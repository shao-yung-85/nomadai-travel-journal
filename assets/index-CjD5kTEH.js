(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=t(r);fetch(r.href,l)}})();function Cg(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var vp={exports:{}},Sc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V0;function YC(){if(V0)return Sc;V0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var m in r)m!=="key"&&(l[m]=r[m])}else l=r;return r=l.ref,{$$typeof:n,type:i,key:c,ref:r!==void 0?r:null,props:l}}return Sc.Fragment=e,Sc.jsx=t,Sc.jsxs=t,Sc}var O0;function WC(){return O0||(O0=1,vp.exports=YC()),vp.exports}var T=WC(),Tp={exports:{}},ot={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U0;function JC(){if(U0)return ot;U0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),C=Symbol.iterator;function M(K){return K===null||typeof K!="object"?null:(K=C&&K[C]||K["@@iterator"],typeof K=="function"?K:null)}var z={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H=Object.assign,Y={};function te(K,de,Ce){this.props=K,this.context=de,this.refs=Y,this.updater=Ce||z}te.prototype.isReactComponent={},te.prototype.setState=function(K,de){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,de,"setState")},te.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function re(){}re.prototype=te.prototype;function ee(K,de,Ce){this.props=K,this.context=de,this.refs=Y,this.updater=Ce||z}var ge=ee.prototype=new re;ge.constructor=ee,H(ge,te.prototype),ge.isPureReactComponent=!0;var pe=Array.isArray;function J(){}var k={H:null,A:null,T:null,S:null},U=Object.prototype.hasOwnProperty;function V(K,de,Ce){var ae=Ce.ref;return{$$typeof:n,type:K,key:de,ref:ae!==void 0?ae:null,props:Ce}}function F(K,de){return V(K.type,de,K.props)}function q(K){return typeof K=="object"&&K!==null&&K.$$typeof===n}function j(K){var de={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(Ce){return de[Ce]})}var B=/\/+/g;function Le(K,de){return typeof K=="object"&&K!==null&&K.key!=null?j(""+K.key):de.toString(36)}function et(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(J,J):(K.status="pending",K.then(function(de){K.status==="pending"&&(K.status="fulfilled",K.value=de)},function(de){K.status==="pending"&&(K.status="rejected",K.reason=de)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function ne(K,de,Ce,ae,fe){var be=typeof K;(be==="undefined"||be==="boolean")&&(K=null);var Fe=!1;if(K===null)Fe=!0;else switch(be){case"bigint":case"string":case"number":Fe=!0;break;case"object":switch(K.$$typeof){case n:case e:Fe=!0;break;case E:return Fe=K._init,ne(Fe(K._payload),de,Ce,ae,fe)}}if(Fe)return fe=fe(K),Fe=ae===""?"."+Le(K,0):ae,pe(fe)?(Ce="",Fe!=null&&(Ce=Fe.replace(B,"$&/")+"/"),ne(fe,de,Ce,"",function(We){return We})):fe!=null&&(q(fe)&&(fe=F(fe,Ce+(fe.key==null||K&&K.key===fe.key?"":(""+fe.key).replace(B,"$&/")+"/")+Fe)),de.push(fe)),1;Fe=0;var ze=ae===""?".":ae+":";if(pe(K))for(var xe=0;xe<K.length;xe++)ae=K[xe],be=ze+Le(ae,xe),Fe+=ne(ae,de,Ce,be,fe);else if(xe=M(K),typeof xe=="function")for(K=xe.call(K),xe=0;!(ae=K.next()).done;)ae=ae.value,be=ze+Le(ae,xe++),Fe+=ne(ae,de,Ce,be,fe);else if(be==="object"){if(typeof K.then=="function")return ne(et(K),de,Ce,ae,fe);throw de=String(K),Error("Objects are not valid as a React child (found: "+(de==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":de)+"). If you meant to render a collection of children, use an array instead.")}return Fe}function Ae(K,de,Ce){if(K==null)return K;var ae=[],fe=0;return ne(K,ae,"","",function(be){return de.call(Ce,be,fe++)}),ae}function Se(K){if(K._status===-1){var de=K._result;de=de(),de.then(function(Ce){(K._status===0||K._status===-1)&&(K._status=1,K._result=Ce)},function(Ce){(K._status===0||K._status===-1)&&(K._status=2,K._result=Ce)}),K._status===-1&&(K._status=0,K._result=de)}if(K._status===1)return K._result.default;throw K._result}var Ye=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var de=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(de))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)},Ie={map:Ae,forEach:function(K,de,Ce){Ae(K,function(){de.apply(this,arguments)},Ce)},count:function(K){var de=0;return Ae(K,function(){de++}),de},toArray:function(K){return Ae(K,function(de){return de})||[]},only:function(K){if(!q(K))throw Error("React.Children.only expected to receive a single React element child.");return K}};return ot.Activity=S,ot.Children=Ie,ot.Component=te,ot.Fragment=t,ot.Profiler=r,ot.PureComponent=ee,ot.StrictMode=i,ot.Suspense=g,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,ot.__COMPILER_RUNTIME={__proto__:null,c:function(K){return k.H.useMemoCache(K)}},ot.cache=function(K){return function(){return K.apply(null,arguments)}},ot.cacheSignal=function(){return null},ot.cloneElement=function(K,de,Ce){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var ae=H({},K.props),fe=K.key;if(de!=null)for(be in de.key!==void 0&&(fe=""+de.key),de)!U.call(de,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&de.ref===void 0||(ae[be]=de[be]);var be=arguments.length-2;if(be===1)ae.children=Ce;else if(1<be){for(var Fe=Array(be),ze=0;ze<be;ze++)Fe[ze]=arguments[ze+2];ae.children=Fe}return V(K.type,fe,ae)},ot.createContext=function(K){return K={$$typeof:c,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:l,_context:K},K},ot.createElement=function(K,de,Ce){var ae,fe={},be=null;if(de!=null)for(ae in de.key!==void 0&&(be=""+de.key),de)U.call(de,ae)&&ae!=="key"&&ae!=="__self"&&ae!=="__source"&&(fe[ae]=de[ae]);var Fe=arguments.length-2;if(Fe===1)fe.children=Ce;else if(1<Fe){for(var ze=Array(Fe),xe=0;xe<Fe;xe++)ze[xe]=arguments[xe+2];fe.children=ze}if(K&&K.defaultProps)for(ae in Fe=K.defaultProps,Fe)fe[ae]===void 0&&(fe[ae]=Fe[ae]);return V(K,be,fe)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(K){return{$$typeof:m,render:K}},ot.isValidElement=q,ot.lazy=function(K){return{$$typeof:E,_payload:{_status:-1,_result:K},_init:Se}},ot.memo=function(K,de){return{$$typeof:p,type:K,compare:de===void 0?null:de}},ot.startTransition=function(K){var de=k.T,Ce={};k.T=Ce;try{var ae=K(),fe=k.S;fe!==null&&fe(Ce,ae),typeof ae=="object"&&ae!==null&&typeof ae.then=="function"&&ae.then(J,Ye)}catch(be){Ye(be)}finally{de!==null&&Ce.types!==null&&(de.types=Ce.types),k.T=de}},ot.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},ot.use=function(K){return k.H.use(K)},ot.useActionState=function(K,de,Ce){return k.H.useActionState(K,de,Ce)},ot.useCallback=function(K,de){return k.H.useCallback(K,de)},ot.useContext=function(K){return k.H.useContext(K)},ot.useDebugValue=function(){},ot.useDeferredValue=function(K,de){return k.H.useDeferredValue(K,de)},ot.useEffect=function(K,de){return k.H.useEffect(K,de)},ot.useEffectEvent=function(K){return k.H.useEffectEvent(K)},ot.useId=function(){return k.H.useId()},ot.useImperativeHandle=function(K,de,Ce){return k.H.useImperativeHandle(K,de,Ce)},ot.useInsertionEffect=function(K,de){return k.H.useInsertionEffect(K,de)},ot.useLayoutEffect=function(K,de){return k.H.useLayoutEffect(K,de)},ot.useMemo=function(K,de){return k.H.useMemo(K,de)},ot.useOptimistic=function(K,de){return k.H.useOptimistic(K,de)},ot.useReducer=function(K,de,Ce){return k.H.useReducer(K,de,Ce)},ot.useRef=function(K){return k.H.useRef(K)},ot.useState=function(K){return k.H.useState(K)},ot.useSyncExternalStore=function(K,de,Ce){return k.H.useSyncExternalStore(K,de,Ce)},ot.useTransition=function(){return k.H.useTransition()},ot.version="19.2.0",ot}var z0;function bg(){return z0||(z0=1,Tp.exports=JC()),Tp.exports}var W=bg();const Hc=Cg(W);var xp={exports:{}},Ac={},Ep={exports:{}},wp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B0;function QC(){return B0||(B0=1,(function(n){function e(ne,Ae){var Se=ne.length;ne.push(Ae);e:for(;0<Se;){var Ye=Se-1>>>1,Ie=ne[Ye];if(0<r(Ie,Ae))ne[Ye]=Ae,ne[Se]=Ie,Se=Ye;else break e}}function t(ne){return ne.length===0?null:ne[0]}function i(ne){if(ne.length===0)return null;var Ae=ne[0],Se=ne.pop();if(Se!==Ae){ne[0]=Se;e:for(var Ye=0,Ie=ne.length,K=Ie>>>1;Ye<K;){var de=2*(Ye+1)-1,Ce=ne[de],ae=de+1,fe=ne[ae];if(0>r(Ce,Se))ae<Ie&&0>r(fe,Ce)?(ne[Ye]=fe,ne[ae]=Se,Ye=ae):(ne[Ye]=Ce,ne[de]=Se,Ye=de);else if(ae<Ie&&0>r(fe,Se))ne[Ye]=fe,ne[ae]=Se,Ye=ae;else break e}}return Ae}function r(ne,Ae){var Se=ne.sortIndex-Ae.sortIndex;return Se!==0?Se:ne.id-Ae.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,m=c.now();n.unstable_now=function(){return c.now()-m}}var g=[],p=[],E=1,S=null,C=3,M=!1,z=!1,H=!1,Y=!1,te=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;function ge(ne){for(var Ae=t(p);Ae!==null;){if(Ae.callback===null)i(p);else if(Ae.startTime<=ne)i(p),Ae.sortIndex=Ae.expirationTime,e(g,Ae);else break;Ae=t(p)}}function pe(ne){if(H=!1,ge(ne),!z)if(t(g)!==null)z=!0,J||(J=!0,j());else{var Ae=t(p);Ae!==null&&et(pe,Ae.startTime-ne)}}var J=!1,k=-1,U=5,V=-1;function F(){return Y?!0:!(n.unstable_now()-V<U)}function q(){if(Y=!1,J){var ne=n.unstable_now();V=ne;var Ae=!0;try{e:{z=!1,H&&(H=!1,re(k),k=-1),M=!0;var Se=C;try{t:{for(ge(ne),S=t(g);S!==null&&!(S.expirationTime>ne&&F());){var Ye=S.callback;if(typeof Ye=="function"){S.callback=null,C=S.priorityLevel;var Ie=Ye(S.expirationTime<=ne);if(ne=n.unstable_now(),typeof Ie=="function"){S.callback=Ie,ge(ne),Ae=!0;break t}S===t(g)&&i(g),ge(ne)}else i(g);S=t(g)}if(S!==null)Ae=!0;else{var K=t(p);K!==null&&et(pe,K.startTime-ne),Ae=!1}}break e}finally{S=null,C=Se,M=!1}Ae=void 0}}finally{Ae?j():J=!1}}}var j;if(typeof ee=="function")j=function(){ee(q)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,Le=B.port2;B.port1.onmessage=q,j=function(){Le.postMessage(null)}}else j=function(){te(q,0)};function et(ne,Ae){k=te(function(){ne(n.unstable_now())},Ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ne){ne.callback=null},n.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<ne?Math.floor(1e3/ne):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_next=function(ne){switch(C){case 1:case 2:case 3:var Ae=3;break;default:Ae=C}var Se=C;C=Ae;try{return ne()}finally{C=Se}},n.unstable_requestPaint=function(){Y=!0},n.unstable_runWithPriority=function(ne,Ae){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var Se=C;C=ne;try{return Ae()}finally{C=Se}},n.unstable_scheduleCallback=function(ne,Ae,Se){var Ye=n.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?Ye+Se:Ye):Se=Ye,ne){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=Se+Ie,ne={id:E++,callback:Ae,priorityLevel:ne,startTime:Se,expirationTime:Ie,sortIndex:-1},Se>Ye?(ne.sortIndex=Se,e(p,ne),t(g)===null&&ne===t(p)&&(H?(re(k),k=-1):H=!0,et(pe,Se-Ye))):(ne.sortIndex=Ie,e(g,ne),z||M||(z=!0,J||(J=!0,j()))),ne},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(ne){var Ae=C;return function(){var Se=C;C=Ae;try{return ne.apply(this,arguments)}finally{C=Se}}}})(wp)),wp}var F0;function $C(){return F0||(F0=1,Ep.exports=QC()),Ep.exports}var Sp={exports:{}},ci={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q0;function XC(){if(q0)return ci;q0=1;var n=bg();function e(g){var p="https://react.dev/errors/"+g;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)p+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+g+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(g,p,E){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:S==null?null:""+S,children:g,containerInfo:p,implementation:E}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(g,p){if(g==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return ci.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ci.createPortal=function(g,p){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return l(g,p,null,E)},ci.flushSync=function(g){var p=c.T,E=i.p;try{if(c.T=null,i.p=2,g)return g()}finally{c.T=p,i.p=E,i.d.f()}},ci.preconnect=function(g,p){typeof g=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(g,p))},ci.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ci.preinit=function(g,p){if(typeof g=="string"&&p&&typeof p.as=="string"){var E=p.as,S=m(E,p.crossOrigin),C=typeof p.integrity=="string"?p.integrity:void 0,M=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;E==="style"?i.d.S(g,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:S,integrity:C,fetchPriority:M}):E==="script"&&i.d.X(g,{crossOrigin:S,integrity:C,fetchPriority:M,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},ci.preinitModule=function(g,p){if(typeof g=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var E=m(p.as,p.crossOrigin);i.d.M(g,{crossOrigin:E,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(g)},ci.preload=function(g,p){if(typeof g=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var E=p.as,S=m(E,p.crossOrigin);i.d.L(g,E,{crossOrigin:S,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},ci.preloadModule=function(g,p){if(typeof g=="string")if(p){var E=m(p.as,p.crossOrigin);i.d.m(g,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:E,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(g)},ci.requestFormReset=function(g){i.d.r(g)},ci.unstable_batchedUpdates=function(g,p){return g(p)},ci.useFormState=function(g,p,E){return c.H.useFormState(g,p,E)},ci.useFormStatus=function(){return c.H.useHostTransitionStatus()},ci.version="19.2.0",ci}var H0;function sw(){if(H0)return Sp.exports;H0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Sp.exports=XC(),Sp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G0;function eb(){if(G0)return Ac;G0=1;var n=$C(),e=bg(),t=sw();function i(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function c(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function m(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function g(s){if(l(s)!==s)throw Error(i(188))}function p(s){var o=s.alternate;if(!o){if(o=l(s),o===null)throw Error(i(188));return o!==s?null:s}for(var u=s,h=o;;){var x=u.return;if(x===null)break;var w=x.alternate;if(w===null){if(h=x.return,h!==null){u=h;continue}break}if(x.child===w.child){for(w=x.child;w;){if(w===u)return g(x),s;if(w===h)return g(x),o;w=w.sibling}throw Error(i(188))}if(u.return!==h.return)u=x,h=w;else{for(var N=!1,D=x.child;D;){if(D===u){N=!0,u=x,h=w;break}if(D===h){N=!0,h=x,u=w;break}D=D.sibling}if(!N){for(D=w.child;D;){if(D===u){N=!0,u=w,h=x;break}if(D===h){N=!0,h=w,u=x;break}D=D.sibling}if(!N)throw Error(i(189))}}if(u.alternate!==h)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?s:o}function E(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=E(s),o!==null)return o;s=s.sibling}return null}var S=Object.assign,C=Symbol.for("react.element"),M=Symbol.for("react.transitional.element"),z=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),Y=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),re=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),pe=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function j(s){return s===null||typeof s!="object"?null:(s=q&&s[q]||s["@@iterator"],typeof s=="function"?s:null)}var B=Symbol.for("react.client.reference");function Le(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===B?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case H:return"Fragment";case te:return"Profiler";case Y:return"StrictMode";case pe:return"Suspense";case J:return"SuspenseList";case V:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case z:return"Portal";case ee:return s.displayName||"Context";case re:return(s._context.displayName||"Context")+".Consumer";case ge:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case k:return o=s.displayName||null,o!==null?o:Le(s.type)||"Memo";case U:o=s._payload,s=s._init;try{return Le(s(o))}catch{}}return null}var et=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Se={pending:!1,data:null,method:null,action:null},Ye=[],Ie=-1;function K(s){return{current:s}}function de(s){0>Ie||(s.current=Ye[Ie],Ye[Ie]=null,Ie--)}function Ce(s,o){Ie++,Ye[Ie]=s.current,s.current=o}var ae=K(null),fe=K(null),be=K(null),Fe=K(null);function ze(s,o){switch(Ce(be,o),Ce(fe,s),Ce(ae,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?o0(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=o0(o),s=r0(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}de(ae),Ce(ae,s)}function xe(){de(ae),de(fe),de(be)}function We(s){s.memoizedState!==null&&Ce(Fe,s);var o=ae.current,u=r0(o,s.type);o!==u&&(Ce(fe,s),Ce(ae,u))}function mt(s){fe.current===s&&(de(ae),de(fe)),Fe.current===s&&(de(Fe),Tc._currentValue=Se)}var je,un;function gn(s){if(je===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);je=o&&o[1]||"",un=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+je+s+un}var Et=!1;function pt(s,o){if(!s||Et)return"";Et=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var Te=function(){throw Error()};if(Object.defineProperty(Te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Te,[])}catch(he){var ue=he}Reflect.construct(s,[],Te)}else{try{Te.call()}catch(he){ue=he}s.call(Te.prototype)}}else{try{throw Error()}catch(he){ue=he}(Te=s())&&typeof Te.catch=="function"&&Te.catch(function(){})}}catch(he){if(he&&ue&&typeof he.stack=="string")return[he.stack,ue.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=h.DetermineComponentFrameRoot(),N=w[0],D=w[1];if(N&&D){var Z=N.split(`
`),oe=D.split(`
`);for(x=h=0;h<Z.length&&!Z[h].includes("DetermineComponentFrameRoot");)h++;for(;x<oe.length&&!oe[x].includes("DetermineComponentFrameRoot");)x++;if(h===Z.length||x===oe.length)for(h=Z.length-1,x=oe.length-1;1<=h&&0<=x&&Z[h]!==oe[x];)x--;for(;1<=h&&0<=x;h--,x--)if(Z[h]!==oe[x]){if(h!==1||x!==1)do if(h--,x--,0>x||Z[h]!==oe[x]){var me=`
`+Z[h].replace(" at new "," at ");return s.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",s.displayName)),me}while(1<=h&&0<=x);break}}}finally{Et=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?gn(u):""}function Nt(s,o){switch(s.tag){case 26:case 27:case 5:return gn(s.type);case 16:return gn("Lazy");case 13:return s.child!==o&&o!==null?gn("Suspense Fallback"):gn("Suspense");case 19:return gn("SuspenseList");case 0:case 15:return pt(s.type,!1);case 11:return pt(s.type.render,!1);case 1:return pt(s.type,!0);case 31:return gn("Activity");default:return""}}function Dt(s){try{var o="",u=null;do o+=Nt(s,u),u=s,s=s.return;while(s);return o}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Rt=Object.prototype.hasOwnProperty,ye=n.unstable_scheduleCallback,Pe=n.unstable_cancelCallback,Ge=n.unstable_shouldYield,gt=n.unstable_requestPaint,lt=n.unstable_now,hn=n.unstable_getCurrentPriorityLevel,Ai=n.unstable_ImmediatePriority,ii=n.unstable_UserBlockingPriority,cn=n.unstable_NormalPriority,Ci=n.unstable_LowPriority,io=n.unstable_IdlePriority,so=n.log,Mo=n.unstable_setDisableYieldValue,Re=null,$e=null;function _t(s){if(typeof so=="function"&&Mo(s),$e&&typeof $e.setStrictMode=="function")try{$e.setStrictMode(Re,s)}catch{}}var ut=Math.clz32?Math.clz32:bi,Un=Math.log,_i=Math.LN2;function bi(s){return s>>>=0,s===0?32:31-(Un(s)/_i|0)|0}var Jn=256,Zi=262144,en=4194304;function yi(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function zn(s,o,u){var h=s.pendingLanes;if(h===0)return 0;var x=0,w=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var D=h&134217727;return D!==0?(h=D&~w,h!==0?x=yi(h):(N&=D,N!==0?x=yi(N):u||(u=D&~s,u!==0&&(x=yi(u))))):(D=h&~w,D!==0?x=yi(D):N!==0?x=yi(N):u||(u=h&~s,u!==0&&(x=yi(u)))),x===0?0:o!==0&&o!==x&&(o&w)===0&&(w=x&-x,u=o&-o,w>=u||w===32&&(u&4194048)!==0)?o:x}function Yi(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Bu(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tl(){var s=en;return en<<=1,(en&62914560)===0&&(en=4194304),s}function fs(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function Ds(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Fu(s,o,u,h,x,w){var N=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var D=s.entanglements,Z=s.expirationTimes,oe=s.hiddenUpdates;for(u=N&~u;0<u;){var me=31-ut(u),Te=1<<me;D[me]=0,Z[me]=-1;var ue=oe[me];if(ue!==null)for(oe[me]=null,me=0;me<ue.length;me++){var he=ue[me];he!==null&&(he.lane&=-536870913)}u&=~Te}h!==0&&Po(s,h,0),w!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=w&~(N&~o))}function Po(s,o,u){s.pendingLanes|=o,s.suspendedLanes&=~o;var h=31-ut(o);s.entangledLanes|=o,s.entanglements[h]=s.entanglements[h]|1073741824|u&261930}function Ea(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var h=31-ut(u),x=1<<h;x&o|s[h]&o&&(s[h]|=o),u&=~x}}function wa(s,o){var u=o&-o;return u=(u&42)!==0?1:Bn(u),(u&(s.suspendedLanes|o))!==0?0:u}function Bn(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ue(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Sa(){var s=Ae.p;return s!==0?s:(s=window.event,s===void 0?32:N0(s.type))}function Ii(s,o){var u=Ae.p;try{return Ae.p=s,o()}finally{Ae.p=u}}var Ni=Math.random().toString(36).slice(2),fn="__reactFiber$"+Ni,_n="__reactProps$"+Ni,Wi="__reactContainer$"+Ni,Ji="__reactEvents$"+Ni,xl="__reactListeners$"+Ni,El="__reactHandles$"+Ni,wl="__reactResources$"+Ni,ms="__reactMarker$"+Ni;function pr(s){delete s[fn],delete s[_n],delete s[Ji],delete s[xl],delete s[El]}function Qi(s){var o=s[fn];if(o)return o;for(var u=s.parentNode;u;){if(o=u[Wi]||u[fn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=f0(s);s!==null;){if(u=s[fn])return u;s=f0(s)}return o}s=u,u=s.parentNode}return null}function Ri(s){if(s=s[fn]||s[Wi]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function Fn(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(i(33))}function ps(s){var o=s[wl];return o||(o=s[wl]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function yn(s){s[ms]=!0}var Aa=new Set,Ca={};function gs(s,o){Mi(s,o),Mi(s+"Capture",o)}function Mi(s,o){for(Ca[s]=o,s=0;s<o.length;s++)Aa.add(o[s])}var Ls=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gr={},_r={};function oo(s){return Rt.call(_r,s)?!0:Rt.call(gr,s)?!1:Ls.test(s)?_r[s]=!0:(gr[s]=!0,!1)}function ft(s,o,u){if(oo(o))if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+u)}}function yt(s,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+u)}}function nn(s,o,u,h){if(h===null)s.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(o,u,""+h)}}function sn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function vi(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ko(s,o,u){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var x=h.get,w=h.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return x.call(this)},set:function(N){u=""+N,w.call(this,N)}}),Object.defineProperty(s,o,{enumerable:h.enumerable}),{getValue:function(){return u},setValue:function(N){u=""+N},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function De(s){if(!s._valueTracker){var o=vi(s)?"checked":"value";s._valueTracker=ko(s,o,""+s[o])}}function Ht(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),h="";return s&&(h=vi(s)?s.checked?"true":"false":s.value),s=h,s!==u?(o.setValue(s),!0):!1}function Pi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var _s=/[\n"\\]/g;function Jt(s){return s.replace(_s,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function yr(s,o,u,h,x,w,N,D){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),o!=null?N==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+sn(o)):s.value!==""+sn(o)&&(s.value=""+sn(o)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),o!=null?$i(s,N,sn(o)):u!=null?$i(s,N,sn(u)):h!=null&&s.removeAttribute("value"),x==null&&w!=null&&(s.defaultChecked=!!w),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.name=""+sn(D):s.removeAttribute("name")}function Do(s,o,u,h,x,w,N,D){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.type=w),o!=null||u!=null){if(!(w!=="submit"&&w!=="reset"||o!=null)){De(s);return}u=u!=null?""+sn(u):"",o=o!=null?""+sn(o):u,D||o===s.value||(s.value=o),s.defaultValue=o}h=h??x,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=D?s.checked:!!h,s.defaultChecked=!!h,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),De(s)}function $i(s,o,u){o==="number"&&Pi(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Gt(s,o,u,h){if(s=s.options,o){o={};for(var x=0;x<u.length;x++)o["$"+u[x]]=!0;for(u=0;u<s.length;u++)x=o.hasOwnProperty("$"+s[u].value),s[u].selected!==x&&(s[u].selected=x),x&&h&&(s[u].defaultSelected=!0)}else{for(u=""+sn(u),o=null,x=0;x<s.length;x++){if(s[x].value===u){s[x].selected=!0,h&&(s[x].defaultSelected=!0);return}o!==null||s[x].disabled||(o=s[x])}o!==null&&(o.selected=!0)}}function ys(s,o,u){if(o!=null&&(o=""+sn(o),o!==s.value&&(s.value=o),u==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=u!=null?""+sn(u):""}function ki(s,o,u,h){if(o==null){if(h!=null){if(u!=null)throw Error(i(92));if(et(h)){if(1<h.length)throw Error(i(93));h=h[0]}u=h}u==null&&(u=""),o=u}u=sn(o),s.defaultValue=u,h=s.textContent,h===u&&h!==""&&h!==null&&(s.value=h),De(s)}function Cn(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var vr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vs(s,o,u){var h=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":h?s.setProperty(o,u):typeof u!="number"||u===0||vr.has(o)?o==="float"?s.cssFloat=u:s[o]=(""+u).trim():s[o]=u+"px"}function Lo(s,o,u){if(o!=null&&typeof o!="object")throw Error(i(62));if(s=s.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var x in o)h=o[x],o.hasOwnProperty(x)&&u[x]!==h&&Vs(s,x,h)}else for(var w in o)o.hasOwnProperty(w)&&Vs(s,w,o[w])}function ro(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),vs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ao(s){return vs.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function si(){}var Tr=null;function oi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var lo=null,Je=null;function qn(s){var o=Ri(s);if(o&&(s=o.stateNode)){var u=s[_n]||null;e:switch(s=o.stateNode,o.type){case"input":if(yr(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Jt(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var h=u[o];if(h!==s&&h.form===s.form){var x=h[_n]||null;if(!x)throw Error(i(90));yr(h,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(o=0;o<u.length;o++)h=u[o],h.form===s.form&&Ht(h)}break e;case"textarea":ys(s,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Gt(s,!!u.multiple,o,!1)}}}var Lt=!1;function Os(s,o,u){if(Lt)return s(o,u);Lt=!0;try{var h=s(o);return h}finally{if(Lt=!1,(lo!==null||Je!==null)&&(jd(),lo&&(o=lo,s=Je,Je=lo=null,qn(o),s)))for(o=0;o<s.length;o++)qn(s[o])}}function Ti(s,o){var u=s.stateNode;if(u===null)return null;var h=u[_n]||null;if(h===null)return null;u=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(i(231,o,typeof u));return u}var ri=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Us=!1;if(ri)try{var wt={};Object.defineProperty(wt,"passive",{get:function(){Us=!0}}),window.addEventListener("test",wt,wt),window.removeEventListener("test",wt,wt)}catch{Us=!1}var Di=null,zs=null,on=null;function Xi(){if(on)return on;var s,o=zs,u=o.length,h,x="value"in Di?Di.value:Di.textContent,w=x.length;for(s=0;s<u&&o[s]===x[s];s++);var N=u-s;for(h=1;h<=N&&o[u-h]===x[w-h];h++);return on=x.slice(s,1<h?1-h:void 0)}function uo(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Ts(){return!0}function es(){return!1}function bn(s){function o(u,h,x,w,N){this._reactName=u,this._targetInst=x,this.type=h,this.nativeEvent=w,this.target=N,this.currentTarget=null;for(var D in s)s.hasOwnProperty(D)&&(u=s[D],this[D]=u?u(w):w[D]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Ts:es,this.isPropagationStopped=es,this}return S(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ts)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ts)},persist:function(){},isPersistent:Ts}),o}var ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xs=bn(ts),Bs=S({},ts,{view:0,detail:0}),ht=bn(Bs),co,Hn,ai,Oo=S({},Bs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ho,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ai&&(ai&&s.type==="mousemove"?(co=s.screenX-ai.screenX,Hn=s.screenY-ai.screenY):Hn=co=0,ai=s),co)},movementY:function(s){return"movementY"in s?s.movementY:Hn}}),ba=bn(Oo),Fs=S({},Oo,{dataTransfer:0}),Sl=bn(Fs),Ia=S({},Bs,{relatedTarget:0}),Uo=bn(Ia),Na=S({},ts,{animationName:0,elapsedTime:0,pseudoElement:0}),xr=bn(Na),Er=S({},ts,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),xi=bn(Er),Al=S({},ts,{data:0}),ns=bn(Al),is={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ra={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ma={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wr(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=Ma[s])?!!o[s]:!1}function ho(){return wr}var Gn=S({},Bs,{key:function(s){if(s.key){var o=is[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=uo(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ra[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ho,charCode:function(s){return s.type==="keypress"?uo(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?uo(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Pa=bn(Gn),Cl=S({},Oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qs=bn(Cl),y=S({},Bs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ho}),b=bn(y),R=S({},ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),O=bn(R),ie=S({},Oo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ce=bn(ie),Ne=S({},ts,{newState:0,oldState:0}),tt=bn(Ne),Mt=[9,13,27,32],Pt=ri&&"CompositionEvent"in window,Qt=null;ri&&"documentMode"in document&&(Qt=document.documentMode);var Li=ri&&"TextEvent"in window&&!Qt,Vi=ri&&(!Pt||Qt&&8<Qt&&11>=Qt),Ei=" ",ss=!1;function zo(s,o){switch(s){case"keyup":return Mt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bo(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Sr=!1;function os(s,o){switch(s){case"compositionend":return Bo(o);case"keypress":return o.which!==32?null:(ss=!0,Ei);case"textInput":return s=o.data,s===Ei&&ss?null:s;default:return null}}function Ar(s,o){if(Sr)return s==="compositionend"||!Pt&&zo(s,o)?(s=Xi(),on=zs=Di=null,Sr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Vi&&o.locale!=="ko"?null:o.data;default:return null}}var Of={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Es(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!Of[s.type]:o==="textarea"}function ld(s,o,u,h){lo?Je?Je.push(h):Je=[h]:lo=h,o=$d(o,"onChange"),0<o.length&&(u=new xs("onChange","change",null,u,h),s.push({event:u,listeners:o}))}var ws=null,ka=null;function Da(s){Xv(s,0)}function La(s){var o=Fn(s);if(Ht(o))return s}function Va(s,o){if(s==="change")return o}var ud=!1;if(ri){var Ss;if(ri){var Cr="oninput"in document;if(!Cr){var cd=document.createElement("div");cd.setAttribute("oninput","return;"),Cr=typeof cd.oninput=="function"}Ss=Cr}else Ss=!1;ud=Ss&&(!document.documentMode||9<document.documentMode)}function bl(){ws&&(ws.detachEvent("onpropertychange",dd),ka=ws=null)}function dd(s){if(s.propertyName==="value"&&La(ka)){var o=[];ld(o,ka,s,oi(s)),Os(Da,o)}}function Hs(s,o,u){s==="focusin"?(bl(),ws=o,ka=u,ws.attachEvent("onpropertychange",dd)):s==="focusout"&&bl()}function Uf(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return La(ka)}function br(s,o){if(s==="click")return La(o)}function zf(s,o){if(s==="input"||s==="change")return La(o)}function Gs(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var jn=typeof Object.is=="function"?Object.is:Gs;function Ir(s,o){if(jn(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),h=Object.keys(o);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var x=u[h];if(!Rt.call(o,x)||!jn(s[x],o[x]))return!1}return!0}function Il(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Oa(s,o){var u=Il(s);s=0;for(var h;u;){if(u.nodeType===3){if(h=s+u.textContent.length,s<=o&&h>=o)return{node:u,offset:o-s};s=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Il(u)}}function Nl(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Nl(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Ua(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Pi(s.document);o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=Pi(s.document)}return o}function fo(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var Rl=ri&&"documentMode"in document&&11>=document.documentMode,mo=null,Ml=null,za=null,Nr=!1;function hd(s,o,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Nr||mo==null||mo!==Pi(h)||(h=mo,"selectionStart"in h&&fo(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),za&&Ir(za,h)||(za=h,h=$d(Ml,"onSelect"),0<h.length&&(o=new xs("onSelect","select",null,o,u),s.push({event:o,listeners:h}),o.target=mo)))}function po(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var Rr={animationend:po("Animation","AnimationEnd"),animationiteration:po("Animation","AnimationIteration"),animationstart:po("Animation","AnimationStart"),transitionrun:po("Transition","TransitionRun"),transitionstart:po("Transition","TransitionStart"),transitioncancel:po("Transition","TransitionCancel"),transitionend:po("Transition","TransitionEnd")},Pl={},fd={};ri&&(fd=document.createElement("div").style,"AnimationEvent"in window||(delete Rr.animationend.animation,delete Rr.animationiteration.animation,delete Rr.animationstart.animation),"TransitionEvent"in window||delete Rr.transitionend.transition);function Kn(s){if(Pl[s])return Pl[s];if(!Rr[s])return s;var o=Rr[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in fd)return Pl[s]=o[u];return s}var Ba=Kn("animationend"),md=Kn("animationiteration"),Fa=Kn("animationstart"),Bf=Kn("transitionrun"),pd=Kn("transitionstart"),Ff=Kn("transitioncancel"),Mr=Kn("transitionend"),gd=new Map,go="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");go.push("scrollEnd");function Oi(s,o){gd.set(s,o),gs(o,[s])}var qa=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ui=[],li=0,kl=0;function Ha(){for(var s=li,o=kl=li=0;o<s;){var u=Ui[o];Ui[o++]=null;var h=Ui[o];Ui[o++]=null;var x=Ui[o];Ui[o++]=null;var w=Ui[o];if(Ui[o++]=null,h!==null&&x!==null){var N=h.pending;N===null?x.next=x:(x.next=N.next,N.next=x),h.pending=x}w!==0&&Pr(u,x,w)}}function _o(s,o,u,h){Ui[li++]=s,Ui[li++]=o,Ui[li++]=u,Ui[li++]=h,kl|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function qu(s,o,u,h){return _o(s,o,u,h),Ga(s)}function As(s,o){return _o(s,null,null,o),Ga(s)}function Pr(s,o,u){s.lanes|=u;var h=s.alternate;h!==null&&(h.lanes|=u);for(var x=!1,w=s.return;w!==null;)w.childLanes|=u,h=w.alternate,h!==null&&(h.childLanes|=u),w.tag===22&&(s=w.stateNode,s===null||s._visibility&1||(x=!0)),s=w,w=w.return;return s.tag===3?(w=s.stateNode,x&&o!==null&&(x=31-ut(u),s=w.hiddenUpdates,h=s[x],h===null?s[x]=[o]:h.push(o),o.lane=u|536870912),w):null}function Ga(s){if(50<fc)throw fc=0,Hm=null,Error(i(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var Fo={};function qf(s,o,u,h){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ui(s,o,u,h){return new qf(s,o,u,h)}function Dl(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Cs(s,o){var u=s.alternate;return u===null?(u=ui(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function Hu(s,o){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,o=u.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function ja(s,o,u,h,x,w){var N=0;if(h=s,typeof s=="function")Dl(s)&&(N=1);else if(typeof s=="string")N=VC(s,u,ae.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case V:return s=ui(31,u,o,x),s.elementType=V,s.lanes=w,s;case H:return qo(u.children,x,w,o);case Y:N=8,x|=24;break;case te:return s=ui(12,u,o,x|2),s.elementType=te,s.lanes=w,s;case pe:return s=ui(13,u,o,x),s.elementType=pe,s.lanes=w,s;case J:return s=ui(19,u,o,x),s.elementType=J,s.lanes=w,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ee:N=10;break e;case re:N=9;break e;case ge:N=11;break e;case k:N=14;break e;case U:N=16,h=null;break e}N=29,u=Error(i(130,s===null?"null":typeof s,"")),h=null}return o=ui(N,u,o,x),o.elementType=s,o.type=h,o.lanes=w,o}function qo(s,o,u,h){return s=ui(7,s,h,o),s.lanes=u,s}function Ll(s,o,u){return s=ui(6,s,null,o),s.lanes=u,s}function Gu(s){var o=ui(18,null,null,0);return o.stateNode=s,o}function ju(s,o,u){return o=ui(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var a=new WeakMap;function d(s,o){if(typeof s=="object"&&s!==null){var u=a.get(s);return u!==void 0?u:(o={value:s,source:o,stack:Dt(o)},a.set(s,o),o)}return{value:s,source:o,stack:Dt(o)}}var v=[],A=0,I=null,P=0,G=[],X=0,le=null,ve=1,Me="";function He(s,o){v[A++]=P,v[A++]=I,I=s,P=o}function ct(s,o,u){G[X++]=ve,G[X++]=Me,G[X++]=le,le=s;var h=ve;s=Me;var x=32-ut(h)-1;h&=~(1<<x),u+=1;var w=32-ut(o)+x;if(30<w){var N=x-x%5;w=(h&(1<<N)-1).toString(32),h>>=N,x-=N,ve=1<<32-ut(o)+x|u<<x|h,Me=w+s}else ve=1<<w|u<<x|h,Me=s}function Ln(s){s.return!==null&&(He(s,1),ct(s,1,0))}function vn(s){for(;s===I;)I=v[--A],v[A]=null,P=v[--A],v[A]=null;for(;s===le;)le=G[--X],G[X]=null,Me=G[--X],G[X]=null,ve=G[--X],G[X]=null}function wi(s,o){G[X++]=ve,G[X++]=Me,G[X++]=le,ve=o.id,Me=o.overflow,le=s}var Vt=null,Ot=null,vt=!1,yo=null,zi=!1,Vl=Error(i(519));function vo(s){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ka(d(o,s)),Vl}function Ku(s){var o=s.stateNode,u=s.type,h=s.memoizedProps;switch(o[fn]=s,o[_n]=h,u){case"dialog":xt("cancel",o),xt("close",o);break;case"iframe":case"object":case"embed":xt("load",o);break;case"video":case"audio":for(u=0;u<pc.length;u++)xt(pc[u],o);break;case"source":xt("error",o);break;case"img":case"image":case"link":xt("error",o),xt("load",o);break;case"details":xt("toggle",o);break;case"input":xt("invalid",o),Do(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":xt("invalid",o);break;case"textarea":xt("invalid",o),ki(o,h.value,h.defaultValue,h.children)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||h.suppressHydrationWarning===!0||i0(o.textContent,u)?(h.popover!=null&&(xt("beforetoggle",o),xt("toggle",o)),h.onScroll!=null&&xt("scroll",o),h.onScrollEnd!=null&&xt("scrollend",o),h.onClick!=null&&(o.onclick=si),o=!0):o=!1,o||vo(s,!0)}function mn(s){for(Vt=s.return;Vt;)switch(Vt.tag){case 5:case 31:case 13:zi=!1;return;case 27:case 3:zi=!0;return;default:Vt=Vt.return}}function js(s){if(s!==Vt)return!1;if(!vt)return mn(s),vt=!0,!1;var o=s.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||sp(s.type,s.memoizedProps)),u=!u),u&&Ot&&vo(s),mn(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Ot=h0(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Ot=h0(s)}else o===27?(o=Ot,Kr(s.type)?(s=up,up=null,Ot=s):Ot=o):Ot=Vt?Is(s.stateNode.nextSibling):null;return!0}function Ho(){Ot=Vt=null,vt=!1}function Zu(){var s=yo;return s!==null&&(Hi===null?Hi=s:Hi.push.apply(Hi,s),yo=null),s}function Ka(s){yo===null?yo=[s]:yo.push(s)}var Za=K(null),To=null,Ks=null;function kr(s,o,u){Ce(Za,o._currentValue),o._currentValue=u}function Go(s){s._currentValue=Za.current,de(Za)}function Hf(s,o,u){for(;s!==null;){var h=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),s===u)break;s=s.return}}function Gf(s,o,u,h){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var w=x.dependencies;if(w!==null){var N=x.child;w=w.firstContext;e:for(;w!==null;){var D=w;w=x;for(var Z=0;Z<o.length;Z++)if(D.context===o[Z]){w.lanes|=u,D=w.alternate,D!==null&&(D.lanes|=u),Hf(w.return,u,s),h||(N=null);break e}w=D.next}}else if(x.tag===18){if(N=x.return,N===null)throw Error(i(341));N.lanes|=u,w=N.alternate,w!==null&&(w.lanes|=u),Hf(N,u,s),N=null}else N=x.child;if(N!==null)N.return=x;else for(N=x;N!==null;){if(N===s){N=null;break}if(x=N.sibling,x!==null){x.return=N.return,N=x;break}N=N.return}x=N}}function Ol(s,o,u,h){s=null;for(var x=o,w=!1;x!==null;){if(!w){if((x.flags&524288)!==0)w=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var N=x.alternate;if(N===null)throw Error(i(387));if(N=N.memoizedProps,N!==null){var D=x.type;jn(x.pendingProps.value,N.value)||(s!==null?s.push(D):s=[D])}}else if(x===Fe.current){if(N=x.alternate,N===null)throw Error(i(387));N.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Tc):s=[Tc])}x=x.return}s!==null&&Gf(o,s,u,h),o.flags|=262144}function _d(s){for(s=s.firstContext;s!==null;){if(!jn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ya(s){To=s,Ks=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Qn(s){return q_(To,s)}function yd(s,o){return To===null&&Ya(s),q_(s,o)}function q_(s,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Ks===null){if(s===null)throw Error(i(308));Ks=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Ks=Ks.next=o;return u}var PA=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(u,h){s.push(h)}};this.abort=function(){o.aborted=!0,s.forEach(function(u){return u()})}},kA=n.unstable_scheduleCallback,DA=n.unstable_NormalPriority,In={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jf(){return{controller:new PA,data:new Map,refCount:0}}function Yu(s){s.refCount--,s.refCount===0&&kA(DA,function(){s.controller.abort()})}var Wu=null,Kf=0,Ul=0,zl=null;function LA(s,o){if(Wu===null){var u=Wu=[];Kf=0,Ul=Wm(),zl={status:"pending",value:void 0,then:function(h){u.push(h)}}}return Kf++,o.then(H_,H_),o}function H_(){if(--Kf===0&&Wu!==null){zl!==null&&(zl.status="fulfilled");var s=Wu;Wu=null,Ul=0,zl=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function VA(s,o){var u=[],h={status:"pending",value:null,reason:null,then:function(x){u.push(x)}};return s.then(function(){h.status="fulfilled",h.value=o;for(var x=0;x<u.length;x++)(0,u[x])(o)},function(x){for(h.status="rejected",h.reason=x,x=0;x<u.length;x++)(0,u[x])(void 0)}),h}var G_=ne.S;ne.S=function(s,o){bv=lt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&LA(s,o),G_!==null&&G_(s,o)};var Wa=K(null);function Zf(){var s=Wa.current;return s!==null?s:$t.pooledCache}function vd(s,o){o===null?Ce(Wa,Wa.current):Ce(Wa,o.pool)}function j_(){var s=Zf();return s===null?null:{parent:In._currentValue,pool:s}}var Bl=Error(i(460)),Yf=Error(i(474)),Td=Error(i(542)),xd={then:function(){}};function K_(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Z_(s,o,u){switch(u=s[u],u===void 0?s.push(o):u!==o&&(o.then(si,si),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,W_(s),s;default:if(typeof o.status=="string")o.then(si,si);else{if(s=$t,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=o,s.status="pending",s.then(function(h){if(o.status==="pending"){var x=o;x.status="fulfilled",x.value=h}},function(h){if(o.status==="pending"){var x=o;x.status="rejected",x.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,W_(s),s}throw Qa=o,Bl}}function Ja(s){try{var o=s._init;return o(s._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Qa=u,Bl):u}}var Qa=null;function Y_(){if(Qa===null)throw Error(i(459));var s=Qa;return Qa=null,s}function W_(s){if(s===Bl||s===Td)throw Error(i(483))}var Fl=null,Ju=0;function Ed(s){var o=Ju;return Ju+=1,Fl===null&&(Fl=[]),Z_(Fl,s,o)}function Qu(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function wd(s,o){throw o.$$typeof===C?Error(i(525)):(s=Object.prototype.toString.call(o),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function J_(s){function o($,Q){if(s){var se=$.deletions;se===null?($.deletions=[Q],$.flags|=16):se.push(Q)}}function u($,Q){if(!s)return null;for(;Q!==null;)o($,Q),Q=Q.sibling;return null}function h($){for(var Q=new Map;$!==null;)$.key!==null?Q.set($.key,$):Q.set($.index,$),$=$.sibling;return Q}function x($,Q){return $=Cs($,Q),$.index=0,$.sibling=null,$}function w($,Q,se){return $.index=se,s?(se=$.alternate,se!==null?(se=se.index,se<Q?($.flags|=67108866,Q):se):($.flags|=67108866,Q)):($.flags|=1048576,Q)}function N($){return s&&$.alternate===null&&($.flags|=67108866),$}function D($,Q,se,_e){return Q===null||Q.tag!==6?(Q=Ll(se,$.mode,_e),Q.return=$,Q):(Q=x(Q,se),Q.return=$,Q)}function Z($,Q,se,_e){var Ke=se.type;return Ke===H?me($,Q,se.props.children,_e,se.key):Q!==null&&(Q.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===U&&Ja(Ke)===Q.type)?(Q=x(Q,se.props),Qu(Q,se),Q.return=$,Q):(Q=ja(se.type,se.key,se.props,null,$.mode,_e),Qu(Q,se),Q.return=$,Q)}function oe($,Q,se,_e){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==se.containerInfo||Q.stateNode.implementation!==se.implementation?(Q=ju(se,$.mode,_e),Q.return=$,Q):(Q=x(Q,se.children||[]),Q.return=$,Q)}function me($,Q,se,_e,Ke){return Q===null||Q.tag!==7?(Q=qo(se,$.mode,_e,Ke),Q.return=$,Q):(Q=x(Q,se),Q.return=$,Q)}function Te($,Q,se){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Ll(""+Q,$.mode,se),Q.return=$,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case M:return se=ja(Q.type,Q.key,Q.props,null,$.mode,se),Qu(se,Q),se.return=$,se;case z:return Q=ju(Q,$.mode,se),Q.return=$,Q;case U:return Q=Ja(Q),Te($,Q,se)}if(et(Q)||j(Q))return Q=qo(Q,$.mode,se,null),Q.return=$,Q;if(typeof Q.then=="function")return Te($,Ed(Q),se);if(Q.$$typeof===ee)return Te($,yd($,Q),se);wd($,Q)}return null}function ue($,Q,se,_e){var Ke=Q!==null?Q.key:null;if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return Ke!==null?null:D($,Q,""+se,_e);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case M:return se.key===Ke?Z($,Q,se,_e):null;case z:return se.key===Ke?oe($,Q,se,_e):null;case U:return se=Ja(se),ue($,Q,se,_e)}if(et(se)||j(se))return Ke!==null?null:me($,Q,se,_e,null);if(typeof se.then=="function")return ue($,Q,Ed(se),_e);if(se.$$typeof===ee)return ue($,Q,yd($,se),_e);wd($,se)}return null}function he($,Q,se,_e,Ke){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return $=$.get(se)||null,D(Q,$,""+_e,Ke);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case M:return $=$.get(_e.key===null?se:_e.key)||null,Z(Q,$,_e,Ke);case z:return $=$.get(_e.key===null?se:_e.key)||null,oe(Q,$,_e,Ke);case U:return _e=Ja(_e),he($,Q,se,_e,Ke)}if(et(_e)||j(_e))return $=$.get(se)||null,me(Q,$,_e,Ke,null);if(typeof _e.then=="function")return he($,Q,se,Ed(_e),Ke);if(_e.$$typeof===ee)return he($,Q,se,yd(Q,_e),Ke);wd(Q,_e)}return null}function Be($,Q,se,_e){for(var Ke=null,Ut=null,qe=Q,dt=Q=0,At=null;qe!==null&&dt<se.length;dt++){qe.index>dt?(At=qe,qe=null):At=qe.sibling;var zt=ue($,qe,se[dt],_e);if(zt===null){qe===null&&(qe=At);break}s&&qe&&zt.alternate===null&&o($,qe),Q=w(zt,Q,dt),Ut===null?Ke=zt:Ut.sibling=zt,Ut=zt,qe=At}if(dt===se.length)return u($,qe),vt&&He($,dt),Ke;if(qe===null){for(;dt<se.length;dt++)qe=Te($,se[dt],_e),qe!==null&&(Q=w(qe,Q,dt),Ut===null?Ke=qe:Ut.sibling=qe,Ut=qe);return vt&&He($,dt),Ke}for(qe=h(qe);dt<se.length;dt++)At=he(qe,$,dt,se[dt],_e),At!==null&&(s&&At.alternate!==null&&qe.delete(At.key===null?dt:At.key),Q=w(At,Q,dt),Ut===null?Ke=At:Ut.sibling=At,Ut=At);return s&&qe.forEach(function(Qr){return o($,Qr)}),vt&&He($,dt),Ke}function Qe($,Q,se,_e){if(se==null)throw Error(i(151));for(var Ke=null,Ut=null,qe=Q,dt=Q=0,At=null,zt=se.next();qe!==null&&!zt.done;dt++,zt=se.next()){qe.index>dt?(At=qe,qe=null):At=qe.sibling;var Qr=ue($,qe,zt.value,_e);if(Qr===null){qe===null&&(qe=At);break}s&&qe&&Qr.alternate===null&&o($,qe),Q=w(Qr,Q,dt),Ut===null?Ke=Qr:Ut.sibling=Qr,Ut=Qr,qe=At}if(zt.done)return u($,qe),vt&&He($,dt),Ke;if(qe===null){for(;!zt.done;dt++,zt=se.next())zt=Te($,zt.value,_e),zt!==null&&(Q=w(zt,Q,dt),Ut===null?Ke=zt:Ut.sibling=zt,Ut=zt);return vt&&He($,dt),Ke}for(qe=h(qe);!zt.done;dt++,zt=se.next())zt=he(qe,$,dt,zt.value,_e),zt!==null&&(s&&zt.alternate!==null&&qe.delete(zt.key===null?dt:zt.key),Q=w(zt,Q,dt),Ut===null?Ke=zt:Ut.sibling=zt,Ut=zt);return s&&qe.forEach(function(ZC){return o($,ZC)}),vt&&He($,dt),Ke}function Wt($,Q,se,_e){if(typeof se=="object"&&se!==null&&se.type===H&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case M:e:{for(var Ke=se.key;Q!==null;){if(Q.key===Ke){if(Ke=se.type,Ke===H){if(Q.tag===7){u($,Q.sibling),_e=x(Q,se.props.children),_e.return=$,$=_e;break e}}else if(Q.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===U&&Ja(Ke)===Q.type){u($,Q.sibling),_e=x(Q,se.props),Qu(_e,se),_e.return=$,$=_e;break e}u($,Q);break}else o($,Q);Q=Q.sibling}se.type===H?(_e=qo(se.props.children,$.mode,_e,se.key),_e.return=$,$=_e):(_e=ja(se.type,se.key,se.props,null,$.mode,_e),Qu(_e,se),_e.return=$,$=_e)}return N($);case z:e:{for(Ke=se.key;Q!==null;){if(Q.key===Ke)if(Q.tag===4&&Q.stateNode.containerInfo===se.containerInfo&&Q.stateNode.implementation===se.implementation){u($,Q.sibling),_e=x(Q,se.children||[]),_e.return=$,$=_e;break e}else{u($,Q);break}else o($,Q);Q=Q.sibling}_e=ju(se,$.mode,_e),_e.return=$,$=_e}return N($);case U:return se=Ja(se),Wt($,Q,se,_e)}if(et(se))return Be($,Q,se,_e);if(j(se)){if(Ke=j(se),typeof Ke!="function")throw Error(i(150));return se=Ke.call(se),Qe($,Q,se,_e)}if(typeof se.then=="function")return Wt($,Q,Ed(se),_e);if(se.$$typeof===ee)return Wt($,Q,yd($,se),_e);wd($,se)}return typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint"?(se=""+se,Q!==null&&Q.tag===6?(u($,Q.sibling),_e=x(Q,se),_e.return=$,$=_e):(u($,Q),_e=Ll(se,$.mode,_e),_e.return=$,$=_e),N($)):u($,Q)}return function($,Q,se,_e){try{Ju=0;var Ke=Wt($,Q,se,_e);return Fl=null,Ke}catch(qe){if(qe===Bl||qe===Td)throw qe;var Ut=ui(29,qe,null,$.mode);return Ut.lanes=_e,Ut.return=$,Ut}finally{}}}var $a=J_(!0),Q_=J_(!1),Dr=!1;function Wf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Jf(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Lr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Vr(s,o,u){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Ft&2)!==0){var x=h.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),h.pending=o,o=Ga(s),Pr(s,null,u),o}return _o(s,h,o,u),Ga(s)}function $u(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var h=o.lanes;h&=s.pendingLanes,u|=h,o.lanes=u,Ea(s,u)}}function Qf(s,o){var u=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var x=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var N={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};w===null?x=w=N:w=w.next=N,u=u.next}while(u!==null);w===null?x=w=o:w=w.next=o}else x=w=o;u={baseState:h.baseState,firstBaseUpdate:x,lastBaseUpdate:w,shared:h.shared,callbacks:h.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}var $f=!1;function Xu(){if($f){var s=zl;if(s!==null)throw s}}function ec(s,o,u,h){$f=!1;var x=s.updateQueue;Dr=!1;var w=x.firstBaseUpdate,N=x.lastBaseUpdate,D=x.shared.pending;if(D!==null){x.shared.pending=null;var Z=D,oe=Z.next;Z.next=null,N===null?w=oe:N.next=oe,N=Z;var me=s.alternate;me!==null&&(me=me.updateQueue,D=me.lastBaseUpdate,D!==N&&(D===null?me.firstBaseUpdate=oe:D.next=oe,me.lastBaseUpdate=Z))}if(w!==null){var Te=x.baseState;N=0,me=oe=Z=null,D=w;do{var ue=D.lane&-536870913,he=ue!==D.lane;if(he?(St&ue)===ue:(h&ue)===ue){ue!==0&&ue===Ul&&($f=!0),me!==null&&(me=me.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Be=s,Qe=D;ue=o;var Wt=u;switch(Qe.tag){case 1:if(Be=Qe.payload,typeof Be=="function"){Te=Be.call(Wt,Te,ue);break e}Te=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=Qe.payload,ue=typeof Be=="function"?Be.call(Wt,Te,ue):Be,ue==null)break e;Te=S({},Te,ue);break e;case 2:Dr=!0}}ue=D.callback,ue!==null&&(s.flags|=64,he&&(s.flags|=8192),he=x.callbacks,he===null?x.callbacks=[ue]:he.push(ue))}else he={lane:ue,tag:D.tag,payload:D.payload,callback:D.callback,next:null},me===null?(oe=me=he,Z=Te):me=me.next=he,N|=ue;if(D=D.next,D===null){if(D=x.shared.pending,D===null)break;he=D,D=he.next,he.next=null,x.lastBaseUpdate=he,x.shared.pending=null}}while(!0);me===null&&(Z=Te),x.baseState=Z,x.firstBaseUpdate=oe,x.lastBaseUpdate=me,w===null&&(x.shared.lanes=0),Fr|=N,s.lanes=N,s.memoizedState=Te}}function $_(s,o){if(typeof s!="function")throw Error(i(191,s));s.call(o)}function X_(s,o){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)$_(u[s],o)}var ql=K(null),Sd=K(0);function ey(s,o){s=Xo,Ce(Sd,s),Ce(ql,o),Xo=s|o.baseLanes}function Xf(){Ce(Sd,Xo),Ce(ql,ql.current)}function em(){Xo=Sd.current,de(ql),de(Sd)}var rs=K(null),bs=null;function Or(s){var o=s.alternate;Ce(En,En.current&1),Ce(rs,s),bs===null&&(o===null||ql.current!==null||o.memoizedState!==null)&&(bs=s)}function tm(s){Ce(En,En.current),Ce(rs,s),bs===null&&(bs=s)}function ty(s){s.tag===22?(Ce(En,En.current),Ce(rs,s),bs===null&&(bs=s)):Ur()}function Ur(){Ce(En,En.current),Ce(rs,rs.current)}function as(s){de(rs),bs===s&&(bs=null),de(En)}var En=K(0);function Ad(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||ap(u)||lp(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var jo=0,at=null,Zt=null,Nn=null,Cd=!1,Hl=!1,Xa=!1,bd=0,tc=0,Gl=null,OA=0;function Tn(){throw Error(i(321))}function nm(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!jn(s[u],o[u]))return!1;return!0}function im(s,o,u,h,x,w){return jo=w,at=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ne.H=s===null||s.memoizedState===null?Uy:ym,Xa=!1,w=u(h,x),Xa=!1,Hl&&(w=iy(o,u,h,x)),ny(s),w}function ny(s){ne.H=sc;var o=Zt!==null&&Zt.next!==null;if(jo=0,Nn=Zt=at=null,Cd=!1,tc=0,Gl=null,o)throw Error(i(300));s===null||Rn||(s=s.dependencies,s!==null&&_d(s)&&(Rn=!0))}function iy(s,o,u,h){at=s;var x=0;do{if(Hl&&(Gl=null),tc=0,Hl=!1,25<=x)throw Error(i(301));if(x+=1,Nn=Zt=null,s.updateQueue!=null){var w=s.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}ne.H=zy,w=o(u,h)}while(Hl);return w}function UA(){var s=ne.H,o=s.useState()[0];return o=typeof o.then=="function"?nc(o):o,s=s.useState()[0],(Zt!==null?Zt.memoizedState:null)!==s&&(at.flags|=1024),o}function sm(){var s=bd!==0;return bd=0,s}function om(s,o,u){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~u}function rm(s){if(Cd){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Cd=!1}jo=0,Nn=Zt=at=null,Hl=!1,tc=bd=0,Gl=null}function Si(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nn===null?at.memoizedState=Nn=s:Nn=Nn.next=s,Nn}function wn(){if(Zt===null){var s=at.alternate;s=s!==null?s.memoizedState:null}else s=Zt.next;var o=Nn===null?at.memoizedState:Nn.next;if(o!==null)Nn=o,Zt=s;else{if(s===null)throw at.alternate===null?Error(i(467)):Error(i(310));Zt=s,s={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},Nn===null?at.memoizedState=Nn=s:Nn=Nn.next=s}return Nn}function Id(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function nc(s){var o=tc;return tc+=1,Gl===null&&(Gl=[]),s=Z_(Gl,s,o),o=at,(Nn===null?o.memoizedState:Nn.next)===null&&(o=o.alternate,ne.H=o===null||o.memoizedState===null?Uy:ym),s}function Nd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return nc(s);if(s.$$typeof===ee)return Qn(s)}throw Error(i(438,String(s)))}function am(s){var o=null,u=at.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var h=at.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(x){return x.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Id(),at.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(s),h=0;h<s;h++)u[h]=F;return o.index++,u}function Ko(s,o){return typeof o=="function"?o(s):o}function Rd(s){var o=wn();return lm(o,Zt,s)}function lm(s,o,u){var h=s.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=u;var x=s.baseQueue,w=h.pending;if(w!==null){if(x!==null){var N=x.next;x.next=w.next,w.next=N}o.baseQueue=x=w,h.pending=null}if(w=s.baseState,x===null)s.memoizedState=w;else{o=x.next;var D=N=null,Z=null,oe=o,me=!1;do{var Te=oe.lane&-536870913;if(Te!==oe.lane?(St&Te)===Te:(jo&Te)===Te){var ue=oe.revertLane;if(ue===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),Te===Ul&&(me=!0);else if((jo&ue)===ue){oe=oe.next,ue===Ul&&(me=!0);continue}else Te={lane:0,revertLane:oe.revertLane,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},Z===null?(D=Z=Te,N=w):Z=Z.next=Te,at.lanes|=ue,Fr|=ue;Te=oe.action,Xa&&u(w,Te),w=oe.hasEagerState?oe.eagerState:u(w,Te)}else ue={lane:Te,revertLane:oe.revertLane,gesture:oe.gesture,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},Z===null?(D=Z=ue,N=w):Z=Z.next=ue,at.lanes|=Te,Fr|=Te;oe=oe.next}while(oe!==null&&oe!==o);if(Z===null?N=w:Z.next=D,!jn(w,s.memoizedState)&&(Rn=!0,me&&(u=zl,u!==null)))throw u;s.memoizedState=w,s.baseState=N,s.baseQueue=Z,h.lastRenderedState=w}return x===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function um(s){var o=wn(),u=o.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=s;var h=u.dispatch,x=u.pending,w=o.memoizedState;if(x!==null){u.pending=null;var N=x=x.next;do w=s(w,N.action),N=N.next;while(N!==x);jn(w,o.memoizedState)||(Rn=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),u.lastRenderedState=w}return[w,h]}function sy(s,o,u){var h=at,x=wn(),w=vt;if(w){if(u===void 0)throw Error(i(407));u=u()}else u=o();var N=!jn((Zt||x).memoizedState,u);if(N&&(x.memoizedState=u,Rn=!0),x=x.queue,hm(ay.bind(null,h,x,s),[s]),x.getSnapshot!==o||N||Nn!==null&&Nn.memoizedState.tag&1){if(h.flags|=2048,jl(9,{destroy:void 0},ry.bind(null,h,x,u,o),null),$t===null)throw Error(i(349));w||(jo&127)!==0||oy(h,o,u)}return u}function oy(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=at.updateQueue,o===null?(o=Id(),at.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function ry(s,o,u,h){o.value=u,o.getSnapshot=h,ly(o)&&uy(s)}function ay(s,o,u){return u(function(){ly(o)&&uy(s)})}function ly(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!jn(s,u)}catch{return!0}}function uy(s){var o=As(s,2);o!==null&&Gi(o,s,2)}function cm(s){var o=Si();if(typeof s=="function"){var u=s;if(s=u(),Xa){_t(!0);try{u()}finally{_t(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ko,lastRenderedState:s},o}function cy(s,o,u,h){return s.baseState=u,lm(s,Zt,typeof h=="function"?h:Ko)}function zA(s,o,u,h,x){if(kd(s))throw Error(i(485));if(s=o.action,s!==null){var w={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){w.listeners.push(N)}};ne.T!==null?u(!0):w.isTransition=!1,h(w),u=o.pending,u===null?(w.next=o.pending=w,dy(o,w)):(w.next=u.next,o.pending=u.next=w)}}function dy(s,o){var u=o.action,h=o.payload,x=s.state;if(o.isTransition){var w=ne.T,N={};ne.T=N;try{var D=u(x,h),Z=ne.S;Z!==null&&Z(N,D),hy(s,o,D)}catch(oe){dm(s,o,oe)}finally{w!==null&&N.types!==null&&(w.types=N.types),ne.T=w}}else try{w=u(x,h),hy(s,o,w)}catch(oe){dm(s,o,oe)}}function hy(s,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){fy(s,o,h)},function(h){return dm(s,o,h)}):fy(s,o,u)}function fy(s,o,u){o.status="fulfilled",o.value=u,my(o),s.state=u,o=s.pending,o!==null&&(u=o.next,u===o?s.pending=null:(u=u.next,o.next=u,dy(s,u)))}function dm(s,o,u){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=u,my(o),o=o.next;while(o!==h)}s.action=null}function my(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function py(s,o){return o}function gy(s,o){if(vt){var u=$t.formState;if(u!==null){e:{var h=at;if(vt){if(Ot){t:{for(var x=Ot,w=zi;x.nodeType!==8;){if(!w){x=null;break t}if(x=Is(x.nextSibling),x===null){x=null;break t}}w=x.data,x=w==="F!"||w==="F"?x:null}if(x){Ot=Is(x.nextSibling),h=x.data==="F!";break e}}vo(h)}h=!1}h&&(o=u[0])}}return u=Si(),u.memoizedState=u.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:py,lastRenderedState:o},u.queue=h,u=Ly.bind(null,at,h),h.dispatch=u,h=cm(!1),w=_m.bind(null,at,!1,h.queue),h=Si(),x={state:o,dispatch:null,action:s,pending:null},h.queue=x,u=zA.bind(null,at,x,w,u),x.dispatch=u,h.memoizedState=s,[o,u,!1]}function _y(s){var o=wn();return yy(o,Zt,s)}function yy(s,o,u){if(o=lm(s,o,py)[0],s=Rd(Ko)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=nc(o)}catch(N){throw N===Bl?Td:N}else h=o;o=wn();var x=o.queue,w=x.dispatch;return u!==o.memoizedState&&(at.flags|=2048,jl(9,{destroy:void 0},BA.bind(null,x,u),null)),[h,w,s]}function BA(s,o){s.action=o}function vy(s){var o=wn(),u=Zt;if(u!==null)return yy(o,u,s);wn(),o=o.memoizedState,u=wn();var h=u.queue.dispatch;return u.memoizedState=s,[o,h,!1]}function jl(s,o,u,h){return s={tag:s,create:u,deps:h,inst:o,next:null},o=at.updateQueue,o===null&&(o=Id(),at.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=s.next=s:(h=u.next,u.next=s,s.next=h,o.lastEffect=s),s}function Ty(){return wn().memoizedState}function Md(s,o,u,h){var x=Si();at.flags|=s,x.memoizedState=jl(1|o,{destroy:void 0},u,h===void 0?null:h)}function Pd(s,o,u,h){var x=wn();h=h===void 0?null:h;var w=x.memoizedState.inst;Zt!==null&&h!==null&&nm(h,Zt.memoizedState.deps)?x.memoizedState=jl(o,w,u,h):(at.flags|=s,x.memoizedState=jl(1|o,w,u,h))}function xy(s,o){Md(8390656,8,s,o)}function hm(s,o){Pd(2048,8,s,o)}function FA(s){at.flags|=4;var o=at.updateQueue;if(o===null)o=Id(),at.updateQueue=o,o.events=[s];else{var u=o.events;u===null?o.events=[s]:u.push(s)}}function Ey(s){var o=wn().memoizedState;return FA({ref:o,nextImpl:s}),function(){if((Ft&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function wy(s,o){return Pd(4,2,s,o)}function Sy(s,o){return Pd(4,4,s,o)}function Ay(s,o){if(typeof o=="function"){s=s();var u=o(s);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function Cy(s,o,u){u=u!=null?u.concat([s]):null,Pd(4,4,Ay.bind(null,o,s),u)}function fm(){}function by(s,o){var u=wn();o=o===void 0?null:o;var h=u.memoizedState;return o!==null&&nm(o,h[1])?h[0]:(u.memoizedState=[s,o],s)}function Iy(s,o){var u=wn();o=o===void 0?null:o;var h=u.memoizedState;if(o!==null&&nm(o,h[1]))return h[0];if(h=s(),Xa){_t(!0);try{s()}finally{_t(!1)}}return u.memoizedState=[h,o],h}function mm(s,o,u){return u===void 0||(jo&1073741824)!==0&&(St&261930)===0?s.memoizedState=o:(s.memoizedState=u,s=Nv(),at.lanes|=s,Fr|=s,u)}function Ny(s,o,u,h){return jn(u,o)?u:ql.current!==null?(s=mm(s,u,h),jn(s,o)||(Rn=!0),s):(jo&42)===0||(jo&1073741824)!==0&&(St&261930)===0?(Rn=!0,s.memoizedState=u):(s=Nv(),at.lanes|=s,Fr|=s,o)}function Ry(s,o,u,h,x){var w=Ae.p;Ae.p=w!==0&&8>w?w:8;var N=ne.T,D={};ne.T=D,_m(s,!1,o,u);try{var Z=x(),oe=ne.S;if(oe!==null&&oe(D,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var me=VA(Z,h);ic(s,o,me,cs(s))}else ic(s,o,h,cs(s))}catch(Te){ic(s,o,{then:function(){},status:"rejected",reason:Te},cs())}finally{Ae.p=w,N!==null&&D.types!==null&&(N.types=D.types),ne.T=N}}function qA(){}function pm(s,o,u,h){if(s.tag!==5)throw Error(i(476));var x=My(s).queue;Ry(s,x,o,Se,u===null?qA:function(){return Py(s),u(h)})}function My(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:Se,baseState:Se,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ko,lastRenderedState:Se},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ko,lastRenderedState:u},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Py(s){var o=My(s);o.next===null&&(o=s.alternate.memoizedState),ic(s,o.next.queue,{},cs())}function gm(){return Qn(Tc)}function ky(){return wn().memoizedState}function Dy(){return wn().memoizedState}function HA(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var u=cs();s=Lr(u);var h=Vr(o,s,u);h!==null&&(Gi(h,o,u),$u(h,o,u)),o={cache:jf()},s.payload=o;return}o=o.return}}function GA(s,o,u){var h=cs();u={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},kd(s)?Vy(o,u):(u=qu(s,o,u,h),u!==null&&(Gi(u,s,h),Oy(u,o,h)))}function Ly(s,o,u){var h=cs();ic(s,o,u,h)}function ic(s,o,u,h){var x={lane:h,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(kd(s))Vy(o,x);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var N=o.lastRenderedState,D=w(N,u);if(x.hasEagerState=!0,x.eagerState=D,jn(D,N))return _o(s,o,x,0),$t===null&&Ha(),!1}catch{}finally{}if(u=qu(s,o,x,h),u!==null)return Gi(u,s,h),Oy(u,o,h),!0}return!1}function _m(s,o,u,h){if(h={lane:2,revertLane:Wm(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},kd(s)){if(o)throw Error(i(479))}else o=qu(s,u,h,2),o!==null&&Gi(o,s,2)}function kd(s){var o=s.alternate;return s===at||o!==null&&o===at}function Vy(s,o){Hl=Cd=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function Oy(s,o,u){if((u&4194048)!==0){var h=o.lanes;h&=s.pendingLanes,u|=h,o.lanes=u,Ea(s,u)}}var sc={readContext:Qn,use:Nd,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useLayoutEffect:Tn,useInsertionEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useSyncExternalStore:Tn,useId:Tn,useHostTransitionStatus:Tn,useFormState:Tn,useActionState:Tn,useOptimistic:Tn,useMemoCache:Tn,useCacheRefresh:Tn};sc.useEffectEvent=Tn;var Uy={readContext:Qn,use:Nd,useCallback:function(s,o){return Si().memoizedState=[s,o===void 0?null:o],s},useContext:Qn,useEffect:xy,useImperativeHandle:function(s,o,u){u=u!=null?u.concat([s]):null,Md(4194308,4,Ay.bind(null,o,s),u)},useLayoutEffect:function(s,o){return Md(4194308,4,s,o)},useInsertionEffect:function(s,o){Md(4,2,s,o)},useMemo:function(s,o){var u=Si();o=o===void 0?null:o;var h=s();if(Xa){_t(!0);try{s()}finally{_t(!1)}}return u.memoizedState=[h,o],h},useReducer:function(s,o,u){var h=Si();if(u!==void 0){var x=u(o);if(Xa){_t(!0);try{u(o)}finally{_t(!1)}}}else x=o;return h.memoizedState=h.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},h.queue=s,s=s.dispatch=GA.bind(null,at,s),[h.memoizedState,s]},useRef:function(s){var o=Si();return s={current:s},o.memoizedState=s},useState:function(s){s=cm(s);var o=s.queue,u=Ly.bind(null,at,o);return o.dispatch=u,[s.memoizedState,u]},useDebugValue:fm,useDeferredValue:function(s,o){var u=Si();return mm(u,s,o)},useTransition:function(){var s=cm(!1);return s=Ry.bind(null,at,s.queue,!0,!1),Si().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,u){var h=at,x=Si();if(vt){if(u===void 0)throw Error(i(407));u=u()}else{if(u=o(),$t===null)throw Error(i(349));(St&127)!==0||oy(h,o,u)}x.memoizedState=u;var w={value:u,getSnapshot:o};return x.queue=w,xy(ay.bind(null,h,w,s),[s]),h.flags|=2048,jl(9,{destroy:void 0},ry.bind(null,h,w,u,o),null),u},useId:function(){var s=Si(),o=$t.identifierPrefix;if(vt){var u=Me,h=ve;u=(h&~(1<<32-ut(h)-1)).toString(32)+u,o="_"+o+"R_"+u,u=bd++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=OA++,o="_"+o+"r_"+u.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:gm,useFormState:gy,useActionState:gy,useOptimistic:function(s){var o=Si();o.memoizedState=o.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=_m.bind(null,at,!0,u),u.dispatch=o,[s,o]},useMemoCache:am,useCacheRefresh:function(){return Si().memoizedState=HA.bind(null,at)},useEffectEvent:function(s){var o=Si(),u={impl:s};return o.memoizedState=u,function(){if((Ft&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}},ym={readContext:Qn,use:Nd,useCallback:by,useContext:Qn,useEffect:hm,useImperativeHandle:Cy,useInsertionEffect:wy,useLayoutEffect:Sy,useMemo:Iy,useReducer:Rd,useRef:Ty,useState:function(){return Rd(Ko)},useDebugValue:fm,useDeferredValue:function(s,o){var u=wn();return Ny(u,Zt.memoizedState,s,o)},useTransition:function(){var s=Rd(Ko)[0],o=wn().memoizedState;return[typeof s=="boolean"?s:nc(s),o]},useSyncExternalStore:sy,useId:ky,useHostTransitionStatus:gm,useFormState:_y,useActionState:_y,useOptimistic:function(s,o){var u=wn();return cy(u,Zt,s,o)},useMemoCache:am,useCacheRefresh:Dy};ym.useEffectEvent=Ey;var zy={readContext:Qn,use:Nd,useCallback:by,useContext:Qn,useEffect:hm,useImperativeHandle:Cy,useInsertionEffect:wy,useLayoutEffect:Sy,useMemo:Iy,useReducer:um,useRef:Ty,useState:function(){return um(Ko)},useDebugValue:fm,useDeferredValue:function(s,o){var u=wn();return Zt===null?mm(u,s,o):Ny(u,Zt.memoizedState,s,o)},useTransition:function(){var s=um(Ko)[0],o=wn().memoizedState;return[typeof s=="boolean"?s:nc(s),o]},useSyncExternalStore:sy,useId:ky,useHostTransitionStatus:gm,useFormState:vy,useActionState:vy,useOptimistic:function(s,o){var u=wn();return Zt!==null?cy(u,Zt,s,o):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:am,useCacheRefresh:Dy};zy.useEffectEvent=Ey;function vm(s,o,u,h){o=s.memoizedState,u=u(h,o),u=u==null?o:S({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Tm={enqueueSetState:function(s,o,u){s=s._reactInternals;var h=cs(),x=Lr(h);x.payload=o,u!=null&&(x.callback=u),o=Vr(s,x,h),o!==null&&(Gi(o,s,h),$u(o,s,h))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var h=cs(),x=Lr(h);x.tag=1,x.payload=o,u!=null&&(x.callback=u),o=Vr(s,x,h),o!==null&&(Gi(o,s,h),$u(o,s,h))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=cs(),h=Lr(u);h.tag=2,o!=null&&(h.callback=o),o=Vr(s,h,u),o!==null&&(Gi(o,s,u),$u(o,s,u))}};function By(s,o,u,h,x,w,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,w,N):o.prototype&&o.prototype.isPureReactComponent?!Ir(u,h)||!Ir(x,w):!0}function Fy(s,o,u,h){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,h),o.state!==s&&Tm.enqueueReplaceState(o,o.state,null)}function el(s,o){var u=o;if("ref"in o){u={};for(var h in o)h!=="ref"&&(u[h]=o[h])}if(s=s.defaultProps){u===o&&(u=S({},u));for(var x in s)u[x]===void 0&&(u[x]=s[x])}return u}function qy(s){qa(s)}function Hy(s){console.error(s)}function Gy(s){qa(s)}function Dd(s,o){try{var u=s.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function jy(s,o,u){try{var h=s.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function xm(s,o,u){return u=Lr(u),u.tag=3,u.payload={element:null},u.callback=function(){Dd(s,o)},u}function Ky(s){return s=Lr(s),s.tag=3,s}function Zy(s,o,u,h){var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var w=h.value;s.payload=function(){return x(w)},s.callback=function(){jy(o,u,h)}}var N=u.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){jy(o,u,h),typeof x!="function"&&(qr===null?qr=new Set([this]):qr.add(this));var D=h.stack;this.componentDidCatch(h.value,{componentStack:D!==null?D:""})})}function jA(s,o,u,h,x){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=u.alternate,o!==null&&Ol(o,u,x,!0),u=rs.current,u!==null){switch(u.tag){case 31:case 13:return bs===null?Kd():u.alternate===null&&xn===0&&(xn=3),u.flags&=-257,u.flags|=65536,u.lanes=x,h===xd?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([h]):o.add(h),Km(s,h,x)),!1;case 22:return u.flags|=65536,h===xd?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([h]):u.add(h)),Km(s,h,x)),!1}throw Error(i(435,u.tag))}return Km(s,h,x),Kd(),!1}if(vt)return o=rs.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=x,h!==Vl&&(s=Error(i(422),{cause:h}),Ka(d(s,u)))):(h!==Vl&&(o=Error(i(423),{cause:h}),Ka(d(o,u))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,h=d(h,u),x=xm(s.stateNode,h,x),Qf(s,x),xn!==4&&(xn=2)),!1;var w=Error(i(520),{cause:h});if(w=d(w,u),hc===null?hc=[w]:hc.push(w),xn!==4&&(xn=2),o===null)return!0;h=d(h,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,s=x&-x,u.lanes|=s,s=xm(u.stateNode,h,s),Qf(u,s),!1;case 1:if(o=u.type,w=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(qr===null||!qr.has(w))))return u.flags|=65536,x&=-x,u.lanes|=x,x=Ky(x),Zy(x,s,u,h),Qf(u,x),!1}u=u.return}while(u!==null);return!1}var Em=Error(i(461)),Rn=!1;function $n(s,o,u,h){o.child=s===null?Q_(o,null,u,h):$a(o,s.child,u,h)}function Yy(s,o,u,h,x){u=u.render;var w=o.ref;if("ref"in h){var N={};for(var D in h)D!=="ref"&&(N[D]=h[D])}else N=h;return Ya(o),h=im(s,o,u,N,w,x),D=sm(),s!==null&&!Rn?(om(s,o,x),Zo(s,o,x)):(vt&&D&&Ln(o),o.flags|=1,$n(s,o,h,x),o.child)}function Wy(s,o,u,h,x){if(s===null){var w=u.type;return typeof w=="function"&&!Dl(w)&&w.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=w,Jy(s,o,w,h,x)):(s=ja(u.type,null,h,o,o.mode,x),s.ref=o.ref,s.return=o,o.child=s)}if(w=s.child,!Rm(s,x)){var N=w.memoizedProps;if(u=u.compare,u=u!==null?u:Ir,u(N,h)&&s.ref===o.ref)return Zo(s,o,x)}return o.flags|=1,s=Cs(w,h),s.ref=o.ref,s.return=o,o.child=s}function Jy(s,o,u,h,x){if(s!==null){var w=s.memoizedProps;if(Ir(w,h)&&s.ref===o.ref)if(Rn=!1,o.pendingProps=h=w,Rm(s,x))(s.flags&131072)!==0&&(Rn=!0);else return o.lanes=s.lanes,Zo(s,o,x)}return wm(s,o,u,h,x)}function Qy(s,o,u,h){var x=h.children,w=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((o.flags&128)!==0){if(w=w!==null?w.baseLanes|u:u,s!==null){for(h=o.child=s.child,x=0;h!==null;)x=x|h.lanes|h.childLanes,h=h.sibling;h=x&~w}else h=0,o.child=null;return $y(s,o,w,u,h)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&vd(o,w!==null?w.cachePool:null),w!==null?ey(o,w):Xf(),ty(o);else return h=o.lanes=536870912,$y(s,o,w!==null?w.baseLanes|u:u,u,h)}else w!==null?(vd(o,w.cachePool),ey(o,w),Ur(),o.memoizedState=null):(s!==null&&vd(o,null),Xf(),Ur());return $n(s,o,x,u),o.child}function oc(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function $y(s,o,u,h,x){var w=Zf();return w=w===null?null:{parent:In._currentValue,pool:w},o.memoizedState={baseLanes:u,cachePool:w},s!==null&&vd(o,null),Xf(),ty(o),s!==null&&Ol(s,o,h,!0),o.childLanes=x,null}function Ld(s,o){return o=Od({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function Xy(s,o,u){return $a(o,s.child,null,u),s=Ld(o,o.pendingProps),s.flags|=2,as(o),o.memoizedState=null,s}function KA(s,o,u){var h=o.pendingProps,x=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(vt){if(h.mode==="hidden")return s=Ld(o,h),o.lanes=536870912,oc(null,s);if(tm(o),(s=Ot)?(s=d0(s,zi),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:le!==null?{id:ve,overflow:Me}:null,retryLane:536870912,hydrationErrors:null},u=Gu(s),u.return=o,o.child=u,Vt=o,Ot=null)):s=null,s===null)throw vo(o);return o.lanes=536870912,null}return Ld(o,h)}var w=s.memoizedState;if(w!==null){var N=w.dehydrated;if(tm(o),x)if(o.flags&256)o.flags&=-257,o=Xy(s,o,u);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(i(558));else if(Rn||Ol(s,o,u,!1),x=(u&s.childLanes)!==0,Rn||x){if(h=$t,h!==null&&(N=wa(h,u),N!==0&&N!==w.retryLane))throw w.retryLane=N,As(s,N),Gi(h,s,N),Em;Kd(),o=Xy(s,o,u)}else s=w.treeContext,Ot=Is(N.nextSibling),Vt=o,vt=!0,yo=null,zi=!1,s!==null&&wi(o,s),o=Ld(o,h),o.flags|=4096;return o}return s=Cs(s.child,{mode:h.mode,children:h.children}),s.ref=o.ref,o.child=s,s.return=o,s}function Vd(s,o){var u=o.ref;if(u===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(s===null||s.ref!==u)&&(o.flags|=4194816)}}function wm(s,o,u,h,x){return Ya(o),u=im(s,o,u,h,void 0,x),h=sm(),s!==null&&!Rn?(om(s,o,x),Zo(s,o,x)):(vt&&h&&Ln(o),o.flags|=1,$n(s,o,u,x),o.child)}function ev(s,o,u,h,x,w){return Ya(o),o.updateQueue=null,u=iy(o,h,u,x),ny(s),h=sm(),s!==null&&!Rn?(om(s,o,w),Zo(s,o,w)):(vt&&h&&Ln(o),o.flags|=1,$n(s,o,u,w),o.child)}function tv(s,o,u,h,x){if(Ya(o),o.stateNode===null){var w=Fo,N=u.contextType;typeof N=="object"&&N!==null&&(w=Qn(N)),w=new u(h,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=Tm,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=h,w.state=o.memoizedState,w.refs={},Wf(o),N=u.contextType,w.context=typeof N=="object"&&N!==null?Qn(N):Fo,w.state=o.memoizedState,N=u.getDerivedStateFromProps,typeof N=="function"&&(vm(o,u,N,h),w.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(N=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),N!==w.state&&Tm.enqueueReplaceState(w,w.state,null),ec(o,h,w,x),Xu(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(s===null){w=o.stateNode;var D=o.memoizedProps,Z=el(u,D);w.props=Z;var oe=w.context,me=u.contextType;N=Fo,typeof me=="object"&&me!==null&&(N=Qn(me));var Te=u.getDerivedStateFromProps;me=typeof Te=="function"||typeof w.getSnapshotBeforeUpdate=="function",D=o.pendingProps!==D,me||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(D||oe!==N)&&Fy(o,w,h,N),Dr=!1;var ue=o.memoizedState;w.state=ue,ec(o,h,w,x),Xu(),oe=o.memoizedState,D||ue!==oe||Dr?(typeof Te=="function"&&(vm(o,u,Te,h),oe=o.memoizedState),(Z=Dr||By(o,u,Z,h,ue,oe,N))?(me||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=oe),w.props=h,w.state=oe,w.context=N,h=Z):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{w=o.stateNode,Jf(s,o),N=o.memoizedProps,me=el(u,N),w.props=me,Te=o.pendingProps,ue=w.context,oe=u.contextType,Z=Fo,typeof oe=="object"&&oe!==null&&(Z=Qn(oe)),D=u.getDerivedStateFromProps,(oe=typeof D=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(N!==Te||ue!==Z)&&Fy(o,w,h,Z),Dr=!1,ue=o.memoizedState,w.state=ue,ec(o,h,w,x),Xu();var he=o.memoizedState;N!==Te||ue!==he||Dr||s!==null&&s.dependencies!==null&&_d(s.dependencies)?(typeof D=="function"&&(vm(o,u,D,h),he=o.memoizedState),(me=Dr||By(o,u,me,h,ue,he,Z)||s!==null&&s.dependencies!==null&&_d(s.dependencies))?(oe||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,he,Z),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,he,Z)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&ue===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ue===s.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=he),w.props=h,w.state=he,w.context=Z,h=me):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&ue===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ue===s.memoizedState||(o.flags|=1024),h=!1)}return w=h,Vd(s,o),h=(o.flags&128)!==0,w||h?(w=o.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,s!==null&&h?(o.child=$a(o,s.child,null,x),o.child=$a(o,null,u,x)):$n(s,o,u,x),o.memoizedState=w.state,s=o.child):s=Zo(s,o,x),s}function nv(s,o,u,h){return Ho(),o.flags|=256,$n(s,o,u,h),o.child}var Sm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Am(s){return{baseLanes:s,cachePool:j_()}}function Cm(s,o,u){return s=s!==null?s.childLanes&~u:0,o&&(s|=us),s}function iv(s,o,u){var h=o.pendingProps,x=!1,w=(o.flags&128)!==0,N;if((N=w)||(N=s!==null&&s.memoizedState===null?!1:(En.current&2)!==0),N&&(x=!0,o.flags&=-129),N=(o.flags&32)!==0,o.flags&=-33,s===null){if(vt){if(x?Or(o):Ur(),(s=Ot)?(s=d0(s,zi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:le!==null?{id:ve,overflow:Me}:null,retryLane:536870912,hydrationErrors:null},u=Gu(s),u.return=o,o.child=u,Vt=o,Ot=null)):s=null,s===null)throw vo(o);return lp(s)?o.lanes=32:o.lanes=536870912,null}var D=h.children;return h=h.fallback,x?(Ur(),x=o.mode,D=Od({mode:"hidden",children:D},x),h=qo(h,x,u,null),D.return=o,h.return=o,D.sibling=h,o.child=D,h=o.child,h.memoizedState=Am(u),h.childLanes=Cm(s,N,u),o.memoizedState=Sm,oc(null,h)):(Or(o),bm(o,D))}var Z=s.memoizedState;if(Z!==null&&(D=Z.dehydrated,D!==null)){if(w)o.flags&256?(Or(o),o.flags&=-257,o=Im(s,o,u)):o.memoizedState!==null?(Ur(),o.child=s.child,o.flags|=128,o=null):(Ur(),D=h.fallback,x=o.mode,h=Od({mode:"visible",children:h.children},x),D=qo(D,x,u,null),D.flags|=2,h.return=o,D.return=o,h.sibling=D,o.child=h,$a(o,s.child,null,u),h=o.child,h.memoizedState=Am(u),h.childLanes=Cm(s,N,u),o.memoizedState=Sm,o=oc(null,h));else if(Or(o),lp(D)){if(N=D.nextSibling&&D.nextSibling.dataset,N)var oe=N.dgst;N=oe,h=Error(i(419)),h.stack="",h.digest=N,Ka({value:h,source:null,stack:null}),o=Im(s,o,u)}else if(Rn||Ol(s,o,u,!1),N=(u&s.childLanes)!==0,Rn||N){if(N=$t,N!==null&&(h=wa(N,u),h!==0&&h!==Z.retryLane))throw Z.retryLane=h,As(s,h),Gi(N,s,h),Em;ap(D)||Kd(),o=Im(s,o,u)}else ap(D)?(o.flags|=192,o.child=s.child,o=null):(s=Z.treeContext,Ot=Is(D.nextSibling),Vt=o,vt=!0,yo=null,zi=!1,s!==null&&wi(o,s),o=bm(o,h.children),o.flags|=4096);return o}return x?(Ur(),D=h.fallback,x=o.mode,Z=s.child,oe=Z.sibling,h=Cs(Z,{mode:"hidden",children:h.children}),h.subtreeFlags=Z.subtreeFlags&65011712,oe!==null?D=Cs(oe,D):(D=qo(D,x,u,null),D.flags|=2),D.return=o,h.return=o,h.sibling=D,o.child=h,oc(null,h),h=o.child,D=s.child.memoizedState,D===null?D=Am(u):(x=D.cachePool,x!==null?(Z=In._currentValue,x=x.parent!==Z?{parent:Z,pool:Z}:x):x=j_(),D={baseLanes:D.baseLanes|u,cachePool:x}),h.memoizedState=D,h.childLanes=Cm(s,N,u),o.memoizedState=Sm,oc(s.child,h)):(Or(o),u=s.child,s=u.sibling,u=Cs(u,{mode:"visible",children:h.children}),u.return=o,u.sibling=null,s!==null&&(N=o.deletions,N===null?(o.deletions=[s],o.flags|=16):N.push(s)),o.child=u,o.memoizedState=null,u)}function bm(s,o){return o=Od({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Od(s,o){return s=ui(22,s,null,o),s.lanes=0,s}function Im(s,o,u){return $a(o,s.child,null,u),s=bm(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function sv(s,o,u){s.lanes|=o;var h=s.alternate;h!==null&&(h.lanes|=o),Hf(s.return,o,u)}function Nm(s,o,u,h,x,w){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:x,treeForkCount:w}:(N.isBackwards=o,N.rendering=null,N.renderingStartTime=0,N.last=h,N.tail=u,N.tailMode=x,N.treeForkCount=w)}function ov(s,o,u){var h=o.pendingProps,x=h.revealOrder,w=h.tail;h=h.children;var N=En.current,D=(N&2)!==0;if(D?(N=N&1|2,o.flags|=128):N&=1,Ce(En,N),$n(s,o,h,u),h=vt?P:0,!D&&s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&sv(s,u,o);else if(s.tag===19)sv(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(u=o.child,x=null;u!==null;)s=u.alternate,s!==null&&Ad(s)===null&&(x=u),u=u.sibling;u=x,u===null?(x=o.child,o.child=null):(x=u.sibling,u.sibling=null),Nm(o,!1,x,u,w,h);break;case"backwards":case"unstable_legacy-backwards":for(u=null,x=o.child,o.child=null;x!==null;){if(s=x.alternate,s!==null&&Ad(s)===null){o.child=x;break}s=x.sibling,x.sibling=u,u=x,x=s}Nm(o,!0,u,null,w,h);break;case"together":Nm(o,!1,null,null,void 0,h);break;default:o.memoizedState=null}return o.child}function Zo(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),Fr|=o.lanes,(u&o.childLanes)===0)if(s!==null){if(Ol(s,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(i(153));if(o.child!==null){for(s=o.child,u=Cs(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=Cs(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function Rm(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&_d(s)))}function ZA(s,o,u){switch(o.tag){case 3:ze(o,o.stateNode.containerInfo),kr(o,In,s.memoizedState.cache),Ho();break;case 27:case 5:We(o);break;case 4:ze(o,o.stateNode.containerInfo);break;case 10:kr(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,tm(o),null;break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(Or(o),o.flags|=128,null):(u&o.child.childLanes)!==0?iv(s,o,u):(Or(o),s=Zo(s,o,u),s!==null?s.sibling:null);Or(o);break;case 19:var x=(s.flags&128)!==0;if(h=(u&o.childLanes)!==0,h||(Ol(s,o,u,!1),h=(u&o.childLanes)!==0),x){if(h)return ov(s,o,u);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Ce(En,En.current),h)break;return null;case 22:return o.lanes=0,Qy(s,o,u,o.pendingProps);case 24:kr(o,In,s.memoizedState.cache)}return Zo(s,o,u)}function rv(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps)Rn=!0;else{if(!Rm(s,u)&&(o.flags&128)===0)return Rn=!1,ZA(s,o,u);Rn=(s.flags&131072)!==0}else Rn=!1,vt&&(o.flags&1048576)!==0&&ct(o,P,o.index);switch(o.lanes=0,o.tag){case 16:e:{var h=o.pendingProps;if(s=Ja(o.elementType),o.type=s,typeof s=="function")Dl(s)?(h=el(s,h),o.tag=1,o=tv(null,o,s,h,u)):(o.tag=0,o=wm(null,o,s,h,u));else{if(s!=null){var x=s.$$typeof;if(x===ge){o.tag=11,o=Yy(null,o,s,h,u);break e}else if(x===k){o.tag=14,o=Wy(null,o,s,h,u);break e}}throw o=Le(s)||s,Error(i(306,o,""))}}return o;case 0:return wm(s,o,o.type,o.pendingProps,u);case 1:return h=o.type,x=el(h,o.pendingProps),tv(s,o,h,x,u);case 3:e:{if(ze(o,o.stateNode.containerInfo),s===null)throw Error(i(387));h=o.pendingProps;var w=o.memoizedState;x=w.element,Jf(s,o),ec(o,h,null,u);var N=o.memoizedState;if(h=N.cache,kr(o,In,h),h!==w.cache&&Gf(o,[In],u,!0),Xu(),h=N.element,w.isDehydrated)if(w={element:h,isDehydrated:!1,cache:N.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=nv(s,o,h,u);break e}else if(h!==x){x=d(Error(i(424)),o),Ka(x),o=nv(s,o,h,u);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Ot=Is(s.firstChild),Vt=o,vt=!0,yo=null,zi=!0,u=Q_(o,null,h,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Ho(),h===x){o=Zo(s,o,u);break e}$n(s,o,h,u)}o=o.child}return o;case 26:return Vd(s,o),s===null?(u=_0(o.type,null,o.pendingProps,null))?o.memoizedState=u:vt||(u=o.type,s=o.pendingProps,h=Xd(be.current).createElement(u),h[fn]=o,h[_n]=s,Xn(h,u,s),yn(h),o.stateNode=h):o.memoizedState=_0(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return We(o),s===null&&vt&&(h=o.stateNode=m0(o.type,o.pendingProps,be.current),Vt=o,zi=!0,x=Ot,Kr(o.type)?(up=x,Ot=Is(h.firstChild)):Ot=x),$n(s,o,o.pendingProps.children,u),Vd(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&vt&&((x=h=Ot)&&(h=wC(h,o.type,o.pendingProps,zi),h!==null?(o.stateNode=h,Vt=o,Ot=Is(h.firstChild),zi=!1,x=!0):x=!1),x||vo(o)),We(o),x=o.type,w=o.pendingProps,N=s!==null?s.memoizedProps:null,h=w.children,sp(x,w)?h=null:N!==null&&sp(x,N)&&(o.flags|=32),o.memoizedState!==null&&(x=im(s,o,UA,null,null,u),Tc._currentValue=x),Vd(s,o),$n(s,o,h,u),o.child;case 6:return s===null&&vt&&((s=u=Ot)&&(u=SC(u,o.pendingProps,zi),u!==null?(o.stateNode=u,Vt=o,Ot=null,s=!0):s=!1),s||vo(o)),null;case 13:return iv(s,o,u);case 4:return ze(o,o.stateNode.containerInfo),h=o.pendingProps,s===null?o.child=$a(o,null,h,u):$n(s,o,h,u),o.child;case 11:return Yy(s,o,o.type,o.pendingProps,u);case 7:return $n(s,o,o.pendingProps,u),o.child;case 8:return $n(s,o,o.pendingProps.children,u),o.child;case 12:return $n(s,o,o.pendingProps.children,u),o.child;case 10:return h=o.pendingProps,kr(o,o.type,h.value),$n(s,o,h.children,u),o.child;case 9:return x=o.type._context,h=o.pendingProps.children,Ya(o),x=Qn(x),h=h(x),o.flags|=1,$n(s,o,h,u),o.child;case 14:return Wy(s,o,o.type,o.pendingProps,u);case 15:return Jy(s,o,o.type,o.pendingProps,u);case 19:return ov(s,o,u);case 31:return KA(s,o,u);case 22:return Qy(s,o,u,o.pendingProps);case 24:return Ya(o),h=Qn(In),s===null?(x=Zf(),x===null&&(x=$t,w=jf(),x.pooledCache=w,w.refCount++,w!==null&&(x.pooledCacheLanes|=u),x=w),o.memoizedState={parent:h,cache:x},Wf(o),kr(o,In,x)):((s.lanes&u)!==0&&(Jf(s,o),ec(o,null,null,u),Xu()),x=s.memoizedState,w=o.memoizedState,x.parent!==h?(x={parent:h,cache:h},o.memoizedState=x,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=x),kr(o,In,h)):(h=w.cache,kr(o,In,h),h!==x.cache&&Gf(o,[In],u,!0))),$n(s,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function Yo(s){s.flags|=4}function Mm(s,o,u,h,x){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(kv())s.flags|=8192;else throw Qa=xd,Yf}else s.flags&=-16777217}function av(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!E0(o))if(kv())s.flags|=8192;else throw Qa=xd,Yf}function Ud(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Tl():536870912,s.lanes|=o,Wl|=o)}function rc(s,o){if(!vt)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function rn(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,h=0;if(o)for(var x=s.child;x!==null;)u|=x.lanes|x.childLanes,h|=x.subtreeFlags&65011712,h|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)u|=x.lanes|x.childLanes,h|=x.subtreeFlags,h|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=h,s.childLanes=u,o}function YA(s,o,u){var h=o.pendingProps;switch(vn(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rn(o),null;case 1:return rn(o),null;case 3:return u=o.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),Go(In),xe(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(js(o)?Yo(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Zu())),rn(o),null;case 26:var x=o.type,w=o.memoizedState;return s===null?(Yo(o),w!==null?(rn(o),av(o,w)):(rn(o),Mm(o,x,null,h,u))):w?w!==s.memoizedState?(Yo(o),rn(o),av(o,w)):(rn(o),o.flags&=-16777217):(s=s.memoizedProps,s!==h&&Yo(o),rn(o),Mm(o,x,s,h,u)),null;case 27:if(mt(o),u=be.current,x=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==h&&Yo(o);else{if(!h){if(o.stateNode===null)throw Error(i(166));return rn(o),null}s=ae.current,js(o)?Ku(o):(s=m0(x,h,u),o.stateNode=s,Yo(o))}return rn(o),null;case 5:if(mt(o),x=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==h&&Yo(o);else{if(!h){if(o.stateNode===null)throw Error(i(166));return rn(o),null}if(w=ae.current,js(o))Ku(o);else{var N=Xd(be.current);switch(w){case 1:w=N.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:w=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":w=N.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":w=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":w=N.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof h.is=="string"?N.createElement("select",{is:h.is}):N.createElement("select"),h.multiple?w.multiple=!0:h.size&&(w.size=h.size);break;default:w=typeof h.is=="string"?N.createElement(x,{is:h.is}):N.createElement(x)}}w[fn]=o,w[_n]=h;e:for(N=o.child;N!==null;){if(N.tag===5||N.tag===6)w.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===o)break e;for(;N.sibling===null;){if(N.return===null||N.return===o)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}o.stateNode=w;e:switch(Xn(w,x,h),x){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Yo(o)}}return rn(o),Mm(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,u),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==h&&Yo(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(i(166));if(s=be.current,js(o)){if(s=o.stateNode,u=o.memoizedProps,h=null,x=Vt,x!==null)switch(x.tag){case 27:case 5:h=x.memoizedProps}s[fn]=o,s=!!(s.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||i0(s.nodeValue,u)),s||vo(o,!0)}else s=Xd(s).createTextNode(h),s[fn]=o,o.stateNode=s}return rn(o),null;case 31:if(u=o.memoizedState,s===null||s.memoizedState!==null){if(h=js(o),u!==null){if(s===null){if(!h)throw Error(i(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[fn]=o}else Ho(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;rn(o),s=!1}else u=Zu(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=u),s=!0;if(!s)return o.flags&256?(as(o),o):(as(o),null);if((o.flags&128)!==0)throw Error(i(558))}return rn(o),null;case 13:if(h=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=js(o),h!==null&&h.dehydrated!==null){if(s===null){if(!x)throw Error(i(318));if(x=o.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(i(317));x[fn]=o}else Ho(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;rn(o),x=!1}else x=Zu(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return o.flags&256?(as(o),o):(as(o),null)}return as(o),(o.flags&128)!==0?(o.lanes=u,o):(u=h!==null,s=s!==null&&s.memoizedState!==null,u&&(h=o.child,x=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(x=h.alternate.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==x&&(h.flags|=2048)),u!==s&&u&&(o.child.flags|=8192),Ud(o,o.updateQueue),rn(o),null);case 4:return xe(),s===null&&Xm(o.stateNode.containerInfo),rn(o),null;case 10:return Go(o.type),rn(o),null;case 19:if(de(En),h=o.memoizedState,h===null)return rn(o),null;if(x=(o.flags&128)!==0,w=h.rendering,w===null)if(x)rc(h,!1);else{if(xn!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(w=Ad(s),w!==null){for(o.flags|=128,rc(h,!1),s=w.updateQueue,o.updateQueue=s,Ud(o,s),o.subtreeFlags=0,s=u,u=o.child;u!==null;)Hu(u,s),u=u.sibling;return Ce(En,En.current&1|2),vt&&He(o,h.treeForkCount),o.child}s=s.sibling}h.tail!==null&&lt()>Hd&&(o.flags|=128,x=!0,rc(h,!1),o.lanes=4194304)}else{if(!x)if(s=Ad(w),s!==null){if(o.flags|=128,x=!0,s=s.updateQueue,o.updateQueue=s,Ud(o,s),rc(h,!0),h.tail===null&&h.tailMode==="hidden"&&!w.alternate&&!vt)return rn(o),null}else 2*lt()-h.renderingStartTime>Hd&&u!==536870912&&(o.flags|=128,x=!0,rc(h,!1),o.lanes=4194304);h.isBackwards?(w.sibling=o.child,o.child=w):(s=h.last,s!==null?s.sibling=w:o.child=w,h.last=w)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=lt(),s.sibling=null,u=En.current,Ce(En,x?u&1|2:u&1),vt&&He(o,h.treeForkCount),s):(rn(o),null);case 22:case 23:return as(o),em(),h=o.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(u&536870912)!==0&&(o.flags&128)===0&&(rn(o),o.subtreeFlags&6&&(o.flags|=8192)):rn(o),u=o.updateQueue,u!==null&&Ud(o,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==u&&(o.flags|=2048),s!==null&&de(Wa),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Go(In),rn(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function WA(s,o){switch(vn(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Go(In),xe(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return mt(o),null;case 31:if(o.memoizedState!==null){if(as(o),o.alternate===null)throw Error(i(340));Ho()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(as(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(i(340));Ho()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return de(En),null;case 4:return xe(),null;case 10:return Go(o.type),null;case 22:case 23:return as(o),em(),s!==null&&de(Wa),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return Go(In),null;case 25:return null;default:return null}}function lv(s,o){switch(vn(o),o.tag){case 3:Go(In),xe();break;case 26:case 27:case 5:mt(o);break;case 4:xe();break;case 31:o.memoizedState!==null&&as(o);break;case 13:as(o);break;case 19:de(En);break;case 10:Go(o.type);break;case 22:case 23:as(o),em(),s!==null&&de(Wa);break;case 24:Go(In)}}function ac(s,o){try{var u=o.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var x=h.next;u=x;do{if((u.tag&s)===s){h=void 0;var w=u.create,N=u.inst;h=w(),N.destroy=h}u=u.next}while(u!==x)}}catch(D){Kt(o,o.return,D)}}function zr(s,o,u){try{var h=o.updateQueue,x=h!==null?h.lastEffect:null;if(x!==null){var w=x.next;h=w;do{if((h.tag&s)===s){var N=h.inst,D=N.destroy;if(D!==void 0){N.destroy=void 0,x=o;var Z=u,oe=D;try{oe()}catch(me){Kt(x,Z,me)}}}h=h.next}while(h!==w)}}catch(me){Kt(o,o.return,me)}}function uv(s){var o=s.updateQueue;if(o!==null){var u=s.stateNode;try{X_(o,u)}catch(h){Kt(s,s.return,h)}}}function cv(s,o,u){u.props=el(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(h){Kt(s,o,h)}}function lc(s,o){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof u=="function"?s.refCleanup=u(h):u.current=h}}catch(x){Kt(s,o,x)}}function xo(s,o){var u=s.ref,h=s.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(x){Kt(s,o,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(x){Kt(s,o,x)}else u.current=null}function dv(s){var o=s.type,u=s.memoizedProps,h=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break e;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(x){Kt(s,s.return,x)}}function Pm(s,o,u){try{var h=s.stateNode;_C(h,s.type,u,o),h[_n]=o}catch(x){Kt(s,s.return,x)}}function hv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Kr(s.type)||s.tag===4}function km(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||hv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Kr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Dm(s,o,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(s),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=si));else if(h!==4&&(h===27&&Kr(s.type)&&(u=s.stateNode,o=null),s=s.child,s!==null))for(Dm(s,o,u),s=s.sibling;s!==null;)Dm(s,o,u),s=s.sibling}function zd(s,o,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(h!==4&&(h===27&&Kr(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(zd(s,o,u),s=s.sibling;s!==null;)zd(s,o,u),s=s.sibling}function fv(s){var o=s.stateNode,u=s.memoizedProps;try{for(var h=s.type,x=o.attributes;x.length;)o.removeAttributeNode(x[0]);Xn(o,h,u),o[fn]=s,o[_n]=u}catch(w){Kt(s,s.return,w)}}var Wo=!1,Mn=!1,Lm=!1,mv=typeof WeakSet=="function"?WeakSet:Set,Zn=null;function JA(s,o){if(s=s.containerInfo,np=rh,s=Ua(s),fo(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var x=h.anchorOffset,w=h.focusNode;h=h.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var N=0,D=-1,Z=-1,oe=0,me=0,Te=s,ue=null;t:for(;;){for(var he;Te!==u||x!==0&&Te.nodeType!==3||(D=N+x),Te!==w||h!==0&&Te.nodeType!==3||(Z=N+h),Te.nodeType===3&&(N+=Te.nodeValue.length),(he=Te.firstChild)!==null;)ue=Te,Te=he;for(;;){if(Te===s)break t;if(ue===u&&++oe===x&&(D=N),ue===w&&++me===h&&(Z=N),(he=Te.nextSibling)!==null)break;Te=ue,ue=Te.parentNode}Te=he}u=D===-1||Z===-1?null:{start:D,end:Z}}else u=null}u=u||{start:0,end:0}}else u=null;for(ip={focusedElem:s,selectionRange:u},rh=!1,Zn=o;Zn!==null;)if(o=Zn,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,Zn=s;else for(;Zn!==null;){switch(o=Zn,w=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(u=0;u<s.length;u++)x=s[u],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&w!==null){s=void 0,u=o,x=w.memoizedProps,w=w.memoizedState,h=u.stateNode;try{var Be=el(u.type,x);s=h.getSnapshotBeforeUpdate(Be,w),h.__reactInternalSnapshotBeforeUpdate=s}catch(Qe){Kt(u,u.return,Qe)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,u=s.nodeType,u===9)rp(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":rp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=o.sibling,s!==null){s.return=o.return,Zn=s;break}Zn=o.return}}function pv(s,o,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:Qo(s,u),h&4&&ac(5,u);break;case 1:if(Qo(s,u),h&4)if(s=u.stateNode,o===null)try{s.componentDidMount()}catch(N){Kt(u,u.return,N)}else{var x=el(u.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(x,o,s.__reactInternalSnapshotBeforeUpdate)}catch(N){Kt(u,u.return,N)}}h&64&&uv(u),h&512&&lc(u,u.return);break;case 3:if(Qo(s,u),h&64&&(s=u.updateQueue,s!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{X_(s,o)}catch(N){Kt(u,u.return,N)}}break;case 27:o===null&&h&4&&fv(u);case 26:case 5:Qo(s,u),o===null&&h&4&&dv(u),h&512&&lc(u,u.return);break;case 12:Qo(s,u);break;case 31:Qo(s,u),h&4&&yv(s,u);break;case 13:Qo(s,u),h&4&&vv(s,u),h&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=oC.bind(null,u),AC(s,u))));break;case 22:if(h=u.memoizedState!==null||Wo,!h){o=o!==null&&o.memoizedState!==null||Mn,x=Wo;var w=Mn;Wo=h,(Mn=o)&&!w?$o(s,u,(u.subtreeFlags&8772)!==0):Qo(s,u),Wo=x,Mn=w}break;case 30:break;default:Qo(s,u)}}function gv(s){var o=s.alternate;o!==null&&(s.alternate=null,gv(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&pr(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var dn=null,Bi=!1;function Jo(s,o,u){for(u=u.child;u!==null;)_v(s,o,u),u=u.sibling}function _v(s,o,u){if($e&&typeof $e.onCommitFiberUnmount=="function")try{$e.onCommitFiberUnmount(Re,u)}catch{}switch(u.tag){case 26:Mn||xo(u,o),Jo(s,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Mn||xo(u,o);var h=dn,x=Bi;Kr(u.type)&&(dn=u.stateNode,Bi=!1),Jo(s,o,u),_c(u.stateNode),dn=h,Bi=x;break;case 5:Mn||xo(u,o);case 6:if(h=dn,x=Bi,dn=null,Jo(s,o,u),dn=h,Bi=x,dn!==null)if(Bi)try{(dn.nodeType===9?dn.body:dn.nodeName==="HTML"?dn.ownerDocument.body:dn).removeChild(u.stateNode)}catch(w){Kt(u,o,w)}else try{dn.removeChild(u.stateNode)}catch(w){Kt(u,o,w)}break;case 18:dn!==null&&(Bi?(s=dn,u0(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),iu(s)):u0(dn,u.stateNode));break;case 4:h=dn,x=Bi,dn=u.stateNode.containerInfo,Bi=!0,Jo(s,o,u),dn=h,Bi=x;break;case 0:case 11:case 14:case 15:zr(2,u,o),Mn||zr(4,u,o),Jo(s,o,u);break;case 1:Mn||(xo(u,o),h=u.stateNode,typeof h.componentWillUnmount=="function"&&cv(u,o,h)),Jo(s,o,u);break;case 21:Jo(s,o,u);break;case 22:Mn=(h=Mn)||u.memoizedState!==null,Jo(s,o,u),Mn=h;break;default:Jo(s,o,u)}}function yv(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{iu(s)}catch(u){Kt(o,o.return,u)}}}function vv(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{iu(s)}catch(u){Kt(o,o.return,u)}}function QA(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new mv),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new mv),o;default:throw Error(i(435,s.tag))}}function Bd(s,o){var u=QA(s);o.forEach(function(h){if(!u.has(h)){u.add(h);var x=rC.bind(null,s,h);h.then(x,x)}})}function Fi(s,o){var u=o.deletions;if(u!==null)for(var h=0;h<u.length;h++){var x=u[h],w=s,N=o,D=N;e:for(;D!==null;){switch(D.tag){case 27:if(Kr(D.type)){dn=D.stateNode,Bi=!1;break e}break;case 5:dn=D.stateNode,Bi=!1;break e;case 3:case 4:dn=D.stateNode.containerInfo,Bi=!0;break e}D=D.return}if(dn===null)throw Error(i(160));_v(w,N,x),dn=null,Bi=!1,w=x.alternate,w!==null&&(w.return=null),x.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Tv(o,s),o=o.sibling}var Zs=null;function Tv(s,o){var u=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Fi(o,s),qi(s),h&4&&(zr(3,s,s.return),ac(3,s),zr(5,s,s.return));break;case 1:Fi(o,s),qi(s),h&512&&(Mn||u===null||xo(u,u.return)),h&64&&Wo&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var x=Zs;if(Fi(o,s),qi(s),h&512&&(Mn||u===null||xo(u,u.return)),h&4){var w=u!==null?u.memoizedState:null;if(h=s.memoizedState,u===null)if(h===null)if(s.stateNode===null){e:{h=s.type,u=s.memoizedProps,x=x.ownerDocument||x;t:switch(h){case"title":w=x.getElementsByTagName("title")[0],(!w||w[ms]||w[fn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=x.createElement(h),x.head.insertBefore(w,x.querySelector("head > title"))),Xn(w,h,u),w[fn]=s,yn(w),h=w;break e;case"link":var N=T0("link","href",x).get(h+(u.href||""));if(N){for(var D=0;D<N.length;D++)if(w=N[D],w.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&w.getAttribute("rel")===(u.rel==null?null:u.rel)&&w.getAttribute("title")===(u.title==null?null:u.title)&&w.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){N.splice(D,1);break t}}w=x.createElement(h),Xn(w,h,u),x.head.appendChild(w);break;case"meta":if(N=T0("meta","content",x).get(h+(u.content||""))){for(D=0;D<N.length;D++)if(w=N[D],w.getAttribute("content")===(u.content==null?null:""+u.content)&&w.getAttribute("name")===(u.name==null?null:u.name)&&w.getAttribute("property")===(u.property==null?null:u.property)&&w.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&w.getAttribute("charset")===(u.charSet==null?null:u.charSet)){N.splice(D,1);break t}}w=x.createElement(h),Xn(w,h,u),x.head.appendChild(w);break;default:throw Error(i(468,h))}w[fn]=s,yn(w),h=w}s.stateNode=h}else x0(x,s.type,s.stateNode);else s.stateNode=v0(x,h,s.memoizedProps);else w!==h?(w===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):w.count--,h===null?x0(x,s.type,s.stateNode):v0(x,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Pm(s,s.memoizedProps,u.memoizedProps)}break;case 27:Fi(o,s),qi(s),h&512&&(Mn||u===null||xo(u,u.return)),u!==null&&h&4&&Pm(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Fi(o,s),qi(s),h&512&&(Mn||u===null||xo(u,u.return)),s.flags&32){x=s.stateNode;try{Cn(x,"")}catch(Be){Kt(s,s.return,Be)}}h&4&&s.stateNode!=null&&(x=s.memoizedProps,Pm(s,x,u!==null?u.memoizedProps:x)),h&1024&&(Lm=!0);break;case 6:if(Fi(o,s),qi(s),h&4){if(s.stateNode===null)throw Error(i(162));h=s.memoizedProps,u=s.stateNode;try{u.nodeValue=h}catch(Be){Kt(s,s.return,Be)}}break;case 3:if(nh=null,x=Zs,Zs=eh(o.containerInfo),Fi(o,s),Zs=x,qi(s),h&4&&u!==null&&u.memoizedState.isDehydrated)try{iu(o.containerInfo)}catch(Be){Kt(s,s.return,Be)}Lm&&(Lm=!1,xv(s));break;case 4:h=Zs,Zs=eh(s.stateNode.containerInfo),Fi(o,s),qi(s),Zs=h;break;case 12:Fi(o,s),qi(s);break;case 31:Fi(o,s),qi(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Bd(s,h)));break;case 13:Fi(o,s),qi(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(qd=lt()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Bd(s,h)));break;case 22:x=s.memoizedState!==null;var Z=u!==null&&u.memoizedState!==null,oe=Wo,me=Mn;if(Wo=oe||x,Mn=me||Z,Fi(o,s),Mn=me,Wo=oe,qi(s),h&8192)e:for(o=s.stateNode,o._visibility=x?o._visibility&-2:o._visibility|1,x&&(u===null||Z||Wo||Mn||tl(s)),u=null,o=s;;){if(o.tag===5||o.tag===26){if(u===null){Z=u=o;try{if(w=Z.stateNode,x)N=w.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{D=Z.stateNode;var Te=Z.memoizedProps.style,ue=Te!=null&&Te.hasOwnProperty("display")?Te.display:null;D.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(Be){Kt(Z,Z.return,Be)}}}else if(o.tag===6){if(u===null){Z=o;try{Z.stateNode.nodeValue=x?"":Z.memoizedProps}catch(Be){Kt(Z,Z.return,Be)}}}else if(o.tag===18){if(u===null){Z=o;try{var he=Z.stateNode;x?c0(he,!0):c0(Z.stateNode,!1)}catch(Be){Kt(Z,Z.return,Be)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=s.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,Bd(s,u))));break;case 19:Fi(o,s),qi(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Bd(s,h)));break;case 30:break;case 21:break;default:Fi(o,s),qi(s)}}function qi(s){var o=s.flags;if(o&2){try{for(var u,h=s.return;h!==null;){if(hv(h)){u=h;break}h=h.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var x=u.stateNode,w=km(s);zd(s,w,x);break;case 5:var N=u.stateNode;u.flags&32&&(Cn(N,""),u.flags&=-33);var D=km(s);zd(s,D,N);break;case 3:case 4:var Z=u.stateNode.containerInfo,oe=km(s);Dm(s,oe,Z);break;default:throw Error(i(161))}}catch(me){Kt(s,s.return,me)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function xv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;xv(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Qo(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)pv(s,o.alternate,o),o=o.sibling}function tl(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:zr(4,o,o.return),tl(o);break;case 1:xo(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&cv(o,o.return,u),tl(o);break;case 27:_c(o.stateNode);case 26:case 5:xo(o,o.return),tl(o);break;case 22:o.memoizedState===null&&tl(o);break;case 30:tl(o);break;default:tl(o)}s=s.sibling}}function $o(s,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,x=s,w=o,N=w.flags;switch(w.tag){case 0:case 11:case 15:$o(x,w,u),ac(4,w);break;case 1:if($o(x,w,u),h=w,x=h.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(oe){Kt(h,h.return,oe)}if(h=w,x=h.updateQueue,x!==null){var D=h.stateNode;try{var Z=x.shared.hiddenCallbacks;if(Z!==null)for(x.shared.hiddenCallbacks=null,x=0;x<Z.length;x++)$_(Z[x],D)}catch(oe){Kt(h,h.return,oe)}}u&&N&64&&uv(w),lc(w,w.return);break;case 27:fv(w);case 26:case 5:$o(x,w,u),u&&h===null&&N&4&&dv(w),lc(w,w.return);break;case 12:$o(x,w,u);break;case 31:$o(x,w,u),u&&N&4&&yv(x,w);break;case 13:$o(x,w,u),u&&N&4&&vv(x,w);break;case 22:w.memoizedState===null&&$o(x,w,u),lc(w,w.return);break;case 30:break;default:$o(x,w,u)}o=o.sibling}}function Vm(s,o){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Yu(u))}function Om(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Yu(s))}function Ys(s,o,u,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Ev(s,o,u,h),o=o.sibling}function Ev(s,o,u,h){var x=o.flags;switch(o.tag){case 0:case 11:case 15:Ys(s,o,u,h),x&2048&&ac(9,o);break;case 1:Ys(s,o,u,h);break;case 3:Ys(s,o,u,h),x&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Yu(s)));break;case 12:if(x&2048){Ys(s,o,u,h),s=o.stateNode;try{var w=o.memoizedProps,N=w.id,D=w.onPostCommit;typeof D=="function"&&D(N,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Z){Kt(o,o.return,Z)}}else Ys(s,o,u,h);break;case 31:Ys(s,o,u,h);break;case 13:Ys(s,o,u,h);break;case 23:break;case 22:w=o.stateNode,N=o.alternate,o.memoizedState!==null?w._visibility&2?Ys(s,o,u,h):uc(s,o):w._visibility&2?Ys(s,o,u,h):(w._visibility|=2,Kl(s,o,u,h,(o.subtreeFlags&10256)!==0||!1)),x&2048&&Vm(N,o);break;case 24:Ys(s,o,u,h),x&2048&&Om(o.alternate,o);break;default:Ys(s,o,u,h)}}function Kl(s,o,u,h,x){for(x=x&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var w=s,N=o,D=u,Z=h,oe=N.flags;switch(N.tag){case 0:case 11:case 15:Kl(w,N,D,Z,x),ac(8,N);break;case 23:break;case 22:var me=N.stateNode;N.memoizedState!==null?me._visibility&2?Kl(w,N,D,Z,x):uc(w,N):(me._visibility|=2,Kl(w,N,D,Z,x)),x&&oe&2048&&Vm(N.alternate,N);break;case 24:Kl(w,N,D,Z,x),x&&oe&2048&&Om(N.alternate,N);break;default:Kl(w,N,D,Z,x)}o=o.sibling}}function uc(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=s,h=o,x=h.flags;switch(h.tag){case 22:uc(u,h),x&2048&&Vm(h.alternate,h);break;case 24:uc(u,h),x&2048&&Om(h.alternate,h);break;default:uc(u,h)}o=o.sibling}}var cc=8192;function Zl(s,o,u){if(s.subtreeFlags&cc)for(s=s.child;s!==null;)wv(s,o,u),s=s.sibling}function wv(s,o,u){switch(s.tag){case 26:Zl(s,o,u),s.flags&cc&&s.memoizedState!==null&&OC(u,Zs,s.memoizedState,s.memoizedProps);break;case 5:Zl(s,o,u);break;case 3:case 4:var h=Zs;Zs=eh(s.stateNode.containerInfo),Zl(s,o,u),Zs=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=cc,cc=16777216,Zl(s,o,u),cc=h):Zl(s,o,u));break;default:Zl(s,o,u)}}function Sv(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function dc(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var h=o[u];Zn=h,Cv(h,s)}Sv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Av(s),s=s.sibling}function Av(s){switch(s.tag){case 0:case 11:case 15:dc(s),s.flags&2048&&zr(9,s,s.return);break;case 3:dc(s);break;case 12:dc(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Fd(s)):dc(s);break;default:dc(s)}}function Fd(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var h=o[u];Zn=h,Cv(h,s)}Sv(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:zr(8,o,o.return),Fd(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,Fd(o));break;default:Fd(o)}s=s.sibling}}function Cv(s,o){for(;Zn!==null;){var u=Zn;switch(u.tag){case 0:case 11:case 15:zr(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Yu(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,Zn=h;else e:for(u=s;Zn!==null;){h=Zn;var x=h.sibling,w=h.return;if(gv(h),h===u){Zn=null;break e}if(x!==null){x.return=w,Zn=x;break e}Zn=w}}}var $A={getCacheForType:function(s){var o=Qn(In),u=o.data.get(s);return u===void 0&&(u=s(),o.data.set(s,u)),u},cacheSignal:function(){return Qn(In).controller.signal}},XA=typeof WeakMap=="function"?WeakMap:Map,Ft=0,$t=null,Tt=null,St=0,jt=0,ls=null,Br=!1,Yl=!1,Um=!1,Xo=0,xn=0,Fr=0,nl=0,zm=0,us=0,Wl=0,hc=null,Hi=null,Bm=!1,qd=0,bv=0,Hd=1/0,Gd=null,qr=null,Vn=0,Hr=null,Jl=null,er=0,Fm=0,qm=null,Iv=null,fc=0,Hm=null;function cs(){return(Ft&2)!==0&&St!==0?St&-St:ne.T!==null?Wm():Sa()}function Nv(){if(us===0)if((St&536870912)===0||vt){var s=Zi;Zi<<=1,(Zi&3932160)===0&&(Zi=262144),us=s}else us=536870912;return s=rs.current,s!==null&&(s.flags|=32),us}function Gi(s,o,u){(s===$t&&(jt===2||jt===9)||s.cancelPendingCommit!==null)&&(Ql(s,0),Gr(s,St,us,!1)),Ds(s,u),((Ft&2)===0||s!==$t)&&(s===$t&&((Ft&2)===0&&(nl|=u),xn===4&&Gr(s,St,us,!1)),Eo(s))}function Rv(s,o,u){if((Ft&6)!==0)throw Error(i(327));var h=!u&&(o&127)===0&&(o&s.expiredLanes)===0||Yi(s,o),x=h?nC(s,o):jm(s,o,!0),w=h;do{if(x===0){Yl&&!h&&Gr(s,o,0,!1);break}else{if(u=s.current.alternate,w&&!eC(u)){x=jm(s,o,!1),w=!1;continue}if(x===2){if(w=o,s.errorRecoveryDisabledLanes&w)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){o=N;e:{var D=s;x=hc;var Z=D.current.memoizedState.isDehydrated;if(Z&&(Ql(D,N).flags|=256),N=jm(D,N,!1),N!==2){if(Um&&!Z){D.errorRecoveryDisabledLanes|=w,nl|=w,x=4;break e}w=Hi,Hi=x,w!==null&&(Hi===null?Hi=w:Hi.push.apply(Hi,w))}x=N}if(w=!1,x!==2)continue}}if(x===1){Ql(s,0),Gr(s,o,0,!0);break}e:{switch(h=s,w=x,w){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:Gr(h,o,us,!Br);break e;case 2:Hi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(x=qd+300-lt(),10<x)){if(Gr(h,o,us,!Br),zn(h,0,!0)!==0)break e;er=o,h.timeoutHandle=a0(Mv.bind(null,h,u,Hi,Gd,Bm,o,us,nl,Wl,Br,w,"Throttled",-0,0),x);break e}Mv(h,u,Hi,Gd,Bm,o,us,nl,Wl,Br,w,null,-0,0)}}break}while(!0);Eo(s)}function Mv(s,o,u,h,x,w,N,D,Z,oe,me,Te,ue,he){if(s.timeoutHandle=-1,Te=o.subtreeFlags,Te&8192||(Te&16785408)===16785408){Te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:si},wv(o,w,Te);var Be=(w&62914560)===w?qd-lt():(w&4194048)===w?bv-lt():0;if(Be=UC(Te,Be),Be!==null){er=w,s.cancelPendingCommit=Be(zv.bind(null,s,o,w,u,h,x,N,D,Z,me,Te,null,ue,he)),Gr(s,w,N,!oe);return}}zv(s,o,w,u,h,x,N,D,Z)}function eC(s){for(var o=s;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var x=u[h],w=x.getSnapshot;x=x.value;try{if(!jn(w(),x))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Gr(s,o,u,h){o&=~zm,o&=~nl,s.suspendedLanes|=o,s.pingedLanes&=~o,h&&(s.warmLanes|=o),h=s.expirationTimes;for(var x=o;0<x;){var w=31-ut(x),N=1<<w;h[w]=-1,x&=~N}u!==0&&Po(s,u,o)}function jd(){return(Ft&6)===0?(mc(0),!1):!0}function Gm(){if(Tt!==null){if(jt===0)var s=Tt.return;else s=Tt,Ks=To=null,rm(s),Fl=null,Ju=0,s=Tt;for(;s!==null;)lv(s.alternate,s),s=s.return;Tt=null}}function Ql(s,o){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,TC(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),er=0,Gm(),$t=s,Tt=u=Cs(s.current,null),St=o,jt=0,ls=null,Br=!1,Yl=Yi(s,o),Um=!1,Wl=us=zm=nl=Fr=xn=0,Hi=hc=null,Bm=!1,(o&8)!==0&&(o|=o&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=o;0<h;){var x=31-ut(h),w=1<<x;o|=s[x],h&=~w}return Xo=o,Ha(),u}function Pv(s,o){at=null,ne.H=sc,o===Bl||o===Td?(o=Y_(),jt=3):o===Yf?(o=Y_(),jt=4):jt=o===Em?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,ls=o,Tt===null&&(xn=1,Dd(s,d(o,s.current)))}function kv(){var s=rs.current;return s===null?!0:(St&4194048)===St?bs===null:(St&62914560)===St||(St&536870912)!==0?s===bs:!1}function Dv(){var s=ne.H;return ne.H=sc,s===null?sc:s}function Lv(){var s=ne.A;return ne.A=$A,s}function Kd(){xn=4,Br||(St&4194048)!==St&&rs.current!==null||(Yl=!0),(Fr&134217727)===0&&(nl&134217727)===0||$t===null||Gr($t,St,us,!1)}function jm(s,o,u){var h=Ft;Ft|=2;var x=Dv(),w=Lv();($t!==s||St!==o)&&(Gd=null,Ql(s,o)),o=!1;var N=xn;e:do try{if(jt!==0&&Tt!==null){var D=Tt,Z=ls;switch(jt){case 8:Gm(),N=6;break e;case 3:case 2:case 9:case 6:rs.current===null&&(o=!0);var oe=jt;if(jt=0,ls=null,$l(s,D,Z,oe),u&&Yl){N=0;break e}break;default:oe=jt,jt=0,ls=null,$l(s,D,Z,oe)}}tC(),N=xn;break}catch(me){Pv(s,me)}while(!0);return o&&s.shellSuspendCounter++,Ks=To=null,Ft=h,ne.H=x,ne.A=w,Tt===null&&($t=null,St=0,Ha()),N}function tC(){for(;Tt!==null;)Vv(Tt)}function nC(s,o){var u=Ft;Ft|=2;var h=Dv(),x=Lv();$t!==s||St!==o?(Gd=null,Hd=lt()+500,Ql(s,o)):Yl=Yi(s,o);e:do try{if(jt!==0&&Tt!==null){o=Tt;var w=ls;t:switch(jt){case 1:jt=0,ls=null,$l(s,o,w,1);break;case 2:case 9:if(K_(w)){jt=0,ls=null,Ov(o);break}o=function(){jt!==2&&jt!==9||$t!==s||(jt=7),Eo(s)},w.then(o,o);break e;case 3:jt=7;break e;case 4:jt=5;break e;case 7:K_(w)?(jt=0,ls=null,Ov(o)):(jt=0,ls=null,$l(s,o,w,7));break;case 5:var N=null;switch(Tt.tag){case 26:N=Tt.memoizedState;case 5:case 27:var D=Tt;if(N?E0(N):D.stateNode.complete){jt=0,ls=null;var Z=D.sibling;if(Z!==null)Tt=Z;else{var oe=D.return;oe!==null?(Tt=oe,Zd(oe)):Tt=null}break t}}jt=0,ls=null,$l(s,o,w,5);break;case 6:jt=0,ls=null,$l(s,o,w,6);break;case 8:Gm(),xn=6;break e;default:throw Error(i(462))}}iC();break}catch(me){Pv(s,me)}while(!0);return Ks=To=null,ne.H=h,ne.A=x,Ft=u,Tt!==null?0:($t=null,St=0,Ha(),xn)}function iC(){for(;Tt!==null&&!Ge();)Vv(Tt)}function Vv(s){var o=rv(s.alternate,s,Xo);s.memoizedProps=s.pendingProps,o===null?Zd(s):Tt=o}function Ov(s){var o=s,u=o.alternate;switch(o.tag){case 15:case 0:o=ev(u,o,o.pendingProps,o.type,void 0,St);break;case 11:o=ev(u,o,o.pendingProps,o.type.render,o.ref,St);break;case 5:rm(o);default:lv(u,o),o=Tt=Hu(o,Xo),o=rv(u,o,Xo)}s.memoizedProps=s.pendingProps,o===null?Zd(s):Tt=o}function $l(s,o,u,h){Ks=To=null,rm(o),Fl=null,Ju=0;var x=o.return;try{if(jA(s,x,o,u,St)){xn=1,Dd(s,d(u,s.current)),Tt=null;return}}catch(w){if(x!==null)throw Tt=x,w;xn=1,Dd(s,d(u,s.current)),Tt=null;return}o.flags&32768?(vt||h===1?s=!0:Yl||(St&536870912)!==0?s=!1:(Br=s=!0,(h===2||h===9||h===3||h===6)&&(h=rs.current,h!==null&&h.tag===13&&(h.flags|=16384))),Uv(o,s)):Zd(o)}function Zd(s){var o=s;do{if((o.flags&32768)!==0){Uv(o,Br);return}s=o.return;var u=YA(o.alternate,o,Xo);if(u!==null){Tt=u;return}if(o=o.sibling,o!==null){Tt=o;return}Tt=o=s}while(o!==null);xn===0&&(xn=5)}function Uv(s,o){do{var u=WA(s.alternate,s);if(u!==null){u.flags&=32767,Tt=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(s=s.sibling,s!==null)){Tt=s;return}Tt=s=u}while(s!==null);xn=6,Tt=null}function zv(s,o,u,h,x,w,N,D,Z){s.cancelPendingCommit=null;do Yd();while(Vn!==0);if((Ft&6)!==0)throw Error(i(327));if(o!==null){if(o===s.current)throw Error(i(177));if(w=o.lanes|o.childLanes,w|=kl,Fu(s,u,w,N,D,Z),s===$t&&(Tt=$t=null,St=0),Jl=o,Hr=s,er=u,Fm=w,qm=x,Iv=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,aC(cn,function(){return Gv(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=ne.T,ne.T=null,x=Ae.p,Ae.p=2,N=Ft,Ft|=4;try{JA(s,o,u)}finally{Ft=N,Ae.p=x,ne.T=h}}Vn=1,Bv(),Fv(),qv()}}function Bv(){if(Vn===1){Vn=0;var s=Hr,o=Jl,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=ne.T,ne.T=null;var h=Ae.p;Ae.p=2;var x=Ft;Ft|=4;try{Tv(o,s);var w=ip,N=Ua(s.containerInfo),D=w.focusedElem,Z=w.selectionRange;if(N!==D&&D&&D.ownerDocument&&Nl(D.ownerDocument.documentElement,D)){if(Z!==null&&fo(D)){var oe=Z.start,me=Z.end;if(me===void 0&&(me=oe),"selectionStart"in D)D.selectionStart=oe,D.selectionEnd=Math.min(me,D.value.length);else{var Te=D.ownerDocument||document,ue=Te&&Te.defaultView||window;if(ue.getSelection){var he=ue.getSelection(),Be=D.textContent.length,Qe=Math.min(Z.start,Be),Wt=Z.end===void 0?Qe:Math.min(Z.end,Be);!he.extend&&Qe>Wt&&(N=Wt,Wt=Qe,Qe=N);var $=Oa(D,Qe),Q=Oa(D,Wt);if($&&Q&&(he.rangeCount!==1||he.anchorNode!==$.node||he.anchorOffset!==$.offset||he.focusNode!==Q.node||he.focusOffset!==Q.offset)){var se=Te.createRange();se.setStart($.node,$.offset),he.removeAllRanges(),Qe>Wt?(he.addRange(se),he.extend(Q.node,Q.offset)):(se.setEnd(Q.node,Q.offset),he.addRange(se))}}}}for(Te=[],he=D;he=he.parentNode;)he.nodeType===1&&Te.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<Te.length;D++){var _e=Te[D];_e.element.scrollLeft=_e.left,_e.element.scrollTop=_e.top}}rh=!!np,ip=np=null}finally{Ft=x,Ae.p=h,ne.T=u}}s.current=o,Vn=2}}function Fv(){if(Vn===2){Vn=0;var s=Hr,o=Jl,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=ne.T,ne.T=null;var h=Ae.p;Ae.p=2;var x=Ft;Ft|=4;try{pv(s,o.alternate,o)}finally{Ft=x,Ae.p=h,ne.T=u}}Vn=3}}function qv(){if(Vn===4||Vn===3){Vn=0,gt();var s=Hr,o=Jl,u=er,h=Iv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Vn=5:(Vn=0,Jl=Hr=null,Hv(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(qr=null),Ue(u),o=o.stateNode,$e&&typeof $e.onCommitFiberRoot=="function")try{$e.onCommitFiberRoot(Re,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=ne.T,x=Ae.p,Ae.p=2,ne.T=null;try{for(var w=s.onRecoverableError,N=0;N<h.length;N++){var D=h[N];w(D.value,{componentStack:D.stack})}}finally{ne.T=o,Ae.p=x}}(er&3)!==0&&Yd(),Eo(s),x=s.pendingLanes,(u&261930)!==0&&(x&42)!==0?s===Hm?fc++:(fc=0,Hm=s):fc=0,mc(0)}}function Hv(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Yu(o)))}function Yd(){return Bv(),Fv(),qv(),Gv()}function Gv(){if(Vn!==5)return!1;var s=Hr,o=Fm;Fm=0;var u=Ue(er),h=ne.T,x=Ae.p;try{Ae.p=32>u?32:u,ne.T=null,u=qm,qm=null;var w=Hr,N=er;if(Vn=0,Jl=Hr=null,er=0,(Ft&6)!==0)throw Error(i(331));var D=Ft;if(Ft|=4,Av(w.current),Ev(w,w.current,N,u),Ft=D,mc(0,!1),$e&&typeof $e.onPostCommitFiberRoot=="function")try{$e.onPostCommitFiberRoot(Re,w)}catch{}return!0}finally{Ae.p=x,ne.T=h,Hv(s,o)}}function jv(s,o,u){o=d(u,o),o=xm(s.stateNode,o,2),s=Vr(s,o,2),s!==null&&(Ds(s,2),Eo(s))}function Kt(s,o,u){if(s.tag===3)jv(s,s,u);else for(;o!==null;){if(o.tag===3){jv(o,s,u);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(qr===null||!qr.has(h))){s=d(u,s),u=Ky(2),h=Vr(o,u,2),h!==null&&(Zy(u,h,o,s),Ds(h,2),Eo(h));break}}o=o.return}}function Km(s,o,u){var h=s.pingCache;if(h===null){h=s.pingCache=new XA;var x=new Set;h.set(o,x)}else x=h.get(o),x===void 0&&(x=new Set,h.set(o,x));x.has(u)||(Um=!0,x.add(u),s=sC.bind(null,s,o,u),o.then(s,s))}function sC(s,o,u){var h=s.pingCache;h!==null&&h.delete(o),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,$t===s&&(St&u)===u&&(xn===4||xn===3&&(St&62914560)===St&&300>lt()-qd?(Ft&2)===0&&Ql(s,0):zm|=u,Wl===St&&(Wl=0)),Eo(s)}function Kv(s,o){o===0&&(o=Tl()),s=As(s,o),s!==null&&(Ds(s,o),Eo(s))}function oC(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),Kv(s,u)}function rC(s,o){var u=0;switch(s.tag){case 31:case 13:var h=s.stateNode,x=s.memoizedState;x!==null&&(u=x.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(o),Kv(s,u)}function aC(s,o){return ye(s,o)}var Wd=null,Xl=null,Zm=!1,Jd=!1,Ym=!1,jr=0;function Eo(s){s!==Xl&&s.next===null&&(Xl===null?Wd=Xl=s:Xl=Xl.next=s),Jd=!0,Zm||(Zm=!0,uC())}function mc(s,o){if(!Ym&&Jd){Ym=!0;do for(var u=!1,h=Wd;h!==null;){if(s!==0){var x=h.pendingLanes;if(x===0)var w=0;else{var N=h.suspendedLanes,D=h.pingedLanes;w=(1<<31-ut(42|s)+1)-1,w&=x&~(N&~D),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(u=!0,Jv(h,w))}else w=St,w=zn(h,h===$t?w:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(w&3)===0||Yi(h,w)||(u=!0,Jv(h,w));h=h.next}while(u);Ym=!1}}function lC(){Zv()}function Zv(){Jd=Zm=!1;var s=0;jr!==0&&vC()&&(s=jr);for(var o=lt(),u=null,h=Wd;h!==null;){var x=h.next,w=Yv(h,o);w===0?(h.next=null,u===null?Wd=x:u.next=x,x===null&&(Xl=u)):(u=h,(s!==0||(w&3)!==0)&&(Jd=!0)),h=x}Vn!==0&&Vn!==5||mc(s),jr!==0&&(jr=0)}function Yv(s,o){for(var u=s.suspendedLanes,h=s.pingedLanes,x=s.expirationTimes,w=s.pendingLanes&-62914561;0<w;){var N=31-ut(w),D=1<<N,Z=x[N];Z===-1?((D&u)===0||(D&h)!==0)&&(x[N]=Bu(D,o)):Z<=o&&(s.expiredLanes|=D),w&=~D}if(o=$t,u=St,u=zn(s,s===o?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,u===0||s===o&&(jt===2||jt===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&Pe(h),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||Yi(s,u)){if(o=u&-u,o===s.callbackPriority)return o;switch(h!==null&&Pe(h),Ue(u)){case 2:case 8:u=ii;break;case 32:u=cn;break;case 268435456:u=io;break;default:u=cn}return h=Wv.bind(null,s),u=ye(u,h),s.callbackPriority=o,s.callbackNode=u,o}return h!==null&&h!==null&&Pe(h),s.callbackPriority=2,s.callbackNode=null,2}function Wv(s,o){if(Vn!==0&&Vn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(Yd()&&s.callbackNode!==u)return null;var h=St;return h=zn(s,s===$t?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(Rv(s,h,o),Yv(s,lt()),s.callbackNode!=null&&s.callbackNode===u?Wv.bind(null,s):null)}function Jv(s,o){if(Yd())return null;Rv(s,o,!0)}function uC(){xC(function(){(Ft&6)!==0?ye(Ai,lC):Zv()})}function Wm(){if(jr===0){var s=Ul;s===0&&(s=Jn,Jn<<=1,(Jn&261888)===0&&(Jn=256)),jr=s}return jr}function Qv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ao(""+s)}function $v(s,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,s.id&&u.setAttribute("form",s.id),o.parentNode.insertBefore(u,o),s=new FormData(s),u.parentNode.removeChild(u),s}function cC(s,o,u,h,x){if(o==="submit"&&u&&u.stateNode===x){var w=Qv((x[_n]||null).action),N=h.submitter;N&&(o=(o=N[_n]||null)?Qv(o.formAction):N.getAttribute("formAction"),o!==null&&(w=o,N=null));var D=new xs("action","action",null,h,x);s.push({event:D,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(jr!==0){var Z=N?$v(x,N):new FormData(x);pm(u,{pending:!0,data:Z,method:x.method,action:w},null,Z)}}else typeof w=="function"&&(D.preventDefault(),Z=N?$v(x,N):new FormData(x),pm(u,{pending:!0,data:Z,method:x.method,action:w},w,Z))},currentTarget:x}]})}}for(var Jm=0;Jm<go.length;Jm++){var Qm=go[Jm],dC=Qm.toLowerCase(),hC=Qm[0].toUpperCase()+Qm.slice(1);Oi(dC,"on"+hC)}Oi(Ba,"onAnimationEnd"),Oi(md,"onAnimationIteration"),Oi(Fa,"onAnimationStart"),Oi("dblclick","onDoubleClick"),Oi("focusin","onFocus"),Oi("focusout","onBlur"),Oi(Bf,"onTransitionRun"),Oi(pd,"onTransitionStart"),Oi(Ff,"onTransitionCancel"),Oi(Mr,"onTransitionEnd"),Mi("onMouseEnter",["mouseout","mouseover"]),Mi("onMouseLeave",["mouseout","mouseover"]),Mi("onPointerEnter",["pointerout","pointerover"]),Mi("onPointerLeave",["pointerout","pointerover"]),gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),gs("onBeforeInput",["compositionend","keypress","textInput","paste"]),gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pc));function Xv(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var h=s[u],x=h.event;h=h.listeners;e:{var w=void 0;if(o)for(var N=h.length-1;0<=N;N--){var D=h[N],Z=D.instance,oe=D.currentTarget;if(D=D.listener,Z!==w&&x.isPropagationStopped())break e;w=D,x.currentTarget=oe;try{w(x)}catch(me){qa(me)}x.currentTarget=null,w=Z}else for(N=0;N<h.length;N++){if(D=h[N],Z=D.instance,oe=D.currentTarget,D=D.listener,Z!==w&&x.isPropagationStopped())break e;w=D,x.currentTarget=oe;try{w(x)}catch(me){qa(me)}x.currentTarget=null,w=Z}}}}function xt(s,o){var u=o[Ji];u===void 0&&(u=o[Ji]=new Set);var h=s+"__bubble";u.has(h)||(e0(o,s,2,!1),u.add(h))}function $m(s,o,u){var h=0;o&&(h|=4),e0(u,s,h,o)}var Qd="_reactListening"+Math.random().toString(36).slice(2);function Xm(s){if(!s[Qd]){s[Qd]=!0,Aa.forEach(function(u){u!=="selectionchange"&&(fC.has(u)||$m(u,!1,s),$m(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Qd]||(o[Qd]=!0,$m("selectionchange",!1,o))}}function e0(s,o,u,h){switch(N0(o)){case 2:var x=FC;break;case 8:x=qC;break;default:x=mp}u=x.bind(null,o,u,s),x=void 0,!Us||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),h?x!==void 0?s.addEventListener(o,u,{capture:!0,passive:x}):s.addEventListener(o,u,!0):x!==void 0?s.addEventListener(o,u,{passive:x}):s.addEventListener(o,u,!1)}function ep(s,o,u,h,x){var w=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var N=h.tag;if(N===3||N===4){var D=h.stateNode.containerInfo;if(D===x)break;if(N===4)for(N=h.return;N!==null;){var Z=N.tag;if((Z===3||Z===4)&&N.stateNode.containerInfo===x)return;N=N.return}for(;D!==null;){if(N=Qi(D),N===null)return;if(Z=N.tag,Z===5||Z===6||Z===26||Z===27){h=w=N;continue e}D=D.parentNode}}h=h.return}Os(function(){var oe=w,me=oi(u),Te=[];e:{var ue=gd.get(s);if(ue!==void 0){var he=xs,Be=s;switch(s){case"keypress":if(uo(u)===0)break e;case"keydown":case"keyup":he=Pa;break;case"focusin":Be="focus",he=Uo;break;case"focusout":Be="blur",he=Uo;break;case"beforeblur":case"afterblur":he=Uo;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=ba;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=Sl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=b;break;case Ba:case md:case Fa:he=xr;break;case Mr:he=O;break;case"scroll":case"scrollend":he=ht;break;case"wheel":he=ce;break;case"copy":case"cut":case"paste":he=xi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=qs;break;case"toggle":case"beforetoggle":he=tt}var Qe=(o&4)!==0,Wt=!Qe&&(s==="scroll"||s==="scrollend"),$=Qe?ue!==null?ue+"Capture":null:ue;Qe=[];for(var Q=oe,se;Q!==null;){var _e=Q;if(se=_e.stateNode,_e=_e.tag,_e!==5&&_e!==26&&_e!==27||se===null||$===null||(_e=Ti(Q,$),_e!=null&&Qe.push(gc(Q,_e,se))),Wt)break;Q=Q.return}0<Qe.length&&(ue=new he(ue,Be,null,u,me),Te.push({event:ue,listeners:Qe}))}}if((o&7)===0){e:{if(ue=s==="mouseover"||s==="pointerover",he=s==="mouseout"||s==="pointerout",ue&&u!==Tr&&(Be=u.relatedTarget||u.fromElement)&&(Qi(Be)||Be[Wi]))break e;if((he||ue)&&(ue=me.window===me?me:(ue=me.ownerDocument)?ue.defaultView||ue.parentWindow:window,he?(Be=u.relatedTarget||u.toElement,he=oe,Be=Be?Qi(Be):null,Be!==null&&(Wt=l(Be),Qe=Be.tag,Be!==Wt||Qe!==5&&Qe!==27&&Qe!==6)&&(Be=null)):(he=null,Be=oe),he!==Be)){if(Qe=ba,_e="onMouseLeave",$="onMouseEnter",Q="mouse",(s==="pointerout"||s==="pointerover")&&(Qe=qs,_e="onPointerLeave",$="onPointerEnter",Q="pointer"),Wt=he==null?ue:Fn(he),se=Be==null?ue:Fn(Be),ue=new Qe(_e,Q+"leave",he,u,me),ue.target=Wt,ue.relatedTarget=se,_e=null,Qi(me)===oe&&(Qe=new Qe($,Q+"enter",Be,u,me),Qe.target=se,Qe.relatedTarget=Wt,_e=Qe),Wt=_e,he&&Be)t:{for(Qe=mC,$=he,Q=Be,se=0,_e=$;_e;_e=Qe(_e))se++;_e=0;for(var Ke=Q;Ke;Ke=Qe(Ke))_e++;for(;0<se-_e;)$=Qe($),se--;for(;0<_e-se;)Q=Qe(Q),_e--;for(;se--;){if($===Q||Q!==null&&$===Q.alternate){Qe=$;break t}$=Qe($),Q=Qe(Q)}Qe=null}else Qe=null;he!==null&&t0(Te,ue,he,Qe,!1),Be!==null&&Wt!==null&&t0(Te,Wt,Be,Qe,!0)}}e:{if(ue=oe?Fn(oe):window,he=ue.nodeName&&ue.nodeName.toLowerCase(),he==="select"||he==="input"&&ue.type==="file")var Ut=Va;else if(Es(ue))if(ud)Ut=zf;else{Ut=Uf;var qe=Hs}else he=ue.nodeName,!he||he.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?oe&&ro(oe.elementType)&&(Ut=Va):Ut=br;if(Ut&&(Ut=Ut(s,oe))){ld(Te,Ut,u,me);break e}qe&&qe(s,ue,oe),s==="focusout"&&oe&&ue.type==="number"&&oe.memoizedProps.value!=null&&$i(ue,"number",ue.value)}switch(qe=oe?Fn(oe):window,s){case"focusin":(Es(qe)||qe.contentEditable==="true")&&(mo=qe,Ml=oe,za=null);break;case"focusout":za=Ml=mo=null;break;case"mousedown":Nr=!0;break;case"contextmenu":case"mouseup":case"dragend":Nr=!1,hd(Te,u,me);break;case"selectionchange":if(Rl)break;case"keydown":case"keyup":hd(Te,u,me)}var dt;if(Pt)e:{switch(s){case"compositionstart":var At="onCompositionStart";break e;case"compositionend":At="onCompositionEnd";break e;case"compositionupdate":At="onCompositionUpdate";break e}At=void 0}else Sr?zo(s,u)&&(At="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(At="onCompositionStart");At&&(Vi&&u.locale!=="ko"&&(Sr||At!=="onCompositionStart"?At==="onCompositionEnd"&&Sr&&(dt=Xi()):(Di=me,zs="value"in Di?Di.value:Di.textContent,Sr=!0)),qe=$d(oe,At),0<qe.length&&(At=new ns(At,s,null,u,me),Te.push({event:At,listeners:qe}),dt?At.data=dt:(dt=Bo(u),dt!==null&&(At.data=dt)))),(dt=Li?os(s,u):Ar(s,u))&&(At=$d(oe,"onBeforeInput"),0<At.length&&(qe=new ns("onBeforeInput","beforeinput",null,u,me),Te.push({event:qe,listeners:At}),qe.data=dt)),cC(Te,s,oe,u,me)}Xv(Te,o)})}function gc(s,o,u){return{instance:s,listener:o,currentTarget:u}}function $d(s,o){for(var u=o+"Capture",h=[];s!==null;){var x=s,w=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||w===null||(x=Ti(s,u),x!=null&&h.unshift(gc(s,x,w)),x=Ti(s,o),x!=null&&h.push(gc(s,x,w))),s.tag===3)return h;s=s.return}return[]}function mC(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function t0(s,o,u,h,x){for(var w=o._reactName,N=[];u!==null&&u!==h;){var D=u,Z=D.alternate,oe=D.stateNode;if(D=D.tag,Z!==null&&Z===h)break;D!==5&&D!==26&&D!==27||oe===null||(Z=oe,x?(oe=Ti(u,w),oe!=null&&N.unshift(gc(u,oe,Z))):x||(oe=Ti(u,w),oe!=null&&N.push(gc(u,oe,Z)))),u=u.return}N.length!==0&&s.push({event:o,listeners:N})}var pC=/\r\n?/g,gC=/\u0000|\uFFFD/g;function n0(s){return(typeof s=="string"?s:""+s).replace(pC,`
`).replace(gC,"")}function i0(s,o){return o=n0(o),n0(s)===o}function Yt(s,o,u,h,x,w){switch(u){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||Cn(s,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&Cn(s,""+h);break;case"className":yt(s,"class",h);break;case"tabIndex":yt(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":yt(s,u,h);break;case"style":Lo(s,h,w);break;case"data":if(o!=="object"){yt(s,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||u!=="href")){s.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=ao(""+h),s.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(u==="formAction"?(o!=="input"&&Yt(s,o,"name",x.name,x,null),Yt(s,o,"formEncType",x.formEncType,x,null),Yt(s,o,"formMethod",x.formMethod,x,null),Yt(s,o,"formTarget",x.formTarget,x,null)):(Yt(s,o,"encType",x.encType,x,null),Yt(s,o,"method",x.method,x,null),Yt(s,o,"target",x.target,x,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=ao(""+h),s.setAttribute(u,h);break;case"onClick":h!=null&&(s.onclick=si);break;case"onScroll":h!=null&&xt("scroll",s);break;case"onScrollEnd":h!=null&&xt("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(u=h.__html,u!=null){if(x.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}u=ao(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""+h):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":h===!0?s.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,h):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(u,h):s.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(u):s.setAttribute(u,h);break;case"popover":xt("beforetoggle",s),xt("toggle",s),ft(s,"popover",h);break;case"xlinkActuate":nn(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":nn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":nn(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":nn(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":nn(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":nn(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":nn(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":nn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":nn(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":ft(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Vo.get(u)||u,ft(s,u,h))}}function tp(s,o,u,h,x,w){switch(u){case"style":Lo(s,h,w);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(u=h.__html,u!=null){if(x.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"children":typeof h=="string"?Cn(s,h):(typeof h=="number"||typeof h=="bigint")&&Cn(s,""+h);break;case"onScroll":h!=null&&xt("scroll",s);break;case"onScrollEnd":h!=null&&xt("scrollend",s);break;case"onClick":h!=null&&(s.onclick=si);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ca.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(x=u.endsWith("Capture"),o=u.slice(2,x?u.length-7:void 0),w=s[_n]||null,w=w!=null?w[u]:null,typeof w=="function"&&s.removeEventListener(o,w,x),typeof h=="function")){typeof w!="function"&&w!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(o,h,x);break e}u in s?s[u]=h:h===!0?s.setAttribute(u,""):ft(s,u,h)}}}function Xn(s,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xt("error",s),xt("load",s);var h=!1,x=!1,w;for(w in u)if(u.hasOwnProperty(w)){var N=u[w];if(N!=null)switch(w){case"src":h=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Yt(s,o,w,N,u,null)}}x&&Yt(s,o,"srcSet",u.srcSet,u,null),h&&Yt(s,o,"src",u.src,u,null);return;case"input":xt("invalid",s);var D=w=N=x=null,Z=null,oe=null;for(h in u)if(u.hasOwnProperty(h)){var me=u[h];if(me!=null)switch(h){case"name":x=me;break;case"type":N=me;break;case"checked":Z=me;break;case"defaultChecked":oe=me;break;case"value":w=me;break;case"defaultValue":D=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,o));break;default:Yt(s,o,h,me,u,null)}}Do(s,w,D,Z,oe,N,x,!1);return;case"select":xt("invalid",s),h=N=w=null;for(x in u)if(u.hasOwnProperty(x)&&(D=u[x],D!=null))switch(x){case"value":w=D;break;case"defaultValue":N=D;break;case"multiple":h=D;default:Yt(s,o,x,D,u,null)}o=w,u=N,s.multiple=!!h,o!=null?Gt(s,!!h,o,!1):u!=null&&Gt(s,!!h,u,!0);return;case"textarea":xt("invalid",s),w=x=h=null;for(N in u)if(u.hasOwnProperty(N)&&(D=u[N],D!=null))switch(N){case"value":h=D;break;case"defaultValue":x=D;break;case"children":w=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(i(91));break;default:Yt(s,o,N,D,u,null)}ki(s,h,x,w);return;case"option":for(Z in u)if(u.hasOwnProperty(Z)&&(h=u[Z],h!=null))switch(Z){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Yt(s,o,Z,h,u,null)}return;case"dialog":xt("beforetoggle",s),xt("toggle",s),xt("cancel",s),xt("close",s);break;case"iframe":case"object":xt("load",s);break;case"video":case"audio":for(h=0;h<pc.length;h++)xt(pc[h],s);break;case"image":xt("error",s),xt("load",s);break;case"details":xt("toggle",s);break;case"embed":case"source":case"link":xt("error",s),xt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in u)if(u.hasOwnProperty(oe)&&(h=u[oe],h!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Yt(s,o,oe,h,u,null)}return;default:if(ro(o)){for(me in u)u.hasOwnProperty(me)&&(h=u[me],h!==void 0&&tp(s,o,me,h,u,void 0));return}}for(D in u)u.hasOwnProperty(D)&&(h=u[D],h!=null&&Yt(s,o,D,h,u,null))}function _C(s,o,u,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,w=null,N=null,D=null,Z=null,oe=null,me=null;for(he in u){var Te=u[he];if(u.hasOwnProperty(he)&&Te!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":Z=Te;default:h.hasOwnProperty(he)||Yt(s,o,he,null,h,Te)}}for(var ue in h){var he=h[ue];if(Te=u[ue],h.hasOwnProperty(ue)&&(he!=null||Te!=null))switch(ue){case"type":w=he;break;case"name":x=he;break;case"checked":oe=he;break;case"defaultChecked":me=he;break;case"value":N=he;break;case"defaultValue":D=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,o));break;default:he!==Te&&Yt(s,o,ue,he,h,Te)}}yr(s,N,D,Z,oe,me,w,x);return;case"select":he=N=D=ue=null;for(w in u)if(Z=u[w],u.hasOwnProperty(w)&&Z!=null)switch(w){case"value":break;case"multiple":he=Z;default:h.hasOwnProperty(w)||Yt(s,o,w,null,h,Z)}for(x in h)if(w=h[x],Z=u[x],h.hasOwnProperty(x)&&(w!=null||Z!=null))switch(x){case"value":ue=w;break;case"defaultValue":D=w;break;case"multiple":N=w;default:w!==Z&&Yt(s,o,x,w,h,Z)}o=D,u=N,h=he,ue!=null?Gt(s,!!u,ue,!1):!!h!=!!u&&(o!=null?Gt(s,!!u,o,!0):Gt(s,!!u,u?[]:"",!1));return;case"textarea":he=ue=null;for(D in u)if(x=u[D],u.hasOwnProperty(D)&&x!=null&&!h.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:Yt(s,o,D,null,h,x)}for(N in h)if(x=h[N],w=u[N],h.hasOwnProperty(N)&&(x!=null||w!=null))switch(N){case"value":ue=x;break;case"defaultValue":he=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(i(91));break;default:x!==w&&Yt(s,o,N,x,h,w)}ys(s,ue,he);return;case"option":for(var Be in u)if(ue=u[Be],u.hasOwnProperty(Be)&&ue!=null&&!h.hasOwnProperty(Be))switch(Be){case"selected":s.selected=!1;break;default:Yt(s,o,Be,null,h,ue)}for(Z in h)if(ue=h[Z],he=u[Z],h.hasOwnProperty(Z)&&ue!==he&&(ue!=null||he!=null))switch(Z){case"selected":s.selected=ue&&typeof ue!="function"&&typeof ue!="symbol";break;default:Yt(s,o,Z,ue,h,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in u)ue=u[Qe],u.hasOwnProperty(Qe)&&ue!=null&&!h.hasOwnProperty(Qe)&&Yt(s,o,Qe,null,h,ue);for(oe in h)if(ue=h[oe],he=u[oe],h.hasOwnProperty(oe)&&ue!==he&&(ue!=null||he!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(i(137,o));break;default:Yt(s,o,oe,ue,h,he)}return;default:if(ro(o)){for(var Wt in u)ue=u[Wt],u.hasOwnProperty(Wt)&&ue!==void 0&&!h.hasOwnProperty(Wt)&&tp(s,o,Wt,void 0,h,ue);for(me in h)ue=h[me],he=u[me],!h.hasOwnProperty(me)||ue===he||ue===void 0&&he===void 0||tp(s,o,me,ue,h,he);return}}for(var $ in u)ue=u[$],u.hasOwnProperty($)&&ue!=null&&!h.hasOwnProperty($)&&Yt(s,o,$,null,h,ue);for(Te in h)ue=h[Te],he=u[Te],!h.hasOwnProperty(Te)||ue===he||ue==null&&he==null||Yt(s,o,Te,ue,h,he)}function s0(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function yC(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,u=performance.getEntriesByType("resource"),h=0;h<u.length;h++){var x=u[h],w=x.transferSize,N=x.initiatorType,D=x.duration;if(w&&D&&s0(N)){for(N=0,D=x.responseEnd,h+=1;h<u.length;h++){var Z=u[h],oe=Z.startTime;if(oe>D)break;var me=Z.transferSize,Te=Z.initiatorType;me&&s0(Te)&&(Z=Z.responseEnd,N+=me*(Z<D?1:(D-oe)/(Z-oe)))}if(--h,o+=8*(w+N)/(x.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var np=null,ip=null;function Xd(s){return s.nodeType===9?s:s.ownerDocument}function o0(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function r0(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function sp(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var op=null;function vC(){var s=window.event;return s&&s.type==="popstate"?s===op?!1:(op=s,!0):(op=null,!1)}var a0=typeof setTimeout=="function"?setTimeout:void 0,TC=typeof clearTimeout=="function"?clearTimeout:void 0,l0=typeof Promise=="function"?Promise:void 0,xC=typeof queueMicrotask=="function"?queueMicrotask:typeof l0<"u"?function(s){return l0.resolve(null).then(s).catch(EC)}:a0;function EC(s){setTimeout(function(){throw s})}function Kr(s){return s==="head"}function u0(s,o){var u=o,h=0;do{var x=u.nextSibling;if(s.removeChild(u),x&&x.nodeType===8)if(u=x.data,u==="/$"||u==="/&"){if(h===0){s.removeChild(x),iu(o);return}h--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")h++;else if(u==="html")_c(s.ownerDocument.documentElement);else if(u==="head"){u=s.ownerDocument.head,_c(u);for(var w=u.firstChild;w;){var N=w.nextSibling,D=w.nodeName;w[ms]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&w.rel.toLowerCase()==="stylesheet"||u.removeChild(w),w=N}}else u==="body"&&_c(s.ownerDocument.body);u=x}while(u);iu(o)}function c0(s,o){var u=s;s=0;do{var h=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),h&&h.nodeType===8)if(u=h.data,u==="/$"){if(s===0)break;s--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||s++;u=h}while(u)}function rp(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":rp(u),pr(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function wC(s,o,u,h){for(;s.nodeType===1;){var x=u;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[ms])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(w=s.getAttribute("rel"),w==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(w!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(w=s.getAttribute("src"),(w!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&w&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var w=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===w)return s}else return s;if(s=Is(s.nextSibling),s===null)break}return null}function SC(s,o,u){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=Is(s.nextSibling),s===null))return null;return s}function d0(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Is(s.nextSibling),s===null))return null;return s}function ap(s){return s.data==="$?"||s.data==="$~"}function lp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function AC(s,o){var u=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||u.readyState!=="loading")o();else{var h=function(){o(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function Is(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var up=null;function h0(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"||u==="/&"){if(o===0)return Is(s.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}s=s.nextSibling}return null}function f0(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return s;o--}else u!=="/$"&&u!=="/&"||o++}s=s.previousSibling}return null}function m0(s,o,u){switch(o=Xd(u),s){case"html":if(s=o.documentElement,!s)throw Error(i(452));return s;case"head":if(s=o.head,!s)throw Error(i(453));return s;case"body":if(s=o.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function _c(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);pr(s)}var Ns=new Map,p0=new Set;function eh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var tr=Ae.d;Ae.d={f:CC,r:bC,D:IC,C:NC,L:RC,m:MC,X:kC,S:PC,M:DC};function CC(){var s=tr.f(),o=jd();return s||o}function bC(s){var o=Ri(s);o!==null&&o.tag===5&&o.type==="form"?Py(o):tr.r(s)}var eu=typeof document>"u"?null:document;function g0(s,o,u){var h=eu;if(h&&typeof o=="string"&&o){var x=Jt(o);x='link[rel="'+s+'"][href="'+x+'"]',typeof u=="string"&&(x+='[crossorigin="'+u+'"]'),p0.has(x)||(p0.add(x),s={rel:s,crossOrigin:u,href:o},h.querySelector(x)===null&&(o=h.createElement("link"),Xn(o,"link",s),yn(o),h.head.appendChild(o)))}}function IC(s){tr.D(s),g0("dns-prefetch",s,null)}function NC(s,o){tr.C(s,o),g0("preconnect",s,o)}function RC(s,o,u){tr.L(s,o,u);var h=eu;if(h&&s&&o){var x='link[rel="preload"][as="'+Jt(o)+'"]';o==="image"&&u&&u.imageSrcSet?(x+='[imagesrcset="'+Jt(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(x+='[imagesizes="'+Jt(u.imageSizes)+'"]')):x+='[href="'+Jt(s)+'"]';var w=x;switch(o){case"style":w=tu(s);break;case"script":w=nu(s)}Ns.has(w)||(s=S({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:s,as:o},u),Ns.set(w,s),h.querySelector(x)!==null||o==="style"&&h.querySelector(yc(w))||o==="script"&&h.querySelector(vc(w))||(o=h.createElement("link"),Xn(o,"link",s),yn(o),h.head.appendChild(o)))}}function MC(s,o){tr.m(s,o);var u=eu;if(u&&s){var h=o&&typeof o.as=="string"?o.as:"script",x='link[rel="modulepreload"][as="'+Jt(h)+'"][href="'+Jt(s)+'"]',w=x;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=nu(s)}if(!Ns.has(w)&&(s=S({rel:"modulepreload",href:s},o),Ns.set(w,s),u.querySelector(x)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(vc(w)))return}h=u.createElement("link"),Xn(h,"link",s),yn(h),u.head.appendChild(h)}}}function PC(s,o,u){tr.S(s,o,u);var h=eu;if(h&&s){var x=ps(h).hoistableStyles,w=tu(s);o=o||"default";var N=x.get(w);if(!N){var D={loading:0,preload:null};if(N=h.querySelector(yc(w)))D.loading=5;else{s=S({rel:"stylesheet",href:s,"data-precedence":o},u),(u=Ns.get(w))&&cp(s,u);var Z=N=h.createElement("link");yn(Z),Xn(Z,"link",s),Z._p=new Promise(function(oe,me){Z.onload=oe,Z.onerror=me}),Z.addEventListener("load",function(){D.loading|=1}),Z.addEventListener("error",function(){D.loading|=2}),D.loading|=4,th(N,o,h)}N={type:"stylesheet",instance:N,count:1,state:D},x.set(w,N)}}}function kC(s,o){tr.X(s,o);var u=eu;if(u&&s){var h=ps(u).hoistableScripts,x=nu(s),w=h.get(x);w||(w=u.querySelector(vc(x)),w||(s=S({src:s,async:!0},o),(o=Ns.get(x))&&dp(s,o),w=u.createElement("script"),yn(w),Xn(w,"link",s),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(x,w))}}function DC(s,o){tr.M(s,o);var u=eu;if(u&&s){var h=ps(u).hoistableScripts,x=nu(s),w=h.get(x);w||(w=u.querySelector(vc(x)),w||(s=S({src:s,async:!0,type:"module"},o),(o=Ns.get(x))&&dp(s,o),w=u.createElement("script"),yn(w),Xn(w,"link",s),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(x,w))}}function _0(s,o,u,h){var x=(x=be.current)?eh(x):null;if(!x)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=tu(u.href),u=ps(x).hoistableStyles,h=u.get(o),h||(h={type:"style",instance:null,count:0,state:null},u.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=tu(u.href);var w=ps(x).hoistableStyles,N=w.get(s);if(N||(x=x.ownerDocument||x,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(s,N),(w=x.querySelector(yc(s)))&&!w._p&&(N.instance=w,N.state.loading=5),Ns.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ns.set(s,u),w||LC(x,s,u,N.state))),o&&h===null)throw Error(i(528,""));return N}if(o&&h!==null)throw Error(i(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=nu(u),u=ps(x).hoistableScripts,h=u.get(o),h||(h={type:"script",instance:null,count:0,state:null},u.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function tu(s){return'href="'+Jt(s)+'"'}function yc(s){return'link[rel="stylesheet"]['+s+"]"}function y0(s){return S({},s,{"data-precedence":s.precedence,precedence:null})}function LC(s,o,u,h){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=s.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),Xn(o,"link",u),yn(o),s.head.appendChild(o))}function nu(s){return'[src="'+Jt(s)+'"]'}function vc(s){return"script[async]"+s}function v0(s,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var h=s.querySelector('style[data-href~="'+Jt(u.href)+'"]');if(h)return o.instance=h,yn(h),h;var x=S({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),yn(h),Xn(h,"style",x),th(h,u.precedence,s),o.instance=h;case"stylesheet":x=tu(u.href);var w=s.querySelector(yc(x));if(w)return o.state.loading|=4,o.instance=w,yn(w),w;h=y0(u),(x=Ns.get(x))&&cp(h,x),w=(s.ownerDocument||s).createElement("link"),yn(w);var N=w;return N._p=new Promise(function(D,Z){N.onload=D,N.onerror=Z}),Xn(w,"link",h),o.state.loading|=4,th(w,u.precedence,s),o.instance=w;case"script":return w=nu(u.src),(x=s.querySelector(vc(w)))?(o.instance=x,yn(x),x):(h=u,(x=Ns.get(w))&&(h=S({},u),dp(h,x)),s=s.ownerDocument||s,x=s.createElement("script"),yn(x),Xn(x,"link",h),s.head.appendChild(x),o.instance=x);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,th(h,u.precedence,s));return o.instance}function th(s,o,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=h.length?h[h.length-1]:null,w=x,N=0;N<h.length;N++){var D=h[N];if(D.dataset.precedence===o)w=D;else if(w!==x)break}w?w.parentNode.insertBefore(s,w.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(s,o.firstChild))}function cp(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function dp(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var nh=null;function T0(s,o,u){if(nh===null){var h=new Map,x=nh=new Map;x.set(u,h)}else x=nh,h=x.get(u),h||(h=new Map,x.set(u,h));if(h.has(s))return h;for(h.set(s,null),u=u.getElementsByTagName(s),x=0;x<u.length;x++){var w=u[x];if(!(w[ms]||w[fn]||s==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var N=w.getAttribute(o)||"";N=s+N;var D=h.get(N);D?D.push(w):h.set(N,[w])}}return h}function x0(s,o,u){s=s.ownerDocument||s,s.head.insertBefore(u,o==="title"?s.querySelector("head > title"):null)}function VC(s,o,u){if(u===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function E0(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function OC(s,o,u,h){if(u.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var x=tu(h.href),w=o.querySelector(yc(x));if(w){o=w._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=ih.bind(s),o.then(s,s)),u.state.loading|=4,u.instance=w,yn(w);return}w=o.ownerDocument||o,h=y0(h),(x=Ns.get(x))&&cp(h,x),w=w.createElement("link"),yn(w);var N=w;N._p=new Promise(function(D,Z){N.onload=D,N.onerror=Z}),Xn(w,"link",h),u.instance=w}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(s.count++,u=ih.bind(s),o.addEventListener("load",u),o.addEventListener("error",u))}}var hp=0;function UC(s,o){return s.stylesheets&&s.count===0&&oh(s,s.stylesheets),0<s.count||0<s.imgCount?function(u){var h=setTimeout(function(){if(s.stylesheets&&oh(s,s.stylesheets),s.unsuspend){var w=s.unsuspend;s.unsuspend=null,w()}},6e4+o);0<s.imgBytes&&hp===0&&(hp=62500*yC());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&oh(s,s.stylesheets),s.unsuspend)){var w=s.unsuspend;s.unsuspend=null,w()}},(s.imgBytes>hp?50:800)+o);return s.unsuspend=u,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(x)}}:null}function ih(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)oh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var sh=null;function oh(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,sh=new Map,o.forEach(zC,s),sh=null,ih.call(s))}function zC(s,o){if(!(o.state.loading&4)){var u=sh.get(s);if(u)var h=u.get(null);else{u=new Map,sh.set(s,u);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<x.length;w++){var N=x[w];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(u.set(N.dataset.precedence,N),h=N)}h&&u.set(null,h)}x=o.instance,N=x.getAttribute("data-precedence"),w=u.get(N)||h,w===h&&u.set(null,x),u.set(N,x),this.count++,h=ih.bind(this),x.addEventListener("load",h),x.addEventListener("error",h),w?w.parentNode.insertBefore(x,w.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),o.state.loading|=4}}var Tc={$$typeof:ee,Provider:null,Consumer:null,_currentValue:Se,_currentValue2:Se,_threadCount:0};function BC(s,o,u,h,x,w,N,D,Z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fs(0),this.hiddenUpdates=fs(null),this.identifierPrefix=h,this.onUncaughtError=x,this.onCaughtError=w,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function w0(s,o,u,h,x,w,N,D,Z,oe,me,Te){return s=new BC(s,o,u,N,Z,oe,me,Te,D),o=1,w===!0&&(o|=24),w=ui(3,null,null,o),s.current=w,w.stateNode=s,o=jf(),o.refCount++,s.pooledCache=o,o.refCount++,w.memoizedState={element:h,isDehydrated:u,cache:o},Wf(w),s}function S0(s){return s?(s=Fo,s):Fo}function A0(s,o,u,h,x,w){x=S0(x),h.context===null?h.context=x:h.pendingContext=x,h=Lr(o),h.payload={element:u},w=w===void 0?null:w,w!==null&&(h.callback=w),u=Vr(s,h,o),u!==null&&(Gi(u,s,o),$u(u,s,o))}function C0(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function fp(s,o){C0(s,o),(s=s.alternate)&&C0(s,o)}function b0(s){if(s.tag===13||s.tag===31){var o=As(s,67108864);o!==null&&Gi(o,s,67108864),fp(s,67108864)}}function I0(s){if(s.tag===13||s.tag===31){var o=cs();o=Bn(o);var u=As(s,o);u!==null&&Gi(u,s,o),fp(s,o)}}var rh=!0;function FC(s,o,u,h){var x=ne.T;ne.T=null;var w=Ae.p;try{Ae.p=2,mp(s,o,u,h)}finally{Ae.p=w,ne.T=x}}function qC(s,o,u,h){var x=ne.T;ne.T=null;var w=Ae.p;try{Ae.p=8,mp(s,o,u,h)}finally{Ae.p=w,ne.T=x}}function mp(s,o,u,h){if(rh){var x=pp(h);if(x===null)ep(s,o,h,ah,u),R0(s,h);else if(GC(x,s,o,u,h))h.stopPropagation();else if(R0(s,h),o&4&&-1<HC.indexOf(s)){for(;x!==null;){var w=Ri(x);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var N=yi(w.pendingLanes);if(N!==0){var D=w;for(D.pendingLanes|=2,D.entangledLanes|=2;N;){var Z=1<<31-ut(N);D.entanglements[1]|=Z,N&=~Z}Eo(w),(Ft&6)===0&&(Hd=lt()+500,mc(0))}}break;case 31:case 13:D=As(w,2),D!==null&&Gi(D,w,2),jd(),fp(w,2)}if(w=pp(h),w===null&&ep(s,o,h,ah,u),w===x)break;x=w}x!==null&&h.stopPropagation()}else ep(s,o,h,null,u)}}function pp(s){return s=oi(s),gp(s)}var ah=null;function gp(s){if(ah=null,s=Qi(s),s!==null){var o=l(s);if(o===null)s=null;else{var u=o.tag;if(u===13){if(s=c(o),s!==null)return s;s=null}else if(u===31){if(s=m(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return ah=s,null}function N0(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(hn()){case Ai:return 2;case ii:return 8;case cn:case Ci:return 32;case io:return 268435456;default:return 32}default:return 32}}var _p=!1,Zr=null,Yr=null,Wr=null,xc=new Map,Ec=new Map,Jr=[],HC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function R0(s,o){switch(s){case"focusin":case"focusout":Zr=null;break;case"dragenter":case"dragleave":Yr=null;break;case"mouseover":case"mouseout":Wr=null;break;case"pointerover":case"pointerout":xc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ec.delete(o.pointerId)}}function wc(s,o,u,h,x,w){return s===null||s.nativeEvent!==w?(s={blockedOn:o,domEventName:u,eventSystemFlags:h,nativeEvent:w,targetContainers:[x]},o!==null&&(o=Ri(o),o!==null&&b0(o)),s):(s.eventSystemFlags|=h,o=s.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),s)}function GC(s,o,u,h,x){switch(o){case"focusin":return Zr=wc(Zr,s,o,u,h,x),!0;case"dragenter":return Yr=wc(Yr,s,o,u,h,x),!0;case"mouseover":return Wr=wc(Wr,s,o,u,h,x),!0;case"pointerover":var w=x.pointerId;return xc.set(w,wc(xc.get(w)||null,s,o,u,h,x)),!0;case"gotpointercapture":return w=x.pointerId,Ec.set(w,wc(Ec.get(w)||null,s,o,u,h,x)),!0}return!1}function M0(s){var o=Qi(s.target);if(o!==null){var u=l(o);if(u!==null){if(o=u.tag,o===13){if(o=c(u),o!==null){s.blockedOn=o,Ii(s.priority,function(){I0(u)});return}}else if(o===31){if(o=m(u),o!==null){s.blockedOn=o,Ii(s.priority,function(){I0(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function lh(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=pp(s.nativeEvent);if(u===null){u=s.nativeEvent;var h=new u.constructor(u.type,u);Tr=h,u.target.dispatchEvent(h),Tr=null}else return o=Ri(u),o!==null&&b0(o),s.blockedOn=u,!1;o.shift()}return!0}function P0(s,o,u){lh(s)&&u.delete(o)}function jC(){_p=!1,Zr!==null&&lh(Zr)&&(Zr=null),Yr!==null&&lh(Yr)&&(Yr=null),Wr!==null&&lh(Wr)&&(Wr=null),xc.forEach(P0),Ec.forEach(P0)}function uh(s,o){s.blockedOn===o&&(s.blockedOn=null,_p||(_p=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,jC)))}var ch=null;function k0(s){ch!==s&&(ch=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ch===s&&(ch=null);for(var o=0;o<s.length;o+=3){var u=s[o],h=s[o+1],x=s[o+2];if(typeof h!="function"){if(gp(h||u)===null)continue;break}var w=Ri(u);w!==null&&(s.splice(o,3),o-=3,pm(w,{pending:!0,data:x,method:u.method,action:h},h,x))}}))}function iu(s){function o(Z){return uh(Z,s)}Zr!==null&&uh(Zr,s),Yr!==null&&uh(Yr,s),Wr!==null&&uh(Wr,s),xc.forEach(o),Ec.forEach(o);for(var u=0;u<Jr.length;u++){var h=Jr[u];h.blockedOn===s&&(h.blockedOn=null)}for(;0<Jr.length&&(u=Jr[0],u.blockedOn===null);)M0(u),u.blockedOn===null&&Jr.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var x=u[h],w=u[h+1],N=x[_n]||null;if(typeof w=="function")N||k0(u);else if(N){var D=null;if(w&&w.hasAttribute("formAction")){if(x=w,N=w[_n]||null)D=N.formAction;else if(gp(x)!==null)continue}else D=N.action;typeof D=="function"?u[h+1]=D:(u.splice(h,3),h-=3),k0(u)}}}function D0(){function s(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(N){return x=N})},focusReset:"manual",scroll:"manual"})}function o(){x!==null&&(x(),x=null),h||setTimeout(u,20)}function u(){if(!h&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),x!==null&&(x(),x=null)}}}function yp(s){this._internalRoot=s}dh.prototype.render=yp.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(i(409));var u=o.current,h=cs();A0(u,h,s,o,null,null)},dh.prototype.unmount=yp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;A0(s.current,2,null,s,null,null),jd(),o[Wi]=null}};function dh(s){this._internalRoot=s}dh.prototype.unstable_scheduleHydration=function(s){if(s){var o=Sa();s={blockedOn:null,target:s,priority:o};for(var u=0;u<Jr.length&&o!==0&&o<Jr[u].priority;u++);Jr.splice(u,0,s),u===0&&M0(s)}};var L0=e.version;if(L0!=="19.2.0")throw Error(i(527,L0,"19.2.0"));Ae.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=p(o),s=s!==null?E(s):null,s=s===null?null:s.stateNode,s};var KC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hh.isDisabled&&hh.supportsFiber)try{Re=hh.inject(KC),$e=hh}catch{}}return Ac.createRoot=function(s,o){if(!r(s))throw Error(i(299));var u=!1,h="",x=qy,w=Hy,N=Gy;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError)),o=w0(s,1,!1,null,null,u,h,null,x,w,N,D0),s[Wi]=o.current,Xm(s),new yp(o)},Ac.hydrateRoot=function(s,o,u){if(!r(s))throw Error(i(299));var h=!1,x="",w=qy,N=Hy,D=Gy,Z=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(N=u.onCaughtError),u.onRecoverableError!==void 0&&(D=u.onRecoverableError),u.formState!==void 0&&(Z=u.formState)),o=w0(s,1,!0,o,u??null,h,x,Z,w,N,D,D0),o.context=S0(null),u=o.current,h=cs(),h=Bn(h),x=Lr(h),x.callback=null,Vr(u,x,h),u=h,o.current.lanes=u,Ds(o,u),Eo(o),s[Wi]=o.current,Xm(s),new dh(o)},Ac.version="19.2.0",Ac}var j0;function tb(){if(j0)return xp.exports;j0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),xp.exports=eb(),xp.exports}var nb=tb();const ib=Cg(nb);var it=(n=>(n.HOME="HOME",n.ADD_TRIP="ADD_TRIP",n.TRIP_DETAILS="TRIP_DETAILS",n.SETTINGS="SETTINGS",n.MAGIC_EDITOR="MAGIC_EDITOR",n.AI_PLANNER="AI_PLANNER",n.TOOLS="TOOLS",n.TRIP_MEMORY="TRIP_MEMORY",n))(it||{});const sb=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),nf=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),sa=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"})}),_u=({className:n})=>T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})]}),Up=({className:n})=>T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})]}),hs=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})}),zp=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})}),ob=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),ow=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:T.jsx("path",{d:"M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5Z"})}),rw=({className:n})=>T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"})]}),aw=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"})}),lw=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 9.75a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 0 1 .778-.332 48.294 48.294 0 0 0 5.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})}),rb=({className:n})=>T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:[T.jsx("path",{d:"M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.85 7h10.29l1.08 3.11H5.77L6.85 7zM19 17H5v-5h14v5z"}),T.jsx("circle",{cx:"7.5",cy:"14.5",r:"1.5"}),T.jsx("circle",{cx:"16.5",cy:"14.5",r:"1.5"})]}),K0=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"})}),Ig=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z"})}),da=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),ab=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"})}),lb=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),ub=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 0 1-2.25 2.25M16.5 7.5V18a2.25 2.25 0 0 0 2.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 0 0 2.25 2.25h13.5M6 7.5h3v3H6v-3Z"})}),Bp=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-1.94c.955-.13 1.93-.32 2.795-.591 3.615-1.133 4.705-4.884 2.636-7.962-1.373-2.042-3.738-3.257-6.236-3.257-4.14 0-7.5 3.36-7.5 7.5 0 2.053.84 3.942 2.22 5.297.808.796 1.83 1.344 2.923 1.564V18m2.25 0h-4.5m4.5 0a2.25 2.25 0 0 1-2.25 2.25h-1.5A2.25 2.25 0 0 1 7.5 18m9-9h.008v.008H16.5V9Zm-4.5 0h.008v.008H12V9Zm-4.5 0h.008v.008H7.5V9Z"})}),cb=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h3.375c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125h-3.375c-.621 0-1.125-.504-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125Zm-3 7.5h10.5a.75.75 0 0 1 .75.75v3.375a3 3 0 0 1-3 3h-6a3 3 0 0 1-3-3V10.5a.75.75 0 0 1 .75-.75Zm9.375 12a1.125 1.125 0 1 0 0-2.25 1.125 1.125 0 0 0 0 2.25Z"})}),db=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"})}),uw=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 17.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),hb=({className:n})=>T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 0 1 1.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.559.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.894.149c-.424.07-.764.383-.929.78-.165.398-.143.854.107 1.204l-.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 0 1-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 0 1-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 0 1 .12-1.45l.773-.773a1.125 1.125 0 0 1 1.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),fb=({className:n})=>T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),mb=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"})}),cw=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),dw=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 01-1.12-1.243l1.264-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.119 1.007zM8.625 10.5a.375.375 0 11-.75 0 .375.375 0 01.75 0zm7.5 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})}),pb=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 016-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 01-3.827-5.802"})}),gb=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})}),Z0=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0 1 18 16.5h-2.25m-7.5 0h7.5m-7.5 0-1 3m8.5-3 1 3m0 0 .5 1.5m-.5-1.5h-9.5m0 0-.5 1.5M9 11.25v1.5M12 9v3m3-3v3M9 3.75V5.25m3-1.5h3m-3 0v1.5m0-1.5h-3m3 0v1.5M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})}),_b=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:T.jsx("path",{d:"M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4S4 2.5 4 6v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z"})}),yb=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:T.jsx("path",{d:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"})}),vb=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),Tb=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})}),xb=({className:n})=>T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})}),Xt={"zh-TW":{back:"",cancel:"",confirm:"",save:"",delete:"",edit:"",loading:"...",day:"Day",my_trips:"",start_adventure:"",click_to_add:"",trips_count:"",new_trip:"",trip_destination_title:" / ",cover_photo:"",upload_photo:"",ai_generate_cover:"AI ",start_date:"",end_date:"",create_trip:"",add_trip_hint:"",itinerary:"",map:"",budget:"",bookings:"",shopping_list:"",shopping:"",origin:"",label_destination:"",status_confirmed:"",status_pending:"",status_cancelled:"",ai_guide:"AI ",add_activity:"",edit_activity:"",add_expense:"",add_booking:"",weather:"",nav_quick_jump:"",no_itinerary:"",click_add:"",delete_trip_title:"",delete_trip_confirm:"{title}",confirm_delete:"",activity_name:"",time:"",location:"",notes:" ()",duration:"",details:"",placeholder_duration:"15 ",placeholder_details:"JR ",ai_route:"AI ",optimize_route:"AI ",expense_item:"",amount:"",payer:"",payment_method:"",booking_type:"",provider:" / ",booking_ref:" ()",ai_planner_title:"AI ",ai_planner_intro:" AI ",ai_planning:" 10-20 ",ai_done:"",input_placeholder:"...",planning_process:"...",magic_editor_title:"",upload_hint:"",magic_prompt_placeholder:"...",start_magic:"",generating:"...",settings_title:"",general:"",language:"",appearance:"",minimalist_mode:"",minimalist_desc:"",data_mgmt:"",reset_all:"",reset_confirm:"",tools_title:"",tool_emergency:"",tool_card:"",tool_map:"",tool_restroom:"",tool_visa:"",tool_translation:"",tool_culture:"",api_settings:"API ",api_key_label:"Gemini API Key",api_key_placeholder:" API Key",api_key_help:" Key ",api_key_saved:"API Key ",theme_color:"",payer_me:"",payer_other:"",payment_cash:"",payment_card:"",split_individual:"",split_shared:"",translate_to:"",enter_text:"...",translate_result:"",desc_translator:"AI ",desc_emergency:" / ",desc_card:"",desc_map:"",desc_restroom:"",desc_visa:"",desc_culture:"",prompt_tokyo:"",prompt_bangkok:"",prompt_paris:"",placeholder_item:"",placeholder_payer:"",lang_ja:"",lang_en:"",lang_zh:"",lang_ko:"",lang_th:"",lang_fr:"",lang_es:"",share_trip:"",share_success:"",travel_time:"",travel_mode:"",travel_details:" ( JR )",mode_walk:"",mode_train:"/",mode_bus:"/",mode_car:"/",mode_flight:"",minutes:"",search_placeholder:" (: )",search_location:""},"en-US":{back:"Back",cancel:"Cancel",confirm:"Confirm",save:"Save",delete:"Delete",edit:"Edit",loading:"Loading...",day:"Day",my_trips:"My Trips",start_adventure:"Start New Adventure",click_to_add:"Click button below to add trip",trips_count:"items",new_trip:"New Trip",trip_destination_title:"Destination / Title",cover_photo:"Cover Photo",upload_photo:"Upload",ai_generate_cover:"AI Generate",start_date:"Start Date",end_date:"End Date",create_trip:"Create Trip",add_trip_hint:"You can add detailed itinerary later",itinerary:"Itinerary",map:"Map",budget:"Budget",shopping_list:"Shopping List",shopping:"Shopping",bookings:"Bookings",origin:"Origin",label_destination:"Destination",status_confirmed:"Confirmed",status_pending:"Pending",status_cancelled:"Cancelled",ai_guide:"AI Guide",add_activity:"Add Activity",edit_activity:"Edit Activity",add_expense:"Add Expense",add_booking:"Add Booking",weather:"Weather",nav_quick_jump:"Jump to",no_itinerary:"No itinerary yet",click_add:"Click button to add",delete_trip_title:"Delete Trip?",delete_trip_confirm:'Are you sure you want to delete "{title}"? This cannot be undone.',confirm_delete:"Delete",activity_name:"Activity Name",time:"Time",location:"Location",notes:"Notes (Optional)",duration:"Duration",details:"Details",placeholder_duration:"e.g. 15 min",placeholder_details:"e.g. JR Line",ai_route:"AI Route",optimize_route:"AI Route Optimization",expense_item:"Item Name",amount:"Amount",payer:"Payer",payment_method:"Method",booking_type:"Type",provider:"Provider / Name",booking_ref:"Ref Number (Optional)",ai_planner_title:"AI Planner",ai_planner_intro:"Hi! I am your AI travel assistant. Where do you want to go?",ai_planning:"Sure! I am planning your trip. This takes about 10-20 seconds.",ai_done:"Planning complete! Check your trip list. ",input_placeholder:"Enter your travel ideas...",planning_process:"Processing...",magic_editor_title:"Magic Editor",upload_hint:"Upload Photo",magic_prompt_placeholder:"Make it sunny, add balloons...",start_magic:"Generate",generating:"Processing...",settings_title:"Settings",api_settings:"API Settings",api_key_label:"Gemini API Key",api_key_placeholder:"Paste your API Key here",api_key_help:"Your key is stored locally in your browser.",api_key_saved:"API Key Saved",general:"General",language:"Language",appearance:"Appearance",minimalist_mode:"Minimalist Mode",minimalist_desc:"Hide images, focus on text",data_mgmt:"Data Management",reset_all:"Reset All Data",reset_confirm:"Are you sure? This will delete all trips and settings. This cannot be undone.",tools_title:"Tools",tool_emergency:"Emergency",tool_card:"Card Tips",tool_map:"Scratch Map",tool_restroom:"Restroom",tool_visa:"Visa Check",tool_culture:"Culture",share_trip:"Share Trip",share_success:"Copied to clipboard!",travel_time:"Travel Time",travel_mode:"Travel Mode",travel_details:"Details (e.g. JR Line)",mode_walk:"Walk",mode_train:"Train/Subway",mode_bus:"Bus",mode_car:"Car/Taxi",mode_flight:"Flight",minutes:"min",search_placeholder:"Search location (e.g. Tokyo Tower)",search_location:"Search"},"ja-JP":{back:"",cancel:"",confirm:"",save:"",delete:"",edit:"",loading:"...",day:"Day",my_trips:"",start_adventure:"",click_to_add:"",trips_count:"",new_trip:"",trip_destination_title:" / ",cover_photo:"",upload_photo:"",ai_generate_cover:"AI",start_date:"",end_date:"",create_trip:"",add_trip_hint:"",itinerary:"",map:"",budget:"",shopping_list:"",shopping:"",bookings:"",origin:"",label_destination:"",status_confirmed:"",status_pending:"",status_cancelled:"",ai_guide:"AI",add_activity:"",edit_activity:"",add_expense:"",add_booking:"",weather:"",nav_quick_jump:"",no_itinerary:"",click_add:"",delete_trip_title:"",delete_trip_confirm:"{title}",confirm_delete:"",activity_name:"",time:"",location:"",notes:" ()",duration:"",details:"",placeholder_duration:"15",placeholder_details:"JR",ai_route:"AI",optimize_route:"AI",expense_item:"",amount:"",payer:"",payment_method:"",booking_type:"",provider:" / ",booking_ref:" ()",ai_planner_title:"AI",ai_planner_intro:"AI",ai_planning:"1020",ai_done:"",input_placeholder:"...",planning_process:"...",magic_editor_title:"",upload_hint:"",magic_prompt_placeholder:"...",start_magic:"",generating:"...",settings_title:"",general:"",language:"",appearance:"",minimalist_mode:"",minimalist_desc:"",data_mgmt:"",reset_all:"",reset_confirm:"",tools_title:"",tool_emergency:"",tool_card:"",tool_map:"",tool_restroom:"",tool_visa:"",tool_culture:"",share_trip:"",share_success:"",travel_time:"",travel_mode:"",travel_details:" (: JR)",mode_walk:"",mode_train:"/",mode_bus:"",mode_car:"/",mode_flight:"",minutes:"",search_placeholder:" (: )",search_location:""}},Eb=({trips:n,onSelectTrip:e,onAddTrip:t,onOpenSettings:i,settings:r})=>{const[l,c]=W.useState(new Set),[m,g]=W.useState(new Set),p=Xt[r.language]||Xt["zh-TW"],E=S=>{c(C=>{const M=new Set(C);return M.add(S),M})};return T.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[T.jsxs("div",{className:"px-6 py-5 sticky top-0 z-10 flex justify-between items-center bg-paper/90 backdrop-blur-sm",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"w-14 h-14 flex items-center justify-center overflow-hidden",children:T.jsx("img",{src:"/nomadai-travel-journal_app_icon.png",alt:"Icon",className:"w-full h-full object-cover"})}),T.jsx("h1",{className:"text-3xl font-extrabold text-ink tracking-tight",children:p.my_trips})]}),T.jsx("button",{onClick:i,className:"p-2.5 bg-white shadow-card rounded-full text-gray-400 hover:text-coral transition-colors active:scale-95",children:T.jsx(hb,{className:"w-6 h-6"})})]}),T.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-2 space-y-6 pb-32 no-scrollbar",children:n.length===0?T.jsxs("div",{className:"flex flex-col items-center justify-center h-80 text-center animate-fade-in border-2 border-dashed border-sand rounded-3xl m-4",children:[T.jsx("div",{className:"w-16 h-16 bg-white shadow-soft rounded-full flex items-center justify-center mb-4 text-coral",children:T.jsx(Up,{className:"w-8 h-8"})}),T.jsx("h3",{className:"text-xl font-bold text-ink mb-1",children:p.start_adventure}),T.jsx("p",{className:"text-gray-400 text-sm",children:p.click_to_add})]}):n==null?void 0:n.map(S=>{var C;return T.jsxs("div",{onClick:()=>e(S),className:`group cursor-pointer active:scale-[0.98] transition-all transform bg-white rounded-3xl shadow-card hover:shadow-soft overflow-hidden ${r.minimalistMode?"p-5 border border-sand":"p-3"}`,children:[!r.minimalistMode&&T.jsxs("div",{className:"aspect-[2/1] w-full relative overflow-hidden rounded-2xl bg-gray-100 mb-4 shadow-inner group",children:[S.coverImage&&!l.has(S.id)?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:`absolute inset-0 bg-gray-200 transition-opacity duration-500 ${m.has(S.id)?"opacity-0 pointer-events-none":"opacity-100"}`}),T.jsx("img",{src:S.coverImage,alt:S.title,onLoad:()=>g(M=>new Set(M).add(S.id)),onError:()=>E(S.id),className:`w-full h-full object-cover transition-all duration-700 ${m.has(S.id)?"opacity-100 group-hover:scale-105":"opacity-0"}`})]}):T.jsx("div",{className:"w-full h-full bg-sand/30 flex items-center justify-center",children:T.jsx(Up,{className:"w-12 h-12 text-gray-300"})}),T.jsxs("div",{className:"absolute top-3 right-3 bg-white/90 backdrop-blur text-ink text-xs font-bold px-3 py-1.5 rounded-full shadow-sm z-10",children:[((C=S.itinerary)==null?void 0:C.length)||0," ",p.trips_count]})]}),T.jsxs("div",{className:`${r.minimalistMode?"flex justify-between items-center":"px-2 pb-2"}`,children:[T.jsxs("div",{children:[T.jsx("h3",{className:`font-bold text-ink leading-tight ${r.minimalistMode?"text-lg":"text-xl mb-1"}`,children:S.title}),T.jsxs("div",{className:"flex items-center text-sm text-gray-400 font-medium",children:[T.jsx(zp,{className:"w-4 h-4 mr-1.5 text-coral"}),T.jsxs("span",{children:[S.startDate," - ",S.endDate]})]})]}),r.minimalistMode&&T.jsx("div",{className:"w-8 h-8 bg-paper rounded-full flex items-center justify-center text-coral",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-4 h-4",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})})})]})]},S.id)})}),T.jsx("button",{onClick:t,className:"fixed bottom-28 right-6 w-16 h-16 bg-coral text-white rounded-full shadow-float flex items-center justify-center transition-all active:scale-90 hover:bg-coralDark z-50 ring-4 ring-white",children:T.jsx(nf,{className:"w-8 h-8 stroke-[2]"})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let wb,Sb;function Ab(){return{geminiUrl:wb,vertexUrl:Sb}}function Cb(n,e,t,i){var r,l;if(!(n!=null&&n.baseUrl)){const c=Ab();return e?(r=c.vertexUrl)!==null&&r!==void 0?r:t:(l=c.geminiUrl)!==null&&l!==void 0?l:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hr{}function ke(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const l=e[r];return l!=null?String(l):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function _(n,e,t){for(let l=0;l<e.length-1;l++){const c=e[l];if(c.endsWith("[]")){const m=c.slice(0,-2);if(!(m in n))if(Array.isArray(t))n[m]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(n[m])){const g=n[m];if(Array.isArray(t))for(let p=0;p<g.length;p++){const E=g[p];_(E,e.slice(l+1),t[p])}else for(const p of g)_(p,e.slice(l+1),t)}return}else if(c.endsWith("[0]")){const m=c.slice(0,-3);m in n||(n[m]=[{}]);const g=n[m];_(g[0],e.slice(l+1),t);return}(!n[c]||typeof n[c]!="object")&&(n[c]={}),n=n[c]}const i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function f(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const r=e[i];if(r.endsWith("[]")){const l=r.slice(0,-2);if(l in n){const c=n[l];return Array.isArray(c)?c.map(m=>f(m,e.slice(i+1),t)):t}else return t}else n=n[r]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function bb(n,e){for(const[t,i]of Object.entries(e)){const r=t.split("."),l=i.split("."),c=new Set;let m=-1;for(let g=0;g<r.length;g++)if(r[g]==="*"){m=g;break}if(m!==-1&&l.length>m)for(let g=m;g<l.length;g++){const p=l[g];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&c.add(p)}Fp(n,r,l,0,c)}}function Fp(n,e,t,i,r){if(i>=e.length||typeof n!="object"||n===null)return;const l=e[i];if(l.endsWith("[]")){const c=l.slice(0,-2),m=n;if(c in m&&Array.isArray(m[c]))for(const g of m[c])Fp(g,e,t,i+1,r)}else if(l==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const c=n,m=Object.keys(c).filter(p=>!p.startsWith("_")&&!r.has(p)),g={};for(const p of m)g[p]=c[p];for(const[p,E]of Object.entries(g)){const S=[];for(const C of t.slice(i))C==="*"?S.push(p):S.push(C);_(c,S,E)}for(const p of m)delete c[p]}}else{const c=n;l in c&&Fp(c[l],e,t,i+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ng(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ib(n){const e={},t=f(n,["operationName"]);t!=null&&_(e,["operationName"],t);const i=f(n,["resourceName"]);return i!=null&&_(e,["_url","resourceName"],i),e}function Nb(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const l=f(n,["error"]);l!=null&&_(e,["error"],l);const c=f(n,["response","generateVideoResponse"]);return c!=null&&_(e,["response"],Mb(c)),e}function Rb(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const l=f(n,["error"]);l!=null&&_(e,["error"],l);const c=f(n,["response"]);return c!=null&&_(e,["response"],Pb(c)),e}function Mb(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>kb(c))),_(e,["generatedVideos"],l)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function Pb(n){const e={},t=f(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>Db(c))),_(e,["generatedVideos"],l)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function kb(n){const e={},t=f(n,["video"]);return t!=null&&_(e,["video"],Bb(t)),e}function Db(n){const e={},t=f(n,["_self"]);return t!=null&&_(e,["video"],Fb(t)),e}function Lb(n){const e={},t=f(n,["operationName"]);return t!=null&&_(e,["_url","operationName"],t),e}function Vb(n){const e={},t=f(n,["operationName"]);return t!=null&&_(e,["_url","operationName"],t),e}function Ob(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const l=f(n,["error"]);l!=null&&_(e,["error"],l);const c=f(n,["response"]);return c!=null&&_(e,["response"],Ub(c)),e}function Ub(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["parent"]);i!=null&&_(e,["parent"],i);const r=f(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function hw(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const l=f(n,["error"]);l!=null&&_(e,["error"],l);const c=f(n,["response"]);return c!=null&&_(e,["response"],zb(c)),e}function zb(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["parent"]);i!=null&&_(e,["parent"],i);const r=f(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function Bb(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["uri"],t);const i=f(n,["encodedVideo"]);i!=null&&_(e,["videoBytes"],Ng(i));const r=f(n,["encoding"]);return r!=null&&_(e,["mimeType"],r),e}function Fb(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["uri"],t);const i=f(n,["bytesBase64Encoded"]);i!=null&&_(e,["videoBytes"],Ng(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Y0;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Y0||(Y0={}));var W0;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(W0||(W0={}));var J0;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(J0||(J0={}));var na;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(na||(na={}));var Q0;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Q0||(Q0={}));var $0;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})($0||($0={}));var X0;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(X0||(X0={}));var eT;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(eT||(eT={}));var tT;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(tT||(tT={}));var nT;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(nT||(nT={}));var iT;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(iT||(iT={}));var sT;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(sT||(sT={}));var oT;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(oT||(oT={}));var rT;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(rT||(rT={}));var aT;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(aT||(aT={}));var lT;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(lT||(lT={}));var uT;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(uT||(uT={}));var cT;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(cT||(cT={}));var dT;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(dT||(dT={}));var kh;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(kh||(kh={}));var hT;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(hT||(hT={}));var fT;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(fT||(fT={}));var mT;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(mT||(mT={}));var qp;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(qp||(qp={}));var pT;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(pT||(pT={}));var gT;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(gT||(gT={}));var _T;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(_T||(_T={}));var yT;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(yT||(yT={}));var vT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(vT||(vT={}));var TT;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(TT||(TT={}));var xT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(xT||(xT={}));var ET;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(ET||(ET={}));var wT;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(wT||(wT={}));var ST;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(ST||(ST={}));var AT;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(AT||(AT={}));var CT;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(CT||(CT={}));var bT;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(bT||(bT={}));var IT;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(IT||(IT={}));var NT;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(NT||(NT={}));var RT;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(RT||(RT={}));var MT;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(MT||(MT={}));var PT;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(PT||(PT={}));var kT;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(kT||(kT={}));var DT;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(DT||(DT={}));var LT;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(LT||(LT={}));var VT;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(VT||(VT={}));var OT;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(OT||(OT={}));var UT;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(UT||(UT={}));var zT;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(zT||(zT={}));var BT;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(BT||(BT={}));var FT;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(FT||(FT={}));var qT;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(qT||(qT={}));var HT;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(HT||(HT={}));var GT;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(GT||(GT={}));var lu;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(lu||(lu={}));class Hp{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Cc{get text(){var e,t,i,r,l,c,m,g;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",E=!1;const S=[];for(const C of(g=(m=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)!==null&&g!==void 0?g:[]){for(const[M,z]of Object.entries(C))M!=="text"&&M!=="thought"&&M!=="thoughtSignature"&&(z!==null||z!==void 0)&&S.push(M);if(typeof C.text=="string"){if(typeof C.thought=="boolean"&&C.thought)continue;E=!0,p+=C.text}}return S.length>0&&console.warn(`there are non-text parts ${S} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),E?p:void 0}get data(){var e,t,i,r,l,c,m,g;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const E=[];for(const S of(g=(m=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)!==null&&g!==void 0?g:[]){for(const[C,M]of Object.entries(S))C!=="inlineData"&&(M!==null||M!==void 0)&&E.push(C);S.inlineData&&typeof S.inlineData.data=="string"&&(p+=atob(S.inlineData.data))}return E.length>0&&console.warn(`there are non-data parts ${E} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,r,l,c,m,g;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(g=(m=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)===null||g===void 0?void 0:g.filter(E=>E.functionCall).map(E=>E.functionCall).filter(E=>E!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,r,l,c,m,g,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const E=(g=(m=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)===null||g===void 0?void 0:g.filter(S=>S.executableCode).map(S=>S.executableCode).filter(S=>S!==void 0);if((E==null?void 0:E.length)!==0)return(p=E==null?void 0:E[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,r,l,c,m,g,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const E=(g=(m=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)===null||g===void 0?void 0:g.filter(S=>S.codeExecutionResult).map(S=>S.codeExecutionResult).filter(S=>S!==void 0);if((E==null?void 0:E.length)!==0)return(p=E==null?void 0:E[0])===null||p===void 0?void 0:p.output}}class jT{}class KT{}class qb{}class Hb{}class Gb{}class jb{}class ZT{}class YT{}class WT{}class Kb{}class Dh{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Dh;let r;const l=e;return t?r=Rb(l):r=Nb(l),Object.assign(i,r),i}}class JT{}class QT{}class $T{}class Zb{}class Yb{}class Wb{}class Rg{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Rg,l=Ob(e);return Object.assign(i,l),i}}class Jb{}class Qb{}class $b{}class XT{}class Xb{get text(){var e,t,i;let r="",l=!1;const c=[];for(const m of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[g,p]of Object.entries(m))g!=="text"&&g!=="thought"&&p!==null&&c.push(g);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;l=!0,r+=m.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?r:void 0}get data(){var e,t,i;let r="";const l=[];for(const c of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[m,g]of Object.entries(c))m!=="inlineData"&&g!==null&&l.push(m);c.inlineData&&typeof c.inlineData.data=="string"&&(r+=atob(c.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class eI{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Mg{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Mg,l=hw(e);return Object.assign(i,l),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function fw(n,e){const t=Bt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function mw(n){return Array.isArray(n)?n.map(e=>Lh(e)):[Lh(n)]}function Lh(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function pw(n){const e=Lh(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function gw(n){const e=Lh(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function ex(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function _w(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>ex(e)):[ex(n)]}function Gp(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function tx(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function nx(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function mi(n){if(n==null)throw new Error("ContentUnion is required");return Gp(n)?n:{role:"user",parts:_w(n)}}function Pg(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=mi(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=mi(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>mi(t)):[mi(e)]}function Ms(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(tx(n)||nx(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[mi(n)]}const e=[],t=[],i=Gp(n[0]);for(const r of n){const l=Gp(r);if(l!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(r);else{if(tx(r)||nx(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:_w(t)}),e}function tI(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(na).includes(t[0].toUpperCase())?t[0].toUpperCase():na.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(na).includes(i.toUpperCase())?i.toUpperCase():na.TYPE_UNSPECIFIED})}}function uu(n){const e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,n=l[1]):l[1].type==="null"&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&tI(n.type,e);for(const[c,m]of Object.entries(n))if(m!=null)if(c=="type"){if(m==="null")throw new Error("type: null can not be the only possible type for the field.");if(m instanceof Array)continue;e.type=Object.values(na).includes(m.toUpperCase())?m.toUpperCase():na.TYPE_UNSPECIFIED}else if(t.includes(c))e[c]=uu(m);else if(i.includes(c)){const g=[];for(const p of m){if(p.type=="null"){e.nullable=!0;continue}g.push(uu(p))}e[c]=g}else if(r.includes(c)){const g={};for(const[p,E]of Object.entries(m))g[p]=uu(E);e[c]=g}else{if(c==="additionalProperties")continue;e[c]=m}return e}function kg(n){return uu(n)}function Dg(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Lg(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Iu(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=uu(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=uu(e.response));return n}function Nu(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function nI(n,e,t,i=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function fr(n,e){if(typeof e!="string")throw new Error("name must be a string");return nI(n,e,"cachedContents")}function yw(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function va(n){return Ng(n)}function iI(n){return n!=null&&typeof n=="object"&&"name"in n}function sI(n){return n!=null&&typeof n=="object"&&"video"in n}function oI(n){return n!=null&&typeof n=="object"&&"uri"in n}function vw(n){var e;let t;if(iI(n)&&(t=n.name),!(oI(n)&&(t=n.uri,t===void 0))&&!(sI(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function Tw(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function xw(n){for(const e of["models","tunedModels","publisherModels"])if(rI(n,e))return n[e];return[]}function rI(n,e){return n!==null&&typeof n=="object"&&e in n}function aI(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function lI(n,e={}){const t=[],i=new Set;for(const r of n){const l=r.name;if(i.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);i.add(l);const c=aI(r,e);c.functionDeclarations&&t.push(...c.functionDeclarations)}return{functionDeclarations:t}}function Ew(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function uI(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function ww(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let l=!1;for(const c of r){if(typeof c!="object"||c===null)continue;const g=c.response;if(typeof g!="object"||g===null)continue;if(g.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Ru(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Sw(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cI(n){const e={},t=f(n,["responsesFile"]);t!=null&&_(e,["fileName"],t);const i=f(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>GI(c))),_(e,["inlinedResponses"],l)}const r=f(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),_(e,["inlinedEmbedContentResponses"],l)}return e}function dI(n){const e={},t=f(n,["predictionsFormat"]);t!=null&&_(e,["format"],t);const i=f(n,["gcsDestination","outputUriPrefix"]);i!=null&&_(e,["gcsUri"],i);const r=f(n,["bigqueryDestination","outputUri"]);return r!=null&&_(e,["bigqueryUri"],r),e}function hI(n){const e={},t=f(n,["format"]);t!=null&&_(e,["predictionsFormat"],t);const i=f(n,["gcsUri"]);i!=null&&_(e,["gcsDestination","outputUriPrefix"],i);const r=f(n,["bigqueryUri"]);if(r!=null&&_(e,["bigqueryDestination","outputUri"],r),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Th(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata","displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["metadata","state"]);r!=null&&_(e,["state"],Sw(r));const l=f(n,["metadata","createTime"]);l!=null&&_(e,["createTime"],l);const c=f(n,["metadata","endTime"]);c!=null&&_(e,["endTime"],c);const m=f(n,["metadata","updateTime"]);m!=null&&_(e,["updateTime"],m);const g=f(n,["metadata","model"]);g!=null&&_(e,["model"],g);const p=f(n,["metadata","output"]);return p!=null&&_(e,["dest"],cI(ww(p))),e}function jp(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["state"]);r!=null&&_(e,["state"],Sw(r));const l=f(n,["error"]);l!=null&&_(e,["error"],l);const c=f(n,["createTime"]);c!=null&&_(e,["createTime"],c);const m=f(n,["startTime"]);m!=null&&_(e,["startTime"],m);const g=f(n,["endTime"]);g!=null&&_(e,["endTime"],g);const p=f(n,["updateTime"]);p!=null&&_(e,["updateTime"],p);const E=f(n,["model"]);E!=null&&_(e,["model"],E);const S=f(n,["inputConfig"]);S!=null&&_(e,["src"],fI(S));const C=f(n,["outputConfig"]);C!=null&&_(e,["dest"],dI(ww(C)));const M=f(n,["completionStats"]);return M!=null&&_(e,["completionStats"],M),e}function fI(n){const e={},t=f(n,["instancesFormat"]);t!=null&&_(e,["format"],t);const i=f(n,["gcsSource","uris"]);i!=null&&_(e,["gcsUri"],i);const r=f(n,["bigquerySource","inputUri"]);return r!=null&&_(e,["bigqueryUri"],r),e}function mI(n,e){const t={};if(f(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=f(e,["fileName"]);i!=null&&_(t,["fileName"],i);const r=f(e,["inlinedRequests"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>HI(n,c))),_(t,["requests","requests"],l)}return t}function pI(n){const e={},t=f(n,["format"]);t!=null&&_(e,["instancesFormat"],t);const i=f(n,["gcsUri"]);i!=null&&_(e,["gcsSource","uris"],i);const r=f(n,["bigqueryUri"]);if(r!=null&&_(e,["bigquerySource","inputUri"],r),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function gI(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function _I(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Ru(n,i)),t}function yI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Ru(n,i)),t}function vI(n){const e={},t=f(n,["content"]);t!=null&&_(e,["content"],t);const i=f(n,["citationMetadata"]);i!=null&&_(e,["citationMetadata"],TI(i));const r=f(n,["tokenCount"]);r!=null&&_(e,["tokenCount"],r);const l=f(n,["finishReason"]);l!=null&&_(e,["finishReason"],l);const c=f(n,["avgLogprobs"]);c!=null&&_(e,["avgLogprobs"],c);const m=f(n,["groundingMetadata"]);m!=null&&_(e,["groundingMetadata"],m);const g=f(n,["index"]);g!=null&&_(e,["index"],g);const p=f(n,["logprobsResult"]);p!=null&&_(e,["logprobsResult"],p);const E=f(n,["safetyRatings"]);if(E!=null){let C=E;Array.isArray(C)&&(C=C.map(M=>M)),_(e,["safetyRatings"],C)}const S=f(n,["urlContextMetadata"]);return S!=null&&_(e,["urlContextMetadata"],S),e}function TI(n){const e={},t=f(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["citations"],i)}return e}function Aw(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>QI(l))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function xI(n,e){const t={},i=f(n,["displayName"]);if(e!==void 0&&i!=null&&_(e,["batch","displayName"],i),f(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function EI(n,e){const t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=f(n,["dest"]);return e!==void 0&&r!=null&&_(e,["outputConfig"],hI(uI(r))),t}function ix(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["src"]);r!=null&&_(t,["batch","inputConfig"],mI(n,Ew(n,r)));const l=f(e,["config"]);return l!=null&&xI(l,t),t}function wI(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["model"],Bt(n,i));const r=f(e,["src"]);r!=null&&_(t,["inputConfig"],pI(Ew(n,r)));const l=f(e,["config"]);return l!=null&&EI(l,t),t}function SI(n,e){const t={},i=f(n,["displayName"]);return e!==void 0&&i!=null&&_(e,["batch","displayName"],i),t}function AI(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["src"]);r!=null&&_(t,["batch","inputConfig"],PI(n,r));const l=f(e,["config"]);return l!=null&&SI(l,t),t}function CI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Ru(n,i)),t}function bI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Ru(n,i)),t}function II(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const l=f(n,["error"]);return l!=null&&_(e,["error"],l),e}function NI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const l=f(n,["error"]);return l!=null&&_(e,["error"],l),e}function RI(n,e){const t={},i=f(e,["contents"]);if(i!=null){let l=Pg(n,i);Array.isArray(l)&&(l=l.map(c=>c)),_(t,["requests[]","request","content"],l)}const r=f(e,["config"]);return r!=null&&(_(t,["_self"],MI(r,t)),bb(t,{"requests[].*":"requests[].request.*"})),t}function MI(n,e){const t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&_(e,["requests[]","taskType"],i);const r=f(n,["title"]);e!==void 0&&r!=null&&_(e,["requests[]","title"],r);const l=f(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&_(e,["requests[]","outputDimensionality"],l),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function PI(n,e){const t={},i=f(e,["fileName"]);i!=null&&_(t,["file_name"],i);const r=f(e,["inlinedRequests"]);return r!=null&&_(t,["requests"],RI(n,r)),t}function kI(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function DI(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function LI(n){const e={},t=f(n,["mode"]);t!=null&&_(e,["mode"],t);const i=f(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function VI(n,e,t){const i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],Aw(mi(r)));const l=f(e,["temperature"]);l!=null&&_(i,["temperature"],l);const c=f(e,["topP"]);c!=null&&_(i,["topP"],c);const m=f(e,["topK"]);m!=null&&_(i,["topK"],m);const g=f(e,["candidateCount"]);g!=null&&_(i,["candidateCount"],g);const p=f(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const E=f(e,["stopSequences"]);E!=null&&_(i,["stopSequences"],E);const S=f(e,["responseLogprobs"]);S!=null&&_(i,["responseLogprobs"],S);const C=f(e,["logprobs"]);C!=null&&_(i,["logprobs"],C);const M=f(e,["presencePenalty"]);M!=null&&_(i,["presencePenalty"],M);const z=f(e,["frequencyPenalty"]);z!=null&&_(i,["frequencyPenalty"],z);const H=f(e,["seed"]);H!=null&&_(i,["seed"],H);const Y=f(e,["responseMimeType"]);Y!=null&&_(i,["responseMimeType"],Y);const te=f(e,["responseSchema"]);te!=null&&_(i,["responseSchema"],kg(te));const re=f(e,["responseJsonSchema"]);if(re!=null&&_(i,["responseJsonSchema"],re),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=f(e,["safetySettings"]);if(t!==void 0&&ee!=null){let j=ee;Array.isArray(j)&&(j=j.map(B=>$I(B))),_(t,["safetySettings"],j)}const ge=f(e,["tools"]);if(t!==void 0&&ge!=null){let j=Nu(ge);Array.isArray(j)&&(j=j.map(B=>e2(Iu(B)))),_(t,["tools"],j)}const pe=f(e,["toolConfig"]);if(t!==void 0&&pe!=null&&_(t,["toolConfig"],XI(pe)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=f(e,["cachedContent"]);t!==void 0&&J!=null&&_(t,["cachedContent"],fr(n,J));const k=f(e,["responseModalities"]);k!=null&&_(i,["responseModalities"],k);const U=f(e,["mediaResolution"]);U!=null&&_(i,["mediaResolution"],U);const V=f(e,["speechConfig"]);if(V!=null&&_(i,["speechConfig"],Dg(V)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const F=f(e,["thinkingConfig"]);F!=null&&_(i,["thinkingConfig"],F);const q=f(e,["imageConfig"]);return q!=null&&_(i,["imageConfig"],qI(q)),i}function OI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(p=>vI(p))),_(e,["candidates"],g)}const r=f(n,["modelVersion"]);r!=null&&_(e,["modelVersion"],r);const l=f(n,["promptFeedback"]);l!=null&&_(e,["promptFeedback"],l);const c=f(n,["responseId"]);c!=null&&_(e,["responseId"],c);const m=f(n,["usageMetadata"]);return m!=null&&_(e,["usageMetadata"],m),e}function UI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Ru(n,i)),t}function zI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Ru(n,i)),t}function BI(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function FI(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function qI(n){const e={},t=f(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=f(n,["imageSize"]);if(i!=null&&_(e,["imageSize"],i),f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function HI(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["request","model"],Bt(n,i));const r=f(e,["contents"]);if(r!=null){let m=Ms(r);Array.isArray(m)&&(m=m.map(g=>Aw(g))),_(t,["request","contents"],m)}const l=f(e,["metadata"]);l!=null&&_(t,["metadata"],l);const c=f(e,["config"]);return c!=null&&_(t,["request","generationConfig"],VI(n,c,f(t,["request"],{}))),t}function GI(n){const e={},t=f(n,["response"]);t!=null&&_(e,["response"],OI(t));const i=f(n,["error"]);return i!=null&&_(e,["error"],i),e}function jI(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);if(e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),f(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function KI(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);e!==void 0&&r!=null&&_(e,["_query","pageToken"],r);const l=f(n,["filter"]);return e!==void 0&&l!=null&&_(e,["_query","filter"],l),t}function ZI(n){const e={},t=f(n,["config"]);return t!=null&&jI(t,e),e}function YI(n){const e={},t=f(n,["config"]);return t!=null&&KI(t,e),e}function WI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["operations"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>Th(c))),_(e,["batchJobs"],l)}return e}function JI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["batchPredictionJobs"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>jp(c))),_(e,["batchJobs"],l)}return e}function QI(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const l=f(n,["fileData"]);l!=null&&_(e,["fileData"],kI(l));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],DI(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],gI(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const E=f(n,["thought"]);E!=null&&_(e,["thought"],E);const S=f(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const C=f(n,["videoMetadata"]);return C!=null&&_(e,["videoMetadata"],C),e}function $I(n){const e={},t=f(n,["category"]);if(t!=null&&_(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=f(n,["threshold"]);return i!=null&&_(e,["threshold"],i),e}function XI(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],LI(t));const i=f(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function e2(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>S)),_(e,["functionDeclarations"],E)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const l=f(n,["fileSearch"]);l!=null&&_(e,["fileSearch"],l);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],BI(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],FI(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var rr;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(rr||(rr={}));class ml{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let c={config:{}};!i||Object.keys(i).length===0?c={config:{}}:typeof i=="object"?c=Object.assign({},i):c=i,c.config&&(c.config.pageToken=t.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(l=(r=c.config)===null||r===void 0?void 0:r.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t2 extends hr{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new ml(rr.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=ix(this.apiClient,e),i=t._url,r=ke("{model}:batchGenerateContent",i),m=t.batch.inputConfig.requests,g=m.requests,p=[];for(const E of g){const S=Object.assign({},E);if(S.systemInstruction){const C=S.systemInstruction;delete S.systemInstruction;const M=S.request;M.systemInstruction=C,S.request=M}p.push(S)}return m.requests=p,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const l=this.getGcsUri(e),c=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?i.dest=`${l.slice(0,-6)}/dest`:i.dest=`${l}_dest_${r}`;else if(c)i.dest=`${c}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=wI(this.apiClient,e);return m=ke("batchPredictionJobs",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),c.then(E=>jp(E))}else{const p=ix(this.apiClient,e);return m=ke("{model}:batchGenerateContent",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json()),c.then(E=>Th(E))}}async createEmbeddingsInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=AI(this.apiClient,e);return l=ke("{model}:asyncBatchEmbedContent",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>Th(g))}}async get(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=zI(this.apiClient,e);return m=ke("batchPredictionJobs/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),c.then(E=>jp(E))}else{const p=UI(this.apiClient,e);return m=ke("batches/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json()),c.then(E=>Th(E))}}async cancel(e){var t,i,r,l;let c="",m={};if(this.apiClient.isVertexAI()){const g=yI(this.apiClient,e);c=ke("batchPredictionJobs/{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=_I(this.apiClient,e);c=ke("batches/{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=YI(e);return m=ke("batchPredictionJobs",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=JI(E),C=new XT;return Object.assign(C,S),C})}else{const p=ZI(e);return m=ke("batches",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=WI(E),C=new XT;return Object.assign(C,S),C})}}async delete(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=bI(this.apiClient,e);return m=ke("batchPredictionJobs/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>NI(E))}else{const p=CI(this.apiClient,e);return m=ke("batches/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>II(E))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n2(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function sx(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>A2(l))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function i2(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);e!==void 0&&r!=null&&_(e,["expireTime"],r);const l=f(n,["displayName"]);e!==void 0&&l!=null&&_(e,["displayName"],l);const c=f(n,["contents"]);if(e!==void 0&&c!=null){let E=Ms(c);Array.isArray(E)&&(E=E.map(S=>sx(S))),_(e,["contents"],E)}const m=f(n,["systemInstruction"]);e!==void 0&&m!=null&&_(e,["systemInstruction"],sx(mi(m)));const g=f(n,["tools"]);if(e!==void 0&&g!=null){let E=g;Array.isArray(E)&&(E=E.map(S=>b2(S))),_(e,["tools"],E)}const p=f(n,["toolConfig"]);if(e!==void 0&&p!=null&&_(e,["toolConfig"],C2(p)),f(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function s2(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);e!==void 0&&r!=null&&_(e,["expireTime"],r);const l=f(n,["displayName"]);e!==void 0&&l!=null&&_(e,["displayName"],l);const c=f(n,["contents"]);if(e!==void 0&&c!=null){let S=Ms(c);Array.isArray(S)&&(S=S.map(C=>C)),_(e,["contents"],S)}const m=f(n,["systemInstruction"]);e!==void 0&&m!=null&&_(e,["systemInstruction"],mi(m));const g=f(n,["tools"]);if(e!==void 0&&g!=null){let S=g;Array.isArray(S)&&(S=S.map(C=>I2(C))),_(e,["tools"],S)}const p=f(n,["toolConfig"]);e!==void 0&&p!=null&&_(e,["toolConfig"],p);const E=f(n,["kmsKeyName"]);return e!==void 0&&E!=null&&_(e,["encryption_spec","kmsKeyName"],E),t}function o2(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["model"],fw(n,i));const r=f(e,["config"]);return r!=null&&i2(r,t),t}function r2(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["model"],fw(n,i));const r=f(e,["config"]);return r!=null&&s2(r,t),t}function a2(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],fr(n,i)),t}function l2(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],fr(n,i)),t}function u2(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function c2(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function d2(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function h2(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function f2(n){const e={},t=f(n,["mode"]);t!=null&&_(e,["mode"],t);const i=f(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function m2(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&_(e,["description"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["parameters"]);r!=null&&_(e,["parameters"],r);const l=f(n,["parametersJsonSchema"]);l!=null&&_(e,["parametersJsonSchema"],l);const c=f(n,["response"]);c!=null&&_(e,["response"],c);const m=f(n,["responseJsonSchema"]);return m!=null&&_(e,["responseJsonSchema"],m),e}function p2(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],fr(n,i)),t}function g2(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],fr(n,i)),t}function _2(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function y2(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function v2(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function T2(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function x2(n){const e={},t=f(n,["config"]);return t!=null&&v2(t,e),e}function E2(n){const e={},t=f(n,["config"]);return t!=null&&T2(t,e),e}function w2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["cachedContents"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),_(e,["cachedContents"],l)}return e}function S2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["cachedContents"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),_(e,["cachedContents"],l)}return e}function A2(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const l=f(n,["fileData"]);l!=null&&_(e,["fileData"],d2(l));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],h2(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],n2(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const E=f(n,["thought"]);E!=null&&_(e,["thought"],E);const S=f(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const C=f(n,["videoMetadata"]);return C!=null&&_(e,["videoMetadata"],C),e}function C2(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],f2(t));const i=f(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function b2(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>S)),_(e,["functionDeclarations"],E)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const l=f(n,["fileSearch"]);l!=null&&_(e,["fileSearch"],l);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],_2(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],y2(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function I2(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let S=t;Array.isArray(S)&&(S=S.map(C=>m2(C))),_(e,["functionDeclarations"],S)}const i=f(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=f(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const l=f(n,["computerUse"]);if(l!=null&&_(e,["computerUse"],l),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=f(n,["codeExecution"]);c!=null&&_(e,["codeExecution"],c);const m=f(n,["enterpriseWebSearch"]);m!=null&&_(e,["enterpriseWebSearch"],m);const g=f(n,["googleMaps"]);g!=null&&_(e,["googleMaps"],g);const p=f(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const E=f(n,["urlContext"]);return E!=null&&_(e,["urlContext"],E),e}function N2(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);return e!==void 0&&r!=null&&_(e,["expireTime"],r),t}function R2(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);return e!==void 0&&r!=null&&_(e,["expireTime"],r),t}function M2(n,e){const t={},i=f(e,["name"]);i!=null&&_(t,["_url","name"],fr(n,i));const r=f(e,["config"]);return r!=null&&N2(r,t),t}function P2(n,e){const t={},i=f(e,["name"]);i!=null&&_(t,["_url","name"],fr(n,i));const r=f(e,["config"]);return r!=null&&R2(r,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k2 extends hr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ml(rr.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=r2(this.apiClient,e);return m=ke("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),c.then(E=>E)}else{const p=o2(this.apiClient,e);return m=ke("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json()),c.then(E=>E)}}async get(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=g2(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),c.then(E=>E)}else{const p=p2(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json()),c.then(E=>E)}}async delete(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=l2(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=c2(E),C=new QT;return Object.assign(C,S),C})}else{const p=a2(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=u2(E),C=new QT;return Object.assign(C,S),C})}}async update(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=P2(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),c.then(E=>E)}else{const p=M2(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json()),c.then(E=>E)}}async listInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=E2(e);return m=ke("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=S2(E),C=new $T;return Object.assign(C,S),C})}else{const p=x2(e);return m=ke("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=w2(E),C=new $T;return Object.assign(C,S),C})}}}function ox(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function an(n){return this instanceof an?(this.v=n,this):new an(n)}function cu(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,l=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",c),r[Symbol.asyncIterator]=function(){return this},r;function c(M){return function(z){return Promise.resolve(z).then(M,S)}}function m(M,z){i[M]&&(r[M]=function(H){return new Promise(function(Y,te){l.push([M,H,Y,te])>1||g(M,H)})},z&&(r[M]=z(r[M])))}function g(M,z){try{p(i[M](z))}catch(H){C(l[0][3],H)}}function p(M){M.value instanceof an?Promise.resolve(M.value.v).then(E,S):C(l[0][2],M)}function E(M){g("next",M)}function S(M){g("throw",M)}function C(M,z){M(z),l.shift(),l.length&&g(l[0][0],l[0][1])}}function Dc(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ox=="function"?ox(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=n[l]&&function(c){return new Promise(function(m,g){c=n[l](c),r(m,g,c.done,c.value)})}}function r(l,c,m,g){Promise.resolve(g).then(function(p){l({value:p,done:m})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function D2(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:Cw(t)}function Cw(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function L2(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function rx(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const r=[];let l=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),l&&!Cw(n[i])&&(l=!1),i++;l?e.push(...r):e.pop()}return e}class V2{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new O2(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class O2{constructor(e,t,i,r={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=l,this.sendPromise=Promise.resolve(),L2(l)}async sendMessage(e){var t;await this.sendPromise;const i=mi(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,c,m;const g=await r,p=(c=(l=g.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content,E=g.automaticFunctionCallingHistory,S=this.getHistory(!0).length;let C=[];E!=null&&(C=(m=E.slice(S))!==null&&m!==void 0?m:[]);const M=p?[p]:[];this.recordHistory(i,M,C)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const i=mi(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const l=await r;return this.processStreamResponse(l,i)}getHistory(e=!1){const t=e?rx(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,r;return cu(this,arguments,function*(){var c,m,g,p;const E=[];try{for(var S=!0,C=Dc(e),M;M=yield an(C.next()),c=M.done,!c;S=!0){p=M.value,S=!1;const z=p;if(D2(z)){const H=(r=(i=z.candidates)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.content;H!==void 0&&E.push(H)}yield yield an(z)}}catch(z){m={error:z}}finally{try{!S&&!c&&(g=C.return)&&(yield an(g.call(C)))}finally{if(m)throw m.error}}this.recordHistory(t,E)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(l=>l.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...rx(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sf extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,sf.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function U2(n){const e={},t=f(n,["file"]);return t!=null&&_(e,["file"],t),e}function z2(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function B2(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","file"],vw(t)),e}function F2(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function q2(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","file"],vw(t)),e}function H2(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function G2(n){const e={},t=f(n,["config"]);return t!=null&&H2(t,e),e}function j2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["files"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),_(e,["files"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class K2 extends hr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ml(rr.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=G2(e);return l=ke("files",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:g.headers},E})),r.then(g=>{const p=j2(g),E=new Jb;return Object.assign(E,p),E})}}async createInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=U2(e);return l=ke("upload/v1beta/files",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=z2(g),E=new Qb;return Object.assign(E,p),E})}}async get(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=q2(e);return l=ke("files/{file}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async delete(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=B2(e);return l=ke("files/{file}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:g.headers},E})),r.then(g=>{const p=F2(g),E=new $b;return Object.assign(E,p),E})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xh(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function Z2(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>uN(l))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function Y2(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function W2(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function J2(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&_(e,["description"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["parameters"]);r!=null&&_(e,["parameters"],r);const l=f(n,["parametersJsonSchema"]);l!=null&&_(e,["parametersJsonSchema"],l);const c=f(n,["response"]);c!=null&&_(e,["response"],c);const m=f(n,["responseJsonSchema"]);return m!=null&&_(e,["responseJsonSchema"],m),e}function Q2(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&_(e,["modelConfig"],t);const i=f(n,["responseJsonSchema"]);i!=null&&_(e,["responseJsonSchema"],i);const r=f(n,["audioTimestamp"]);r!=null&&_(e,["audioTimestamp"],r);const l=f(n,["candidateCount"]);l!=null&&_(e,["candidateCount"],l);const c=f(n,["enableAffectiveDialog"]);c!=null&&_(e,["enableAffectiveDialog"],c);const m=f(n,["frequencyPenalty"]);m!=null&&_(e,["frequencyPenalty"],m);const g=f(n,["logprobs"]);g!=null&&_(e,["logprobs"],g);const p=f(n,["maxOutputTokens"]);p!=null&&_(e,["maxOutputTokens"],p);const E=f(n,["mediaResolution"]);E!=null&&_(e,["mediaResolution"],E);const S=f(n,["presencePenalty"]);S!=null&&_(e,["presencePenalty"],S);const C=f(n,["responseLogprobs"]);C!=null&&_(e,["responseLogprobs"],C);const M=f(n,["responseMimeType"]);M!=null&&_(e,["responseMimeType"],M);const z=f(n,["responseModalities"]);z!=null&&_(e,["responseModalities"],z);const H=f(n,["responseSchema"]);H!=null&&_(e,["responseSchema"],H);const Y=f(n,["routingConfig"]);Y!=null&&_(e,["routingConfig"],Y);const te=f(n,["seed"]);te!=null&&_(e,["seed"],te);const re=f(n,["speechConfig"]);re!=null&&_(e,["speechConfig"],bw(re));const ee=f(n,["stopSequences"]);ee!=null&&_(e,["stopSequences"],ee);const ge=f(n,["temperature"]);ge!=null&&_(e,["temperature"],ge);const pe=f(n,["thinkingConfig"]);pe!=null&&_(e,["thinkingConfig"],pe);const J=f(n,["topK"]);J!=null&&_(e,["topK"],J);const k=f(n,["topP"]);if(k!=null&&_(e,["topP"],k),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function $2(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function X2(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function eN(n,e){const t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],i);const r=f(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const l=f(n,["temperature"]);e!==void 0&&l!=null&&_(e,["setup","generationConfig","temperature"],l);const c=f(n,["topP"]);e!==void 0&&c!=null&&_(e,["setup","generationConfig","topP"],c);const m=f(n,["topK"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","topK"],m);const g=f(n,["maxOutputTokens"]);e!==void 0&&g!=null&&_(e,["setup","generationConfig","maxOutputTokens"],g);const p=f(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const E=f(n,["seed"]);e!==void 0&&E!=null&&_(e,["setup","generationConfig","seed"],E);const S=f(n,["speechConfig"]);e!==void 0&&S!=null&&_(e,["setup","generationConfig","speechConfig"],Lg(S));const C=f(n,["thinkingConfig"]);e!==void 0&&C!=null&&_(e,["setup","generationConfig","thinkingConfig"],C);const M=f(n,["enableAffectiveDialog"]);e!==void 0&&M!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],M);const z=f(n,["systemInstruction"]);e!==void 0&&z!=null&&_(e,["setup","systemInstruction"],Z2(mi(z)));const H=f(n,["tools"]);if(e!==void 0&&H!=null){let J=Nu(H);Array.isArray(J)&&(J=J.map(k=>dN(Iu(k)))),_(e,["setup","tools"],J)}const Y=f(n,["sessionResumption"]);e!==void 0&&Y!=null&&_(e,["setup","sessionResumption"],cN(Y));const te=f(n,["inputAudioTranscription"]);e!==void 0&&te!=null&&_(e,["setup","inputAudioTranscription"],te);const re=f(n,["outputAudioTranscription"]);e!==void 0&&re!=null&&_(e,["setup","outputAudioTranscription"],re);const ee=f(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&_(e,["setup","realtimeInputConfig"],ee);const ge=f(n,["contextWindowCompression"]);e!==void 0&&ge!=null&&_(e,["setup","contextWindowCompression"],ge);const pe=f(n,["proactivity"]);return e!==void 0&&pe!=null&&_(e,["setup","proactivity"],pe),t}function tN(n,e){const t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],Q2(i));const r=f(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const l=f(n,["temperature"]);e!==void 0&&l!=null&&_(e,["setup","generationConfig","temperature"],l);const c=f(n,["topP"]);e!==void 0&&c!=null&&_(e,["setup","generationConfig","topP"],c);const m=f(n,["topK"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","topK"],m);const g=f(n,["maxOutputTokens"]);e!==void 0&&g!=null&&_(e,["setup","generationConfig","maxOutputTokens"],g);const p=f(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const E=f(n,["seed"]);e!==void 0&&E!=null&&_(e,["setup","generationConfig","seed"],E);const S=f(n,["speechConfig"]);e!==void 0&&S!=null&&_(e,["setup","generationConfig","speechConfig"],bw(Lg(S)));const C=f(n,["thinkingConfig"]);e!==void 0&&C!=null&&_(e,["setup","generationConfig","thinkingConfig"],C);const M=f(n,["enableAffectiveDialog"]);e!==void 0&&M!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],M);const z=f(n,["systemInstruction"]);e!==void 0&&z!=null&&_(e,["setup","systemInstruction"],mi(z));const H=f(n,["tools"]);if(e!==void 0&&H!=null){let J=Nu(H);Array.isArray(J)&&(J=J.map(k=>hN(Iu(k)))),_(e,["setup","tools"],J)}const Y=f(n,["sessionResumption"]);e!==void 0&&Y!=null&&_(e,["setup","sessionResumption"],Y);const te=f(n,["inputAudioTranscription"]);e!==void 0&&te!=null&&_(e,["setup","inputAudioTranscription"],te);const re=f(n,["outputAudioTranscription"]);e!==void 0&&re!=null&&_(e,["setup","outputAudioTranscription"],re);const ee=f(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&_(e,["setup","realtimeInputConfig"],ee);const ge=f(n,["contextWindowCompression"]);e!==void 0&&ge!=null&&_(e,["setup","contextWindowCompression"],ge);const pe=f(n,["proactivity"]);return e!==void 0&&pe!=null&&_(e,["setup","proactivity"],pe),t}function nN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["setup","model"],Bt(n,i));const r=f(e,["config"]);return r!=null&&_(t,["config"],eN(r,t)),t}function iN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["setup","model"],Bt(n,i));const r=f(e,["config"]);return r!=null&&_(t,["config"],tN(r,t)),t}function sN(n){const e={},t=f(n,["musicGenerationConfig"]);return t!=null&&_(e,["musicGenerationConfig"],t),e}function oN(n){const e={},t=f(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["weightedPrompts"],i)}return e}function rN(n){const e={},t=f(n,["media"]);if(t!=null){let p=mw(t);Array.isArray(p)&&(p=p.map(E=>xh(E))),_(e,["mediaChunks"],p)}const i=f(n,["audio"]);i!=null&&_(e,["audio"],xh(gw(i)));const r=f(n,["audioStreamEnd"]);r!=null&&_(e,["audioStreamEnd"],r);const l=f(n,["video"]);l!=null&&_(e,["video"],xh(pw(l)));const c=f(n,["text"]);c!=null&&_(e,["text"],c);const m=f(n,["activityStart"]);m!=null&&_(e,["activityStart"],m);const g=f(n,["activityEnd"]);return g!=null&&_(e,["activityEnd"],g),e}function aN(n){const e={},t=f(n,["media"]);if(t!=null){let p=mw(t);Array.isArray(p)&&(p=p.map(E=>E)),_(e,["mediaChunks"],p)}const i=f(n,["audio"]);i!=null&&_(e,["audio"],gw(i));const r=f(n,["audioStreamEnd"]);r!=null&&_(e,["audioStreamEnd"],r);const l=f(n,["video"]);l!=null&&_(e,["video"],pw(l));const c=f(n,["text"]);c!=null&&_(e,["text"],c);const m=f(n,["activityStart"]);m!=null&&_(e,["activityStart"],m);const g=f(n,["activityEnd"]);return g!=null&&_(e,["activityEnd"],g),e}function lN(n){const e={},t=f(n,["setupComplete"]);t!=null&&_(e,["setupComplete"],t);const i=f(n,["serverContent"]);i!=null&&_(e,["serverContent"],i);const r=f(n,["toolCall"]);r!=null&&_(e,["toolCall"],r);const l=f(n,["toolCallCancellation"]);l!=null&&_(e,["toolCallCancellation"],l);const c=f(n,["usageMetadata"]);c!=null&&_(e,["usageMetadata"],fN(c));const m=f(n,["goAway"]);m!=null&&_(e,["goAway"],m);const g=f(n,["sessionResumptionUpdate"]);return g!=null&&_(e,["sessionResumptionUpdate"],g),e}function uN(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const l=f(n,["fileData"]);l!=null&&_(e,["fileData"],Y2(l));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],W2(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],xh(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const E=f(n,["thought"]);E!=null&&_(e,["thought"],E);const S=f(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const C=f(n,["videoMetadata"]);return C!=null&&_(e,["videoMetadata"],C),e}function cN(n){const e={},t=f(n,["handle"]);if(t!=null&&_(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function bw(n){const e={},t=f(n,["languageCode"]);t!=null&&_(e,["languageCode"],t);const i=f(n,["voiceConfig"]);if(i!=null&&_(e,["voiceConfig"],i),f(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function dN(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>S)),_(e,["functionDeclarations"],E)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const l=f(n,["fileSearch"]);l!=null&&_(e,["fileSearch"],l);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],$2(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],X2(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function hN(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let S=t;Array.isArray(S)&&(S=S.map(C=>J2(C))),_(e,["functionDeclarations"],S)}const i=f(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=f(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const l=f(n,["computerUse"]);if(l!=null&&_(e,["computerUse"],l),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=f(n,["codeExecution"]);c!=null&&_(e,["codeExecution"],c);const m=f(n,["enterpriseWebSearch"]);m!=null&&_(e,["enterpriseWebSearch"],m);const g=f(n,["googleMaps"]);g!=null&&_(e,["googleMaps"],g);const p=f(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const E=f(n,["urlContext"]);return E!=null&&_(e,["urlContext"],E),e}function fN(n){const e={},t=f(n,["promptTokenCount"]);t!=null&&_(e,["promptTokenCount"],t);const i=f(n,["cachedContentTokenCount"]);i!=null&&_(e,["cachedContentTokenCount"],i);const r=f(n,["candidatesTokenCount"]);r!=null&&_(e,["responseTokenCount"],r);const l=f(n,["toolUsePromptTokenCount"]);l!=null&&_(e,["toolUsePromptTokenCount"],l);const c=f(n,["thoughtsTokenCount"]);c!=null&&_(e,["thoughtsTokenCount"],c);const m=f(n,["totalTokenCount"]);m!=null&&_(e,["totalTokenCount"],m);const g=f(n,["promptTokensDetails"]);if(g!=null){let M=g;Array.isArray(M)&&(M=M.map(z=>z)),_(e,["promptTokensDetails"],M)}const p=f(n,["cacheTokensDetails"]);if(p!=null){let M=p;Array.isArray(M)&&(M=M.map(z=>z)),_(e,["cacheTokensDetails"],M)}const E=f(n,["candidatesTokensDetails"]);if(E!=null){let M=E;Array.isArray(M)&&(M=M.map(z=>z)),_(e,["responseTokensDetails"],M)}const S=f(n,["toolUsePromptTokensDetails"]);if(S!=null){let M=S;Array.isArray(M)&&(M=M.map(z=>z)),_(e,["toolUsePromptTokensDetails"],M)}const C=f(n,["trafficType"]);return C!=null&&_(e,["trafficType"],C),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mN(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function pN(n){const e={},t=f(n,["content"]);t!=null&&_(e,["content"],t);const i=f(n,["citationMetadata"]);i!=null&&_(e,["citationMetadata"],gN(i));const r=f(n,["tokenCount"]);r!=null&&_(e,["tokenCount"],r);const l=f(n,["finishReason"]);l!=null&&_(e,["finishReason"],l);const c=f(n,["avgLogprobs"]);c!=null&&_(e,["avgLogprobs"],c);const m=f(n,["groundingMetadata"]);m!=null&&_(e,["groundingMetadata"],m);const g=f(n,["index"]);g!=null&&_(e,["index"],g);const p=f(n,["logprobsResult"]);p!=null&&_(e,["logprobsResult"],p);const E=f(n,["safetyRatings"]);if(E!=null){let C=E;Array.isArray(C)&&(C=C.map(M=>M)),_(e,["safetyRatings"],C)}const S=f(n,["urlContextMetadata"]);return S!=null&&_(e,["urlContextMetadata"],S),e}function gN(n){const e={},t=f(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["citations"],i)}return e}function _N(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["contents"]);if(r!=null){let l=Ms(r);Array.isArray(l)&&(l=l.map(c=>c)),_(t,["contents"],l)}return t}function yN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["tokensInfo"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(l=>l)),_(e,["tokensInfo"],r)}return e}function vN(n){const e={},t=f(n,["values"]);t!=null&&_(e,["values"],t);const i=f(n,["statistics"]);return i!=null&&_(e,["statistics"],TN(i)),e}function TN(n){const e={},t=f(n,["truncated"]);t!=null&&_(e,["truncated"],t);const i=f(n,["token_count"]);return i!=null&&_(e,["tokenCount"],i),e}function of(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>NR(l))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function xN(n){const e={},t=f(n,["controlType"]);t!=null&&_(e,["controlType"],t);const i=f(n,["enableControlImageComputation"]);return i!=null&&_(e,["computeControl"],i),e}function EN(n){const e={};if(f(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function wN(n,e){const t={},i=f(n,["systemInstruction"]);e!==void 0&&i!=null&&_(e,["systemInstruction"],mi(i));const r=f(n,["tools"]);if(e!==void 0&&r!=null){let c=r;Array.isArray(c)&&(c=c.map(m=>Pw(m))),_(e,["tools"],c)}const l=f(n,["generationConfig"]);return e!==void 0&&l!=null&&_(e,["generationConfig"],mR(l)),t}function SN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ms(r);Array.isArray(c)&&(c=c.map(m=>of(m))),_(t,["contents"],c)}const l=f(e,["config"]);return l!=null&&EN(l),t}function AN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ms(r);Array.isArray(c)&&(c=c.map(m=>m)),_(t,["contents"],c)}const l=f(e,["config"]);return l!=null&&wN(l,t),t}function CN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["totalTokens"]);i!=null&&_(e,["totalTokens"],i);const r=f(n,["cachedContentTokenCount"]);return r!=null&&_(e,["cachedContentTokenCount"],r),e}function bN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["totalTokens"]);return i!=null&&_(e,["totalTokens"],i),e}function IN(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Bt(n,i)),t}function NN(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Bt(n,i)),t}function RN(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function MN(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function PN(n,e){const t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=f(n,["negativePrompt"]);e!==void 0&&r!=null&&_(e,["parameters","negativePrompt"],r);const l=f(n,["numberOfImages"]);e!==void 0&&l!=null&&_(e,["parameters","sampleCount"],l);const c=f(n,["aspectRatio"]);e!==void 0&&c!=null&&_(e,["parameters","aspectRatio"],c);const m=f(n,["guidanceScale"]);e!==void 0&&m!=null&&_(e,["parameters","guidanceScale"],m);const g=f(n,["seed"]);e!==void 0&&g!=null&&_(e,["parameters","seed"],g);const p=f(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&_(e,["parameters","safetySetting"],p);const E=f(n,["personGeneration"]);e!==void 0&&E!=null&&_(e,["parameters","personGeneration"],E);const S=f(n,["includeSafetyAttributes"]);e!==void 0&&S!=null&&_(e,["parameters","includeSafetyAttributes"],S);const C=f(n,["includeRaiReason"]);e!==void 0&&C!=null&&_(e,["parameters","includeRaiReason"],C);const M=f(n,["language"]);e!==void 0&&M!=null&&_(e,["parameters","language"],M);const z=f(n,["outputMimeType"]);e!==void 0&&z!=null&&_(e,["parameters","outputOptions","mimeType"],z);const H=f(n,["outputCompressionQuality"]);e!==void 0&&H!=null&&_(e,["parameters","outputOptions","compressionQuality"],H);const Y=f(n,["addWatermark"]);e!==void 0&&Y!=null&&_(e,["parameters","addWatermark"],Y);const te=f(n,["labels"]);e!==void 0&&te!=null&&_(e,["labels"],te);const re=f(n,["editMode"]);e!==void 0&&re!=null&&_(e,["parameters","editMode"],re);const ee=f(n,["baseSteps"]);return e!==void 0&&ee!=null&&_(e,["parameters","editConfig","baseSteps"],ee),t}function kN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const l=f(e,["referenceImages"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(g=>LR(g))),_(t,["instances[0]","referenceImages"],m)}const c=f(e,["config"]);return c!=null&&PN(c,t),t}function DN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(l=>rf(l))),_(e,["generatedImages"],r)}return e}function LN(n,e){const t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&_(e,["requests[]","taskType"],i);const r=f(n,["title"]);e!==void 0&&r!=null&&_(e,["requests[]","title"],r);const l=f(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&_(e,["requests[]","outputDimensionality"],l),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function VN(n,e){const t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&_(e,["instances[]","task_type"],i);const r=f(n,["title"]);e!==void 0&&r!=null&&_(e,["instances[]","title"],r);const l=f(n,["outputDimensionality"]);e!==void 0&&l!=null&&_(e,["parameters","outputDimensionality"],l);const c=f(n,["mimeType"]);e!==void 0&&c!=null&&_(e,["instances[]","mimeType"],c);const m=f(n,["autoTruncate"]);return e!==void 0&&m!=null&&_(e,["parameters","autoTruncate"],m),t}function ON(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["contents"]);if(r!=null){let m=Pg(n,r);Array.isArray(m)&&(m=m.map(g=>g)),_(t,["requests[]","content"],m)}const l=f(e,["config"]);l!=null&&LN(l,t);const c=f(e,["model"]);return c!==void 0&&_(t,["requests[]","model"],Bt(n,c)),t}function UN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Pg(n,r);Array.isArray(c)&&(c=c.map(m=>m)),_(t,["instances[]","content"],c)}const l=f(e,["config"]);return l!=null&&VN(l,t),t}function zN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>c)),_(e,["embeddings"],l)}const r=f(n,["metadata"]);return r!=null&&_(e,["metadata"],r),e}function BN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions[]","embeddings"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>vN(c))),_(e,["embeddings"],l)}const r=f(n,["metadata"]);return r!=null&&_(e,["metadata"],r),e}function FN(n){const e={},t=f(n,["endpoint"]);t!=null&&_(e,["name"],t);const i=f(n,["deployedModelId"]);return i!=null&&_(e,["deployedModelId"],i),e}function qN(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function HN(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function GN(n){const e={},t=f(n,["mode"]);t!=null&&_(e,["mode"],t);const i=f(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function jN(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&_(e,["description"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["parameters"]);r!=null&&_(e,["parameters"],r);const l=f(n,["parametersJsonSchema"]);l!=null&&_(e,["parametersJsonSchema"],l);const c=f(n,["response"]);c!=null&&_(e,["response"],c);const m=f(n,["responseJsonSchema"]);return m!=null&&_(e,["responseJsonSchema"],m),e}function KN(n,e,t){const i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],of(mi(r)));const l=f(e,["temperature"]);l!=null&&_(i,["temperature"],l);const c=f(e,["topP"]);c!=null&&_(i,["topP"],c);const m=f(e,["topK"]);m!=null&&_(i,["topK"],m);const g=f(e,["candidateCount"]);g!=null&&_(i,["candidateCount"],g);const p=f(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const E=f(e,["stopSequences"]);E!=null&&_(i,["stopSequences"],E);const S=f(e,["responseLogprobs"]);S!=null&&_(i,["responseLogprobs"],S);const C=f(e,["logprobs"]);C!=null&&_(i,["logprobs"],C);const M=f(e,["presencePenalty"]);M!=null&&_(i,["presencePenalty"],M);const z=f(e,["frequencyPenalty"]);z!=null&&_(i,["frequencyPenalty"],z);const H=f(e,["seed"]);H!=null&&_(i,["seed"],H);const Y=f(e,["responseMimeType"]);Y!=null&&_(i,["responseMimeType"],Y);const te=f(e,["responseSchema"]);te!=null&&_(i,["responseSchema"],kg(te));const re=f(e,["responseJsonSchema"]);if(re!=null&&_(i,["responseJsonSchema"],re),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=f(e,["safetySettings"]);if(t!==void 0&&ee!=null){let j=ee;Array.isArray(j)&&(j=j.map(B=>VR(B))),_(t,["safetySettings"],j)}const ge=f(e,["tools"]);if(t!==void 0&&ge!=null){let j=Nu(ge);Array.isArray(j)&&(j=j.map(B=>HR(Iu(B)))),_(t,["tools"],j)}const pe=f(e,["toolConfig"]);if(t!==void 0&&pe!=null&&_(t,["toolConfig"],qR(pe)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=f(e,["cachedContent"]);t!==void 0&&J!=null&&_(t,["cachedContent"],fr(n,J));const k=f(e,["responseModalities"]);k!=null&&_(i,["responseModalities"],k);const U=f(e,["mediaResolution"]);U!=null&&_(i,["mediaResolution"],U);const V=f(e,["speechConfig"]);if(V!=null&&_(i,["speechConfig"],Dg(V)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const F=f(e,["thinkingConfig"]);F!=null&&_(i,["thinkingConfig"],F);const q=f(e,["imageConfig"]);return q!=null&&_(i,["imageConfig"],vR(q)),i}function ZN(n,e,t){const i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],mi(r));const l=f(e,["temperature"]);l!=null&&_(i,["temperature"],l);const c=f(e,["topP"]);c!=null&&_(i,["topP"],c);const m=f(e,["topK"]);m!=null&&_(i,["topK"],m);const g=f(e,["candidateCount"]);g!=null&&_(i,["candidateCount"],g);const p=f(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const E=f(e,["stopSequences"]);E!=null&&_(i,["stopSequences"],E);const S=f(e,["responseLogprobs"]);S!=null&&_(i,["responseLogprobs"],S);const C=f(e,["logprobs"]);C!=null&&_(i,["logprobs"],C);const M=f(e,["presencePenalty"]);M!=null&&_(i,["presencePenalty"],M);const z=f(e,["frequencyPenalty"]);z!=null&&_(i,["frequencyPenalty"],z);const H=f(e,["seed"]);H!=null&&_(i,["seed"],H);const Y=f(e,["responseMimeType"]);Y!=null&&_(i,["responseMimeType"],Y);const te=f(e,["responseSchema"]);te!=null&&_(i,["responseSchema"],kg(te));const re=f(e,["responseJsonSchema"]);re!=null&&_(i,["responseJsonSchema"],re);const ee=f(e,["routingConfig"]);ee!=null&&_(i,["routingConfig"],ee);const ge=f(e,["modelSelectionConfig"]);ge!=null&&_(i,["modelConfig"],ge);const pe=f(e,["safetySettings"]);if(t!==void 0&&pe!=null){let ne=pe;Array.isArray(ne)&&(ne=ne.map(Ae=>Ae)),_(t,["safetySettings"],ne)}const J=f(e,["tools"]);if(t!==void 0&&J!=null){let ne=Nu(J);Array.isArray(ne)&&(ne=ne.map(Ae=>Pw(Iu(Ae)))),_(t,["tools"],ne)}const k=f(e,["toolConfig"]);t!==void 0&&k!=null&&_(t,["toolConfig"],k);const U=f(e,["labels"]);t!==void 0&&U!=null&&_(t,["labels"],U);const V=f(e,["cachedContent"]);t!==void 0&&V!=null&&_(t,["cachedContent"],fr(n,V));const F=f(e,["responseModalities"]);F!=null&&_(i,["responseModalities"],F);const q=f(e,["mediaResolution"]);q!=null&&_(i,["mediaResolution"],q);const j=f(e,["speechConfig"]);j!=null&&_(i,["speechConfig"],Mw(Dg(j)));const B=f(e,["audioTimestamp"]);B!=null&&_(i,["audioTimestamp"],B);const Le=f(e,["thinkingConfig"]);Le!=null&&_(i,["thinkingConfig"],Le);const et=f(e,["imageConfig"]);return et!=null&&_(i,["imageConfig"],TR(et)),i}function ax(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ms(r);Array.isArray(c)&&(c=c.map(m=>of(m))),_(t,["contents"],c)}const l=f(e,["config"]);return l!=null&&_(t,["generationConfig"],KN(n,l,t)),t}function lx(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ms(r);Array.isArray(c)&&(c=c.map(m=>m)),_(t,["contents"],c)}const l=f(e,["config"]);return l!=null&&_(t,["generationConfig"],ZN(n,l,t)),t}function ux(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(p=>pN(p))),_(e,["candidates"],g)}const r=f(n,["modelVersion"]);r!=null&&_(e,["modelVersion"],r);const l=f(n,["promptFeedback"]);l!=null&&_(e,["promptFeedback"],l);const c=f(n,["responseId"]);c!=null&&_(e,["responseId"],c);const m=f(n,["usageMetadata"]);return m!=null&&_(e,["usageMetadata"],m),e}function cx(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(E=>E)),_(e,["candidates"],p)}const r=f(n,["createTime"]);r!=null&&_(e,["createTime"],r);const l=f(n,["modelVersion"]);l!=null&&_(e,["modelVersion"],l);const c=f(n,["promptFeedback"]);c!=null&&_(e,["promptFeedback"],c);const m=f(n,["responseId"]);m!=null&&_(e,["responseId"],m);const g=f(n,["usageMetadata"]);return g!=null&&_(e,["usageMetadata"],g),e}function YN(n,e){const t={};if(f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=f(n,["numberOfImages"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=f(n,["aspectRatio"]);e!==void 0&&r!=null&&_(e,["parameters","aspectRatio"],r);const l=f(n,["guidanceScale"]);if(e!==void 0&&l!=null&&_(e,["parameters","guidanceScale"],l),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=f(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&_(e,["parameters","safetySetting"],c);const m=f(n,["personGeneration"]);e!==void 0&&m!=null&&_(e,["parameters","personGeneration"],m);const g=f(n,["includeSafetyAttributes"]);e!==void 0&&g!=null&&_(e,["parameters","includeSafetyAttributes"],g);const p=f(n,["includeRaiReason"]);e!==void 0&&p!=null&&_(e,["parameters","includeRaiReason"],p);const E=f(n,["language"]);e!==void 0&&E!=null&&_(e,["parameters","language"],E);const S=f(n,["outputMimeType"]);e!==void 0&&S!=null&&_(e,["parameters","outputOptions","mimeType"],S);const C=f(n,["outputCompressionQuality"]);if(e!==void 0&&C!=null&&_(e,["parameters","outputOptions","compressionQuality"],C),f(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=f(n,["imageSize"]);if(e!==void 0&&M!=null&&_(e,["parameters","sampleImageSize"],M),f(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function WN(n,e){const t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=f(n,["negativePrompt"]);e!==void 0&&r!=null&&_(e,["parameters","negativePrompt"],r);const l=f(n,["numberOfImages"]);e!==void 0&&l!=null&&_(e,["parameters","sampleCount"],l);const c=f(n,["aspectRatio"]);e!==void 0&&c!=null&&_(e,["parameters","aspectRatio"],c);const m=f(n,["guidanceScale"]);e!==void 0&&m!=null&&_(e,["parameters","guidanceScale"],m);const g=f(n,["seed"]);e!==void 0&&g!=null&&_(e,["parameters","seed"],g);const p=f(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&_(e,["parameters","safetySetting"],p);const E=f(n,["personGeneration"]);e!==void 0&&E!=null&&_(e,["parameters","personGeneration"],E);const S=f(n,["includeSafetyAttributes"]);e!==void 0&&S!=null&&_(e,["parameters","includeSafetyAttributes"],S);const C=f(n,["includeRaiReason"]);e!==void 0&&C!=null&&_(e,["parameters","includeRaiReason"],C);const M=f(n,["language"]);e!==void 0&&M!=null&&_(e,["parameters","language"],M);const z=f(n,["outputMimeType"]);e!==void 0&&z!=null&&_(e,["parameters","outputOptions","mimeType"],z);const H=f(n,["outputCompressionQuality"]);e!==void 0&&H!=null&&_(e,["parameters","outputOptions","compressionQuality"],H);const Y=f(n,["addWatermark"]);e!==void 0&&Y!=null&&_(e,["parameters","addWatermark"],Y);const te=f(n,["labels"]);e!==void 0&&te!=null&&_(e,["labels"],te);const re=f(n,["imageSize"]);e!==void 0&&re!=null&&_(e,["parameters","sampleImageSize"],re);const ee=f(n,["enhancePrompt"]);return e!==void 0&&ee!=null&&_(e,["parameters","enhancePrompt"],ee),t}function JN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const l=f(e,["config"]);return l!=null&&YN(l,t),t}function QN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const l=f(e,["config"]);return l!=null&&WN(l,t),t}function $N(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>cR(c))),_(e,["generatedImages"],l)}const r=f(n,["positivePromptSafetyAttributes"]);return r!=null&&_(e,["positivePromptSafetyAttributes"],Nw(r)),e}function XN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>rf(c))),_(e,["generatedImages"],l)}const r=f(n,["positivePromptSafetyAttributes"]);return r!=null&&_(e,["positivePromptSafetyAttributes"],Rw(r)),e}function eR(n,e){const t={},i=f(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i),f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=f(n,["durationSeconds"]);if(e!==void 0&&r!=null&&_(e,["parameters","durationSeconds"],r),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=f(n,["aspectRatio"]);e!==void 0&&l!=null&&_(e,["parameters","aspectRatio"],l);const c=f(n,["resolution"]);e!==void 0&&c!=null&&_(e,["parameters","resolution"],c);const m=f(n,["personGeneration"]);if(e!==void 0&&m!=null&&_(e,["parameters","personGeneration"],m),f(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const g=f(n,["negativePrompt"]);e!==void 0&&g!=null&&_(e,["parameters","negativePrompt"],g);const p=f(n,["enhancePrompt"]);if(e!==void 0&&p!=null&&_(e,["parameters","enhancePrompt"],p),f(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const E=f(n,["lastFrame"]);e!==void 0&&E!=null&&_(e,["instances[0]","lastFrame"],af(E));const S=f(n,["referenceImages"]);if(e!==void 0&&S!=null){let C=S;Array.isArray(C)&&(C=C.map(M=>nM(M))),_(e,["instances[0]","referenceImages"],C)}if(f(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function tR(n,e){const t={},i=f(n,["numberOfVideos"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=f(n,["outputGcsUri"]);e!==void 0&&r!=null&&_(e,["parameters","storageUri"],r);const l=f(n,["fps"]);e!==void 0&&l!=null&&_(e,["parameters","fps"],l);const c=f(n,["durationSeconds"]);e!==void 0&&c!=null&&_(e,["parameters","durationSeconds"],c);const m=f(n,["seed"]);e!==void 0&&m!=null&&_(e,["parameters","seed"],m);const g=f(n,["aspectRatio"]);e!==void 0&&g!=null&&_(e,["parameters","aspectRatio"],g);const p=f(n,["resolution"]);e!==void 0&&p!=null&&_(e,["parameters","resolution"],p);const E=f(n,["personGeneration"]);e!==void 0&&E!=null&&_(e,["parameters","personGeneration"],E);const S=f(n,["pubsubTopic"]);e!==void 0&&S!=null&&_(e,["parameters","pubsubTopic"],S);const C=f(n,["negativePrompt"]);e!==void 0&&C!=null&&_(e,["parameters","negativePrompt"],C);const M=f(n,["enhancePrompt"]);e!==void 0&&M!=null&&_(e,["parameters","enhancePrompt"],M);const z=f(n,["generateAudio"]);e!==void 0&&z!=null&&_(e,["parameters","generateAudio"],z);const H=f(n,["lastFrame"]);e!==void 0&&H!=null&&_(e,["instances[0]","lastFrame"],Xs(H));const Y=f(n,["referenceImages"]);if(e!==void 0&&Y!=null){let ee=Y;Array.isArray(ee)&&(ee=ee.map(ge=>iM(ge))),_(e,["instances[0]","referenceImages"],ee)}const te=f(n,["mask"]);e!==void 0&&te!=null&&_(e,["instances[0]","mask"],tM(te));const re=f(n,["compressionQuality"]);return e!==void 0&&re!=null&&_(e,["parameters","compressionQuality"],re),t}function nR(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const l=f(n,["error"]);l!=null&&_(e,["error"],l);const c=f(n,["response","generateVideoResponse"]);return c!=null&&_(e,["response"],rR(c)),e}function iR(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const l=f(n,["error"]);l!=null&&_(e,["error"],l);const c=f(n,["response"]);return c!=null&&_(e,["response"],aR(c)),e}function sR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const l=f(e,["image"]);l!=null&&_(t,["instances[0]","image"],af(l));const c=f(e,["video"]);c!=null&&_(t,["instances[0]","video"],kw(c));const m=f(e,["source"]);m!=null&&lR(m,t);const g=f(e,["config"]);return g!=null&&eR(g,t),t}function oR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const l=f(e,["image"]);l!=null&&_(t,["instances[0]","image"],Xs(l));const c=f(e,["video"]);c!=null&&_(t,["instances[0]","video"],Dw(c));const m=f(e,["source"]);m!=null&&uR(m,t);const g=f(e,["config"]);return g!=null&&tR(g,t),t}function rR(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>hR(c))),_(e,["generatedVideos"],l)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function aR(n){const e={},t=f(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>fR(c))),_(e,["generatedVideos"],l)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function lR(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],af(r));const l=f(n,["video"]);return e!==void 0&&l!=null&&_(e,["instances[0]","video"],kw(l)),t}function uR(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],Xs(r));const l=f(n,["video"]);return e!==void 0&&l!=null&&_(e,["instances[0]","video"],Dw(l)),t}function cR(n){const e={},t=f(n,["_self"]);t!=null&&_(e,["image"],xR(t));const i=f(n,["raiFilteredReason"]);i!=null&&_(e,["raiFilteredReason"],i);const r=f(n,["_self"]);return r!=null&&_(e,["safetyAttributes"],Nw(r)),e}function rf(n){const e={},t=f(n,["_self"]);t!=null&&_(e,["image"],Iw(t));const i=f(n,["raiFilteredReason"]);i!=null&&_(e,["raiFilteredReason"],i);const r=f(n,["_self"]);r!=null&&_(e,["safetyAttributes"],Rw(r));const l=f(n,["prompt"]);return l!=null&&_(e,["enhancedPrompt"],l),e}function dR(n){const e={},t=f(n,["_self"]);t!=null&&_(e,["mask"],Iw(t));const i=f(n,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(l=>l)),_(e,["labels"],r)}return e}function hR(n){const e={},t=f(n,["video"]);return t!=null&&_(e,["video"],XR(t)),e}function fR(n){const e={},t=f(n,["_self"]);return t!=null&&_(e,["video"],eM(t)),e}function mR(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&_(e,["modelConfig"],t);const i=f(n,["responseJsonSchema"]);i!=null&&_(e,["responseJsonSchema"],i);const r=f(n,["audioTimestamp"]);r!=null&&_(e,["audioTimestamp"],r);const l=f(n,["candidateCount"]);l!=null&&_(e,["candidateCount"],l);const c=f(n,["enableAffectiveDialog"]);c!=null&&_(e,["enableAffectiveDialog"],c);const m=f(n,["frequencyPenalty"]);m!=null&&_(e,["frequencyPenalty"],m);const g=f(n,["logprobs"]);g!=null&&_(e,["logprobs"],g);const p=f(n,["maxOutputTokens"]);p!=null&&_(e,["maxOutputTokens"],p);const E=f(n,["mediaResolution"]);E!=null&&_(e,["mediaResolution"],E);const S=f(n,["presencePenalty"]);S!=null&&_(e,["presencePenalty"],S);const C=f(n,["responseLogprobs"]);C!=null&&_(e,["responseLogprobs"],C);const M=f(n,["responseMimeType"]);M!=null&&_(e,["responseMimeType"],M);const z=f(n,["responseModalities"]);z!=null&&_(e,["responseModalities"],z);const H=f(n,["responseSchema"]);H!=null&&_(e,["responseSchema"],H);const Y=f(n,["routingConfig"]);Y!=null&&_(e,["routingConfig"],Y);const te=f(n,["seed"]);te!=null&&_(e,["seed"],te);const re=f(n,["speechConfig"]);re!=null&&_(e,["speechConfig"],Mw(re));const ee=f(n,["stopSequences"]);ee!=null&&_(e,["stopSequences"],ee);const ge=f(n,["temperature"]);ge!=null&&_(e,["temperature"],ge);const pe=f(n,["thinkingConfig"]);pe!=null&&_(e,["thinkingConfig"],pe);const J=f(n,["topK"]);J!=null&&_(e,["topK"],J);const k=f(n,["topP"]);if(k!=null&&_(e,["topP"],k),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function pR(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Bt(n,i)),t}function gR(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Bt(n,i)),t}function _R(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function yR(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function vR(n){const e={},t=f(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=f(n,["imageSize"]);if(i!=null&&_(e,["imageSize"],i),f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function TR(n){const e={},t=f(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=f(n,["imageSize"]);i!=null&&_(e,["imageSize"],i);const r=f(n,["outputMimeType"]);r!=null&&_(e,["imageOutputOptions","mimeType"],r);const l=f(n,["outputCompressionQuality"]);return l!=null&&_(e,["imageOutputOptions","compressionQuality"],l),e}function xR(n){const e={},t=f(n,["bytesBase64Encoded"]);t!=null&&_(e,["imageBytes"],va(t));const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function Iw(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["gcsUri"],t);const i=f(n,["bytesBase64Encoded"]);i!=null&&_(e,["imageBytes"],va(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function af(n){const e={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=f(n,["imageBytes"]);t!=null&&_(e,["bytesBase64Encoded"],va(t));const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function Xs(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["gcsUri"],t);const i=f(n,["imageBytes"]);i!=null&&_(e,["bytesBase64Encoded"],va(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function ER(n,e,t){const i={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&_(t,["_query","pageSize"],r);const l=f(e,["pageToken"]);t!==void 0&&l!=null&&_(t,["_query","pageToken"],l);const c=f(e,["filter"]);t!==void 0&&c!=null&&_(t,["_query","filter"],c);const m=f(e,["queryBase"]);return t!==void 0&&m!=null&&_(t,["_url","models_url"],Tw(n,m)),i}function wR(n,e,t){const i={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&_(t,["_query","pageSize"],r);const l=f(e,["pageToken"]);t!==void 0&&l!=null&&_(t,["_query","pageToken"],l);const c=f(e,["filter"]);t!==void 0&&c!=null&&_(t,["_query","filter"],c);const m=f(e,["queryBase"]);return t!==void 0&&m!=null&&_(t,["_url","models_url"],Tw(n,m)),i}function SR(n,e){const t={},i=f(e,["config"]);return i!=null&&ER(n,i,t),t}function AR(n,e){const t={},i=f(e,["config"]);return i!=null&&wR(n,i,t),t}function CR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["_self"]);if(r!=null){let l=xw(r);Array.isArray(l)&&(l=l.map(c=>Kp(c))),_(e,["models"],l)}return e}function bR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["_self"]);if(r!=null){let l=xw(r);Array.isArray(l)&&(l=l.map(c=>Zp(c))),_(e,["models"],l)}return e}function IR(n){const e={},t=f(n,["maskMode"]);t!=null&&_(e,["maskMode"],t);const i=f(n,["segmentationClasses"]);i!=null&&_(e,["maskClasses"],i);const r=f(n,["maskDilation"]);return r!=null&&_(e,["dilation"],r),e}function Kp(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);r!=null&&_(e,["description"],r);const l=f(n,["version"]);l!=null&&_(e,["version"],l);const c=f(n,["_self"]);c!=null&&_(e,["tunedModelInfo"],GR(c));const m=f(n,["inputTokenLimit"]);m!=null&&_(e,["inputTokenLimit"],m);const g=f(n,["outputTokenLimit"]);g!=null&&_(e,["outputTokenLimit"],g);const p=f(n,["supportedGenerationMethods"]);p!=null&&_(e,["supportedActions"],p);const E=f(n,["temperature"]);E!=null&&_(e,["temperature"],E);const S=f(n,["maxTemperature"]);S!=null&&_(e,["maxTemperature"],S);const C=f(n,["topP"]);C!=null&&_(e,["topP"],C);const M=f(n,["topK"]);M!=null&&_(e,["topK"],M);const z=f(n,["thinking"]);return z!=null&&_(e,["thinking"],z),e}function Zp(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);r!=null&&_(e,["description"],r);const l=f(n,["versionId"]);l!=null&&_(e,["version"],l);const c=f(n,["deployedModels"]);if(c!=null){let S=c;Array.isArray(S)&&(S=S.map(C=>FN(C))),_(e,["endpoints"],S)}const m=f(n,["labels"]);m!=null&&_(e,["labels"],m);const g=f(n,["_self"]);g!=null&&_(e,["tunedModelInfo"],jR(g));const p=f(n,["defaultCheckpointId"]);p!=null&&_(e,["defaultCheckpointId"],p);const E=f(n,["checkpoints"]);if(E!=null){let S=E;Array.isArray(S)&&(S=S.map(C=>C)),_(e,["checkpoints"],S)}return e}function NR(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const l=f(n,["fileData"]);l!=null&&_(e,["fileData"],qN(l));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],HN(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],mN(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const E=f(n,["thought"]);E!=null&&_(e,["thought"],E);const S=f(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const C=f(n,["videoMetadata"]);return C!=null&&_(e,["videoMetadata"],C),e}function RR(n){const e={},t=f(n,["productImage"]);return t!=null&&_(e,["image"],Xs(t)),e}function MR(n,e){const t={},i=f(n,["numberOfImages"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=f(n,["baseSteps"]);e!==void 0&&r!=null&&_(e,["parameters","baseSteps"],r);const l=f(n,["outputGcsUri"]);e!==void 0&&l!=null&&_(e,["parameters","storageUri"],l);const c=f(n,["seed"]);e!==void 0&&c!=null&&_(e,["parameters","seed"],c);const m=f(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&_(e,["parameters","safetySetting"],m);const g=f(n,["personGeneration"]);e!==void 0&&g!=null&&_(e,["parameters","personGeneration"],g);const p=f(n,["addWatermark"]);e!==void 0&&p!=null&&_(e,["parameters","addWatermark"],p);const E=f(n,["outputMimeType"]);e!==void 0&&E!=null&&_(e,["parameters","outputOptions","mimeType"],E);const S=f(n,["outputCompressionQuality"]);e!==void 0&&S!=null&&_(e,["parameters","outputOptions","compressionQuality"],S);const C=f(n,["enhancePrompt"]);e!==void 0&&C!=null&&_(e,["parameters","enhancePrompt"],C);const M=f(n,["labels"]);return e!==void 0&&M!=null&&_(e,["labels"],M),t}function PR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["source"]);r!=null&&DR(r,t);const l=f(e,["config"]);return l!=null&&MR(l,t),t}function kR(n){const e={},t=f(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>rf(r))),_(e,["generatedImages"],i)}return e}function DR(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["personImage"]);e!==void 0&&r!=null&&_(e,["instances[0]","personImage","image"],Xs(r));const l=f(n,["productImages"]);if(e!==void 0&&l!=null){let c=l;Array.isArray(c)&&(c=c.map(m=>RR(m))),_(e,["instances[0]","productImages"],c)}return t}function LR(n){const e={},t=f(n,["referenceImage"]);t!=null&&_(e,["referenceImage"],Xs(t));const i=f(n,["referenceId"]);i!=null&&_(e,["referenceId"],i);const r=f(n,["referenceType"]);r!=null&&_(e,["referenceType"],r);const l=f(n,["maskImageConfig"]);l!=null&&_(e,["maskImageConfig"],IR(l));const c=f(n,["controlImageConfig"]);c!=null&&_(e,["controlImageConfig"],xN(c));const m=f(n,["styleImageConfig"]);m!=null&&_(e,["styleImageConfig"],m);const g=f(n,["subjectImageConfig"]);return g!=null&&_(e,["subjectImageConfig"],g),e}function Nw(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&_(e,["categories"],t);const i=f(n,["safetyAttributes","scores"]);i!=null&&_(e,["scores"],i);const r=f(n,["contentType"]);return r!=null&&_(e,["contentType"],r),e}function Rw(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&_(e,["categories"],t);const i=f(n,["safetyAttributes","scores"]);i!=null&&_(e,["scores"],i);const r=f(n,["contentType"]);return r!=null&&_(e,["contentType"],r),e}function VR(n){const e={},t=f(n,["category"]);if(t!=null&&_(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=f(n,["threshold"]);return i!=null&&_(e,["threshold"],i),e}function OR(n){const e={},t=f(n,["image"]);return t!=null&&_(e,["image"],Xs(t)),e}function UR(n,e){const t={},i=f(n,["mode"]);e!==void 0&&i!=null&&_(e,["parameters","mode"],i);const r=f(n,["maxPredictions"]);e!==void 0&&r!=null&&_(e,["parameters","maxPredictions"],r);const l=f(n,["confidenceThreshold"]);e!==void 0&&l!=null&&_(e,["parameters","confidenceThreshold"],l);const c=f(n,["maskDilation"]);e!==void 0&&c!=null&&_(e,["parameters","maskDilation"],c);const m=f(n,["binaryColorThreshold"]);e!==void 0&&m!=null&&_(e,["parameters","binaryColorThreshold"],m);const g=f(n,["labels"]);return e!==void 0&&g!=null&&_(e,["labels"],g),t}function zR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["source"]);r!=null&&FR(r,t);const l=f(e,["config"]);return l!=null&&UR(l,t),t}function BR(n){const e={},t=f(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>dR(r))),_(e,["generatedMasks"],i)}return e}function FR(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],Xs(r));const l=f(n,["scribbleImage"]);return e!==void 0&&l!=null&&_(e,["instances[0]","scribble"],OR(l)),t}function Mw(n){const e={},t=f(n,["languageCode"]);t!=null&&_(e,["languageCode"],t);const i=f(n,["voiceConfig"]);if(i!=null&&_(e,["voiceConfig"],i),f(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function qR(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],GN(t));const i=f(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function HR(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>S)),_(e,["functionDeclarations"],E)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const l=f(n,["fileSearch"]);l!=null&&_(e,["fileSearch"],l);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],_R(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],yR(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function Pw(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let S=t;Array.isArray(S)&&(S=S.map(C=>jN(C))),_(e,["functionDeclarations"],S)}const i=f(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=f(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const l=f(n,["computerUse"]);if(l!=null&&_(e,["computerUse"],l),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=f(n,["codeExecution"]);c!=null&&_(e,["codeExecution"],c);const m=f(n,["enterpriseWebSearch"]);m!=null&&_(e,["enterpriseWebSearch"],m);const g=f(n,["googleMaps"]);g!=null&&_(e,["googleMaps"],g);const p=f(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const E=f(n,["urlContext"]);return E!=null&&_(e,["urlContext"],E),e}function GR(n){const e={},t=f(n,["baseModel"]);t!=null&&_(e,["baseModel"],t);const i=f(n,["createTime"]);i!=null&&_(e,["createTime"],i);const r=f(n,["updateTime"]);return r!=null&&_(e,["updateTime"],r),e}function jR(n){const e={},t=f(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&_(e,["baseModel"],t);const i=f(n,["createTime"]);i!=null&&_(e,["createTime"],i);const r=f(n,["updateTime"]);return r!=null&&_(e,["updateTime"],r),e}function KR(n,e){const t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);e!==void 0&&r!=null&&_(e,["description"],r);const l=f(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&_(e,["defaultCheckpointId"],l),t}function ZR(n,e){const t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);e!==void 0&&r!=null&&_(e,["description"],r);const l=f(n,["defaultCheckpointId"]);return e!==void 0&&l!=null&&_(e,["defaultCheckpointId"],l),t}function YR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","name"],Bt(n,i));const r=f(e,["config"]);return r!=null&&KR(r,t),t}function WR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["config"]);return r!=null&&ZR(r,t),t}function JR(n,e){const t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=f(n,["safetyFilterLevel"]);e!==void 0&&r!=null&&_(e,["parameters","safetySetting"],r);const l=f(n,["personGeneration"]);e!==void 0&&l!=null&&_(e,["parameters","personGeneration"],l);const c=f(n,["includeRaiReason"]);e!==void 0&&c!=null&&_(e,["parameters","includeRaiReason"],c);const m=f(n,["outputMimeType"]);e!==void 0&&m!=null&&_(e,["parameters","outputOptions","mimeType"],m);const g=f(n,["outputCompressionQuality"]);e!==void 0&&g!=null&&_(e,["parameters","outputOptions","compressionQuality"],g);const p=f(n,["enhanceInputImage"]);e!==void 0&&p!=null&&_(e,["parameters","upscaleConfig","enhanceInputImage"],p);const E=f(n,["imagePreservationFactor"]);e!==void 0&&E!=null&&_(e,["parameters","upscaleConfig","imagePreservationFactor"],E);const S=f(n,["labels"]);e!==void 0&&S!=null&&_(e,["labels"],S);const C=f(n,["numberOfImages"]);e!==void 0&&C!=null&&_(e,["parameters","sampleCount"],C);const M=f(n,["mode"]);return e!==void 0&&M!=null&&_(e,["parameters","mode"],M),t}function QR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Bt(n,i));const r=f(e,["image"]);r!=null&&_(t,["instances[0]","image"],Xs(r));const l=f(e,["upscaleFactor"]);l!=null&&_(t,["parameters","upscaleConfig","upscaleFactor"],l);const c=f(e,["config"]);return c!=null&&JR(c,t),t}function $R(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(l=>rf(l))),_(e,["generatedImages"],r)}return e}function XR(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["uri"],t);const i=f(n,["encodedVideo"]);i!=null&&_(e,["videoBytes"],va(i));const r=f(n,["encoding"]);return r!=null&&_(e,["mimeType"],r),e}function eM(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["uri"],t);const i=f(n,["bytesBase64Encoded"]);i!=null&&_(e,["videoBytes"],va(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function tM(n){const e={},t=f(n,["image"]);t!=null&&_(e,["_self"],Xs(t));const i=f(n,["maskMode"]);return i!=null&&_(e,["maskMode"],i),e}function nM(n){const e={},t=f(n,["image"]);t!=null&&_(e,["image"],af(t));const i=f(n,["referenceType"]);return i!=null&&_(e,["referenceType"],i),e}function iM(n){const e={},t=f(n,["image"]);t!=null&&_(e,["image"],Xs(t));const i=f(n,["referenceType"]);return i!=null&&_(e,["referenceType"],i),e}function kw(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["uri"],t);const i=f(n,["videoBytes"]);i!=null&&_(e,["encodedVideo"],va(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["encoding"],r),e}function Dw(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["gcsUri"],t);const i=f(n,["videoBytes"]);i!=null&&_(e,["bytesBase64Encoded"],va(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sM="Content-Type",oM="X-Server-Timeout",rM="User-Agent",Yp="x-goog-api-client",aM="1.30.0",lM=`google-genai-sdk/${aM}`,uM="v1beta1",cM="v1beta",dx=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class dM{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:uM,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:cM,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[c,m]of Object.entries(e.queryParams))r.searchParams.append(c,String(m));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,r.toString(),e.abortSignal),this.unaryApiCall(r,l,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[r,l]of Object.entries(t))typeof l=="object"?i[r]=Object.assign(Object.assign({},i[r]),l):l!==void 0&&(i[r]=l);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,r.toString(),e.abortSignal),this.streamApiCall(r,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,r){if(t&&t.timeout||r){const l=new AbortController,c=l.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const m=setTimeout(()=>l.abort(),t.timeout);m&&typeof m.unref=="function"&&m.unref()}r&&r.addEventListener("abort",()=>{l.abort()}),e.signal=c}return t&&t.extraBody!==null&&hM(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await hx(r),new Hp(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await hx(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return cu(this,arguments,function*(){const r=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),l=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let c="";for(;;){const{done:m,value:g}=yield an(r.read());if(m){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=l.decode(g,{stream:!0});try{const S=JSON.parse(p);if("error"in S){const C=JSON.parse(JSON.stringify(S.error)),M=C.status,z=C.code,H=`got status: ${M}. ${JSON.stringify(S)}`;if(z>=400&&z<600)throw new sf({message:H,status:z})}}catch(S){if(S.name==="ApiError")throw S}c+=p;let E=c.match(dx);for(;E;){const S=E[1];try{const C=new Response(S,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield an(new Hp(C)),c=c.slice(E[0].length),E=c.match(dx)}catch(C){throw new Error(`exception parsing stream chunk ${S}. ${C}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=lM+" "+this.clientOptions.userAgentExtra;return e[rM]=t,e[Yp]=t,e[sM]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[r,l]of Object.entries(e.headers))i.append(r,l);e.timeout&&e.timeout>0&&i.append(oM,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const l=this.clientOptions.uploader,c=await l.stat(e);r.sizeBytes=String(c.size);const m=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:c.type;if(m===void 0||m==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=m;const g={file:r},p=this.getFileName(e),E=ke("upload/v1beta/files",g._url),S=await this.fetchUploadUrl(E,r.sizeBytes,r.mimeType,p,g,t==null?void 0:t.httpOptions);return l.upload(e,S,this)}async uploadFileToFileSearchStore(e,t,i){var r;const l=this.clientOptions.uploader,c=await l.stat(t),m=String(c.size),g=(r=i==null?void 0:i.mimeType)!==null&&r!==void 0?r:c.type;if(g===void 0||g==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,E=this.getFileName(t),S={};i!=null&&i.customMetadata&&(S.customMetadata=i.customMetadata),i!=null&&i.chunkingConfig&&(S.chunkingConfig=i.chunkingConfig);const C=await this.fetchUploadUrl(p,m,g,E,S,i==null?void 0:i.httpOptions);return l.uploadToFileSearchStore(t,C,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,r,l,c){var m;let g={};c?g=c:g={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};const p=await this.request({path:e,body:JSON.stringify(l),httpMethod:"POST",httpOptions:g});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const E=(m=p==null?void 0:p.headers)===null||m===void 0?void 0:m["x-goog-upload-url"];if(E===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return E}}async function hx(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(i);throw t>=400&&t<600?new sf({message:r,status:t}):new Error(r)}}function hM(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const l=JSON.parse(n.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))t=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(l,c){const m=Object.assign({},l);for(const g in c)if(Object.prototype.hasOwnProperty.call(c,g)){const p=c[g],E=m[g];p&&typeof p=="object"&&!Array.isArray(p)&&E&&typeof E=="object"&&!Array.isArray(E)?m[g]=i(E,p):(E&&p&&typeof E!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${g}". Original type: ${typeof E}, New type: ${typeof p}. Overwriting.`),m[g]=p)}return m}const r=i(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fM="mcp_used/unknown";let mM=!1;function Lw(n){for(const e of n)if(pM(e)||typeof e=="object"&&"inputSchema"in e)return!0;return mM}function Vw(n){var e;const t=(e=n[Yp])!==null&&e!==void 0?e:"";n[Yp]=(t+` ${fM}`).trimStart()}function pM(n){return n!==null&&typeof n=="object"&&n instanceof Vg}function gM(n,e=100){return cu(this,arguments,function*(){let i,r=0;for(;r<e;){const l=yield an(n.listTools({cursor:i}));for(const c of l.tools)yield yield an(c),r++;if(!l.nextCursor)break;i=l.nextCursor}})}class Vg{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Vg(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;const l={},c=[];for(const E of this.mcpClients)try{for(var m=!0,g=(t=void 0,Dc(gM(E))),p;p=await g.next(),e=p.done,!e;m=!0){r=p.value,m=!1;const S=r;c.push(S);const C=S.name;if(l[C])throw new Error(`Duplicate function name ${C} found in MCP tools. Please ensure function names are unique.`);l[C]=E}}catch(S){t={error:S}}finally{try{!m&&!e&&(i=g.return)&&await i.call(g)}finally{if(t)throw t.error}}this.mcpTools=c,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),lI(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const c=await r.callTool({name:i.name,arguments:i.args},void 0,l);t.push({functionResponse:{name:i.name,response:c.isError?{error:c}:c}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function _M(n,e,t){const i=new eI;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(i,r),e(i)}class yM{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),c=xM(this.apiClient.getDefaultHeaders()),m=this.apiClient.getApiKey(),g=`${r}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${m}`;let p=()=>{};const E=new Promise(ee=>{p=ee}),S=e.callbacks,C=function(){p({})},M=this.apiClient,z={onopen:C,onmessage:ee=>{_M(M,S.onmessage,ee)},onerror:(t=S==null?void 0:S.onerror)!==null&&t!==void 0?t:function(ee){},onclose:(i=S==null?void 0:S.onclose)!==null&&i!==void 0?i:function(ee){}},H=this.webSocketFactory.create(g,TM(c),z);H.connect(),await E;const re={setup:{model:Bt(this.apiClient,e.model)}};return H.send(JSON.stringify(re)),new vM(H,this.apiClient)}}class vM{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=oN(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=sN(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(lu.PLAY)}pause(){this.sendPlaybackControl(lu.PAUSE)}stop(){this.sendPlaybackControl(lu.STOP)}resetContext(){this.sendPlaybackControl(lu.RESET_CONTEXT)}close(){this.conn.close()}}function TM(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function xM(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const EM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function wM(n,e,t){const i=new Xb;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const l=JSON.parse(r);if(n.isVertexAI()){const c=lN(l);Object.assign(i,c)}else Object.assign(i,l);e(i)}class SM{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new yM(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,l,c,m;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const g=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let E;const S=this.apiClient.getHeaders();e.config&&e.config.tools&&Lw(e.config.tools)&&Vw(S);const C=IM(S);if(this.apiClient.isVertexAI())E=`${g}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(C,E);else{const V=this.apiClient.getApiKey();let F="BidiGenerateContent",q="key";V!=null&&V.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),F="BidiGenerateContentConstrained",q="access_token"),E=`${g}/ws/google.ai.generativelanguage.${p}.GenerativeService.${F}?${q}=${V}`}let M=()=>{};const z=new Promise(V=>{M=V}),H=e.callbacks,Y=function(){var V;(V=H==null?void 0:H.onopen)===null||V===void 0||V.call(H),M({})},te=this.apiClient,re={onopen:Y,onmessage:V=>{wM(te,H.onmessage,V)},onerror:(t=H==null?void 0:H.onerror)!==null&&t!==void 0?t:function(V){},onclose:(i=H==null?void 0:H.onclose)!==null&&i!==void 0?i:function(V){}},ee=this.webSocketFactory.create(E,bM(C),re);ee.connect(),await z;let ge=Bt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&ge.startsWith("publishers/")){const V=this.apiClient.getProject(),F=this.apiClient.getLocation();ge=`projects/${V}/locations/${F}/`+ge}let pe={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[kh.AUDIO]}:e.config.responseModalities=[kh.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const J=(m=(c=e.config)===null||c===void 0?void 0:c.tools)!==null&&m!==void 0?m:[],k=[];for(const V of J)if(this.isCallableTool(V)){const F=V;k.push(await F.tool())}else k.push(V);k.length>0&&(e.config.tools=k);const U={model:ge,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?pe=iN(this.apiClient,U):pe=nN(this.apiClient,U),delete pe.config,ee.send(JSON.stringify(pe)),new CM(ee,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const AM={turnComplete:!0};class CM{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Ms(t.turns),e.isVertexAI()||(i=i.map(r=>of(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const l of i){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(EM)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},AM),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:aN(e)}:t={realtimeInput:rN(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function bM(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function IM(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fx=10;function mx(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const c of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(du(c)){r=!0;break}if(!r)return!0;const l=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function du(n){return"callTool"in n&&typeof n.callTool=="function"}function NM(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>du(r)))!==null&&i!==void 0?i:!1}function px(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,r)=>{if(du(i))return;const l=i;l.functionDeclarations&&l.functionDeclarations.length>0&&t.push(r)}),t}function gx(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RM extends hr{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,l,c,m;const g=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!NM(t)||mx(t.config))return await this.generateContentInternal(g);const p=px(t);if(p.length>0){const H=p.map(Y=>`tools[${Y}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${H}.`)}let E,S;const C=Ms(g.contents),M=(l=(r=(i=g.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&l!==void 0?l:fx;let z=0;for(;z<M&&(E=await this.generateContentInternal(g),!(!E.functionCalls||E.functionCalls.length===0));){const H=E.candidates[0].content,Y=[];for(const te of(m=(c=t.config)===null||c===void 0?void 0:c.tools)!==null&&m!==void 0?m:[])if(du(te)){const ee=await te.callTool(E.functionCalls);Y.push(...ee)}z++,S={role:"user",parts:Y},g.contents=Ms(g.contents),g.contents.push(H),g.contents.push(S),gx(g.config)&&(C.push(H),C.push(S))}return gx(g.config)&&(E.automaticFunctionCallingHistory=C),E},this.generateContentStream=async t=>{var i,r,l,c,m;if(this.maybeMoveToResponseJsonSchem(t),mx(t.config)){const S=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(S)}const g=px(t);if(g.length>0){const S=g.map(C=>`tools[${C}]`).join(", ");throw new Error(`Incompatible tools found at ${S}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(l=(r=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||l===void 0?void 0:l.streamFunctionCallArguments,E=(m=(c=t==null?void 0:t.config)===null||c===void 0?void 0:c.automaticFunctionCalling)===null||m===void 0?void 0:m.disable;if(p&&!E)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let l;const c=[];if(i!=null&&i.generatedImages)for(const g of i.generatedImages)g&&(g!=null&&g.safetyAttributes)&&((r=g==null?void 0:g.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?l=g==null?void 0:g.safetyAttributes:c.push(g);let m;return l?m={generatedImages:c,positivePromptSafetyAttributes:l,sdkHttpResponse:i.sdkHttpResponse}:m={generatedImages:c,sdkHttpResponse:i.sdkHttpResponse},m}),this.list=async t=>{var i;const c={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((i=c.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new ml(rr.PAGED_ITEM_MODELS,m=>this.listInternal(m),await this.listInternal(c),c)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var i,r,l,c,m,g;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((c=(l=t.source)===null||l===void 0?void 0:l.video)===null||c===void 0)&&c.uri&&(!((g=(m=t.source)===null||m===void 0?void 0:m.video)===null||g===void 0)&&g.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;const l=(t=e.config)===null||t===void 0?void 0:t.tools;if(!l)return e;const c=await Promise.all(l.map(async g=>du(g)?await g.tool():g)),m={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:c})};if(m.config.tools=c,e.config&&e.config.tools&&Lw(e.config.tools)){const g=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let p=Object.assign({},g);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),Vw(p),m.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return m}async initAfcToolsMap(e){var t,i,r;const l=new Map;for(const c of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(du(c)){const m=c,g=await m.tool();for(const p of(r=g.functionDeclarations)!==null&&r!==void 0?r:[]){if(!p.name)throw new Error("Function declaration name is required.");if(l.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);l.set(p.name,m)}}return l}async processAfcStream(e){var t,i,r;const l=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:fx;let c=!1,m=0;const g=await this.initAfcToolsMap(e);return(function(p,E,S){var C,M;return cu(this,arguments,function*(){for(var z,H,Y,te;m<l;){c&&(m++,c=!1);const pe=yield an(p.processParamsMaybeAddMcpUsage(S)),J=yield an(p.generateContentStreamInternal(pe)),k=[],U=[];try{for(var re=!0,ee=(H=void 0,Dc(J)),ge;ge=yield an(ee.next()),z=ge.done,!z;re=!0){te=ge.value,re=!1;const V=te;if(yield yield an(V),V.candidates&&(!((C=V.candidates[0])===null||C===void 0)&&C.content)){U.push(V.candidates[0].content);for(const F of(M=V.candidates[0].content.parts)!==null&&M!==void 0?M:[])if(m<l&&F.functionCall){if(!F.functionCall.name)throw new Error("Function call name was not returned by the model.");if(E.has(F.functionCall.name)){const q=yield an(E.get(F.functionCall.name).callTool([F.functionCall]));k.push(...q)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${E.keys()}, mising tool: ${F.functionCall.name}`)}}}}catch(V){H={error:V}}finally{try{!re&&!z&&(Y=ee.return)&&(yield an(Y.call(ee)))}finally{if(H)throw H.error}}if(k.length>0){c=!0;const V=new Cc;V.candidates=[{content:{role:"user",parts:k}}],yield yield an(V);const F=[];F.push(...U),F.push({role:"user",parts:k});const q=Ms(S.contents).concat(F);S.contents=q}else break}})})(this,g,e)}async generateContentInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=lx(this.apiClient,e);return m=ke("{model}:generateContent",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=cx(E),C=new Cc;return Object.assign(C,S),C})}else{const p=ax(this.apiClient,e);return m=ke("{model}:generateContent",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=ux(E),C=new Cc;return Object.assign(C,S),C})}}async generateContentStreamInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=lx(this.apiClient,e);return m=ke("{model}:streamGenerateContent?alt=sse",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.requestStream({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),c.then(function(S){return cu(this,arguments,function*(){var C,M,z,H;try{for(var Y=!0,te=Dc(S),re;re=yield an(te.next()),C=re.done,!C;Y=!0){H=re.value,Y=!1;const ee=H,ge=cx(yield an(ee.json()));ge.sdkHttpResponse={headers:ee.headers};const pe=new Cc;Object.assign(pe,ge),yield yield an(pe)}}catch(ee){M={error:ee}}finally{try{!Y&&!C&&(z=te.return)&&(yield an(z.call(te)))}finally{if(M)throw M.error}}})})}else{const p=ax(this.apiClient,e);return m=ke("{model}:streamGenerateContent?alt=sse",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.requestStream({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),c.then(function(S){return cu(this,arguments,function*(){var C,M,z,H;try{for(var Y=!0,te=Dc(S),re;re=yield an(te.next()),C=re.done,!C;Y=!0){H=re.value,Y=!1;const ee=H,ge=ux(yield an(ee.json()));ge.sdkHttpResponse={headers:ee.headers};const pe=new Cc;Object.assign(pe,ge),yield yield an(pe)}}catch(ee){M={error:ee}}finally{try{!Y&&!C&&(z=te.return)&&(yield an(z.call(te)))}finally{if(M)throw M.error}}})})}}async embedContent(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=UN(this.apiClient,e);return m=ke("{model}:predict",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=BN(E),C=new jT;return Object.assign(C,S),C})}else{const p=ON(this.apiClient,e);return m=ke("{model}:batchEmbedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=zN(E),C=new jT;return Object.assign(C,S),C})}}async generateImagesInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=QN(this.apiClient,e);return m=ke("{model}:predict",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=XN(E),C=new KT;return Object.assign(C,S),C})}else{const p=JN(this.apiClient,e);return m=ke("{model}:predict",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=$N(E),C=new KT;return Object.assign(C,S),C})}}async editImageInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const m=kN(this.apiClient,e);return l=ke("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:g.headers},E})),r.then(g=>{const p=DN(g),E=new qb;return Object.assign(E,p),E})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const m=QR(this.apiClient,e);return l=ke("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:g.headers},E})),r.then(g=>{const p=$R(g),E=new Hb;return Object.assign(E,p),E})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const m=PR(this.apiClient,e);return l=ke("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=kR(g),E=new Gb;return Object.assign(E,p),E})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const m=zR(this.apiClient,e);return l=ke("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=BR(g),E=new jb;return Object.assign(E,p),E})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=gR(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),c.then(E=>Zp(E))}else{const p=pR(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json()),c.then(E=>Kp(E))}}async listInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=AR(this.apiClient,e);return m=ke("{models_url}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=bR(E),C=new ZT;return Object.assign(C,S),C})}else{const p=SR(this.apiClient,e);return m=ke("{models_url}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=CR(E),C=new ZT;return Object.assign(C,S),C})}}async update(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=WR(this.apiClient,e);return m=ke("{model}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),c.then(E=>Zp(E))}else{const p=YR(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json()),c.then(E=>Kp(E))}}async delete(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=NN(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=MN(E),C=new YT;return Object.assign(C,S),C})}else{const p=IN(this.apiClient,e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=RN(E),C=new YT;return Object.assign(C,S),C})}}async countTokens(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=AN(this.apiClient,e);return m=ke("{model}:countTokens",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=bN(E),C=new WT;return Object.assign(C,S),C})}else{const p=SN(this.apiClient,e);return m=ke("{model}:countTokens",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=CN(E),C=new WT;return Object.assign(C,S),C})}}async computeTokens(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const m=_N(this.apiClient,e);return l=ke("{model}:computeTokens",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:g.headers},E})),r.then(g=>{const p=yN(g),E=new Kb;return Object.assign(E,p),E})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=oR(this.apiClient,e);return m=ke("{model}:predictLongRunning",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),c.then(E=>{const S=iR(E),C=new Dh;return Object.assign(C,S),C})}else{const p=sR(this.apiClient,e);return m=ke("{model}:predictLongRunning",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json()),c.then(E=>{const S=nR(E),C=new Dh;return Object.assign(C,S),C})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MM extends hr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:c,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:c,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=Vb(e);return m=ke("{operationName}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),c}else{const p=Lb(e);return m=ke("{operationName}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json()),c}}async fetchPredictVideosOperationInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const m=Ib(e);return l=ke("{resourceName}:fetchPredictOperation",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PM(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function kM(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>qM(l))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function DM(n,e,t){const i={},r=f(e,["expireTime"]);t!==void 0&&r!=null&&_(t,["expireTime"],r);const l=f(e,["newSessionExpireTime"]);t!==void 0&&l!=null&&_(t,["newSessionExpireTime"],l);const c=f(e,["uses"]);t!==void 0&&c!=null&&_(t,["uses"],c);const m=f(e,["liveConnectConstraints"]);t!==void 0&&m!=null&&_(t,["bidiGenerateContentSetup"],FM(n,m));const g=f(e,["lockAdditionalFields"]);return t!==void 0&&g!=null&&_(t,["fieldMask"],g),i}function LM(n,e){const t={},i=f(e,["config"]);return i!=null&&_(t,["config"],DM(n,i,t)),t}function VM(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function OM(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function UM(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function zM(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function BM(n,e){const t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],i);const r=f(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const l=f(n,["temperature"]);e!==void 0&&l!=null&&_(e,["setup","generationConfig","temperature"],l);const c=f(n,["topP"]);e!==void 0&&c!=null&&_(e,["setup","generationConfig","topP"],c);const m=f(n,["topK"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","topK"],m);const g=f(n,["maxOutputTokens"]);e!==void 0&&g!=null&&_(e,["setup","generationConfig","maxOutputTokens"],g);const p=f(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const E=f(n,["seed"]);e!==void 0&&E!=null&&_(e,["setup","generationConfig","seed"],E);const S=f(n,["speechConfig"]);e!==void 0&&S!=null&&_(e,["setup","generationConfig","speechConfig"],Lg(S));const C=f(n,["thinkingConfig"]);e!==void 0&&C!=null&&_(e,["setup","generationConfig","thinkingConfig"],C);const M=f(n,["enableAffectiveDialog"]);e!==void 0&&M!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],M);const z=f(n,["systemInstruction"]);e!==void 0&&z!=null&&_(e,["setup","systemInstruction"],kM(mi(z)));const H=f(n,["tools"]);if(e!==void 0&&H!=null){let J=Nu(H);Array.isArray(J)&&(J=J.map(k=>GM(Iu(k)))),_(e,["setup","tools"],J)}const Y=f(n,["sessionResumption"]);e!==void 0&&Y!=null&&_(e,["setup","sessionResumption"],HM(Y));const te=f(n,["inputAudioTranscription"]);e!==void 0&&te!=null&&_(e,["setup","inputAudioTranscription"],te);const re=f(n,["outputAudioTranscription"]);e!==void 0&&re!=null&&_(e,["setup","outputAudioTranscription"],re);const ee=f(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&_(e,["setup","realtimeInputConfig"],ee);const ge=f(n,["contextWindowCompression"]);e!==void 0&&ge!=null&&_(e,["setup","contextWindowCompression"],ge);const pe=f(n,["proactivity"]);return e!==void 0&&pe!=null&&_(e,["setup","proactivity"],pe),t}function FM(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["setup","model"],Bt(n,i));const r=f(e,["config"]);return r!=null&&_(t,["config"],BM(r,t)),t}function qM(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const l=f(n,["fileData"]);l!=null&&_(e,["fileData"],VM(l));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],OM(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],PM(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const E=f(n,["thought"]);E!=null&&_(e,["thought"],E);const S=f(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const C=f(n,["videoMetadata"]);return C!=null&&_(e,["videoMetadata"],C),e}function HM(n){const e={},t=f(n,["handle"]);if(t!=null&&_(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function GM(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>S)),_(e,["functionDeclarations"],E)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const l=f(n,["fileSearch"]);l!=null&&_(e,["fileSearch"],l);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],UM(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],zM(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jM(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(l=>`${t}.${l}`);e.push(...r)}else e.push(t)}return e.join(",")}function KM(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const l=i.setup;typeof l=="object"&&l!==null?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const l=jM(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)l?n.fieldMask=l:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let m=[];r.length>0&&(m=r.map(p=>c.includes(p)?`generationConfig.${p}`:p));const g=[];l&&g.push(l),m.length>0&&g.push(...m),g.length>0?n.fieldMask=g.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class ZM extends hr{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const m=LM(this.apiClient,e);l=ke("auth_tokens",m._url),c=m._query,delete m.config,delete m._url,delete m._query;const g=KM(m,e.config);return r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YM(n,e){const t={},i=f(n,["displayName"]);return e!==void 0&&i!=null&&_(e,["displayName"],i),t}function WM(n){const e={},t=f(n,["config"]);return t!=null&&YM(t,e),e}function JM(n,e){const t={},i=f(n,["force"]);return e!==void 0&&i!=null&&_(e,["_query","force"],i),t}function QM(n){const e={},t=f(n,["name"]);t!=null&&_(e,["_url","name"],t);const i=f(n,["config"]);return i!=null&&JM(i,e),e}function $M(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","name"],t),e}function XM(n,e){const t={},i=f(n,["customMetadata"]);if(e!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>c)),_(e,["customMetadata"],l)}const r=f(n,["chunkingConfig"]);return e!==void 0&&r!=null&&_(e,["chunkingConfig"],r),t}function eP(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const l=f(n,["error"]);l!=null&&_(e,["error"],l);const c=f(n,["response"]);return c!=null&&_(e,["response"],nP(c)),e}function tP(n){const e={},t=f(n,["fileSearchStoreName"]);t!=null&&_(e,["_url","file_search_store_name"],t);const i=f(n,["fileName"]);i!=null&&_(e,["fileName"],i);const r=f(n,["config"]);return r!=null&&XM(r,e),e}function nP(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["parent"]);i!=null&&_(e,["parent"],i);const r=f(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function iP(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function sP(n){const e={},t=f(n,["config"]);return t!=null&&iP(t,e),e}function oP(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["fileSearchStores"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),_(e,["fileSearchStores"],l)}return e}function rP(n,e){const t={},i=f(n,["mimeType"]);e!==void 0&&i!=null&&_(e,["mimeType"],i);const r=f(n,["displayName"]);e!==void 0&&r!=null&&_(e,["displayName"],r);const l=f(n,["customMetadata"]);if(e!==void 0&&l!=null){let m=l;Array.isArray(m)&&(m=m.map(g=>g)),_(e,["customMetadata"],m)}const c=f(n,["chunkingConfig"]);return e!==void 0&&c!=null&&_(e,["chunkingConfig"],c),t}function aP(n){const e={},t=f(n,["fileSearchStoreName"]);t!=null&&_(e,["_url","file_search_store_name"],t);const i=f(n,["config"]);return i!=null&&rP(i,e),e}function lP(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uP(n,e){const t={},i=f(n,["force"]);return e!==void 0&&i!=null&&_(e,["_query","force"],i),t}function cP(n){const e={},t=f(n,["name"]);t!=null&&_(e,["_url","name"],t);const i=f(n,["config"]);return i!=null&&uP(i,e),e}function dP(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","name"],t),e}function hP(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function fP(n){const e={},t=f(n,["parent"]);t!=null&&_(e,["_url","parent"],t);const i=f(n,["config"]);return i!=null&&hP(i,e),e}function mP(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["documents"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),_(e,["documents"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pP extends hr{constructor(e){super(),this.apiClient=e,this.list=async t=>new ml(rr.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=dP(e);return l=ke("{name}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async delete(e){var t,i;let r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=cP(e);r=ke("{name}",c._url),l=c._query,delete c._url,delete c._query,await this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=fP(e);return l=ke("{parent}/documents",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=mP(g),E=new Zb;return Object.assign(E,p),E})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gP extends hr{constructor(e,t=new pP(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new ml(rr.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=WM(e);return l=ke("fileSearchStores",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async get(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=$M(e);return l=ke("{name}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async delete(e){var t,i;let r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=QM(e);r=ke("{name}",c._url),l=c._query,delete c._url,delete c._query,await this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=sP(e);return l=ke("fileSearchStores",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=oP(g),E=new Yb;return Object.assign(E,p),E})}}async uploadToFileSearchStoreInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=aP(e);return l=ke("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=lP(g),E=new Wb;return Object.assign(E,p),E})}}async importFile(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=tP(e);return l=ke("{file_search_store_name}:importFile",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=eP(g),E=new Rg;return Object.assign(E,p),E})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _P(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function yP(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function vP(n,e,t){const i={};if(f(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=f(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&_(e,["displayName"],r),f(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=f(n,["epochCount"]);e!==void 0&&l!=null&&_(e,["tuningTask","hyperparameters","epochCount"],l);const c=f(n,["learningRateMultiplier"]);if(c!=null&&_(i,["tuningTask","hyperparameters","learningRateMultiplier"],c),f(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const m=f(n,["batchSize"]);e!==void 0&&m!=null&&_(e,["tuningTask","hyperparameters","batchSize"],m);const g=f(n,["learningRate"]);if(e!==void 0&&g!=null&&_(e,["tuningTask","hyperparameters","learningRate"],g),f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(f(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function TP(n,e,t){const i={};let r=f(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const M=f(n,["validationDataset"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec"],_x(M))}else if(r==="PREFERENCE_TUNING"){const M=f(n,["validationDataset"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec"],_x(M))}const l=f(n,["tunedModelDisplayName"]);e!==void 0&&l!=null&&_(e,["tunedModelDisplayName"],l);const c=f(n,["description"]);e!==void 0&&c!=null&&_(e,["description"],c);let m=f(t,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const M=f(n,["epochCount"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","hyperParameters","epochCount"],M)}else if(m==="PREFERENCE_TUNING"){const M=f(n,["epochCount"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],M)}let g=f(t,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const M=f(n,["learningRateMultiplier"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],M)}else if(g==="PREFERENCE_TUNING"){const M=f(n,["learningRateMultiplier"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],M)}let p=f(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const M=f(n,["exportLastCheckpointOnly"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","exportLastCheckpointOnly"],M)}else if(p==="PREFERENCE_TUNING"){const M=f(n,["exportLastCheckpointOnly"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],M)}let E=f(t,["config","method"]);if(E===void 0&&(E="SUPERVISED_FINE_TUNING"),E==="SUPERVISED_FINE_TUNING"){const M=f(n,["adapterSize"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","hyperParameters","adapterSize"],M)}else if(E==="PREFERENCE_TUNING"){const M=f(n,["adapterSize"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],M)}if(f(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const S=f(n,["labels"]);e!==void 0&&S!=null&&_(e,["labels"],S);const C=f(n,["beta"]);return e!==void 0&&C!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","beta"],C),i}function xP(n,e){const t={},i=f(n,["baseModel"]);i!=null&&_(t,["baseModel"],i);const r=f(n,["preTunedModel"]);r!=null&&_(t,["preTunedModel"],r);const l=f(n,["trainingDataset"]);l!=null&&PP(l);const c=f(n,["config"]);return c!=null&&vP(c,t),t}function EP(n,e){const t={},i=f(n,["baseModel"]);i!=null&&_(t,["baseModel"],i);const r=f(n,["preTunedModel"]);r!=null&&_(t,["preTunedModel"],r);const l=f(n,["trainingDataset"]);l!=null&&kP(l,t,e);const c=f(n,["config"]);return c!=null&&TP(c,t,e),t}function wP(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function SP(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function AP(n,e,t){const i={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&_(e,["_query","pageSize"],r);const l=f(n,["pageToken"]);e!==void 0&&l!=null&&_(e,["_query","pageToken"],l);const c=f(n,["filter"]);return e!==void 0&&c!=null&&_(e,["_query","filter"],c),i}function CP(n,e,t){const i={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&_(e,["_query","pageSize"],r);const l=f(n,["pageToken"]);e!==void 0&&l!=null&&_(e,["_query","pageToken"],l);const c=f(n,["filter"]);return e!==void 0&&c!=null&&_(e,["_query","filter"],c),i}function bP(n,e){const t={},i=f(n,["config"]);return i!=null&&AP(i,t),t}function IP(n,e){const t={},i=f(n,["config"]);return i!=null&&CP(i,t),t}function NP(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const l=f(n,["tunedModels"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(m=>Ow(m))),_(t,["tuningJobs"],c)}return t}function RP(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const l=f(n,["tuningJobs"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(m=>Wp(m))),_(t,["tuningJobs"],c)}return t}function MP(n,e){const t={},i=f(n,["name"]);i!=null&&_(t,["model"],i);const r=f(n,["name"]);return r!=null&&_(t,["endpoint"],r),t}function PP(n,e){const t={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=f(n,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(l=>l)),_(t,["examples","examples"],r)}return t}function kP(n,e,t){const i={};let r=f(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const c=f(n,["gcsUri"]);e!==void 0&&c!=null&&_(e,["supervisedTuningSpec","trainingDatasetUri"],c)}else if(r==="PREFERENCE_TUNING"){const c=f(n,["gcsUri"]);e!==void 0&&c!=null&&_(e,["preferenceOptimizationSpec","trainingDatasetUri"],c)}let l=f(t,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const c=f(n,["vertexDatasetResource"]);e!==void 0&&c!=null&&_(e,["supervisedTuningSpec","trainingDatasetUri"],c)}else if(l==="PREFERENCE_TUNING"){const c=f(n,["vertexDatasetResource"]);e!==void 0&&c!=null&&_(e,["preferenceOptimizationSpec","trainingDatasetUri"],c)}if(f(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function Ow(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["name"]);r!=null&&_(t,["name"],r);const l=f(n,["state"]);l!=null&&_(t,["state"],yw(l));const c=f(n,["createTime"]);c!=null&&_(t,["createTime"],c);const m=f(n,["tuningTask","startTime"]);m!=null&&_(t,["startTime"],m);const g=f(n,["tuningTask","completeTime"]);g!=null&&_(t,["endTime"],g);const p=f(n,["updateTime"]);p!=null&&_(t,["updateTime"],p);const E=f(n,["description"]);E!=null&&_(t,["description"],E);const S=f(n,["baseModel"]);S!=null&&_(t,["baseModel"],S);const C=f(n,["_self"]);return C!=null&&_(t,["tunedModel"],MP(C)),t}function Wp(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["name"]);r!=null&&_(t,["name"],r);const l=f(n,["state"]);l!=null&&_(t,["state"],yw(l));const c=f(n,["createTime"]);c!=null&&_(t,["createTime"],c);const m=f(n,["startTime"]);m!=null&&_(t,["startTime"],m);const g=f(n,["endTime"]);g!=null&&_(t,["endTime"],g);const p=f(n,["updateTime"]);p!=null&&_(t,["updateTime"],p);const E=f(n,["error"]);E!=null&&_(t,["error"],E);const S=f(n,["description"]);S!=null&&_(t,["description"],S);const C=f(n,["baseModel"]);C!=null&&_(t,["baseModel"],C);const M=f(n,["tunedModel"]);M!=null&&_(t,["tunedModel"],M);const z=f(n,["preTunedModel"]);z!=null&&_(t,["preTunedModel"],z);const H=f(n,["supervisedTuningSpec"]);H!=null&&_(t,["supervisedTuningSpec"],H);const Y=f(n,["preferenceOptimizationSpec"]);Y!=null&&_(t,["preferenceOptimizationSpec"],Y);const te=f(n,["tuningDataStats"]);te!=null&&_(t,["tuningDataStats"],te);const re=f(n,["encryptionSpec"]);re!=null&&_(t,["encryptionSpec"],re);const ee=f(n,["partnerModelTuningSpec"]);ee!=null&&_(t,["partnerModelTuningSpec"],ee);const ge=f(n,["customBaseModel"]);ge!=null&&_(t,["customBaseModel"],ge);const pe=f(n,["experiment"]);pe!=null&&_(t,["experiment"],pe);const J=f(n,["labels"]);J!=null&&_(t,["labels"],J);const k=f(n,["outputUri"]);k!=null&&_(t,["outputUri"],k);const U=f(n,["pipelineJob"]);U!=null&&_(t,["pipelineJob"],U);const V=f(n,["serviceAccount"]);V!=null&&_(t,["serviceAccount"],V);const F=f(n,["tunedModelDisplayName"]);F!=null&&_(t,["tunedModelDisplayName"],F);const q=f(n,["veoTuningSpec"]);return q!=null&&_(t,["veoTuningSpec"],q),t}function DP(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["name"]);r!=null&&_(t,["name"],r);const l=f(n,["metadata"]);l!=null&&_(t,["metadata"],l);const c=f(n,["done"]);c!=null&&_(t,["done"],c);const m=f(n,["error"]);return m!=null&&_(t,["error"],m),t}function _x(n,e){const t={},i=f(n,["gcsUri"]);i!=null&&_(t,["validationDatasetUri"],i);const r=f(n,["vertexDatasetResource"]);return r!=null&&_(t,["validationDatasetUri"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class LP extends hr{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new ml(rr.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const r={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},t),{preTunedModel:r});return l.baseModel=void 0,await this.tuneInternal(l)}else{const r=Object.assign({},t);return await this.tuneInternal(r)}else{const r=Object.assign({},t),l=await this.tuneMldevInternal(r);let c="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?c=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(c=l.name.split("/operations/")[0]),{name:c,state:qp.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=SP(e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>Wp(E))}else{const p=wP(e);return m=ke("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>Ow(E))}}async listInternal(e){var t,i,r,l;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=IP(e);return m=ke("tuningJobs",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=RP(E),C=new JT;return Object.assign(C,S),C})}else{const p=bP(e);return m=ke("tunedModels",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(E=>E.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:E.headers},C})),c.then(E=>{const S=NP(E),C=new JT;return Object.assign(C,S),C})}}async cancel(e){var t,i,r,l;let c="",m={};if(this.apiClient.isVertexAI()){const g=yP(e);c=ke("{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=_P(e);c=ke("{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async tuneInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const m=EP(e,e);return l=ke("tuningJobs",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:g.headers},E})),r.then(g=>Wp(g))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=xP(e);return l=ke("tunedModels",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:g.headers},E})),r.then(g=>DP(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class VP{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const OP=1024*1024*8,UP=3,zP=1e3,BP=2,Vh="x-goog-upload-status";async function FP(n,e,t){var i;const r=await Uw(n,e,t),l=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Vh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return l.file}async function qP(n,e,t){var i;const r=await Uw(n,e,t),l=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Vh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const c=hw(l),m=new Mg;return Object.assign(m,c),m}async function Uw(n,e,t){var i,r;let l=0,c=0,m=new Hp(new Response),g="upload";for(l=n.size;c<l;){const p=Math.min(OP,l-c),E=n.slice(c,c+p);c+p>=l&&(g+=", finalize");let S=0,C=zP;for(;S<UP&&(m=await t.request({path:"",body:E,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":g,"X-Goog-Upload-Offset":String(c),"Content-Length":String(p)}}}),!(!((i=m==null?void 0:m.headers)===null||i===void 0)&&i[Vh]));)S++,await GP(C),C=C*BP;if(c+=p,((r=m==null?void 0:m.headers)===null||r===void 0?void 0:r[Vh])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return m}async function HP(n){return{size:n.size,type:n.type}}function GP(n){return new Promise(e=>setTimeout(e,n))}class jP{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await FP(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await qP(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await HP(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KP{create(e,t,i){return new ZP(e,t,i)}}class ZP{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yx="x-goog-api-key";class YP{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(yx)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(yx,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WP="gl-node/";class zw{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=Cb(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const r=new YP(this.apiKey);this.apiClient=new dM({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:WP+"web",uploader:new jP,downloader:new VP}),this.models=new RM(this.apiClient),this.live=new SM(this.apiClient,r,new KP),this.batches=new t2(this.apiClient),this.chats=new V2(this.models,this.apiClient),this.caches=new k2(this.apiClient),this.files=new K2(this.apiClient),this.operations=new MM(this.apiClient),this.authTokens=new ZM(this.apiClient),this.tunings=new LP(this.apiClient),this.fileSearchStores=new gP(this.apiClient)}}const JP={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var vx={};const QP=()=>{try{if(typeof window<"u"&&window.localStorage){const n=localStorage.getItem("nomad_user_api_key");if(n)return n}if(typeof import.meta<"u"&&JP)return"";if(typeof process<"u"&&vx)return vx.VITE_API_KEY||""}catch(n){console.warn("Failed to access API key",n)}return""},eo=async n=>{var i;const e=QP();let t=null;if(e)try{const r=new zw({apiKey:e});return await n(r)}catch(r){if(console.warn("Primary API Key failed",r),t=r,(i=r.message)!=null&&i.includes("403")||r.toString().includes("403"))throw new Error("Invalid API Key (403). Please check your key in Settings.")}else throw new Error("API key is missing. Please provide a valid API key in Settings.");throw new Error(`AI Service Failed. ${(t==null?void 0:t.message)||t||"Unknown error"}`)},pi={"zh-TW":"Traditional Chinese (Taiwan) ()","en-US":"English","ja-JP":"Japanese"},to=n=>{if(typeof n.text=="string")return n.text;if(typeof n.text=="function")return n.text();if(n.candidates&&n.candidates[0]&&n.candidates[0].content&&n.candidates[0].content.parts&&n.candidates[0].content.parts[0].text)return n.candidates[0].content.parts[0].text;throw new Error("No text found in AI response")},no="gemini-2.5-flash",Bw=async(n,e)=>(console.warn("Image editing is not supported. Returning original image."),n),Og=async n=>{try{const e=`Cinematic travel photography of ${n}, 4k, high quality, sunny day, vibrant colors, wide angle`,t=encodeURIComponent(e),i=Math.floor(Math.random()*1e6);return`https://image.pollinations.ai/prompt/${t}?width=1600&height=900&nologo=true&seed=${i}&model=flux`}catch(e){return console.error("Failed to generate cover image:",e),`https://via.placeholder.com/1600x900/D4A574/FFFFFF?text=${encodeURIComponent(n)}`}},Fw=async(n,e="zh-TW")=>{const t=pi[e]||pi["zh-TW"];return eo(async i=>{const r=await i.models.generateContent({model:no,contents:`Help me plan a trip. ${n}`,config:{systemInstruction:`You are a professional travel agent AI. 
                Create a detailed itinerary based on the user's request. 
                
                CRITICAL PLANNING RULES:
                1. **Distance & Logic**: Group attractions that are geographically close to each other on the same day.
                2. **Feasibility**: Ensure the schedule is realistic.
                3. **Language**: All content MUST be in ${t}.
                4. **Travel Info**: You MUST estimate the travel mode and duration to the NEXT activity. This is mandatory for all items except the last one of the day.
                5. **Completeness**: You MUST generate a FULL itinerary with at least 3 activities per day. Do not leave the itinerary empty.
                
                FORMAT REQUIREMENTS:
                Return response in valid JSON format. Do not use Markdown code blocks.
                The JSON must strictly follow this structure:
                {
                    "title": "Trip Title",
                    "startDate": "YYYY-MM-DD",
                    "endDate": "YYYY-MM-DD",
                    "itinerary": [
                        {
                            "id": "unique_id",
                            "day": 1,
                            "time": "09:00",
                            "activity": "Activity Name",
                            "location": "Location Address",
                            "notes": "Tips",
                            "travelToNext": {
                                "mode": "WALK/TRAIN/BUS/CAR",
                                "duration": "15 min",
                                "details": "Route details"
                            }
                        }
                    ],
                    "budget": {
                        "total": 10000,
                        "currency": "TWD",
                        "expenses": []
                    },
                    "packingList": [],
                    "weather": [
                        {
                            "date": "YYYY-MM-DD",
                            "condition": "Sunny",
                            "tempLow": 20,
                            "tempHigh": 30,
                            "icon": ""
                        }
                    ]
                }
                `,responseMimeType:"application/json"}}),l=to(r);if(l){const c=l.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(c)}throw new Error("Empty response from AI")})},qw=async(n,e,t="zh-TW")=>{const i=pi[t]||pi["zh-TW"];return eo(async r=>{const l=await r.models.generateContent({model:no,contents:`Help me modify an existing trip plan.
            
            Current Trip JSON:
            ${JSON.stringify(n)}
            
            User Request: "${e}"
            
            INSTRUCTIONS:
            1. Modify the "Current Trip JSON" based on the "User Request".
            2. Keep the same structure and fields.
            3. Update the "itinerary", "bookings", "budget", etc. as needed.
            4. Ensure the response is valid JSON matching the Trip structure.
            5. All content MUST be in ${i}.
            6. Return ONLY the updated JSON.
            `,config:{responseMimeType:"application/json"}}),c=to(l);if(c){const m=c.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(m)}throw new Error("Empty response from AI")})},Hw=async(n,e,t="zh-TW")=>{const i=pi[t]||pi["zh-TW"];return eo(async r=>{const l=await r.models.generateContent({model:no,contents:`I hold a ${n} passport and want to travel to ${e}. 
            What are the visa requirements, entry rules, and any vaccination requirements? 
            Provide a concise summary in Markdown format. 
            Include a 'Difficulty Level' (Easy, Moderate, Hard) at the top.
            Response MUST be in ${i}.`});return to(l)})},Gw=async(n,e="zh-TW")=>{const t=pi[e]||pi["zh-TW"];return eo(async i=>{const r=await i.models.generateContent({model:no,contents:`I am currently in (or planning to go to) ${n}. 
            Give me a quick guide on:
            1. Tipping customs (Restaurants, Taxis, Hotels).
            2. Major cultural taboos (Do's and Don'ts).
            3. Dress code advice.
            Keep it short, fun, and formatted in Markdown.
            Response MUST be in ${t}.`});return to(r)})},jw=async(n,e,t="zh-TW")=>{const i=pi[t]||pi["zh-TW"];return eo(async r=>{try{const l=await r.models.generateContent({model:no,contents:`Tell me about "${e}" at "${n}". 
                Provide a very short fun fact, the best photo spot, and one "pro tip" for visiting.
                Format as simple Markdown (bold keys). Keep it under 100 words.
                Response MUST be in ${i}.`});return to(l)}catch(l){return console.error("Error fetching attraction guide:",l),""}})},Kw=async(n,e="zh-TW")=>{const t=pi[e]||pi["zh-TW"];return eo(async i=>{try{const r=await i.models.generateContent({model:no,contents:`I am travelling in ${n}. 
                List the emergency phone numbers for: Police, Ambulance, Fire.
                Also list the address and phone number of the nearest major hospital in the capital city.
                Format as a clear list.
                Response MUST be in ${t}.`});return to(r)}catch(r){return`: ${r instanceof Error?r.message:String(r)}`}})},Zw=async(n,e="zh-TW")=>{const t=pi[e]||pi["zh-TW"];return eo(async i=>{try{const r=await i.models.generateContent({model:no,contents:`I am travelling to ${n}. 
                What kind of credit cards are best to use there (Visa, Mastercard, Amex, JCB)?
                Are cash payments preferred?
                Any tips on currency exchange or dynamic currency conversion (DCC)?
                Keep it concise.
                Response MUST be in ${t}.`});return to(r)}catch{return" Visa/Mastercard "}})},Yw=async(n,e="zh-TW")=>eo(async t=>{const i=n.map(c=>({id:c.id,activity:c.activity,location:c.location,time:c.time})),r=await t.models.generateContent({model:no,contents:`I have a list of activities for one day. Reorder them to create the most efficient geographical route.
            
            Current Items: ${JSON.stringify(i)}
            
            Return ONLY a JSON array of strings, where each string is the 'id' of the activity in the new order.
            Do not change the time, just the order of visiting.
            Example response: ["id1", "id3", "id2"]`,config:{responseMimeType:"application/json"}}),l=to(r);if(l)return JSON.parse(l);throw new Error("Empty response")}),Ww=async(n,e,t="zh-TW")=>eo(async i=>{try{const r=await i.models.generateContent({model:no,contents:`Translate the following text to ${e}.
                Text: "${n}"
                
                Only provide the translated text.`});return to(r)}catch(r){return console.error("Translation Error:",r),null}}),Jw=async(n,e,t="zh-TW")=>{const i=pi[t]||pi["zh-TW"];return eo(async r=>{try{const l=n.map(m=>`${m.date}: ${m.condition}, ${m.tempLow}C - ${m.tempHigh}C`).join(`
`),c=await r.models.generateContent({model:no,contents:`I am travelling to ${e}. Here is the weather forecast:
                ${l}
                
                Based on this weather, give me a VERY SHORT, ONE-LINE clothing advice summary.
                Example: "It's rainy and cold, so bring a heavy coat and umbrella."
                Keep it under 20 words.
                Response MUST be in ${i}.`});return to(c)}catch(l){return console.error("Clothing Advice Error:",l),""}})},Ug=async(n,e)=>{try{return await eo(async t=>{try{const i=await t.models.generateContent({model:no,contents:`What is the current exchange rate from ${n} to ${e}?
                    Return ONLY the number. Example: 0.23
                    If you are unsure, return "null".`}),r=to(i),l=parseFloat(r);return isNaN(l)?null:l.toString()}catch(i){return console.error("Exchange Rate Error:",i),null}})}catch(t){return console.warn("Call AI failed for exchange rate:",t),null}},$P=Object.freeze(Object.defineProperty({__proto__:null,editTravelPhoto:Bw,generateCoverImage:Og,generateTripPlan:Fw,getAttractionGuide:jw,getClothingAdvice:Jw,getCreditCardAdvice:Zw,getCulturalEtiquette:Gw,getEmergencyInfo:Kw,getExchangeRate:Ug,getTranslation:Ww,getVisaRequirements:Hw,optimizeRoute:Yw,updateTripPlan:qw},Symbol.toStringTag,{value:"Module"})),XP=({onSave:n,onCancel:e,settings:t})=>{const i=Xt[t.language]||Xt["zh-TW"],[r,l]=W.useState(""),[c,m]=W.useState(""),[g,p]=W.useState(""),[E,S]=W.useState(null),[C,M]=W.useState(!1),z=W.useRef(null),H=re=>{var ge;const ee=(ge=re.target.files)==null?void 0:ge[0];if(ee){const pe=new FileReader;pe.onloadend=()=>{S(pe.result)},pe.readAsDataURL(ee)}},Y=async()=>{if(!r){alert("Please enter title");return}M(!0);try{const re=await Og(r);S(re)}catch(re){console.error(re),alert("Error")}finally{M(!1)}},te=async re=>{if(re.preventDefault(),!r||!c)return;let ee=E;if(!ee)try{const pe=`Cinematic travel photography of ${r}, 4k, high quality, sunny day`,J=encodeURIComponent(pe),k=Math.floor(Math.random()*1e6);ee=`https://image.pollinations.ai/prompt/${J}?width=1600&height=900&nologo=true&seed=${k}&model=flux`}catch(pe){console.error("Failed to generate default cover",pe),ee=`https://via.placeholder.com/1600x900/D4A574/FFFFFF?text=${encodeURIComponent(r)}`}const ge={id:Date.now().toString(),title:r,startDate:c,endDate:g,itinerary:[],coverImage:ee};n(ge)};return T.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe pt-12",children:[T.jsxs("div",{className:"px-4 py-3 flex items-center gap-2 bg-paper sticky top-0 z-10 border-b border-sand/50",children:[T.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-white text-gray-500 active:scale-90 transition-transform",children:T.jsx(hs,{className:"w-6 h-6"})}),T.jsx("h2",{className:"text-lg font-bold text-ink",children:i.new_trip})]}),T.jsxs("form",{onSubmit:te,className:"p-6 space-y-8 flex-1 overflow-y-auto no-scrollbar pb-32",children:[T.jsxs("div",{className:"space-y-3",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase",children:i.trip_destination_title}),T.jsx("div",{className:"relative",children:T.jsx("input",{type:"text",required:!0,value:r,onChange:re=>l(re.target.value),placeholder:"...",className:"w-full p-5 bg-white rounded-3xl border border-sand focus:border-coral focus:ring-1 focus:ring-coral/50 transition-all text-lg font-bold text-ink outline-none placeholder:text-gray-300 shadow-sm"})})]}),T.jsxs("div",{className:"space-y-3",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase",children:i.cover_photo}),T.jsxs("div",{className:"w-full aspect-video rounded-3xl overflow-hidden bg-white border-2 border-dashed border-sand relative shadow-inner",children:[E?T.jsx("img",{src:E,alt:"Cover",className:"w-full h-full object-cover"}):T.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-300",children:[T.jsx(_u,{className:"w-10 h-10 mb-2 opacity-50"}),T.jsx("span",{className:"text-xs font-bold",children:"Preview"})]}),E&&T.jsx("button",{type:"button",onClick:()=>S(null),className:"absolute top-2 right-2 bg-black/50 text-white p-1.5 rounded-full backdrop-blur-sm",children:T.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),T.jsxs("div",{className:"flex gap-3 mt-2",children:[T.jsxs("button",{type:"button",onClick:()=>{var re;return(re=z.current)==null?void 0:re.click()},className:"flex-1 py-3 bg-white text-gray-600 rounded-2xl font-bold text-sm border border-sand hover:border-coral hover:text-coral transition-colors flex items-center justify-center gap-1.5 shadow-sm",children:[T.jsx(_u,{className:"w-4 h-4"})," ",i.upload_photo]}),T.jsx("input",{type:"file",ref:z,className:"hidden",accept:"image/*",onChange:H}),T.jsx("button",{type:"button",onClick:Y,disabled:C||!r,className:"flex-1 py-3 bg-purple-50 text-purple-600 rounded-2xl font-bold text-sm hover:bg-purple-100 transition-colors flex items-center justify-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed border border-purple-100",children:C?T.jsx("span",{className:"animate-pulse",children:"..."}):T.jsxs(T.Fragment,{children:[T.jsx(sa,{className:"w-4 h-4"})," ",i.ai_generate_cover]})})]})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsxs("div",{className:"space-y-3",children:[T.jsxs("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase flex items-center gap-1",children:[T.jsx(zp,{className:"w-3 h-3 text-coral"})," ",i.start_date]}),T.jsx("input",{type:"date",required:!0,value:c,onChange:re=>m(re.target.value),className:"w-full p-4 bg-white rounded-2xl border border-sand focus:border-coral outline-none text-sm font-bold text-ink shadow-sm"})]}),T.jsxs("div",{className:"space-y-3",children:[T.jsxs("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase flex items-center gap-1",children:[T.jsx(zp,{className:"w-3 h-3 text-gray-400"})," ",i.end_date]}),T.jsx("input",{type:"date",value:g,onChange:re=>p(re.target.value),className:"w-full p-4 bg-white rounded-2xl border border-sand focus:border-coral outline-none text-sm font-bold text-ink shadow-sm"})]})]}),T.jsxs("div",{className:"pt-4",children:[T.jsxs("button",{type:"submit",className:"w-full py-4 bg-coral text-white rounded-2xl font-bold text-lg shadow-float active:scale-[0.98] transition-all flex items-center justify-center gap-2 hover:bg-coralDark ring-4 ring-white",children:[T.jsx("span",{children:i.create_trip}),T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 text-white/70",children:T.jsx("path",{fillRule:"evenodd",d:"M3 10a.75.75 0 01.75-.75h10.638L10.23 5.29a.75.75 0 111.04-1.08l5.5 5.25a.75.75 0 010 1.08l-5.5 5.25a.75.75 0 11-1.04-1.08l4.158-3.96H3.75A.75.75 0 013 10z",clipRule:"evenodd"})})]}),T.jsx("p",{className:"text-center text-xs text-gray-400 mt-6 font-medium",children:i.add_trip_hint})]})]})]})},e5=({settings:n})=>{const e=(n==null?void 0:n.language)||"zh-TW",t=Xt[e]||Xt["zh-TW"],[i,r]=W.useState(null),[l,c]=W.useState(null),[m,g]=W.useState(""),[p,E]=W.useState(!1),[S,C]=W.useState(null),M=W.useRef(null),z=Y=>{var re;const te=(re=Y.target.files)==null?void 0:re[0];if(te){const ee=new FileReader;ee.onloadend=()=>{const ge=ee.result;r(ge),c(null),C(null)},ee.readAsDataURL(te)}},H=async()=>{if(!(!i||!m)){E(!0),C(null);try{const Y=await Bw(i,m);c(Y)}catch(Y){C("Error"),console.error(Y)}finally{E(!1)}}};return T.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[T.jsxs("div",{className:"px-5 py-4 bg-paper sticky top-0 z-10 flex items-center justify-between",children:[T.jsxs("h2",{className:"text-xl font-extrabold text-ink flex items-center gap-2",children:[T.jsx(sa,{className:"w-6 h-6 text-coral"}),t.magic_editor_title]}),T.jsx("span",{className:"text-[10px] font-bold bg-white text-coral border border-coral/20 px-2 py-1 rounded-lg uppercase tracking-wider shadow-sm",children:"Beta"})]}),T.jsx("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 pb-32 no-scrollbar",children:i?T.jsxs("div",{className:"space-y-6 animate-fade-in",children:[T.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-6 snap-x no-scrollbar px-2",children:[T.jsxs("div",{className:"snap-center shrink-0 w-full bg-white p-3 pb-12 rounded-sm shadow-polaroid rotate-1 relative transition-transform hover:rotate-0 duration-300",children:[T.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden mb-2",children:T.jsx("img",{src:i,alt:"Original",className:"w-full h-full object-cover"})}),T.jsx("div",{className:"absolute bottom-4 left-4 font-handwriting text-gray-500 text-sm font-bold",children:"#Original"}),T.jsx("button",{onClick:()=>{r(null),c(null),g("")},className:"absolute -top-2 -right-2 bg-white text-ink p-2 rounded-full shadow-lg border border-sand hover:text-coral",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:T.jsx("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"})})})]}),l&&T.jsxs("div",{className:"snap-center shrink-0 w-full bg-white p-3 pb-12 rounded-sm shadow-polaroid -rotate-1 relative transition-transform hover:rotate-0 duration-300 ring-2 ring-coral/20",children:[T.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden mb-2",children:T.jsx("img",{src:l,alt:"Magic Result",className:"w-full h-full object-cover"})}),T.jsxs("div",{className:"absolute bottom-4 left-4 font-handwriting text-coral font-bold flex items-center gap-1",children:[T.jsx(sa,{className:"w-4 h-4"})," #MagicEdit"]})]})]}),T.jsxs("div",{className:"bg-white p-2 rounded-3xl shadow-card border border-sand",children:[T.jsxs("div",{className:"p-4",children:[T.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2 uppercase tracking-wider",children:"Prompt"}),T.jsx("textarea",{value:m,onChange:Y=>g(Y.target.value),placeholder:t.magic_prompt_placeholder,className:"w-full p-4 rounded-2xl bg-paper border-0 focus:ring-2 focus:ring-coral/50 outline-none text-base resize-none h-24 placeholder:text-gray-300 font-medium text-ink"})]}),S&&T.jsxs("div",{className:"mx-4 mb-2 text-red-500 text-xs bg-red-50 p-3 rounded-xl flex items-center gap-2 font-bold",children:[T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:T.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),S]}),T.jsx("div",{className:"p-2",children:T.jsx("button",{onClick:H,disabled:p||!m.trim(),className:`w-full py-4 rounded-2xl font-bold text-white shadow-lg flex items-center justify-center gap-2 transition-all ${p||!m.trim()?"bg-gray-300 cursor-not-allowed text-gray-500 shadow-none":"bg-coral hover:bg-coralDark hover:shadow-coral/30 active:scale-[0.98]"}`,children:p?T.jsxs(T.Fragment,{children:[T.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[T.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),T.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.generating]}):T.jsxs(T.Fragment,{children:[T.jsx(sa,{className:"w-5 h-5 stroke-[2]"}),t.start_magic]})})})]})]}):T.jsxs("div",{onClick:()=>{var Y;return(Y=M.current)==null?void 0:Y.click()},className:"border-2 border-dashed border-sand rounded-3xl h-80 flex flex-col items-center justify-center bg-white cursor-pointer active:scale-[0.98] transition-all hover:border-coral hover:bg-white/80 group shadow-card",children:[T.jsx("div",{className:"w-20 h-20 bg-paper rounded-full shadow-inner flex items-center justify-center mb-5 group-hover:scale-110 transition-transform",children:T.jsx(_u,{className:"w-10 h-10 text-coral"})}),T.jsx("span",{className:"text-ink font-bold text-lg",children:t.upload_hint}),T.jsx("input",{type:"file",ref:M,onChange:z,className:"hidden",accept:"image/*"})]})})]})},t5="modulepreload",n5=function(n){return"/"+n},Tx={},lf=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(p){return Promise.all(p.map(E=>Promise.resolve(E).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),g=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));r=c(t.map(p=>{if(p=n5(p),p in Tx)return;Tx[p]=!0;const E=p.endsWith(".css"),S=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${S}`))return;const C=document.createElement("link");if(C.rel=E?"stylesheet":t5,E||(C.as="script"),C.crossOrigin="",C.href=p,g&&C.setAttribute("nonce",g),document.head.appendChild(C),E)return new Promise((M,z)=>{C.addEventListener("load",M),C.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${p}`)))})}))}function l(c){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=c,window.dispatchEvent(m),!m.defaultPrevented)throw c}return r.then(c=>{for(const m of c||[])m.status==="rejected"&&l(m.reason);return e().catch(l)})},i5=({items:n,onUpdateItems:e,settings:t})=>{const i=Xt[t.language]||Xt["zh-TW"],[r,l]=W.useState(""),[c,m]=W.useState(""),[g,p]=W.useState(!1),E=()=>{if(!r.trim())return;const M={id:Date.now().toString(),item:r,bought:!1,notes:c},z=[...n,M];e(z),l(""),m(""),p(!1)},S=M=>{const z=n.map(H=>H.id===M?{...H,bought:!H.bought}:H);e(z)},C=M=>{if(confirm(i.delete_trip_confirm.replace("{title}",i.shopping_list))){const z=n.filter(H=>H.id!==M);e(z)}};return T.jsxs("div",{className:"pb-40",children:[T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-soft text-center mt-2 border border-sand relative overflow-hidden mb-6",children:[T.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-coral"}),T.jsx("h3",{className:"text-gray-400 text-sm font-bold uppercase tracking-widest mb-2",children:i.shopping_list}),T.jsxs("div",{className:"text-5xl font-black text-ink mb-2 tracking-tight",children:[(n==null?void 0:n.filter(M=>M.bought).length)||0,T.jsx("span",{className:"text-2xl text-gray-300 mx-2",children:"/"}),T.jsx("span",{className:"text-3xl text-gray-400",children:(n==null?void 0:n.length)||0})]})]}),(n==null?void 0:n.length)>0?T.jsx("div",{className:"space-y-3",children:n==null?void 0:n.map(M=>T.jsxs("div",{className:`bg-white p-4 rounded-2xl border ${M.bought?"border-green-200 bg-green-50/30":"border-sand"} shadow-card flex items-center justify-between group transition-all`,children:[T.jsxs("div",{className:"flex items-center gap-4 flex-1",onClick:()=>S(M.id),children:[T.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center cursor-pointer transition-colors ${M.bought?"bg-green-500 border-green-500":"border-gray-300 hover:border-coral"}`,children:M.bought&&T.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),T.jsxs("div",{children:[T.jsx("div",{className:`font-bold text-lg ${M.bought?"text-gray-400 line-through":"text-ink"}`,children:M.item}),M.notes&&T.jsx("div",{className:"text-xs text-gray-400 font-medium mt-0.5",children:M.notes})]})]}),T.jsx("button",{onClick:()=>C(M.id),className:"p-2 text-gray-300 hover:text-red-500 transition-colors",children:T.jsx(da,{className:"w-5 h-5"})})]},M.id))}):T.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[T.jsx("div",{className:"w-16 h-16 bg-sand/30 rounded-full flex items-center justify-center text-gray-400",children:T.jsx(dw,{className:"w-8 h-8"})}),T.jsxs("p",{className:"text-gray-400 font-medium",children:[i.no_itinerary,T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:i.click_add})]})]}),g&&T.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>p(!1),children:T.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:M=>M.stopPropagation(),children:[T.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_activity}),T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.activity_name}),T.jsx("input",{value:r,onChange:M=>l(M.target.value),placeholder:i.shopping_list,className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal",autoFocus:!0})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.notes}),T.jsx("input",{value:c,onChange:M=>m(M.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-medium border-none shadow-sm outline-none placeholder:font-normal"})]}),T.jsx("button",{onClick:E,disabled:!r.trim(),className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 mt-4 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:i.confirm})]})]})}),T.jsx("button",{onClick:()=>p(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-coral text-white rounded-full shadow-xl shadow-coral/40 flex items-center justify-center z-30 hover:bg-coralDark active:scale-90 transition-all",children:T.jsx(nf,{className:"w-8 h-8 stroke-[2]"})})]})},s5=({trip:n,settings:e,onUpdateTrip:t,onOpenQuickExpense:i})=>{var Rt;const r=Xt[e.language]||Xt["zh-TW"],[l,c]=W.useState(null),[m,g]=W.useState(""),[p,E]=W.useState(!1),[S,C]=W.useState(!1),M=W.useRef(null),[z,H]=W.useState(!1),[Y,te]=W.useState(null),[re,ee]=W.useState(1),[ge,pe]=W.useState("09:00"),[J,k]=W.useState(""),[U,V]=W.useState(""),[F,q]=W.useState(""),[j,B]=W.useState(null),[Le,et]=W.useState("TRAIN"),[ne,Ae]=W.useState(""),[Se,Ye]=W.useState(""),[Ie,K]=W.useState(null),[de,Ce]=W.useState(!1),ae=W.useMemo(()=>{const ye=n.itinerary||[],Pe={};return[...ye].sort((gt,lt)=>gt.time.localeCompare(lt.time)).forEach(gt=>{const lt=gt.day||1;Pe[lt]||(Pe[lt]=[]),Pe[lt].push(gt)}),Pe},[n.itinerary]),fe=W.useMemo(()=>Object.keys(ae).map(Number).sort((ye,Pe)=>ye-Pe),[ae]);W.useEffect(()=>{l||We()},[l]),W.useEffect(()=>()=>{window.speechSynthesis.cancel()},[]);const be=async()=>{const ye=[`${n.title} (${n.startDate} - ${n.endDate})`];fe.forEach(Ge=>{ye.push(`
Day ${Ge}:`),ae[Ge].forEach(gt=>{ye.push(`${gt.time} ${gt.activity}`),gt.travelToNext&&ye.push(`   ${gt.travelToNext.mode} (${gt.travelToNext.duration})`)})});const Pe=ye.join(`
`);try{navigator.share?await navigator.share({title:n.title,text:Pe}):(await navigator.clipboard.writeText(Pe),alert(r.share_success))}catch(Ge){console.error("Error sharing:",Ge)}},Fe=async()=>{if(!(!n.weather||n.weather.length===0)){Ce(!0);try{const ye=await Jw(n.weather,n.title,e.language);K(ye)}catch{K("")}finally{Ce(!1)}}},ze=async(ye,Pe)=>{c({name:ye,location:Pe}),g(""),E(!0);try{const Ge=await jw(Pe,ye);g(Ge||"")}catch{g("")}finally{E(!1)}},xe=()=>{if(S){We();return}if(!m)return;const ye=new SpeechSynthesisUtterance(m);ye.lang=e.language==="en-US"?"en-US":"zh-TW",ye.rate=1,ye.onend=()=>C(!1),M.current=ye,window.speechSynthesis.speak(ye),C(!0)},We=()=>{window.speechSynthesis.cancel(),C(!1)},mt=async ye=>{const Pe=ae[ye];if(!Pe||(Pe==null?void 0:Pe.length)<3){alert(r.optimize_route_min_items||"Need at least 3 items to optimize.");return}B(ye);try{const gt=(await Yw(Pe,e.language)).map(cn=>Pe.find(Ci=>Ci.id===cn)).filter(Boolean),lt=Pe.map(cn=>cn.time).sort(),hn=gt.map((cn,Ci)=>({...cn,time:lt[Ci]})),ii=[...(n.itinerary||[]).filter(cn=>cn.day!==ye),...hn];t==null||t({...n,itinerary:ii})}catch(Ge){console.error("Optimization failed",Ge),alert("Route optimization failed.")}finally{B(null)}},je=ye=>{te(ye.id),ee(ye.day),pe(ye.time),k(ye.activity),V(ye.location),q(ye.notes||""),ye.travelToNext?(et(ye.travelToNext.mode),Ae(ye.travelToNext.duration),Ye(ye.travelToNext.details||"")):(Ae(""),Ye("")),H(!0)},un=async()=>{var lt;if(!J)return;let ye=null;if(U)try{const{geocodeAddress:hn}=await lf(async()=>{const{geocodeAddress:cn}=await Promise.resolve().then(()=>N5);return{geocodeAddress:cn}},void 0),Ai=hn(U),ii=new Promise((cn,Ci)=>setTimeout(()=>Ci(new Error("Geocoding timeout")),5e3));ye=await Promise.race([Ai,ii])}catch(hn){console.error("Auto-geocoding failed or timed out",hn)}const Pe=Y?(lt=n.itinerary)==null?void 0:lt.find(hn=>hn.id===Y):null,Ge={id:Y||Date.now().toString(),day:Number(re),time:ge,activity:J,location:U,notes:F,coordinates:ye||(Pe==null?void 0:Pe.coordinates)||null,lat:(ye==null?void 0:ye.lat)??(Pe==null?void 0:Pe.lat)??null,lng:(ye==null?void 0:ye.lng)??(Pe==null?void 0:Pe.lng)??null,attachments:(Pe==null?void 0:Pe.attachments)||[],...ne?{travelToNext:{mode:Le,duration:ne,details:Se}}:{}};let gt;Y?gt=(n.itinerary||[]).map(hn=>hn.id===Y?Ge:hn):gt=[...n.itinerary||[],Ge],t==null||t({...n,itinerary:gt}),te(null),k(""),V(""),q(""),Ae(""),Ye(""),H(!1)},gn=ye=>{if(confirm(r.delete_trip_confirm.replace("{title}",r.itinerary))){const Pe=(n.itinerary||[]).filter(Ge=>Ge.id!==ye);t==null||t({...n,itinerary:Pe})}},Et=ye=>{ye&&window.open(ye,"_blank")},pt=ye=>{switch(ye){case"WALK":return T.jsx(yb,{className:"w-4 h-4"});case"TRAIN":return T.jsx(Z0,{className:"w-4 h-4"});case"BUS":return T.jsx(_b,{className:"w-4 h-4"});case"CAR":return T.jsx(rb,{className:"w-4 h-4"});case"FLIGHT":return T.jsx(ow,{className:"w-4 h-4"});default:return T.jsx(Z0,{className:"w-4 h-4"})}},Nt=()=>{var ye,Pe;return!n.weather||((ye=n.weather)==null?void 0:ye.length)===0?null:T.jsxs("div",{className:"mb-6",children:[T.jsxs("div",{className:"flex items-center justify-between mb-3",children:[T.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1",children:r.weather}),T.jsxs("button",{onClick:Fe,disabled:de,className:"text-xs font-bold text-coral flex items-center gap-1 hover:bg-coral/10 px-2 py-1 rounded-lg transition-colors",children:[T.jsx(Bp,{className:"w-3 h-3"}),de?"...":""]})]}),T.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar pb-2",children:(Pe=n.weather)==null?void 0:Pe.map((Ge,gt)=>T.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center justify-center gap-1 bg-white border border-sand p-3 rounded-2xl min-w-[70px] shadow-sm",children:[T.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:Ge.date}),T.jsx("span",{className:"text-2xl drop-shadow-sm",children:Ge.icon}),T.jsxs("span",{className:"text-xs font-bold text-ink",children:[Ge.tempHigh,""]})]},gt))}),Ie&&T.jsxs("div",{className:"mt-4 bg-white p-5 rounded-3xl shadow-card border border-sand animate-fade-in relative",children:[T.jsx("button",{onClick:()=>K(null),className:"absolute top-3 right-3 text-gray-300 hover:text-gray-500",children:T.jsx(da,{className:"w-4 h-4"})}),T.jsxs("div",{className:"flex items-start gap-3",children:[T.jsx("div",{className:"bg-orange-100 p-2 rounded-full text-orange-500 shrink-0",children:T.jsx(Bp,{className:"w-5 h-5"})}),T.jsxs("div",{children:[T.jsx("h5",{className:"font-bold text-ink mb-2",children:"AI "}),T.jsx("div",{className:"prose prose-sm text-gray-600 leading-relaxed whitespace-pre-line",children:Ie})]})]})]})]})},Dt=e==null?void 0:e.minimalistMode;return T.jsxs("div",{className:"pb-40 relative min-h-full",children:[T.jsxs("div",{className:"sticky top-0 z-20 bg-paper/95 backdrop-blur-md border-b border-sand/50 py-3 mb-6 -mx-5 px-5 flex items-center justify-between shadow-sm",children:[T.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar flex-1 mr-2",children:[T.jsx("span",{className:"text-xs font-bold text-gray-400 shrink-0 mr-1",children:r.nav_quick_jump}),fe.map(ye=>T.jsxs("button",{onClick:()=>{const Pe=document.getElementById(`day-header-${ye}`);Pe&&Pe.scrollIntoView({behavior:"smooth",block:"start"})},className:"flex-shrink-0 px-4 py-1.5 bg-white border border-sand rounded-full font-bold text-ink text-xs hover:border-coral hover:text-coral hover:shadow-md active:bg-coral active:text-white transition-all whitespace-nowrap",children:[r.day," ",ye]},`nav-${ye}`))]}),T.jsx("button",{onClick:be,className:"p-2 bg-white rounded-full border border-sand text-coral hover:bg-coral hover:text-white transition-colors shadow-sm shrink-0",children:T.jsx(gb,{className:"w-5 h-5"})})]}),!Dt&&Nt(),((Rt=n.itinerary)==null?void 0:Rt.length)>0?T.jsxs("div",{children:[!Dt&&T.jsx("h4",{className:"text-xs font-bold text-gray-400 mb-4 uppercase tracking-wider ml-1",children:r.itinerary}),fe.map(ye=>{var Pe;return T.jsxs("div",{className:"mb-8 scroll-mt-48",id:`day-header-${ye}`,children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4 sticky top-[60px] bg-paper py-2 z-10 border-b border-sand/50 shadow-sm",children:[T.jsxs("div",{className:"bg-coral text-white px-3 py-1 rounded-lg text-sm font-bold shadow-sm",children:[r.day," ",ye]}),T.jsx("div",{className:"h-px bg-sand flex-1"}),T.jsxs("button",{onClick:()=>mt(ye),disabled:j===ye,className:"flex items-center gap-1 text-xs font-bold text-coral bg-white border border-coral px-2 py-1 rounded-lg hover:bg-coral hover:text-white transition-colors disabled:opacity-50",children:[j===ye?T.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"}):T.jsx(sa,{className:"w-3 h-3"}),r.optimize_route||"AI Route"]})]}),T.jsx("div",{className:`space-y-0 relative ${Dt?"":"border-l-2 border-sand ml-4"}`,children:(Pe=ae[ye])==null?void 0:Pe.map((Ge,gt)=>T.jsxs("div",{className:"relative group",children:[T.jsxs("div",{className:`relative ${Dt?"mb-4 border-b border-sand pb-4":"pl-8 pb-10 last:pb-0"}`,children:[!Dt&&T.jsx("div",{className:"absolute -left-[7px] top-1.5 w-3.5 h-3.5 rounded-full border-2 border-paper shadow-sm bg-gray-300 group-hover:bg-coral transition-colors"}),T.jsxs("div",{className:"transition-all opacity-90 group-hover:opacity-100",children:[T.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T.jsx("div",{className:"flex items-center gap-2",children:T.jsx("span",{className:"text-xs font-bold font-mono text-coral bg-coral/10 px-2 py-1 rounded-lg",children:Ge.time})}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{onClick:lt=>{lt.stopPropagation(),i(Ge)},className:"p-1.5 bg-white text-gray-400 rounded-full border border-sand hover:text-green-600 hover:border-green-600 shadow-sm",title:"",children:T.jsx(rw,{className:"w-3 h-3"})}),T.jsx("button",{onClick:lt=>{lt.stopPropagation(),je(Ge)},className:"p-1.5 bg-white text-gray-400 rounded-full border border-sand hover:text-coral hover:border-coral shadow-sm",title:"",children:T.jsx(cw,{className:"w-3 h-3"})}),T.jsx("button",{onClick:lt=>{lt.stopPropagation(),gn(Ge.id)},className:"p-1.5 bg-white text-red-400 rounded-full border border-red-200 hover:bg-red-50 hover:text-red-600 hover:border-red-500 shadow-sm transition-colors",title:"",children:T.jsx(da,{className:"w-3 h-3"})})]})]}),T.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-card border border-transparent hover:border-sand transition-all relative",children:[T.jsx("button",{onClick:lt=>{lt.stopPropagation(),ze(Ge.activity,Ge.location)},className:"absolute top-4 right-4 text-gray-300 hover:text-coral transition-colors",children:T.jsx(ab,{className:"w-5 h-5"})}),T.jsx("h4",{className:`font-bold text-ink ${Dt?"text-base":"text-lg"} mb-1 pr-6`,children:Ge.activity}),T.jsxs("div",{onClick:()=>Et(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(Ge.location)}`),className:"flex items-center gap-1.5 text-sm text-gray-500 cursor-pointer hover:text-coral truncate mt-1",children:[T.jsx(Up,{className:"w-3.5 h-3.5 shrink-0 text-coral"}),Ge.location]}),Ge.notes&&!Dt&&T.jsx("p",{className:"text-sm text-gray-600 mt-3 pt-3 border-t border-gray-50 leading-relaxed",children:Ge.notes})]})]})]}),Ge.travelToNext&&!Dt&&T.jsxs("div",{className:"pl-8 pb-10 relative",children:[T.jsx("div",{className:"absolute left-[0px] top-0 bottom-0 w-0.5 border-l-2 border-dotted border-gray-300 -ml-[1px]"}),T.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-sand rounded-xl p-3 w-fit max-w-[80%]",children:[T.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-sand flex items-center justify-center text-gray-500 shadow-sm shrink-0",children:pt(Ge.travelToNext.mode)}),T.jsx("div",{children:T.jsxs("div",{className:"text-xs font-bold text-gray-500 flex items-center gap-1",children:[Ge.travelToNext.duration,Ge.travelToNext.details&&T.jsxs("span",{className:"font-normal text-gray-400",children:[" ",Ge.travelToNext.details]})]})})]})]})]},Ge.id||gt))})]},ye)})]}):T.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[T.jsx("div",{className:"w-16 h-16 bg-sand/30 rounded-full flex items-center justify-center text-gray-400",children:T.jsx(uw,{className:"w-8 h-8"})}),T.jsxs("p",{className:"text-gray-400 font-medium",children:[r.no_itinerary,T.jsx("br",{}),T.jsx("span",{className:"text-xs",children:r.click_add})]})]}),l&&T.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>c(null),children:T.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[80vh] overflow-y-auto",onClick:ye=>ye.stopPropagation(),children:[T.jsxs("div",{className:"flex items-center justify-between mb-4",children:[T.jsx("h3",{className:"text-xl font-bold text-ink",children:l.name}),T.jsx("button",{onClick:xe,className:`p-2 rounded-full ${S?"bg-coral text-white":"bg-gray-100 text-gray-500"}`,children:T.jsx(o5,{className:"w-5 h-5"})})]}),p?T.jsx("div",{className:"flex justify-center py-10",children:T.jsx("div",{className:"w-8 h-8 border-4 border-coral border-t-transparent rounded-full animate-spin"})}):T.jsx("div",{className:"prose prose-sm text-gray-600 leading-relaxed whitespace-pre-line",children:m})]})}),z&&T.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>H(!1),children:T.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",onClick:ye=>ye.stopPropagation(),children:[T.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:Y?r.edit_activity:r.add_activity}),T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.day}),T.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-sand px-3",children:[T.jsx("span",{className:"text-sm font-bold text-gray-400 mr-2",children:r.day}),T.jsx("input",{type:"number",min:"1",value:re,onChange:ye=>ee(parseInt(ye.target.value)||1),className:"w-full bg-transparent p-3 text-lg font-bold border-none outline-none"})]})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.time}),T.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-sand px-3",children:[T.jsx(ob,{className:"w-5 h-5 text-gray-400 mr-2"}),T.jsx("input",{type:"time",value:ge,onChange:ye=>pe(ye.target.value),className:"w-full bg-transparent p-3 text-lg font-bold border-none outline-none"})]})]})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.activity_name}),T.jsx("input",{value:J,onChange:ye=>k(ye.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300",autoFocus:!0})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.location}),T.jsx("input",{value:U,onChange:ye=>V(ye.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300"})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.notes}),T.jsx("textarea",{value:F,onChange:ye=>q(ye.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-medium border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300 min-h-[80px]"})]}),T.jsxs("div",{className:"pt-4 border-t border-sand",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 mb-2 block",children:r.travel_to_next}),T.jsx("div",{className:"flex gap-2 mb-3 overflow-x-auto no-scrollbar",children:["WALK","TRAIN","BUS","CAR","FLIGHT"].map(ye=>T.jsx("button",{onClick:()=>et(ye),className:`p-2 rounded-lg border ${Le===ye?"bg-ink text-white border-ink":"bg-white text-gray-400 border-sand"}`,children:pt(ye)},ye))}),T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsx("input",{value:ne,onChange:ye=>Ae(ye.target.value),placeholder:"1h 30m",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"}),T.jsx("input",{value:Se,onChange:ye=>Ye(ye.target.value),placeholder:"Details...",className:"w-full bg-white p-3 rounded-xl text-sm font-medium border-none shadow-sm outline-none"})]})]}),T.jsx("div",{className:"sticky bottom-0 bg-paper pt-4 mt-4 border-t border-sand z-10 pb-20",children:T.jsx("button",{onClick:un,disabled:!J,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:Y?r.confirm:r.add_activity})})]})]})}),T.jsx("button",{onClick:()=>{te(null),ee(1),pe("09:00"),k(""),V(""),q(""),Ae(""),Ye(""),H(!0)},className:"fixed bottom-24 right-6 w-14 h-14 bg-coral text-white rounded-full shadow-xl shadow-coral/40 flex items-center justify-center z-30 hover:bg-coralDark active:scale-90 transition-all",children:T.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})},o5=({className:n})=>T.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:n,children:[T.jsx("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 001.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06zM18.584 5.106a.75.75 0 011.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 11-1.06-1.06 8.25 8.25 0 000-11.668.75.75 0 010-1.06z"}),T.jsx("path",{d:"M15.932 7.757a.75.75 0 011.061 0 6 6 0 010 8.486.75.75 0 01-1.06-1.061 4.5 4.5 0 000-6.364.75.75 0 010-1.06z"})]}),zg=[{code:"TWD",symbol:"NT$",name:""},{code:"JPY",symbol:"",name:""},{code:"USD",symbol:"$",name:""},{code:"EUR",symbol:"",name:""},{code:"KRW",symbol:"",name:""},{code:"CNY",symbol:"",name:""},{code:"HKD",symbol:"HK$",name:""},{code:"GBP",symbol:"",name:""},{code:"THB",symbol:"",name:""},{code:"SGD",symbol:"S$",name:""}],sl=n=>{const e=zg.find(t=>t.code===n);return e?e.symbol:n},r5=({trip:n,settings:e,onUpdateTrip:t})=>{var Ie,K,de,Ce,ae,fe,be,Fe,ze;const i=Xt[e.language]||Xt["zh-TW"],[r,l]=W.useState(!1),[c,m]=W.useState(""),[g,p]=W.useState(""),[E,S]=W.useState(""),[C,M]=W.useState("Cash"),[z,H]=W.useState(((Ie=n.budget)==null?void 0:Ie.currency)||"TWD"),[Y,te]=W.useState(""),[re,ee]=W.useState(0),[ge,pe]=W.useState(!1),[J,k]=W.useState(null),[U,V]=W.useState(!1),[F,q]=W.useState(""),j=()=>{var We,mt;const xe=parseInt(F);if(!isNaN(xe)&&xe>=0){const je={...n,budget:{...n.budget,total:xe,currency:((We=n.budget)==null?void 0:We.currency)||"TWD",expenses:((mt=n.budget)==null?void 0:mt.expenses)||[]}};t==null||t(je)}V(!1)};W.useEffect(()=>{var xe;r&&(H(((xe=n.budget)==null?void 0:xe.currency)||"TWD"),te(""))},[r,(K=n.budget)==null?void 0:K.currency]),W.useEffect(()=>{(async()=>{var mt;const We=((mt=n.budget)==null?void 0:mt.currency)||"TWD";if(k(null),z!==We&&e.apiKey){pe(!0);try{const je=await Ug(z,We);je?te(je):k(" (API Key )")}catch(je){console.error(je),k("")}pe(!1)}})()},[z,(de=n.budget)==null?void 0:de.currency,e.apiKey]),W.useEffect(()=>{const xe=parseFloat(g)||0,We=parseFloat(Y)||1;ee(Math.round(xe*We))},[g,Y]);const B=()=>{var Et,pt,Nt;if(!c||!g)return;const xe=parseFloat(g);if(xe<=0){alert(i.amount_invalid||"Amount must be greater than 0");return}const We=parseFloat(Y)||1,mt=Math.round(xe*We),je={id:Date.now().toString(),title:c,amount:mt,category:"Other",date:new Date().toISOString().split("T")[0],payer:E||"ME",paymentMethod:C,originalCurrency:z,originalAmount:xe,exchangeRate:We},un=((Et=n.budget)==null?void 0:Et.expenses)||[],gn={...n,budget:{...n.budget,total:((pt=n.budget)==null?void 0:pt.total)||0,currency:((Nt=n.budget)==null?void 0:Nt.currency)||"TWD",expenses:[je,...un]}};t==null||t(gn),l(!1),m(""),p("")},Le=xe=>{var We,mt,je;if(confirm(i.delete_trip_confirm.replace("{title}",i.expense_item))){const gn=(((We=n.budget)==null?void 0:We.expenses)||[]).filter(pt=>pt.id!==xe),Et={...n,budget:{...n.budget,total:((mt=n.budget)==null?void 0:mt.total)||0,currency:((je=n.budget)==null?void 0:je.currency)||"TWD",expenses:gn}};t==null||t(Et)}},et=(((Ce=n.budget)==null?void 0:Ce.expenses)||[]).reduce((xe,We)=>xe+We.amount,0),ne=((ae=n.budget)==null?void 0:ae.total)||0,Ae=ne>0?Math.min(et/ne*100,100):0,Se=((fe=n.budget)==null?void 0:fe.currency)||"TWD",Ye=sl(Se);return T.jsxs("div",{className:"pb-32",children:[T.jsxs("div",{className:"bg-ink text-white p-6 rounded-3xl shadow-xl mb-8 relative overflow-hidden",children:[T.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -mr-10 -mt-10 blur-2xl"}),T.jsxs("div",{className:"relative z-10",children:[T.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-1",children:i.budget_total}),T.jsx("div",{className:"flex items-center gap-2 mb-6 group",children:U?T.jsxs("div",{className:"flex items-center",children:[T.jsx("span",{className:"text-2xl mr-1 font-black",children:Ye}),T.jsx("input",{type:"number",value:F,onChange:xe=>q(xe.target.value),onBlur:j,onKeyDown:xe=>xe.key==="Enter"&&j(),className:"bg-transparent text-4xl font-black text-white border-b-2 border-white/20 outline-none w-48",autoFocus:!0})]}):T.jsxs("h2",{className:"text-4xl font-black cursor-pointer hover:opacity-80 transition-opacity flex items-center gap-2",onClick:()=>{q(ne.toString()),V(!0)},children:[T.jsx("span",{className:"text-2xl mr-1",children:Ye}),ne.toLocaleString(),T.jsx("svg",{className:"w-5 h-5 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]})}),T.jsxs("div",{className:"mb-2 flex justify-between text-sm font-bold",children:[T.jsx("span",{className:"text-gray-300",children:i.budget_spent}),T.jsxs("span",{children:[Ye,et.toLocaleString()]})]}),T.jsx("div",{className:"h-3 bg-gray-700 rounded-full overflow-hidden mb-4",children:T.jsx("div",{className:`h-full rounded-full ${Ae>90?"bg-red-500":"bg-coral"}`,style:{width:`${Ae}%`}})}),T.jsxs("div",{className:"flex justify-between text-xs text-gray-400 font-medium",children:[T.jsxs("span",{children:[Ae.toFixed(1),"%"]}),T.jsxs("span",{children:[": ",Ye,et.toLocaleString()]})]})]})]}),T.jsxs("div",{className:"space-y-4",children:[T.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1 mb-2",children:i.expense_list}),(Fe=(be=n.budget)==null?void 0:be.expenses)==null?void 0:Fe.map(xe=>{var We;return T.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-sand flex items-center justify-between group",children:[T.jsxs("div",{className:"flex items-center gap-4",children:[T.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold ${xe.payer==="ME"?"bg-coral/10 text-coral":"bg-gray-100 text-gray-500"}`,children:xe.payer==="ME"?"":""}),T.jsxs("div",{children:[T.jsx("h4",{className:"font-bold text-ink",children:xe.title}),T.jsxs("p",{className:"text-xs text-gray-400",children:[xe.date,"  ",xe.paymentMethod]}),xe.originalCurrency&&xe.originalCurrency!==Se&&T.jsxs("p",{className:"text-xs text-coral font-medium mt-0.5",children:[sl(xe.originalCurrency),(We=xe.originalAmount)==null?void 0:We.toLocaleString(),T.jsx("span",{className:"text-gray-400 mx-1",children:""}),xe.exchangeRate]}),xe.note&&T.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:xe.note})]})]}),T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsxs("span",{className:"font-bold text-ink text-lg",children:[Ye,xe.amount.toLocaleString()]}),T.jsx("button",{onClick:()=>Le(xe.id),className:"text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all",children:T.jsx(da,{className:"w-5 h-5"})})]})]},xe.id)}),(!((ze=n.budget)!=null&&ze.expenses)||n.budget.expenses.length===0)&&T.jsx("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:i.no_expenses})]}),r&&T.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>l(!1),children:T.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up relative",onClick:xe=>xe.stopPropagation(),children:[T.jsx("button",{onClick:()=>l(!1),className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:T.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),T.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_expense}),T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.expense_item}),T.jsx("input",{value:c,onChange:xe=>m(xe.target.value),placeholder:": ",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal",autoFocus:!0,onFocus:xe=>xe.target.select()})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.amount}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("select",{value:z,onChange:xe=>H(xe.target.value),className:"bg-white rounded-xl border-none shadow-sm px-3 font-bold text-ink outline-none",children:zg.map(xe=>T.jsx("option",{value:xe.code,children:xe.code},xe.code))}),T.jsxs("div",{className:"flex-1 flex items-center bg-white rounded-xl border-none shadow-sm px-4",children:[T.jsx("span",{className:"text-gray-400 font-bold mr-2",children:sl(z)}),T.jsx("input",{value:g,onChange:xe=>p(xe.target.value),type:"number",placeholder:"0",className:"w-full bg-transparent py-4 text-xl font-bold border-none outline-none placeholder:font-normal",onFocus:xe=>xe.target.select()})]})]})]}),z!==Se&&T.jsxs("div",{className:"space-y-1 bg-sand/30 p-3 rounded-xl",children:[T.jsxs("div",{className:"flex justify-between items-center mb-2",children:[T.jsxs("label",{className:"text-xs font-bold text-gray-500",children:[" (",z,"  ",Se,")"]}),T.jsxs("span",{className:"text-xs font-bold text-coral",children:[" ",Ye,re.toLocaleString()]})]}),T.jsxs("div",{className:"relative",children:[T.jsx("input",{value:Y,onChange:xe=>te(xe.target.value),type:"number",step:"0.01",placeholder:ge?"...":"Exchange Rate",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none",onFocus:xe=>xe.target.select(),disabled:ge}),ge&&T.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:T.jsx("div",{className:"w-4 h-4 border-2 border-coral border-t-transparent rounded-full animate-spin"})})]}),!e.apiKey&&T.jsx("p",{className:"text-[10px] text-red-400 mt-1",children:"*  API Key "}),J&&T.jsxs("p",{className:"text-[10px] text-red-400 mt-1",children:["* ",J]})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsxs("div",{className:"flex bg-white rounded-xl p-1 shadow-sm",children:[T.jsx("button",{onClick:()=>S("ME"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${E==="ME"||E===""?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payer_me}),T.jsx("button",{onClick:()=>S("OTHER"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${E==="OTHER"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payer_other})]}),T.jsxs("div",{className:"flex bg-white rounded-xl p-1 shadow-sm",children:[T.jsx("button",{onClick:()=>M("Cash"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${C==="Cash"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payment_cash}),T.jsx("button",{onClick:()=>M("Card"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${C==="Card"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payment_card})]})]}),T.jsx("div",{className:"space-y-1",children:T.jsxs("select",{className:"w-full bg-white p-3 rounded-xl font-bold text-ink border-none shadow-sm outline-none h-[48px] text-center",children:[T.jsx("option",{value:"Individual",children:i.split_individual}),T.jsx("option",{value:"Shared",children:i.split_shared})]})}),T.jsxs("div",{className:"space-y-3 pt-2",children:[T.jsx("button",{onClick:B,disabled:!c||!g,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:"+ "}),T.jsx("button",{onClick:()=>l(!1),className:"w-full py-3 bg-transparent text-gray-400 font-bold hover:text-gray-600 transition-colors",children:""})]})]})]})}),T.jsx("button",{onClick:()=>l(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-ink text-white rounded-full shadow-xl shadow-ink/40 flex items-center justify-center z-30 hover:scale-105 active:scale-95 transition-all",children:T.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})},a5=({trip:n,settings:e,onUpdateTrip:t})=>{var J;const i=Xt[e.language]||Xt["zh-TW"],[r,l]=W.useState(!1),[c,m]=W.useState("FLIGHT"),[g,p]=W.useState(""),[E,S]=W.useState(""),[C,M]=W.useState(""),[z,H]=W.useState(""),[Y,te]=W.useState(""),[re,ee]=W.useState(""),ge=()=>{if(!g)return;const U=[{id:Date.now().toString(),type:c,airline:g,number:E||"N/A",origin:C||"-",destination:z||"-",departureTime:Y?`${Y} ${re}`:re||"00:00",arrivalTime:"-",status:"Confirmed",bookingUrl:""},...n.bookings||[]];t==null||t({...n,bookings:U}),p(""),S(""),M(""),H(""),te(""),ee(""),l(!1)},pe=k=>{if(confirm(i.delete_trip_confirm.replace("{title}",i.bookings))){const V=(n.bookings||[]).filter(F=>F.id!==k);t==null||t({...n,bookings:V})}};return T.jsxs("div",{className:"pb-32",children:[T.jsxs("div",{className:"space-y-4",children:[(J=n.bookings)==null?void 0:J.map(k=>T.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-sand relative group",children:[T.jsxs("div",{className:"flex justify-between items-start mb-4",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"w-10 h-10 bg-blue-50 text-blue-500 rounded-xl flex items-center justify-center",children:k.type==="FLIGHT"?T.jsx(ow,{className:"w-5 h-5"}):T.jsx(aw,{className:"w-5 h-5"})}),T.jsxs("div",{children:[T.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:k.type}),T.jsx("h4",{className:"font-bold text-ink text-lg",children:k.airline})]})]}),T.jsx("div",{className:"text-right",children:T.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-bold ${k.status==="Confirmed"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-500"}`,children:k.status})})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-gray-400 font-bold mb-1",children:"DEPARTURE"}),T.jsx("p",{className:"text-ink font-bold text-lg",children:k.origin}),T.jsx("p",{className:"text-sm text-gray-500",children:k.departureTime})]}),T.jsxs("div",{className:"text-right",children:[T.jsx("p",{className:"text-xs text-gray-400 font-bold mb-1",children:"ARRIVAL"}),T.jsx("p",{className:"text-ink font-bold text-lg",children:k.destination}),T.jsx("p",{className:"text-sm text-gray-500",children:k.arrivalTime})]})]}),T.jsxs("div",{className:"pt-4 border-t border-sand flex justify-between items-center",children:[T.jsxs("div",{className:"text-xs text-gray-400 font-mono",children:["REF: ",T.jsx("span",{className:"text-ink font-bold",children:k.number})]}),T.jsx("button",{onClick:()=>pe(k.id),className:"text-gray-300 hover:text-red-500 transition-colors",children:T.jsx(da,{className:"w-4 h-4"})})]})]},k.id)),(!n.bookings||n.bookings.length===0)&&T.jsx("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:i.no_bookings})]}),r&&T.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>l(!1),children:T.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",onClick:k=>k.stopPropagation(),children:[T.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_booking}),T.jsxs("div",{className:"space-y-4",children:[T.jsx("div",{className:"flex bg-white rounded-xl p-1 shadow-sm mb-4",children:["FLIGHT","HOTEL","TRAIN"].map(k=>T.jsx("button",{onClick:()=>m(k),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${c===k?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:k},k))}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.provider}),T.jsx("input",{value:g,onChange:k=>p(k.target.value),placeholder:"Airline / Hotel Name...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none",autoFocus:!0})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.ref_number}),T.jsx("input",{value:E,onChange:k=>S(k.target.value),placeholder:"PNR...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.date}),T.jsx("input",{type:"date",value:Y,onChange:k=>te(k.target.value),className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.origin}),T.jsx("input",{value:C,onChange:k=>M(k.target.value),placeholder:"TPE...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]}),T.jsxs("div",{className:"space-y-1",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.label_destination}),T.jsx("input",{value:z,onChange:k=>H(k.target.value),placeholder:"NRT...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]})]}),T.jsx("button",{onClick:ge,disabled:!g,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 mt-4 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:i.confirm})]})]})}),T.jsx("button",{onClick:()=>l(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-blue-500 text-white rounded-full shadow-xl shadow-blue-500/40 flex items-center justify-center z-30 hover:scale-105 active:scale-95 transition-all",children:T.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})};function Qw(n,e){const t=W.useRef(e);W.useEffect(function(){e!==t.current&&n.attributionControl!=null&&(t.current!=null&&n.attributionControl.removeAttribution(t.current),e!=null&&n.attributionControl.addAttribution(e)),t.current=e},[n,e])}var l5=sw();const u5=1;function c5(n){return Object.freeze({__version:u5,map:n})}function $w(n,e){return Object.freeze({...n,...e})}const Bg=W.createContext(null);function uf(){const n=W.use(Bg);if(n==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}function Xw(n){function e(t,i){const{instance:r,context:l}=n(t).current;W.useImperativeHandle(i,()=>r);const{children:c}=t;return c==null?null:Hc.createElement(Bg,{value:l},c)}return W.forwardRef(e)}function d5(n){function e(t,i){const[r,l]=W.useState(!1),{instance:c}=n(t,l).current;W.useImperativeHandle(i,()=>c),W.useEffect(function(){r&&c.update()},[c,r,t.children]);const m=c._contentNode;return m?l5.createPortal(t.children,m):null}return W.forwardRef(e)}function h5(n){function e(t,i){const{instance:r}=n(t).current;return W.useImperativeHandle(i,()=>r),null}return W.forwardRef(e)}function Fg(n,e){const t=W.useRef(void 0);W.useEffect(function(){return e!=null&&n.instance.on(e),t.current=e,function(){t.current!=null&&n.instance.off(t.current),t.current=null}},[n,e])}function cf(n,e){const t=n.pane??e.pane;return t?{...n,pane:t}:n}function f5(n,e){return function(i,r){const l=uf(),c=n(cf(i,l),l);return Qw(l.map,i.attribution),Fg(c.current,i.eventHandlers),e(c.current,l,i,r),c}}var Nc={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var m5=Nc.exports,xx;function p5(){return xx||(xx=1,(function(n,e){(function(t,i){i(e)})(m5,(function(t){var i="1.9.4";function r(a){var d,v,A,I;for(v=1,A=arguments.length;v<A;v++){I=arguments[v];for(d in I)a[d]=I[d]}return a}var l=Object.create||(function(){function a(){}return function(d){return a.prototype=d,new a}})();function c(a,d){var v=Array.prototype.slice;if(a.bind)return a.bind.apply(a,v.call(arguments,1));var A=v.call(arguments,2);return function(){return a.apply(d,A.length?A.concat(v.call(arguments)):arguments)}}var m=0;function g(a){return"_leaflet_id"in a||(a._leaflet_id=++m),a._leaflet_id}function p(a,d,v){var A,I,P,G;return G=function(){A=!1,I&&(P.apply(v,I),I=!1)},P=function(){A?I=arguments:(a.apply(v,arguments),setTimeout(G,d),A=!0)},P}function E(a,d,v){var A=d[1],I=d[0],P=A-I;return a===A&&v?a:((a-I)%P+P)%P+I}function S(){return!1}function C(a,d){if(d===!1)return a;var v=Math.pow(10,d===void 0?6:d);return Math.round(a*v)/v}function M(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function z(a){return M(a).split(/\s+/)}function H(a,d){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?l(a.options):{});for(var v in d)a.options[v]=d[v];return a.options}function Y(a,d,v){var A=[];for(var I in a)A.push(encodeURIComponent(v?I.toUpperCase():I)+"="+encodeURIComponent(a[I]));return(!d||d.indexOf("?")===-1?"?":"&")+A.join("&")}var te=/\{ *([\w_ -]+) *\}/g;function re(a,d){return a.replace(te,function(v,A){var I=d[A];if(I===void 0)throw new Error("No value provided for variable "+v);return typeof I=="function"&&(I=I(d)),I})}var ee=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function ge(a,d){for(var v=0;v<a.length;v++)if(a[v]===d)return v;return-1}var pe="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function J(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var k=0;function U(a){var d=+new Date,v=Math.max(0,16-(d-k));return k=d+v,window.setTimeout(a,v)}var V=window.requestAnimationFrame||J("RequestAnimationFrame")||U,F=window.cancelAnimationFrame||J("CancelAnimationFrame")||J("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function q(a,d,v){if(v&&V===U)a.call(d);else return V.call(window,c(a,d))}function j(a){a&&F.call(window,a)}var B={__proto__:null,extend:r,create:l,bind:c,get lastId(){return m},stamp:g,throttle:p,wrapNum:E,falseFn:S,formatNum:C,trim:M,splitWords:z,setOptions:H,getParamString:Y,template:re,isArray:ee,indexOf:ge,emptyImageUrl:pe,requestFn:V,cancelFn:F,requestAnimFrame:q,cancelAnimFrame:j};function Le(){}Le.extend=function(a){var d=function(){H(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=d.__super__=this.prototype,A=l(v);A.constructor=d,d.prototype=A;for(var I in this)Object.prototype.hasOwnProperty.call(this,I)&&I!=="prototype"&&I!=="__super__"&&(d[I]=this[I]);return a.statics&&r(d,a.statics),a.includes&&(et(a.includes),r.apply(null,[A].concat(a.includes))),r(A,a),delete A.statics,delete A.includes,A.options&&(A.options=v.options?l(v.options):{},r(A.options,a.options)),A._initHooks=[],A.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var P=0,G=A._initHooks.length;P<G;P++)A._initHooks[P].call(this)}},d},Le.include=function(a){var d=this.prototype.options;return r(this.prototype,a),a.options&&(this.prototype.options=d,this.mergeOptions(a.options)),this},Le.mergeOptions=function(a){return r(this.prototype.options,a),this},Le.addInitHook=function(a){var d=Array.prototype.slice.call(arguments,1),v=typeof a=="function"?a:function(){this[a].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function et(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=ee(a)?a:[a];for(var d=0;d<a.length;d++)a[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ne={on:function(a,d,v){if(typeof a=="object")for(var A in a)this._on(A,a[A],d);else{a=z(a);for(var I=0,P=a.length;I<P;I++)this._on(a[I],d,v)}return this},off:function(a,d,v){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var A in a)this._off(A,a[A],d);else{a=z(a);for(var I=arguments.length===1,P=0,G=a.length;P<G;P++)I?this._off(a[P]):this._off(a[P],d,v)}return this},_on:function(a,d,v,A){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(a,d,v)===!1){v===this&&(v=void 0);var I={fn:d,ctx:v};A&&(I.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(I)}},_off:function(a,d,v){var A,I,P;if(this._events&&(A=this._events[a],!!A)){if(arguments.length===1){if(this._firingCount)for(I=0,P=A.length;I<P;I++)A[I].fn=S;delete this._events[a];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var G=this._listens(a,d,v);if(G!==!1){var X=A[G];this._firingCount&&(X.fn=S,this._events[a]=A=A.slice()),A.splice(G,1)}}},fire:function(a,d,v){if(!this.listens(a,v))return this;var A=r({},d,{type:a,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var I=this._events[a];if(I){this._firingCount=this._firingCount+1||1;for(var P=0,G=I.length;P<G;P++){var X=I[P],le=X.fn;X.once&&this.off(a,le,X.ctx),le.call(X.ctx||this,A)}this._firingCount--}}return v&&this._propagateEvent(A),this},listens:function(a,d,v,A){typeof a!="string"&&console.warn('"string" type argument expected');var I=d;typeof d!="function"&&(A=!!d,I=void 0,v=void 0);var P=this._events&&this._events[a];if(P&&P.length&&this._listens(a,I,v)!==!1)return!0;if(A){for(var G in this._eventParents)if(this._eventParents[G].listens(a,d,v,A))return!0}return!1},_listens:function(a,d,v){if(!this._events)return!1;var A=this._events[a]||[];if(!d)return!!A.length;v===this&&(v=void 0);for(var I=0,P=A.length;I<P;I++)if(A[I].fn===d&&A[I].ctx===v)return I;return!1},once:function(a,d,v){if(typeof a=="object")for(var A in a)this._on(A,a[A],d,!0);else{a=z(a);for(var I=0,P=a.length;I<P;I++)this._on(a[I],d,v,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[g(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[g(a)],this},_propagateEvent:function(a){for(var d in this._eventParents)this._eventParents[d].fire(a.type,r({layer:a.target,propagatedFrom:a.target},a),!0)}};ne.addEventListener=ne.on,ne.removeEventListener=ne.clearAllEventListeners=ne.off,ne.addOneTimeEventListener=ne.once,ne.fireEvent=ne.fire,ne.hasEventListeners=ne.listens;var Ae=Le.extend(ne);function Se(a,d,v){this.x=v?Math.round(a):a,this.y=v?Math.round(d):d}var Ye=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};Se.prototype={clone:function(){return new Se(this.x,this.y)},add:function(a){return this.clone()._add(Ie(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(Ie(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new Se(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new Se(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Ye(this.x),this.y=Ye(this.y),this},distanceTo:function(a){a=Ie(a);var d=a.x-this.x,v=a.y-this.y;return Math.sqrt(d*d+v*v)},equals:function(a){return a=Ie(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=Ie(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+C(this.x)+", "+C(this.y)+")"}};function Ie(a,d,v){return a instanceof Se?a:ee(a)?new Se(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new Se(a.x,a.y):new Se(a,d,v)}function K(a,d){if(a)for(var v=d?[a,d]:a,A=0,I=v.length;A<I;A++)this.extend(v[A])}K.prototype={extend:function(a){var d,v;if(!a)return this;if(a instanceof Se||typeof a[0]=="number"||"x"in a)d=v=Ie(a);else if(a=de(a),d=a.min,v=a.max,!d||!v)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=v.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(a){return Ie((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return Ie(this.min.x,this.max.y)},getTopRight:function(){return Ie(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var d,v;return typeof a[0]=="number"||a instanceof Se?a=Ie(a):a=de(a),a instanceof K?(d=a.min,v=a.max):d=v=a,d.x>=this.min.x&&v.x<=this.max.x&&d.y>=this.min.y&&v.y<=this.max.y},intersects:function(a){a=de(a);var d=this.min,v=this.max,A=a.min,I=a.max,P=I.x>=d.x&&A.x<=v.x,G=I.y>=d.y&&A.y<=v.y;return P&&G},overlaps:function(a){a=de(a);var d=this.min,v=this.max,A=a.min,I=a.max,P=I.x>d.x&&A.x<v.x,G=I.y>d.y&&A.y<v.y;return P&&G},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var d=this.min,v=this.max,A=Math.abs(d.x-v.x)*a,I=Math.abs(d.y-v.y)*a;return de(Ie(d.x-A,d.y-I),Ie(v.x+A,v.y+I))},equals:function(a){return a?(a=de(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function de(a,d){return!a||a instanceof K?a:new K(a,d)}function Ce(a,d){if(a)for(var v=d?[a,d]:a,A=0,I=v.length;A<I;A++)this.extend(v[A])}Ce.prototype={extend:function(a){var d=this._southWest,v=this._northEast,A,I;if(a instanceof fe)A=a,I=a;else if(a instanceof Ce){if(A=a._southWest,I=a._northEast,!A||!I)return this}else return a?this.extend(be(a)||ae(a)):this;return!d&&!v?(this._southWest=new fe(A.lat,A.lng),this._northEast=new fe(I.lat,I.lng)):(d.lat=Math.min(A.lat,d.lat),d.lng=Math.min(A.lng,d.lng),v.lat=Math.max(I.lat,v.lat),v.lng=Math.max(I.lng,v.lng)),this},pad:function(a){var d=this._southWest,v=this._northEast,A=Math.abs(d.lat-v.lat)*a,I=Math.abs(d.lng-v.lng)*a;return new Ce(new fe(d.lat-A,d.lng-I),new fe(v.lat+A,v.lng+I))},getCenter:function(){return new fe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new fe(this.getNorth(),this.getWest())},getSouthEast:function(){return new fe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof fe||"lat"in a?a=be(a):a=ae(a);var d=this._southWest,v=this._northEast,A,I;return a instanceof Ce?(A=a.getSouthWest(),I=a.getNorthEast()):A=I=a,A.lat>=d.lat&&I.lat<=v.lat&&A.lng>=d.lng&&I.lng<=v.lng},intersects:function(a){a=ae(a);var d=this._southWest,v=this._northEast,A=a.getSouthWest(),I=a.getNorthEast(),P=I.lat>=d.lat&&A.lat<=v.lat,G=I.lng>=d.lng&&A.lng<=v.lng;return P&&G},overlaps:function(a){a=ae(a);var d=this._southWest,v=this._northEast,A=a.getSouthWest(),I=a.getNorthEast(),P=I.lat>d.lat&&A.lat<v.lat,G=I.lng>d.lng&&A.lng<v.lng;return P&&G},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,d){return a?(a=ae(a),this._southWest.equals(a.getSouthWest(),d)&&this._northEast.equals(a.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ae(a,d){return a instanceof Ce?a:new Ce(a,d)}function fe(a,d,v){if(isNaN(a)||isNaN(d))throw new Error("Invalid LatLng object: ("+a+", "+d+")");this.lat=+a,this.lng=+d,v!==void 0&&(this.alt=+v)}fe.prototype={equals:function(a,d){if(!a)return!1;a=be(a);var v=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return v<=(d===void 0?1e-9:d)},toString:function(a){return"LatLng("+C(this.lat,a)+", "+C(this.lng,a)+")"},distanceTo:function(a){return ze.distance(this,be(a))},wrap:function(){return ze.wrapLatLng(this)},toBounds:function(a){var d=180*a/40075017,v=d/Math.cos(Math.PI/180*this.lat);return ae([this.lat-d,this.lng-v],[this.lat+d,this.lng+v])},clone:function(){return new fe(this.lat,this.lng,this.alt)}};function be(a,d,v){return a instanceof fe?a:ee(a)&&typeof a[0]!="object"?a.length===3?new fe(a[0],a[1],a[2]):a.length===2?new fe(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new fe(a.lat,"lng"in a?a.lng:a.lon,a.alt):d===void 0?null:new fe(a,d,v)}var Fe={latLngToPoint:function(a,d){var v=this.projection.project(a),A=this.scale(d);return this.transformation._transform(v,A)},pointToLatLng:function(a,d){var v=this.scale(d),A=this.transformation.untransform(a,v);return this.projection.unproject(A)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var d=this.projection.bounds,v=this.scale(a),A=this.transformation.transform(d.min,v),I=this.transformation.transform(d.max,v);return new K(A,I)},infinite:!1,wrapLatLng:function(a){var d=this.wrapLng?E(a.lng,this.wrapLng,!0):a.lng,v=this.wrapLat?E(a.lat,this.wrapLat,!0):a.lat,A=a.alt;return new fe(v,d,A)},wrapLatLngBounds:function(a){var d=a.getCenter(),v=this.wrapLatLng(d),A=d.lat-v.lat,I=d.lng-v.lng;if(A===0&&I===0)return a;var P=a.getSouthWest(),G=a.getNorthEast(),X=new fe(P.lat-A,P.lng-I),le=new fe(G.lat-A,G.lng-I);return new Ce(X,le)}},ze=r({},Fe,{wrapLng:[-180,180],R:6371e3,distance:function(a,d){var v=Math.PI/180,A=a.lat*v,I=d.lat*v,P=Math.sin((d.lat-a.lat)*v/2),G=Math.sin((d.lng-a.lng)*v/2),X=P*P+Math.cos(A)*Math.cos(I)*G*G,le=2*Math.atan2(Math.sqrt(X),Math.sqrt(1-X));return this.R*le}}),xe=6378137,We={R:xe,MAX_LATITUDE:85.0511287798,project:function(a){var d=Math.PI/180,v=this.MAX_LATITUDE,A=Math.max(Math.min(v,a.lat),-v),I=Math.sin(A*d);return new Se(this.R*a.lng*d,this.R*Math.log((1+I)/(1-I))/2)},unproject:function(a){var d=180/Math.PI;return new fe((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*d,a.x*d/this.R)},bounds:(function(){var a=xe*Math.PI;return new K([-a,-a],[a,a])})()};function mt(a,d,v,A){if(ee(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=d,this._c=v,this._d=A}mt.prototype={transform:function(a,d){return this._transform(a.clone(),d)},_transform:function(a,d){return d=d||1,a.x=d*(this._a*a.x+this._b),a.y=d*(this._c*a.y+this._d),a},untransform:function(a,d){return d=d||1,new Se((a.x/d-this._b)/this._a,(a.y/d-this._d)/this._c)}};function je(a,d,v,A){return new mt(a,d,v,A)}var un=r({},ze,{code:"EPSG:3857",projection:We,transformation:(function(){var a=.5/(Math.PI*We.R);return je(a,.5,-a,.5)})()}),gn=r({},un,{code:"EPSG:900913"});function Et(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function pt(a,d){var v="",A,I,P,G,X,le;for(A=0,P=a.length;A<P;A++){for(X=a[A],I=0,G=X.length;I<G;I++)le=X[I],v+=(I?"L":"M")+le.x+" "+le.y;v+=d?Ue.svg?"z":"x":""}return v||"M0 0"}var Nt=document.documentElement.style,Dt="ActiveXObject"in window,Rt=Dt&&!document.addEventListener,ye="msLaunchUri"in navigator&&!("documentMode"in document),Pe=Bn("webkit"),Ge=Bn("android"),gt=Bn("android 2")||Bn("android 3"),lt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),hn=Ge&&Bn("Google")&&lt<537&&!("AudioNode"in window),Ai=!!window.opera,ii=!ye&&Bn("chrome"),cn=Bn("gecko")&&!Pe&&!Ai&&!Dt,Ci=!ii&&Bn("safari"),io=Bn("phantom"),so="OTransition"in Nt,Mo=navigator.platform.indexOf("Win")===0,Re=Dt&&"transition"in Nt,$e="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!gt,_t="MozPerspective"in Nt,ut=!window.L_DISABLE_3D&&(Re||$e||_t)&&!so&&!io,Un=typeof orientation<"u"||Bn("mobile"),_i=Un&&Pe,bi=Un&&$e,Jn=!window.PointerEvent&&window.MSPointerEvent,Zi=!!(window.PointerEvent||Jn),en="ontouchstart"in window||!!window.TouchEvent,yi=!window.L_NO_TOUCH&&(en||Zi),zn=Un&&Ai,Yi=Un&&cn,Bu=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Tl=(function(){var a=!1;try{var d=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",S,d),window.removeEventListener("testPassiveEventSupport",S,d)}catch{}return a})(),fs=(function(){return!!document.createElement("canvas").getContext})(),Ds=!!(document.createElementNS&&Et("svg").createSVGRect),Fu=!!Ds&&(function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Po=!Ds&&(function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var d=a.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch{return!1}})(),Ea=navigator.platform.indexOf("Mac")===0,wa=navigator.platform.indexOf("Linux")===0;function Bn(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var Ue={ie:Dt,ielt9:Rt,edge:ye,webkit:Pe,android:Ge,android23:gt,androidStock:hn,opera:Ai,chrome:ii,gecko:cn,safari:Ci,phantom:io,opera12:so,win:Mo,ie3d:Re,webkit3d:$e,gecko3d:_t,any3d:ut,mobile:Un,mobileWebkit:_i,mobileWebkit3d:bi,msPointer:Jn,pointer:Zi,touch:yi,touchNative:en,mobileOpera:zn,mobileGecko:Yi,retina:Bu,passiveEvents:Tl,canvas:fs,svg:Ds,vml:Po,inlineSvg:Fu,mac:Ea,linux:wa},Sa=Ue.msPointer?"MSPointerDown":"pointerdown",Ii=Ue.msPointer?"MSPointerMove":"pointermove",Ni=Ue.msPointer?"MSPointerUp":"pointerup",fn=Ue.msPointer?"MSPointerCancel":"pointercancel",_n={touchstart:Sa,touchmove:Ii,touchend:Ni,touchcancel:fn},Wi={touchstart:ps,touchmove:Fn,touchend:Fn,touchcancel:Fn},Ji={},xl=!1;function El(a,d,v){return d==="touchstart"&&Ri(),Wi[d]?(v=Wi[d].bind(this,v),a.addEventListener(_n[d],v,!1),v):(console.warn("wrong event specified:",d),S)}function wl(a,d,v){if(!_n[d]){console.warn("wrong event specified:",d);return}a.removeEventListener(_n[d],v,!1)}function ms(a){Ji[a.pointerId]=a}function pr(a){Ji[a.pointerId]&&(Ji[a.pointerId]=a)}function Qi(a){delete Ji[a.pointerId]}function Ri(){xl||(document.addEventListener(Sa,ms,!0),document.addEventListener(Ii,pr,!0),document.addEventListener(Ni,Qi,!0),document.addEventListener(fn,Qi,!0),xl=!0)}function Fn(a,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var v in Ji)d.touches.push(Ji[v]);d.changedTouches=[d],a(d)}}function ps(a,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&on(d),Fn(a,d)}function yn(a){var d={},v,A;for(A in a)v=a[A],d[A]=v&&v.bind?v.bind(a):v;return a=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var Aa=200;function Ca(a,d){a.addEventListener("dblclick",d);var v=0,A;function I(P){if(P.detail!==1){A=P.detail;return}if(!(P.pointerType==="mouse"||P.sourceCapabilities&&!P.sourceCapabilities.firesTouchEvents)){var G=uo(P);if(!(G.some(function(le){return le instanceof HTMLLabelElement&&le.attributes.for})&&!G.some(function(le){return le instanceof HTMLInputElement||le instanceof HTMLSelectElement}))){var X=Date.now();X-v<=Aa?(A++,A===2&&d(yn(P))):A=1,v=X}}}return a.addEventListener("click",I),{dblclick:d,simDblclick:I}}function gs(a,d){a.removeEventListener("dblclick",d.dblclick),a.removeEventListener("click",d.simDblclick)}var Mi=Do(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ls=Do(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),gr=Ls==="webkitTransition"||Ls==="OTransition"?Ls+"End":"transitionend";function _r(a){return typeof a=="string"?document.getElementById(a):a}function oo(a,d){var v=a.style[d]||a.currentStyle&&a.currentStyle[d];if((!v||v==="auto")&&document.defaultView){var A=document.defaultView.getComputedStyle(a,null);v=A?A[d]:null}return v==="auto"?null:v}function ft(a,d,v){var A=document.createElement(a);return A.className=d||"",v&&v.appendChild(A),A}function yt(a){var d=a.parentNode;d&&d.removeChild(a)}function nn(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function sn(a){var d=a.parentNode;d&&d.lastChild!==a&&d.appendChild(a)}function vi(a){var d=a.parentNode;d&&d.firstChild!==a&&d.insertBefore(a,d.firstChild)}function ko(a,d){if(a.classList!==void 0)return a.classList.contains(d);var v=_s(a);return v.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(v)}function De(a,d){if(a.classList!==void 0)for(var v=z(d),A=0,I=v.length;A<I;A++)a.classList.add(v[A]);else if(!ko(a,d)){var P=_s(a);Pi(a,(P?P+" ":"")+d)}}function Ht(a,d){a.classList!==void 0?a.classList.remove(d):Pi(a,M((" "+_s(a)+" ").replace(" "+d+" "," ")))}function Pi(a,d){a.className.baseVal===void 0?a.className=d:a.className.baseVal=d}function _s(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function Jt(a,d){"opacity"in a.style?a.style.opacity=d:"filter"in a.style&&yr(a,d)}function yr(a,d){var v=!1,A="DXImageTransform.Microsoft.Alpha";try{v=a.filters.item(A)}catch{if(d===1)return}d=Math.round(d*100),v?(v.Enabled=d!==100,v.Opacity=d):a.style.filter+=" progid:"+A+"(opacity="+d+")"}function Do(a){for(var d=document.documentElement.style,v=0;v<a.length;v++)if(a[v]in d)return a[v];return!1}function $i(a,d,v){var A=d||new Se(0,0);a.style[Mi]=(Ue.ie3d?"translate("+A.x+"px,"+A.y+"px)":"translate3d("+A.x+"px,"+A.y+"px,0)")+(v?" scale("+v+")":"")}function Gt(a,d){a._leaflet_pos=d,Ue.any3d?$i(a,d):(a.style.left=d.x+"px",a.style.top=d.y+"px")}function ys(a){return a._leaflet_pos||new Se(0,0)}var ki,Cn,vr;if("onselectstart"in document)ki=function(){Je(window,"selectstart",on)},Cn=function(){Lt(window,"selectstart",on)};else{var Vs=Do(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ki=function(){if(Vs){var a=document.documentElement.style;vr=a[Vs],a[Vs]="none"}},Cn=function(){Vs&&(document.documentElement.style[Vs]=vr,vr=void 0)}}function Lo(){Je(window,"dragstart",on)}function ro(){Lt(window,"dragstart",on)}var Vo,vs;function ao(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(si(),Vo=a,vs=a.style.outlineStyle,a.style.outlineStyle="none",Je(window,"keydown",si))}function si(){Vo&&(Vo.style.outlineStyle=vs,Vo=void 0,vs=void 0,Lt(window,"keydown",si))}function Tr(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function oi(a){var d=a.getBoundingClientRect();return{x:d.width/a.offsetWidth||1,y:d.height/a.offsetHeight||1,boundingClientRect:d}}var lo={__proto__:null,TRANSFORM:Mi,TRANSITION:Ls,TRANSITION_END:gr,get:_r,getStyle:oo,create:ft,remove:yt,empty:nn,toFront:sn,toBack:vi,hasClass:ko,addClass:De,removeClass:Ht,setClass:Pi,getClass:_s,setOpacity:Jt,testProp:Do,setTransform:$i,setPosition:Gt,getPosition:ys,get disableTextSelection(){return ki},get enableTextSelection(){return Cn},disableImageDrag:Lo,enableImageDrag:ro,preventOutline:ao,restoreOutline:si,getSizedParentNode:Tr,getScale:oi};function Je(a,d,v,A){if(d&&typeof d=="object")for(var I in d)ri(a,I,d[I],v);else{d=z(d);for(var P=0,G=d.length;P<G;P++)ri(a,d[P],v,A)}return this}var qn="_leaflet_events";function Lt(a,d,v,A){if(arguments.length===1)Os(a),delete a[qn];else if(d&&typeof d=="object")for(var I in d)Us(a,I,d[I],v);else if(d=z(d),arguments.length===2)Os(a,function(X){return ge(d,X)!==-1});else for(var P=0,G=d.length;P<G;P++)Us(a,d[P],v,A);return this}function Os(a,d){for(var v in a[qn]){var A=v.split(/\d/)[0];(!d||d(A))&&Us(a,A,null,null,v)}}var Ti={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ri(a,d,v,A){var I=d+g(v)+(A?"_"+g(A):"");if(a[qn]&&a[qn][I])return this;var P=function(X){return v.call(A||a,X||window.event)},G=P;!Ue.touchNative&&Ue.pointer&&d.indexOf("touch")===0?P=El(a,d,P):Ue.touch&&d==="dblclick"?P=Ca(a,P):"addEventListener"in a?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?a.addEventListener(Ti[d]||d,P,Ue.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(P=function(X){X=X||window.event,ts(a,X)&&G(X)},a.addEventListener(Ti[d],P,!1)):a.addEventListener(d,G,!1):a.attachEvent("on"+d,P),a[qn]=a[qn]||{},a[qn][I]=P}function Us(a,d,v,A,I){I=I||d+g(v)+(A?"_"+g(A):"");var P=a[qn]&&a[qn][I];if(!P)return this;!Ue.touchNative&&Ue.pointer&&d.indexOf("touch")===0?wl(a,d,P):Ue.touch&&d==="dblclick"?gs(a,P):"removeEventListener"in a?a.removeEventListener(Ti[d]||d,P,!1):a.detachEvent("on"+d,P),a[qn][I]=null}function wt(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function Di(a){return ri(a,"wheel",wt),this}function zs(a){return Je(a,"mousedown touchstart dblclick contextmenu",wt),a._leaflet_disable_click=!0,this}function on(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function Xi(a){return on(a),wt(a),this}function uo(a){if(a.composedPath)return a.composedPath();for(var d=[],v=a.target;v;)d.push(v),v=v.parentNode;return d}function Ts(a,d){if(!d)return new Se(a.clientX,a.clientY);var v=oi(d),A=v.boundingClientRect;return new Se((a.clientX-A.left)/v.x-d.clientLeft,(a.clientY-A.top)/v.y-d.clientTop)}var es=Ue.linux&&Ue.chrome?window.devicePixelRatio:Ue.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function bn(a){return Ue.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/es:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function ts(a,d){var v=d.relatedTarget;if(!v)return!0;try{for(;v&&v!==a;)v=v.parentNode}catch{return!1}return v!==a}var xs={__proto__:null,on:Je,off:Lt,stopPropagation:wt,disableScrollPropagation:Di,disableClickPropagation:zs,preventDefault:on,stop:Xi,getPropagationPath:uo,getMousePosition:Ts,getWheelDelta:bn,isExternalTarget:ts,addListener:Je,removeListener:Lt},Bs=Ae.extend({run:function(a,d,v,A){this.stop(),this._el=a,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(A||.5,.2),this._startPos=ys(a),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=q(this._animate,this),this._step()},_step:function(a){var d=+new Date-this._startTime,v=this._duration*1e3;d<v?this._runFrame(this._easeOut(d/v),a):(this._runFrame(1),this._complete())},_runFrame:function(a,d){var v=this._startPos.add(this._offset.multiplyBy(a));d&&v._round(),Gt(this._el,v),this.fire("step")},_complete:function(){j(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),ht=Ae.extend({options:{crs:un,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,d){d=H(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(be(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ls&&Ue.any3d&&!Ue.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Je(this._proxy,gr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,d,v){if(d=d===void 0?this._zoom:this._limitZoom(d),a=this._limitCenter(be(a),d,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=r({animate:v.animate},v.zoom),v.pan=r({animate:v.animate,duration:v.duration},v.pan));var A=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,d,v.zoom):this._tryAnimatedPan(a,v.pan);if(A)return clearTimeout(this._sizeTimer),this}return this._resetView(a,d,v.pan&&v.pan.noMoveStart),this},setZoom:function(a,d){return this._loaded?this.setView(this.getCenter(),a,{zoom:d}):(this._zoom=a,this)},zoomIn:function(a,d){return a=a||(Ue.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,d)},zoomOut:function(a,d){return a=a||(Ue.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,d)},setZoomAround:function(a,d,v){var A=this.getZoomScale(d),I=this.getSize().divideBy(2),P=a instanceof Se?a:this.latLngToContainerPoint(a),G=P.subtract(I).multiplyBy(1-1/A),X=this.containerPointToLatLng(I.add(G));return this.setView(X,d,{zoom:v})},_getBoundsCenterZoom:function(a,d){d=d||{},a=a.getBounds?a.getBounds():ae(a);var v=Ie(d.paddingTopLeft||d.padding||[0,0]),A=Ie(d.paddingBottomRight||d.padding||[0,0]),I=this.getBoundsZoom(a,!1,v.add(A));if(I=typeof d.maxZoom=="number"?Math.min(d.maxZoom,I):I,I===1/0)return{center:a.getCenter(),zoom:I};var P=A.subtract(v).divideBy(2),G=this.project(a.getSouthWest(),I),X=this.project(a.getNorthEast(),I),le=this.unproject(G.add(X).divideBy(2).add(P),I);return{center:le,zoom:I}},fitBounds:function(a,d){if(a=ae(a),!a.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(a,d);return this.setView(v.center,v.zoom,d)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,d){return this.setView(a,this._zoom,{pan:d})},panBy:function(a,d){if(a=Ie(a).round(),d=d||{},!a.x&&!a.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Bs,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){De(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,v,d.duration||.25,d.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,d,v){if(v=v||{},v.animate===!1||!Ue.any3d)return this.setView(a,d,v);this._stop();var A=this.project(this.getCenter()),I=this.project(a),P=this.getSize(),G=this._zoom;a=be(a),d=d===void 0?G:d;var X=Math.max(P.x,P.y),le=X*this.getZoomScale(G,d),ve=I.distanceTo(A)||1,Me=1.42,He=Me*Me;function ct(mn){var js=mn?-1:1,Ho=mn?le:X,Zu=le*le-X*X+js*He*He*ve*ve,Ka=2*Ho*He*ve,Za=Zu/Ka,To=Math.sqrt(Za*Za+1)-Za,Ks=To<1e-9?-18:Math.log(To);return Ks}function Ln(mn){return(Math.exp(mn)-Math.exp(-mn))/2}function vn(mn){return(Math.exp(mn)+Math.exp(-mn))/2}function wi(mn){return Ln(mn)/vn(mn)}var Vt=ct(0);function Ot(mn){return X*(vn(Vt)/vn(Vt+Me*mn))}function vt(mn){return X*(vn(Vt)*wi(Vt+Me*mn)-Ln(Vt))/He}function yo(mn){return 1-Math.pow(1-mn,1.5)}var zi=Date.now(),Vl=(ct(1)-Vt)/Me,vo=v.duration?1e3*v.duration:1e3*Vl*.8;function Ku(){var mn=(Date.now()-zi)/vo,js=yo(mn)*Vl;mn<=1?(this._flyToFrame=q(Ku,this),this._move(this.unproject(A.add(I.subtract(A).multiplyBy(vt(js)/ve)),G),this.getScaleZoom(X/Ot(js),G),{flyTo:!0})):this._move(a,d)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),Ku.call(this),this},flyToBounds:function(a,d){var v=this._getBoundsCenterZoom(a,d);return this.flyTo(v.center,v.zoom,d)},setMaxBounds:function(a){return a=ae(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var d=this.options.minZoom;return this.options.minZoom=a,this._loaded&&d!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var d=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&d!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,d){this._enforcingBounds=!0;var v=this.getCenter(),A=this._limitCenter(v,this._zoom,ae(a));return v.equals(A)||this.panTo(A,d),this._enforcingBounds=!1,this},panInside:function(a,d){d=d||{};var v=Ie(d.paddingTopLeft||d.padding||[0,0]),A=Ie(d.paddingBottomRight||d.padding||[0,0]),I=this.project(this.getCenter()),P=this.project(a),G=this.getPixelBounds(),X=de([G.min.add(v),G.max.subtract(A)]),le=X.getSize();if(!X.contains(P)){this._enforcingBounds=!0;var ve=P.subtract(X.getCenter()),Me=X.extend(P).getSize().subtract(le);I.x+=ve.x<0?-Me.x:Me.x,I.y+=ve.y<0?-Me.y:Me.y,this.panTo(this.unproject(I),d),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=r({animate:!1,pan:!0},a===!0?{animate:!0}:a);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),A=d.divideBy(2).round(),I=v.divideBy(2).round(),P=A.subtract(I);return!P.x&&!P.y?this:(a.animate&&a.pan?this.panBy(P):(a.pan&&this._rawPanBy(P),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=r({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=c(this._handleGeolocationResponse,this),v=c(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,v,a):navigator.geolocation.getCurrentPosition(d,v,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var d=a.code,v=a.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var d=a.coords.latitude,v=a.coords.longitude,A=new fe(d,v),I=A.toBounds(a.coords.accuracy*2),P=this._locateOptions;if(P.setView){var G=this.getBoundsZoom(I);this.setView(A,P.maxZoom?Math.min(G,P.maxZoom):G)}var X={latlng:A,bounds:I,timestamp:a.timestamp};for(var le in a.coords)typeof a.coords[le]=="number"&&(X[le]=a.coords[le]);this.fire("locationfound",X)}},addHandler:function(a,d){if(!d)return this;var v=this[a]=new d(this);return this._handlers.push(v),this.options[a]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),yt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(j(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)yt(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,d){var v="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),A=ft("div",v,d||this._mapPane);return a&&(this._panes[a]=A),A},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),d=this.unproject(a.getBottomLeft()),v=this.unproject(a.getTopRight());return new Ce(d,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,d,v){a=ae(a),v=Ie(v||[0,0]);var A=this.getZoom()||0,I=this.getMinZoom(),P=this.getMaxZoom(),G=a.getNorthWest(),X=a.getSouthEast(),le=this.getSize().subtract(v),ve=de(this.project(X,A),this.project(G,A)).getSize(),Me=Ue.any3d?this.options.zoomSnap:1,He=le.x/ve.x,ct=le.y/ve.y,Ln=d?Math.max(He,ct):Math.min(He,ct);return A=this.getScaleZoom(Ln,A),Me&&(A=Math.round(A/(Me/100))*(Me/100),A=d?Math.ceil(A/Me)*Me:Math.floor(A/Me)*Me),Math.max(I,Math.min(P,A))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Se(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,d){var v=this._getTopLeftPoint(a,d);return new K(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,d){var v=this.options.crs;return d=d===void 0?this._zoom:d,v.scale(a)/v.scale(d)},getScaleZoom:function(a,d){var v=this.options.crs;d=d===void 0?this._zoom:d;var A=v.zoom(a*v.scale(d));return isNaN(A)?1/0:A},project:function(a,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(be(a),d)},unproject:function(a,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(Ie(a),d)},layerPointToLatLng:function(a){var d=Ie(a).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(a){var d=this.project(be(a))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(be(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(ae(a))},distance:function(a,d){return this.options.crs.distance(be(a),be(d))},containerPointToLayerPoint:function(a){return Ie(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return Ie(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var d=this.containerPointToLayerPoint(Ie(a));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(be(a)))},mouseEventToContainerPoint:function(a){return Ts(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var d=this._container=_r(a);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Je(d,"scroll",this._onScroll,this),this._containerId=g(d)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ue.any3d,De(a,"leaflet-container"+(Ue.touch?" leaflet-touch":"")+(Ue.retina?" leaflet-retina":"")+(Ue.ielt9?" leaflet-oldie":"")+(Ue.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=oo(a,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Gt(this._mapPane,new Se(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(De(a.markerPane,"leaflet-zoom-hide"),De(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,d,v){Gt(this._mapPane,new Se(0,0));var A=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var I=this._zoom!==d;this._moveStart(I,v)._move(a,d)._moveEnd(I),this.fire("viewreset"),A&&this.fire("load")},_moveStart:function(a,d){return a&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(a,d,v,A){d===void 0&&(d=this._zoom);var I=this._zoom!==d;return this._zoom=d,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),A?v&&v.pinch&&this.fire("zoom",v):((I||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return j(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){Gt(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[g(this._container)]=this;var d=a?Lt:Je;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),Ue.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){j(this._resizeRequest),this._resizeRequest=q(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,d){for(var v=[],A,I=d==="mouseout"||d==="mouseover",P=a.target||a.srcElement,G=!1;P;){if(A=this._targets[g(P)],A&&(d==="click"||d==="preclick")&&this._draggableMoved(A)){G=!0;break}if(A&&A.listens(d,!0)&&(I&&!ts(P,a)||(v.push(A),I))||P===this._container)break;P=P.parentNode}return!v.length&&!G&&!I&&this.listens(d,!0)&&(v=[this]),v},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var d=a.target||a.srcElement;if(!(!this._loaded||d._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(d))){var v=a.type;v==="mousedown"&&ao(d),this._fireDOMEvent(a,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,d,v){if(a.type==="click"){var A=r({},a);A.type="preclick",this._fireDOMEvent(A,A.type,v)}var I=this._findEventTargets(a,d);if(v){for(var P=[],G=0;G<v.length;G++)v[G].listens(d,!0)&&P.push(v[G]);I=P.concat(I)}if(I.length){d==="contextmenu"&&on(a);var X=I[0],le={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var ve=X.getLatLng&&(!X._radius||X._radius<=10);le.containerPoint=ve?this.latLngToContainerPoint(X.getLatLng()):this.mouseEventToContainerPoint(a),le.layerPoint=this.containerPointToLayerPoint(le.containerPoint),le.latlng=ve?X.getLatLng():this.layerPointToLatLng(le.layerPoint)}for(G=0;G<I.length;G++)if(I[G].fire(d,le,!0),le.originalEvent._stopped||I[G].options.bubblingMouseEvents===!1&&ge(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,d=this._handlers.length;a<d;a++)this._handlers[a].disable()},whenReady:function(a,d){return this._loaded?a.call(d||this,{target:this}):this.on("load",a,d),this},_getMapPanePos:function(){return ys(this._mapPane)||new Se(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,d){var v=a&&d!==void 0?this._getNewPixelOrigin(a,d):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,d){var v=this.getSize()._divideBy(2);return this.project(a,d)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,d,v){var A=this._getNewPixelOrigin(v,d);return this.project(a,d)._subtract(A)},_latLngBoundsToNewLayerBounds:function(a,d,v){var A=this._getNewPixelOrigin(v,d);return de([this.project(a.getSouthWest(),d)._subtract(A),this.project(a.getNorthWest(),d)._subtract(A),this.project(a.getSouthEast(),d)._subtract(A),this.project(a.getNorthEast(),d)._subtract(A)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,d,v){if(!v)return a;var A=this.project(a,d),I=this.getSize().divideBy(2),P=new K(A.subtract(I),A.add(I)),G=this._getBoundsOffset(P,v,d);return Math.abs(G.x)<=1&&Math.abs(G.y)<=1?a:this.unproject(A.add(G),d)},_limitOffset:function(a,d){if(!d)return a;var v=this.getPixelBounds(),A=new K(v.min.add(a),v.max.add(a));return a.add(this._getBoundsOffset(A,d))},_getBoundsOffset:function(a,d,v){var A=de(this.project(d.getNorthEast(),v),this.project(d.getSouthWest(),v)),I=A.min.subtract(a.min),P=A.max.subtract(a.max),G=this._rebound(I.x,-P.x),X=this._rebound(I.y,-P.y);return new Se(G,X)},_rebound:function(a,d){return a+d>0?Math.round(a-d)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(d))},_limitZoom:function(a){var d=this.getMinZoom(),v=this.getMaxZoom(),A=Ue.any3d?this.options.zoomSnap:1;return A&&(a=Math.round(a/A)*A),Math.max(d,Math.min(v,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ht(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,d){var v=this._getCenterOffset(a)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,d),!0)},_createAnimProxy:function(){var a=this._proxy=ft("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(d){var v=Mi,A=this._proxy.style[v];$i(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),A===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){yt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),d=this.getZoom();$i(this._proxy,this.project(a,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,d,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var A=this.getZoomScale(d),I=this._getCenterOffset(a)._divideBy(1-1/A);return v.animate!==!0&&!this.getSize().contains(I)?!1:(q(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(a,d,!0)},this),!0)},_animateZoom:function(a,d,v,A){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=d,De(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:d,noUpdate:A}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ht(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function co(a,d){return new ht(a,d)}var Hn=Le.extend({options:{position:"topright"},initialize:function(a){H(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var d=this._map;return d&&d.removeControl(this),this.options.position=a,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var d=this._container=this.onAdd(a),v=this.getPosition(),A=a._controlCorners[v];return De(d,"leaflet-control"),v.indexOf("bottom")!==-1?A.insertBefore(d,A.firstChild):A.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(yt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),ai=function(a){return new Hn(a)};ht.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},d="leaflet-",v=this._controlContainer=ft("div",d+"control-container",this._container);function A(I,P){var G=d+I+" "+d+P;a[I+P]=ft("div",G,v)}A("top","left"),A("top","right"),A("bottom","left"),A("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)yt(this._controlCorners[a]);yt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Oo=Hn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,d,v,A){return v<A?-1:A<v?1:0}},initialize:function(a,d,v){H(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var A in a)this._addLayer(a[A],A);for(A in d)this._addLayer(d[A],A,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return Hn.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,d){return this._addLayer(a,d),this._map?this._update():this},addOverlay:function(a,d){return this._addLayer(a,d,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var d=this._getLayer(g(a));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){De(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(De(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):Ht(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ht(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",d=this._container=ft("div",a),v=this.options.collapsed;d.setAttribute("aria-haspopup",!0),zs(d),Di(d);var A=this._section=ft("section",a+"-list");v&&(this._map.on("click",this.collapse,this),Je(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var I=this._layersLink=ft("a",a+"-toggle",d);I.href="#",I.title="Layers",I.setAttribute("role","button"),Je(I,{keydown:function(P){P.keyCode===13&&this._expandSafely()},click:function(P){on(P),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=ft("div",a+"-base",A),this._separator=ft("div",a+"-separator",A),this._overlaysList=ft("div",a+"-overlays",A),d.appendChild(A)},_getLayer:function(a){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&g(this._layers[d].layer)===a)return this._layers[d]},_addLayer:function(a,d,v){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:d,overlay:v}),this.options.sortLayers&&this._layers.sort(c(function(A,I){return this.options.sortFunction(A.layer,I.layer,A.name,I.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;nn(this._baseLayersList),nn(this._overlaysList),this._layerControlInputs=[];var a,d,v,A,I=0;for(v=0;v<this._layers.length;v++)A=this._layers[v],this._addItem(A),d=d||A.overlay,a=a||!A.overlay,I+=A.overlay?0:1;return this.options.hideSingleBase&&(a=a&&I>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=d&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var d=this._getLayer(g(a.target)),v=d.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;v&&this._map.fire(v,d)},_createRadioElement:function(a,d){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(d?' checked="checked"':"")+"/>",A=document.createElement("div");return A.innerHTML=v,A.firstChild},_addItem:function(a){var d=document.createElement("label"),v=this._map.hasLayer(a.layer),A;a.overlay?(A=document.createElement("input"),A.type="checkbox",A.className="leaflet-control-layers-selector",A.defaultChecked=v):A=this._createRadioElement("leaflet-base-layers_"+g(this),v),this._layerControlInputs.push(A),A.layerId=g(a.layer),Je(A,"click",this._onInputClick,this);var I=document.createElement("span");I.innerHTML=" "+a.name;var P=document.createElement("span");d.appendChild(P),P.appendChild(A),P.appendChild(I);var G=a.overlay?this._overlaysList:this._baseLayersList;return G.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,d,v,A=[],I=[];this._handlingClick=!0;for(var P=a.length-1;P>=0;P--)d=a[P],v=this._getLayer(d.layerId).layer,d.checked?A.push(v):d.checked||I.push(v);for(P=0;P<I.length;P++)this._map.hasLayer(I[P])&&this._map.removeLayer(I[P]);for(P=0;P<A.length;P++)this._map.hasLayer(A[P])||this._map.addLayer(A[P]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,d,v,A=this._map.getZoom(),I=a.length-1;I>=0;I--)d=a[I],v=this._getLayer(d.layerId).layer,d.disabled=v.options.minZoom!==void 0&&A<v.options.minZoom||v.options.maxZoom!==void 0&&A>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,Je(a,"click",on),this.expand();var d=this;setTimeout(function(){Lt(a,"click",on),d._preventClick=!1})}}),ba=function(a,d,v){return new Oo(a,d,v)},Fs=Hn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var d="leaflet-control-zoom",v=ft("div",d+" leaflet-bar"),A=this.options;return this._zoomInButton=this._createButton(A.zoomInText,A.zoomInTitle,d+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(A.zoomOutText,A.zoomOutTitle,d+"-out",v,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,d,v,A,I){var P=ft("a",v,A);return P.innerHTML=a,P.href="#",P.title=d,P.setAttribute("role","button"),P.setAttribute("aria-label",d),zs(P),Je(P,"click",Xi),Je(P,"click",I,this),Je(P,"click",this._refocusOnMap,this),P},_updateDisabled:function(){var a=this._map,d="leaflet-disabled";Ht(this._zoomInButton,d),Ht(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(De(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(De(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});ht.mergeOptions({zoomControl:!0}),ht.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Fs,this.addControl(this.zoomControl))});var Sl=function(a){return new Fs(a)},Ia=Hn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var d="leaflet-control-scale",v=ft("div",d),A=this.options;return this._addScales(A,d+"-line",v),a.on(A.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),v},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,d,v){a.metric&&(this._mScale=ft("div",d,v)),a.imperial&&(this._iScale=ft("div",d,v))},_update:function(){var a=this._map,d=a.getSize().y/2,v=a.distance(a.containerPointToLatLng([0,d]),a.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(v)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var d=this._getRoundNum(a),v=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,v,d/a)},_updateImperial:function(a){var d=a*3.2808399,v,A,I;d>5280?(v=d/5280,A=this._getRoundNum(v),this._updateScale(this._iScale,A+" mi",A/v)):(I=this._getRoundNum(d),this._updateScale(this._iScale,I+" ft",I/d))},_updateScale:function(a,d,v){a.style.width=Math.round(this.options.maxWidth*v)+"px",a.innerHTML=d},_getRoundNum:function(a){var d=Math.pow(10,(Math.floor(a)+"").length-1),v=a/d;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,d*v}}),Uo=function(a){return new Ia(a)},Na='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',xr=Hn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ue.inlineSvg?Na+" ":"")+"Leaflet</a>"},initialize:function(a){H(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=ft("div","leaflet-control-attribution"),zs(this._container);for(var d in a._layers)a._layers[d].getAttribution&&this.addAttribution(a._layers[d].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var d in this._attributions)this._attributions[d]&&a.push(d);var v=[];this.options.prefix&&v.push(this.options.prefix),a.length&&v.push(a.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});ht.mergeOptions({attributionControl:!0}),ht.addInitHook(function(){this.options.attributionControl&&new xr().addTo(this)});var Er=function(a){return new xr(a)};Hn.Layers=Oo,Hn.Zoom=Fs,Hn.Scale=Ia,Hn.Attribution=xr,ai.layers=ba,ai.zoom=Sl,ai.scale=Uo,ai.attribution=Er;var xi=Le.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});xi.addTo=function(a,d){return a.addHandler(d,this),this};var Al={Events:ne},ns=Ue.touch?"touchstart mousedown":"mousedown",is=Ae.extend({options:{clickTolerance:3},initialize:function(a,d,v,A){H(this,A),this._element=a,this._dragStartTarget=d||a,this._preventOutline=v},enable:function(){this._enabled||(Je(this._dragStartTarget,ns,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(is._dragging===this&&this.finishDrag(!0),Lt(this._dragStartTarget,ns,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!ko(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){is._dragging===this&&this.finishDrag();return}if(!(is._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(is._dragging=this,this._preventOutline&&ao(this._element),Lo(),ki(),!this._moving)){this.fire("down");var d=a.touches?a.touches[0]:a,v=Tr(this._element);this._startPoint=new Se(d.clientX,d.clientY),this._startPos=ys(this._element),this._parentScale=oi(v);var A=a.type==="mousedown";Je(document,A?"mousemove":"touchmove",this._onMove,this),Je(document,A?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var d=a.touches&&a.touches.length===1?a.touches[0]:a,v=new Se(d.clientX,d.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,on(a),this._moved||(this.fire("dragstart"),this._moved=!0,De(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),De(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),Gt(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){Ht(document.body,"leaflet-dragging"),this._lastTarget&&(Ht(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Lt(document,"mousemove touchmove",this._onMove,this),Lt(document,"mouseup touchend touchcancel",this._onUp,this),ro(),Cn();var d=this._moved&&this._moving;this._moving=!1,is._dragging=!1,d&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function Ra(a,d,v){var A,I=[1,4,2,8],P,G,X,le,ve,Me,He,ct;for(P=0,Me=a.length;P<Me;P++)a[P]._code=ce(a[P],d);for(X=0;X<4;X++){for(He=I[X],A=[],P=0,Me=a.length,G=Me-1;P<Me;G=P++)le=a[P],ve=a[G],le._code&He?ve._code&He||(ct=ie(ve,le,He,d,v),ct._code=ce(ct,d),A.push(ct)):(ve._code&He&&(ct=ie(ve,le,He,d,v),ct._code=ce(ct,d),A.push(ct)),A.push(le));a=A}return a}function Ma(a,d){var v,A,I,P,G,X,le,ve,Me;if(!a||a.length===0)throw new Error("latlngs not passed");Mt(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var He=be([0,0]),ct=ae(a),Ln=ct.getNorthWest().distanceTo(ct.getSouthWest())*ct.getNorthEast().distanceTo(ct.getNorthWest());Ln<1700&&(He=wr(a));var vn=a.length,wi=[];for(v=0;v<vn;v++){var Vt=be(a[v]);wi.push(d.project(be([Vt.lat-He.lat,Vt.lng-He.lng])))}for(X=le=ve=0,v=0,A=vn-1;v<vn;A=v++)I=wi[v],P=wi[A],G=I.y*P.x-P.y*I.x,le+=(I.x+P.x)*G,ve+=(I.y+P.y)*G,X+=G*3;X===0?Me=wi[0]:Me=[le/X,ve/X];var Ot=d.unproject(Ie(Me));return be([Ot.lat+He.lat,Ot.lng+He.lng])}function wr(a){for(var d=0,v=0,A=0,I=0;I<a.length;I++){var P=be(a[I]);d+=P.lat,v+=P.lng,A++}return be([d/A,v/A])}var ho={__proto__:null,clipPolygon:Ra,polygonCenter:Ma,centroid:wr};function Gn(a,d){if(!d||!a.length)return a.slice();var v=d*d;return a=b(a,v),a=qs(a,v),a}function Pa(a,d,v){return Math.sqrt(tt(a,d,v,!0))}function Cl(a,d,v){return tt(a,d,v)}function qs(a,d){var v=a.length,A=typeof Uint8Array<"u"?Uint8Array:Array,I=new A(v);I[0]=I[v-1]=1,y(a,I,d,0,v-1);var P,G=[];for(P=0;P<v;P++)I[P]&&G.push(a[P]);return G}function y(a,d,v,A,I){var P=0,G,X,le;for(X=A+1;X<=I-1;X++)le=tt(a[X],a[A],a[I],!0),le>P&&(G=X,P=le);P>v&&(d[G]=1,y(a,d,v,A,G),y(a,d,v,G,I))}function b(a,d){for(var v=[a[0]],A=1,I=0,P=a.length;A<P;A++)Ne(a[A],a[I])>d&&(v.push(a[A]),I=A);return I<P-1&&v.push(a[P-1]),v}var R;function O(a,d,v,A,I){var P=A?R:ce(a,v),G=ce(d,v),X,le,ve;for(R=G;;){if(!(P|G))return[a,d];if(P&G)return!1;X=P||G,le=ie(a,d,X,v,I),ve=ce(le,v),X===P?(a=le,P=ve):(d=le,G=ve)}}function ie(a,d,v,A,I){var P=d.x-a.x,G=d.y-a.y,X=A.min,le=A.max,ve,Me;return v&8?(ve=a.x+P*(le.y-a.y)/G,Me=le.y):v&4?(ve=a.x+P*(X.y-a.y)/G,Me=X.y):v&2?(ve=le.x,Me=a.y+G*(le.x-a.x)/P):v&1&&(ve=X.x,Me=a.y+G*(X.x-a.x)/P),new Se(ve,Me,I)}function ce(a,d){var v=0;return a.x<d.min.x?v|=1:a.x>d.max.x&&(v|=2),a.y<d.min.y?v|=4:a.y>d.max.y&&(v|=8),v}function Ne(a,d){var v=d.x-a.x,A=d.y-a.y;return v*v+A*A}function tt(a,d,v,A){var I=d.x,P=d.y,G=v.x-I,X=v.y-P,le=G*G+X*X,ve;return le>0&&(ve=((a.x-I)*G+(a.y-P)*X)/le,ve>1?(I=v.x,P=v.y):ve>0&&(I+=G*ve,P+=X*ve)),G=a.x-I,X=a.y-P,A?G*G+X*X:new Se(I,P)}function Mt(a){return!ee(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function Pt(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Mt(a)}function Qt(a,d){var v,A,I,P,G,X,le,ve;if(!a||a.length===0)throw new Error("latlngs not passed");Mt(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var Me=be([0,0]),He=ae(a),ct=He.getNorthWest().distanceTo(He.getSouthWest())*He.getNorthEast().distanceTo(He.getNorthWest());ct<1700&&(Me=wr(a));var Ln=a.length,vn=[];for(v=0;v<Ln;v++){var wi=be(a[v]);vn.push(d.project(be([wi.lat-Me.lat,wi.lng-Me.lng])))}for(v=0,A=0;v<Ln-1;v++)A+=vn[v].distanceTo(vn[v+1])/2;if(A===0)ve=vn[0];else for(v=0,P=0;v<Ln-1;v++)if(G=vn[v],X=vn[v+1],I=G.distanceTo(X),P+=I,P>A){le=(P-A)/I,ve=[X.x-le*(X.x-G.x),X.y-le*(X.y-G.y)];break}var Vt=d.unproject(Ie(ve));return be([Vt.lat+Me.lat,Vt.lng+Me.lng])}var Li={__proto__:null,simplify:Gn,pointToSegmentDistance:Pa,closestPointOnSegment:Cl,clipSegment:O,_getEdgeIntersection:ie,_getBitCode:ce,_sqClosestPointOnSegment:tt,isFlat:Mt,_flat:Pt,polylineCenter:Qt},Vi={project:function(a){return new Se(a.lng,a.lat)},unproject:function(a){return new fe(a.y,a.x)},bounds:new K([-180,-90],[180,90])},Ei={R:6378137,R_MINOR:6356752314245179e-9,bounds:new K([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var d=Math.PI/180,v=this.R,A=a.lat*d,I=this.R_MINOR/v,P=Math.sqrt(1-I*I),G=P*Math.sin(A),X=Math.tan(Math.PI/4-A/2)/Math.pow((1-G)/(1+G),P/2);return A=-v*Math.log(Math.max(X,1e-10)),new Se(a.lng*d*v,A)},unproject:function(a){for(var d=180/Math.PI,v=this.R,A=this.R_MINOR/v,I=Math.sqrt(1-A*A),P=Math.exp(-a.y/v),G=Math.PI/2-2*Math.atan(P),X=0,le=.1,ve;X<15&&Math.abs(le)>1e-7;X++)ve=I*Math.sin(G),ve=Math.pow((1-ve)/(1+ve),I/2),le=Math.PI/2-2*Math.atan(P*ve)-G,G+=le;return new fe(G*d,a.x*d/v)}},ss={__proto__:null,LonLat:Vi,Mercator:Ei,SphericalMercator:We},zo=r({},ze,{code:"EPSG:3395",projection:Ei,transformation:(function(){var a=.5/(Math.PI*Ei.R);return je(a,.5,-a,.5)})()}),Bo=r({},ze,{code:"EPSG:4326",projection:Vi,transformation:je(1/180,1,-1/180,.5)}),Sr=r({},Fe,{projection:Vi,transformation:je(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,d){var v=d.lng-a.lng,A=d.lat-a.lat;return Math.sqrt(v*v+A*A)},infinite:!0});Fe.Earth=ze,Fe.EPSG3395=zo,Fe.EPSG3857=un,Fe.EPSG900913=gn,Fe.EPSG4326=Bo,Fe.Simple=Sr;var os=Ae.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[g(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[g(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var d=a.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var v=this.getEvents();d.on(v,this),this.once("remove",function(){d.off(v,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});ht.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var d=g(a);return this._layers[d]?this:(this._layers[d]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var d=g(a);return this._layers[d]?(this._loaded&&a.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return g(a)in this._layers},eachLayer:function(a,d){for(var v in this._layers)a.call(d,this._layers[v]);return this},_addLayers:function(a){a=a?ee(a)?a:[a]:[];for(var d=0,v=a.length;d<v;d++)this.addLayer(a[d])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[g(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var d=g(a);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,d=-1/0,v=this._getZoomSpan();for(var A in this._zoomBoundLayers){var I=this._zoomBoundLayers[A].options;a=I.minZoom===void 0?a:Math.min(a,I.minZoom),d=I.maxZoom===void 0?d:Math.max(d,I.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=a===1/0?void 0:a,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ar=os.extend({initialize:function(a,d){H(this,d),this._layers={};var v,A;if(a)for(v=0,A=a.length;v<A;v++)this.addLayer(a[v])},addLayer:function(a){var d=this.getLayerId(a);return this._layers[d]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var d=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(a){var d=typeof a=="number"?a:this.getLayerId(a);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var d=Array.prototype.slice.call(arguments,1),v,A;for(v in this._layers)A=this._layers[v],A[a]&&A[a].apply(A,d);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,d){for(var v in this._layers)a.call(d,this._layers[v]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return g(a)}}),Of=function(a,d){return new Ar(a,d)},Es=Ar.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),Ar.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),Ar.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new Ce;for(var d in this._layers){var v=this._layers[d];a.extend(v.getBounds?v.getBounds():v.getLatLng())}return a}}),ld=function(a,d){return new Es(a,d)},ws=Le.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){H(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,d){var v=this._getIconUrl(a);if(!v){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var A=this._createImg(v,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(A,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),A},_setIconStyles:function(a,d){var v=this.options,A=v[d+"Size"];typeof A=="number"&&(A=[A,A]);var I=Ie(A),P=Ie(d==="shadow"&&v.shadowAnchor||v.iconAnchor||I&&I.divideBy(2,!0));a.className="leaflet-marker-"+d+" "+(v.className||""),P&&(a.style.marginLeft=-P.x+"px",a.style.marginTop=-P.y+"px"),I&&(a.style.width=I.x+"px",a.style.height=I.y+"px")},_createImg:function(a,d){return d=d||document.createElement("img"),d.src=a,d},_getIconUrl:function(a){return Ue.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function ka(a){return new ws(a)}var Da=ws.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof Da.imagePath!="string"&&(Da.imagePath=this._detectIconPath()),(this.options.imagePath||Da.imagePath)+ws.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var d=function(v,A,I){var P=A.exec(v);return P&&P[I]};return a=d(a,/^url\((['"])?(.+)\1\)$/,2),a&&d(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=ft("div","leaflet-default-icon-path",document.body),d=oo(a,"background-image")||oo(a,"backgroundImage");if(document.body.removeChild(a),d=this._stripUrl(d),d)return d;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),La=xi.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new is(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),De(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ht(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var d=this._marker,v=d._map,A=this._marker.options.autoPanSpeed,I=this._marker.options.autoPanPadding,P=ys(d._icon),G=v.getPixelBounds(),X=v.getPixelOrigin(),le=de(G.min._subtract(X).add(I),G.max._subtract(X).subtract(I));if(!le.contains(P)){var ve=Ie((Math.max(le.max.x,P.x)-le.max.x)/(G.max.x-le.max.x)-(Math.min(le.min.x,P.x)-le.min.x)/(G.min.x-le.min.x),(Math.max(le.max.y,P.y)-le.max.y)/(G.max.y-le.max.y)-(Math.min(le.min.y,P.y)-le.min.y)/(G.min.y-le.min.y)).multiplyBy(A);v.panBy(ve,{animate:!1}),this._draggable._newPos._add(ve),this._draggable._startPos._add(ve),Gt(d._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=q(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(j(this._panRequest),this._panRequest=q(this._adjustPan.bind(this,a)))},_onDrag:function(a){var d=this._marker,v=d._shadow,A=ys(d._icon),I=d._map.layerPointToLatLng(A);v&&Gt(v,A),d._latlng=I,a.latlng=I,a.oldLatLng=this._oldLatLng,d.fire("move",a).fire("drag",a)},_onDragEnd:function(a){j(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),Va=os.extend({options:{icon:new Da,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,d){H(this,d),this._latlng=be(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var d=this._latlng;return this._latlng=be(a),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=a.icon.createIcon(this._icon),A=!1;v!==this._icon&&(this._icon&&this._removeIcon(),A=!0,a.title&&(v.title=a.title),v.tagName==="IMG"&&(v.alt=a.alt||"")),De(v,d),a.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Je(v,"focus",this._panOnFocus,this);var I=a.icon.createShadow(this._shadow),P=!1;I!==this._shadow&&(this._removeShadow(),P=!0),I&&(De(I,d),I.alt=""),this._shadow=I,a.opacity<1&&this._updateOpacity(),A&&this.getPane().appendChild(this._icon),this._initInteraction(),I&&P&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Lt(this._icon,"focus",this._panOnFocus,this),yt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&yt(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&Gt(this._icon,a),this._shadow&&Gt(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(De(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),La)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new La(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&Jt(this._icon,a),this._shadow&&Jt(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var d=this.options.icon.options,v=d.iconSize?Ie(d.iconSize):Ie(0,0),A=d.iconAnchor?Ie(d.iconAnchor):Ie(0,0);a.panInside(this._latlng,{paddingTopLeft:A,paddingBottomRight:v.subtract(A)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ud(a,d){return new Va(a,d)}var Ss=os.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return H(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Cr=Ss.extend({options:{fill:!0,radius:10},initialize:function(a,d){H(this,d),this._latlng=be(a),this._radius=this.options.radius},setLatLng:function(a){var d=this._latlng;return this._latlng=be(a),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var d=a&&a.radius||this._radius;return Ss.prototype.setStyle.call(this,a),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,d=this._radiusY||a,v=this._clickTolerance(),A=[a+v,d+v];this._pxBounds=new K(this._point.subtract(A),this._point.add(A))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function cd(a,d){return new Cr(a,d)}var bl=Cr.extend({initialize:function(a,d,v){if(typeof d=="number"&&(d=r({},v,{radius:d})),H(this,d),this._latlng=be(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new Ce(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:Ss.prototype.setStyle,_project:function(){var a=this._latlng.lng,d=this._latlng.lat,v=this._map,A=v.options.crs;if(A.distance===ze.distance){var I=Math.PI/180,P=this._mRadius/ze.R/I,G=v.project([d+P,a]),X=v.project([d-P,a]),le=G.add(X).divideBy(2),ve=v.unproject(le).lat,Me=Math.acos((Math.cos(P*I)-Math.sin(d*I)*Math.sin(ve*I))/(Math.cos(d*I)*Math.cos(ve*I)))/I;(isNaN(Me)||Me===0)&&(Me=P/Math.cos(Math.PI/180*d)),this._point=le.subtract(v.getPixelOrigin()),this._radius=isNaN(Me)?0:le.x-v.project([ve,a-Me]).x,this._radiusY=le.y-G.y}else{var He=A.unproject(A.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(He).x}this._updateBounds()}});function dd(a,d,v){return new bl(a,d,v)}var Hs=Ss.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,d){H(this,d),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var d=1/0,v=null,A=tt,I,P,G=0,X=this._parts.length;G<X;G++)for(var le=this._parts[G],ve=1,Me=le.length;ve<Me;ve++){I=le[ve-1],P=le[ve];var He=A(a,I,P,!0);He<d&&(d=He,v=A(a,I,P))}return v&&(v.distance=Math.sqrt(d)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Qt(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,d){return d=d||this._defaultShape(),a=be(a),d.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new Ce,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return Mt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var d=[],v=Mt(a),A=0,I=a.length;A<I;A++)v?(d[A]=be(a[A]),this._bounds.extend(d[A])):d[A]=this._convertLatLngs(a[A]);return d},_project:function(){var a=new K;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),d=new Se(a,a);this._rawPxBounds&&(this._pxBounds=new K([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(a,d,v){var A=a[0]instanceof fe,I=a.length,P,G;if(A){for(G=[],P=0;P<I;P++)G[P]=this._map.latLngToLayerPoint(a[P]),v.extend(G[P]);d.push(G)}else for(P=0;P<I;P++)this._projectLatlngs(a[P],d,v)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,v,A,I,P,G,X,le;for(v=0,I=0,P=this._rings.length;v<P;v++)for(le=this._rings[v],A=0,G=le.length;A<G-1;A++)X=O(le[A],le[A+1],a,A,!0),X&&(d[I]=d[I]||[],d[I].push(X[0]),(X[1]!==le[A+1]||A===G-2)&&(d[I].push(X[1]),I++))}},_simplifyPoints:function(){for(var a=this._parts,d=this.options.smoothFactor,v=0,A=a.length;v<A;v++)a[v]=Gn(a[v],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,d){var v,A,I,P,G,X,le=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(v=0,P=this._parts.length;v<P;v++)for(X=this._parts[v],A=0,G=X.length,I=G-1;A<G;I=A++)if(!(!d&&A===0)&&Pa(a,X[I],X[A])<=le)return!0;return!1}});function Uf(a,d){return new Hs(a,d)}Hs._flat=Pt;var br=Hs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ma(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var d=Hs.prototype._convertLatLngs.call(this,a),v=d.length;return v>=2&&d[0]instanceof fe&&d[0].equals(d[v-1])&&d.pop(),d},_setLatLngs:function(a){Hs.prototype._setLatLngs.call(this,a),Mt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Mt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,d=this.options.weight,v=new Se(d,d);if(a=new K(a.min.subtract(v),a.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var A=0,I=this._rings.length,P;A<I;A++)P=Ra(this._rings[A],a,!0),P.length&&this._parts.push(P)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var d=!1,v,A,I,P,G,X,le,ve;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(P=0,le=this._parts.length;P<le;P++)for(v=this._parts[P],G=0,ve=v.length,X=ve-1;G<ve;X=G++)A=v[G],I=v[X],A.y>a.y!=I.y>a.y&&a.x<(I.x-A.x)*(a.y-A.y)/(I.y-A.y)+A.x&&(d=!d);return d||Hs.prototype._containsPoint.call(this,a,!0)}});function zf(a,d){return new br(a,d)}var Gs=Es.extend({initialize:function(a,d){H(this,d),this._layers={},a&&this.addData(a)},addData:function(a){var d=ee(a)?a:a.features,v,A,I;if(d){for(v=0,A=d.length;v<A;v++)I=d[v],(I.geometries||I.geometry||I.features||I.coordinates)&&this.addData(I);return this}var P=this.options;if(P.filter&&!P.filter(a))return this;var G=jn(a,P);return G?(G.feature=Rl(a),G.defaultOptions=G.options,this.resetStyle(G),P.onEachFeature&&P.onEachFeature(a,G),this.addLayer(G)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=r({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(d){this._setLayerStyle(d,a)},this)},_setLayerStyle:function(a,d){a.setStyle&&(typeof d=="function"&&(d=d(a.feature)),a.setStyle(d))}});function jn(a,d){var v=a.type==="Feature"?a.geometry:a,A=v?v.coordinates:null,I=[],P=d&&d.pointToLayer,G=d&&d.coordsToLatLng||Il,X,le,ve,Me;if(!A&&!v)return null;switch(v.type){case"Point":return X=G(A),Ir(P,a,X,d);case"MultiPoint":for(ve=0,Me=A.length;ve<Me;ve++)X=G(A[ve]),I.push(Ir(P,a,X,d));return new Es(I);case"LineString":case"MultiLineString":return le=Oa(A,v.type==="LineString"?0:1,G),new Hs(le,d);case"Polygon":case"MultiPolygon":return le=Oa(A,v.type==="Polygon"?1:2,G),new br(le,d);case"GeometryCollection":for(ve=0,Me=v.geometries.length;ve<Me;ve++){var He=jn({geometry:v.geometries[ve],type:"Feature",properties:a.properties},d);He&&I.push(He)}return new Es(I);case"FeatureCollection":for(ve=0,Me=v.features.length;ve<Me;ve++){var ct=jn(v.features[ve],d);ct&&I.push(ct)}return new Es(I);default:throw new Error("Invalid GeoJSON object.")}}function Ir(a,d,v,A){return a?a(d,v):new Va(v,A&&A.markersInheritOptions&&A)}function Il(a){return new fe(a[1],a[0],a[2])}function Oa(a,d,v){for(var A=[],I=0,P=a.length,G;I<P;I++)G=d?Oa(a[I],d-1,v):(v||Il)(a[I]),A.push(G);return A}function Nl(a,d){return a=be(a),a.alt!==void 0?[C(a.lng,d),C(a.lat,d),C(a.alt,d)]:[C(a.lng,d),C(a.lat,d)]}function Ua(a,d,v,A){for(var I=[],P=0,G=a.length;P<G;P++)I.push(d?Ua(a[P],Mt(a[P])?0:d-1,v,A):Nl(a[P],A));return!d&&v&&I.length>0&&I.push(I[0].slice()),I}function fo(a,d){return a.feature?r({},a.feature,{geometry:d}):Rl(d)}function Rl(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var mo={toGeoJSON:function(a){return fo(this,{type:"Point",coordinates:Nl(this.getLatLng(),a)})}};Va.include(mo),bl.include(mo),Cr.include(mo),Hs.include({toGeoJSON:function(a){var d=!Mt(this._latlngs),v=Ua(this._latlngs,d?1:0,!1,a);return fo(this,{type:(d?"Multi":"")+"LineString",coordinates:v})}}),br.include({toGeoJSON:function(a){var d=!Mt(this._latlngs),v=d&&!Mt(this._latlngs[0]),A=Ua(this._latlngs,v?2:d?1:0,!0,a);return d||(A=[A]),fo(this,{type:(v?"Multi":"")+"Polygon",coordinates:A})}}),Ar.include({toMultiPoint:function(a){var d=[];return this.eachLayer(function(v){d.push(v.toGeoJSON(a).geometry.coordinates)}),fo(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(a){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(a);var v=d==="GeometryCollection",A=[];return this.eachLayer(function(I){if(I.toGeoJSON){var P=I.toGeoJSON(a);if(v)A.push(P.geometry);else{var G=Rl(P);G.type==="FeatureCollection"?A.push.apply(A,G.features):A.push(G)}}}),v?fo(this,{geometries:A,type:"GeometryCollection"}):{type:"FeatureCollection",features:A}}});function Ml(a,d){return new Gs(a,d)}var za=Ml,Nr=os.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,d,v){this._url=a,this._bounds=ae(d),H(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(De(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){yt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&sn(this._image),this},bringToBack:function(){return this._map&&vi(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=ae(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",d=this._image=a?this._url:ft("img");if(De(d,"leaflet-image-layer"),this._zoomAnimated&&De(d,"leaflet-zoom-animated"),this.options.className&&De(d,this.options.className),d.onselectstart=S,d.onmousemove=S,d.onload=c(this.fire,this,"load"),d.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(a){var d=this._map.getZoomScale(a.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;$i(this._image,v,d)},_reset:function(){var a=this._image,d=new K(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=d.getSize();Gt(a,d.min),a.style.width=v.x+"px",a.style.height=v.y+"px"},_updateOpacity:function(){Jt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),hd=function(a,d,v){return new Nr(a,d,v)},po=Nr.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",d=this._image=a?this._url:ft("video");if(De(d,"leaflet-image-layer"),this._zoomAnimated&&De(d,"leaflet-zoom-animated"),this.options.className&&De(d,this.options.className),d.onselectstart=S,d.onmousemove=S,d.onloadeddata=c(this.fire,this,"load"),a){for(var v=d.getElementsByTagName("source"),A=[],I=0;I<v.length;I++)A.push(v[I].src);this._url=v.length>0?A:[d.src];return}ee(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var P=0;P<this._url.length;P++){var G=ft("source");G.src=this._url[P],d.appendChild(G)}}});function Rr(a,d,v){return new po(a,d,v)}var Pl=Nr.extend({_initImage:function(){var a=this._image=this._url;De(a,"leaflet-image-layer"),this._zoomAnimated&&De(a,"leaflet-zoom-animated"),this.options.className&&De(a,this.options.className),a.onselectstart=S,a.onmousemove=S}});function fd(a,d,v){return new Pl(a,d,v)}var Kn=os.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,d){a&&(a instanceof fe||ee(a))?(this._latlng=be(a),H(this,d)):(H(this,a),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&Jt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&Jt(this._container,1),this.bringToFront(),this.options.interactive&&(De(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(Jt(this._container,0),this._removeTimeout=setTimeout(c(yt,void 0,this._container),200)):yt(this._container),this.options.interactive&&(Ht(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=be(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&sn(this._container),this},bringToBack:function(){return this._map&&vi(this._container),this},_prepareOpen:function(a){var d=this._source;if(!d._map)return!1;if(d instanceof Es){d=null;var v=this._source._layers;for(var A in v)if(v[A]._map){d=v[A];break}if(!d)return!1;this._source=d}if(!a)if(d.getCenter)a=d.getCenter();else if(d.getLatLng)a=d.getLatLng();else if(d.getBounds)a=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")a.innerHTML=d;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),d=Ie(this.options.offset),v=this._getAnchor();this._zoomAnimated?Gt(this._container,a.add(v)):d=d.add(a).add(v);var A=this._containerBottom=-d.y,I=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=A+"px",this._container.style.left=I+"px"}},_getAnchor:function(){return[0,0]}});ht.include({_initOverlay:function(a,d,v,A){var I=d;return I instanceof a||(I=new a(A).setContent(d)),v&&I.setLatLng(v),I}}),os.include({_initOverlay:function(a,d,v,A){var I=v;return I instanceof a?(H(I,A),I._source=this):(I=d&&!A?d:new a(A,this),I.setContent(v)),I}});var Ba=Kn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,Kn.prototype.openOn.call(this,a)},onAdd:function(a){Kn.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ss||this._source.on("preclick",wt))},onRemove:function(a){Kn.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ss||this._source.off("preclick",wt))},getEvents:function(){var a=Kn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",d=this._container=ft("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=ft("div",a+"-content-wrapper",d);if(this._contentNode=ft("div",a+"-content",v),zs(d),Di(this._contentNode),Je(d,"contextmenu",wt),this._tipContainer=ft("div",a+"-tip-container",d),this._tip=ft("div",a+"-tip",this._tipContainer),this.options.closeButton){var A=this._closeButton=ft("a",a+"-close-button",d);A.setAttribute("role","button"),A.setAttribute("aria-label","Close popup"),A.href="#close",A.innerHTML='<span aria-hidden="true">&#215;</span>',Je(A,"click",function(I){on(I),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,d=a.style;d.width="",d.whiteSpace="nowrap";var v=a.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),d.width=v+1+"px",d.whiteSpace="",d.height="";var A=a.offsetHeight,I=this.options.maxHeight,P="leaflet-popup-scrolled";I&&A>I?(d.height=I+"px",De(a,P)):Ht(a,P),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),v=this._getAnchor();Gt(this._container,d.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,d=parseInt(oo(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+d,A=this._containerWidth,I=new Se(this._containerLeft,-v-this._containerBottom);I._add(ys(this._container));var P=a.layerPointToContainerPoint(I),G=Ie(this.options.autoPanPadding),X=Ie(this.options.autoPanPaddingTopLeft||G),le=Ie(this.options.autoPanPaddingBottomRight||G),ve=a.getSize(),Me=0,He=0;P.x+A+le.x>ve.x&&(Me=P.x+A-ve.x+le.x),P.x-Me-X.x<0&&(Me=P.x-X.x),P.y+v+le.y>ve.y&&(He=P.y+v-ve.y+le.y),P.y-He-X.y<0&&(He=P.y-X.y),(Me||He)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([Me,He]))}},_getAnchor:function(){return Ie(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),md=function(a,d){return new Ba(a,d)};ht.mergeOptions({closePopupOnClick:!0}),ht.include({openPopup:function(a,d,v){return this._initOverlay(Ba,a,d,v).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),os.include({bindPopup:function(a,d){return this._popup=this._initOverlay(Ba,this._popup,a,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof Es||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){Xi(a);var d=a.layer||a.target;if(this._popup._source===d&&!(d instanceof Ss)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=d,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var Fa=Kn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){Kn.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){Kn.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=Kn.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",d=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ft("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+g(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var d,v,A=this._map,I=this._container,P=A.latLngToContainerPoint(A.getCenter()),G=A.layerPointToContainerPoint(a),X=this.options.direction,le=I.offsetWidth,ve=I.offsetHeight,Me=Ie(this.options.offset),He=this._getAnchor();X==="top"?(d=le/2,v=ve):X==="bottom"?(d=le/2,v=0):X==="center"?(d=le/2,v=ve/2):X==="right"?(d=0,v=ve/2):X==="left"?(d=le,v=ve/2):G.x<P.x?(X="right",d=0,v=ve/2):(X="left",d=le+(Me.x+He.x)*2,v=ve/2),a=a.subtract(Ie(d,v,!0)).add(Me).add(He),Ht(I,"leaflet-tooltip-right"),Ht(I,"leaflet-tooltip-left"),Ht(I,"leaflet-tooltip-top"),Ht(I,"leaflet-tooltip-bottom"),De(I,"leaflet-tooltip-"+X),Gt(I,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&Jt(this._container,a)},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(d)},_getAnchor:function(){return Ie(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Bf=function(a,d){return new Fa(a,d)};ht.include({openTooltip:function(a,d,v){return this._initOverlay(Fa,a,d,v).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),os.include({bindTooltip:function(a,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Fa,this._tooltip,a,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var d=a?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[d](v),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof Es||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var d=typeof a.getElement=="function"&&a.getElement();d&&(Je(d,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),Je(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var d=typeof a.getElement=="function"&&a.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var d=a.latlng,v,A;this._tooltip.options.sticky&&a.originalEvent&&(v=this._map.mouseEventToContainerPoint(a.originalEvent),A=this._map.containerPointToLayerPoint(v),d=this._map.layerPointToLatLng(A)),this._tooltip.setLatLng(d)}});var pd=ws.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var d=a&&a.tagName==="DIV"?a:document.createElement("div"),v=this.options;if(v.html instanceof Element?(nn(d),d.appendChild(v.html)):d.innerHTML=v.html!==!1?v.html:"",v.bgPos){var A=Ie(v.bgPos);d.style.backgroundPosition=-A.x+"px "+-A.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function Ff(a){return new pd(a)}ws.Default=Da;var Mr=os.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ue.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){H(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),yt(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(sn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(vi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof Se?a:new Se(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var d=this.getPane().children,v=-a(-1/0,1/0),A=0,I=d.length,P;A<I;A++)P=d[A].style.zIndex,d[A]!==this._container&&P&&(v=a(v,+P));isFinite(v)&&(this.options.zIndex=v+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ue.ielt9){Jt(this._container,this.options.opacity);var a=+new Date,d=!1,v=!1;for(var A in this._tiles){var I=this._tiles[A];if(!(!I.current||!I.loaded)){var P=Math.min(1,(a-I.loaded)/200);Jt(I.el,P),P<1?d=!0:(I.active?v=!0:this._onOpaqueTile(I),I.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),d&&(j(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this))}},_onOpaqueTile:S,_initContainer:function(){this._container||(this._container=ft("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,d=this.options.maxZoom;if(a!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===a?(this._levels[v].el.style.zIndex=d-Math.abs(a-v),this._onUpdateLevel(v)):(yt(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var A=this._levels[a],I=this._map;return A||(A=this._levels[a]={},A.el=ft("div","leaflet-tile-container leaflet-zoom-animated",this._container),A.el.style.zIndex=d,A.origin=I.project(I.unproject(I.getPixelOrigin()),a).round(),A.zoom=a,this._setZoomTransform(A,I.getCenter(),I.getZoom()),S(A.el.offsetWidth),this._onCreateLevel(A)),this._level=A,A}},_onUpdateLevel:S,_onRemoveLevel:S,_onCreateLevel:S,_pruneTiles:function(){if(this._map){var a,d,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)d=this._tiles[a],d.retain=d.current;for(a in this._tiles)if(d=this._tiles[a],d.current&&!d.active){var A=d.coords;this._retainParent(A.x,A.y,A.z,A.z-5)||this._retainChildren(A.x,A.y,A.z,A.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var d in this._tiles)this._tiles[d].coords.z===a&&this._removeTile(d)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)yt(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,d,v,A){var I=Math.floor(a/2),P=Math.floor(d/2),G=v-1,X=new Se(+I,+P);X.z=+G;var le=this._tileCoordsToKey(X),ve=this._tiles[le];return ve&&ve.active?(ve.retain=!0,!0):(ve&&ve.loaded&&(ve.retain=!0),G>A?this._retainParent(I,P,G,A):!1)},_retainChildren:function(a,d,v,A){for(var I=2*a;I<2*a+2;I++)for(var P=2*d;P<2*d+2;P++){var G=new Se(I,P);G.z=v+1;var X=this._tileCoordsToKey(G),le=this._tiles[X];if(le&&le.active){le.retain=!0;continue}else le&&le.loaded&&(le.retain=!0);v+1<A&&this._retainChildren(I,P,v+1,A)}},_resetView:function(a){var d=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var d=this.options;return d.minNativeZoom!==void 0&&a<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<a?d.maxNativeZoom:a},_setView:function(a,d,v,A){var I=Math.round(d);this.options.maxZoom!==void 0&&I>this.options.maxZoom||this.options.minZoom!==void 0&&I<this.options.minZoom?I=void 0:I=this._clampZoom(I);var P=this.options.updateWhenZooming&&I!==this._tileZoom;(!A||P)&&(this._tileZoom=I,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),I!==void 0&&this._update(a),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(a,d)},_setZoomTransforms:function(a,d){for(var v in this._levels)this._setZoomTransform(this._levels[v],a,d)},_setZoomTransform:function(a,d,v){var A=this._map.getZoomScale(v,a.zoom),I=a.origin.multiplyBy(A).subtract(this._map._getNewPixelOrigin(d,v)).round();Ue.any3d?$i(a.el,I,A):Gt(a.el,I)},_resetGrid:function(){var a=this._map,d=a.options.crs,v=this._tileSize=this.getTileSize(),A=this._tileZoom,I=this._map.getPixelWorldBounds(this._tileZoom);I&&(this._globalTileRange=this._pxBoundsToTileRange(I)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,d.wrapLng[0]],A).x/v.x),Math.ceil(a.project([0,d.wrapLng[1]],A).x/v.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([d.wrapLat[0],0],A).y/v.x),Math.ceil(a.project([d.wrapLat[1],0],A).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var d=this._map,v=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),A=d.getZoomScale(v,this._tileZoom),I=d.project(a,this._tileZoom).floor(),P=d.getSize().divideBy(A*2);return new K(I.subtract(P),I.add(P))},_update:function(a){var d=this._map;if(d){var v=this._clampZoom(d.getZoom());if(a===void 0&&(a=d.getCenter()),this._tileZoom!==void 0){var A=this._getTiledPixelBounds(a),I=this._pxBoundsToTileRange(A),P=I.getCenter(),G=[],X=this.options.keepBuffer,le=new K(I.getBottomLeft().subtract([X,-X]),I.getTopRight().add([X,-X]));if(!(isFinite(I.min.x)&&isFinite(I.min.y)&&isFinite(I.max.x)&&isFinite(I.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ve in this._tiles){var Me=this._tiles[ve].coords;(Me.z!==this._tileZoom||!le.contains(new Se(Me.x,Me.y)))&&(this._tiles[ve].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(a,v);return}for(var He=I.min.y;He<=I.max.y;He++)for(var ct=I.min.x;ct<=I.max.x;ct++){var Ln=new Se(ct,He);if(Ln.z=this._tileZoom,!!this._isValidTile(Ln)){var vn=this._tiles[this._tileCoordsToKey(Ln)];vn?vn.current=!0:G.push(Ln)}}if(G.sort(function(Vt,Ot){return Vt.distanceTo(P)-Ot.distanceTo(P)}),G.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var wi=document.createDocumentFragment();for(ct=0;ct<G.length;ct++)this._addTile(G[ct],wi);this._level.el.appendChild(wi)}}}},_isValidTile:function(a){var d=this._map.options.crs;if(!d.infinite){var v=this._globalTileRange;if(!d.wrapLng&&(a.x<v.min.x||a.x>v.max.x)||!d.wrapLat&&(a.y<v.min.y||a.y>v.max.y))return!1}if(!this.options.bounds)return!0;var A=this._tileCoordsToBounds(a);return ae(this.options.bounds).overlaps(A)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var d=this._map,v=this.getTileSize(),A=a.scaleBy(v),I=A.add(v),P=d.unproject(A,a.z),G=d.unproject(I,a.z);return[P,G]},_tileCoordsToBounds:function(a){var d=this._tileCoordsToNwSe(a),v=new Ce(d[0],d[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var d=a.split(":"),v=new Se(+d[0],+d[1]);return v.z=+d[2],v},_removeTile:function(a){var d=this._tiles[a];d&&(yt(d.el),delete this._tiles[a],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){De(a,"leaflet-tile");var d=this.getTileSize();a.style.width=d.x+"px",a.style.height=d.y+"px",a.onselectstart=S,a.onmousemove=S,Ue.ielt9&&this.options.opacity<1&&Jt(a,this.options.opacity)},_addTile:function(a,d){var v=this._getTilePos(a),A=this._tileCoordsToKey(a),I=this.createTile(this._wrapCoords(a),c(this._tileReady,this,a));this._initTile(I),this.createTile.length<2&&q(c(this._tileReady,this,a,null,I)),Gt(I,v),this._tiles[A]={el:I,coords:a,current:!0},d.appendChild(I),this.fire("tileloadstart",{tile:I,coords:a})},_tileReady:function(a,d,v){d&&this.fire("tileerror",{error:d,tile:v,coords:a});var A=this._tileCoordsToKey(a);v=this._tiles[A],v&&(v.loaded=+new Date,this._map._fadeAnimated?(Jt(v.el,0),j(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),d||(De(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ue.ielt9||!this._map._fadeAnimated?q(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var d=new Se(this._wrapX?E(a.x,this._wrapX):a.x,this._wrapY?E(a.y,this._wrapY):a.y);return d.z=a.z,d},_pxBoundsToTileRange:function(a){var d=this.getTileSize();return new K(a.min.unscaleBy(d).floor(),a.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function gd(a){return new Mr(a)}var go=Mr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,d){this._url=a,d=H(this,d),d.detectRetina&&Ue.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,d){return this._url===a&&d===void 0&&(d=!0),this._url=a,d||this.redraw(),this},createTile:function(a,d){var v=document.createElement("img");return Je(v,"load",c(this._tileOnLoad,this,d,v)),Je(v,"error",c(this._tileOnError,this,d,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(a),v},getTileUrl:function(a){var d={r:Ue.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-a.y;this.options.tms&&(d.y=v),d["-y"]=v}return re(this._url,r(d,this.options))},_tileOnLoad:function(a,d){Ue.ielt9?setTimeout(c(a,this,null,d),0):a(null,d)},_tileOnError:function(a,d,v){var A=this.options.errorTileUrl;A&&d.getAttribute("src")!==A&&(d.src=A),a(v,d)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,d=this.options.maxZoom,v=this.options.zoomReverse,A=this.options.zoomOffset;return v&&(a=d-a),a+A},_getSubdomain:function(a){var d=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var a,d;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(d=this._tiles[a].el,d.onload=S,d.onerror=S,!d.complete)){d.src=pe;var v=this._tiles[a].coords;yt(d),delete this._tiles[a],this.fire("tileabort",{tile:d,coords:v})}},_removeTile:function(a){var d=this._tiles[a];if(d)return d.el.setAttribute("src",pe),Mr.prototype._removeTile.call(this,a)},_tileReady:function(a,d,v){if(!(!this._map||v&&v.getAttribute("src")===pe))return Mr.prototype._tileReady.call(this,a,d,v)}});function Oi(a,d){return new go(a,d)}var qa=go.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,d){this._url=a;var v=r({},this.defaultWmsParams);for(var A in d)A in this.options||(v[A]=d[A]);d=H(this,d);var I=d.detectRetina&&Ue.retina?2:1,P=this.getTileSize();v.width=P.x*I,v.height=P.y*I,this.wmsParams=v},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,go.prototype.onAdd.call(this,a)},getTileUrl:function(a){var d=this._tileCoordsToNwSe(a),v=this._crs,A=de(v.project(d[0]),v.project(d[1])),I=A.min,P=A.max,G=(this._wmsVersion>=1.3&&this._crs===Bo?[I.y,I.x,P.y,P.x]:[I.x,I.y,P.x,P.y]).join(","),X=go.prototype.getTileUrl.call(this,a);return X+Y(this.wmsParams,X,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+G},setParams:function(a,d){return r(this.wmsParams,a),d||this.redraw(),this}});function Ui(a,d){return new qa(a,d)}go.WMS=qa,Oi.wms=Ui;var li=os.extend({options:{padding:.1},initialize:function(a){H(this,a),g(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),De(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,d){var v=this._map.getZoomScale(d,this._zoom),A=this._map.getSize().multiplyBy(.5+this.options.padding),I=this._map.project(this._center,d),P=A.multiplyBy(-v).add(I).subtract(this._map._getNewPixelOrigin(a,d));Ue.any3d?$i(this._container,P,v):Gt(this._container,P)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,d=this._map.getSize(),v=this._map.containerPointToLayerPoint(d.multiplyBy(-a)).round();this._bounds=new K(v,v.add(d.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),kl=li.extend({options:{tolerance:0},getEvents:function(){var a=li.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){li.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");Je(a,"mousemove",this._onMouseMove,this),Je(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Je(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){j(this._redrawRequest),delete this._ctx,yt(this._container),Lt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var d in this._layers)a=this._layers[d],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){li.prototype._update.call(this);var a=this._bounds,d=this._container,v=a.getSize(),A=Ue.retina?2:1;Gt(d,a.min),d.width=A*v.x,d.height=A*v.y,d.style.width=v.x+"px",d.style.height=v.y+"px",Ue.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){li.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[g(a)]=a;var d=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var d=a._order,v=d.next,A=d.prev;v?v.prev=A:this._drawLast=A,A?A.next=v:this._drawFirst=v,delete a._order,delete this._layers[g(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var d=a.options.dashArray.split(/[, ]+/),v=[],A,I;for(I=0;I<d.length;I++){if(A=Number(d[I]),isNaN(A))return;v.push(A)}a.options._dashArray=v}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||q(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var d=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new K,this._redrawBounds.extend(a._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(a._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var d=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,d=this._redrawBounds;if(this._ctx.save(),d){var v=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var A=this._drawFirst;A;A=A.next)a=A.layer,(!d||a._pxBounds&&a._pxBounds.intersects(d))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,d){if(this._drawing){var v,A,I,P,G=a._parts,X=G.length,le=this._ctx;if(X){for(le.beginPath(),v=0;v<X;v++){for(A=0,I=G[v].length;A<I;A++)P=G[v][A],le[A?"lineTo":"moveTo"](P.x,P.y);d&&le.closePath()}this._fillStroke(le,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var d=a._point,v=this._ctx,A=Math.max(Math.round(a._radius),1),I=(Math.max(Math.round(a._radiusY),1)||A)/A;I!==1&&(v.save(),v.scale(1,I)),v.beginPath(),v.arc(d.x,d.y/I,A,0,Math.PI*2,!1),I!==1&&v.restore(),this._fillStroke(v,a)}},_fillStroke:function(a,d){var v=d.options;v.fill&&(a.globalAlpha=v.fillOpacity,a.fillStyle=v.fillColor||v.color,a.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(a.setLineDash&&a.setLineDash(d.options&&d.options._dashArray||[]),a.globalAlpha=v.opacity,a.lineWidth=v.weight,a.strokeStyle=v.color,a.lineCap=v.lineCap,a.lineJoin=v.lineJoin,a.stroke())},_onClick:function(a){for(var d=this._map.mouseEventToLayerPoint(a),v,A,I=this._drawFirst;I;I=I.next)v=I.layer,v.options.interactive&&v._containsPoint(d)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(v))&&(A=v);this._fireEvent(A?[A]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,d)}},_handleMouseOut:function(a){var d=this._hoveredLayer;d&&(Ht(this._container,"leaflet-interactive"),this._fireEvent([d],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,d){if(!this._mouseHoverThrottled){for(var v,A,I=this._drawFirst;I;I=I.next)v=I.layer,v.options.interactive&&v._containsPoint(d)&&(A=v);A!==this._hoveredLayer&&(this._handleMouseOut(a),A&&(De(this._container,"leaflet-interactive"),this._fireEvent([A],a,"mouseover"),this._hoveredLayer=A)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,d,v){this._map._fireDOMEvent(d,v||d.type,a)},_bringToFront:function(a){var d=a._order;if(d){var v=d.next,A=d.prev;if(v)v.prev=A;else return;A?A.next=v:v&&(this._drawFirst=v),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(a)}},_bringToBack:function(a){var d=a._order;if(d){var v=d.next,A=d.prev;if(A)A.next=v;else return;v?v.prev=A:A&&(this._drawLast=A),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(a)}}});function Ha(a){return Ue.canvas?new kl(a):null}var _o=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),qu={_initContainer:function(){this._container=ft("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(li.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var d=a._container=_o("shape");De(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",a._path=_o("path"),d.appendChild(a._path),this._updateStyle(a),this._layers[g(a)]=a},_addPath:function(a){var d=a._container;this._container.appendChild(d),a.options.interactive&&a.addInteractiveTarget(d)},_removePath:function(a){var d=a._container;yt(d),a.removeInteractiveTarget(d),delete this._layers[g(a)]},_updateStyle:function(a){var d=a._stroke,v=a._fill,A=a.options,I=a._container;I.stroked=!!A.stroke,I.filled=!!A.fill,A.stroke?(d||(d=a._stroke=_o("stroke")),I.appendChild(d),d.weight=A.weight+"px",d.color=A.color,d.opacity=A.opacity,A.dashArray?d.dashStyle=ee(A.dashArray)?A.dashArray.join(" "):A.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=A.lineCap.replace("butt","flat"),d.joinstyle=A.lineJoin):d&&(I.removeChild(d),a._stroke=null),A.fill?(v||(v=a._fill=_o("fill")),I.appendChild(v),v.color=A.fillColor||A.color,v.opacity=A.fillOpacity):v&&(I.removeChild(v),a._fill=null)},_updateCircle:function(a){var d=a._point.round(),v=Math.round(a._radius),A=Math.round(a._radiusY||v);this._setPath(a,a._empty()?"M0 0":"AL "+d.x+","+d.y+" "+v+","+A+" 0,"+65535*360)},_setPath:function(a,d){a._path.v=d},_bringToFront:function(a){sn(a._container)},_bringToBack:function(a){vi(a._container)}},As=Ue.vml?_o:Et,Pr=li.extend({_initContainer:function(){this._container=As("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=As("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){yt(this._container),Lt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){li.prototype._update.call(this);var a=this._bounds,d=a.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,v.setAttribute("width",d.x),v.setAttribute("height",d.y)),Gt(v,a.min),v.setAttribute("viewBox",[a.min.x,a.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(a){var d=a._path=As("path");a.options.className&&De(d,a.options.className),a.options.interactive&&De(d,"leaflet-interactive"),this._updateStyle(a),this._layers[g(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){yt(a._path),a.removeInteractiveTarget(a._path),delete this._layers[g(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var d=a._path,v=a.options;d&&(v.stroke?(d.setAttribute("stroke",v.color),d.setAttribute("stroke-opacity",v.opacity),d.setAttribute("stroke-width",v.weight),d.setAttribute("stroke-linecap",v.lineCap),d.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?d.setAttribute("stroke-dasharray",v.dashArray):d.removeAttribute("stroke-dasharray"),v.dashOffset?d.setAttribute("stroke-dashoffset",v.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),v.fill?(d.setAttribute("fill",v.fillColor||v.color),d.setAttribute("fill-opacity",v.fillOpacity),d.setAttribute("fill-rule",v.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(a,d){this._setPath(a,pt(a._parts,d))},_updateCircle:function(a){var d=a._point,v=Math.max(Math.round(a._radius),1),A=Math.max(Math.round(a._radiusY),1)||v,I="a"+v+","+A+" 0 1,0 ",P=a._empty()?"M0 0":"M"+(d.x-v)+","+d.y+I+v*2+",0 "+I+-v*2+",0 ";this._setPath(a,P)},_setPath:function(a,d){a._path.setAttribute("d",d)},_bringToFront:function(a){sn(a._path)},_bringToBack:function(a){vi(a._path)}});Ue.vml&&Pr.include(qu);function Ga(a){return Ue.svg||Ue.vml?new Pr(a):null}ht.include({getRenderer:function(a){var d=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var d=this._paneRenderers[a];return d===void 0&&(d=this._createRenderer({pane:a}),this._paneRenderers[a]=d),d},_createRenderer:function(a){return this.options.preferCanvas&&Ha(a)||Ga(a)}});var Fo=br.extend({initialize:function(a,d){br.prototype.initialize.call(this,this._boundsToLatLngs(a),d)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=ae(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function qf(a,d){return new Fo(a,d)}Pr.create=As,Pr.pointsToPath=pt,Gs.geometryToLayer=jn,Gs.coordsToLatLng=Il,Gs.coordsToLatLngs=Oa,Gs.latLngToCoords=Nl,Gs.latLngsToCoords=Ua,Gs.getFeature=fo,Gs.asFeature=Rl,ht.mergeOptions({boxZoom:!0});var ui=xi.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){Je(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Lt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){yt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ki(),Lo(),this._startPoint=this._map.mouseEventToContainerPoint(a),Je(document,{contextmenu:Xi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=ft("div","leaflet-zoom-box",this._container),De(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var d=new K(this._point,this._startPoint),v=d.getSize();Gt(this._box,d.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(yt(this._box),Ht(this._container,"leaflet-crosshair")),Cn(),ro(),Lt(document,{contextmenu:Xi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var d=new Ce(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ht.addInitHook("addHandler","boxZoom",ui),ht.mergeOptions({doubleClickZoom:!0});var Dl=xi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var d=this._map,v=d.getZoom(),A=d.options.zoomDelta,I=a.originalEvent.shiftKey?v-A:v+A;d.options.doubleClickZoom==="center"?d.setZoom(I):d.setZoomAround(a.containerPoint,I)}});ht.addInitHook("addHandler","doubleClickZoom",Dl),ht.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Cs=xi.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new is(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}De(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ht(this._map._container,"leaflet-grab"),Ht(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=ae(this._map.options.maxBounds);this._offsetLimit=de(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var d=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(d),this._prunePositions(d)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,d){return a-(a-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;a.x<d.min.x&&(a.x=this._viscousLimit(a.x,d.min.x)),a.y<d.min.y&&(a.y=this._viscousLimit(a.y,d.min.y)),a.x>d.max.x&&(a.x=this._viscousLimit(a.x,d.max.x)),a.y>d.max.y&&(a.y=this._viscousLimit(a.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,d=Math.round(a/2),v=this._initialWorldOffset,A=this._draggable._newPos.x,I=(A-d+v)%a+d-v,P=(A+d+v)%a-d-v,G=Math.abs(I+v)<Math.abs(P+v)?I:P;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=G},_onDragEnd:function(a){var d=this._map,v=d.options,A=!v.inertia||a.noInertia||this._times.length<2;if(d.fire("dragend",a),A)d.fire("moveend");else{this._prunePositions(+new Date);var I=this._lastPos.subtract(this._positions[0]),P=(this._lastTime-this._times[0])/1e3,G=v.easeLinearity,X=I.multiplyBy(G/P),le=X.distanceTo([0,0]),ve=Math.min(v.inertiaMaxSpeed,le),Me=X.multiplyBy(ve/le),He=ve/(v.inertiaDeceleration*G),ct=Me.multiplyBy(-He/2).round();!ct.x&&!ct.y?d.fire("moveend"):(ct=d._limitOffset(ct,d.options.maxBounds),q(function(){d.panBy(ct,{duration:He,easeLinearity:G,noMoveStart:!0,animate:!0})}))}}});ht.addInitHook("addHandler","dragging",Cs),ht.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Hu=xi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),Je(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Lt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,d=document.documentElement,v=a.scrollTop||d.scrollTop,A=a.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(A,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var d=this._panKeys={},v=this.keyCodes,A,I;for(A=0,I=v.left.length;A<I;A++)d[v.left[A]]=[-1*a,0];for(A=0,I=v.right.length;A<I;A++)d[v.right[A]]=[a,0];for(A=0,I=v.down.length;A<I;A++)d[v.down[A]]=[0,a];for(A=0,I=v.up.length;A<I;A++)d[v.up[A]]=[0,-1*a]},_setZoomDelta:function(a){var d=this._zoomKeys={},v=this.keyCodes,A,I;for(A=0,I=v.zoomIn.length;A<I;A++)d[v.zoomIn[A]]=a;for(A=0,I=v.zoomOut.length;A<I;A++)d[v.zoomOut[A]]=-a},_addHooks:function(){Je(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Lt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var d=a.keyCode,v=this._map,A;if(d in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(A=this._panKeys[d],a.shiftKey&&(A=Ie(A).multiplyBy(3)),v.options.maxBounds&&(A=v._limitOffset(Ie(A),v.options.maxBounds)),v.options.worldCopyJump){var I=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(A)));v.panTo(I)}else v.panBy(A)}else if(d in this._zoomKeys)v.setZoom(v.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;Xi(a)}}});ht.addInitHook("addHandler","keyboard",Hu),ht.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ja=xi.extend({addHooks:function(){Je(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Lt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var d=bn(a),v=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var A=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),A),Xi(a)},_performZoom:function(){var a=this._map,d=a.getZoom(),v=this._map.options.zoomSnap||0;a._stop();var A=this._delta/(this._map.options.wheelPxPerZoomLevel*4),I=4*Math.log(2/(1+Math.exp(-Math.abs(A))))/Math.LN2,P=v?Math.ceil(I/v)*v:I,G=a._limitZoom(d+(this._delta>0?P:-P))-d;this._delta=0,this._startTime=null,G&&(a.options.scrollWheelZoom==="center"?a.setZoom(d+G):a.setZoomAround(this._lastMousePos,d+G))}});ht.addInitHook("addHandler","scrollWheelZoom",ja);var qo=600;ht.mergeOptions({tapHold:Ue.touchNative&&Ue.safari&&Ue.mobile,tapTolerance:15});var Ll=xi.extend({addHooks:function(){Je(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Lt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var d=a.touches[0];this._startPos=this._newPos=new Se(d.clientX,d.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(Je(document,"touchend",on),Je(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),qo),Je(document,"touchend touchcancel contextmenu",this._cancel,this),Je(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){Lt(document,"touchend",on),Lt(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),Lt(document,"touchend touchcancel contextmenu",this._cancel,this),Lt(document,"touchmove",this._onMove,this)},_onMove:function(a){var d=a.touches[0];this._newPos=new Se(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,d){var v=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});v._simulated=!0,d.target.dispatchEvent(v)}});ht.addInitHook("addHandler","tapHold",Ll),ht.mergeOptions({touchZoom:Ue.touch,bounceAtZoomLimits:!0});var Gu=xi.extend({addHooks:function(){De(this._map._container,"leaflet-touch-zoom"),Je(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ht(this._map._container,"leaflet-touch-zoom"),Lt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var d=this._map;if(!(!a.touches||a.touches.length!==2||d._animatingZoom||this._zooming)){var v=d.mouseEventToContainerPoint(a.touches[0]),A=d.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(v.add(A)._divideBy(2))),this._startDist=v.distanceTo(A),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),Je(document,"touchmove",this._onTouchMove,this),Je(document,"touchend touchcancel",this._onTouchEnd,this),on(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var d=this._map,v=d.mouseEventToContainerPoint(a.touches[0]),A=d.mouseEventToContainerPoint(a.touches[1]),I=v.distanceTo(A)/this._startDist;if(this._zoom=d.getScaleZoom(I,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&I<1||this._zoom>d.getMaxZoom()&&I>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,I===1)return}else{var P=v._add(A)._divideBy(2)._subtract(this._centerPoint);if(I===1&&P.x===0&&P.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(P),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),j(this._animRequest);var G=c(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=q(G,this,!0),on(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,j(this._animRequest),Lt(document,"touchmove",this._onTouchMove,this),Lt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ht.addInitHook("addHandler","touchZoom",Gu),ht.BoxZoom=ui,ht.DoubleClickZoom=Dl,ht.Drag=Cs,ht.Keyboard=Hu,ht.ScrollWheelZoom=ja,ht.TapHold=Ll,ht.TouchZoom=Gu,t.Bounds=K,t.Browser=Ue,t.CRS=Fe,t.Canvas=kl,t.Circle=bl,t.CircleMarker=Cr,t.Class=Le,t.Control=Hn,t.DivIcon=pd,t.DivOverlay=Kn,t.DomEvent=xs,t.DomUtil=lo,t.Draggable=is,t.Evented=Ae,t.FeatureGroup=Es,t.GeoJSON=Gs,t.GridLayer=Mr,t.Handler=xi,t.Icon=ws,t.ImageOverlay=Nr,t.LatLng=fe,t.LatLngBounds=Ce,t.Layer=os,t.LayerGroup=Ar,t.LineUtil=Li,t.Map=ht,t.Marker=Va,t.Mixin=Al,t.Path=Ss,t.Point=Se,t.PolyUtil=ho,t.Polygon=br,t.Polyline=Hs,t.Popup=Ba,t.PosAnimation=Bs,t.Projection=ss,t.Rectangle=Fo,t.Renderer=li,t.SVG=Pr,t.SVGOverlay=Pl,t.TileLayer=go,t.Tooltip=Fa,t.Transformation=mt,t.Util=B,t.VideoOverlay=po,t.bind=c,t.bounds=de,t.canvas=Ha,t.circle=dd,t.circleMarker=cd,t.control=ai,t.divIcon=Ff,t.extend=r,t.featureGroup=ld,t.geoJSON=Ml,t.geoJson=za,t.gridLayer=gd,t.icon=ka,t.imageOverlay=hd,t.latLng=be,t.latLngBounds=ae,t.layerGroup=Of,t.map=co,t.marker=ud,t.point=Ie,t.polygon=zf,t.polyline=Uf,t.popup=md,t.rectangle=qf,t.setOptions=H,t.stamp=g,t.svg=Ga,t.svgOverlay=fd,t.tileLayer=Oi,t.tooltip=Bf,t.transformation=je,t.version=i,t.videoOverlay=Rr;var ju=window.L;t.noConflict=function(){return window.L=ju,this},window.L=t}))})(Nc,Nc.exports)),Nc.exports}var Mu=p5();const pl=Cg(Mu);function df(n,e,t){return Object.freeze({instance:n,context:e,container:t})}function hf(n,e){return e==null?function(i,r){const l=W.useRef(void 0);return l.current||(l.current=n(i,r)),l}:function(i,r){const l=W.useRef(void 0);l.current||(l.current=n(i,r));const c=W.useRef(i),{instance:m}=l.current;return W.useEffect(function(){c.current!==i&&(e(m,i,c.current),c.current=i)},[m,i,e]),l}}function eS(n,e){W.useEffect(function(){return(e.layerContainer??e.map).addLayer(n.instance),function(){var l;(l=e.layerContainer)==null||l.removeLayer(n.instance),e.map.removeLayer(n.instance)}},[e,n])}function tS(n){return function(t){const i=uf(),r=n(cf(t,i),i);return Qw(i.map,t.attribution),Fg(r.current,t.eventHandlers),eS(r.current,i),r}}function g5(n,e){const t=W.useRef(void 0);W.useEffect(function(){if(e.pathOptions!==t.current){const r=e.pathOptions??{};n.instance.setStyle(r),t.current=r}},[n,e])}function _5(n){return function(t){const i=uf(),r=n(cf(t,i),i);return Fg(r.current,t.eventHandlers),eS(r.current,i),g5(r.current,t),r}}function y5(n,e){const t=hf(n,e),i=tS(t);return Xw(i)}function v5(n,e){const t=hf(n),i=f5(t,e);return d5(i)}function T5(n,e){const t=hf(n,e),i=_5(t);return Xw(i)}function x5(n,e){const t=hf(n,e),i=tS(t);return h5(i)}function E5(n,e,t){const{opacity:i,zIndex:r}=e;i!=null&&i!==t.opacity&&n.setOpacity(i),r!=null&&r!==t.zIndex&&n.setZIndex(r)}function ff(){return uf().map}function w5({bounds:n,boundsOptions:e,center:t,children:i,className:r,id:l,placeholder:c,style:m,whenReady:g,zoom:p,...E},S){const[C]=W.useState({className:r,id:l,style:m}),[M,z]=W.useState(null),H=W.useRef(void 0);W.useImperativeHandle(S,()=>(M==null?void 0:M.map)??null,[M]);const Y=W.useCallback(re=>{if(re!==null&&!H.current){const ee=new Mu.Map(re,E);H.current=ee,t!=null&&p!=null?ee.setView(t,p):n!=null&&ee.fitBounds(n,e),g!=null&&ee.whenReady(g),z(c5(ee))}},[]);W.useEffect(()=>()=>{M==null||M.map.remove()},[M]);const te=M?Hc.createElement(Bg,{value:M},i):c??null;return Hc.createElement("div",{...C,ref:Y},te)}const nS=W.forwardRef(w5),qg=y5(function({position:e,...t},i){const r=new Mu.Marker(e,t);return df(r,$w(i,{overlayContainer:r}))},function(e,t,i){t.position!==i.position&&e.setLatLng(t.position),t.icon!=null&&t.icon!==i.icon&&e.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==i.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==i.opacity&&e.setOpacity(t.opacity),e.dragging!=null&&t.draggable!==i.draggable&&(t.draggable===!0?e.dragging.enable():e.dragging.disable())}),S5=T5(function({positions:e,...t},i){const r=new Mu.Polyline(e,t);return df(r,$w(i,{overlayContainer:r}))},function(e,t,i){t.positions!==i.positions&&e.setLatLngs(t.positions)}),Hg=v5(function(e,t){const i=new Mu.Popup(e,t.overlayContainer);return df(i,t)},function(e,t,{position:i},r){W.useEffect(function(){const{instance:c}=e;function m(p){p.popup===c&&(c.update(),r(!0))}function g(p){p.popup===c&&r(!1)}return t.map.on({popupopen:m,popupclose:g}),t.overlayContainer==null?(i!=null&&c.setLatLng(i),c.openOn(t.map)):t.overlayContainer.bindPopup(c),function(){var E;t.map.off({popupopen:m,popupclose:g}),(E=t.overlayContainer)==null||E.unbindPopup(),t.map.removeLayer(c)}},[e,t,r,i])}),iS=x5(function({url:e,...t},i){const r=new Mu.TileLayer(e,cf(t,i));return df(r,i)},function(e,t,i){E5(e,t,i);const{url:r}=t;r!=null&&r!==i.url&&e.setUrl(r)}),A5={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var Ex={};const C5=()=>{try{if(typeof import.meta<"u"&&A5)return"";if(typeof process<"u"&&Ex)return Ex.VITE_API_KEY||""}catch(n){console.warn("Failed to access API key",n)}return""},Ap=C5(),b5="AIzaSyC2SRWVViygm5tBgGQeGgFEq9_jK_PdT_0",I5=n=>{var e,t,i,r;if(typeof n.text=="string")return n.text;if(typeof n.text=="function")return n.text();if(n.candidates&&((r=(i=(t=(e=n.candidates[0])==null?void 0:e.content)==null?void 0:t.parts)==null?void 0:i[0])!=null&&r.text))return n.candidates[0].content.parts[0].text;throw new Error("No text found in AI response")},wx={1:{lat:25.033,lng:121.5654},"taipei 101":{lat:25.033,lng:121.5654},2:{lat:25.0421,lng:121.5082},3:{lat:25.1024,lng:121.5486},test:{lat:25.033,lng:121.5654},kyoto:{lat:35.0116,lng:135.7681},osaka:{lat:34.6937,lng:135.5023},tokyo:{lat:35.6762,lng:139.6503},:{lat:26.2048,lng:127.6458}," () check in":{lat:26.2048,lng:127.6458},:{lat:26.2048,lng:127.6458},"  ":{lat:26.196,lng:127.665},:{lat:26.196,lng:127.665},:{lat:26.196,lng:127.665},:{lat:26.2206,lng:127.6711},:{lat:26.1308,lng:127.7739},:{lat:26.3164,lng:127.7577},:{lat:26.695,lng:128.022},:{lat:26.6942,lng:127.8779},:{lat:26.505,lng:127.8512},:{lat:26.215,lng:127.685},"tokyo tower":{lat:35.6586,lng:139.7454},:{lat:35.6586,lng:139.7454}},Lc=async(n,e)=>{const t=n.toLowerCase().trim();if(wx[t])return console.log(`Using Test Location for: ${n}`),wx[t];const i=async S=>{if(!S)return null;try{const M=await new zw({apiKey:S}).models.generateContent({model:"gemini-2.0-flash",contents:`Convert this address to latitude and longitude coordinates: "${n}". 
                
                IMPORTANT: Return ONLY a JSON object in this exact format:
                {"lat": 25.0330, "lng": 121.5654}
                
                Do not include any explanations, just the JSON object.`,config:{responseMimeType:"application/json"}}),z=I5(M),H=JSON.parse(z);if(H.lat&&H.lng)return{lat:parseFloat(H.lat),lng:parseFloat(H.lng)}}catch(C){return console.warn(`Geocoding failed with key ${S.substring(0,5)}...`,C),null}return null},r=async S=>{if(!S)return null;try{console.log(`Trying Google Maps Geocoding API with key ${S.substring(0,5)}...`);const C=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(n)}&key=${S}`,z=await(await fetch(C)).json();if(z.status==="OK"&&z.results&&z.results.length>0){const H=z.results[0].geometry.location;return{lat:H.lat,lng:H.lng}}else console.warn("Google Maps Geocoding API error:",z.status,z.error_message),window.localStorage.setItem("last_geocode_error",`${z.status}: ${z.error_message||"Unknown error"}`)}catch(C){console.warn("Google Maps Geocoding API request failed:",C),window.localStorage.setItem("last_geocode_error",`Network Error: ${C}`)}return null},l=S=>S.split(/|\/|\|/).map(M=>M.trim()).filter(M=>M).map(M=>M.replace(/\(.*\)|.*/g,"").trim()).filter(M=>M.length>0),c=async(S,C={},M=5e3)=>{const z=new AbortController,H=setTimeout(()=>z.abort(),M);try{const Y=await fetch(S,{...C,signal:z.signal});return clearTimeout(H),Y}catch(Y){throw clearTimeout(H),Y}},m=async S=>{try{console.log(`[Geocoding] Trying Nominatim for: ${S}`);const C=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(S)}&limit=1`,{headers:{"User-Agent":"NomadAI-Travel-Journal/1.0"}});if(!C.ok)return console.warn(`[Geocoding] Nominatim request failed: ${C.status}`),null;const M=await C.json();if(console.log("[Geocoding] Nominatim response:",M),M&&M.length>0){const z=parseFloat(M[0].lat),H=parseFloat(M[0].lon);return console.log("[Geocoding] Nominatim success:",{lat:z,lng:H}),{lat:z,lng:H}}return null}catch(C){return console.error("Nominatim geocoding error:",C),null}},g=async S=>{try{console.log(`Trying Open-Meteo Geocoding for: "${S}"...`);const C=`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(S)}&count=1&language=zh&format=json`,M=await c(C);if(!M.ok)throw new Error(`Open-Meteo status: ${M.status}`);const z=await M.json();if(z&&z.results&&z.results.length>0){const H=z.results[0];return{lat:H.latitude,lng:H.longitude}}}catch(C){console.warn(`Open-Meteo failed for "${S}":`,C)}return null},p=[n,...l(n)],E=Array.from(new Set(p));console.log("Geocoding candidates:",E);for(const S of E){if(e){let z=await i(e);if(z||(z=await r(e),z))return z}if(Ap){let z=await i(Ap);if(z||(z=await r(Ap),z))return z}{const z=await i(b5);if(z)return z}const C=await m(S);if(C)return C;const M=await g(S);if(M)return M}return null},N5=Object.freeze(Object.defineProperty({__proto__:null,geocodeAddress:Lc},Symbol.toStringTag,{value:"Module"})),sS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",oS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";let R5=pl.icon({iconUrl:sS,shadowUrl:oS,iconSize:[25,41],iconAnchor:[12,41]});pl.Marker.prototype.options.icon=R5;const M5=({bounds:n,isMapReady:e})=>{const t=ff();return W.useEffect(()=>{e&&n&&n.length>0&&setTimeout(()=>{t.fitBounds(n,{padding:[80,80]})},100)},[n,t,e]),null},P5=({onReady:n})=>{const e=ff();return W.useEffect(()=>{const t=setTimeout(()=>{e.invalidateSize(),n()},250);return()=>clearTimeout(t)},[e,n]),null},k5=({selectedLocation:n,searchedLocation:e,isMapReady:t})=>{const i=ff();return W.useEffect(()=>{t&&(e?i.flyTo([e.lat,e.lng],16,{animate:!0,duration:1.5}):n&&i.flyTo([n.lat,n.lng],16,{animate:!0,duration:1.5}))},[n,e,i,t]),null},D5=({item:n,index:e,isSelected:t,color:i,onClick:r})=>{var g,p;const l=Hc.useRef(null);W.useEffect(()=>{t&&l.current&&l.current.openPopup()},[t]);const c=((g=n.coordinates)==null?void 0:g.lat)||n.lat,m=((p=n.coordinates)==null?void 0:p.lng)||n.lng;return!c||!m?null:T.jsx(qg,{ref:l,position:[c,m],icon:pl.divIcon({className:"custom-div-icon",html:`<div style="background-color: ${t?"#C5A059":i}; width: ${t?"32px":"24px"}; height: ${t?"32px":"24px"}; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: ${t?"14px":"12px"}; transition: all 0.3s ease;">${e+1}</div>`,iconSize:[t?32:24,t?32:24],iconAnchor:[t?16:12,t?16:12]}),eventHandlers:{click:r},children:T.jsx(Hg,{children:T.jsxs("div",{className:"text-center",children:[T.jsxs("div",{className:"font-bold text-ink",children:[e+1,". ",n.activity]}),T.jsx("div",{className:"text-xs text-gray-500",children:n.time}),T.jsxs("div",{className:"text-xs text-coral mt-1",children:["Day ",n.day]})]})})})},L5=({trip:n,settings:e,onUpdateTrip:t,searchedLocation:i,onItemClick:r,mapSearchQuery:l})=>{Xt[e.language]||Xt["zh-TW"];const[c,m]=W.useState(null),[g,p]=W.useState(new Set),[E,S]=W.useState("ALL"),[C,M]=W.useState(null),[z,H]=W.useState(!1),Y=W.useMemo(()=>{const J=n.itinerary||[];return E==="ALL"?J:J.filter(k=>k.day===E)},[n.itinerary,E]),te=W.useMemo(()=>{const J={};return(n.itinerary||[]).forEach(k=>{J[k.day]||(J[k.day]=[]),J[k.day].push(k)}),Object.keys(J).forEach(k=>{J[Number(k)].sort((U,V)=>U.time.localeCompare(V.time))}),J},[n.itinerary]),re=W.useMemo(()=>Object.keys(te).map(Number).sort((J,k)=>J-k),[te]),ee=["#FF5733","#33FF57","#3357FF","#FF33F5","#33FFF5","#F5FF33"],ge=W.useMemo(()=>{const J=Y.filter(k=>k.coordinates||k.lat&&k.lng).map(k=>{var U,V;return[((U=k.coordinates)==null?void 0:U.lat)||k.lat,((V=k.coordinates)==null?void 0:V.lng)||k.lng]});return J.length===0?null:J},[Y]),pe=W.useMemo(()=>{var k,U,V;if(!C)return null;const J=(k=n.itinerary)==null?void 0:k.find(F=>F.id===C);return J&&(J.coordinates||J.lat&&J.lng)?{lat:((U=J.coordinates)==null?void 0:U.lat)||J.lat,lng:((V=J.coordinates)==null?void 0:V.lng)||J.lng}:null},[C,n.itinerary]);return W.useEffect(()=>{if(n.itinerary&&n.itinerary.length>0){const J=Array.from(new Set(n.itinerary.map(k=>Number(k.day)))).sort((k,U)=>k-U);if(J.length>0){const k=J[0],U=n.itinerary.filter(V=>V.day===k).sort((V,F)=>V.time.localeCompare(F.time));if(U.length>0){const V=U[0];if(M(V.id),S(k),r){const F=V.location||V.activity;F&&setTimeout(()=>r(F),500)}}}}},[n.id]),W.useEffect(()=>{window.localStorage.removeItem("last_geocode_error")},[n.id]),T.jsxs("div",{className:"h-full flex flex-col pb-24",children:[T.jsxs("div",{className:"mb-4 flex gap-2 overflow-x-auto no-scrollbar py-1 shrink-0",children:[T.jsx("button",{onClick:()=>{S("ALL"),M(null)},className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${E==="ALL"?"bg-ink text-white":"bg-white text-gray-500 border border-sand"}`,children:"ALL"}),re.map(J=>T.jsxs("button",{onClick:()=>{S(J),M(null)},className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${E===J?"bg-coral text-white":"bg-white text-gray-500 border border-sand"}`,children:["Day ",J]},J))]}),T.jsx("div",{className:"h-[35vh] shrink-0 bg-gray-100 rounded-3xl overflow-hidden shadow-inner border border-sand relative z-0 mb-4",children:T.jsxs(nS,{center:[25.033,121.5654],zoom:13,style:{height:"100%",width:"100%"},children:[T.jsx(iS,{attribution:' <a href="https://www.google.com/maps">Google Maps</a>',url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"}),T.jsx(P5,{onReady:()=>H(!0)}),ge&&!pe&&!i&&T.jsx(M5,{bounds:ge,isMapReady:z}),T.jsx(k5,{selectedLocation:pe,searchedLocation:i,isMapReady:z}),i&&(()=>{const J=Y.findIndex(F=>{var q,j;return((q=F.coordinates)==null?void 0:q.lat)===i.lat&&((j=F.coordinates)==null?void 0:j.lng)===i.lng||F.location===l||F.activity===l}),k=J!==-1?Y[J]:null;if(k&&k.coordinates)return null;const U=J!==-1?J+1:"?",V=k?ee[(k.day-1)%ee.length]:"#FF0000";return T.jsx(qg,{position:[i.lat,i.lng],icon:pl.divIcon({className:"custom-div-icon",html:`<div style="background-color: ${V}; width: 32px; height: 32px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 16px;">${U}</div>`,iconSize:[32,32],iconAnchor:[16,16]}),children:T.jsx(Hg,{children:T.jsx("div",{className:"text-center font-bold",children:"Searched Location"})})})})(),Y.map((J,k)=>T.jsx(D5,{item:J,index:k,isSelected:C===J.id,color:ee[(J.day-1)%ee.length],onClick:()=>M(J.id)},J.id||k)),re.map((J,k)=>{if(E!=="ALL"&&E!==J)return null;const V=te[J].filter(F=>{var q,j;return(((q=F.coordinates)==null?void 0:q.lat)||F.lat)&&(((j=F.coordinates)==null?void 0:j.lng)||F.lng)}).map(F=>{var q,j;return[((q=F.coordinates)==null?void 0:q.lat)||F.lat,((j=F.coordinates)==null?void 0:j.lng)||F.lng]});return V.length<2?null:T.jsx(S5,{positions:V,color:ee[k%ee.length],weight:4,opacity:.7,dashArray:"10, 10"},J)})]})}),T.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-3 px-1",children:Y.map((J,k)=>{var q,j;const U=(((q=J.coordinates)==null?void 0:q.lat)||J.lat)&&(((j=J.coordinates)==null?void 0:j.lng)||J.lng),V=c===J.id||c==="BATCH"&&!U,F=g.has(J.id);return T.jsxs("div",{onClick:async()=>{if(M(J.id),S(J.day),r){const B=J.location||J.activity;B&&r(B)}if(!U&&!c){if(m(J.id),g.has(J.id)){const B=new Set(g);B.delete(J.id),p(B)}console.log(`[TripMap] Starting geocode for item: ${J.activity}`);try{let B=J.location,Le=null;if(B&&(console.log(`[TripMap] Trying location: ${B}`),Le=await Lc(B,e.apiKey)),Le||(console.log(`[TripMap] Location failed or empty, trying activity: ${J.activity}`),Le=await Lc(J.activity,e.apiKey)),!Le){const et=J.activity.split(/[\(]/)[0].split(/|\/|\|/)[0].trim();et&&et!==J.activity&&(console.log(`[TripMap] Activity failed, trying simplified: ${et}`),Le=await Lc(et,e.apiKey))}if(console.log("[TripMap] Final geocode result:",Le),Le&&t){const et=[...n.itinerary||[]],ne=et.findIndex(Ae=>Ae.id===J.id);ne!==-1&&(console.log(`[TripMap] Updating item ${ne} with coords`,Le),et[ne]={...et[ne],coordinates:Le,lat:Le.lat,lng:Le.lng},t({...n,itinerary:et}),console.log("[TripMap] onUpdateTrip called"))}else console.warn(`[TripMap] No coords found for item ${J.id}`),p(et=>new Set(et).add(J.id))}catch(B){console.error("On-demand geocoding failed",B),p(Le=>new Set(Le).add(J.id))}finally{m(null)}}},className:`p-4 rounded-2xl border transition-all cursor-pointer flex items-center gap-4 ${C===J.id?"bg-coral/10 border-coral shadow-md":"bg-white border-sand hover:border-coral/50"}`,children:[T.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold shrink-0 relative",style:{backgroundColor:ee[(J.day-1)%ee.length]},children:V&&!U?T.jsx("div",{className:"absolute inset-0 border-2 border-white border-t-transparent rounded-full animate-spin"}):k+1}),T.jsxs("div",{className:"flex-1 min-w-0",children:[T.jsxs("div",{className:"flex justify-between items-start",children:[T.jsx("h3",{className:"font-bold text-ink truncate",children:J.activity}),T.jsxs("span",{className:"text-xs font-bold text-coral bg-coral/10 px-2 py-0.5 rounded-full whitespace-nowrap",children:["Day ",J.day]})]}),T.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[T.jsx("span",{className:"font-mono bg-gray-100 px-1.5 py-0.5 rounded",children:J.time}),T.jsxs("span",{className:"truncate flex-1",children:[J.location,V&&!U&&T.jsx("span",{className:"text-coral ml-1 text-[10px] animate-pulse",children:"..."}),F&&!U&&!V&&!(i&&(J.location===l||J.activity===l))&&T.jsx("span",{className:"text-red-500 ml-1 text-[10px]",children:""})]})]})]})]},J.id||k)})})]})},V5=()=>{};var Sx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},O5=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const l=n[t++];e[i++]=String.fromCharCode((r&31)<<6|l&63)}else if(r>239&&r<365){const l=n[t++],c=n[t++],m=n[t++],g=((r&7)<<18|(l&63)<<12|(c&63)<<6|m&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const l=n[t++],c=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(l&63)<<6|c&63)}}return e.join("")},aS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const l=n[r],c=r+1<n.length,m=c?n[r+1]:0,g=r+2<n.length,p=g?n[r+2]:0,E=l>>2,S=(l&3)<<4|m>>4;let C=(m&15)<<2|p>>6,M=p&63;g||(M=64,c||(C=64)),i.push(t[E],t[S],t[C],t[M])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(rS(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):O5(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const l=t[n.charAt(r++)],m=r<n.length?t[n.charAt(r)]:0;++r;const p=r<n.length?t[n.charAt(r)]:64;++r;const S=r<n.length?t[n.charAt(r)]:64;if(++r,l==null||m==null||p==null||S==null)throw new U5;const C=l<<2|m>>4;if(i.push(C),p!==64){const M=m<<4&240|p>>2;if(i.push(M),S!==64){const z=p<<6&192|S;i.push(z)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class U5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const z5=function(n){const e=rS(n);return aS.encodeByteArray(e,!0)},Oh=function(n){return z5(n).replace(/\./g,"")},lS=function(n){try{return aS.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F5=()=>B5().__FIREBASE_DEFAULTS__,q5=()=>{if(typeof process>"u"||typeof Sx>"u")return;const n=Sx.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},H5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&lS(n[1]);return e&&JSON.parse(e)},mf=()=>{try{return V5()||F5()||q5()||H5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},uS=n=>{var e,t;return(t=(e=mf())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},G5=n=>{const e=uS(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},cS=()=>{var n;return(n=mf())==null?void 0:n.config},dS=n=>{var e;return(e=mf())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hS(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K5(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Oh(JSON.stringify(t)),Oh(JSON.stringify(c)),""].join(".")}const Vc={};function Z5(){const n={prod:[],emulator:[]};for(const e of Object.keys(Vc))Vc[e]?n.emulator.push(e):n.prod.push(e);return n}function Y5(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Ax=!1;function fS(n,e){if(typeof window>"u"||typeof document>"u"||!Pu(window.location.host)||Vc[n]===e||Vc[n]||Ax)return;Vc[n]=e;function t(C){return`__firebase__banner__${C}`}const i="__firebase__banner",l=Z5().prod.length>0;function c(){const C=document.getElementById(i);C&&C.remove()}function m(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function g(C,M){C.setAttribute("width","24"),C.setAttribute("id",M),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function p(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{Ax=!0,c()},C}function E(C,M){C.setAttribute("id",M),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function S(){const C=Y5(i),M=t("text"),z=document.getElementById(M)||document.createElement("span"),H=t("learnmore"),Y=document.getElementById(H)||document.createElement("a"),te=t("preprendIcon"),re=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const ee=C.element;m(ee),E(Y,H);const ge=p();g(re,te),ee.append(re,z,Y,ge),document.body.appendChild(ee)}l?(z.innerText="Preview backend disconnected.",re.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(re.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,z.innerText="Preview backend running in this workspace."),z.setAttribute("id",M)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",S):S()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function W5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gi())}function J5(){var e;const n=(e=mf())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Q5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $5(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function X5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ek(){const n=gi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function tk(){return!J5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nk(){try{return typeof indexedDB=="object"}catch{return!1}}function ik(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var l;e(((l=r.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sk="FirebaseError";class mr extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=sk,Object.setPrototypeOf(this,mr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qc.prototype.create)}}class Qc{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,l=this.errors[e],c=l?ok(l,i):"Error",m=`${this.serviceName}: ${c} (${r}).`;return new mr(r,m,i)}}function ok(n,e){return n.replace(rk,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const rk=/\{\$([^}]+)}/g;function ak(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ar(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const l=n[r],c=e[r];if(Cx(l)&&Cx(c)){if(!ar(l,c))return!1}else if(l!==c)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function Cx(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $c(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function lk(n,e){const t=new uk(n,e);return t.subscribe.bind(t)}class uk{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");ck(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=Cp),r.error===void 0&&(r.error=Cp),r.complete===void 0&&(r.complete=Cp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ck(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Cp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wn(n){return n&&n._delegate?n._delegate:n}class cl{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const il="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new j5;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fk(e))try{this.getOrInitializeService({instanceIdentifier:il})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:r});i.resolve(l)}catch{}}}}clearInstance(e=il){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=il){return this.instances.has(e)}getOptions(e=il){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,c]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(l);i===m&&c.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const l=this.instances.get(i);return l&&e(l,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:hk(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=il){return this.component?this.component.multipleInstances?e:il:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function hk(n){return n===il?void 0:n}function fk(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new dk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ct||(Ct={}));const pk={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},gk=Ct.INFO,_k={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},yk=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=_k[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gg{constructor(e){this.name=e,this._logLevel=gk,this._logHandler=yk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const vk=(n,e)=>e.some(t=>n instanceof t);let bx,Ix;function Tk(){return bx||(bx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xk(){return Ix||(Ix=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mS=new WeakMap,Jp=new WeakMap,pS=new WeakMap,bp=new WeakMap,jg=new WeakMap;function Ek(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",l),n.removeEventListener("error",c)},l=()=>{t(oa(n.result)),r()},c=()=>{i(n.error),r()};n.addEventListener("success",l),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&mS.set(t,n)}).catch(()=>{}),jg.set(e,n),e}function wk(n){if(Jp.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",c),n.removeEventListener("abort",c)},l=()=>{t(),r()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",l),n.addEventListener("error",c),n.addEventListener("abort",c)});Jp.set(n,e)}let Qp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Jp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||pS.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return oa(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Sk(n){Qp=n(Qp)}function Ak(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Ip(this),e,...t);return pS.set(i,e.sort?e.sort():[e]),oa(i)}:xk().includes(n)?function(...e){return n.apply(Ip(this),e),oa(mS.get(this))}:function(...e){return oa(n.apply(Ip(this),e))}}function Ck(n){return typeof n=="function"?Ak(n):(n instanceof IDBTransaction&&wk(n),vk(n,Tk())?new Proxy(n,Qp):n)}function oa(n){if(n instanceof IDBRequest)return Ek(n);if(bp.has(n))return bp.get(n);const e=Ck(n);return e!==n&&(bp.set(n,e),jg.set(e,n)),e}const Ip=n=>jg.get(n);function bk(n,e,{blocked:t,upgrade:i,blocking:r,terminated:l}={}){const c=indexedDB.open(n,e),m=oa(c);return i&&c.addEventListener("upgradeneeded",g=>{i(oa(c.result),g.oldVersion,g.newVersion,oa(c.transaction),g)}),t&&c.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),m.then(g=>{l&&g.addEventListener("close",()=>l()),r&&g.addEventListener("versionchange",p=>r(p.oldVersion,p.newVersion,p))}).catch(()=>{}),m}const Ik=["get","getKey","getAll","getAllKeys","count"],Nk=["put","add","delete","clear"],Np=new Map;function Nx(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Np.get(e))return Np.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=Nk.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Ik.includes(t)))return;const l=async function(c,...m){const g=this.transaction(c,r?"readwrite":"readonly");let p=g.store;return i&&(p=p.index(m.shift())),(await Promise.all([p[t](...m),r&&g.done]))[0]};return Np.set(e,l),l}Sk(n=>({...n,get:(e,t,i)=>Nx(e,t)||n.get(e,t,i),has:(e,t)=>!!Nx(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Mk(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Mk(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $p="@firebase/app",Rx="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lr=new Gg("@firebase/app"),Pk="@firebase/app-compat",kk="@firebase/analytics-compat",Dk="@firebase/analytics",Lk="@firebase/app-check-compat",Vk="@firebase/app-check",Ok="@firebase/auth",Uk="@firebase/auth-compat",zk="@firebase/database",Bk="@firebase/data-connect",Fk="@firebase/database-compat",qk="@firebase/functions",Hk="@firebase/functions-compat",Gk="@firebase/installations",jk="@firebase/installations-compat",Kk="@firebase/messaging",Zk="@firebase/messaging-compat",Yk="@firebase/performance",Wk="@firebase/performance-compat",Jk="@firebase/remote-config",Qk="@firebase/remote-config-compat",$k="@firebase/storage",Xk="@firebase/storage-compat",eD="@firebase/firestore",tD="@firebase/ai",nD="@firebase/firestore-compat",iD="firebase",sD="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp="[DEFAULT]",oD={[$p]:"fire-core",[Pk]:"fire-core-compat",[Dk]:"fire-analytics",[kk]:"fire-analytics-compat",[Vk]:"fire-app-check",[Lk]:"fire-app-check-compat",[Ok]:"fire-auth",[Uk]:"fire-auth-compat",[zk]:"fire-rtdb",[Bk]:"fire-data-connect",[Fk]:"fire-rtdb-compat",[qk]:"fire-fn",[Hk]:"fire-fn-compat",[Gk]:"fire-iid",[jk]:"fire-iid-compat",[Kk]:"fire-fcm",[Zk]:"fire-fcm-compat",[Yk]:"fire-perf",[Wk]:"fire-perf-compat",[Jk]:"fire-rc",[Qk]:"fire-rc-compat",[$k]:"fire-gcs",[Xk]:"fire-gcs-compat",[eD]:"fire-fst",[nD]:"fire-fst-compat",[tD]:"fire-vertex","fire-js":"fire-js",[iD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh=new Map,rD=new Map,eg=new Map;function Mx(n,e){try{n.container.addComponent(e)}catch(t){lr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function yu(n){const e=n.name;if(eg.has(e))return lr.debug(`There were multiple attempts to register component ${e}.`),!1;eg.set(e,n);for(const t of Uh.values())Mx(t,n);for(const t of rD.values())Mx(t,n);return!0}function Kg(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ws(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ra=new Qc("app","Firebase",aD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new cl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ra.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ku=sD;function gS(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Xp,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw ra.create("bad-app-name",{appName:String(r)});if(t||(t=cS()),!t)throw ra.create("no-options");const l=Uh.get(r);if(l){if(ar(t,l.options)&&ar(i,l.config))return l;throw ra.create("duplicate-app",{appName:r})}const c=new mk(r);for(const g of eg.values())c.addComponent(g);const m=new lD(t,i,c);return Uh.set(r,m),m}function _S(n=Xp){const e=Uh.get(n);if(!e&&n===Xp&&cS())return gS();if(!e)throw ra.create("no-app",{appName:n});return e}function aa(n,e,t){let i=oD[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),l=e.match(/\s|\//);if(r||l){const c=[`Unable to register library "${i}" with version "${e}":`];r&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),lr.warn(c.join(" "));return}yu(new cl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uD="firebase-heartbeat-database",cD=1,Gc="firebase-heartbeat-store";let Rp=null;function yS(){return Rp||(Rp=bk(uD,cD,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Gc)}catch(t){console.warn(t)}}}}).catch(n=>{throw ra.create("idb-open",{originalErrorMessage:n.message})})),Rp}async function dD(n){try{const t=(await yS()).transaction(Gc),i=await t.objectStore(Gc).get(vS(n));return await t.done,i}catch(e){if(e instanceof mr)lr.warn(e.message);else{const t=ra.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});lr.warn(t.message)}}}async function Px(n,e){try{const i=(await yS()).transaction(Gc,"readwrite");await i.objectStore(Gc).put(e,vS(n)),await i.done}catch(t){if(t instanceof mr)lr.warn(t.message);else{const i=ra.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});lr.warn(i.message)}}}function vS(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hD=1024,fD=30;class mD{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new gD(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=kx();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:r}),this._heartbeatsCache.heartbeats.length>fD){const c=_D(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){lr.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=kx(),{heartbeatsToSend:i,unsentEntries:r}=pD(this._heartbeatsCache.heartbeats),l=Oh(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return lr.warn(t),""}}}function kx(){return new Date().toISOString().substring(0,10)}function pD(n,e=hD){const t=[];let i=n.slice();for(const r of n){const l=t.find(c=>c.agent===r.agent);if(l){if(l.dates.push(r.date),Dx(t)>e){l.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Dx(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class gD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nk()?ik().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await dD(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Px(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Px(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Dx(n){return Oh(JSON.stringify({version:2,heartbeats:n})).length}function _D(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yD(n){yu(new cl("platform-logger",e=>new Rk(e),"PRIVATE")),yu(new cl("heartbeat",e=>new mD(e),"PRIVATE")),aa($p,Rx,n),aa($p,Rx,"esm2020"),aa("fire-js","")}yD("");var vD="firebase",TD="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */aa(vD,TD,"app");function TS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xD=TS,xS=new Qc("auth","Firebase",TS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh=new Gg("@firebase/auth");function ED(n,...e){zh.logLevel<=Ct.WARN&&zh.warn(`Auth (${ku}): ${n}`,...e)}function Eh(n,...e){zh.logLevel<=Ct.ERROR&&zh.error(`Auth (${ku}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(n,...e){throw Yg(n,...e)}function Qs(n,...e){return Yg(n,...e)}function Zg(n,e,t){const i={...xD(),[e]:t};return new Qc("auth","Firebase",i).create(e,{appName:n.name})}function al(n){return Zg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wD(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&No(n,"argument-error"),Zg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Yg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return xS.create(n,...e)}function nt(n,e,...t){if(!n)throw Yg(e,...t)}function sr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Eh(e),new Error(e)}function ur(n,e){n||sr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tg(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function SD(){return Lx()==="http:"||Lx()==="https:"}function Lx(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(SD()||$5()||"connection"in navigator)?navigator.onLine:!0}function CD(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,t){this.shortDelay=e,this.longDelay=t,ur(t>e,"Short delay should be less than long delay!"),this.isMobile=W5()||X5()}get(){return AD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(n,e){ur(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;sr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;sr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;sr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ND=new Xc(3e4,6e4);function Jg(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Du(n,e,t,i,r={}){return wS(n,r,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const m=$c({key:n.config.apiKey,...c}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:g,...l};return Q5()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Pu(n.emulatorConfig.host)&&(p.credentials="include"),ES.fetch()(await SS(n,n.config.apiHost,t,m),p)})}async function wS(n,e,t){n._canInitEmulator=!1;const i={...bD,...e};try{const r=new MD(n),l=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw fh(n,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const m=l.ok?c.errorMessage:c.error.message,[g,p]=m.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw fh(n,"credential-already-in-use",c);if(g==="EMAIL_EXISTS")throw fh(n,"email-already-in-use",c);if(g==="USER_DISABLED")throw fh(n,"user-disabled",c);const E=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Zg(n,E,p);No(n,E)}}catch(r){if(r instanceof mr)throw r;No(n,"network-request-failed",{message:String(r)})}}async function RD(n,e,t,i,r={}){const l=await Du(n,e,t,i,r);return"mfaPendingCredential"in l&&No(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function SS(n,e,t,i){const r=`${e}${t}?${i}`,l=n,c=l.config.emulator?Wg(n.config,r):`${n.config.apiScheme}://${r}`;return ID.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}class MD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Qs(this.auth,"network-request-failed")),ND.get())})}}function fh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Qs(n,e,i);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PD(n,e){return Du(n,"POST","/v1/accounts:delete",e)}async function Bh(n,e){return Du(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function kD(n,e=!1){const t=Wn(n),i=await t.getIdToken(e),r=Qg(i);nt(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const l=typeof r.firebase=="object"?r.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:r,token:i,authTime:Oc(Mp(r.auth_time)),issuedAtTime:Oc(Mp(r.iat)),expirationTime:Oc(Mp(r.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Mp(n){return Number(n)*1e3}function Qg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Eh("JWT malformed, contained fewer than 3 sections"),null;try{const r=lS(t);return r?JSON.parse(r):(Eh("Failed to decode base64 JWT payload"),null)}catch(r){return Eh("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function Vx(n){const e=Qg(n);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jc(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof mr&&DD(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function DD({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Oc(this.lastLoginAt),this.creationTime=Oc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fh(n){var S;const e=n.auth,t=await n.getIdToken(),i=await jc(n,Bh(e,{idToken:t}));nt(i==null?void 0:i.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const l=(S=r.providerUserInfo)!=null&&S.length?AS(r.providerUserInfo):[],c=OD(n.providerData,l),m=n.isAnonymous,g=!(n.email&&r.passwordHash)&&!(c!=null&&c.length),p=m?g:!1,E={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:c,metadata:new ng(r.createdAt,r.lastLoginAt),isAnonymous:p};Object.assign(n,E)}async function VD(n){const e=Wn(n);await Fh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function OD(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function AS(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UD(n,e){const t=await wS(n,{},async()=>{const i=$c({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:l}=n.config,c=await SS(n,r,"/v1/token",`key=${l}`),m=await n._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:m,body:i};return n.emulatorConfig&&Pu(n.emulatorConfig.host)&&(g.credentials="include"),ES.fetch()(c,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function zD(n,e){return Du(n,"POST","/v2/accounts:revokeToken",Jg(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Vx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const t=Vx(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:l}=await UD(e,t);this.updateTokensAndExpiration(i,r,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:l}=t,c=new hu;return i&&(nt(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),r&&(nt(typeof r=="string","internal-error",{appName:e}),c.accessToken=r),l&&(nt(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new hu,this.toJSON())}_performRefresh(){return sr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(n,e){nt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Js{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new LD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new ng(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await jc(this,this.stsTokenManager.getToken(this.auth,e));return nt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return kD(this,e)}reload(){return VD(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Js({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Fh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ws(this.auth.app))return Promise.reject(al(this.auth));const e=await this.getIdToken();return await jc(this,PD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,l=t.phoneNumber??void 0,c=t.photoURL??void 0,m=t.tenantId??void 0,g=t._redirectEventId??void 0,p=t.createdAt??void 0,E=t.lastLoginAt??void 0,{uid:S,emailVerified:C,isAnonymous:M,providerData:z,stsTokenManager:H}=t;nt(S&&H,e,"internal-error");const Y=hu.fromJSON(this.name,H);nt(typeof S=="string",e,"internal-error"),$r(i,e.name),$r(r,e.name),nt(typeof C=="boolean",e,"internal-error"),nt(typeof M=="boolean",e,"internal-error"),$r(l,e.name),$r(c,e.name),$r(m,e.name),$r(g,e.name),$r(p,e.name),$r(E,e.name);const te=new Js({uid:S,auth:e,email:r,emailVerified:C,displayName:i,isAnonymous:M,photoURL:c,phoneNumber:l,tenantId:m,stsTokenManager:Y,createdAt:p,lastLoginAt:E});return z&&Array.isArray(z)&&(te.providerData=z.map(re=>({...re}))),g&&(te._redirectEventId=g),te}static async _fromIdTokenResponse(e,t,i=!1){const r=new hu;r.updateFromServerResponse(t);const l=new Js({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Fh(l),l}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];nt(r.localId!==void 0,"internal-error");const l=r.providerUserInfo!==void 0?AS(r.providerUserInfo):[],c=!(r.email&&r.passwordHash)&&!(l!=null&&l.length),m=new hu;m.updateFromIdToken(i);const g=new Js({uid:r.localId,auth:e,stsTokenManager:m,isAnonymous:c}),p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:l,metadata:new ng(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(l!=null&&l.length)};return Object.assign(g,p),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox=new Map;function or(n){ur(n instanceof Function,"Expected a class definition");let e=Ox.get(n);return e?(ur(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Ox.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}CS.type="NONE";const Ux=CS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(n,e,t){return`firebase:${n}:${e}:${t}`}class fu{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:l}=this.auth;this.fullUserKey=wh(this.userKey,r.apiKey,l),this.fullPersistenceKey=wh("persistence",r.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Bh(this.auth,{idToken:e}).catch(()=>{});return t?Js._fromGetAccountInfoResponse(this.auth,t,e):null}return Js._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new fu(or(Ux),e,i);const r=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let l=r[0]||or(Ux);const c=wh(i,e.config.apiKey,e.name);let m=null;for(const p of t)try{const E=await p._get(c);if(E){let S;if(typeof E=="string"){const C=await Bh(e,{idToken:E}).catch(()=>{});if(!C)break;S=await Js._fromGetAccountInfoResponse(e,C,E)}else S=Js._fromJSON(e,E);p!==l&&(m=S),l=p;break}}catch{}const g=r.filter(p=>p._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new fu(l,e,i):(l=g[0],m&&await l._set(c,m.toJSON()),await Promise.all(t.map(async p=>{if(p!==l)try{await p._remove(c)}catch{}})),new fu(l,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zx(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(PS(e))return"Blackberry";if(kS(e))return"Webos";if(IS(e))return"Safari";if((e.includes("chrome/")||NS(e))&&!e.includes("edge/"))return"Chrome";if(MS(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function bS(n=gi()){return/firefox\//i.test(n)}function IS(n=gi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function NS(n=gi()){return/crios\//i.test(n)}function RS(n=gi()){return/iemobile/i.test(n)}function MS(n=gi()){return/android/i.test(n)}function PS(n=gi()){return/blackberry/i.test(n)}function kS(n=gi()){return/webos/i.test(n)}function $g(n=gi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function BD(n=gi()){var e;return $g(n)&&!!((e=window.navigator)!=null&&e.standalone)}function FD(){return ek()&&document.documentMode===10}function DS(n=gi()){return $g(n)||MS(n)||kS(n)||PS(n)||/windows phone/i.test(n)||RS(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(n,e=[]){let t;switch(n){case"Browser":t=zx(gi());break;case"Worker":t=`${zx(gi())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ku}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((c,m)=>{try{const g=e(l);c(g)}catch(g){m(g)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HD(n,e={}){return Du(n,"GET","/v2/passwordPolicy",Jg(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GD=6;class jD{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??GD,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Bx(this),this.idTokenSubscription=new Bx(this),this.beforeStateQueue=new qD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=or(t)),this._initializationPromise=this.queue(async()=>{var i,r,l;if(!this._deleted&&(this.persistenceManager=await fu.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Bh(this,{idToken:e}),i=await Js._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(Ws(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(m=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(m,m))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(l=this.redirectUser)==null?void 0:l._redirectEventId,m=i==null?void 0:i._redirectEventId,g=await this.tryRedirectSignIn(e);(!c||c===m)&&(g!=null&&g.user)&&(i=g.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Fh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=CD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ws(this.app))return Promise.reject(al(this));const t=e?Wn(e):null;return t&&nt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ws(this.app)?Promise.reject(al(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ws(this.app)?Promise.reject(al(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(or(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await HD(this),t=new jD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qc("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await zD(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&or(e)||this._popupRedirectResolver;nt(t,this,"argument-error"),this.redirectPersistenceManager=await fu.create(this,[or(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(m,this,"internal-error"),m.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,r);return()=>{c=!0,g()}}else{const g=e.addObserver(t);return()=>{c=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=LS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(Ws(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&ED(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function pf(n){return Wn(n)}class Bx{constructor(e){this.auth=e,this.observer=null,this.addObserver=lk(t=>this.observer=t)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ZD(n){Xg=n}function YD(n){return Xg.loadJS(n)}function WD(){return Xg.gapiScript}function JD(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QD(n,e){const t=Kg(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),l=t.getOptions();if(ar(l,e??{}))return r;No(r,"already-initialized")}return t.initialize({options:e})}function $D(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(or);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function XD(n,e,t){const i=pf(n);nt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,l=VS(e),{host:c,port:m}=eL(e),g=m===null?"":`:${m}`,p={url:`${l}//${c}${g}/`},E=Object.freeze({host:c,port:m,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){nt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),nt(ar(p,i.config.emulator)&&ar(E,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=E,i.settings.appVerificationDisabledForTesting=!0,Pu(c)?(hS(`${l}//${c}${g}`),fS("Auth",!0)):tL()}function VS(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function eL(n){const e=VS(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const l=r[1];return{host:l,port:Fx(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:Fx(c)}}}function Fx(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function tL(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return sr("not implemented")}_getIdTokenResponse(e){return sr("not implemented")}_linkToIdToken(e,t){return sr("not implemented")}_getReauthenticationResolver(e){return sr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mu(n,e){return RD(n,"POST","/v1/accounts:signInWithIdp",Jg(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nL="http://localhost";class dl extends OS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new dl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):No("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...l}=t;if(!i||!r)return null;const c=new dl(i,r);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return mu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,mu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mu(e,t)}buildRequest(){const e={requestUri:nL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=$c(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed extends e_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends ed{constructor(){super("facebook.com")}static credential(e){return dl._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xr.credentialFromTaggedObject(e)}static credentialFromError(e){return Xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xr.credential(e.oauthAccessToken)}catch{return null}}}Xr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Xr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir extends ed{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return dl._fromParams({providerId:ir.PROVIDER_ID,signInMethod:ir.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ir.credentialFromTaggedObject(e)}static credentialFromError(e){return ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ir.credential(t,i)}catch{return null}}}ir.GOOGLE_SIGN_IN_METHOD="google.com";ir.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea extends ed{constructor(){super("github.com")}static credential(e){return dl._fromParams({providerId:ea.PROVIDER_ID,signInMethod:ea.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ea.credentialFromTaggedObject(e)}static credentialFromError(e){return ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ea.credential(e.oauthAccessToken)}catch{return null}}}ea.GITHUB_SIGN_IN_METHOD="github.com";ea.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta extends ed{constructor(){super("twitter.com")}static credential(e,t){return dl._fromParams({providerId:ta.PROVIDER_ID,signInMethod:ta.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ta.credentialFromTaggedObject(e)}static credentialFromError(e){return ta.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return ta.credential(t,i)}catch{return null}}}ta.TWITTER_SIGN_IN_METHOD="twitter.com";ta.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const l=await Js._fromIdTokenResponse(e,i,r),c=qx(i);return new vu({user:l,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=qx(i);return new vu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function qx(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh extends mr{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,qh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new qh(e,t,i,r)}}function US(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?qh._fromErrorAndOperation(n,l,e,i):l})}async function iL(n,e,t=!1){const i=await jc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return vu._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sL(n,e,t=!1){const{auth:i}=n;if(Ws(i.app))return Promise.reject(al(i));const r="reauthenticate";try{const l=await jc(n,US(i,r,e,n),t);nt(l.idToken,i,"internal-error");const c=Qg(l.idToken);nt(c,i,"internal-error");const{sub:m}=c;return nt(n.uid===m,i,"user-mismatch"),vu._forOperation(n,r,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&No(i,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oL(n,e,t=!1){if(Ws(n.app))return Promise.reject(al(n));const i="signIn",r=await US(n,i,e),l=await vu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(l.user),l}function rL(n,e,t,i){return Wn(n).onIdTokenChanged(e,t,i)}function aL(n,e,t){return Wn(n).beforeAuthStateChanged(e,t)}function lL(n,e,t,i){return Wn(n).onAuthStateChanged(e,t,i)}function uL(n){return Wn(n).signOut()}const Hh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Hh,"1"),this.storage.removeItem(Hh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cL=1e3,dL=10;class BS extends zS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=DS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,m,g)=>{this.notifyListeners(c,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);FD()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,dL):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},cL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}BS.type="LOCAL";const hL=BS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS extends zS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}FS.type="SESSION";const qS=FS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fL(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new gf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:l}=t.data,c=this.handlersMap[r];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const m=Array.from(c).map(async p=>p(t.origin,l)),g=await fL(m);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}gf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let l,c;return new Promise((m,g)=>{const p=t_("",20);r.port1.start();const E=setTimeout(()=>{g(new Error("unsupported_event"))},i);c={messageChannel:r,onMessage(S){const C=S;if(C.data.eventId===p)switch(C.data.status){case"ack":clearTimeout(E),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),m(C.data.response);break;default:clearTimeout(E),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(c),r.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[r.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(){return window}function pL(n){So().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HS(){return typeof So().WorkerGlobalScope<"u"&&typeof So().importScripts=="function"}async function gL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _L(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function yL(){return HS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="firebaseLocalStorageDb",vL=1,Gh="firebaseLocalStorage",jS="fbase_key";class td{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function _f(n,e){return n.transaction([Gh],e?"readwrite":"readonly").objectStore(Gh)}function TL(){const n=indexedDB.deleteDatabase(GS);return new td(n).toPromise()}function ig(){const n=indexedDB.open(GS,vL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Gh,{keyPath:jS})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Gh)?e(i):(i.close(),await TL(),e(await ig()))})})}async function Hx(n,e,t){const i=_f(n,!0).put({[jS]:e,value:t});return new td(i).toPromise()}async function xL(n,e){const t=_f(n,!1).get(e),i=await new td(t).toPromise();return i===void 0?null:i.value}function Gx(n,e){const t=_f(n,!0).delete(e);return new td(t).toPromise()}const EL=800,wL=3;class KS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ig(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>wL)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return HS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=gf._getInstance(yL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await gL(),!this.activeServiceWorker)return;this.sender=new mL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_L()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ig();return await Hx(e,Hh,"1"),await Gx(e,Hh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>Hx(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>xL(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Gx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const l=_f(r,!1).getAll();return new td(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:l}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(l)&&(this.notifyListeners(r,l),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),EL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}KS.type="LOCAL";const SL=KS;new Xc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZS(n,e){return e?or(e):(nt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_ extends OS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return mu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return mu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function AL(n){return oL(n.auth,new n_(n),n.bypassAuthState)}function CL(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),sL(t,new n_(n),n.bypassAuthState)}async function bL(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),iL(t,new n_(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,t,i,r,l=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:l,error:c,type:m}=e;if(c){this.reject(c);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(g))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return AL;case"linkViaPopup":case"linkViaRedirect":return bL;case"reauthViaPopup":case"reauthViaRedirect":return CL;default:No(this.auth,"internal-error")}}resolve(e){ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL=new Xc(2e3,1e4);async function NL(n,e,t){if(Ws(n.app))return Promise.reject(Qs(n,"operation-not-supported-in-this-environment"));const i=pf(n);wD(n,e,e_);const r=ZS(i,t);return new ol(i,"signInViaPopup",e,r).executeNotNull()}class ol extends YS{constructor(e,t,i,r,l){super(e,t,r,l),this.provider=i,this.authWindow=null,this.pollId=null,ol.currentPopupAction&&ol.currentPopupAction.cancel(),ol.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){ur(this.filter.length===1,"Popup operations only handle one event");const e=t_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Qs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Qs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ol.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,IL.get())};e()}}ol.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL="pendingRedirect",Sh=new Map;class ML extends YS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Sh.get(this.auth._key());if(!e){try{const i=await PL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Sh.set(this.auth._key(),e)}return this.bypassAuthState||Sh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function PL(n,e){const t=LL(e),i=DL(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function kL(n,e){Sh.set(n._key(),e)}function DL(n){return or(n._redirectPersistence)}function LL(n){return wh(RL,n.config.apiKey,n.name)}async function VL(n,e,t=!1){if(Ws(n.app))return Promise.reject(al(n));const i=pf(n),r=ZS(i,e),c=await new ML(i,r,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OL=600*1e3;class UL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!zL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!WS(e)){const r=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Qs(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=OL&&this.cachedEventUids.clear(),this.cachedEventUids.has(jx(e))}saveEventToCache(e){this.cachedEventUids.add(jx(e)),this.lastProcessedEventTime=Date.now()}}function jx(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function WS({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function zL(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return WS(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BL(n,e={}){return Du(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,qL=/^https?/;async function HL(n){if(n.config.emulator)return;const{authorizedDomains:e}=await BL(n);for(const t of e)try{if(GL(t))return}catch{}No(n,"unauthorized-domain")}function GL(n){const e=tg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!qL.test(t))return!1;if(FL.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL=new Xc(3e4,6e4);function Kx(){const n=So().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function KL(n){return new Promise((e,t)=>{var r,l,c;function i(){Kx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Kx(),t(Qs(n,"network-request-failed"))},timeout:jL.get()})}if((l=(r=So().gapi)==null?void 0:r.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((c=So().gapi)!=null&&c.load)i();else{const m=JD("iframefcb");return So()[m]=()=>{gapi.load?i():t(Qs(n,"network-request-failed"))},YD(`${WD()}?onload=${m}`).catch(g=>t(g))}}).catch(e=>{throw Ah=null,e})}let Ah=null;function ZL(n){return Ah=Ah||KL(n),Ah}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YL=new Xc(5e3,15e3),WL="__/auth/iframe",JL="emulator/auth/iframe",QL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$L=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function XL(n){const e=n.config;nt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Wg(e,JL):`https://${n.config.authDomain}/${WL}`,i={apiKey:e.apiKey,appName:n.name,v:ku},r=$L.get(n.config.apiHost);r&&(i.eid=r);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${$c(i).slice(1)}`}async function e3(n){const e=await ZL(n),t=So().gapi;return nt(t,n,"internal-error"),e.open({where:document.body,url:XL(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:QL,dontclear:!0},i=>new Promise(async(r,l)=>{await i.restyle({setHideOnLeave:!1});const c=Qs(n,"network-request-failed"),m=So().setTimeout(()=>{l(c)},YL.get());function g(){So().clearTimeout(m),r(i)}i.ping(g).then(g,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},n3=500,i3=600,s3="_blank",o3="http://localhost";class Zx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function r3(n,e,t,i=n3,r=i3){const l=Math.max((window.screen.availHeight-r)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let m="";const g={...t3,width:i.toString(),height:r.toString(),top:l,left:c},p=gi().toLowerCase();t&&(m=NS(p)?s3:t),bS(p)&&(e=e||o3,g.scrollbars="yes");const E=Object.entries(g).reduce((C,[M,z])=>`${C}${M}=${z},`,"");if(BD(p)&&m!=="_self")return a3(e||"",m),new Zx(null);const S=window.open(e||"",m,E);nt(S,n,"popup-blocked");try{S.focus()}catch{}return new Zx(S)}function a3(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l3="__/auth/handler",u3="emulator/auth/handler",c3=encodeURIComponent("fac");async function Yx(n,e,t,i,r,l){nt(n.config.authDomain,n,"auth-domain-config-required"),nt(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:ku,eventId:r};if(e instanceof e_){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",ak(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[E,S]of Object.entries({}))c[E]=S}if(e instanceof ed){const E=e.getScopes().filter(S=>S!=="");E.length>0&&(c.scopes=E.join(","))}n.tenantId&&(c.tid=n.tenantId);const m=c;for(const E of Object.keys(m))m[E]===void 0&&delete m[E];const g=await n._getAppCheckToken(),p=g?`#${c3}=${encodeURIComponent(g)}`:"";return`${d3(n)}?${$c(m).slice(1)}${p}`}function d3({config:n}){return n.emulator?Wg(n,u3):`https://${n.authDomain}/${l3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pp="webStorageSupport";class h3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qS,this._completeRedirectFn=VL,this._overrideRedirectResult=kL}async _openPopup(e,t,i,r){var c;ur((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const l=await Yx(e,t,i,tg(),r);return r3(e,l,t_())}async _openRedirect(e,t,i,r){await this._originValidation(e);const l=await Yx(e,t,i,tg(),r);return pL(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:l}=this.eventManagers[t];return r?Promise.resolve(r):(ur(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await e3(e),i=new UL(e);return t.register("authEvent",r=>(nt(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Pp,{type:Pp},r=>{var c;const l=(c=r==null?void 0:r[0])==null?void 0:c[Pp];l!==void 0&&t(!!l),No(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=HL(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return DS()||IS()||$g()}}const f3=h3;var Wx="@firebase/auth",Jx="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p3(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function g3(n){yu(new cl("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:m}=i.options;nt(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:c,authDomain:m,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:LS(n)},p=new KD(i,r,l,g);return $D(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),yu(new cl("auth-internal",e=>{const t=pf(e.getProvider("auth").getImmediate());return(i=>new m3(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),aa(Wx,Jx,p3(n)),aa(Wx,Jx,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _3=300,y3=dS("authIdTokenMaxAge")||_3;let Qx=null;const v3=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>y3)return;const r=t==null?void 0:t.token;Qx!==r&&(Qx=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function T3(n=_S()){const e=Kg(n,"auth");if(e.isInitialized())return e.getImmediate();const t=QD(n,{popupRedirectResolver:f3,persistence:[SL,hL,qS]}),i=dS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=v3(l.toString());aL(t,c,()=>c(t.currentUser)),rL(t,m=>c(m))}}const r=uS("auth");return r&&XD(t,`http://${r}`),t}function x3(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}ZD({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const l=Qs("internal-error");l.customData=r,t(l)},i.type="text/javascript",i.charset="UTF-8",x3().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});g3("Browser");var $x=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var la,JS;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,U){function V(){}V.prototype=U.prototype,k.F=U.prototype,k.prototype=new V,k.prototype.constructor=k,k.D=function(F,q,j){for(var B=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)B[Le-2]=arguments[Le];return U.prototype[q].apply(F,B)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,U,V){V||(V=0);const F=Array(16);if(typeof U=="string")for(var q=0;q<16;++q)F[q]=U.charCodeAt(V++)|U.charCodeAt(V++)<<8|U.charCodeAt(V++)<<16|U.charCodeAt(V++)<<24;else for(q=0;q<16;++q)F[q]=U[V++]|U[V++]<<8|U[V++]<<16|U[V++]<<24;U=k.g[0],V=k.g[1],q=k.g[2];let j=k.g[3],B;B=U+(j^V&(q^j))+F[0]+3614090360&4294967295,U=V+(B<<7&4294967295|B>>>25),B=j+(q^U&(V^q))+F[1]+3905402710&4294967295,j=U+(B<<12&4294967295|B>>>20),B=q+(V^j&(U^V))+F[2]+606105819&4294967295,q=j+(B<<17&4294967295|B>>>15),B=V+(U^q&(j^U))+F[3]+3250441966&4294967295,V=q+(B<<22&4294967295|B>>>10),B=U+(j^V&(q^j))+F[4]+4118548399&4294967295,U=V+(B<<7&4294967295|B>>>25),B=j+(q^U&(V^q))+F[5]+1200080426&4294967295,j=U+(B<<12&4294967295|B>>>20),B=q+(V^j&(U^V))+F[6]+2821735955&4294967295,q=j+(B<<17&4294967295|B>>>15),B=V+(U^q&(j^U))+F[7]+4249261313&4294967295,V=q+(B<<22&4294967295|B>>>10),B=U+(j^V&(q^j))+F[8]+1770035416&4294967295,U=V+(B<<7&4294967295|B>>>25),B=j+(q^U&(V^q))+F[9]+2336552879&4294967295,j=U+(B<<12&4294967295|B>>>20),B=q+(V^j&(U^V))+F[10]+4294925233&4294967295,q=j+(B<<17&4294967295|B>>>15),B=V+(U^q&(j^U))+F[11]+2304563134&4294967295,V=q+(B<<22&4294967295|B>>>10),B=U+(j^V&(q^j))+F[12]+1804603682&4294967295,U=V+(B<<7&4294967295|B>>>25),B=j+(q^U&(V^q))+F[13]+4254626195&4294967295,j=U+(B<<12&4294967295|B>>>20),B=q+(V^j&(U^V))+F[14]+2792965006&4294967295,q=j+(B<<17&4294967295|B>>>15),B=V+(U^q&(j^U))+F[15]+1236535329&4294967295,V=q+(B<<22&4294967295|B>>>10),B=U+(q^j&(V^q))+F[1]+4129170786&4294967295,U=V+(B<<5&4294967295|B>>>27),B=j+(V^q&(U^V))+F[6]+3225465664&4294967295,j=U+(B<<9&4294967295|B>>>23),B=q+(U^V&(j^U))+F[11]+643717713&4294967295,q=j+(B<<14&4294967295|B>>>18),B=V+(j^U&(q^j))+F[0]+3921069994&4294967295,V=q+(B<<20&4294967295|B>>>12),B=U+(q^j&(V^q))+F[5]+3593408605&4294967295,U=V+(B<<5&4294967295|B>>>27),B=j+(V^q&(U^V))+F[10]+38016083&4294967295,j=U+(B<<9&4294967295|B>>>23),B=q+(U^V&(j^U))+F[15]+3634488961&4294967295,q=j+(B<<14&4294967295|B>>>18),B=V+(j^U&(q^j))+F[4]+3889429448&4294967295,V=q+(B<<20&4294967295|B>>>12),B=U+(q^j&(V^q))+F[9]+568446438&4294967295,U=V+(B<<5&4294967295|B>>>27),B=j+(V^q&(U^V))+F[14]+3275163606&4294967295,j=U+(B<<9&4294967295|B>>>23),B=q+(U^V&(j^U))+F[3]+4107603335&4294967295,q=j+(B<<14&4294967295|B>>>18),B=V+(j^U&(q^j))+F[8]+1163531501&4294967295,V=q+(B<<20&4294967295|B>>>12),B=U+(q^j&(V^q))+F[13]+2850285829&4294967295,U=V+(B<<5&4294967295|B>>>27),B=j+(V^q&(U^V))+F[2]+4243563512&4294967295,j=U+(B<<9&4294967295|B>>>23),B=q+(U^V&(j^U))+F[7]+1735328473&4294967295,q=j+(B<<14&4294967295|B>>>18),B=V+(j^U&(q^j))+F[12]+2368359562&4294967295,V=q+(B<<20&4294967295|B>>>12),B=U+(V^q^j)+F[5]+4294588738&4294967295,U=V+(B<<4&4294967295|B>>>28),B=j+(U^V^q)+F[8]+2272392833&4294967295,j=U+(B<<11&4294967295|B>>>21),B=q+(j^U^V)+F[11]+1839030562&4294967295,q=j+(B<<16&4294967295|B>>>16),B=V+(q^j^U)+F[14]+4259657740&4294967295,V=q+(B<<23&4294967295|B>>>9),B=U+(V^q^j)+F[1]+2763975236&4294967295,U=V+(B<<4&4294967295|B>>>28),B=j+(U^V^q)+F[4]+1272893353&4294967295,j=U+(B<<11&4294967295|B>>>21),B=q+(j^U^V)+F[7]+4139469664&4294967295,q=j+(B<<16&4294967295|B>>>16),B=V+(q^j^U)+F[10]+3200236656&4294967295,V=q+(B<<23&4294967295|B>>>9),B=U+(V^q^j)+F[13]+681279174&4294967295,U=V+(B<<4&4294967295|B>>>28),B=j+(U^V^q)+F[0]+3936430074&4294967295,j=U+(B<<11&4294967295|B>>>21),B=q+(j^U^V)+F[3]+3572445317&4294967295,q=j+(B<<16&4294967295|B>>>16),B=V+(q^j^U)+F[6]+76029189&4294967295,V=q+(B<<23&4294967295|B>>>9),B=U+(V^q^j)+F[9]+3654602809&4294967295,U=V+(B<<4&4294967295|B>>>28),B=j+(U^V^q)+F[12]+3873151461&4294967295,j=U+(B<<11&4294967295|B>>>21),B=q+(j^U^V)+F[15]+530742520&4294967295,q=j+(B<<16&4294967295|B>>>16),B=V+(q^j^U)+F[2]+3299628645&4294967295,V=q+(B<<23&4294967295|B>>>9),B=U+(q^(V|~j))+F[0]+4096336452&4294967295,U=V+(B<<6&4294967295|B>>>26),B=j+(V^(U|~q))+F[7]+1126891415&4294967295,j=U+(B<<10&4294967295|B>>>22),B=q+(U^(j|~V))+F[14]+2878612391&4294967295,q=j+(B<<15&4294967295|B>>>17),B=V+(j^(q|~U))+F[5]+4237533241&4294967295,V=q+(B<<21&4294967295|B>>>11),B=U+(q^(V|~j))+F[12]+1700485571&4294967295,U=V+(B<<6&4294967295|B>>>26),B=j+(V^(U|~q))+F[3]+2399980690&4294967295,j=U+(B<<10&4294967295|B>>>22),B=q+(U^(j|~V))+F[10]+4293915773&4294967295,q=j+(B<<15&4294967295|B>>>17),B=V+(j^(q|~U))+F[1]+2240044497&4294967295,V=q+(B<<21&4294967295|B>>>11),B=U+(q^(V|~j))+F[8]+1873313359&4294967295,U=V+(B<<6&4294967295|B>>>26),B=j+(V^(U|~q))+F[15]+4264355552&4294967295,j=U+(B<<10&4294967295|B>>>22),B=q+(U^(j|~V))+F[6]+2734768916&4294967295,q=j+(B<<15&4294967295|B>>>17),B=V+(j^(q|~U))+F[13]+1309151649&4294967295,V=q+(B<<21&4294967295|B>>>11),B=U+(q^(V|~j))+F[4]+4149444226&4294967295,U=V+(B<<6&4294967295|B>>>26),B=j+(V^(U|~q))+F[11]+3174756917&4294967295,j=U+(B<<10&4294967295|B>>>22),B=q+(U^(j|~V))+F[2]+718787259&4294967295,q=j+(B<<15&4294967295|B>>>17),B=V+(j^(q|~U))+F[9]+3951481745&4294967295,k.g[0]=k.g[0]+U&4294967295,k.g[1]=k.g[1]+(q+(B<<21&4294967295|B>>>11))&4294967295,k.g[2]=k.g[2]+q&4294967295,k.g[3]=k.g[3]+j&4294967295}i.prototype.v=function(k,U){U===void 0&&(U=k.length);const V=U-this.blockSize,F=this.C;let q=this.h,j=0;for(;j<U;){if(q==0)for(;j<=V;)r(this,k,j),j+=this.blockSize;if(typeof k=="string"){for(;j<U;)if(F[q++]=k.charCodeAt(j++),q==this.blockSize){r(this,F),q=0;break}}else for(;j<U;)if(F[q++]=k[j++],q==this.blockSize){r(this,F),q=0;break}}this.h=q,this.o+=U},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var U=1;U<k.length-8;++U)k[U]=0;U=this.o*8;for(var V=k.length-8;V<k.length;++V)k[V]=U&255,U/=256;for(this.v(k),k=Array(16),U=0,V=0;V<4;++V)for(let F=0;F<32;F+=8)k[U++]=this.g[V]>>>F&255;return k};function l(k,U){var V=m;return Object.prototype.hasOwnProperty.call(V,k)?V[k]:V[k]=U(k)}function c(k,U){this.h=U;const V=[];let F=!0;for(let q=k.length-1;q>=0;q--){const j=k[q]|0;F&&j==U||(V[q]=j,F=!1)}this.g=V}var m={};function g(k){return-128<=k&&k<128?l(k,function(U){return new c([U|0],U<0?-1:0)}):new c([k|0],k<0?-1:0)}function p(k){if(isNaN(k)||!isFinite(k))return S;if(k<0)return Y(p(-k));const U=[];let V=1;for(let F=0;k>=V;F++)U[F]=k/V|0,V*=4294967296;return new c(U,0)}function E(k,U){if(k.length==0)throw Error("number format error: empty string");if(U=U||10,U<2||36<U)throw Error("radix out of range: "+U);if(k.charAt(0)=="-")return Y(E(k.substring(1),U));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const V=p(Math.pow(U,8));let F=S;for(let j=0;j<k.length;j+=8){var q=Math.min(8,k.length-j);const B=parseInt(k.substring(j,j+q),U);q<8?(q=p(Math.pow(U,q)),F=F.j(q).add(p(B))):(F=F.j(V),F=F.add(p(B)))}return F}var S=g(0),C=g(1),M=g(16777216);n=c.prototype,n.m=function(){if(H(this))return-Y(this).m();let k=0,U=1;for(let V=0;V<this.g.length;V++){const F=this.i(V);k+=(F>=0?F:4294967296+F)*U,U*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(z(this))return"0";if(H(this))return"-"+Y(this).toString(k);const U=p(Math.pow(k,6));var V=this;let F="";for(;;){const q=ge(V,U).g;V=te(V,q.j(U));let j=((V.g.length>0?V.g[0]:V.h)>>>0).toString(k);if(V=q,z(V))return j+F;for(;j.length<6;)j="0"+j;F=j+F}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function z(k){if(k.h!=0)return!1;for(let U=0;U<k.g.length;U++)if(k.g[U]!=0)return!1;return!0}function H(k){return k.h==-1}n.l=function(k){return k=te(this,k),H(k)?-1:z(k)?0:1};function Y(k){const U=k.g.length,V=[];for(let F=0;F<U;F++)V[F]=~k.g[F];return new c(V,~k.h).add(C)}n.abs=function(){return H(this)?Y(this):this},n.add=function(k){const U=Math.max(this.g.length,k.g.length),V=[];let F=0;for(let q=0;q<=U;q++){let j=F+(this.i(q)&65535)+(k.i(q)&65535),B=(j>>>16)+(this.i(q)>>>16)+(k.i(q)>>>16);F=B>>>16,j&=65535,B&=65535,V[q]=B<<16|j}return new c(V,V[V.length-1]&-2147483648?-1:0)};function te(k,U){return k.add(Y(U))}n.j=function(k){if(z(this)||z(k))return S;if(H(this))return H(k)?Y(this).j(Y(k)):Y(Y(this).j(k));if(H(k))return Y(this.j(Y(k)));if(this.l(M)<0&&k.l(M)<0)return p(this.m()*k.m());const U=this.g.length+k.g.length,V=[];for(var F=0;F<2*U;F++)V[F]=0;for(F=0;F<this.g.length;F++)for(let q=0;q<k.g.length;q++){const j=this.i(F)>>>16,B=this.i(F)&65535,Le=k.i(q)>>>16,et=k.i(q)&65535;V[2*F+2*q]+=B*et,re(V,2*F+2*q),V[2*F+2*q+1]+=j*et,re(V,2*F+2*q+1),V[2*F+2*q+1]+=B*Le,re(V,2*F+2*q+1),V[2*F+2*q+2]+=j*Le,re(V,2*F+2*q+2)}for(k=0;k<U;k++)V[k]=V[2*k+1]<<16|V[2*k];for(k=U;k<2*U;k++)V[k]=0;return new c(V,0)};function re(k,U){for(;(k[U]&65535)!=k[U];)k[U+1]+=k[U]>>>16,k[U]&=65535,U++}function ee(k,U){this.g=k,this.h=U}function ge(k,U){if(z(U))throw Error("division by zero");if(z(k))return new ee(S,S);if(H(k))return U=ge(Y(k),U),new ee(Y(U.g),Y(U.h));if(H(U))return U=ge(k,Y(U)),new ee(Y(U.g),U.h);if(k.g.length>30){if(H(k)||H(U))throw Error("slowDivide_ only works with positive integers.");for(var V=C,F=U;F.l(k)<=0;)V=pe(V),F=pe(F);var q=J(V,1),j=J(F,1);for(F=J(F,2),V=J(V,2);!z(F);){var B=j.add(F);B.l(k)<=0&&(q=q.add(V),j=B),F=J(F,1),V=J(V,1)}return U=te(k,q.j(U)),new ee(q,U)}for(q=S;k.l(U)>=0;){for(V=Math.max(1,Math.floor(k.m()/U.m())),F=Math.ceil(Math.log(V)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),j=p(V),B=j.j(U);H(B)||B.l(k)>0;)V-=F,j=p(V),B=j.j(U);z(j)&&(j=C),q=q.add(j),k=te(k,B)}return new ee(q,k)}n.B=function(k){return ge(this,k).h},n.and=function(k){const U=Math.max(this.g.length,k.g.length),V=[];for(let F=0;F<U;F++)V[F]=this.i(F)&k.i(F);return new c(V,this.h&k.h)},n.or=function(k){const U=Math.max(this.g.length,k.g.length),V=[];for(let F=0;F<U;F++)V[F]=this.i(F)|k.i(F);return new c(V,this.h|k.h)},n.xor=function(k){const U=Math.max(this.g.length,k.g.length),V=[];for(let F=0;F<U;F++)V[F]=this.i(F)^k.i(F);return new c(V,this.h^k.h)};function pe(k){const U=k.g.length+1,V=[];for(let F=0;F<U;F++)V[F]=k.i(F)<<1|k.i(F-1)>>>31;return new c(V,k.h)}function J(k,U){const V=U>>5;U%=32;const F=k.g.length-V,q=[];for(let j=0;j<F;j++)q[j]=U>0?k.i(j+V)>>>U|k.i(j+V+1)<<32-U:k.i(j+V);return new c(q,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,JS=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=E,la=c}).apply(typeof $x<"u"?$x:typeof self<"u"?self:typeof window<"u"?window:{});var mh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var QS,Rc,$S,Ch,sg,XS,e1,t1;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof mh=="object"&&mh];for(var b=0;b<y.length;++b){var R=y[b];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var i=t(this);function r(y,b){if(b)e:{var R=i;y=y.split(".");for(var O=0;O<y.length-1;O++){var ie=y[O];if(!(ie in R))break e;R=R[ie]}y=y[y.length-1],O=R[y],b=b(O),b!=O&&b!=null&&e(R,y,{configurable:!0,writable:!0,value:b})}}r("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(y){return y||function(b){var R=[],O;for(O in b)Object.prototype.hasOwnProperty.call(b,O)&&R.push([O,b[O]]);return R}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function m(y){var b=typeof y;return b=="object"&&y!=null||b=="function"}function g(y,b,R){return y.call.apply(y.bind,arguments)}function p(y,b,R){return p=g,p.apply(null,arguments)}function E(y,b){var R=Array.prototype.slice.call(arguments,1);return function(){var O=R.slice();return O.push.apply(O,arguments),y.apply(this,O)}}function S(y,b){function R(){}R.prototype=b.prototype,y.Z=b.prototype,y.prototype=new R,y.prototype.constructor=y,y.Ob=function(O,ie,ce){for(var Ne=Array(arguments.length-2),tt=2;tt<arguments.length;tt++)Ne[tt-2]=arguments[tt];return b.prototype[ie].apply(O,Ne)}}var C=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function M(y){const b=y.length;if(b>0){const R=Array(b);for(let O=0;O<b;O++)R[O]=y[O];return R}return[]}function z(y,b){for(let O=1;O<arguments.length;O++){const ie=arguments[O];var R=typeof ie;if(R=R!="object"?R:ie?Array.isArray(ie)?"array":R:"null",R=="array"||R=="object"&&typeof ie.length=="number"){R=y.length||0;const ce=ie.length||0;y.length=R+ce;for(let Ne=0;Ne<ce;Ne++)y[R+Ne]=ie[Ne]}else y.push(ie)}}class H{constructor(b,R){this.i=b,this.j=R,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function Y(y){c.setTimeout(()=>{throw y},0)}function te(){var y=k;let b=null;return y.g&&(b=y.g,y.g=y.g.next,y.g||(y.h=null),b.next=null),b}class re{constructor(){this.h=this.g=null}add(b,R){const O=ee.get();O.set(b,R),this.h?this.h.next=O:this.g=O,this.h=O}}var ee=new H(()=>new ge,y=>y.reset());class ge{constructor(){this.next=this.g=this.h=null}set(b,R){this.h=b,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let pe,J=!1,k=new re,U=()=>{const y=Promise.resolve(void 0);pe=()=>{y.then(V)}};function V(){for(var y;y=te();){try{y.h.call(y.g)}catch(R){Y(R)}var b=ee;b.j(y),b.h<100&&(b.h++,y.next=b.g,b.g=y)}J=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(y,b){this.type=y,this.g=this.target=b,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var y=!1,b=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const R=()=>{};c.addEventListener("test",R,b),c.removeEventListener("test",R,b)}catch{}return y})();function B(y){return/^[\s\xa0]*$/.test(y)}function Le(y,b){q.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,b)}S(Le,q),Le.prototype.init=function(y,b){const R=this.type=y.type,O=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=b,b=y.relatedTarget,b||(R=="mouseover"?b=y.fromElement:R=="mouseout"&&(b=y.toElement)),this.relatedTarget=b,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&Le.Z.h.call(this)},Le.prototype.h=function(){Le.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var et="closure_listenable_"+(Math.random()*1e6|0),ne=0;function Ae(y,b,R,O,ie){this.listener=y,this.proxy=null,this.src=b,this.type=R,this.capture=!!O,this.ha=ie,this.key=++ne,this.da=this.fa=!1}function Se(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function Ye(y,b,R){for(const O in y)b.call(R,y[O],O,y)}function Ie(y,b){for(const R in y)b.call(void 0,y[R],R,y)}function K(y){const b={};for(const R in y)b[R]=y[R];return b}const de="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ce(y,b){let R,O;for(let ie=1;ie<arguments.length;ie++){O=arguments[ie];for(R in O)y[R]=O[R];for(let ce=0;ce<de.length;ce++)R=de[ce],Object.prototype.hasOwnProperty.call(O,R)&&(y[R]=O[R])}}function ae(y){this.src=y,this.g={},this.h=0}ae.prototype.add=function(y,b,R,O,ie){const ce=y.toString();y=this.g[ce],y||(y=this.g[ce]=[],this.h++);const Ne=be(y,b,O,ie);return Ne>-1?(b=y[Ne],R||(b.fa=!1)):(b=new Ae(b,this.src,ce,!!O,ie),b.fa=R,y.push(b)),b};function fe(y,b){const R=b.type;if(R in y.g){var O=y.g[R],ie=Array.prototype.indexOf.call(O,b,void 0),ce;(ce=ie>=0)&&Array.prototype.splice.call(O,ie,1),ce&&(Se(b),y.g[R].length==0&&(delete y.g[R],y.h--))}}function be(y,b,R,O){for(let ie=0;ie<y.length;++ie){const ce=y[ie];if(!ce.da&&ce.listener==b&&ce.capture==!!R&&ce.ha==O)return ie}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),ze={};function xe(y,b,R,O,ie){if(Array.isArray(b)){for(let ce=0;ce<b.length;ce++)xe(y,b[ce],R,O,ie);return null}return R=Dt(R),y&&y[et]?y.J(b,R,m(O)?!!O.capture:!1,ie):We(y,b,R,!1,O,ie)}function We(y,b,R,O,ie,ce){if(!b)throw Error("Invalid event type");const Ne=m(ie)?!!ie.capture:!!ie;let tt=pt(y);if(tt||(y[Fe]=tt=new ae(y)),R=tt.add(b,R,O,Ne,ce),R.proxy)return R;if(O=mt(),R.proxy=O,O.src=y,O.listener=R,y.addEventListener)j||(ie=Ne),ie===void 0&&(ie=!1),y.addEventListener(b.toString(),O,ie);else if(y.attachEvent)y.attachEvent(gn(b.toString()),O);else if(y.addListener&&y.removeListener)y.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return R}function mt(){function y(R){return b.call(y.src,y.listener,R)}const b=Et;return y}function je(y,b,R,O,ie){if(Array.isArray(b))for(var ce=0;ce<b.length;ce++)je(y,b[ce],R,O,ie);else O=m(O)?!!O.capture:!!O,R=Dt(R),y&&y[et]?(y=y.i,ce=String(b).toString(),ce in y.g&&(b=y.g[ce],R=be(b,R,O,ie),R>-1&&(Se(b[R]),Array.prototype.splice.call(b,R,1),b.length==0&&(delete y.g[ce],y.h--)))):y&&(y=pt(y))&&(b=y.g[b.toString()],y=-1,b&&(y=be(b,R,O,ie)),(R=y>-1?b[y]:null)&&un(R))}function un(y){if(typeof y!="number"&&y&&!y.da){var b=y.src;if(b&&b[et])fe(b.i,y);else{var R=y.type,O=y.proxy;b.removeEventListener?b.removeEventListener(R,O,y.capture):b.detachEvent?b.detachEvent(gn(R),O):b.addListener&&b.removeListener&&b.removeListener(O),(R=pt(b))?(fe(R,y),R.h==0&&(R.src=null,b[Fe]=null)):Se(y)}}}function gn(y){return y in ze?ze[y]:ze[y]="on"+y}function Et(y,b){if(y.da)y=!0;else{b=new Le(b,this);const R=y.listener,O=y.ha||y.src;y.fa&&un(y),y=R.call(O,b)}return y}function pt(y){return y=y[Fe],y instanceof ae?y:null}var Nt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Dt(y){return typeof y=="function"?y:(y[Nt]||(y[Nt]=function(b){return y.handleEvent(b)}),y[Nt])}function Rt(){F.call(this),this.i=new ae(this),this.M=this,this.G=null}S(Rt,F),Rt.prototype[et]=!0,Rt.prototype.removeEventListener=function(y,b,R,O){je(this,y,b,R,O)};function ye(y,b){var R,O=y.G;if(O)for(R=[];O;O=O.G)R.push(O);if(y=y.M,O=b.type||b,typeof b=="string")b=new q(b,y);else if(b instanceof q)b.target=b.target||y;else{var ie=b;b=new q(O,y),Ce(b,ie)}ie=!0;let ce,Ne;if(R)for(Ne=R.length-1;Ne>=0;Ne--)ce=b.g=R[Ne],ie=Pe(ce,O,!0,b)&&ie;if(ce=b.g=y,ie=Pe(ce,O,!0,b)&&ie,ie=Pe(ce,O,!1,b)&&ie,R)for(Ne=0;Ne<R.length;Ne++)ce=b.g=R[Ne],ie=Pe(ce,O,!1,b)&&ie}Rt.prototype.N=function(){if(Rt.Z.N.call(this),this.i){var y=this.i;for(const b in y.g){const R=y.g[b];for(let O=0;O<R.length;O++)Se(R[O]);delete y.g[b],y.h--}}this.G=null},Rt.prototype.J=function(y,b,R,O){return this.i.add(String(y),b,!1,R,O)},Rt.prototype.K=function(y,b,R,O){return this.i.add(String(y),b,!0,R,O)};function Pe(y,b,R,O){if(b=y.i.g[String(b)],!b)return!0;b=b.concat();let ie=!0;for(let ce=0;ce<b.length;++ce){const Ne=b[ce];if(Ne&&!Ne.da&&Ne.capture==R){const tt=Ne.listener,Mt=Ne.ha||Ne.src;Ne.fa&&fe(y.i,Ne),ie=tt.call(Mt,O)!==!1&&ie}}return ie&&!O.defaultPrevented}function Ge(y,b){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=p(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:c.setTimeout(y,b||0)}function gt(y){y.g=Ge(()=>{y.g=null,y.i&&(y.i=!1,gt(y))},y.l);const b=y.h;y.h=null,y.m.apply(null,b)}class lt extends F{constructor(b,R){super(),this.m=b,this.l=R,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:gt(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hn(y){F.call(this),this.h=y,this.g={}}S(hn,F);var Ai=[];function ii(y){Ye(y.g,function(b,R){this.g.hasOwnProperty(R)&&un(b)},y),y.g={}}hn.prototype.N=function(){hn.Z.N.call(this),ii(this)},hn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cn=c.JSON.stringify,Ci=c.JSON.parse,io=class{stringify(y){return c.JSON.stringify(y,void 0)}parse(y){return c.JSON.parse(y,void 0)}};function so(){}function Mo(){}var Re={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function $e(){q.call(this,"d")}S($e,q);function _t(){q.call(this,"c")}S(_t,q);var ut={},Un=null;function _i(){return Un=Un||new Rt}ut.Ia="serverreachability";function bi(y){q.call(this,ut.Ia,y)}S(bi,q);function Jn(y){const b=_i();ye(b,new bi(b))}ut.STAT_EVENT="statevent";function Zi(y,b){q.call(this,ut.STAT_EVENT,y),this.stat=b}S(Zi,q);function en(y){const b=_i();ye(b,new Zi(b,y))}ut.Ja="timingevent";function yi(y,b){q.call(this,ut.Ja,y),this.size=b}S(yi,q);function zn(y,b){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){y()},b)}function Yi(){this.g=!0}Yi.prototype.ua=function(){this.g=!1};function Bu(y,b,R,O,ie,ce){y.info(function(){if(y.g)if(ce){var Ne="",tt=ce.split("&");for(let Pt=0;Pt<tt.length;Pt++){var Mt=tt[Pt].split("=");if(Mt.length>1){const Qt=Mt[0];Mt=Mt[1];const Li=Qt.split("_");Ne=Li.length>=2&&Li[1]=="type"?Ne+(Qt+"="+Mt+"&"):Ne+(Qt+"=redacted&")}}}else Ne=null;else Ne=ce;return"XMLHTTP REQ ("+O+") [attempt "+ie+"]: "+b+`
`+R+`
`+Ne})}function Tl(y,b,R,O,ie,ce,Ne){y.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+ie+"]: "+b+`
`+R+`
`+ce+" "+Ne})}function fs(y,b,R,O){y.info(function(){return"XMLHTTP TEXT ("+b+"): "+Fu(y,R)+(O?" "+O:"")})}function Ds(y,b){y.info(function(){return"TIMEOUT: "+b})}Yi.prototype.info=function(){};function Fu(y,b){if(!y.g)return b;if(!b)return null;try{const ce=JSON.parse(b);if(ce){for(y=0;y<ce.length;y++)if(Array.isArray(ce[y])){var R=ce[y];if(!(R.length<2)){var O=R[1];if(Array.isArray(O)&&!(O.length<1)){var ie=O[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(let Ne=1;Ne<O.length;Ne++)O[Ne]=""}}}}return cn(ce)}catch{return b}}var Po={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ea={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},wa;function Bn(){}S(Bn,so),Bn.prototype.g=function(){return new XMLHttpRequest},wa=new Bn;function Ue(y){return encodeURIComponent(String(y))}function Sa(y){var b=1;y=y.split(":");const R=[];for(;b>0&&y.length;)R.push(y.shift()),b--;return y.length&&R.push(y.join(":")),R}function Ii(y,b,R,O){this.j=y,this.i=b,this.l=R,this.S=O||1,this.V=new hn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ni}function Ni(){this.i=null,this.g="",this.h=!1}var fn={},_n={};function Wi(y,b,R){y.M=1,y.A=Ht(nn(b)),y.u=R,y.R=!0,Ji(y,null)}function Ji(y,b){y.F=Date.now(),ms(y),y.B=nn(y.A);var R=y.B,O=y.S;Array.isArray(O)||(O=[String(O)]),ro(R.i,"t",O),y.C=0,R=y.j.L,y.h=new Ni,y.g=Ma(y.j,R?b:null,!y.u),y.P>0&&(y.O=new lt(p(y.Y,y,y.g),y.P)),b=y.V,R=y.g,O=y.ba;var ie="readystatechange";Array.isArray(ie)||(ie&&(Ai[0]=ie.toString()),ie=Ai);for(let ce=0;ce<ie.length;ce++){const Ne=xe(R,ie[ce],O||b.handleEvent,!1,b.h||b);if(!Ne)break;b.g[Ne.key]=Ne}b=y.J?K(y.J):{},y.u?(y.v||(y.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,b)):(y.v="GET",y.g.ea(y.B,y.v,null,b)),Jn(),Bu(y.i,y.v,y.B,y.l,y.S,y.u)}Ii.prototype.ba=function(y){y=y.target;const b=this.O;b&&es(y)==3?b.j():this.Y(y)},Ii.prototype.Y=function(y){try{if(y==this.g)e:{const tt=es(this.g),Mt=this.g.ya(),Pt=this.g.ca();if(!(tt<3)&&(tt!=3||this.g&&(this.h.h||this.g.la()||bn(this.g)))){this.K||tt!=4||Mt==7||(Mt==8||Pt<=0?Jn(3):Jn(2)),Qi(this);var b=this.g.ca();this.X=b;var R=xl(this);if(this.o=b==200,Tl(this.i,this.v,this.B,this.l,this.S,tt,b),this.o){if(this.U&&!this.L){t:{if(this.g){var O,ie=this.g;if((O=ie.g?ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(O)){var ce=O;break t}}ce=null}if(y=ce)fs(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ps(this,y);else{this.o=!1,this.m=3,en(12),Fn(this),Ri(this);break e}}if(this.R){y=!0;let Qt;for(;!this.K&&this.C<R.length;)if(Qt=wl(this,R),Qt==_n){tt==4&&(this.m=4,en(14),y=!1),fs(this.i,this.l,null,"[Incomplete Response]");break}else if(Qt==fn){this.m=4,en(15),fs(this.i,this.l,R,"[Invalid Chunk]"),y=!1;break}else fs(this.i,this.l,Qt,null),ps(this,Qt);if(El(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tt!=4||R.length!=0||this.h.h||(this.m=1,en(16),y=!1),this.o=this.o&&y,!y)fs(this.i,this.l,R,"[Invalid Chunked Response]"),Fn(this),Ri(this);else if(R.length>0&&!this.W){this.W=!0;var Ne=this.j;Ne.g==this&&Ne.aa&&!Ne.P&&(Ne.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),Na(Ne),Ne.P=!0,en(11))}}else fs(this.i,this.l,R,null),ps(this,R);tt==4&&Fn(this),this.o&&!this.K&&(tt==4?xi(this.j,this):(this.o=!1,ms(this)))}else ts(this.g),b==400&&R.indexOf("Unknown SID")>0?(this.m=3,en(12)):(this.m=0,en(13)),Fn(this),Ri(this)}}}catch{}finally{}};function xl(y){if(!El(y))return y.g.la();const b=bn(y.g);if(b==="")return"";let R="";const O=b.length,ie=es(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return Fn(y),Ri(y),"";y.h.i=new c.TextDecoder}for(let ce=0;ce<O;ce++)y.h.h=!0,R+=y.h.i.decode(b[ce],{stream:!(ie&&ce==O-1)});return b.length=0,y.h.g+=R,y.C=0,y.h.g}function El(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function wl(y,b){var R=y.C,O=b.indexOf(`
`,R);return O==-1?_n:(R=Number(b.substring(R,O)),isNaN(R)?fn:(O+=1,O+R>b.length?_n:(b=b.slice(O,O+R),y.C=O+R,b)))}Ii.prototype.cancel=function(){this.K=!0,Fn(this)};function ms(y){y.T=Date.now()+y.H,pr(y,y.H)}function pr(y,b){if(y.D!=null)throw Error("WatchDog timer not null");y.D=zn(p(y.aa,y),b)}function Qi(y){y.D&&(c.clearTimeout(y.D),y.D=null)}Ii.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(Ds(this.i,this.B),this.M!=2&&(Jn(),en(17)),Fn(this),this.m=2,Ri(this)):pr(this,this.T-y)};function Ri(y){y.j.I==0||y.K||xi(y.j,y)}function Fn(y){Qi(y);var b=y.O;b&&typeof b.dispose=="function"&&b.dispose(),y.O=null,ii(y.V),y.g&&(b=y.g,y.g=null,b.abort(),b.dispose())}function ps(y,b){try{var R=y.j;if(R.I!=0&&(R.g==y||Mi(R.h,y))){if(!y.L&&Mi(R.h,y)&&R.I==3){try{var O=R.Ba.g.parse(b)}catch{O=null}if(Array.isArray(O)&&O.length==3){var ie=O;if(ie[0]==0){e:if(!R.v){if(R.g)if(R.g.F+3e3<y.F)Er(R),co(R);else break e;Uo(R),en(18)}}else R.xa=ie[1],0<R.xa-R.K&&ie[2]<37500&&R.F&&R.A==0&&!R.C&&(R.C=zn(p(R.Va,R),6e3));gs(R.h)<=1&&R.ta&&(R.ta=void 0)}else ns(R,11)}else if((y.L||R.g==y)&&Er(R),!B(b))for(ie=R.Ba.g.parse(b),b=0;b<ie.length;b++){let Pt=ie[b];const Qt=Pt[0];if(!(Qt<=R.K))if(R.K=Qt,Pt=Pt[1],R.I==2)if(Pt[0]=="c"){R.M=Pt[1],R.ba=Pt[2];const Li=Pt[3];Li!=null&&(R.ka=Li,R.j.info("VER="+R.ka));const Vi=Pt[4];Vi!=null&&(R.za=Vi,R.j.info("SVER="+R.za));const Ei=Pt[5];Ei!=null&&typeof Ei=="number"&&Ei>0&&(O=1.5*Ei,R.O=O,R.j.info("backChannelRequestTimeoutMs_="+O)),O=R;const ss=y.g;if(ss){const zo=ss.g?ss.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(zo){var ce=O.h;ce.g||zo.indexOf("spdy")==-1&&zo.indexOf("quic")==-1&&zo.indexOf("h2")==-1||(ce.j=ce.l,ce.g=new Set,ce.h&&(Ls(ce,ce.h),ce.h=null))}if(O.G){const Bo=ss.g?ss.g.getResponseHeader("X-HTTP-Session-Id"):null;Bo&&(O.wa=Bo,De(O.J,O.G,Bo))}}R.I=3,R.l&&R.l.ra(),R.aa&&(R.T=Date.now()-y.F,R.j.info("Handshake RTT: "+R.T+"ms")),O=R;var Ne=y;if(O.na=Ra(O,O.L?O.ba:null,O.W),Ne.L){gr(O.h,Ne);var tt=Ne,Mt=O.O;Mt&&(tt.H=Mt),tt.D&&(Qi(tt),ms(tt)),O.g=Ne}else Ia(O);R.i.length>0&&ai(R)}else Pt[0]!="stop"&&Pt[0]!="close"||ns(R,7);else R.I==3&&(Pt[0]=="stop"||Pt[0]=="close"?Pt[0]=="stop"?ns(R,7):ht(R):Pt[0]!="noop"&&R.l&&R.l.qa(Pt),R.A=0)}}Jn(4)}catch{}}var yn=class{constructor(y,b){this.g=y,this.map=b}};function Aa(y){this.l=y||10,c.PerformanceNavigationTiming?(y=c.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ca(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function gs(y){return y.h?1:y.g?y.g.size:0}function Mi(y,b){return y.h?y.h==b:y.g?y.g.has(b):!1}function Ls(y,b){y.g?y.g.add(b):y.h=b}function gr(y,b){y.h&&y.h==b?y.h=null:y.g&&y.g.has(b)&&y.g.delete(b)}Aa.prototype.cancel=function(){if(this.i=_r(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function _r(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let b=y.i;for(const R of y.g.values())b=b.concat(R.G);return b}return M(y.i)}var oo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ft(y,b){if(y){y=y.split("&");for(let R=0;R<y.length;R++){const O=y[R].indexOf("=");let ie,ce=null;O>=0?(ie=y[R].substring(0,O),ce=y[R].substring(O+1)):ie=y[R],b(ie,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function yt(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;y instanceof yt?(this.l=y.l,sn(this,y.j),this.o=y.o,this.g=y.g,vi(this,y.u),this.h=y.h,ko(this,Vo(y.i)),this.m=y.m):y&&(b=String(y).match(oo))?(this.l=!1,sn(this,b[1]||"",!0),this.o=Pi(b[2]||""),this.g=Pi(b[3]||"",!0),vi(this,b[4]),this.h=Pi(b[5]||"",!0),ko(this,b[6]||"",!0),this.m=Pi(b[7]||"")):(this.l=!1,this.i=new ki(null,this.l))}yt.prototype.toString=function(){const y=[];var b=this.j;b&&y.push(_s(b,yr,!0),":");var R=this.g;return(R||b=="file")&&(y.push("//"),(b=this.o)&&y.push(_s(b,yr,!0),"@"),y.push(Ue(R).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.u,R!=null&&y.push(":",String(R))),(R=this.h)&&(this.g&&R.charAt(0)!="/"&&y.push("/"),y.push(_s(R,R.charAt(0)=="/"?$i:Do,!0))),(R=this.i.toString())&&y.push("?",R),(R=this.m)&&y.push("#",_s(R,ys)),y.join("")},yt.prototype.resolve=function(y){const b=nn(this);let R=!!y.j;R?sn(b,y.j):R=!!y.o,R?b.o=y.o:R=!!y.g,R?b.g=y.g:R=y.u!=null;var O=y.h;if(R)vi(b,y.u);else if(R=!!y.h){if(O.charAt(0)!="/")if(this.g&&!this.h)O="/"+O;else{var ie=b.h.lastIndexOf("/");ie!=-1&&(O=b.h.slice(0,ie+1)+O)}if(ie=O,ie==".."||ie==".")O="";else if(ie.indexOf("./")!=-1||ie.indexOf("/.")!=-1){O=ie.lastIndexOf("/",0)==0,ie=ie.split("/");const ce=[];for(let Ne=0;Ne<ie.length;){const tt=ie[Ne++];tt=="."?O&&Ne==ie.length&&ce.push(""):tt==".."?((ce.length>1||ce.length==1&&ce[0]!="")&&ce.pop(),O&&Ne==ie.length&&ce.push("")):(ce.push(tt),O=!0)}O=ce.join("/")}else O=ie}return R?b.h=O:R=y.i.toString()!=="",R?ko(b,Vo(y.i)):R=!!y.m,R&&(b.m=y.m),b};function nn(y){return new yt(y)}function sn(y,b,R){y.j=R?Pi(b,!0):b,y.j&&(y.j=y.j.replace(/:$/,""))}function vi(y,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);y.u=b}else y.u=null}function ko(y,b,R){b instanceof ki?(y.i=b,ao(y.i,y.l)):(R||(b=_s(b,Gt)),y.i=new ki(b,y.l))}function De(y,b,R){y.i.set(b,R)}function Ht(y){return De(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function Pi(y,b){return y?b?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function _s(y,b,R){return typeof y=="string"?(y=encodeURI(y).replace(b,Jt),R&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Jt(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var yr=/[#\/\?@]/g,Do=/[#\?:]/g,$i=/[#\?]/g,Gt=/[#\?@]/g,ys=/#/g;function ki(y,b){this.h=this.g=null,this.i=y||null,this.j=!!b}function Cn(y){y.g||(y.g=new Map,y.h=0,y.i&&ft(y.i,function(b,R){y.add(decodeURIComponent(b.replace(/\+/g," ")),R)}))}n=ki.prototype,n.add=function(y,b){Cn(this),this.i=null,y=vs(this,y);let R=this.g.get(y);return R||this.g.set(y,R=[]),R.push(b),this.h+=1,this};function vr(y,b){Cn(y),b=vs(y,b),y.g.has(b)&&(y.i=null,y.h-=y.g.get(b).length,y.g.delete(b))}function Vs(y,b){return Cn(y),b=vs(y,b),y.g.has(b)}n.forEach=function(y,b){Cn(this),this.g.forEach(function(R,O){R.forEach(function(ie){y.call(b,ie,O,this)},this)},this)};function Lo(y,b){Cn(y);let R=[];if(typeof b=="string")Vs(y,b)&&(R=R.concat(y.g.get(vs(y,b))));else for(y=Array.from(y.g.values()),b=0;b<y.length;b++)R=R.concat(y[b]);return R}n.set=function(y,b){return Cn(this),this.i=null,y=vs(this,y),Vs(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[b]),this.h+=1,this},n.get=function(y,b){return y?(y=Lo(this,y),y.length>0?String(y[0]):b):b};function ro(y,b,R){vr(y,b),R.length>0&&(y.i=null,y.g.set(vs(y,b),M(R)),y.h+=R.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],b=Array.from(this.g.keys());for(let O=0;O<b.length;O++){var R=b[O];const ie=Ue(R);R=Lo(this,R);for(let ce=0;ce<R.length;ce++){let Ne=ie;R[ce]!==""&&(Ne+="="+Ue(R[ce])),y.push(Ne)}}return this.i=y.join("&")};function Vo(y){const b=new ki;return b.i=y.i,y.g&&(b.g=new Map(y.g),b.h=y.h),b}function vs(y,b){return b=String(b),y.j&&(b=b.toLowerCase()),b}function ao(y,b){b&&!y.j&&(Cn(y),y.i=null,y.g.forEach(function(R,O){const ie=O.toLowerCase();O!=ie&&(vr(this,O),ro(this,ie,R))},y)),y.j=b}function si(y,b){const R=new Yi;if(c.Image){const O=new Image;O.onload=E(oi,R,"TestLoadImage: loaded",!0,b,O),O.onerror=E(oi,R,"TestLoadImage: error",!1,b,O),O.onabort=E(oi,R,"TestLoadImage: abort",!1,b,O),O.ontimeout=E(oi,R,"TestLoadImage: timeout",!1,b,O),c.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=y}else b(!1)}function Tr(y,b){const R=new Yi,O=new AbortController,ie=setTimeout(()=>{O.abort(),oi(R,"TestPingServer: timeout",!1,b)},1e4);fetch(y,{signal:O.signal}).then(ce=>{clearTimeout(ie),ce.ok?oi(R,"TestPingServer: ok",!0,b):oi(R,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ie),oi(R,"TestPingServer: error",!1,b)})}function oi(y,b,R,O,ie){try{ie&&(ie.onload=null,ie.onerror=null,ie.onabort=null,ie.ontimeout=null),O(R)}catch{}}function lo(){this.g=new io}function Je(y){this.i=y.Sb||null,this.h=y.ab||!1}S(Je,so),Je.prototype.g=function(){return new qn(this.i,this.h)};function qn(y,b){Rt.call(this),this.H=y,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}S(qn,Rt),n=qn.prototype,n.open=function(y,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=b,this.readyState=1,Ti(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(b.body=y),(this.H||c).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Os(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Ti(this)),this.g&&(this.readyState=3,Ti(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Lt(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function Lt(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var b=y.value?y.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!y.done}))&&(this.response=this.responseText+=b)}y.done?Os(this):Ti(this),this.readyState==3&&Lt(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,Os(this))},n.Na=function(y){this.g&&(this.response=y,Os(this))},n.ga=function(){this.g&&Os(this)};function Os(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Ti(y)}n.setRequestHeader=function(y,b){this.A.append(y,b)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],b=this.h.entries();for(var R=b.next();!R.done;)R=R.value,y.push(R[0]+": "+R[1]),R=b.next();return y.join(`\r
`)};function Ti(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(qn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function ri(y){let b="";return Ye(y,function(R,O){b+=O,b+=":",b+=R,b+=`\r
`}),b}function Us(y,b,R){e:{for(O in R){var O=!1;break e}O=!0}O||(R=ri(R),typeof y=="string"?R!=null&&Ue(R):De(y,b,R))}function wt(y){Rt.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}S(wt,Rt);var Di=/^https?$/i,zs=["POST","PUT"];n=wt.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,b,R,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);b=b?b.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():wa.g(),this.g.onreadystatechange=C(p(this.Ca,this));try{this.B=!0,this.g.open(b,String(y),!0),this.B=!1}catch(ce){on(this,ce);return}if(y=R||"",R=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var ie in O)R.set(ie,O[ie]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const ce of O.keys())R.set(ce,O.get(ce));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(R.keys()).find(ce=>ce.toLowerCase()=="content-type"),ie=c.FormData&&y instanceof c.FormData,!(Array.prototype.indexOf.call(zs,b,void 0)>=0)||O||ie||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ce,Ne]of R)this.g.setRequestHeader(ce,Ne);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(ce){on(this,ce)}};function on(y,b){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=b,y.o=5,Xi(y),Ts(y)}function Xi(y){y.A||(y.A=!0,ye(y,"complete"),ye(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,ye(this,"complete"),ye(this,"abort"),Ts(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ts(this,!0)),wt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?uo(this):this.Xa())},n.Xa=function(){uo(this)};function uo(y){if(y.h&&typeof l<"u"){if(y.v&&es(y)==4)setTimeout(y.Ca.bind(y),0);else if(ye(y,"readystatechange"),es(y)==4){y.h=!1;try{const ce=y.ca();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var R;if(!(R=b)){var O;if(O=ce===0){let Ne=String(y.D).match(oo)[1]||null;!Ne&&c.self&&c.self.location&&(Ne=c.self.location.protocol.slice(0,-1)),O=!Di.test(Ne?Ne.toLowerCase():"")}R=O}if(R)ye(y,"complete"),ye(y,"success");else{y.o=6;try{var ie=es(y)>2?y.g.statusText:""}catch{ie=""}y.l=ie+" ["+y.ca()+"]",Xi(y)}}finally{Ts(y)}}}}function Ts(y,b){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const R=y.g;y.g=null,b||ye(y,"ready");try{R.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function es(y){return y.g?y.g.readyState:0}n.ca=function(){try{return es(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var b=this.g.responseText;return y&&b.indexOf(y)==0&&(b=b.substring(y.length)),Ci(b)}};function bn(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function ts(y){const b={};y=(y.g&&es(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<y.length;O++){if(B(y[O]))continue;var R=Sa(y[O]);const ie=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const ce=b[ie]||[];b[ie]=ce,ce.push(R)}Ie(b,function(O){return O.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function xs(y,b,R){return R&&R.internalChannelParams&&R.internalChannelParams[y]||b}function Bs(y){this.za=0,this.i=[],this.j=new Yi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=xs("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=xs("baseRetryDelayMs",5e3,y),this.Za=xs("retryDelaySeedMs",1e4,y),this.Ta=xs("forwardChannelMaxRetries",2,y),this.va=xs("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Aa(y&&y.concurrentRequestLimit),this.Ba=new lo,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Bs.prototype,n.ka=8,n.I=1,n.connect=function(y,b,R,O){en(0),this.W=y,this.H=b||{},R&&O!==void 0&&(this.H.OSID=R,this.H.OAID=O),this.F=this.X,this.J=Ra(this,null,this.W),ai(this)};function ht(y){if(Hn(y),y.I==3){var b=y.V++,R=nn(y.J);if(De(R,"SID",y.M),De(R,"RID",b),De(R,"TYPE","terminate"),Fs(y,R),b=new Ii(y,y.j,b),b.M=2,b.A=Ht(nn(R)),R=!1,c.navigator&&c.navigator.sendBeacon)try{R=c.navigator.sendBeacon(b.A.toString(),"")}catch{}!R&&c.Image&&(new Image().src=b.A,R=!0),R||(b.g=Ma(b.j,null),b.g.ea(b.A)),b.F=Date.now(),ms(b)}is(y)}function co(y){y.g&&(Na(y),y.g.cancel(),y.g=null)}function Hn(y){co(y),y.v&&(c.clearTimeout(y.v),y.v=null),Er(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&c.clearTimeout(y.m),y.m=null)}function ai(y){if(!Ca(y.h)&&!y.m){y.m=!0;var b=y.Ea;pe||U(),J||(pe(),J=!0),k.add(b,y),y.D=0}}function Oo(y,b){return gs(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=b.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=zn(p(y.Ea,y,b),Al(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const ie=new Ii(this,this.j,y);let ce=this.o;if(this.U&&(ce?(ce=K(ce),Ce(ce,this.U)):ce=this.U),this.u!==null||this.R||(ie.J=ce,ce=null),this.S)e:{for(var b=0,R=0;R<this.i.length;R++){t:{var O=this.i[R];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(b+=O,b>4096){b=R;break e}if(b===4096||R===this.i.length-1){b=R+1;break e}}b=1e3}else b=1e3;b=Sl(this,ie,b),R=nn(this.J),De(R,"RID",y),De(R,"CVER",22),this.G&&De(R,"X-HTTP-Session-Id",this.G),Fs(this,R),ce&&(this.R?b="headers="+Ue(ri(ce))+"&"+b:this.u&&Us(R,this.u,ce)),Ls(this.h,ie),this.Ra&&De(R,"TYPE","init"),this.S?(De(R,"$req",b),De(R,"SID","null"),ie.U=!0,Wi(ie,R,null)):Wi(ie,R,b),this.I=2}}else this.I==3&&(y?ba(this,y):this.i.length==0||Ca(this.h)||ba(this))};function ba(y,b){var R;b?R=b.l:R=y.V++;const O=nn(y.J);De(O,"SID",y.M),De(O,"RID",R),De(O,"AID",y.K),Fs(y,O),y.u&&y.o&&Us(O,y.u,y.o),R=new Ii(y,y.j,R,y.D+1),y.u===null&&(R.J=y.o),b&&(y.i=b.G.concat(y.i)),b=Sl(y,R,1e3),R.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Ls(y.h,R),Wi(R,O,b)}function Fs(y,b){y.H&&Ye(y.H,function(R,O){De(b,O,R)}),y.l&&Ye({},function(R,O){De(b,O,R)})}function Sl(y,b,R){R=Math.min(y.i.length,R);const O=y.l?p(y.l.Ka,y.l,y):null;e:{var ie=y.i;let tt=-1;for(;;){const Mt=["count="+R];tt==-1?R>0?(tt=ie[0].g,Mt.push("ofs="+tt)):tt=0:Mt.push("ofs="+tt);let Pt=!0;for(let Qt=0;Qt<R;Qt++){var ce=ie[Qt].g;const Li=ie[Qt].map;if(ce-=tt,ce<0)tt=Math.max(0,ie[Qt].g-100),Pt=!1;else try{ce="req"+ce+"_"||"";try{var Ne=Li instanceof Map?Li:Object.entries(Li);for(const[Vi,Ei]of Ne){let ss=Ei;m(Ei)&&(ss=cn(Ei)),Mt.push(ce+Vi+"="+encodeURIComponent(ss))}}catch(Vi){throw Mt.push(ce+"type="+encodeURIComponent("_badmap")),Vi}}catch{O&&O(Li)}}if(Pt){Ne=Mt.join("&");break e}}Ne=void 0}return y=y.i.splice(0,R),b.G=y,Ne}function Ia(y){if(!y.g&&!y.v){y.Y=1;var b=y.Da;pe||U(),J||(pe(),J=!0),k.add(b,y),y.A=0}}function Uo(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=zn(p(y.Da,y),Al(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,xr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=zn(p(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,en(10),co(this),xr(this))};function Na(y){y.B!=null&&(c.clearTimeout(y.B),y.B=null)}function xr(y){y.g=new Ii(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var b=nn(y.na);De(b,"RID","rpc"),De(b,"SID",y.M),De(b,"AID",y.K),De(b,"CI",y.F?"0":"1"),!y.F&&y.ia&&De(b,"TO",y.ia),De(b,"TYPE","xmlhttp"),Fs(y,b),y.u&&y.o&&Us(b,y.u,y.o),y.O&&(y.g.H=y.O);var R=y.g;y=y.ba,R.M=1,R.A=Ht(nn(b)),R.u=null,R.R=!0,Ji(R,y)}n.Va=function(){this.C!=null&&(this.C=null,co(this),Uo(this),en(19))};function Er(y){y.C!=null&&(c.clearTimeout(y.C),y.C=null)}function xi(y,b){var R=null;if(y.g==b){Er(y),Na(y),y.g=null;var O=2}else if(Mi(y.h,b))R=b.G,gr(y.h,b),O=1;else return;if(y.I!=0){if(b.o)if(O==1){R=b.u?b.u.length:0,b=Date.now()-b.F;var ie=y.D;O=_i(),ye(O,new yi(O,R)),ai(y)}else Ia(y);else if(ie=b.m,ie==3||ie==0&&b.X>0||!(O==1&&Oo(y,b)||O==2&&Uo(y)))switch(R&&R.length>0&&(b=y.h,b.i=b.i.concat(R)),ie){case 1:ns(y,5);break;case 4:ns(y,10);break;case 3:ns(y,6);break;default:ns(y,2)}}}function Al(y,b){let R=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(R*=2),R*b}function ns(y,b){if(y.j.info("Error code "+b),b==2){var R=p(y.bb,y),O=y.Ua;const ie=!O;O=new yt(O||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||sn(O,"https"),Ht(O),ie?si(O.toString(),R):Tr(O.toString(),R)}else en(2);y.I=0,y.l&&y.l.pa(b),is(y),Hn(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),en(2)):(this.j.info("Failed to ping google.com"),en(1))};function is(y){if(y.I=0,y.ja=[],y.l){const b=_r(y.h);(b.length!=0||y.i.length!=0)&&(z(y.ja,b),z(y.ja,y.i),y.h.i.length=0,M(y.i),y.i.length=0),y.l.oa()}}function Ra(y,b,R){var O=R instanceof yt?nn(R):new yt(R);if(O.g!="")b&&(O.g=b+"."+O.g),vi(O,O.u);else{var ie=c.location;O=ie.protocol,b=b?b+"."+ie.hostname:ie.hostname,ie=+ie.port;const ce=new yt(null);O&&sn(ce,O),b&&(ce.g=b),ie&&vi(ce,ie),R&&(ce.h=R),O=ce}return R=y.G,b=y.wa,R&&b&&De(O,R,b),De(O,"VER",y.ka),Fs(y,O),O}function Ma(y,b,R){if(b&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=y.Aa&&!y.ma?new wt(new Je({ab:R})):new wt(y.ma),b.Fa(y.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function wr(){}n=wr.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ho(){}ho.prototype.g=function(y,b){return new Gn(y,b)};function Gn(y,b){Rt.call(this),this.g=new Bs(b),this.l=y,this.h=b&&b.messageUrlParams||null,y=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(y?y["X-WebChannel-Content-Type"]=b.messageContentType:y={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(y?y["X-WebChannel-Client-Profile"]=b.sa:y={"X-WebChannel-Client-Profile":b.sa}),this.g.U=y,(y=b&&b.Qb)&&!B(y)&&(this.g.u=y),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!B(b)&&(this.g.G=b,y=this.h,y!==null&&b in y&&(y=this.h,b in y&&delete y[b])),this.j=new qs(this)}S(Gn,Rt),Gn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Gn.prototype.close=function(){ht(this.g)},Gn.prototype.o=function(y){var b=this.g;if(typeof y=="string"){var R={};R.__data__=y,y=R}else this.v&&(R={},R.__data__=cn(y),y=R);b.i.push(new yn(b.Ya++,y)),b.I==3&&ai(b)},Gn.prototype.N=function(){this.g.l=null,delete this.j,ht(this.g),delete this.g,Gn.Z.N.call(this)};function Pa(y){$e.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var b=y.__sm__;if(b){e:{for(const R in b){y=R;break e}y=void 0}(this.i=y)&&(y=this.i,b=b!==null&&y in b?b[y]:void 0),this.data=b}else this.data=y}S(Pa,$e);function Cl(){_t.call(this),this.status=1}S(Cl,_t);function qs(y){this.g=y}S(qs,wr),qs.prototype.ra=function(){ye(this.g,"a")},qs.prototype.qa=function(y){ye(this.g,new Pa(y))},qs.prototype.pa=function(y){ye(this.g,new Cl)},qs.prototype.oa=function(){ye(this.g,"b")},ho.prototype.createWebChannel=ho.prototype.g,Gn.prototype.send=Gn.prototype.o,Gn.prototype.open=Gn.prototype.m,Gn.prototype.close=Gn.prototype.close,t1=function(){return new ho},e1=function(){return _i()},XS=ut,sg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Po.NO_ERROR=0,Po.TIMEOUT=8,Po.HTTP_ERROR=6,Ch=Po,Ea.COMPLETE="complete",$S=Ea,Mo.EventType=Re,Re.OPEN="a",Re.CLOSE="b",Re.ERROR="c",Re.MESSAGE="d",Rt.prototype.listen=Rt.prototype.J,Rc=Mo,wt.prototype.listenOnce=wt.prototype.K,wt.prototype.getLastError=wt.prototype.Ha,wt.prototype.getLastErrorCode=wt.prototype.ya,wt.prototype.getStatus=wt.prototype.ca,wt.prototype.getResponseJson=wt.prototype.La,wt.prototype.getResponseText=wt.prototype.la,wt.prototype.send=wt.prototype.ea,wt.prototype.setWithCredentials=wt.prototype.Fa,QS=wt}).apply(typeof mh<"u"?mh:typeof self<"u"?self:typeof window<"u"?window:{});const Xx="@firebase/firestore",eE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}hi.UNAUTHENTICATED=new hi(null),hi.GOOGLE_CREDENTIALS=new hi("google-credentials-uid"),hi.FIRST_PARTY=new hi("first-party-uid"),hi.MOCK_USER=new hi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lu="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hl=new Gg("@firebase/firestore");function su(){return hl.logLevel}function Oe(n,...e){if(hl.logLevel<=Ct.DEBUG){const t=e.map(i_);hl.debug(`Firestore (${Lu}): ${n}`,...t)}}function cr(n,...e){if(hl.logLevel<=Ct.ERROR){const t=e.map(i_);hl.error(`Firestore (${Lu}): ${n}`,...t)}}function Tu(n,...e){if(hl.logLevel<=Ct.WARN){const t=e.map(i_);hl.warn(`Firestore (${Lu}): ${n}`,...t)}}function i_(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xe(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,n1(n,i,t)}function n1(n,e,t){let i=`FIRESTORE (${Lu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw cr(i),new Error(i)}function qt(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||n1(e,r,i)}function rt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends mr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class E3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(hi.UNAUTHENTICATED)))}shutdown(){}}class w3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class S3{constructor(e){this.t=e,this.currentUser=hi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){qt(this.o===void 0,42304);let i=this.i;const r=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let l=new ua;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new ua,e.enqueueRetryable((()=>r(this.currentUser)))};const c=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await r(this.currentUser)}))},m=g=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((g=>m(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?m(g):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new ua)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(qt(typeof i.accessToken=="string",31837,{l:i}),new i1(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return qt(e===null||typeof e=="string",2055,{h:e}),new hi(e)}}class A3{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=hi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class C3{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new A3(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(hi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class b3{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ws(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){qt(this.o===void 0,3512);const i=l=>{l.error!=null&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Oe("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const r=l=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>r(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?r(l):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(qt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new tE(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=I3(40);for(let l=0;l<r.length;++l)i.length<20&&r[l]<t&&(i+=e.charAt(r[l]%62))}return i}}function bt(n,e){return n<e?-1:n>e?1:0}function og(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),l=e.charAt(i);if(r!==l)return kp(r)===kp(l)?bt(r,l):kp(r)?1:-1}return bt(n.length,e.length)}const N3=55296,R3=57343;function kp(n){const e=n.charCodeAt(0);return e>=N3&&e<=R3}function xu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nE="__name__";class wo{constructor(e,t,i){t===void 0?t=0:t>e.length&&Xe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Xe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return wo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof wo?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const l=wo.compareSegments(e.get(r),t.get(r));if(l!==0)return l}return bt(e.length,t.length)}static compareSegments(e,t){const i=wo.isNumericId(e),r=wo.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?wo.extractNumericId(e).compare(wo.extractNumericId(t)):og(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return la.fromString(e.substring(4,e.length-2))}}class tn extends wo{construct(e,t,i){return new tn(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ve(Ee.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new tn(t)}static emptyPath(){return new tn([])}}const M3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ti extends wo{construct(e,t,i){return new ti(e,t,i)}static isValidIdentifier(e){return M3.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ti.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===nE}static keyField(){return new ti([nE])}static fromServerFormat(e){const t=[];let i="",r=0;const l=()=>{if(i.length===0)throw new Ve(Ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;r<e.length;){const m=e[r];if(m==="\\"){if(r+1===e.length)throw new Ve(Ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[r+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ve(Ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,r+=2}else m==="`"?(c=!c,r++):m!=="."||c?(i+=m,r++):(l(),r++)}if(l(),c)throw new Ve(Ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ti(t)}static emptyPath(){return new ti([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.path=e}static fromPath(e){return new Ze(tn.fromString(e))}static fromName(e){return new Ze(tn.fromString(e).popFirst(5))}static empty(){return new Ze(tn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return tn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ze(new tn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s1(n,e,t){if(!t)throw new Ve(Ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function P3(n,e,t,i){if(e===!0&&i===!0)throw new Ve(Ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function iE(n){if(!Ze.isDocumentKey(n))throw new Ve(Ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function sE(n){if(Ze.isDocumentKey(n))throw new Ve(Ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function o1(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function yf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Xe(12329,{type:typeof n})}function Ps(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ve(Ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=yf(n);throw new Ve(Ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(n,e){const t={typeString:n};return e&&(t.value=e),t}function nd(n,e){if(!o1(n))throw new Ve(Ee.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const c=n[i];if(r&&typeof c!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new Ve(Ee.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oE=-62135596800,rE=1e6;class ln{static now(){return ln.fromMillis(Date.now())}static fromDate(e){return ln.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*rE);return new ln(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ve(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ve(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<oE)throw new Ve(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/rE}_compareTo(e){return this.seconds===e.seconds?bt(this.nanoseconds,e.nanoseconds):bt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ln._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(nd(e,ln._jsonSchema))return new ln(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-oE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ln._jsonSchemaVersion="firestore/timestamp/1.0",ln._jsonSchema={type:Dn("string",ln._jsonSchemaVersion),seconds:Dn("number"),nanoseconds:Dn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{static fromTimestamp(e){return new st(e)}static min(){return new st(new ln(0,0))}static max(){return new st(new ln(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=-1;function k3(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=st.fromTimestamp(i===1e9?new ln(t+1,0):new ln(t,i));return new ha(r,Ze.empty(),e)}function D3(n){return new ha(n.readTime,n.key,Kc)}class ha{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ha(st.min(),Ze.empty(),Kc)}static max(){return new ha(st.max(),Ze.empty(),Kc)}}function L3(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ze.comparator(n.documentKey,e.documentKey),t!==0?t:bt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class O3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vu(n){if(n.code!==Ee.FAILED_PRECONDITION||n.message!==V3)throw n;Oe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new we(((i,r)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,r)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof we?t:we.resolve(t)}catch(t){return we.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):we.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):we.reject(t)}static resolve(e){return new we(((t,i)=>{t(e)}))}static reject(e){return new we(((t,i)=>{i(e)}))}static waitFor(e){return new we(((t,i)=>{let r=0,l=0,c=!1;e.forEach((m=>{++r,m.next((()=>{++l,c&&l===r&&t()}),(g=>i(g)))})),c=!0,l===r&&t()}))}static or(e){let t=we.resolve(!1);for(const i of e)t=t.next((r=>r?we.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,l)=>{i.push(t.call(this,r,l))})),this.waitFor(i)}static mapArray(e,t){return new we(((i,r)=>{const l=e.length,c=new Array(l);let m=0;for(let g=0;g<l;g++){const p=g;t(e[p]).next((E=>{c[p]=E,++m,m===l&&i(c)}),(E=>r(E)))}}))}static doWhile(e,t){return new we(((i,r)=>{const l=()=>{e()===!0?t().next((()=>{l()}),r):i()};l()}))}}function U3(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ou(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}vf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o_=-1;function Tf(n){return n==null}function jh(n){return n===0&&1/n==-1/0}function z3(n){return typeof n=="number"&&Number.isInteger(n)&&!jh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r1="";function B3(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=aE(e)),e=F3(n.get(t),e);return aE(e)}function F3(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const l=n.charAt(r);switch(l){case"\0":t+="";break;case r1:t+="";break;default:t+=l}}return t}function aE(n){return n+r1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lE(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ta(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function a1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e,t){this.comparator=e,this.root=t||ei.EMPTY}insert(e,t){return new pn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ei.BLACK,null,null))}remove(e){return new pn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ei.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ph(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ph(this.root,e,this.comparator,!1)}getReverseIterator(){return new ph(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ph(this.root,e,this.comparator,!0)}}class ph{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&r&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ei{constructor(e,t,i,r,l){this.key=e,this.value=t,this.color=i??ei.RED,this.left=r??ei.EMPTY,this.right=l??ei.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,l){return new ei(e??this.key,t??this.value,i??this.color,r??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const l=i(e,r.key);return r=l<0?r.copy(null,null,null,r.left.insert(e,t,i),null):l===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ei.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return ei.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ei.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ei.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Xe(27949);return e+(this.isRed()?0:1)}}ei.EMPTY=null,ei.RED=!0,ei.BLACK=!1;ei.EMPTY=new class{constructor(){this.size=0}get key(){throw Xe(57766)}get value(){throw Xe(16141)}get color(){throw Xe(16727)}get left(){throw Xe(29726)}get right(){throw Xe(36894)}copy(e,t,i,r,l){return this}insert(e,t,i){return new ei(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.comparator=e,this.data=new pn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new uE(this.data.getIterator())}getIteratorFrom(e){return new uE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof On)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,l=i.getNext().key;if(this.comparator(r,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new On(this.comparator);return t.data=e,t}}class uE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e){this.fields=e,e.sort(ti.comparator)}static empty(){return new ds([])}unionWith(e){let t=new On(ti.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ds(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return xu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new l1("Invalid base64 string: "+l):l}})(e);return new ni(t)}static fromUint8Array(e){const t=(function(r){let l="";for(let c=0;c<r.length;++c)l+=String.fromCharCode(r[c]);return l})(e);return new ni(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return bt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ni.EMPTY_BYTE_STRING=new ni("");const q3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fa(n){if(qt(!!n,39018),typeof n=="string"){let e=0;const t=q3.exec(n);if(qt(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Sn(n.seconds),nanos:Sn(n.nanos)}}function Sn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ma(n){return typeof n=="string"?ni.fromBase64String(n):ni.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1="server_timestamp",c1="__type__",d1="__previous_value__",h1="__local_write_time__";function r_(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[c1])==null?void 0:i.stringValue)===u1}function xf(n){const e=n.mapValue.fields[d1];return r_(e)?xf(e):e}function Zc(n){const e=fa(n.mapValue.fields[h1].timestampValue);return new ln(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(e,t,i,r,l,c,m,g,p,E){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=m,this.longPollingOptions=g,this.useFetchStreams=p,this.isUsingEmulator=E}}const Kh="(default)";class Yc{constructor(e,t){this.projectId=e,this.database=t||Kh}static empty(){return new Yc("","")}get isDefaultDatabase(){return this.database===Kh}isEqual(e){return e instanceof Yc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1="__type__",G3="__max__",gh={mapValue:{}},m1="__vector__",Zh="value";function pa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?r_(n)?4:K3(n)?9007199254740991:j3(n)?10:11:Xe(28295,{value:n})}function Ro(n,e){if(n===e)return!0;const t=pa(n);if(t!==pa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Zc(n).isEqual(Zc(e));case 3:return(function(r,l){if(typeof r.timestampValue=="string"&&typeof l.timestampValue=="string"&&r.timestampValue.length===l.timestampValue.length)return r.timestampValue===l.timestampValue;const c=fa(r.timestampValue),m=fa(l.timestampValue);return c.seconds===m.seconds&&c.nanos===m.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,l){return ma(r.bytesValue).isEqual(ma(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,l){return Sn(r.geoPointValue.latitude)===Sn(l.geoPointValue.latitude)&&Sn(r.geoPointValue.longitude)===Sn(l.geoPointValue.longitude)})(n,e);case 2:return(function(r,l){if("integerValue"in r&&"integerValue"in l)return Sn(r.integerValue)===Sn(l.integerValue);if("doubleValue"in r&&"doubleValue"in l){const c=Sn(r.doubleValue),m=Sn(l.doubleValue);return c===m?jh(c)===jh(m):isNaN(c)&&isNaN(m)}return!1})(n,e);case 9:return xu(n.arrayValue.values||[],e.arrayValue.values||[],Ro);case 10:case 11:return(function(r,l){const c=r.mapValue.fields||{},m=l.mapValue.fields||{};if(lE(c)!==lE(m))return!1;for(const g in c)if(c.hasOwnProperty(g)&&(m[g]===void 0||!Ro(c[g],m[g])))return!1;return!0})(n,e);default:return Xe(52216,{left:n})}}function Wc(n,e){return(n.values||[]).find((t=>Ro(t,e)))!==void 0}function Eu(n,e){if(n===e)return 0;const t=pa(n),i=pa(e);if(t!==i)return bt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return bt(n.booleanValue,e.booleanValue);case 2:return(function(l,c){const m=Sn(l.integerValue||l.doubleValue),g=Sn(c.integerValue||c.doubleValue);return m<g?-1:m>g?1:m===g?0:isNaN(m)?isNaN(g)?0:-1:1})(n,e);case 3:return cE(n.timestampValue,e.timestampValue);case 4:return cE(Zc(n),Zc(e));case 5:return og(n.stringValue,e.stringValue);case 6:return(function(l,c){const m=ma(l),g=ma(c);return m.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(l,c){const m=l.split("/"),g=c.split("/");for(let p=0;p<m.length&&p<g.length;p++){const E=bt(m[p],g[p]);if(E!==0)return E}return bt(m.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,c){const m=bt(Sn(l.latitude),Sn(c.latitude));return m!==0?m:bt(Sn(l.longitude),Sn(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return dE(n.arrayValue,e.arrayValue);case 10:return(function(l,c){var C,M,z,H;const m=l.fields||{},g=c.fields||{},p=(C=m[Zh])==null?void 0:C.arrayValue,E=(M=g[Zh])==null?void 0:M.arrayValue,S=bt(((z=p==null?void 0:p.values)==null?void 0:z.length)||0,((H=E==null?void 0:E.values)==null?void 0:H.length)||0);return S!==0?S:dE(p,E)})(n.mapValue,e.mapValue);case 11:return(function(l,c){if(l===gh.mapValue&&c===gh.mapValue)return 0;if(l===gh.mapValue)return 1;if(c===gh.mapValue)return-1;const m=l.fields||{},g=Object.keys(m),p=c.fields||{},E=Object.keys(p);g.sort(),E.sort();for(let S=0;S<g.length&&S<E.length;++S){const C=og(g[S],E[S]);if(C!==0)return C;const M=Eu(m[g[S]],p[E[S]]);if(M!==0)return M}return bt(g.length,E.length)})(n.mapValue,e.mapValue);default:throw Xe(23264,{he:t})}}function cE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return bt(n,e);const t=fa(n),i=fa(e),r=bt(t.seconds,i.seconds);return r!==0?r:bt(t.nanos,i.nanos)}function dE(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const l=Eu(t[r],i[r]);if(l)return l}return bt(t.length,i.length)}function wu(n){return rg(n)}function rg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=fa(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ma(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ze.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const l of t.values||[])r?r=!1:i+=",",i+=rg(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",l=!0;for(const c of i)l?l=!1:r+=",",r+=`${c}:${rg(t.fields[c])}`;return r+"}"})(n.mapValue):Xe(61005,{value:n})}function bh(n){switch(pa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=xf(n);return e?16+bh(e):16;case 5:return 2*n.stringValue.length;case 6:return ma(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,l)=>r+bh(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Ta(i.fields,((l,c)=>{r+=l.length+bh(c)})),r})(n.mapValue);default:throw Xe(13486,{value:n})}}function hE(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ag(n){return!!n&&"integerValue"in n}function a_(n){return!!n&&"arrayValue"in n}function fE(n){return!!n&&"nullValue"in n}function mE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ih(n){return!!n&&"mapValue"in n}function j3(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[f1])==null?void 0:i.stringValue)===m1}function Uc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ta(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Uc(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Uc(n.arrayValue.values[t]);return e}return{...n}}function K3(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===G3}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e){this.value=e}static empty(){return new Ki({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ih(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Uc(t)}setAll(e){let t=ti.emptyPath(),i={},r=[];e.forEach(((c,m)=>{if(!t.isImmediateParentOf(m)){const g=this.getFieldsMap(t);this.applyChanges(g,i,r),i={},r=[],t=m.popLast()}c?i[m.lastSegment()]=Uc(c):r.push(m.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,r)}delete(e){const t=this.field(e.popLast());Ih(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ro(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Ih(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ta(t,((r,l)=>e[r]=l));for(const r of i)delete e[r]}clone(){return new Ki(Uc(this.value))}}function p1(n){const e=[];return Ta(n.fields,((t,i)=>{const r=new ti([t]);if(Ih(i)){const l=p1(i.mapValue).fields;if(l.length===0)e.push(r);else for(const c of l)e.push(r.child(c))}else e.push(r)})),new ds(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,t,i,r,l,c,m){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=l,this.data=c,this.documentState=m}static newInvalidDocument(e){return new fi(e,0,st.min(),st.min(),st.min(),Ki.empty(),0)}static newFoundDocument(e,t,i,r){return new fi(e,1,t,st.min(),i,r,0)}static newNoDocument(e,t){return new fi(e,2,t,st.min(),st.min(),Ki.empty(),0)}static newUnknownDocument(e,t){return new fi(e,3,t,st.min(),st.min(),Ki.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(st.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ki.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ki.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=st.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof fi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new fi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,t){this.position=e,this.inclusive=t}}function pE(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const l=e[r],c=n.position[r];if(l.field.isKeyField()?i=Ze.comparator(Ze.fromName(c.referenceValue),t.key):i=Eu(c,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function gE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ro(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,t="asc"){this.field=e,this.dir=t}}function Z3(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{}class kn extends g1{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new W3(e,t,i):t==="array-contains"?new $3(e,i):t==="in"?new X3(e,i):t==="not-in"?new e4(e,i):t==="array-contains-any"?new t4(e,i):new kn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new J3(e,i):new Q3(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Eu(t,this.value)):t!==null&&pa(this.value)===pa(t)&&this.matchesComparison(Eu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $s extends g1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new $s(e,t)}matches(e){return _1(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function _1(n){return n.op==="and"}function y1(n){return Y3(n)&&_1(n)}function Y3(n){for(const e of n.filters)if(e instanceof $s)return!1;return!0}function lg(n){if(n instanceof kn)return n.field.canonicalString()+n.op.toString()+wu(n.value);if(y1(n))return n.filters.map((e=>lg(e))).join(",");{const e=n.filters.map((t=>lg(t))).join(",");return`${n.op}(${e})`}}function v1(n,e){return n instanceof kn?(function(i,r){return r instanceof kn&&i.op===r.op&&i.field.isEqual(r.field)&&Ro(i.value,r.value)})(n,e):n instanceof $s?(function(i,r){return r instanceof $s&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((l,c,m)=>l&&v1(c,r.filters[m])),!0):!1})(n,e):void Xe(19439)}function T1(n){return n instanceof kn?(function(t){return`${t.field.canonicalString()} ${t.op} ${wu(t.value)}`})(n):n instanceof $s?(function(t){return t.op.toString()+" {"+t.getFilters().map(T1).join(" ,")+"}"})(n):"Filter"}class W3 extends kn{constructor(e,t,i){super(e,t,i),this.key=Ze.fromName(i.referenceValue)}matches(e){const t=Ze.comparator(e.key,this.key);return this.matchesComparison(t)}}class J3 extends kn{constructor(e,t){super(e,"in",t),this.keys=x1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Q3 extends kn{constructor(e,t){super(e,"not-in",t),this.keys=x1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function x1(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Ze.fromName(i.referenceValue)))}class $3 extends kn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return a_(t)&&Wc(t.arrayValue,this.value)}}class X3 extends kn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Wc(this.value.arrayValue,t)}}class e4 extends kn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Wc(this.value.arrayValue,t)}}class t4 extends kn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!a_(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Wc(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(e,t=null,i=[],r=[],l=null,c=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=l,this.startAt=c,this.endAt=m,this.Te=null}}function _E(n,e=null,t=[],i=[],r=null,l=null,c=null){return new n4(n,e,t,i,r,l,c)}function l_(n){const e=rt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>lg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),Tf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>wu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>wu(i))).join(",")),e.Te=t}return e.Te}function u_(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Z3(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!v1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!gE(n.startAt,e.startAt)&&gE(n.endAt,e.endAt)}function ug(n){return Ze.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,t=null,i=[],r=[],l=null,c="F",m=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=l,this.limitType=c,this.startAt=m,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function i4(n,e,t,i,r,l,c,m){return new id(n,e,t,i,r,l,c,m)}function c_(n){return new id(n)}function yE(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function E1(n){return n.collectionGroup!==null}function zc(n){const e=rt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let m=new On(ti.comparator);return c.filters.forEach((g=>{g.getFlattenedFilters().forEach((p=>{p.isInequality()&&(m=m.add(p.field))}))})),m})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Wh(l,i))})),t.has(ti.keyField().canonicalString())||e.Ie.push(new Wh(ti.keyField(),i))}return e.Ie}function Ao(n){const e=rt(n);return e.Ee||(e.Ee=s4(e,zc(n))),e.Ee}function s4(n,e){if(n.limitType==="F")return _E(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const l=r.dir==="desc"?"asc":"desc";return new Wh(r.field,l)}));const t=n.endAt?new Yh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Yh(n.startAt.position,n.startAt.inclusive):null;return _E(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function cg(n,e){const t=n.filters.concat([e]);return new id(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function dg(n,e,t){return new id(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ef(n,e){return u_(Ao(n),Ao(e))&&n.limitType===e.limitType}function w1(n){return`${l_(Ao(n))}|lt:${n.limitType}`}function ou(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>T1(r))).join(", ")}]`),Tf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>wu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>wu(r))).join(",")),`Target(${i})`})(Ao(n))}; limitType=${n.limitType})`}function wf(n,e){return e.isFoundDocument()&&(function(i,r){const l=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Ze.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,e)&&(function(i,r){for(const l of zc(i))if(!l.field.isKeyField()&&r.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const l of i.filters)if(!l.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(c,m,g){const p=pE(c,m,g);return c.inclusive?p<=0:p<0})(i.startAt,zc(i),r)||i.endAt&&!(function(c,m,g){const p=pE(c,m,g);return c.inclusive?p>=0:p>0})(i.endAt,zc(i),r))})(n,e)}function o4(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function S1(n){return(e,t)=>{let i=!1;for(const r of zc(n)){const l=r4(r,e,t);if(l!==0)return l;i=i||r.field.isKeyField()}return 0}}function r4(n,e,t){const i=n.field.isKeyField()?Ze.comparator(e.key,t.key):(function(l,c,m){const g=c.data.field(l),p=m.data.field(l);return g!==null&&p!==null?Eu(g,p):Xe(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Xe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,l]of i)if(this.equalsFn(r,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<r.length;l++)if(this.equalsFn(r[l][0],e))return void(r[l]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ta(this.inner,((t,i)=>{for(const[r,l]of i)e(r,l)}))}isEmpty(){return a1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4=new pn(Ze.comparator);function dr(){return a4}const A1=new pn(Ze.comparator);function Mc(...n){let e=A1;for(const t of n)e=e.insert(t.key,t);return e}function C1(n){let e=A1;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function rl(){return Bc()}function b1(){return Bc()}function Bc(){return new gl((n=>n.toString()),((n,e)=>n.isEqual(e)))}const l4=new pn(Ze.comparator),u4=new On(Ze.comparator);function It(...n){let e=u4;for(const t of n)e=e.add(t);return e}const c4=new On(bt);function d4(){return c4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:jh(e)?"-0":e}}function I1(n){return{integerValue:""+n}}function h4(n,e){return z3(e)?I1(e):d_(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(){this._=void 0}}function f4(n,e,t){return n instanceof Jc?(function(r,l){const c={fields:{[c1]:{stringValue:u1},[h1]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return l&&r_(l)&&(l=xf(l)),l&&(c.fields[d1]=l),{mapValue:c}})(t,e):n instanceof Su?R1(n,e):n instanceof Au?M1(n,e):(function(r,l){const c=N1(r,l),m=vE(c)+vE(r.Ae);return ag(c)&&ag(r.Ae)?I1(m):d_(r.serializer,m)})(n,e)}function m4(n,e,t){return n instanceof Su?R1(n,e):n instanceof Au?M1(n,e):t}function N1(n,e){return n instanceof Jh?(function(i){return ag(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Jc extends Sf{}class Su extends Sf{constructor(e){super(),this.elements=e}}function R1(n,e){const t=P1(e);for(const i of n.elements)t.some((r=>Ro(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Au extends Sf{constructor(e){super(),this.elements=e}}function M1(n,e){let t=P1(e);for(const i of n.elements)t=t.filter((r=>!Ro(r,i)));return{arrayValue:{values:t}}}class Jh extends Sf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function vE(n){return Sn(n.integerValue||n.doubleValue)}function P1(n){return a_(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,t){this.field=e,this.transform=t}}function p4(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Su&&r instanceof Su||i instanceof Au&&r instanceof Au?xu(i.elements,r.elements,Ro):i instanceof Jh&&r instanceof Jh?Ro(i.Ae,r.Ae):i instanceof Jc&&r instanceof Jc})(n.transform,e.transform)}class g4{constructor(e,t){this.version=e,this.transformResults=t}}class ks{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ks}static exists(e){return new ks(void 0,e)}static updateTime(e){return new ks(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Af{}function k1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new f_(n.key,ks.none()):new sd(n.key,n.data,ks.none());{const t=n.data,i=Ki.empty();let r=new On(ti.comparator);for(let l of e.fields)if(!r.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?i.delete(l):i.set(l,c),r=r.add(l)}return new xa(n.key,i,new ds(r.toArray()),ks.none())}}function _4(n,e,t){n instanceof sd?(function(r,l,c){const m=r.value.clone(),g=xE(r.fieldTransforms,l,c.transformResults);m.setAll(g),l.convertToFoundDocument(c.version,m).setHasCommittedMutations()})(n,e,t):n instanceof xa?(function(r,l,c){if(!Nh(r.precondition,l))return void l.convertToUnknownDocument(c.version);const m=xE(r.fieldTransforms,l,c.transformResults),g=l.data;g.setAll(D1(r)),g.setAll(m),l.convertToFoundDocument(c.version,g).setHasCommittedMutations()})(n,e,t):(function(r,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Fc(n,e,t,i){return n instanceof sd?(function(l,c,m,g){if(!Nh(l.precondition,c))return m;const p=l.value.clone(),E=EE(l.fieldTransforms,g,c);return p.setAll(E),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof xa?(function(l,c,m,g){if(!Nh(l.precondition,c))return m;const p=EE(l.fieldTransforms,g,c),E=c.data;return E.setAll(D1(l)),E.setAll(p),c.convertToFoundDocument(c.version,E).setHasLocalMutations(),m===null?null:m.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((S=>S.field)))})(n,e,t,i):(function(l,c,m){return Nh(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):m})(n,e,t)}function y4(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),l=N1(i.transform,r||null);l!=null&&(t===null&&(t=Ki.empty()),t.set(i.field,l))}return t||null}function TE(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&xu(i,r,((l,c)=>p4(l,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class sd extends Af{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class xa extends Af{constructor(e,t,i,r,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function D1(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function xE(n,e,t){const i=new Map;qt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const l=n[r],c=l.transform,m=e.data.field(l.field);i.set(l.field,m4(c,m,t[r]))}return i}function EE(n,e,t){const i=new Map;for(const r of n){const l=r.transform,c=t.data.field(r.field);i.set(r.field,f4(l,c,e))}return i}class f_ extends Af{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class v4 extends Af{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const l=this.mutations[r];l.key.isEqual(e.key)&&_4(l,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Fc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Fc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=b1();return this.mutations.forEach((r=>{const l=e.get(r.key),c=l.overlayedDocument;let m=this.applyToLocalView(c,l.mutatedFields);m=t.has(r.key)?null:m;const g=k1(c,m);g!==null&&i.set(r.key,g),c.isValidDocument()||c.convertToNoDocument(st.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),It())}isEqual(e){return this.batchId===e.batchId&&xu(this.mutations,e.mutations,((t,i)=>TE(t,i)))&&xu(this.baseMutations,e.baseMutations,((t,i)=>TE(t,i)))}}class m_{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){qt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return l4})();const l=e.mutations;for(let c=0;c<l.length;c++)r=r.insert(l[c].key,i[c].version);return new m_(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E4{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pn,kt;function w4(n){switch(n){case Ee.OK:return Xe(64938);case Ee.CANCELLED:case Ee.UNKNOWN:case Ee.DEADLINE_EXCEEDED:case Ee.RESOURCE_EXHAUSTED:case Ee.INTERNAL:case Ee.UNAVAILABLE:case Ee.UNAUTHENTICATED:return!1;case Ee.INVALID_ARGUMENT:case Ee.NOT_FOUND:case Ee.ALREADY_EXISTS:case Ee.PERMISSION_DENIED:case Ee.FAILED_PRECONDITION:case Ee.ABORTED:case Ee.OUT_OF_RANGE:case Ee.UNIMPLEMENTED:case Ee.DATA_LOSS:return!0;default:return Xe(15467,{code:n})}}function L1(n){if(n===void 0)return cr("GRPC error has no .code"),Ee.UNKNOWN;switch(n){case Pn.OK:return Ee.OK;case Pn.CANCELLED:return Ee.CANCELLED;case Pn.UNKNOWN:return Ee.UNKNOWN;case Pn.DEADLINE_EXCEEDED:return Ee.DEADLINE_EXCEEDED;case Pn.RESOURCE_EXHAUSTED:return Ee.RESOURCE_EXHAUSTED;case Pn.INTERNAL:return Ee.INTERNAL;case Pn.UNAVAILABLE:return Ee.UNAVAILABLE;case Pn.UNAUTHENTICATED:return Ee.UNAUTHENTICATED;case Pn.INVALID_ARGUMENT:return Ee.INVALID_ARGUMENT;case Pn.NOT_FOUND:return Ee.NOT_FOUND;case Pn.ALREADY_EXISTS:return Ee.ALREADY_EXISTS;case Pn.PERMISSION_DENIED:return Ee.PERMISSION_DENIED;case Pn.FAILED_PRECONDITION:return Ee.FAILED_PRECONDITION;case Pn.ABORTED:return Ee.ABORTED;case Pn.OUT_OF_RANGE:return Ee.OUT_OF_RANGE;case Pn.UNIMPLEMENTED:return Ee.UNIMPLEMENTED;case Pn.DATA_LOSS:return Ee.DATA_LOSS;default:return Xe(39323,{code:n})}}(kt=Pn||(Pn={}))[kt.OK=0]="OK",kt[kt.CANCELLED=1]="CANCELLED",kt[kt.UNKNOWN=2]="UNKNOWN",kt[kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kt[kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kt[kt.NOT_FOUND=5]="NOT_FOUND",kt[kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",kt[kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",kt[kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",kt[kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kt[kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kt[kt.ABORTED=10]="ABORTED",kt[kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",kt[kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",kt[kt.INTERNAL=13]="INTERNAL",kt[kt.UNAVAILABLE=14]="UNAVAILABLE",kt[kt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4=new la([4294967295,4294967295],0);function wE(n){const e=S4().encode(n),t=new JS;return t.update(e),new Uint8Array(t.digest())}function SE(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new la([t,i],0),new la([r,l],0)]}class p_{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Pc(`Invalid padding: ${t}`);if(i<0)throw new Pc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Pc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Pc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=la.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(la.fromNumber(i)));return r.compare(A4)===1&&(r=new la([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=wE(e),[i,r]=SE(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,r,l);if(!this.we(c))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new p_(l,r,t);return i.forEach((m=>c.insert(m))),c}insert(e){if(this.ge===0)return;const t=wE(e),[i,r]=SE(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,r,l);this.Se(c)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Pc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,t,i,r,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,od.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Cf(st.min(),r,new pn(bt),dr(),It())}}class od{constructor(e,t,i,r,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new od(i,t,It(),It(),It())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,t,i,r){this.be=e,this.removedTargetIds=t,this.key=i,this.De=r}}class V1{constructor(e,t){this.targetId=e,this.Ce=t}}class O1{constructor(e,t,i=ni.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class AE{constructor(){this.ve=0,this.Fe=CE(),this.Me=ni.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=It(),t=It(),i=It();return this.Fe.forEach(((r,l)=>{switch(l){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Xe(38017,{changeType:l})}})),new od(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=CE()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,qt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class C4{constructor(e){this.Ge=e,this.ze=new Map,this.je=dr(),this.Je=_h(),this.He=_h(),this.Ye=new pn(bt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Xe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const l=r.target;if(ug(l))if(i===0){const c=new Ze(l.path);this.et(t,c,fi.newNoDocument(c,st.min()))}else qt(i===1,20013,{expectedCount:i});else{const c=this._t(t);if(c!==i){const m=this.ut(e),g=m?this.ct(m,e,c):1;if(g!==0){this.it(t);const p=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:l=0}=t;let c,m;try{c=ma(i).toUint8Array()}catch(g){if(g instanceof l1)return Tu("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{m=new p_(c,r,l)}catch(g){return Tu(g instanceof Pc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return m.ge===0?null:m}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((l=>{const c=this.Ge.ht(),m=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(m)||(this.et(t,l,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((l,c)=>{const m=this.ot(c);if(m){if(l.current&&ug(m.target)){const g=new Ze(m.target.path);this.It(g).has(c)||this.Et(c,g)||this.et(c,g,fi.newNoDocument(g,e))}l.Be&&(t.set(c,l.ke()),l.qe())}}));let i=It();this.He.forEach(((l,c)=>{let m=!0;c.forEachWhile((g=>{const p=this.ot(g);return!p||p.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const r=new Cf(e,t,this.Ye,this.je,i);return this.je=dr(),this.Je=_h(),this.He=_h(),this.Ye=new pn(bt),r}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new AE,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new On(bt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new On(bt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new AE),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function _h(){return new pn(Ze.comparator)}function CE(){return new pn(Ze.comparator)}const b4={asc:"ASCENDING",desc:"DESCENDING"},I4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},N4={and:"AND",or:"OR"};class R4{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function hg(n,e){return n.useProto3Json||Tf(e)?e:{value:e}}function Qh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function U1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function M4(n,e){return Qh(n,e.toTimestamp())}function Co(n){return qt(!!n,49232),st.fromTimestamp((function(t){const i=fa(t);return new ln(i.seconds,i.nanos)})(n))}function g_(n,e){return fg(n,e).canonicalString()}function fg(n,e){const t=(function(r){return new tn(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function z1(n){const e=tn.fromString(n);return qt(G1(e),10190,{key:e.toString()}),e}function mg(n,e){return g_(n.databaseId,e.path)}function Dp(n,e){const t=z1(e);if(t.get(1)!==n.databaseId.projectId)throw new Ve(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ve(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ze(F1(t))}function B1(n,e){return g_(n.databaseId,e)}function P4(n){const e=z1(n);return e.length===4?tn.emptyPath():F1(e)}function pg(n){return new tn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function F1(n){return qt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function bE(n,e,t){return{name:mg(n,e),fields:t.value.mapValue.fields}}function k4(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Xe(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],l=(function(p,E){return p.useProto3Json?(qt(E===void 0||typeof E=="string",58123),ni.fromBase64String(E||"")):(qt(E===void 0||E instanceof Buffer||E instanceof Uint8Array,16193),ni.fromUint8Array(E||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,m=c&&(function(p){const E=p.code===void 0?Ee.UNKNOWN:L1(p.code);return new Ve(E,p.message||"")})(c);t=new O1(i,r,l,m||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Dp(n,i.document.name),l=Co(i.document.updateTime),c=i.document.createTime?Co(i.document.createTime):st.min(),m=new Ki({mapValue:{fields:i.document.fields}}),g=fi.newFoundDocument(r,l,c,m),p=i.targetIds||[],E=i.removedTargetIds||[];t=new Rh(p,E,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Dp(n,i.document),l=i.readTime?Co(i.readTime):st.min(),c=fi.newNoDocument(r,l),m=i.removedTargetIds||[];t=new Rh([],m,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Dp(n,i.document),l=i.removedTargetIds||[];t=new Rh([],l,r,null)}else{if(!("filter"in e))return Xe(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:l}=i,c=new E4(r,l),m=i.targetId;t=new V1(m,c)}}return t}function D4(n,e){let t;if(e instanceof sd)t={update:bE(n,e.key,e.value)};else if(e instanceof f_)t={delete:mg(n,e.key)};else if(e instanceof xa)t={update:bE(n,e.key,e.data),updateMask:H4(e.fieldMask)};else{if(!(e instanceof v4))return Xe(16599,{Vt:e.type});t={verify:mg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const m=c.transform;if(m instanceof Jc)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Su)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Au)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof Jh)return{fieldPath:c.field.canonicalString(),increment:m.Ae};throw Xe(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,l){return l.updateTime!==void 0?{updateTime:M4(r,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Xe(27497)})(n,e.precondition)),t}function L4(n,e){return n&&n.length>0?(qt(e!==void 0,14353),n.map((t=>(function(r,l){let c=r.updateTime?Co(r.updateTime):Co(l);return c.isEqual(st.min())&&(c=Co(l)),new g4(c,r.transformResults||[])})(t,e)))):[]}function V4(n,e){return{documents:[B1(n,e.path)]}}function O4(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=B1(n,r);const l=(function(p){if(p.length!==0)return H1($s.create(p,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(p){if(p.length!==0)return p.map((E=>(function(C){return{field:ru(C.field),direction:B4(C.dir)}})(E)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const m=hg(n,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:r}}function U4(n){let e=P4(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){qt(i===1,65062);const E=t.from[0];E.allDescendants?r=E.collectionId:e=e.child(E.collectionId)}let l=[];t.where&&(l=(function(S){const C=q1(S);return C instanceof $s&&y1(C)?C.getFilters():[C]})(t.where));let c=[];t.orderBy&&(c=(function(S){return S.map((C=>(function(z){return new Wh(au(z.field),(function(Y){switch(Y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(z.direction))})(C)))})(t.orderBy));let m=null;t.limit&&(m=(function(S){let C;return C=typeof S=="object"?S.value:S,Tf(C)?null:C})(t.limit));let g=null;t.startAt&&(g=(function(S){const C=!!S.before,M=S.values||[];return new Yh(M,C)})(t.startAt));let p=null;return t.endAt&&(p=(function(S){const C=!S.before,M=S.values||[];return new Yh(M,C)})(t.endAt)),i4(e,r,c,l,m,"F",g,p)}function z4(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Xe(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function q1(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=au(t.unaryFilter.field);return kn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=au(t.unaryFilter.field);return kn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=au(t.unaryFilter.field);return kn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=au(t.unaryFilter.field);return kn.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Xe(61313);default:return Xe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return kn.create(au(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Xe(58110);default:return Xe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return $s.create(t.compositeFilter.filters.map((i=>q1(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Xe(1026)}})(t.compositeFilter.op))})(n):Xe(30097,{filter:n})}function B4(n){return b4[n]}function F4(n){return I4[n]}function q4(n){return N4[n]}function ru(n){return{fieldPath:n.canonicalString()}}function au(n){return ti.fromServerFormat(n.fieldPath)}function H1(n){return n instanceof kn?(function(t){if(t.op==="=="){if(mE(t.value))return{unaryFilter:{field:ru(t.field),op:"IS_NAN"}};if(fE(t.value))return{unaryFilter:{field:ru(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(mE(t.value))return{unaryFilter:{field:ru(t.field),op:"IS_NOT_NAN"}};if(fE(t.value))return{unaryFilter:{field:ru(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ru(t.field),op:F4(t.op),value:t.value}}})(n):n instanceof $s?(function(t){const i=t.getFilters().map((r=>H1(r)));return i.length===1?i[0]:{compositeFilter:{op:q4(t.op),filters:i}}})(n):Xe(54877,{filter:n})}function H4(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function G1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,t,i,r,l=st.min(),c=st.min(),m=ni.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=m,this.expectedCount=g}withSequenceNumber(e){return new ia(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(e){this.yt=e}}function j4(n){const e=U4({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?dg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(){this.Cn=new Z4}addToCollectionParentIndex(e,t){return this.Cn.add(t),we.resolve()}getCollectionParents(e,t){return we.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return we.resolve()}deleteFieldIndex(e,t){return we.resolve()}deleteAllFieldIndexes(e){return we.resolve()}createTargetIndexes(e,t){return we.resolve()}getDocumentsMatchingTarget(e,t){return we.resolve(null)}getIndexType(e,t){return we.resolve(0)}getFieldIndexes(e,t){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,t){return we.resolve(ha.min())}getMinOffsetFromCollectionGroup(e,t){return we.resolve(ha.min())}updateCollectionGroup(e,t,i){return we.resolve()}updateIndexEntries(e,t){return we.resolve()}}class Z4{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new On(tn.comparator),l=!r.has(i);return this.index[t]=r.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new On(tn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},j1=41943040;class ji{static withCacheSize(e){return new ji(e,ji.DEFAULT_COLLECTION_PERCENTILE,ji.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ji.DEFAULT_COLLECTION_PERCENTILE=10,ji.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ji.DEFAULT=new ji(j1,ji.DEFAULT_COLLECTION_PERCENTILE,ji.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ji.DISABLED=new ji(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Cu(0)}static cr(){return new Cu(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NE="LruGarbageCollector",Y4=1048576;function RE([n,e],[t,i]){const r=bt(n,t);return r===0?bt(e,i):r}class W4{constructor(e){this.Ir=e,this.buffer=new On(RE),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();RE(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class J4{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Oe(NE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ou(t)?Oe(NE,"Ignoring IndexedDB error during garbage collection: ",t):await Vu(t)}await this.Vr(3e5)}))}}class Q4{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return we.resolve(vf.ce);const i=new W4(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Oe("LruGarbageCollector","Garbage collection skipped; disabled"),we.resolve(IE)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),IE):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,l,c,m,g,p;const E=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((S=>(S>this.params.maximumSequenceNumbersToCollect?(Oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),r=this.params.maximumSequenceNumbersToCollect):r=S,c=Date.now(),this.nthSequenceNumber(e,r)))).next((S=>(i=S,m=Date.now(),this.removeTargets(e,i,t)))).next((S=>(l=S,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((S=>(p=Date.now(),su()<=Ct.DEBUG&&Oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-E}ms
	Determined least recently used ${r} in `+(m-c)+`ms
	Removed ${l} targets in `+(g-m)+`ms
	Removed ${S} documents in `+(p-g)+`ms
Total Duration: ${p-E}ms`),we.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:l,documentsRemoved:S}))))}}function $4(n,e){return new Q4(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(){this.changes=new gl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,fi.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?we.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&Fc(i.mutation,r,ds.empty(),ln.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,It()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=It()){const r=rl();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((l=>{let c=Mc();return l.forEach(((m,g)=>{c=c.insert(m,g.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=rl();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,It())))}populateOverlays(e,t,i){const r=[];return i.forEach((l=>{t.has(l)||r.push(l)})),this.documentOverlayCache.getOverlays(e,r).next((l=>{l.forEach(((c,m)=>{t.set(c,m)}))}))}computeViews(e,t,i,r){let l=dr();const c=Bc(),m=(function(){return Bc()})();return t.forEach(((g,p)=>{const E=i.get(p.key);r.has(p.key)&&(E===void 0||E.mutation instanceof xa)?l=l.insert(p.key,p):E!==void 0?(c.set(p.key,E.mutation.getFieldMask()),Fc(E.mutation,p,E.mutation.getFieldMask(),ln.now())):c.set(p.key,ds.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((p,E)=>c.set(p,E))),t.forEach(((p,E)=>m.set(p,new e6(E,c.get(p)??null)))),m)))}recalculateAndSaveOverlays(e,t){const i=Bc();let r=new pn(((c,m)=>c-m)),l=It();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const m of c)m.keys().forEach((g=>{const p=t.get(g);if(p===null)return;let E=i.get(g)||ds.empty();E=m.applyToLocalView(p,E),i.set(g,E);const S=(r.get(m.batchId)||It()).add(g);r=r.insert(m.batchId,S)}))})).next((()=>{const c=[],m=r.getReverseIterator();for(;m.hasNext();){const g=m.getNext(),p=g.key,E=g.value,S=b1();E.forEach((C=>{if(!l.has(C)){const M=k1(t.get(C),i.get(C));M!==null&&S.set(C,M),l=l.add(C)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,S))}return we.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(c){return Ze.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):E1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((l=>{const c=r-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-l.size):we.resolve(rl());let m=Kc,g=l;return c.next((p=>we.forEach(p,((E,S)=>(m<S.largestBatchId&&(m=S.largestBatchId),l.get(E)?we.resolve():this.remoteDocumentCache.getEntry(e,E).next((C=>{g=g.insert(E,C)}))))).next((()=>this.populateOverlays(e,p,l))).next((()=>this.computeViews(e,g,p,It()))).next((E=>({batchId:m,changes:C1(E)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ze(t)).next((i=>{let r=Mc();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const l=t.collectionGroup;let c=Mc();return this.indexManager.getCollectionParents(e,l).next((m=>we.forEach(m,(g=>{const p=(function(S,C){return new id(C,null,S.explicitOrderBy.slice(),S.filters.slice(),S.limit,S.limitType,S.startAt,S.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,p,i,r).next((E=>{E.forEach(((S,C)=>{c=c.insert(S,C)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,r)))).next((c=>{l.forEach(((g,p)=>{const E=p.getKey();c.get(E)===null&&(c=c.insert(E,fi.newInvalidDocument(E)))}));let m=Mc();return c.forEach(((g,p)=>{const E=l.get(g);E!==void 0&&Fc(E.mutation,p,ds.empty(),ln.now()),wf(t,p)&&(m=m.insert(g,p))})),m}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return we.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Co(r.createTime)}})(t)),we.resolve()}getNamedQuery(e,t){return we.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:j4(r.bundledQuery),readTime:Co(r.readTime)}})(t)),we.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(){this.overlays=new pn(Ze.comparator),this.qr=new Map}getOverlay(e,t){return we.resolve(this.overlays.get(t))}getOverlays(e,t){const i=rl();return we.forEach(t,(r=>this.getOverlay(e,r).next((l=>{l!==null&&i.set(r,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,l)=>{this.St(e,t,l)})),we.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),we.resolve()}getOverlaysForCollection(e,t,i){const r=rl(),l=t.length+1,c=new Ze(t.child("")),m=this.overlays.getIteratorFrom(c);for(;m.hasNext();){const g=m.getNext().value,p=g.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===l&&g.largestBatchId>i&&r.set(g.getKey(),g)}return we.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let l=new pn(((p,E)=>p-E));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let E=l.get(p.largestBatchId);E===null&&(E=rl(),l=l.insert(p.largestBatchId,E)),E.set(p.getKey(),p)}}const m=rl(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((p,E)=>m.set(p,E))),!(m.size()>=r)););return we.resolve(m)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const c=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new x4(t,i));let l=this.qr.get(t);l===void 0&&(l=It(),this.qr.set(t,l)),this.qr.set(t,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(){this.sessionToken=ni.EMPTY_BYTE_STRING}getSessionToken(e){return we.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,we.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(){this.Qr=new On(Yn.$r),this.Ur=new On(Yn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new Yn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new Yn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ze(new tn([])),i=new Yn(t,e),r=new Yn(t,e+1),l=[];return this.Ur.forEachInRange([i,r],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ze(new tn([])),i=new Yn(t,e),r=new Yn(t,e+1);let l=It();return this.Ur.forEachInRange([i,r],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new Yn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Yn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ze.comparator(e.key,t.key)||bt(e.Yr,t.Yr)}static Kr(e,t){return bt(e.Yr,t.Yr)||Ze.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new On(Yn.$r)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new T4(l,t,i,r);this.mutationQueue.push(c);for(const m of r)this.Zr=this.Zr.add(new Yn(m.key,l)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return we.resolve(c)}lookupMutationBatch(e,t){return we.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),l=r<0?0:r;return we.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?o_:this.tr-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Yn(t,0),r=new Yn(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,r],(c=>{const m=this.Xr(c.Yr);l.push(m)})),we.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new On(bt);return t.forEach((r=>{const l=new Yn(r,0),c=new Yn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(m=>{i=i.add(m.Yr)}))})),we.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let l=i;Ze.isDocumentKey(l)||(l=l.child(""));const c=new Yn(new Ze(l),0);let m=new On(bt);return this.Zr.forEachWhile((g=>{const p=g.key.path;return!!i.isPrefixOf(p)&&(p.length===r&&(m=m.add(g.Yr)),!0)}),c),we.resolve(this.ti(m))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){qt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return we.forEach(t.mutations,(r=>{const l=new Yn(r.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new Yn(t,0),r=this.Zr.firstAfterOrEqual(i);return we.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(e){this.ri=e,this.docs=(function(){return new pn(Ze.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),l=r?r.size:0,c=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return we.resolve(i?i.document.mutableCopy():fi.newInvalidDocument(t))}getEntries(e,t){let i=dr();return t.forEach((r=>{const l=this.docs.get(r);i=i.insert(r,l?l.document.mutableCopy():fi.newInvalidDocument(r))})),we.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let l=dr();const c=t.path,m=new Ze(c.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(m);for(;g.hasNext();){const{key:p,value:{document:E}}=g.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||L3(D3(E),i)<=0||(r.has(E.key)||wf(t,E))&&(l=l.insert(E.key,E.mutableCopy()))}return we.resolve(l)}getAllFromCollectionGroup(e,t,i,r){Xe(9500)}ii(e,t){return we.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new a6(this)}getSize(e){return we.resolve(this.size)}}class a6 extends X4{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),we.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(e){this.persistence=e,this.si=new gl((t=>l_(t)),u_),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this.oi=0,this._i=new __,this.targetCount=0,this.ai=Cu.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),we.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Cu(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,we.resolve()}updateTargetData(e,t){return this.Pr(t),we.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,t,i){let r=0;const l=[];return this.si.forEach(((c,m)=>{m.sequenceNumber<=t&&i.get(m.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,m.targetId)),r++)})),we.waitFor(l).next((()=>r))}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return we.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),we.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,l=[];return r&&t.forEach((c=>{l.push(r.markPotentiallyOrphaned(e,c))})),we.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),we.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return we.resolve(i)}containsKey(e,t){return we.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(e,t){this.ui={},this.overlays={},this.ci=new vf(0),this.li=!1,this.li=!0,this.hi=new s6,this.referenceDelegate=e(this),this.Pi=new l6(this),this.indexManager=new K4,this.remoteDocumentCache=(function(r){return new r6(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new G4(t),this.Ii=new n6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new i6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new o6(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){Oe("MemoryPersistence","Starting transaction:",e);const r=new u6(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((l=>this.referenceDelegate.di(r).next((()=>l)))).toPromise().then((l=>(r.raiseOnCommittedEvent(),l)))}Ai(e,t){return we.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class u6 extends O3{constructor(e){super(),this.currentSequenceNumber=e}}class y_{constructor(e){this.persistence=e,this.Ri=new __,this.Vi=null}static mi(e){return new y_(e)}get fi(){if(this.Vi)return this.Vi;throw Xe(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),we.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),we.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),we.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.fi,(i=>{const r=Ze.fromPath(i);return this.gi(e,r).next((l=>{l||t.removeEntry(r,st.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return we.or([()=>we.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class $h{constructor(e,t){this.persistence=e,this.pi=new gl((i=>B3(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=$4(this,t)}static mi(e,t){return new $h(e,t)}Ei(){}di(e){return we.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return we.forEach(this.pi,((i,r)=>this.br(e,i,r).next((l=>l?we.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),l=r.newChangeBuffer();return r.ii(e,(c=>this.br(e,c,t).next((m=>{m||(i++,l.removeEntry(c,st.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),we.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),we.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),we.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),we.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=bh(e.data.value)),t}br(e,t,i){return we.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return we.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=It(),r=It();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:r=r.add(l.doc.key)}return new v_(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return tk()?8:U3(gi())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const l={result:null};return this.ys(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,t,r,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new c6;return this.Ss(e,t,c).next((m=>{if(l.result=m,this.Vs)return this.bs(e,t,c,m.size)}))})).next((()=>l.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(su()<=Ct.DEBUG&&Oe("QueryEngine","SDK will not create cache indexes for query:",ou(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),we.resolve()):(su()<=Ct.DEBUG&&Oe("QueryEngine","Query:",ou(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(su()<=Ct.DEBUG&&Oe("QueryEngine","The SDK decides to create cache indexes for query:",ou(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ao(t))):we.resolve())}ys(e,t){if(yE(t))return we.resolve(null);let i=Ao(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=dg(t,null,"F"),i=Ao(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=It(...l);return this.ps.getDocuments(e,c).next((m=>this.indexManager.getMinOffset(e,i).next((g=>{const p=this.Ds(t,m);return this.Cs(t,p,c,g.readTime)?this.ys(e,dg(t,null,"F")):this.vs(e,p,t,g)}))))})))))}ws(e,t,i,r){return yE(t)||r.isEqual(st.min())?we.resolve(null):this.ps.getDocuments(e,i).next((l=>{const c=this.Ds(t,l);return this.Cs(t,c,i,r)?we.resolve(null):(su()<=Ct.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ou(t)),this.vs(e,c,t,k3(r,Kc)).next((m=>m)))}))}Ds(e,t){let i=new On(S1(e));return t.forEach(((r,l)=>{wf(e,l)&&(i=i.add(l))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(r)>0)}Ss(e,t,i){return su()<=Ct.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",ou(t)),this.ps.getDocumentsMatchingQuery(e,t,ha.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_="LocalStore",h6=3e8;class f6{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new pn(bt),this.xs=new gl((l=>l_(l)),u_),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new t6(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function m6(n,e,t,i){return new f6(n,e,t,i)}async function Z1(n,e){const t=rt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((l=>(r=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],m=[];let g=It();for(const p of r){c.push(p.batchId);for(const E of p.mutations)g=g.add(E.key)}for(const p of l){m.push(p.batchId);for(const E of p.mutations)g=g.add(E.key)}return t.localDocuments.getDocuments(i,g).next((p=>({Ls:p,removedBatchIds:c,addedBatchIds:m})))}))}))}function p6(n,e){const t=rt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(m,g,p,E){const S=p.batch,C=S.keys();let M=we.resolve();return C.forEach((z=>{M=M.next((()=>E.getEntry(g,z))).next((H=>{const Y=p.docVersions.get(z);qt(Y!==null,48541),H.version.compareTo(Y)<0&&(S.applyToRemoteDocument(H,p),H.isValidDocument()&&(H.setReadTime(p.commitVersion),E.addEntry(H)))}))})),M.next((()=>m.mutationQueue.removeMutationBatch(g,S)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(m){let g=It();for(let p=0;p<m.mutationResults.length;++p)m.mutationResults[p].transformResults.length>0&&(g=g.add(m.batch.mutations[p].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function Y1(n){const e=rt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function g6(n,e){const t=rt(n),i=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const m=[];e.targetChanges.forEach(((E,S)=>{const C=r.get(S);if(!C)return;m.push(t.Pi.removeMatchingKeys(l,E.removedDocuments,S).next((()=>t.Pi.addMatchingKeys(l,E.addedDocuments,S))));let M=C.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(S)!==null?M=M.withResumeToken(ni.EMPTY_BYTE_STRING,st.min()).withLastLimboFreeSnapshotVersion(st.min()):E.resumeToken.approximateByteSize()>0&&(M=M.withResumeToken(E.resumeToken,i)),r=r.insert(S,M),(function(H,Y,te){return H.resumeToken.approximateByteSize()===0||Y.snapshotVersion.toMicroseconds()-H.snapshotVersion.toMicroseconds()>=h6?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(C,M,E)&&m.push(t.Pi.updateTargetData(l,M))}));let g=dr(),p=It();if(e.documentUpdates.forEach((E=>{e.resolvedLimboDocuments.has(E)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(l,E))})),m.push(_6(l,c,e.documentUpdates).next((E=>{g=E.ks,p=E.qs}))),!i.isEqual(st.min())){const E=t.Pi.getLastRemoteSnapshotVersion(l).next((S=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));m.push(E)}return we.waitFor(m).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,p))).next((()=>g))})).then((l=>(t.Ms=r,l)))}function _6(n,e,t){let i=It(),r=It();return t.forEach((l=>i=i.add(l))),e.getEntries(n,i).next((l=>{let c=dr();return t.forEach(((m,g)=>{const p=l.get(m);g.isFoundDocument()!==p.isFoundDocument()&&(r=r.add(m)),g.isNoDocument()&&g.version.isEqual(st.min())?(e.removeEntry(m,g.readTime),c=c.insert(m,g)):!p.isValidDocument()||g.version.compareTo(p.version)>0||g.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(g),c=c.insert(m,g)):Oe(T_,"Ignoring outdated watch update for ",m,". Current version:",p.version," Watch version:",g.version)})),{ks:c,qs:r}}))}function y6(n,e){const t=rt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=o_),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function v6(n,e){const t=rt(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Pi.getTargetData(i,e).next((l=>l?(r=l,we.resolve(r)):t.Pi.allocateTargetId(i).next((c=>(r=new ia(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function gg(n,e,t){const i=rt(n),r=i.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,r)))}catch(c){if(!Ou(c))throw c;Oe(T_,`Failed to update sequence numbers for target ${e}: ${c}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function ME(n,e,t){const i=rt(n);let r=st.min(),l=It();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(g,p,E){const S=rt(g),C=S.xs.get(E);return C!==void 0?we.resolve(S.Ms.get(C)):S.Pi.getTargetData(p,E)})(i,c,Ao(e)).next((m=>{if(m)return r=m.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(c,m.targetId).next((g=>{l=g}))})).next((()=>i.Fs.getDocumentsMatchingQuery(c,e,t?r:st.min(),t?l:It()))).next((m=>(T6(i,o4(e),m),{documents:m,Qs:l})))))}function T6(n,e,t){let i=n.Os.get(e)||st.min();t.forEach(((r,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.Os.set(e,i)}class PE{constructor(){this.activeTargetIds=d4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class x6{constructor(){this.Mo=new PE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new PE,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kE="ConnectivityMonitor";class DE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Oe(kE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Oe(kE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yh=null;function _g(){return yh===null?yh=(function(){return 268435456+Math.round(2147483648*Math.random())})():yh++,"0x"+yh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="RestConnection",w6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class S6{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===Kh?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,l){const c=_g(),m=this.zo(e,t.toUriEncodedString());Oe(Lp,`Sending RPC '${e}' ${c}:`,m,i);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,r,l);const{host:p}=new URL(m),E=Pu(p);return this.Jo(e,m,g,i,E).then((S=>(Oe(Lp,`Received RPC '${e}' ${c}: `,S),S)),(S=>{throw Tu(Lp,`RPC '${e}' ${c} failed with error: `,S,"url: ",m,"request:",i),S}))}Ho(e,t,i,r,l,c){return this.Go(e,t,i,r,l)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Lu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,l)=>e[l]=r)),i&&i.headers.forEach(((r,l)=>e[l]=r))}zo(e,t){const i=w6[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di="WebChannelConnection";class C6 extends S6{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,l){const c=_g();return new Promise(((m,g)=>{const p=new QS;p.setWithCredentials(!0),p.listenOnce($S.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Ch.NO_ERROR:const S=p.getResponseJson();Oe(di,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(S)),m(S);break;case Ch.TIMEOUT:Oe(di,`RPC '${e}' ${c} timed out`),g(new Ve(Ee.DEADLINE_EXCEEDED,"Request time out"));break;case Ch.HTTP_ERROR:const C=p.getStatus();if(Oe(di,`RPC '${e}' ${c} failed with status:`,C,"response text:",p.getResponseText()),C>0){let M=p.getResponseJson();Array.isArray(M)&&(M=M[0]);const z=M==null?void 0:M.error;if(z&&z.status&&z.message){const H=(function(te){const re=te.toLowerCase().replace(/_/g,"-");return Object.values(Ee).indexOf(re)>=0?re:Ee.UNKNOWN})(z.status);g(new Ve(H,z.message))}else g(new Ve(Ee.UNKNOWN,"Server responded with status "+p.getStatus()))}else g(new Ve(Ee.UNAVAILABLE,"Connection failed."));break;default:Xe(9055,{l_:e,streamId:c,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Oe(di,`RPC '${e}' ${c} completed.`)}}));const E=JSON.stringify(r);Oe(di,`RPC '${e}' ${c} sending request:`,r),p.send(t,"POST",E,i,15)}))}T_(e,t,i){const r=_g(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=t1(),m=e1(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(g.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const E=l.join("");Oe(di,`Creating RPC '${e}' stream ${r}: ${E}`,g);const S=c.createWebChannel(E,g);this.I_(S);let C=!1,M=!1;const z=new A6({Yo:Y=>{M?Oe(di,`Not sending because RPC '${e}' stream ${r} is closed:`,Y):(C||(Oe(di,`Opening RPC '${e}' stream ${r} transport.`),S.open(),C=!0),Oe(di,`RPC '${e}' stream ${r} sending:`,Y),S.send(Y))},Zo:()=>S.close()}),H=(Y,te,re)=>{Y.listen(te,(ee=>{try{re(ee)}catch(ge){setTimeout((()=>{throw ge}),0)}}))};return H(S,Rc.EventType.OPEN,(()=>{M||(Oe(di,`RPC '${e}' stream ${r} transport opened.`),z.o_())})),H(S,Rc.EventType.CLOSE,(()=>{M||(M=!0,Oe(di,`RPC '${e}' stream ${r} transport closed`),z.a_(),this.E_(S))})),H(S,Rc.EventType.ERROR,(Y=>{M||(M=!0,Tu(di,`RPC '${e}' stream ${r} transport errored. Name:`,Y.name,"Message:",Y.message),z.a_(new Ve(Ee.UNAVAILABLE,"The operation could not be completed")))})),H(S,Rc.EventType.MESSAGE,(Y=>{var te;if(!M){const re=Y.data[0];qt(!!re,16349);const ee=re,ge=(ee==null?void 0:ee.error)||((te=ee[0])==null?void 0:te.error);if(ge){Oe(di,`RPC '${e}' stream ${r} received error:`,ge);const pe=ge.status;let J=(function(V){const F=Pn[V];if(F!==void 0)return L1(F)})(pe),k=ge.message;J===void 0&&(J=Ee.INTERNAL,k="Unknown error status: "+pe+" with message "+ge.message),M=!0,z.a_(new Ve(J,k)),S.close()}else Oe(di,`RPC '${e}' stream ${r} received:`,re),z.u_(re)}})),H(m,XS.STAT_EVENT,(Y=>{Y.stat===sg.PROXY?Oe(di,`RPC '${e}' stream ${r} detected buffering proxy`):Y.stat===sg.NOPROXY&&Oe(di,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{z.__()}),0),z}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Vp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bf(n){return new R4(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e,t,i=1e3,r=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&Oe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE="PersistentStream";class J1{constructor(e,t,i,r,l,c,m,g){this.Mi=e,this.S_=i,this.b_=r,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=m,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new W1(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ee.RESOURCE_EXHAUSTED?(cr(t.toString()),cr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Ve(Ee.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Oe(LE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Oe(LE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class b6 extends J1{constructor(e,t,i,r,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,c),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=k4(this.serializer,e),i=(function(l){if(!("targetChange"in l))return st.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?st.min():c.readTime?Co(c.readTime):st.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=pg(this.serializer),t.addTarget=(function(l,c){let m;const g=c.target;if(m=ug(g)?{documents:V4(l,g)}:{query:O4(l,g).ft},m.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){m.resumeToken=U1(l,c.resumeToken);const p=hg(l,c.expectedCount);p!==null&&(m.expectedCount=p)}else if(c.snapshotVersion.compareTo(st.min())>0){m.readTime=Qh(l,c.snapshotVersion.toTimestamp());const p=hg(l,c.expectedCount);p!==null&&(m.expectedCount=p)}return m})(this.serializer,e);const i=z4(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=pg(this.serializer),t.removeTarget=e,this.q_(t)}}class I6 extends J1{constructor(e,t,i,r,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return qt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,qt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){qt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=L4(e.writeResults,e.commitTime),i=Co(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=pg(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>D4(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{}class R6 extends N6{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ve(Ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,fg(t,i),r,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ve(Ee.UNKNOWN,l.toString())}))}Ho(e,t,i,r,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,m])=>this.connection.Ho(e,fg(t,i),r,c,m,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Ve(Ee.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class M6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(cr(t),this.aa=!1):Oe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fl="RemoteStore";class P6{constructor(e,t,i,r,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{i.enqueueAndForget((async()=>{_l(this)&&(Oe(fl,"Restarting streams for network reachability change."),await(async function(g){const p=rt(g);p.Ea.add(4),await rd(p),p.Ra.set("Unknown"),p.Ea.delete(4),await If(p)})(this))}))})),this.Ra=new M6(i,r)}}async function If(n){if(_l(n))for(const e of n.da)await e(!0)}async function rd(n){for(const e of n.da)await e(!1)}function Q1(n,e){const t=rt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),S_(t)?w_(t):Uu(t).O_()&&E_(t,e))}function x_(n,e){const t=rt(n),i=Uu(t);t.Ia.delete(e),i.O_()&&$1(t,e),t.Ia.size===0&&(i.O_()?i.L_():_l(t)&&t.Ra.set("Unknown"))}function E_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(st.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Uu(n).Y_(e)}function $1(n,e){n.Va.Ue(e),Uu(n).Z_(e)}function w_(n){n.Va=new C4({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Uu(n).start(),n.Ra.ua()}function S_(n){return _l(n)&&!Uu(n).x_()&&n.Ia.size>0}function _l(n){return rt(n).Ea.size===0}function X1(n){n.Va=void 0}async function k6(n){n.Ra.set("Online")}async function D6(n){n.Ia.forEach(((e,t)=>{E_(n,e)}))}async function L6(n,e){X1(n),S_(n)?(n.Ra.ha(e),w_(n)):n.Ra.set("Unknown")}async function V6(n,e,t){if(n.Ra.set("Online"),e instanceof O1&&e.state===2&&e.cause)try{await(async function(r,l){const c=l.cause;for(const m of l.targetIds)r.Ia.has(m)&&(await r.remoteSyncer.rejectListen(m,c),r.Ia.delete(m),r.Va.removeTarget(m))})(n,e)}catch(i){Oe(fl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Xh(n,i)}else if(e instanceof Rh?n.Va.Ze(e):e instanceof V1?n.Va.st(e):n.Va.tt(e),!t.isEqual(st.min()))try{const i=await Y1(n.localStore);t.compareTo(i)>=0&&await(function(l,c){const m=l.Va.Tt(c);return m.targetChanges.forEach(((g,p)=>{if(g.resumeToken.approximateByteSize()>0){const E=l.Ia.get(p);E&&l.Ia.set(p,E.withResumeToken(g.resumeToken,c))}})),m.targetMismatches.forEach(((g,p)=>{const E=l.Ia.get(g);if(!E)return;l.Ia.set(g,E.withResumeToken(ni.EMPTY_BYTE_STRING,E.snapshotVersion)),$1(l,g);const S=new ia(E.target,g,p,E.sequenceNumber);E_(l,S)})),l.remoteSyncer.applyRemoteEvent(m)})(n,t)}catch(i){Oe(fl,"Failed to raise snapshot:",i),await Xh(n,i)}}async function Xh(n,e,t){if(!Ou(e))throw e;n.Ea.add(1),await rd(n),n.Ra.set("Offline"),t||(t=()=>Y1(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Oe(fl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await If(n)}))}function eA(n,e){return e().catch((t=>Xh(n,t,e)))}async function Nf(n){const e=rt(n),t=ga(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:o_;for(;O6(e);)try{const r=await y6(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,U6(e,r)}catch(r){await Xh(e,r)}tA(e)&&nA(e)}function O6(n){return _l(n)&&n.Ta.length<10}function U6(n,e){n.Ta.push(e);const t=ga(n);t.O_()&&t.X_&&t.ea(e.mutations)}function tA(n){return _l(n)&&!ga(n).x_()&&n.Ta.length>0}function nA(n){ga(n).start()}async function z6(n){ga(n).ra()}async function B6(n){const e=ga(n);for(const t of n.Ta)e.ea(t.mutations)}async function F6(n,e,t){const i=n.Ta.shift(),r=m_.from(i,e,t);await eA(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Nf(n)}async function q6(n,e){e&&ga(n).X_&&await(async function(i,r){if((function(c){return w4(c)&&c!==Ee.ABORTED})(r.code)){const l=i.Ta.shift();ga(i).B_(),await eA(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,r))),await Nf(i)}})(n,e),tA(n)&&nA(n)}async function VE(n,e){const t=rt(n);t.asyncQueue.verifyOperationInProgress(),Oe(fl,"RemoteStore received new credentials");const i=_l(t);t.Ea.add(3),await rd(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await If(t)}async function H6(n,e){const t=rt(n);e?(t.Ea.delete(2),await If(t)):e||(t.Ea.add(2),await rd(t),t.Ra.set("Unknown"))}function Uu(n){return n.ma||(n.ma=(function(t,i,r){const l=rt(t);return l.sa(),new b6(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,r)})(n.datastore,n.asyncQueue,{Xo:k6.bind(null,n),t_:D6.bind(null,n),r_:L6.bind(null,n),H_:V6.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),S_(n)?w_(n):n.Ra.set("Unknown")):(await n.ma.stop(),X1(n))}))),n.ma}function ga(n){return n.fa||(n.fa=(function(t,i,r){const l=rt(t);return l.sa(),new I6(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:z6.bind(null,n),r_:q6.bind(null,n),ta:B6.bind(null,n),na:F6.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Nf(n)):(await n.fa.stop(),n.Ta.length>0&&(Oe(fl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{constructor(e,t,i,r,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=l,this.deferred=new ua,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,l){const c=Date.now()+i,m=new A_(e,t,c,r,l);return m.start(i),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ve(Ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function C_(n,e){if(cr("AsyncQueue",`${e}: ${n}`),Ou(n))return new Ve(Ee.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{static emptySet(e){return new pu(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ze.comparator(t.key,i.key):(t,i)=>Ze.comparator(t.key,i.key),this.keyedMap=Mc(),this.sortedSet=new pn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof pu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,l=i.getNext().key;if(!r.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new pu;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(){this.ga=new pn(Ze.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Xe(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class bu{constructor(e,t,i,r,l,c,m,g,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=m,this.excludesMetadataChanges=g,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,r,l){const c=[];return t.forEach((m=>{c.push({type:0,doc:m})})),new bu(e,t,pu.emptySet(t),c,i,r,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ef(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class j6{constructor(){this.queries=UE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=rt(t),l=r.queries;r.queries=UE(),l.forEach(((c,m)=>{for(const g of m.Sa)g.onError(i)}))})(this,new Ve(Ee.ABORTED,"Firestore shutting down"))}}function UE(){return new gl((n=>w1(n)),Ef)}async function iA(n,e){const t=rt(n);let i=3;const r=e.query;let l=t.queries.get(r);l?!l.ba()&&e.Da()&&(i=2):(l=new G6,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(r,!0);break;case 1:l.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(c){const m=C_(c,`Initialization of query '${ou(e.query)}' failed`);return void e.onError(m)}t.queries.set(r,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&b_(t)}async function sA(n,e){const t=rt(n),i=e.query;let r=3;const l=t.queries.get(i);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?r=e.Da()?0:1:!l.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function K6(n,e){const t=rt(n);let i=!1;for(const r of e){const l=r.query,c=t.queries.get(l);if(c){for(const m of c.Sa)m.Fa(r)&&(i=!0);c.wa=r}}i&&b_(t)}function Z6(n,e,t){const i=rt(n),r=i.queries.get(e);if(r)for(const l of r.Sa)l.onError(t);i.queries.delete(e)}function b_(n){n.Ca.forEach((e=>{e.next()}))}var yg,zE;(zE=yg||(yg={})).Ma="default",zE.Cache="cache";class oA{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new bu(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=bu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==yg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rA{constructor(e){this.key=e}}class aA{constructor(e){this.key=e}}class Y6{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=It(),this.mutatedKeys=It(),this.eu=S1(e),this.tu=new pu(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new OE,r=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,c=r,m=!1;const g=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,p=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((E,S)=>{const C=r.get(E),M=wf(this.query,S)?S:null,z=!!C&&this.mutatedKeys.has(C.key),H=!!M&&(M.hasLocalMutations||this.mutatedKeys.has(M.key)&&M.hasCommittedMutations);let Y=!1;C&&M?C.data.isEqual(M.data)?z!==H&&(i.track({type:3,doc:M}),Y=!0):this.su(C,M)||(i.track({type:2,doc:M}),Y=!0,(g&&this.eu(M,g)>0||p&&this.eu(M,p)<0)&&(m=!0)):!C&&M?(i.track({type:0,doc:M}),Y=!0):C&&!M&&(i.track({type:1,doc:C}),Y=!0,(g||p)&&(m=!0)),Y&&(M?(c=c.add(M),l=H?l.add(E):l.delete(E)):(c=c.delete(E),l=l.delete(E)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const E=this.query.limitType==="F"?c.last():c.first();c=c.delete(E.key),l=l.delete(E.key),i.track({type:1,doc:E})}return{tu:c,iu:i,Cs:m,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((E,S)=>(function(M,z){const H=Y=>{switch(Y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xe(20277,{Rt:Y})}};return H(M)-H(z)})(E.type,S.type)||this.eu(E.doc,S.doc))),this.ou(i),r=r??!1;const m=t&&!r?this._u():[],g=this.Xa.size===0&&this.current&&!r?1:0,p=g!==this.Za;return this.Za=g,c.length!==0||p?{snapshot:new bu(this.query,e.tu,l,c,e.mutatedKeys,g===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new OE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=It(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new aA(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new rA(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=It();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return bu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const I_="SyncEngine";class W6{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class J6{constructor(e){this.key=e,this.hu=!1}}class Q6{constructor(e,t,i,r,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new gl((m=>w1(m)),Ef),this.Iu=new Map,this.Eu=new Set,this.du=new pn(Ze.comparator),this.Au=new Map,this.Ru=new __,this.Vu={},this.mu=new Map,this.fu=Cu.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function $6(n,e,t=!0){const i=fA(n);let r;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),r=l.view.lu()):r=await lA(i,e,t,!0),r}async function X6(n,e){const t=fA(n);await lA(t,e,!0,!1)}async function lA(n,e,t,i){const r=await v6(n.localStore,Ao(e)),l=r.targetId,c=n.sharedClientState.addLocalQueryTarget(l,t);let m;return i&&(m=await eV(n,e,l,c==="current",r.resumeToken)),n.isPrimaryClient&&t&&Q1(n.remoteStore,r),m}async function eV(n,e,t,i,r){n.pu=(S,C,M)=>(async function(H,Y,te,re){let ee=Y.view.ru(te);ee.Cs&&(ee=await ME(H.localStore,Y.query,!1).then((({documents:k})=>Y.view.ru(k,ee))));const ge=re&&re.targetChanges.get(Y.targetId),pe=re&&re.targetMismatches.get(Y.targetId)!=null,J=Y.view.applyChanges(ee,H.isPrimaryClient,ge,pe);return FE(H,Y.targetId,J.au),J.snapshot})(n,S,C,M);const l=await ME(n.localStore,e,!0),c=new Y6(e,l.Qs),m=c.ru(l.documents),g=od.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),p=c.applyChanges(m,n.isPrimaryClient,g);FE(n,t,p.au);const E=new W6(e,t,c);return n.Tu.set(e,E),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function tV(n,e,t){const i=rt(n),r=i.Tu.get(e),l=i.Iu.get(r.targetId);if(l.length>1)return i.Iu.set(r.targetId,l.filter((c=>!Ef(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await gg(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&x_(i.remoteStore,r.targetId),vg(i,r.targetId)})).catch(Vu)):(vg(i,r.targetId),await gg(i.localStore,r.targetId,!0))}async function nV(n,e){const t=rt(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),x_(t.remoteStore,i.targetId))}async function iV(n,e,t){const i=cV(n);try{const r=await(function(c,m){const g=rt(c),p=ln.now(),E=m.reduce(((M,z)=>M.add(z.key)),It());let S,C;return g.persistence.runTransaction("Locally write mutations","readwrite",(M=>{let z=dr(),H=It();return g.Ns.getEntries(M,E).next((Y=>{z=Y,z.forEach(((te,re)=>{re.isValidDocument()||(H=H.add(te))}))})).next((()=>g.localDocuments.getOverlayedDocuments(M,z))).next((Y=>{S=Y;const te=[];for(const re of m){const ee=y4(re,S.get(re.key).overlayedDocument);ee!=null&&te.push(new xa(re.key,ee,p1(ee.value.mapValue),ks.exists(!0)))}return g.mutationQueue.addMutationBatch(M,p,te,m)})).next((Y=>{C=Y;const te=Y.applyToLocalDocumentSet(S,H);return g.documentOverlayCache.saveOverlays(M,Y.batchId,te)}))})).then((()=>({batchId:C.batchId,changes:C1(S)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(c,m,g){let p=c.Vu[c.currentUser.toKey()];p||(p=new pn(bt)),p=p.insert(m,g),c.Vu[c.currentUser.toKey()]=p})(i,r.batchId,t),await ad(i,r.changes),await Nf(i.remoteStore)}catch(r){const l=C_(r,"Failed to persist write");t.reject(l)}}async function uA(n,e){const t=rt(n);try{const i=await g6(t.localStore,e);e.targetChanges.forEach(((r,l)=>{const c=t.Au.get(l);c&&(qt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?c.hu=!0:r.modifiedDocuments.size>0?qt(c.hu,14607):r.removedDocuments.size>0&&(qt(c.hu,42227),c.hu=!1))})),await ad(t,i,e)}catch(i){await Vu(i)}}function BE(n,e,t){const i=rt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((l,c)=>{const m=c.view.va(e);m.snapshot&&r.push(m.snapshot)})),(function(c,m){const g=rt(c);g.onlineState=m;let p=!1;g.queries.forEach(((E,S)=>{for(const C of S.Sa)C.va(m)&&(p=!0)})),p&&b_(g)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function sV(n,e,t){const i=rt(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),l=r&&r.key;if(l){let c=new pn(Ze.comparator);c=c.insert(l,fi.newNoDocument(l,st.min()));const m=It().add(l),g=new Cf(st.min(),new Map,new pn(bt),c,m);await uA(i,g),i.du=i.du.remove(l),i.Au.delete(e),N_(i)}else await gg(i.localStore,e,!1).then((()=>vg(i,e,t))).catch(Vu)}async function oV(n,e){const t=rt(n),i=e.batch.batchId;try{const r=await p6(t.localStore,e);dA(t,i,null),cA(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await ad(t,r)}catch(r){await Vu(r)}}async function rV(n,e,t){const i=rt(n);try{const r=await(function(c,m){const g=rt(c);return g.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let E;return g.mutationQueue.lookupMutationBatch(p,m).next((S=>(qt(S!==null,37113),E=S.keys(),g.mutationQueue.removeMutationBatch(p,S)))).next((()=>g.mutationQueue.performConsistencyCheck(p))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(p,E,m))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,E))).next((()=>g.localDocuments.getDocuments(p,E)))}))})(i.localStore,e);dA(i,e,t),cA(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await ad(i,r)}catch(r){await Vu(r)}}function cA(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function dA(n,e,t){const i=rt(n);let r=i.Vu[i.currentUser.toKey()];if(r){const l=r.get(e);l&&(t?l.reject(t):l.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function vg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||hA(n,i)}))}function hA(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(x_(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),N_(n))}function FE(n,e,t){for(const i of t)i instanceof rA?(n.Ru.addReference(i.key,e),aV(n,i)):i instanceof aA?(Oe(I_,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||hA(n,i.key)):Xe(19791,{wu:i})}function aV(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(Oe(I_,"New document in limbo: "+t),n.Eu.add(i),N_(n))}function N_(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ze(tn.fromString(e)),i=n.fu.next();n.Au.set(i,new J6(t)),n.du=n.du.insert(t,i),Q1(n.remoteStore,new ia(Ao(c_(t.path)),i,"TargetPurposeLimboResolution",vf.ce))}}async function ad(n,e,t){const i=rt(n),r=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((m,g)=>{c.push(i.pu(g,e,t).then((p=>{var E;if((p||t)&&i.isPrimaryClient){const S=p?!p.fromCache:(E=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:E.current;i.sharedClientState.updateQueryState(g.targetId,S?"current":"not-current")}if(p){r.push(p);const S=v_.As(g.targetId,p);l.push(S)}})))})),await Promise.all(c),i.Pu.H_(r),await(async function(g,p){const E=rt(g);try{await E.persistence.runTransaction("notifyLocalViewChanges","readwrite",(S=>we.forEach(p,(C=>we.forEach(C.Es,(M=>E.persistence.referenceDelegate.addReference(S,C.targetId,M))).next((()=>we.forEach(C.ds,(M=>E.persistence.referenceDelegate.removeReference(S,C.targetId,M)))))))))}catch(S){if(!Ou(S))throw S;Oe(T_,"Failed to update sequence numbers: "+S)}for(const S of p){const C=S.targetId;if(!S.fromCache){const M=E.Ms.get(C),z=M.snapshotVersion,H=M.withLastLimboFreeSnapshotVersion(z);E.Ms=E.Ms.insert(C,H)}}})(i.localStore,l))}async function lV(n,e){const t=rt(n);if(!t.currentUser.isEqual(e)){Oe(I_,"User change. New user:",e.toKey());const i=await Z1(t.localStore,e);t.currentUser=e,(function(l,c){l.mu.forEach((m=>{m.forEach((g=>{g.reject(new Ve(Ee.CANCELLED,c))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await ad(t,i.Ls)}}function uV(n,e){const t=rt(n),i=t.Au.get(e);if(i&&i.hu)return It().add(i.key);{let r=It();const l=t.Iu.get(e);if(!l)return r;for(const c of l){const m=t.Tu.get(c);r=r.unionWith(m.view.nu)}return r}}function fA(n){const e=rt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=uA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=uV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sV.bind(null,e),e.Pu.H_=K6.bind(null,e.eventManager),e.Pu.yu=Z6.bind(null,e.eventManager),e}function cV(n){const e=rt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=oV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rV.bind(null,e),e}class ef{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=bf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return m6(this.persistence,new d6,e.initialUser,this.serializer)}Cu(e){return new K1(y_.mi,this.serializer)}Du(e){return new x6}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ef.provider={build:()=>new ef};class dV extends ef{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){qt(this.persistence.referenceDelegate instanceof $h,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new J4(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ji.withCacheSize(this.cacheSizeBytes):ji.DEFAULT;return new K1((i=>$h.mi(i,t)),this.serializer)}}class Tg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>BE(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=lV.bind(null,this.syncEngine),await H6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new j6})()}createDatastore(e){const t=bf(e.databaseInfo.databaseId),i=(function(l){return new C6(l)})(e.databaseInfo);return(function(l,c,m,g){return new R6(l,c,m,g)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,l,c,m){return new P6(i,r,l,c,m)})(this.localStore,this.datastore,e.asyncQueue,(t=>BE(this.syncEngine,t,0)),(function(){return DE.v()?new DE:new E6})())}createSyncEngine(e,t){return(function(r,l,c,m,g,p,E){const S=new Q6(r,l,c,m,g,p);return E&&(S.gu=!0),S})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const l=rt(r);Oe(fl,"RemoteStore shutting down."),l.Ea.add(5),await rd(l),l.Aa.shutdown(),l.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Tg.provider={build:()=>new Tg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):cr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="FirestoreClient";class hV{constructor(e,t,i,r,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=hi.UNAUTHENTICATED,this.clientId=s_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{Oe(_a,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Oe(_a,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ua;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=C_(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Op(n,e){n.asyncQueue.verifyOperationInProgress(),Oe(_a,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await Z1(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function qE(n,e){n.asyncQueue.verifyOperationInProgress();const t=await fV(n);Oe(_a,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>VE(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>VE(e.remoteStore,r))),n._onlineComponents=e}async function fV(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Oe(_a,"Using user provided OfflineComponentProvider");try{await Op(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===Ee.FAILED_PRECONDITION||r.code===Ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;Tu("Error using user provided cache. Falling back to memory cache: "+t),await Op(n,new ef)}}else Oe(_a,"Using default OfflineComponentProvider"),await Op(n,new dV(void 0));return n._offlineComponents}async function pA(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Oe(_a,"Using user provided OnlineComponentProvider"),await qE(n,n._uninitializedComponentsProvider._online)):(Oe(_a,"Using default OnlineComponentProvider"),await qE(n,new Tg))),n._onlineComponents}function mV(n){return pA(n).then((e=>e.syncEngine))}async function xg(n){const e=await pA(n),t=e.eventManager;return t.onListen=$6.bind(null,e.syncEngine),t.onUnlisten=tV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=X6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=nV.bind(null,e.syncEngine),t}function pV(n,e,t={}){const i=new ua;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,m,g,p){const E=new mA({next:C=>{E.Nu(),c.enqueueAndForget((()=>sA(l,S))),C.fromCache&&g.source==="server"?p.reject(new Ve(Ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(C)},error:C=>p.reject(C)}),S=new oA(m,E,{includeMetadataChanges:!0,qa:!0});return iA(l,S)})(await xg(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A="firestore.googleapis.com",GE=!0;class jE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ve(Ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_A,this.ssl=GE}else this.host=e.host,this.ssl=e.ssl??GE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=j1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Y4)throw new Ve(Ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}P3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gA(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ve(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ve(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ve(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Rf{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ve(Ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ve(Ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new E3;switch(i.type){case"firstParty":return new C3(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ve(Ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=HE.get(t);i&&(Oe("ComponentProvider","Removing Datastore"),HE.delete(t),i.terminate())})(this),Promise.resolve()}}function gV(n,e,t,i={}){var p;n=Ps(n,Rf);const r=Pu(e),l=n._getSettings(),c={...l,emulatorOptions:n._getEmulatorOptions()},m=`${e}:${t}`;r&&(hS(`https://${m}`),fS("Firestore",!0)),l.host!==_A&&l.host!==m&&Tu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:m,ssl:r,emulatorOptions:i};if(!ar(g,c)&&(n._setSettings(g),i.mockUserToken)){let E,S;if(typeof i.mockUserToken=="string")E=i.mockUserToken,S=hi.MOCK_USER;else{E=K5(i.mockUserToken,(p=n._app)==null?void 0:p.options.projectId);const C=i.mockUserToken.sub||i.mockUserToken.user_id;if(!C)throw new Ve(Ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");S=new hi(C)}n._authCredentials=new w3(new i1(E,S))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new yl(this.firestore,e,this._query)}}class An{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ca(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new An(this.firestore,e,this._key)}toJSON(){return{type:An._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(nd(t,An._jsonSchema))return new An(e,i||null,new Ze(tn.fromString(t.referencePath)))}}An._jsonSchemaVersion="firestore/documentReference/1.0",An._jsonSchema={type:Dn("string",An._jsonSchemaVersion),referencePath:Dn("string")};class ca extends yl{constructor(e,t,i){super(e,t,c_(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new An(this.firestore,null,new Ze(e))}withConverter(e){return new ca(this.firestore,e,this._path)}}function Mh(n,e,...t){if(n=Wn(n),s1("collection","path",e),n instanceof Rf){const i=tn.fromString(e,...t);return sE(i),new ca(n,null,i)}{if(!(n instanceof An||n instanceof ca))throw new Ve(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(tn.fromString(e,...t));return sE(i),new ca(n.firestore,null,i)}}function gu(n,e,...t){if(n=Wn(n),arguments.length===1&&(e=s_.newId()),s1("doc","path",e),n instanceof Rf){const i=tn.fromString(e,...t);return iE(i),new An(n,null,new Ze(i))}{if(!(n instanceof An||n instanceof ca))throw new Ve(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(tn.fromString(e,...t));return iE(i),new An(n.firestore,n instanceof ca?n.converter:null,new Ze(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE="AsyncQueue";class ZE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new W1(this,"async_queue_retry"),this._c=()=>{const i=Vp();i&&Oe(KE,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Vp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Vp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ua;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ou(e))throw e;Oe(KE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,cr("INTERNAL UNHANDLED ERROR: ",YE(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=A_.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(r),r}uc(){this.nc&&Xe(47125,{Pc:YE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function YE(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WE(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const l of i)if(l in r&&typeof r[l]=="function")return!0;return!1})(n,["next","error","complete"])}class ya extends Rf{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new ZE,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ZE(e),this._firestoreClient=void 0,await e}}}function _V(n,e){const t=typeof n=="object"?n:_S(),i=typeof n=="string"?n:Kh,r=Kg(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const l=G5("firestore");l&&gV(r,...l)}return r}function R_(n){if(n._terminated)throw new Ve(Ee.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||yV(n),n._firestoreClient}function yV(n){var i,r,l;const e=n._freezeSettings(),t=(function(m,g,p,E){return new H3(m,g,p,E.host,E.ssl,E.experimentalForceLongPolling,E.experimentalAutoDetectLongPolling,gA(E.experimentalLongPollingOptions),E.useFetchStreams,E.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new hV(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(m){const g=m==null?void 0:m._online.build();return{_offline:m==null?void 0:m._offline.build(g),_online:g}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Rs(ni.fromBase64String(e))}catch(t){throw new Ve(Ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Rs(ni.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Rs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(nd(e,Rs._jsonSchema))return Rs.fromBase64String(e.bytes)}}Rs._jsonSchemaVersion="firestore/bytes/1.0",Rs._jsonSchema={type:Dn("string",Rs._jsonSchemaVersion),bytes:Dn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ve(Ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ti(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ve(Ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ve(Ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return bt(this._lat,e._lat)||bt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:bo._jsonSchemaVersion}}static fromJSON(e){if(nd(e,bo._jsonSchema))return new bo(e.latitude,e.longitude)}}bo._jsonSchemaVersion="firestore/geoPoint/1.0",bo._jsonSchema={type:Dn("string",bo._jsonSchemaVersion),latitude:Dn("number"),longitude:Dn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==r[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Io._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(nd(e,Io._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Io(e.vectorValues);throw new Ve(Ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Io._jsonSchemaVersion="firestore/vectorValue/1.0",Io._jsonSchema={type:Dn("string",Io._jsonSchemaVersion),vectorValues:Dn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vV=/^__.*__$/;class TV{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new xa(e,this.data,this.fieldMask,t,this.fieldTransforms):new sd(e,this.data,t,this.fieldTransforms)}}class yA{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new xa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function vA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xe(40011,{Ac:n})}}class Pf{constructor(e,t,i,r,l,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Pf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return tf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(vA(this.Ac)&&vV.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class xV{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||bf(e)}Cc(e,t,i,r=!1){return new Pf({Ac:e,methodName:t,Dc:i,path:ti.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function kf(n){const e=n._freezeSettings(),t=bf(n._databaseId);return new xV(n._databaseId,!!e.ignoreUndefinedProperties,t)}function TA(n,e,t,i,r,l={}){const c=n.Cc(l.merge||l.mergeFields?2:0,e,t,r);D_("Data must be an object, but it was:",c,i);const m=EA(i,c);let g,p;if(l.merge)g=new ds(c.fieldMask),p=c.fieldTransforms;else if(l.mergeFields){const E=[];for(const S of l.mergeFields){const C=Eg(e,S,t);if(!c.contains(C))throw new Ve(Ee.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);SA(E,C)||E.push(C)}g=new ds(E),p=c.fieldTransforms.filter((S=>g.covers(S.field)))}else g=null,p=c.fieldTransforms;return new TV(new Ki(m),g,p)}class Df extends zu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Df}}function xA(n,e,t){return new Pf({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class M_ extends zu{_toFieldTransform(e){return new h_(e.path,new Jc)}isEqual(e){return e instanceof M_}}class P_ extends zu{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=xA(this,e,!0),i=this.vc.map((l=>vl(l,t))),r=new Su(i);return new h_(e.path,r)}isEqual(e){return e instanceof P_&&ar(this.vc,e.vc)}}class k_ extends zu{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=xA(this,e,!0),i=this.vc.map((l=>vl(l,t))),r=new Au(i);return new h_(e.path,r)}isEqual(e){return e instanceof k_&&ar(this.vc,e.vc)}}function EV(n,e,t,i){const r=n.Cc(1,e,t);D_("Data must be an object, but it was:",r,i);const l=[],c=Ki.empty();Ta(i,((g,p)=>{const E=L_(e,g,t);p=Wn(p);const S=r.yc(E);if(p instanceof Df)l.push(E);else{const C=vl(p,S);C!=null&&(l.push(E),c.set(E,C))}}));const m=new ds(l);return new yA(c,m,r.fieldTransforms)}function wV(n,e,t,i,r,l){const c=n.Cc(1,e,t),m=[Eg(e,i,t)],g=[r];if(l.length%2!=0)throw new Ve(Ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<l.length;C+=2)m.push(Eg(e,l[C])),g.push(l[C+1]);const p=[],E=Ki.empty();for(let C=m.length-1;C>=0;--C)if(!SA(p,m[C])){const M=m[C];let z=g[C];z=Wn(z);const H=c.yc(M);if(z instanceof Df)p.push(M);else{const Y=vl(z,H);Y!=null&&(p.push(M),E.set(M,Y))}}const S=new ds(p);return new yA(E,S,c.fieldTransforms)}function SV(n,e,t,i=!1){return vl(t,n.Cc(i?4:3,e))}function vl(n,e){if(wA(n=Wn(n)))return D_("Unsupported field value:",e,n),EA(n,e);if(n instanceof zu)return(function(i,r){if(!vA(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(r);l&&r.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,r){const l=[];let c=0;for(const m of i){let g=vl(m,r.wc(c));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),c++}return{arrayValue:{values:l}}})(n,e)}return(function(i,r){if((i=Wn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return h4(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=ln.fromDate(i);return{timestampValue:Qh(r.serializer,l)}}if(i instanceof ln){const l=new ln(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Qh(r.serializer,l)}}if(i instanceof bo)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Rs)return{bytesValue:U1(r.serializer,i._byteString)};if(i instanceof An){const l=r.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw r.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:g_(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Io)return(function(c,m){return{mapValue:{fields:{[f1]:{stringValue:m1},[Zh]:{arrayValue:{values:c.toArray().map((p=>{if(typeof p!="number")throw m.Sc("VectorValues must only contain numeric values.");return d_(m.serializer,p)}))}}}}}})(i,r);throw r.Sc(`Unsupported field value: ${yf(i)}`)})(n,e)}function EA(n,e){const t={};return a1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ta(n,((i,r)=>{const l=vl(r,e.mc(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function wA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ln||n instanceof bo||n instanceof Rs||n instanceof An||n instanceof zu||n instanceof Io)}function D_(n,e,t){if(!wA(t)||!o1(t)){const i=yf(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function Eg(n,e,t){if((e=Wn(e))instanceof Mf)return e._internalPath;if(typeof e=="string")return L_(n,e);throw tf("Field path arguments must be of type string or ",n,!1,void 0,t)}const AV=new RegExp("[~\\*/\\[\\]]");function L_(n,e,t){if(e.search(AV)>=0)throw tf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Mf(...e.split("."))._internalPath}catch{throw tf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function tf(n,e,t,i,r){const l=i&&!i.isEmpty(),c=r!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let g="";return(l||c)&&(g+=" (found",l&&(g+=` in field ${i}`),c&&(g+=` in document ${r}`),g+=")"),new Ve(Ee.INVALID_ARGUMENT,m+n+g)}function SA(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AA{constructor(e,t,i,r,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new An(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new CV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(V_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class CV extends AA{data(){return super.data()}}function V_(n,e){return typeof e=="string"?L_(n,e):e instanceof Mf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ve(Ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class O_{}class bV extends O_{}function wg(n,e,...t){let i=[];e instanceof O_&&i.push(e),i=i.concat(t),(function(l){const c=l.filter((g=>g instanceof U_)).length,m=l.filter((g=>g instanceof Lf)).length;if(c>1||c>0&&m>0)throw new Ve(Ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class Lf extends bV{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Lf(e,t,i)}_apply(e){const t=this._parse(e);return bA(e._query,t),new yl(e.firestore,e.converter,cg(e._query,t))}_parse(e){const t=kf(e.firestore);return(function(l,c,m,g,p,E,S){let C;if(p.isKeyField()){if(E==="array-contains"||E==="array-contains-any")throw new Ve(Ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${E}' queries on documentId().`);if(E==="in"||E==="not-in"){QE(S,E);const z=[];for(const H of S)z.push(JE(g,l,H));C={arrayValue:{values:z}}}else C=JE(g,l,S)}else E!=="in"&&E!=="not-in"&&E!=="array-contains-any"||QE(S,E),C=SV(m,c,S,E==="in"||E==="not-in");return kn.create(p,E,C)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Sg(n,e,t){const i=e,r=V_("where",n);return Lf._create(r,i,t)}class U_ extends O_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new U_(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:$s.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,l){let c=r;const m=l.getFlattenedFilters();for(const g of m)bA(c,g),c=cg(c,g)})(e._query,t),new yl(e.firestore,e.converter,cg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function JE(n,e,t){if(typeof(t=Wn(t))=="string"){if(t==="")throw new Ve(Ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!E1(e)&&t.indexOf("/")!==-1)throw new Ve(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(tn.fromString(t));if(!Ze.isDocumentKey(i))throw new Ve(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return hE(n,new Ze(i))}if(t instanceof An)return hE(n,t._key);throw new Ve(Ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${yf(t)}.`)}function QE(n,e){if(!Array.isArray(n)||n.length===0)throw new Ve(Ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bA(n,e){const t=(function(r,l){for(const c of r)for(const m of c.getFlattenedFilters())if(l.indexOf(m.op)>=0)return m.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ve(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ve(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class IV{convertValue(e,t="none"){switch(pa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Sn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ma(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Ta(e,((r,l)=>{i[r]=this.convertValue(l,t)})),i}convertVectorValue(e){var i,r,l;const t=(l=(r=(i=e.fields)==null?void 0:i[Zh].arrayValue)==null?void 0:r.values)==null?void 0:l.map((c=>Sn(c.doubleValue)));return new Io(t)}convertGeoPoint(e){return new bo(Sn(e.latitude),Sn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=xf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Zc(e));default:return null}}convertTimestamp(e){const t=fa(e);return new ln(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=tn.fromString(e);qt(G1(i),9688,{name:e});const r=new Yc(i.get(1),i.get(3)),l=new Ze(i.popFirst(5));return r.isEqual(t)||cr(`Document ${l} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IA(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class kc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ll extends AA{constructor(e,t,i,r,l,c){super(e,t,i,r,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ph(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(V_("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(Ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ll._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ll._jsonSchemaVersion="firestore/documentSnapshot/1.0",ll._jsonSchema={type:Dn("string",ll._jsonSchemaVersion),bundleSource:Dn("string","DocumentSnapshot"),bundleName:Dn("string"),bundle:Dn("string")};class Ph extends ll{data(e={}){return super.data(e)}}class ul{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new kc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ph(this._firestore,this._userDataWriter,i.key,i,new kc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ve(Ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,l){if(r._snapshot.oldDocs.isEmpty()){let c=0;return r._snapshot.docChanges.map((m=>{const g=new Ph(r._firestore,r._userDataWriter,m.doc.key,m.doc,new kc(r._snapshot.mutatedKeys.has(m.doc.key),r._snapshot.fromCache),r.query.converter);return m.doc,{type:"added",doc:g,oldIndex:-1,newIndex:c++}}))}{let c=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((m=>l||m.type!==3)).map((m=>{const g=new Ph(r._firestore,r._userDataWriter,m.doc.key,m.doc,new kc(r._snapshot.mutatedKeys.has(m.doc.key),r._snapshot.fromCache),r.query.converter);let p=-1,E=-1;return m.type!==0&&(p=c.indexOf(m.doc.key),c=c.delete(m.doc.key)),m.type!==1&&(c=c.add(m.doc),E=c.indexOf(m.doc.key)),{type:NV(m.type),doc:g,oldIndex:p,newIndex:E}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(Ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ul._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=s_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),r.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function NV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xe(61501,{type:n})}}ul._jsonSchemaVersion="firestore/querySnapshot/1.0",ul._jsonSchema={type:Dn("string",ul._jsonSchemaVersion),bundleSource:Dn("string","QuerySnapshot"),bundleName:Dn("string"),bundle:Dn("string")};class z_ extends IV{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new An(this.firestore,null,t)}}function RV(n){n=Ps(n,yl);const e=Ps(n.firestore,ya),t=R_(e),i=new z_(e);return CA(n._query),pV(t,n._query).then((r=>new ul(e,i,n,r)))}function MV(n,e,t){n=Ps(n,An);const i=Ps(n.firestore,ya),r=IA(n.converter,e,t);return Vf(i,[TA(kf(i),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,ks.none())])}function qc(n,e,t,...i){n=Ps(n,An);const r=Ps(n.firestore,ya),l=kf(r);let c;return c=typeof(e=Wn(e))=="string"||e instanceof Mf?wV(l,"updateDoc",n._key,e,t,i):EV(l,"updateDoc",n._key,e),Vf(r,[c.toMutation(n._key,ks.exists(!0))])}function PV(n){return Vf(Ps(n.firestore,ya),[new f_(n._key,ks.none())])}function kV(n,e){const t=Ps(n.firestore,ya),i=gu(n),r=IA(n.converter,e);return Vf(t,[TA(kf(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,ks.exists(!1))]).then((()=>i))}function bc(n,...e){var g,p,E;n=Wn(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||WE(e[i])||(t=e[i++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(WE(e[i])){const S=e[i];e[i]=(g=S.next)==null?void 0:g.bind(S),e[i+1]=(p=S.error)==null?void 0:p.bind(S),e[i+2]=(E=S.complete)==null?void 0:E.bind(S)}let l,c,m;if(n instanceof An)c=Ps(n.firestore,ya),m=c_(n._key.path),l={next:S=>{e[i]&&e[i](DV(c,n,S))},error:e[i+1],complete:e[i+2]};else{const S=Ps(n,yl);c=Ps(S.firestore,ya),m=S._query;const C=new z_(c);l={next:M=>{e[i]&&e[i](new ul(c,C,S,M))},error:e[i+1],complete:e[i+2]},CA(n._query)}return(function(C,M,z,H){const Y=new mA(H),te=new oA(M,Y,z);return C.asyncQueue.enqueueAndForget((async()=>iA(await xg(C),te))),()=>{Y.Nu(),C.asyncQueue.enqueueAndForget((async()=>sA(await xg(C),te)))}})(R_(c),m,r,l)}function Vf(n,e){return(function(i,r){const l=new ua;return i.asyncQueue.enqueueAndForget((async()=>iV(await mV(i),r,l))),l.promise})(R_(n),e)}function DV(n,e,t){const i=t.docs.get(e._key),r=new z_(n);return new ll(n,r,e._key,i,new kc(t.hasPendingWrites,t.fromCache),e.converter)}function $E(){return new M_("serverTimestamp")}function XE(...n){return new P_("arrayUnion",n)}function ew(...n){return new k_("arrayRemove",n)}(function(e,t=!0){(function(r){Lu=r})(ku),yu(new cl("firestore",((i,{instanceIdentifier:r,options:l})=>{const c=i.getProvider("app").getImmediate(),m=new ya(new S3(i.getProvider("auth-internal")),new b3(c,i.getProvider("app-check-internal")),(function(p,E){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Ve(Ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yc(p.options.projectId,E)})(c,r),c);return l={useFetchStreams:t,...l},m._setSettings(l),m}),"PUBLIC").setMultipleInstances(!0)),aa(Xx,eE,e),aa(Xx,eE,"esm2020")})();const LV={apiKey:"AIzaSyBCnLlCaVWh9iKhclzPWJcEPDuyH0OHPUM",authDomain:"ques-trip.firebaseapp.com",projectId:"ques-trip",storageBucket:"ques-trip.firebasestorage.app",messagingSenderId:"765263595886",appId:"1:765263595886:web:3e501d362abe47bfb8597f",measurementId:"G-R1NF9EVRHY"},B_=gS(LV);console.log("Firebase App Initialized:",B_.name);const Ag=T3(B_),VV=new ir,nr=_V(B_),OV=({trip:n,onClose:e,onUpdateTrip:t})=>{var M;const[i,r]=W.useState(""),[l,c]=W.useState(!1),[m,g]=W.useState(null),[p,E]=W.useState(null),S=async()=>{var z;if(i){c(!0),g(null),E(null);try{const H=Mh(nr,"users"),Y=wg(H,Sg("email","==",i)),te=await RV(Y);if(te.empty){g(" Email  App"),c(!1);return}const ee=te.docs[0].data(),ge=ee.uid;if((z=n.userIds)!=null&&z.includes(ge)){g(""),c(!1);return}const pe=gu(nr,"itineraries",n.id);await qc(pe,{collaborators:XE(ge),userIds:XE(ge)});const J={...n,collaborators:[...n.collaborators||[],ge],userIds:[...n.userIds||[],ge]};t(J),E(` ${ee.username||i}`),r("")}catch(H){console.error("Invite failed",H),g(": "+H.message)}finally{c(!1)}}},C=async z=>{if(confirm(""))try{const H=gu(nr,"itineraries",n.id);await qc(H,{collaborators:ew(z),userIds:ew(z)});const Y={...n,collaborators:(n.collaborators||[]).filter(te=>te!==z),userIds:(n.userIds||[]).filter(te=>te!==z)};t(Y)}catch(H){alert(": "+H.message)}};return T.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",onClick:e,children:T.jsxs("div",{className:"bg-white w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up relative",onClick:z=>z.stopPropagation(),children:[T.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:T.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),T.jsx("h3",{className:"text-xl font-bold text-ink mb-2 text-center",children:""}),T.jsx("p",{className:"text-sm text-gray-500 text-center mb-6",children:""}),T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{className:"space-y-2",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:" Email"}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{value:i,onChange:z=>r(z.target.value),placeholder:"friend@example.com",className:"flex-1 bg-gray-50 p-3 rounded-xl text-sm font-bold border border-gray-100 outline-none focus:border-coral transition-colors"}),T.jsx("button",{onClick:S,disabled:!i||l,className:"bg-coral text-white px-4 rounded-xl font-bold text-sm shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none whitespace-nowrap",children:l?"...":""})]}),m&&T.jsx("p",{className:"text-xs text-red-500 font-bold ml-1",children:m}),p&&T.jsx("p",{className:"text-xs text-green-500 font-bold ml-1",children:p})]}),T.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[T.jsx("h4",{className:"text-xs font-bold text-gray-400 mb-3",children:""}),T.jsxs("div",{className:"space-y-2",children:[(!n.collaborators||n.collaborators.length===0)&&T.jsx("p",{className:"text-sm text-gray-400 italic text-center py-2",children:""}),(M=n.collaborators)==null?void 0:M.map(z=>T.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-xl",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:"w-8 h-8 bg-coral/10 rounded-full flex items-center justify-center text-coral font-bold text-xs",children:"User"}),T.jsxs("span",{className:"text-sm font-bold text-gray-600 truncate max-w-[150px]",children:[z.slice(0,8),"..."]})]}),T.jsx("button",{onClick:()=>C(z),className:"text-xs text-red-400 hover:text-red-600 font-bold px-2 py-1",children:""})]},z))]})]})]})]})})},UV=({trip:n,onBack:e,onDelete:t,onUpdateTrip:i,onOpenAI:r,settings:l})=>{var Ci,io,so,Mo;const c=Xt[l.language]||Xt["zh-TW"],[m,g]=W.useState("ITINERARY"),[p,E]=W.useState(!1),[S,C]=W.useState(!1),[M,z]=W.useState(""),[H,Y]=W.useState(null),[te,re]=W.useState(!1),ee=async Re=>{const $e=Re||M;if($e.trim()){Re&&z(Re),re(!0);try{const _t=await Lc($e,l.apiKey);_t?Y(_t):(Re||alert("Location not found"),console.log(`Location not found for: ${$e}`))}catch(_t){console.error("Map search failed:",_t)}finally{re(!1)}}},[ge,pe]=W.useState(null),[J,k]=W.useState(""),[U,V]=W.useState(""),[F,q]=W.useState(""),[j,B]=W.useState([{name:"",price:""}]),[Le,et]=W.useState(((Ci=n.budget)==null?void 0:Ci.currency)||"TWD"),[ne,Ae]=W.useState(""),[Se,Ye]=W.useState(0),[Ie,K]=W.useState(!1),[de,Ce]=W.useState(null),[ae,fe]=W.useState(!1),[be,Fe]=W.useState(!1);W.useEffect(()=>{var Re;ae&&(et(((Re=n.budget)==null?void 0:Re.currency)||"TWD"),Ae(""))},[ae,(io=n.budget)==null?void 0:io.currency]),W.useEffect(()=>{(async()=>{var _t;const $e=((_t=n.budget)==null?void 0:_t.currency)||"TWD";if(Ce(null),Le!==$e&&l.apiKey){K(!0);try{const ut=await Ug(Le,$e);ut?Ae(ut):Ce(" (API Key )")}catch(ut){console.error("Failed to fetch rate:",ut),Ce("")}K(!1)}})()},[Le,(so=n.budget)==null?void 0:so.currency,l.apiKey]),W.useEffect(()=>{const Re=parseFloat(U)||0,$e=parseFloat(ne)||1;Ye(Math.round(Re*$e))},[U,ne]);const[ze,xe]=W.useState(!1),[We,mt]=W.useState(!1),[je,un]=W.useState(n.title),[gn,Et]=W.useState(!1),[pt,Nt]=W.useState(""),[Dt,Rt]=W.useState(!1),ye=()=>{t==null||t(n.id)},Pe=()=>{je.trim()&&je!==n.title&&(i==null||i({...n,title:je})),mt(!1)},Ge=async Re=>{if(Re==="upload"){const $e=document.createElement("input");$e.type="file",$e.accept="image/*",$e.onchange=_t=>{var Un,_i;const ut=(_i=(Un=_t.target)==null?void 0:Un.files)==null?void 0:_i[0];if(ut){const bi=new FileReader;bi.onload=()=>{const Jn=bi.result;i==null||i({...n,coverImage:Jn}),Et(!1)},bi.readAsDataURL(ut)}},$e.click()}else if(Re==="url")pt.trim()&&(i==null||i({...n,coverImage:pt}),Nt(""),Et(!1));else if(Re==="ai"){Rt(!0);try{const{generateCoverImage:$e}=await lf(async()=>{const{generateCoverImage:ut}=await Promise.resolve().then(()=>$P);return{generateCoverImage:ut}},void 0),_t=await $e(n.title);i==null||i({...n,coverImage:_t}),Et(!1)}catch($e){console.error("Failed to generate cover:",$e),alert("AI ")}finally{Rt(!1)}}},gt=Re=>{pe(Re),V(""),q(""),B([{name:"",price:""}]),fe(!0)},lt=()=>{var Zi,en,yi;if(!ge||!U)return;const Re=parseFloat(U);if(Re<=0){alert("Amount must be greater than 0");return}const $e=parseFloat(ne)||1,_t=Math.round(Re*$e),ut=j.filter(zn=>zn.name&&zn.price).map(zn=>`${zn.name}: ${sl(Le)}${zn.price}`).join(", "),Un=F?ut?`${F} (${ut})`:F:ut,_i={id:Date.now().toString(),title:ge.activity,amount:_t,category:"Shopping",date:n.startDate?new Date(n.startDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],payer:"ME",paymentMethod:"Cash",note:Un,originalCurrency:Le,originalAmount:Re,exchangeRate:$e},bi=((Zi=n.budget)==null?void 0:Zi.expenses)||[],Jn={...n,budget:{...n.budget,total:((en=n.budget)==null?void 0:en.total)||0,currency:((yi=n.budget)==null?void 0:yi.currency)||"TWD",expenses:[_i,...bi]}};i==null||i(Jn),fe(!1)},hn=(Re,$e,_t)=>{const ut=[...j];if(ut[Re][$e]=_t,B(ut),$e==="price"){const Un=ut.reduce((_i,bi)=>_i+(parseInt(bi.price)||0),0);Un>0&&V(Un.toString())}},Ai=()=>{B([...j,{name:"",price:""}])},ii=((Mo=n.budget)==null?void 0:Mo.currency)||"TWD",cn=sl(ii);return T.jsxs("div",{className:"flex flex-col h-full bg-paper animate-fade-in relative",children:[T.jsxs("div",{className:"relative h-64 shrink-0 group",children:[T.jsxs("div",{className:"absolute inset-0 bg-gray-200",children:[n.coverImage?T.jsx("img",{src:n.coverImage,alt:n.title,className:`w-full h-full object-cover transition-opacity duration-700 ${S?"opacity-100":"opacity-0"}`,onLoad:()=>C(!0)}):T.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-coral/20 to-sand/30",children:T.jsx(K0,{className:"w-16 h-16 text-coral/40"})}),T.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"})]}),T.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe pt-4 flex justify-between items-start z-10",children:[T.jsx("button",{onClick:e,className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-black/50 transition-colors",children:T.jsx(hs,{className:"w-6 h-6"})}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{onClick:()=>Et(!0),className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-black/50 transition-colors opacity-0 group-hover:opacity-100",children:T.jsx(sa,{className:"w-5 h-5"})}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{onClick:()=>Fe(!0),className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors",children:T.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),T.jsx("button",{onClick:()=>r(n.id),className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors",children:T.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),T.jsx("button",{onClick:()=>t(n.id),className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-red-500/50 transition-colors",children:T.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),be&&T.jsx(OV,{trip:n,onClose:()=>Fe(!1),onUpdateTrip:i})]}),T.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-5 text-white z-10",children:[We?T.jsx("div",{className:"flex items-center gap-2 mb-2",children:T.jsx("input",{value:je,onChange:Re=>un(Re.target.value),className:"bg-white/20 backdrop-blur-md text-white text-3xl font-black px-2 py-1 rounded-lg outline-none w-full",autoFocus:!0,onBlur:Pe,onKeyDown:Re=>Re.key==="Enter"&&Pe()})}):T.jsxs("h1",{className:"text-3xl font-black mb-2 leading-tight drop-shadow-md cursor-pointer hover:text-coral/90 transition-colors flex items-center gap-2",onClick:()=>{mt(!0),un(n.title)},children:[n.title,T.jsx(cw,{className:"w-5 h-5 opacity-50"})]}),T.jsxs("div",{className:"flex items-center gap-3 text-sm font-bold text-gray-200",children:[T.jsxs("span",{className:"bg-white/20 backdrop-blur-md px-2 py-0.5 rounded text-xs",children:[n.days," Days"]}),T.jsxs("span",{children:[n.startDate," - ",n.endDate]})]})]})]}),T.jsx("div",{className:"flex-1 overflow-y-auto bg-paper relative rounded-t-3xl -mt-6 z-20 shadow-[0_-4px_20px_rgba(0,0,0,0.1)]",children:T.jsxs("div",{className:"p-5 min-h-full",children:[m==="ITINERARY"&&T.jsx(s5,{trip:n,settings:l,onUpdateTrip:i,onOpenQuickExpense:gt}),m==="MAP"&&T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:"mb-4 flex gap-2",children:[T.jsxs("div",{className:"flex-1 relative",children:[T.jsx("input",{type:"text",value:M,onChange:Re=>z(Re.target.value),onKeyDown:Re=>Re.key==="Enter"&&ee(),placeholder:c.search_placeholder,className:"w-full pl-10 pr-4 py-2 rounded-full border border-sand focus:border-coral focus:ring-1 focus:ring-coral outline-none text-sm"}),T.jsx(xb,{className:"w-4 h-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2"})]}),T.jsx("button",{onClick:()=>ee(),disabled:te||!M.trim(),className:"bg-ink text-white px-4 py-2 rounded-full text-sm font-bold disabled:opacity-50 flex items-center gap-1",children:te?T.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):c.search_location})]}),T.jsx(L5,{trip:n,settings:l,searchedLocation:H,onItemClick:Re=>ee(Re),mapSearchQuery:M})]}),m==="BUDGET"&&T.jsx(r5,{trip:n,settings:l,onUpdateTrip:i}),m==="BOOKINGS"&&T.jsx(a5,{trip:n,settings:l,onUpdateTrip:i}),m==="SHOPPING"&&T.jsx(i5,{items:n.shoppingList||[],onUpdateItems:Re=>i==null?void 0:i({...n,shoppingList:Re}),settings:l})]})}),T.jsx("div",{className:"absolute bottom-6 left-6 right-6 bg-white/90 backdrop-blur-xl rounded-full shadow-2xl border border-white/50 p-1.5 flex justify-between items-center z-30",children:[{id:"ITINERARY",icon:uw,label:c.itinerary},{id:"MAP",icon:K0,label:c.map},{id:"BUDGET",icon:rw,label:c.budget},{id:"BOOKINGS",icon:aw,label:c.bookings},{id:"SHOPPING",icon:dw,label:c.shopping}].map(Re=>T.jsxs("button",{onClick:()=>g(Re.id),className:`flex-1 flex flex-col items-center justify-center py-2 rounded-full transition-all duration-300 ${m===Re.id?"bg-ink text-white shadow-lg scale-105":"text-gray-400 hover:text-ink hover:bg-gray-100"}`,children:[T.jsx(Re.icon,{className:`w-5 h-5 ${m===Re.id?"stroke-2":"stroke-[1.5]"}`}),m===Re.id&&T.jsx("span",{className:"text-[10px] font-bold mt-0.5",children:Re.label})]},Re.id))}),p&&T.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",children:T.jsxs("div",{className:"bg-white rounded-3xl p-6 w-full max-w-xs shadow-2xl animate-scale-in text-center",children:[T.jsx("div",{className:"w-16 h-16 bg-red-100 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:T.jsx(da,{className:"w-8 h-8"})}),T.jsx("h3",{className:"text-xl font-bold text-ink mb-2",children:c.delete_trip}),T.jsx("p",{className:"text-gray-500 mb-6",children:c.delete_trip_confirm.replace("{title}",n.title)}),T.jsxs("div",{className:"flex gap-3",children:[T.jsx("button",{onClick:()=>E(!1),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:c.cancel}),T.jsx("button",{onClick:ye,className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 shadow-lg shadow-red-500/30 transition-colors",children:c.delete})]})]})}),gn&&T.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>Et(!1),children:T.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:Re=>Re.stopPropagation(),children:[T.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:""}),T.jsxs("div",{className:"space-y-3",children:[T.jsxs("button",{onClick:()=>Ge("upload"),className:"w-full py-4 bg-white border border-sand rounded-xl font-bold text-ink hover:bg-gray-50 flex items-center justify-center gap-2",children:[T.jsx("span",{children:""})," "]}),T.jsx("button",{onClick:()=>Ge("ai"),disabled:Dt,className:"w-full py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:Dt?T.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):T.jsxs(T.Fragment,{children:[T.jsx("span",{children:""})," AI "]})}),T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"absolute inset-0 flex items-center",children:T.jsx("div",{className:"w-full border-t border-sand"})}),T.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:T.jsx("span",{className:"bg-paper px-2 text-gray-400",children:"OR"})})]}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{value:pt,onChange:Re=>Nt(Re.target.value),placeholder:"...",className:"flex-1 bg-white p-3 rounded-xl border border-sand outline-none"}),T.jsx("button",{onClick:()=>Ge("url"),disabled:!pt,className:"bg-ink text-white px-4 rounded-xl font-bold disabled:opacity-50",children:"OK"})]})]})]})}),ae&&T.jsx("div",{className:"fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>fe(!1),children:T.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:Re=>Re.stopPropagation(),children:[T.jsx("h3",{className:"text-xl font-bold text-ink mb-2 text-center",children:""}),T.jsx("p",{className:"text-center text-gray-400 text-sm mb-6",children:ge==null?void 0:ge.activity}),T.jsxs("div",{className:"space-y-4",children:[j.map((Re,$e)=>T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{value:Re.name,onChange:_t=>hn($e,"name",_t.target.value),placeholder:" (: )",className:"flex-1 bg-white p-3 rounded-xl font-bold border-none shadow-sm outline-none",autoFocus:$e===0}),T.jsx("input",{type:"number",value:Re.price,onChange:_t=>hn($e,"price",_t.target.value),placeholder:sl(Le),className:"w-24 bg-white p-3 rounded-xl font-bold border-none shadow-sm outline-none text-center",onFocus:_t=>_t.target.select()})]},$e)),T.jsx("button",{onClick:Ai,className:"text-xs font-bold text-coral flex items-center gap-1 mx-auto hover:bg-coral/10 px-3 py-1 rounded-lg transition-colors",children:"+ "}),T.jsxs("div",{className:"pt-4 border-t border-sand",children:[T.jsxs("div",{className:"flex justify-between items-center mb-4",children:[T.jsx("div",{className:"flex items-center gap-2",children:T.jsx("select",{value:Le,onChange:Re=>et(Re.target.value),className:"bg-transparent font-bold text-gray-400 outline-none text-sm",children:zg.map(Re=>T.jsx("option",{value:Re.code,children:Re.code},Re.code))})}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("span",{className:"font-bold text-ink text-2xl",children:sl(Le)}),T.jsx("input",{type:"number",value:U,onChange:Re=>V(Re.target.value),className:"w-32 bg-transparent text-right text-3xl font-black border-none outline-none p-0",placeholder:"0",onFocus:Re=>Re.target.select()})]})]}),Le!==ii&&T.jsxs("div",{className:"mb-4 bg-sand/30 p-3 rounded-xl",children:[T.jsxs("div",{className:"flex justify-between items-center mb-2",children:[T.jsxs("label",{className:"text-xs font-bold text-gray-500",children:[" (",Le,"  ",ii,")"]}),T.jsxs("span",{className:"text-xs font-bold text-coral",children:[" ",cn,Se.toLocaleString()]})]}),T.jsxs("div",{className:"relative",children:[T.jsx("input",{value:ne,onChange:Re=>Ae(Re.target.value),type:"number",step:"0.01",placeholder:Ie?"...":"Exchange Rate",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none",onFocus:Re=>Re.target.select(),disabled:Ie}),Ie&&T.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:T.jsx("div",{className:"w-4 h-4 border-2 border-coral border-t-transparent rounded-full animate-spin"})})]}),!l.apiKey&&T.jsx("p",{className:"text-[10px] text-red-400 mt-1",children:"*  API Key "}),de&&T.jsxs("p",{className:"text-[10px] text-red-400 mt-1",children:["* ",de]})]}),T.jsx("textarea",{value:F,onChange:Re=>q(Re.target.value),placeholder:"...",className:"w-full bg-white p-3 rounded-xl text-sm font-medium border-none shadow-sm outline-none min-h-[60px]"})]}),T.jsx("button",{onClick:lt,disabled:!U,className:"w-full bg-ink text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-ink/30 mt-2 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:""})]})]})})]})},zV=({onStartGeneration:n,onCancel:e,settings:t,sessions:i,currentSessionId:r,onCreateSession:l,onUpdateSession:c,onDeleteSession:m,onSelectSession:g})=>{const p=Xt[t.language]||Xt["zh-TW"],[E,S]=W.useState(""),[C,M]=W.useState(!1),[z,H]=W.useState(!1),Y=W.useRef(null),te=i.find(J=>J.id===r),re=(te==null?void 0:te.messages)||[],ee=()=>{var J;(J=Y.current)==null||J.scrollIntoView({behavior:"smooth"})};W.useEffect(ee,[re]),W.useEffect(()=>{r&&re.length===0?c(r,[{role:"ai",content:p.ai_planner_intro,timestamp:Date.now()}]):!r&&i.length===0?l():!r&&i.length>0&&g(i[0].id)},[r,i.length]);const ge=()=>{l(),H(!1)},pe=async()=>{if(!E.trim()||!r)return;const J={role:"user",content:E,timestamp:Date.now()},k=[...re,J];c(r,k),S(""),M(!0);const U={role:"ai",content:p.ai_planning,timestamp:Date.now()};c(r,[...k,U]),n(E,te==null?void 0:te.tripId).then(V=>{const F={role:"ai",content:p.ai_done,timestamp:Date.now()};V?c(r,[...k,F],V.title,V.tripId):c(r,[...k,F]),M(!1)})};return T.jsxs("div",{className:"flex h-full bg-paper pt-safe relative overflow-hidden",children:[z&&T.jsx("div",{className:"absolute inset-0 bg-black/20 z-20 backdrop-blur-sm",onClick:()=>H(!1)}),T.jsxs("div",{className:`absolute top-0 left-0 bottom-0 w-64 bg-white shadow-2xl z-30 transform transition-transform duration-300 ease-in-out ${z?"translate-x-0":"-translate-x-full"}`,children:[T.jsxs("div",{className:"p-4 border-b border-sand flex justify-between items-center pt-12",children:[T.jsx("h3",{className:"font-bold text-lg text-ink",children:t.language==="zh-TW"?"":"Chat History"}),T.jsx("button",{onClick:ge,className:"p-2 bg-coral/10 rounded-full text-coral hover:bg-coral/20",children:T.jsx(Ig,{className:"w-5 h-5"})})]}),T.jsxs("div",{className:"overflow-y-auto h-full pb-20",children:[i.map(J=>T.jsxs("div",{onClick:()=>{g(J.id),H(!1)},className:`p-4 border-b border-sand/50 cursor-pointer hover:bg-sand/30 transition-colors ${r===J.id?"bg-sand/50 border-l-4 border-l-coral":""}`,children:[T.jsx("div",{className:"font-medium text-ink truncate",children:J.title}),T.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(J.updatedAt).toLocaleDateString()})]},J.id)),i.length===0&&T.jsx("div",{className:"p-8 text-center text-gray-400 text-sm",children:t.language==="zh-TW"?"":"No chat history"})]})]}),T.jsxs("div",{className:"flex-1 flex flex-col h-full w-full",children:[T.jsxs("div",{className:"px-4 py-3 border-b border-sand/50 flex items-center justify-between bg-paper sticky top-0 z-10 pt-safe pt-4",children:[T.jsxs("div",{className:"flex items-center",children:[T.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-white text-gray-500 transition-colors",children:T.jsx(hs,{className:"w-6 h-6"})}),T.jsx("button",{onClick:()=>H(!0),className:"ml-2 p-2 rounded-full hover:bg-white text-gray-500 transition-colors",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})}),T.jsxs("h2",{className:"text-lg font-bold text-ink ml-2 flex items-center gap-2 truncate max-w-[150px]",children:[T.jsx(lw,{className:"w-5 h-5 text-coral"}),(te==null?void 0:te.title)||p.ai_planner_title]})]}),T.jsx("button",{onClick:ge,className:"text-xs font-bold text-coral border border-coral/30 px-3 py-1.5 rounded-full hover:bg-coral/10 transition-colors",children:t.language==="zh-TW"?"":"New Chat"})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24",children:[re.map((J,k)=>T.jsx("div",{className:`flex ${J.role==="user"?"justify-end":"justify-start"} animate-slide-up`,children:T.jsx("div",{className:`max-w-[85%] p-4 rounded-2xl text-sm font-medium leading-relaxed shadow-sm whitespace-pre-line ${J.role==="user"?"bg-coral text-white rounded-tr-none":"bg-white text-ink border border-sand rounded-tl-none"}`,children:J.content})},k)),C&&T.jsx("div",{className:"flex justify-start",children:T.jsxs("div",{className:"bg-white p-4 rounded-2xl rounded-tl-none border border-sand flex items-center gap-2",children:[T.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce"}),T.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce delay-100"}),T.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce delay-200"}),T.jsx("span",{className:"text-xs text-gray-400 font-bold ml-1",children:p.planning_process})]})}),T.jsx("div",{ref:Y})]}),T.jsxs("div",{className:"p-4 bg-white/90 backdrop-blur border-t border-sand pb-32",children:[T.jsxs("div",{className:"flex gap-2",children:[T.jsx("textarea",{value:E,onChange:J=>S(J.target.value),onKeyDown:J=>{J.key==="Enter"&&!J.shiftKey&&(J.preventDefault(),pe())},placeholder:p.input_placeholder,className:"flex-1 bg-paper rounded-2xl px-5 py-3.5 outline-none focus:ring-2 focus:ring-coral/50 transition-all font-medium text-ink placeholder:text-gray-400 border border-sand resize-none min-h-[50px] max-h-[120px]",disabled:C,rows:1}),T.jsx("button",{onClick:pe,disabled:!E.trim()||C,className:"bg-coral text-white p-3.5 rounded-2xl disabled:opacity-50 active:scale-95 transition-transform shadow-lg shadow-coral/20",children:T.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:T.jsx("path",{d:"M3.105 2.289a.75.75 0 0 0-.826.95l1.414 4.925A1.5 1.5 0 0 0 5.135 9.25h6.115a.75.75 0 0 1 0 1.5H5.135a1.5 1.5 0 0 0-1.442 1.086l-1.414 4.926a.75.75 0 0 0 .826.95 28.896 28.896 0 0 0 15.293-7.154.75.75 0 0 0 0-1.115A28.897 28.897 0 0 0 3.105 2.289Z"})})})]}),T.jsx("div",{className:"flex gap-2 mt-3 overflow-x-auto no-scrollbar pb-2",children:[p.prompt_tokyo,p.prompt_bangkok,p.prompt_paris].map(J=>T.jsx("button",{onClick:()=>S(J),className:"whitespace-nowrap px-4 py-2 bg-white text-gray-500 text-xs font-bold rounded-xl border border-sand hover:text-coral hover:border-coral transition-colors",disabled:C,children:J},J))})]})]})]})},BV="https://api.exchangerate-api.com/v4/latest/TWD";let Ic=null,tw=0;const FV=1440*60*1e3,qV=async()=>{const n=Date.now();if(Ic&&n-tw<FV)return Ic;try{const t=await(await fetch(BV)).json();return Ic=t,tw=n,t}catch(e){return console.error("Failed to fetch exchange rates:",e),Ic||{base:"TWD",rates:{TWD:1,JPY:.22,KRW:.043,USD:31.5,EUR:34.2}}}},HV=async(n,e)=>{if(e==="TWD")return n;const i=(await qV()).rates[e];return i?n/i:(console.warn(`Unknown currency: ${e}`),n)},GV=(n,e="TWD")=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:e==="TWD"?"TWD":e,minimumFractionDigits:0,maximumFractionDigits:0}).format(n),NA=()=>"webkitSpeechRecognition"in window||"SpeechRecognition"in window,F_=()=>"speechSynthesis"in window,jV=(n="zh-TW",e,t)=>{if(!NA())return t==null||t(""),null;const i=window.webkitSpeechRecognition||window.SpeechRecognition,r=new i;return r.continuous=!1,r.interimResults=!1,r.lang=n,r.onresult=l=>{const c=l.results[0][0].transcript;e(c)},r.onerror=l=>{t==null||t(l.error)},r.start(),r},RA=(n,e="zh-TW",t)=>{if(!F_()){console.error("");return}window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(n);i.lang=e,i.rate=1,i.pitch=1,i.volume=1,t&&(i.onend=t),window.speechSynthesis.speak(i)},KV=()=>{F_()&&window.speechSynthesis.cancel()},ZV=async(n,e,t,i,r)=>new Promise((l,c)=>{jV(n,async g=>{t==null||t(g);try{const p=await Ww(g,e,n);p?(i==null||i(p),RA(p,e,()=>{l()})):(r==null||r(""),c("Translation failed"))}catch(p){r==null||r(p),c(p)}},g=>{r==null||r(g),c(g)})||c("Speech recognition not supported")}),vh={recognition:NA(),synthesis:F_()};function YV({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"}))}const WV=W.forwardRef(YV);function JV({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"}))}const QV=W.forwardRef(JV);function $V({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const nw=W.forwardRef($V);function XV({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"}))}const eO=W.forwardRef(XV),tO=({defaultSourceLang:n="zh-TW",defaultTargetLang:e="en-US"})=>{const[t,i]=W.useState(n),[r,l]=W.useState(e),[c,m]=W.useState(""),[g,p]=W.useState(""),[E,S]=W.useState(!1),[C,M]=W.useState(!1),[z,H]=W.useState(""),Y=[{code:"zh-TW",name:""},{code:"en-US",name:"English"},{code:"ja-JP",name:""},{code:"ko-KR",name:""},{code:"th-TH",name:""}],te=async()=>{if(!vh.recognition){H("");return}H(""),S(!0),m(""),p("");try{await ZV(t,r,pe=>{m(pe)},pe=>{p(pe),M(!0)},pe=>{H(`${pe}`)})}catch(pe){console.error(pe)}finally{S(!1),M(!1)}},re=()=>{i(r),l(t),m(""),p("")},ee=(pe,J)=>{if(!vh.synthesis){H("");return}RA(pe,J)},ge=()=>{KV(),M(!1)};return T.jsxs("div",{className:"max-w-4xl mx-auto p-6 pt-12 bg-paper rounded-3xl shadow-float",children:[T.jsx("h2",{className:"text-2xl font-bold text-ink mb-6 text-center",children:" "}),T.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[T.jsx("select",{value:t,onChange:pe=>i(pe.target.value),className:"flex-1 p-3 rounded-xl border-2 border-sand bg-white text-ink font-medium focus:border-coral outline-none",children:Y.map(pe=>T.jsx("option",{value:pe.code,children:pe.name},pe.code))}),T.jsx("button",{onClick:re,className:"p-3 rounded-full bg-coral text-white hover:bg-coralDark active:scale-95 transition-all",children:T.jsx(WV,{className:"w-5 h-5"})}),T.jsx("select",{value:r,onChange:pe=>l(pe.target.value),className:"flex-1 p-3 rounded-xl border-2 border-sand bg-white text-ink font-medium focus:border-coral outline-none",children:Y.map(pe=>T.jsx("option",{value:pe.code,children:pe.name},pe.code))})]}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[T.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-sand min-h-[120px] flex flex-col",children:[T.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:" ()"}),c&&T.jsx("button",{onClick:()=>ee(c,t),className:"p-1 text-coral hover:text-coralDark",children:T.jsx(nw,{className:"w-4 h-4"})})]}),T.jsx("textarea",{value:c,onChange:pe=>m(pe.target.value),placeholder:"...",className:"w-full flex-1 resize-none outline-none text-ink bg-transparent placeholder:text-gray-300"})]}),T.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-sand min-h-[120px]",children:[T.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),g&&T.jsx("button",{onClick:()=>ee(g,r),className:"p-1 text-coral hover:text-coralDark",children:T.jsx(nw,{className:"w-4 h-4"})})]}),T.jsx("p",{className:"text-ink whitespace-pre-wrap",children:g||"..."})]})]}),z&&T.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm",children:z}),T.jsxs("div",{className:"flex gap-3",children:[T.jsxs("button",{onClick:te,disabled:E||C,className:`flex-1 py-4 rounded-2xl font-bold text-lg flex items-center justify-center gap-2 transition-all ${E?"bg-red-500 text-white animate-pulse":"bg-coral text-white hover:bg-coralDark active:scale-95"}`,children:[T.jsx(QV,{className:"w-6 h-6"}),E?"...":""]}),(E||C)&&T.jsxs("button",{onClick:ge,className:"px-6 py-4 rounded-2xl font-bold bg-gray-500 text-white hover:bg-gray-600 active:scale-95 transition-all flex items-center gap-2",children:[T.jsx(eO,{className:"w-6 h-6"}),""]})]}),(!vh.recognition||!vh.synthesis)&&T.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-xl text-yellow-800 text-sm",children:"  ChromeEdge  Safari "})]})},nO=({onBack:n})=>T.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[T.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[T.jsx("button",{onClick:n,children:T.jsx(hs,{className:"w-6 h-6 text-gray-500"})}),T.jsx("h3",{className:"font-bold text-lg text-ink",children:""})]}),T.jsx("div",{className:"p-5 flex items-center justify-center h-full text-gray-400 text-center font-medium",children:T.jsx("p",{children:""})})]}),iO=({onBack:n,t:e,language:t,onOpenSettings:i})=>{const[r,l]=W.useState("Taiwan (ROC)"),[c,m]=W.useState(""),[g,p]=W.useState(null),[E,S]=W.useState(!1),C=async()=>{if(c){S(!0);try{const M=await Hw(r,c,t);p(M||"")}catch(M){p(M.message||"")}finally{S(!1)}}};return T.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[T.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[T.jsx("button",{onClick:n,children:T.jsx(hs,{className:"w-6 h-6 text-gray-500"})}),T.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_visa})]}),T.jsxs("div",{className:"p-5 space-y-4 overflow-y-auto flex-1 pb-32",children:[T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card space-y-5 border border-sand",children:[T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),T.jsxs("select",{value:r,onChange:M=>l(M.target.value),className:"w-full mt-2 p-3 bg-paper rounded-xl text-ink font-medium border-none outline-none",children:[T.jsx("option",{value:"Taiwan (ROC)",children:" (Taiwan)"}),T.jsx("option",{value:"Japan",children:" (Japan)"}),T.jsx("option",{value:"USA",children:" (USA)"}),T.jsx("option",{value:"Hong Kong",children:" (Hong Kong)"})]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),T.jsx("input",{value:c,onChange:M=>m(M.target.value),placeholder:"...",className:"w-full mt-2 p-3 bg-paper rounded-xl text-ink font-medium border-none outline-none"})]}),T.jsx("button",{onClick:C,disabled:E||!c,className:"w-full bg-coral text-white py-3.5 rounded-xl font-bold shadow-lg shadow-coral/30 disabled:opacity-50",children:E?e.loading:e.confirm})]}),g&&T.jsx("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand animate-fade-in",children:T.jsxs("div",{className:`prose prose-sm max-w-none leading-relaxed whitespace-pre-line ${g!=null&&g.includes("API Key")?"text-red-600":"text-ink"}`,children:[g,(g==null?void 0:g.includes("API Key"))&&T.jsx("button",{onClick:i,className:"mt-4 w-full py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg shadow-red-500/20 hover:bg-red-600 transition-colors",children:" API Key"})]})})]})]})},sO=({onBack:n,t:e,language:t,onOpenSettings:i})=>{const[r,l]=W.useState(""),[c,m]=W.useState(null),[g,p]=W.useState(!1),E=async()=>{p(!0);try{const C=await Gw(r||"Kyoto, Japan",t);m(C||"")}catch(S){m(S.message||"")}finally{p(!1)}};return T.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[T.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[T.jsx("button",{onClick:n,children:T.jsx(hs,{className:"w-6 h-6 text-gray-500"})}),T.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_culture})]}),T.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[T.jsx("div",{className:"mb-4",children:T.jsx("input",{value:r,onChange:S=>l(S.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl shadow-sm border border-sand font-medium text-ink outline-none"})}),T.jsx("button",{onClick:E,disabled:g,className:"w-full bg-orange-400 text-white px-4 py-3.5 rounded-2xl font-bold text-sm shadow-md mb-6",children:g?e.loading:e.confirm}),c&&T.jsx("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand animate-fade-in",children:T.jsxs("div",{className:`prose prose-sm whitespace-pre-line leading-relaxed ${c!=null&&c.includes("API Key")?"text-red-600":"text-ink"}`,children:[c,(c==null?void 0:c.includes("API Key"))&&T.jsx("button",{onClick:i,className:"mt-4 w-full py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg shadow-red-500/20 hover:bg-red-600 transition-colors",children:" API Key"})]})})]})]})},oO=({onBack:n,t:e})=>T.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[T.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[T.jsx("button",{onClick:n,children:T.jsx(hs,{className:"w-6 h-6 text-gray-500"})}),T.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_restroom})]}),T.jsx("div",{className:"flex-1 relative rounded-t-3xl overflow-hidden shadow-inner border-t border-sand",children:T.jsx("iframe",{width:"100%",height:"100%",style:{border:0},loading:"lazy",allowFullScreen:!0,src:"https://maps.google.com/maps?q=public+restroom&output=embed"})})]}),rO=({onBack:n,t:e,language:t,onOpenSettings:i})=>{const[r,l]=W.useState(""),[c,m]=W.useState(null),[g,p]=W.useState(!1),E=async()=>{if(r){p(!0);try{const C=await Kw(r,t);m(C)}catch{m("")}finally{p(!1)}}},S=c&&(c.includes("API Key")||c.includes("403"));return T.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[T.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[T.jsx("button",{onClick:n,children:T.jsx(hs,{className:"w-6 h-6 text-gray-500"})}),T.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_emergency})]}),T.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[T.jsxs("div",{className:"bg-red-500 text-white p-6 rounded-3xl shadow-lg shadow-red-500/20 mb-6",children:[T.jsx("h2",{className:"text-xl font-bold mb-2",children:"SOS?"}),T.jsxs("p",{className:"opacity-90 text-sm",children:[": ",T.jsx("span",{className:"font-black text-2xl ml-1",children:"112"})]})]}),T.jsxs("div",{className:"space-y-3",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:""}),T.jsx("input",{value:r,onChange:C=>l(C.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl border border-sand shadow-sm outline-none"}),T.jsx("button",{onClick:E,disabled:g||!r,className:"w-full py-3.5 bg-ink text-white rounded-2xl font-bold shadow-lg",children:g?e.loading:e.confirm})]}),c&&T.jsxs("div",{className:`mt-6 p-6 rounded-3xl shadow-card border whitespace-pre-line leading-relaxed ${S?"bg-red-50 border-red-200 text-red-600":"bg-white border-sand text-ink"}`,children:[c,S&&T.jsx("button",{onClick:i,className:"mt-4 w-full py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg shadow-red-500/20 hover:bg-red-600 transition-colors",children:" API Key"})]})]})]})},aO=({onBack:n,t:e,language:t,onOpenSettings:i})=>{const[r,l]=W.useState(""),[c,m]=W.useState(null),[g,p]=W.useState(!1),E=async()=>{if(r){p(!0);try{const S=await Zw(r,t);m(S)}catch{m("")}finally{p(!1)}}};return T.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[T.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[T.jsx("button",{onClick:n,children:T.jsx(hs,{className:"w-6 h-6 text-gray-500"})}),T.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_card})]}),T.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[T.jsxs("div",{className:"space-y-3",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:""}),T.jsx("input",{value:r,onChange:S=>l(S.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl border border-sand shadow-sm outline-none"}),T.jsx("button",{onClick:E,disabled:g||!r,className:"w-full py-3.5 bg-indigo-500 text-white rounded-2xl font-bold shadow-lg shadow-indigo-200",children:g?e.loading:e.confirm})]}),c&&T.jsxs("div",{className:`mt-6 bg-white p-6 rounded-3xl shadow-card border border-sand whitespace-pre-line leading-relaxed ${c!=null&&c.includes("API Key")?"text-red-600":"text-ink"}`,children:[c,(c==null?void 0:c.includes("API Key"))&&T.jsx("button",{onClick:i,className:"mt-4 w-full py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg shadow-red-500/20 hover:bg-red-600 transition-colors",children:" API Key"})]})]})]})};let lO=pl.icon({iconUrl:sS,shadowUrl:oS,iconSize:[25,41],iconAnchor:[12,41]});pl.Marker.prototype.options.icon=lO;const iw={Japan:[36.2048,138.2529],Taiwan:[23.6978,120.9605],Thailand:[15.87,100.9925],USA:[37.0902,-95.7129],France:[46.2276,2.2137],"South Korea":[35.9078,127.7669],Vietnam:[14.0583,108.2772],China:[35.8617,104.1954],Germany:[51.1657,10.4515],Italy:[41.8719,12.5674],UK:[55.3781,-3.436],Spain:[40.4637,-3.7492],Australia:[-25.2744,133.7751],Canada:[56.1304,-106.3468],Singapore:[1.3521,103.8198],Malaysia:[4.2105,101.9758],Philippines:[12.8797,121.774],Indonesia:[-.7893,113.9213],India:[20.5937,78.9629],Russia:[61.524,105.3188],Brazil:[-14.235,-51.9253],Mexico:[23.6345,-102.5528],Egypt:[26.8206,30.8025],Turkey:[38.9637,35.2433],Netherlands:[52.1326,5.2913],Switzerland:[46.8182,8.2275],Austria:[47.5162,14.5501],Belgium:[50.5039,4.4699],Sweden:[60.1282,18.6435],Norway:[60.472,8.4689],Denmark:[56.2639,9.5018],Finland:[61.9241,25.7482],"New Zealand":[-40.9006,174.886],"Hong Kong":[22.3193,114.1694],Macau:[22.1987,113.5439]},uO=({onReady:n})=>{const e=ff();return W.useEffect(()=>{const t=setTimeout(()=>{e.invalidateSize(),n()},250);return()=>clearTimeout(t)},[e,n]),null},cO=({onBack:n,trips:e,t})=>{const[i,r]=W.useState(new Set(["Japan","Thailand","Taiwan"])),[l,c]=W.useState(""),[m,g]=W.useState(!1);W.useEffect(()=>{if(e){const S=new Set(i);e.forEach(C=>{(C.title.includes("")||C.title.includes("Japan")||C.title.includes("")||C.title.includes("")||C.title.includes("Tokyo"))&&S.add("Japan"),(C.title.includes("")||C.title.includes("Thailand")||C.title.includes(""))&&S.add("Thailand"),(C.title.includes("")||C.title.includes("Taiwan")||C.title.includes(""))&&S.add("Taiwan"),(C.title.includes("")||C.title.includes("USA"))&&S.add("USA"),(C.title.includes("")||C.title.includes("France")||C.title.includes("Paris"))&&S.add("France"),(C.title.includes("")||C.title.includes("Korea")||C.title.includes(""))&&S.add("South Korea"),(C.title.includes("")||C.title.includes("Vietnam"))&&S.add("Vietnam"),(C.title.includes("")||C.title.includes("China")||C.title.includes("")||C.title.includes(""))&&S.add("China"),(C.title.includes("")||C.title.includes("Hong Kong"))&&S.add("Hong Kong")}),r(S)}},[e]);const p=()=>{if(l.trim()){const S=l.trim(),C=Object.keys(iw).find(M=>M.toLowerCase()===S.toLowerCase());r(C?M=>new Set(M).add(C):M=>new Set(M).add(S)),c("")}},E=S=>{const C=new Set(i);C.delete(S),r(C)};return T.jsxs("div",{className:"flex flex-col h-full bg-[#111827] text-white",children:[T.jsx("div",{className:"bg-[#111827] p-4 flex items-center justify-between sticky top-0 z-10 border-b border-gray-800",children:T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("button",{onClick:n,children:T.jsx(hs,{className:"w-6 h-6 text-gray-300"})}),T.jsx("h3",{className:"font-bold text-lg",children:t.tool_map})]})}),T.jsxs("div",{className:"p-6 flex-1 overflow-y-auto pb-32",children:[T.jsxs("div",{className:"relative w-full aspect-[1.6] bg-[#1F2937] rounded-3xl overflow-hidden mb-8 shadow-2xl border border-gray-700",children:[T.jsxs(nS,{center:[20,0],zoom:2,style:{height:"100%",width:"100%",background:"#1F2937"},zoomControl:!1,attributionControl:!1,children:[T.jsx(iS,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),T.jsx(uO,{onReady:()=>g(!0)}),Array.from(i).map(S=>{const C=iw[S];return C?T.jsx(qg,{position:C,icon:pl.divIcon({className:"custom-div-icon",html:'<div style="background-color: #FF6B6B; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 10px #FF6B6B;"></div>',iconSize:[12,12],iconAnchor:[6,6]}),children:T.jsx(Hg,{children:T.jsx("div",{className:"text-ink font-bold",children:S})})},S):null})]}),T.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center pointer-events-none",children:T.jsx("div",{className:"inline-block bg-black/50 backdrop-blur-sm px-3 py-1 rounded-full text-xs text-gray-400 font-mono tracking-widest border border-white/10",children:"[  ]"})})]}),T.jsxs("div",{className:"bg-[#1F2937] rounded-3xl p-6 shadow-lg border border-gray-700 mb-6",children:[T.jsxs("div",{className:"flex justify-between items-center mb-5",children:[T.jsxs("h4",{className:"font-bold text-gray-200",children:[" (",i.size,")"]}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{value:l,onChange:S=>c(S.target.value),placeholder:" ()...",className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-1.5 text-sm text-white focus:outline-none focus:border-coral w-36 placeholder-gray-500"}),T.jsx("button",{onClick:p,className:"bg-coral p-1.5 rounded-lg text-white hover:bg-coralDark",children:T.jsx(nf,{className:"w-4 h-4"})})]})]}),T.jsx("div",{className:"flex flex-wrap gap-3",children:Array.from(i).map(S=>T.jsxs("div",{className:"group relative px-4 py-2 bg-coral/10 text-coral rounded-xl text-sm font-bold border border-coral/20 flex items-center gap-2",children:[S," ",T.jsx("button",{onClick:()=>E(S),className:"opacity-0 group-hover:opacity-100 absolute -top-2 -right-2 bg-white text-coral rounded-full p-0.5 transition-opacity",children:T.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},S))})]})]})]})},dO=({onBack:n,t:e})=>{const[t,i]=W.useState(""),[r,l]=W.useState("USD"),[c,m]=W.useState(null),[g,p]=W.useState(!1),E=[{code:"USD",name:" (USD)"},{code:"JPY",name:" (JPY)"},{code:"KRW",name:" (KRW)"},{code:"EUR",name:" (EUR)"},{code:"CNY",name:" (CNY)"},{code:"THB",name:" (THB)"},{code:"VND",name:" (VND)"}],S=async()=>{if(t){p(!0);try{const C=parseFloat(t),M=await HV(C,r);m(GV(M))}catch{m("")}finally{p(!1)}}};return T.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[T.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[T.jsx("button",{onClick:n,children:T.jsx(hs,{className:"w-6 h-6 text-gray-500"})}),T.jsx("h3",{className:"font-bold text-lg text-ink",children:""})]}),T.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[T.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand space-y-5",children:[T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),T.jsx("input",{type:"number",value:t,onChange:C=>i(C.target.value),placeholder:"...",className:"w-full mt-2 p-4 bg-paper rounded-2xl text-xl font-bold text-ink border-none outline-none"})]}),T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),T.jsx("select",{value:r,onChange:C=>l(C.target.value),className:"w-full mt-2 p-4 bg-paper rounded-2xl text-ink font-medium border-none outline-none",children:E.map(C=>T.jsx("option",{value:C.code,children:C.name},C.code))})]}),T.jsx("button",{onClick:S,disabled:g||!t,className:"w-full bg-green-500 text-white py-4 rounded-2xl font-bold shadow-lg shadow-green-500/30 disabled:opacity-50 active:scale-95 transition-all",children:g?"...":" (TWD)"})]}),c&&T.jsxs("div",{className:"mt-6 bg-white p-6 rounded-3xl shadow-card border border-sand text-center animate-fade-in",children:[T.jsx("p",{className:"text-gray-400 text-sm font-medium mb-1",children:""}),T.jsx("p",{className:"text-3xl font-black text-ink",children:c})]})]})]})},hO=({onBack:n,t:e,language:t})=>T.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[T.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[T.jsx("button",{onClick:n,children:T.jsx(hs,{className:"w-6 h-6 text-gray-500"})}),T.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_translation||"Translation"})]}),T.jsx("div",{className:"flex-1 overflow-y-auto pb-32",children:T.jsx(tO,{defaultSourceLang:t})})]}),fO=({onBack:n,trips:e,settings:t,onMagicEditor:i,onOpenSettings:r})=>{const[l,c]=W.useState("MENU"),m=Xt[t.language]||Xt["zh-TW"];if(l==="EXPENSE")return T.jsx(nO,{onBack:()=>c("MENU")});if(l==="VISA")return T.jsx(iO,{onBack:()=>c("MENU"),t:m,language:t.language,onOpenSettings:r});if(l==="CULTURE")return T.jsx(sO,{onBack:()=>c("MENU"),t:m,language:t.language,onOpenSettings:r});if(l==="RESTROOM")return T.jsx(oO,{onBack:()=>c("MENU"),t:m});if(l==="SCRATCH_MAP")return T.jsx(cO,{onBack:()=>c("MENU"),trips:e,t:m});if(l==="EMERGENCY")return T.jsx(rO,{onBack:()=>c("MENU"),t:m,language:t.language,onOpenSettings:r});if(l==="CARD_ADVICE")return T.jsx(aO,{onBack:()=>c("MENU"),t:m,language:t.language,onOpenSettings:r});if(l==="TIME_CAPSULE")return T.jsx("div",{onClick:()=>c("MENU"),children:"Coming Soon"});if(l==="TRANSLATION")return T.jsx(hO,{onBack:()=>c("MENU"),t:m,language:t.language});if(l==="CURRENCY")return T.jsx(dO,{onBack:()=>c("MENU"),t:m});const g=[{id:"MAGIC_EDITOR",name:"",icon:sa,color:"text-pink-500",bg:"bg-pink-50",desc:"AI ",action:i},{id:"CURRENCY",name:"",icon:lb,color:"text-green-500",bg:"bg-green-50",desc:""},{id:"TRANSLATION",name:m.tool_translation,icon:pb,color:"text-purple-500",bg:"bg-purple-50",desc:m.desc_translator},{id:"EMERGENCY",name:m.tool_emergency,icon:fb,color:"text-red-500",bg:"bg-red-50",desc:m.desc_emergency},{id:"CARD_ADVICE",name:m.tool_card,icon:mb,color:"text-indigo-500",bg:"bg-indigo-50",desc:m.desc_card},{id:"SCRATCH_MAP",name:m.tool_map,icon:db,color:"text-teal-500",bg:"bg-teal-50",desc:m.desc_map},{id:"RESTROOM",name:m.tool_restroom,icon:cb,color:"text-cyan-500",bg:"bg-cyan-50",desc:m.desc_restroom},{id:"VISA",name:m.tool_visa,icon:ub,color:"text-blue-500",bg:"bg-blue-50",desc:m.desc_visa},{id:"CULTURE",name:m.tool_culture,icon:Bp,color:"text-orange-500",bg:"bg-orange-50",desc:m.desc_culture}];return T.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[T.jsx("div",{className:"px-5 py-4 bg-paper sticky top-0 z-10 flex items-center justify-between border-b border-sand/50",children:T.jsxs("h2",{className:"text-xl font-extrabold text-ink flex items-center gap-2",children:[T.jsx(Ig,{className:"w-6 h-6 text-coral"}),m.tools_title]})}),T.jsx("div",{className:"p-5 grid grid-cols-2 gap-4 pb-32 overflow-y-auto",children:g.map(p=>T.jsxs("div",{onClick:()=>p.action?p.action():c(p.id),className:"bg-white p-5 rounded-3xl shadow-card border border-sand active:scale-95 transition-all cursor-pointer hover:shadow-soft hover:border-coral group",children:[T.jsx("div",{className:`w-12 h-12 ${p.bg} ${p.color} rounded-2xl flex items-center justify-center mb-4 transition-transform group-hover:scale-110`,children:T.jsx(p.icon,{className:"w-6 h-6 stroke-2"})}),T.jsx("h3",{className:"font-bold text-ink mb-1",children:p.name}),T.jsx("p",{className:"text-xs text-gray-400 font-medium",children:p.desc})]},p.id))})]})},mO=({onBack:n,settings:e,onUpdateSettings:t,onResetApp:i,user:r,onLogout:l})=>{const[c,m]=W.useState(!1),[g,p]=W.useState(!1),E=Xt[e.language]||Xt["zh-TW"];W.useEffect(()=>{const M=localStorage.getItem("nomad_user_api_key");M&&!e.apiKey&&(t({apiKey:M}),localStorage.removeItem("nomad_user_api_key"))},[]);const S=M=>{t({apiKey:M}),localStorage.setItem("geminiApiKey",M),M&&(p(!0),setTimeout(()=>p(!1),2e3))},C=[{name:"",value:"#FF6B6B"},{name:"",value:"#4ECDC4"},{name:"",value:"#FFE66D"},{name:"",value:"#A06CD5"},{name:"",value:"#6BCB77"}];return T.jsxs("div",{className:"h-full flex flex-col bg-paper animate-slide-in",children:[T.jsxs("div",{className:"px-6 py-6 flex items-center justify-between bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-sand",children:[T.jsx("button",{onClick:n,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 transition-colors",children:T.jsx(hs,{className:"w-6 h-6 text-ink"})}),T.jsx("h1",{className:"text-xl font-bold text-ink",children:""}),T.jsx("div",{className:"w-10"})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[r&&T.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[T.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-lg font-bold text-ink",children:r.username}),T.jsxs("p",{className:"text-xs text-gray-400",children:["ID: ",r.id]})]}),T.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-xl transition-colors text-sm font-medium",children:[T.jsx(vb,{className:"w-4 h-4"}),""]})]})]}),T.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[T.jsxs("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider flex items-center gap-2",children:[T.jsx(Tb,{className:"w-4 h-4"}),E.api_settings||"API "]}),T.jsxs("div",{className:"space-y-3",children:[T.jsx("label",{className:"text-sm font-bold text-ink",children:E.api_key_label||"Gemini API Key"}),T.jsxs("div",{className:"relative",children:[T.jsx("input",{type:"password",value:e.apiKey||"",onChange:M=>S(M.target.value),placeholder:E.api_key_placeholder||" API Key",className:"w-full p-4 pr-20 bg-gray-50 rounded-xl border border-gray-200 focus:border-coral focus:ring-2 focus:ring-coral/20 outline-none transition-all font-mono text-sm"}),g&&T.jsx("div",{className:"text-right mt-1",children:T.jsx("span",{className:"text-green-500 text-xs font-bold animate-fade-in",children:E.api_key_saved||""})})]}),T.jsxs("p",{className:"text-xs text-gray-400 leading-relaxed",children:[E.api_key_help||" Key ",T.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-coral hover:underline ml-1",children:" Key"})]})]})]}),T.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[T.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),T.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:[C.map(M=>T.jsx("button",{onClick:()=>t({themeColor:M.value}),className:`w-10 h-10 rounded-full flex-shrink-0 transition-transform ${e.themeColor===M.value?"scale-110 ring-2 ring-offset-2 ring-gray-300":"hover:scale-105"}`,style:{backgroundColor:M.value},"aria-label":M.name},M.value)),T.jsx("button",{onClick:()=>t({themeColor:void 0}),className:`w-10 h-10 rounded-full flex-shrink-0 bg-coral flex items-center justify-center text-white text-xs font-bold transition-transform ${e.themeColor?"hover:scale-105":"scale-110 ring-2 ring-offset-2 ring-gray-300"}`,children:""})]})]}),T.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[T.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),T.jsx("div",{className:"space-y-2",children:[{code:"zh-TW",label:""},{code:"en-US",label:"English"},{code:"ja-JP",label:""}].map(M=>T.jsxs("button",{onClick:()=>t({language:M.code}),className:`w-full flex items-center justify-between p-3 rounded-xl transition-colors ${e.language===M.code?"bg-coral/10 text-coral font-bold":"hover:bg-gray-50 text-ink"}`,children:[T.jsx("span",{children:M.label}),e.language===M.code&&T.jsx("div",{className:"w-2 h-2 rounded-full bg-coral"})]},M.code))})]}),T.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[T.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),c?T.jsxs("div",{className:"space-y-3 animate-fade-in",children:[T.jsx("p",{className:"text-center text-sm text-red-500 font-medium",children:""}),T.jsxs("div",{className:"flex gap-3",children:[T.jsx("button",{onClick:()=>m(!1),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold",children:""}),T.jsx("button",{onClick:()=>{i(),m(!1)},className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg shadow-red-500/30",children:""})]})]}):T.jsxs("button",{onClick:()=>m(!0),className:"w-full flex items-center justify-center gap-2 p-4 border-2 border-red-100 text-red-500 rounded-xl hover:bg-red-50 transition-colors font-bold",children:[T.jsx(da,{className:"w-5 h-5"}),""]})]}),T.jsxs("div",{className:"text-center text-xs text-gray-400 py-4",children:[T.jsx("p",{children:"NomadAI Travel Journal v1.0.0"}),T.jsx("p",{className:"mt-1",children:"Made with  by NomadAI Team"})]})]})]})},pO=({onLogin:n})=>{const[e,t]=W.useState(""),[i,r]=W.useState(!1),l=async()=>{console.log("Attempting Google Login..."),r(!0),t("");try{const c=await NL(Ag,VV);console.log("Google Login Success:",c.user.uid)}catch(c){console.error("Login failed",c),t(c.message||"")}finally{r(!1)}};return T.jsx("div",{className:"h-full flex flex-col items-center justify-center p-6 bg-paper",children:T.jsxs("div",{className:"w-full max-w-sm bg-white rounded-3xl shadow-card p-8 border border-sand text-center",children:[T.jsxs("div",{className:"flex flex-col items-center mb-8",children:[T.jsx("div",{className:"w-16 h-16 bg-coral rounded-2xl flex items-center justify-center mb-4 shadow-lg shadow-coral/30",children:T.jsx(sa,{className:"w-8 h-8 text-white"})}),T.jsx("h1",{className:"text-2xl font-bold text-ink",children:"Ques-trip"}),T.jsx("p",{className:"text-gray-400 text-sm mt-2",children:""})]}),T.jsxs("div",{className:"space-y-4",children:[T.jsxs("button",{id:"google-login-btn",onClick:l,disabled:i,className:"w-full bg-white border border-gray-300 text-gray-700 py-3.5 rounded-xl font-bold shadow-sm hover:bg-gray-50 active:scale-95 transition-all flex items-center justify-center gap-3",children:[i?T.jsx("div",{className:"w-5 h-5 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}):T.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[T.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),T.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),T.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.84z",fill:"#FBBC05"}),T.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]})," Google "]}),e&&T.jsx("div",{className:"text-red-500 text-sm font-medium bg-red-50 p-2 rounded-lg",children:e})]})]})})},gO=({memories:n,onAddMemory:e,onDeleteMemory:t,settings:i})=>{const[r,l]=W.useState(""),[c,m]=W.useState(null),g=W.useRef(null),p=async S=>{var M;const C=(M=S.target.files)==null?void 0:M[0];if(C)try{const{compressImage:z}=await lf(async()=>{const{compressImage:Y}=await import("./image-CYcWJ_KT.js");return{compressImage:Y}},[]),H=await z(C);m(H)}catch(z){console.error("Image compression failed",z),alert("")}},E=S=>{if(S.preventDefault(),!c)return;const C={id:Date.now().toString(),userId:"",imageUrl:c,caption:r,date:new Date().toISOString()};e(C),l(""),m(null),g.current&&(g.current.value="")};return T.jsxs("div",{className:"h-full flex flex-col bg-paper animate-slide-in pb-24",children:[T.jsxs("div",{className:"px-6 py-6 bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-sand pt-safe pt-12",children:[T.jsxs("h1",{className:"text-2xl font-bold text-ink flex items-center gap-2",children:[T.jsx(_u,{className:"w-8 h-8 text-coral"}),""]}),T.jsx("p",{className:"text-sm text-gray-400 mt-1",children:""})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[T.jsx("div",{className:"bg-white rounded-3xl p-6 shadow-card border border-sand",children:T.jsxs("form",{onSubmit:E,className:"space-y-4",children:[T.jsxs("div",{onClick:()=>{var S;return(S=g.current)==null?void 0:S.click()},className:`relative w-full aspect-video rounded-2xl border-2 border-dashed border-sand flex flex-col items-center justify-center cursor-pointer transition-all hover:bg-gray-50 ${c?"border-none p-0 overflow-hidden":""}`,children:[c?T.jsx("img",{src:c,alt:"Preview",className:"w-full h-full object-cover"}):T.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[T.jsx(_u,{className:"w-12 h-12 mb-2"}),T.jsx("span",{className:"font-medium",children:""})]}),T.jsx("input",{type:"file",ref:g,onChange:p,accept:"image/*",className:"hidden"})]}),T.jsx("textarea",{value:r,onChange:S=>l(S.target.value),placeholder:"...",className:"w-full bg-paper rounded-xl p-4 text-ink font-medium outline-none focus:ring-2 focus:ring-coral/50 transition-all border border-sand resize-none h-24"}),T.jsxs("button",{type:"submit",disabled:!c,className:`w-full py-3.5 rounded-xl font-bold shadow-lg transition-all flex items-center justify-center gap-2 ${c?"bg-coral text-white shadow-coral/30 active:scale-95":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[T.jsx(nf,{className:"w-5 h-5"}),""]})]})}),T.jsx("div",{className:"grid grid-cols-1 gap-6",children:n.length===0?T.jsxs("div",{className:"text-center py-12 text-gray-400",children:[T.jsx("p",{children:""}),T.jsx("p",{className:"text-sm mt-2",children:""})]}):n.map(S=>T.jsxs("div",{className:"bg-white rounded-3xl overflow-hidden shadow-card border border-sand group",children:[T.jsxs("div",{className:"relative aspect-video",children:[T.jsx("img",{src:S.imageUrl,alt:S.caption,className:"w-full h-full object-cover"}),T.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-end p-4",children:T.jsx("button",{onClick:()=>t(S.id),className:"p-2 bg-white/20 backdrop-blur-md text-white rounded-full hover:bg-red-500 transition-colors",children:T.jsx(da,{className:"w-5 h-5"})})})]}),T.jsxs("div",{className:"p-5",children:[T.jsx("p",{className:"text-ink font-medium whitespace-pre-wrap",children:S.caption}),T.jsx("p",{className:"text-xs text-gray-400 mt-3",children:new Date(S.date).toLocaleDateString()})]})]},S.id))})]})]})};function _O(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:i,onRegistered:r,onRegisteredSW:l,onRegisterError:c}=n;let m,g;const p=async(S=!0)=>{await g};async function E(){if("serviceWorker"in navigator){if(m=await lf(async()=>{const{Workbox:S}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:S}},[]).then(({Workbox:S})=>new S("/sw.js",{scope:"/",type:"classic"})).catch(S=>{c==null||c(S)}),!m)return;m.addEventListener("activated",S=>{(S.isUpdate||S.isExternal)&&window.location.reload()}),m.addEventListener("installed",S=>{S.isUpdate||i==null||i()}),m.register({immediate:e}).then(S=>{l?l("/sw.js",S):r==null||r(S)}).catch(S=>{c==null||c(S)})}}return g=E(),p}function yO(n={}){const{immediate:e=!0,onNeedRefresh:t,onOfflineReady:i,onRegistered:r,onRegisteredSW:l,onRegisterError:c}=n,[m,g]=W.useState(!1),[p,E]=W.useState(!1),[S]=W.useState(()=>_O({immediate:e,onOfflineReady(){E(!0),i==null||i()},onNeedRefresh(){g(!0),t==null||t()},onRegistered:r,onRegisteredSW:l,onRegisterError:c}));return{needRefresh:[m,g],offlineReady:[p,E],updateServiceWorker:S}}const vO=({settings:n})=>{n&&Xt[n.language]||Xt["zh-TW"];const{offlineReady:[e,t],needRefresh:[i,r],updateServiceWorker:l}=yO({onRegistered(m){console.log("SW Registered: "+m)},onRegisterError(m){console.log("SW registration error",m)}}),c=()=>{t(!1),r(!1)};return!e&&!i?null:T.jsxs("div",{className:"fixed bottom-6 right-6 z-[1000] p-4 bg-ink text-white rounded-xl shadow-2xl animate-slide-up max-w-xs border border-white/10",children:[T.jsx("div",{className:"mb-3 font-bold",children:e?T.jsx("span",{children:"App ready to work offline"}):T.jsx("span",{children:"New content available, click on reload button to update."})}),T.jsxs("div",{className:"flex gap-2",children:[i&&T.jsx("button",{className:"flex-1 px-3 py-2 bg-coral text-white rounded-lg font-bold text-sm hover:bg-coralDark transition-colors",onClick:()=>l(!0),children:"Reload"}),T.jsx("button",{className:"flex-1 px-3 py-2 bg-white/10 text-white rounded-lg font-bold text-sm hover:bg-white/20 transition-colors",onClick:c,children:"Close"})]})]})},TO={USERS:"nomad_app_users_v1",CURRENT_USER:"nomad_app_current_user_v1",getTripsKey:n=>`nomad_app_trips_${n} `,getSettingsKey:n=>`nomad_app_settings_${n} `,getMemoriesKey:n=>`nomad_app_memories_${n} `,getChatSessionsKey:n=>`nomad_app_chat_sessions_${n} `},xO=()=>{console.log("App Component Rendering...");const[n,e]=W.useState({id:"test-user-id",username:"Test User",password:"",createdAt:new Date().toISOString()}),[t,i]=W.useState([]),[r,l]=W.useState([]),[c,m]=W.useState([]),[g,p]=W.useState(null),[E,S]=W.useState({language:"zh-TW",minimalistMode:!1}),[C,M]=W.useState(!0),[z,H]=W.useState(null),[Y,te]=W.useState(it.HOME),[re,ee]=W.useState(null),[ge,pe]=W.useState([]);W.useEffect(()=>{console.log("Setting up Auth Listener...");const ae=lL(Ag,fe=>{if(console.log("Auth State Changed:",fe?"User Logged In":"User Logged Out",fe==null?void 0:fe.uid),fe){const be={id:fe.uid,username:fe.displayName||"Traveler",email:fe.email||"",password:"",createdAt:fe.metadata.creationTime||new Date().toISOString()};e(be),(async()=>{try{const Et=gu(nr,"users",fe.uid);await MV(Et,{uid:fe.uid,email:fe.email,username:fe.displayName||"Traveler",lastSeen:$E()},{merge:!0})}catch(Et){console.error("Error syncing user:",Et)}})(),console.log("Listening to trips for user:",fe.uid);const ze=wg(Mh(nr,"itineraries"),Sg("userIds","array-contains",fe.uid)),xe=wg(Mh(nr,"itineraries"),Sg("uid","==",fe.uid));bc(ze,Et=>{}),bc(ze,Et=>{const pt=[];Et.forEach(Dt=>{pt.push({id:Dt.id,...Dt.data()})});const Nt=bc(xe,Dt=>{const Rt=new Map;pt.forEach(Pe=>Rt.set(Pe.id,Pe)),Dt.forEach(Pe=>{const Ge=Pe.data(),gt={id:Pe.id,...Ge};gt.userIds||(console.log("Migrating legacy trip:",gt.id),qc(Pe.ref,{userIds:[fe.uid],collaborators:[]}).catch(lt=>console.error("Migration failed",lt))),Rt.set(gt.id,gt)});const ye=Array.from(Rt.values());ye.sort((Pe,Ge)=>{const gt=Pe.createdAt?typeof Pe.createdAt=="string"?new Date(Pe.createdAt).getTime():Pe.createdAt.toMillis?Pe.createdAt.toMillis():0:0;return(Ge.createdAt?typeof Ge.createdAt=="string"?new Date(Ge.createdAt).getTime():Ge.createdAt.toMillis?Ge.createdAt.toMillis():0:0)-gt}),i(ye),M(!0),H(null)});return()=>Nt()});let We=[],mt=[];const je=()=>{const Et=new Map;We.forEach(Nt=>Et.set(Nt.id,Nt)),mt.forEach(Nt=>Et.set(Nt.id,Nt));const pt=Array.from(Et.values());pt.sort((Nt,Dt)=>{const Rt=Nt.createdAt?typeof Nt.createdAt=="string"?new Date(Nt.createdAt).getTime():Nt.createdAt.toMillis?Nt.createdAt.toMillis():0:0;return(Dt.createdAt?typeof Dt.createdAt=="string"?new Date(Dt.createdAt).getTime():Dt.createdAt.toMillis?Dt.createdAt.toMillis():0:0)-Rt}),i(pt),M(!0)},un=bc(ze,Et=>{We=[],Et.forEach(pt=>{We.push({id:pt.id,...pt.data()})}),je()}),gn=bc(xe,Et=>{mt=[],Et.forEach(pt=>{const Nt=pt.data();Nt.userIds||(console.log("Migrating legacy trip:",pt.id),qc(pt.ref,{userIds:[fe.uid],collaborators:[]}),mt.push({id:pt.id,...Nt}))}),je()});return()=>{un(),gn()}}else e(null),i([]),M(!0)});return()=>ae()},[]);const J=async ae=>{if(n)try{const{id:fe,...be}=ae;await kV(Mh(nr,"itineraries"),{...be,...be,uid:n.id,userIds:[n.id],collaborators:[],createdAt:$E()}),Y===it.AI_PLANNER&&te(it.HOME)}catch(fe){console.error("Error adding trip",fe),H(`Add Trip Error: ${fe.message}`),alert(": "+fe.message)}},k=async ae=>{if(!(!n||!ae.id))try{const fe=gu(nr,"itineraries",ae.id),{id:be,...Fe}=ae;await qc(fe,Fe),(re==null?void 0:re.id)===ae.id&&ee(ae)}catch(fe){console.error("Error updating trip",fe),alert("")}},U=async ae=>{try{await PV(gu(nr,"itineraries",ae)),(re==null?void 0:re.id)===ae&&(ee(null),te(it.HOME))}catch(fe){console.error("Error deleting trip",fe),alert("")}},V=W.useCallback(async(ae,fe)=>{var Fe;console.log("Starting background generation...",{userPrompt:ae,tripId:fe});const be=Date.now().toString();pe(ze=>[...ze,be]);try{let ze,xe=null;fe&&(xe=t.find(je=>je.id===fe)),xe?(console.log("Updating existing trip:",xe.title),ze=await qw(xe,ae,E.language),console.log("Updated Trip Plan:",ze)):(console.log("Generating new trip..."),ze=await Fw(ae,E.language),console.log("New Trip Plan:",ze));let We=ze.coverImage||(xe==null?void 0:xe.coverImage);if(!We)try{const je=ze.title||ae;We=await Og(je)}catch(je){console.error("Failed to generate cover image:",je),We=`https://placehold.co/800x600/e2e8f0/475569?text=${encodeURIComponent(((Fe=ze.title)==null?void 0:Fe.split(" ")[0])||"Travel")}`}!ze.itinerary||ze.itinerary.length===0?console.warn("AI returned empty itinerary:",ze):ze.itinerary=ze.itinerary.map(je=>({...je,day:Number(je.day)||1,id:je.id||Math.random().toString(36).substr(2,9),time:je.time||"09:00",activity:je.activity||"New Activity",location:je.location||"",notes:je.notes||""}));let mt;return xe?(mt={...xe,...ze,id:xe.id,coverImage:We},k(mt)):(mt={...ze,id:be,coverImage:We,bookings:[],budget:ze.budget||{total:0,currency:"TWD",expenses:[]},weather:ze.weather||[]},J(mt)),pe(je=>je.filter(un=>un!==be)),{title:mt.title,tripId:mt.id}}catch(ze){return console.error("Background generation failed",ze),pe(xe=>xe.filter(We=>We!==be)),null}},[t,E.language]),F=ae=>{S(fe=>({...fe,...ae}))},q=()=>{n&&j()},j=async()=>{try{await uL(Ag),te(it.HOME),ee(null)}catch(ae){console.error("Logout failed",ae)}},B=()=>{},Le=()=>{},et=ae=>{l([ae,...r])},ne=ae=>{l(r.filter(fe=>fe.id!==ae))},Ae=()=>{const ae={id:Date.now().toString(),title:E.language==="zh-TW"?"":"New Chat",messages:[],createdAt:Date.now(),updatedAt:Date.now()};return m(fe=>[ae,...fe]),p(ae.id),ae.id},Se=(ae,fe,be,Fe)=>{m(ze=>ze.map(xe=>{if(xe.id===ae){let We=xe.title;if(be)We=be;else if(!xe.messages.some(je=>je.role==="user")){const je=fe.find(un=>un.role==="user");je&&(We=je.content.slice(0,20)+(je.content.length>20?"...":""))}return{...xe,messages:fe,title:We,tripId:Fe||xe.tripId,updatedAt:Date.now()}}return xe}))},Ye=ae=>{m(fe=>fe.filter(be=>be.id!==ae)),g===ae&&p(null)},Ie=ae=>{p(ae)};if(W.useEffect(()=>{const ae=document.getElementById("loading-screen");ae?(console.log("Removing loading screen..."),ae.style.opacity="0",setTimeout(()=>ae.remove(),500)):console.log("Loading screen not found (already removed?)")},[]),W.useEffect(()=>{if(n&&C)try{localStorage.setItem(TO.getSettingsKey(n.id),JSON.stringify(E))}catch(ae){console.error("Failed to save settings",ae)}E.themeColor?document.documentElement.style.setProperty("--color-coral",E.themeColor):document.documentElement.style.removeProperty("--color-coral")},[E,n,C]),!n)return T.jsx(pO,{onLogin:B,onRegister:Le});const K=ae=>{const fe=c.find(be=>be.tripId===ae);if(fe)p(fe.id);else{const be=Ae();m(Fe=>Fe.map(ze=>{var xe;return ze.id===be?{...ze,tripId:ae,title:`${((xe=t.find(We=>We.id===ae))==null?void 0:xe.title)||"Trip"} Planning`}:ze}))}te(it.AI_PLANNER)},de=()=>{switch(Y){case it.HOME:return T.jsx(Eb,{trips:t,onSelectTrip:ae=>{ee(ae),te(it.TRIP_DETAILS)},onAddTrip:()=>te(it.ADD_TRIP),onOpenSettings:()=>te(it.SETTINGS),settings:E});case it.ADD_TRIP:return T.jsx(XP,{onSave:ae=>{J(ae),te(it.HOME)},onCancel:()=>te(it.HOME),settings:E});case it.MAGIC_EDITOR:return T.jsx(e5,{settings:E});case it.TRIP_MEMORY:return T.jsx(gO,{memories:r,onAddMemory:et,onDeleteMemory:ne,settings:E});case it.AI_PLANNER:return T.jsx(zV,{onStartGeneration:V,onCancel:()=>te(it.HOME),settings:E,sessions:c,currentSessionId:g,onCreateSession:Ae,onUpdateSession:Se,onDeleteSession:Ye,onSelectSession:Ie});case it.TOOLS:return T.jsx(fO,{onBack:()=>te(it.HOME),trips:t,settings:E,onMagicEditor:()=>te(it.MAGIC_EDITOR),onOpenSettings:()=>te(it.SETTINGS)});case it.TRIP_DETAILS:return re?T.jsx(UV,{trip:re,onBack:()=>te(it.HOME),onDelete:U,onUpdateTrip:k,onOpenAI:K,settings:E}):null;case it.SETTINGS:return T.jsx(mO,{onBack:()=>te(it.HOME),settings:E,onUpdateSettings:F,onResetApp:q,user:n,onLogout:j});default:return null}},Ce=[it.HOME,it.TRIP_MEMORY,it.TOOLS,it.AI_PLANNER].includes(Y);return T.jsxs("div",{className:"h-full w-full max-w-md mx-auto bg-paper shadow-2xl relative overflow-hidden flex flex-col font-sans text-ink",children:[z&&T.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 relative",role:"alert",children:[T.jsx("strong",{className:"font-bold",children:"Error: "}),T.jsx("span",{className:"block sm:inline",children:z}),T.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>H(null),children:T.jsxs("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[T.jsx("title",{children:"Close"}),T.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]}),T.jsx("div",{className:"flex-1 overflow-hidden relative bg-paper",children:de()}),Ce&&T.jsx("div",{className:"absolute bottom-6 left-4 right-4 z-40",children:T.jsxs("div",{className:"bg-white/90 backdrop-blur-xl border border-white/50 shadow-float rounded-3xl px-2 py-3 flex justify-around items-center",children:[T.jsxs("button",{onClick:()=>te(it.HOME),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Y===it.HOME?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[T.jsx(sb,{className:`w-6 h-6 ${Y===it.HOME?"stroke-2":"stroke-[1.5]"}`}),Y===it.HOME&&T.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),T.jsxs("button",{onClick:()=>te(it.AI_PLANNER),className:`relative flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Y===it.AI_PLANNER?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[T.jsxs("div",{className:"relative",children:[T.jsx(lw,{className:`w-6 h-6 ${Y===it.AI_PLANNER?"stroke-2":"stroke-[1.5]"}`}),(ge==null?void 0:ge.length)>0&&T.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-coral rounded-full animate-ping"}),(ge==null?void 0:ge.length)>0&&T.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-coral rounded-full border-2 border-white"})]}),Y===it.AI_PLANNER&&T.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),T.jsxs("button",{onClick:()=>te(it.TRIP_MEMORY),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Y===it.TRIP_MEMORY?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[T.jsx(_u,{className:`w-6 h-6 ${Y===it.TRIP_MEMORY?"stroke-2":"stroke-[1.5]"}`}),Y===it.TRIP_MEMORY&&T.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),T.jsxs("button",{onClick:()=>te(it.TOOLS),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Y===it.TOOLS?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[T.jsx(Ig,{className:`w-6 h-6 ${Y===it.TOOLS?"stroke-2":"stroke-[1.5]"}`}),Y===it.TOOLS&&T.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]})]})}),T.jsx(vO,{settings:E})]})};console.log("NomadAI App Starting...");const MA=document.getElementById("root");if(!MA)throw new Error("Could not find root element to mount to");const EO=ib.createRoot(MA);try{EO.render(T.jsx(Hc.StrictMode,{children:T.jsx(xO,{})})),setTimeout(()=>{const n=document.getElementById("loading-screen");n&&(console.warn("Force removing loader after timeout"),n.style.opacity="0",setTimeout(()=>n.remove(),500))},3e3)}catch(n){console.error("React Render Error:",n)}
