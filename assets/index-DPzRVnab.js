(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function J0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ov={exports:{}},Th={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZS;function CD(){if(ZS)return Th;ZS=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,o){var l=null;if(o!==void 0&&(l=""+o),s.key!==void 0&&(l=""+s.key),"key"in s){o={};for(var d in s)d!=="key"&&(o[d]=s[d])}else o=s;return s=o.ref,{$$typeof:n,type:i,key:l,ref:s!==void 0?s:null,props:o}}return Th.Fragment=e,Th.jsx=t,Th.jsxs=t,Th}var QS;function ID(){return QS||(QS=1,ov.exports=CD()),ov.exports}var _=ID(),av={exports:{}},ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $S;function AD(){if($S)return ft;$S=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),b=Symbol.iterator;function A(K){return K===null||typeof K!="object"?null:(K=b&&K[b]||K["@@iterator"],typeof K=="function"?K:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,H={};function X(K,me,Ie){this.props=K,this.context=me,this.refs=H,this.updater=Ie||P}X.prototype.isReactComponent={},X.prototype.setState=function(K,me){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,me,"setState")},X.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function re(){}re.prototype=X.prototype;function Q(K,me,Ie){this.props=K,this.context=me,this.refs=H,this.updater=Ie||P}var he=Q.prototype=new re;he.constructor=Q,F(he,X.prototype),he.isPureReactComponent=!0;var fe=Array.isArray;function Y(){}var k={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function O(K,me,Ie){var le=Ie.ref;return{$$typeof:n,type:K,key:me,ref:le!==void 0?le:null,props:Ie}}function q(K,me){return O(K.type,me,K.props)}function G(K){return typeof K=="object"&&K!==null&&K.$$typeof===n}function W(K){var me={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(Ie){return me[Ie]})}var z=/\/+/g;function He(K,me){return typeof K=="object"&&K!==null&&K.key!=null?W(""+K.key):me.toString(36)}function Qe(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(Y,Y):(K.status="pending",K.then(function(me){K.status==="pending"&&(K.status="fulfilled",K.value=me)},function(me){K.status==="pending"&&(K.status="rejected",K.reason=me)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function se(K,me,Ie,le,_e){var Ce=typeof K;(Ce==="undefined"||Ce==="boolean")&&(K=null);var Fe=!1;if(K===null)Fe=!0;else switch(Ce){case"bigint":case"string":case"number":Fe=!0;break;case"object":switch(K.$$typeof){case n:case e:Fe=!0;break;case v:return Fe=K._init,se(Fe(K._payload),me,Ie,le,_e)}}if(Fe)return _e=_e(K),Fe=le===""?"."+He(K,0):le,fe(_e)?(Ie="",Fe!=null&&(Ie=Fe.replace(z,"$&/")+"/"),se(_e,me,Ie,"",function(At){return At})):_e!=null&&(G(_e)&&(_e=q(_e,Ie+(_e.key==null||K&&K.key===_e.key?"":(""+_e.key).replace(z,"$&/")+"/")+Fe)),me.push(_e)),1;Fe=0;var Be=le===""?".":le+":";if(fe(K))for(var Ye=0;Ye<K.length;Ye++)le=K[Ye],Ce=Be+He(le,Ye),Fe+=se(le,me,Ie,Ce,_e);else if(Ye=A(K),typeof Ye=="function")for(K=Ye.call(K),Ye=0;!(le=K.next()).done;)le=le.value,Ce=Be+He(le,Ye++),Fe+=se(le,me,Ie,Ce,_e);else if(Ce==="object"){if(typeof K.then=="function")return se(Qe(K),me,Ie,le,_e);throw me=String(K),Error("Objects are not valid as a React child (found: "+(me==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":me)+"). If you meant to render a collection of children, use an array instead.")}return Fe}function Se(K,me,Ie){if(K==null)return K;var le=[],_e=0;return se(K,le,"","",function(Ce){return me.call(Ie,Ce,_e++)}),le}function be(K){if(K._status===-1){var me=K._result;me=me(),me.then(function(Ie){(K._status===0||K._status===-1)&&(K._status=1,K._result=Ie)},function(Ie){(K._status===0||K._status===-1)&&(K._status=2,K._result=Ie)}),K._status===-1&&(K._status=0,K._result=me)}if(K._status===1)return K._result.default;throw K._result}var it=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var me=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(me))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)},Pe={map:Se,forEach:function(K,me,Ie){Se(K,function(){me.apply(this,arguments)},Ie)},count:function(K){var me=0;return Se(K,function(){me++}),me},toArray:function(K){return Se(K,function(me){return me})||[]},only:function(K){if(!G(K))throw Error("React.Children.only expected to receive a single React element child.");return K}};return ft.Activity=x,ft.Children=Pe,ft.Component=X,ft.Fragment=t,ft.Profiler=s,ft.PureComponent=Q,ft.StrictMode=i,ft.Suspense=h,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,ft.__COMPILER_RUNTIME={__proto__:null,c:function(K){return k.H.useMemoCache(K)}},ft.cache=function(K){return function(){return K.apply(null,arguments)}},ft.cacheSignal=function(){return null},ft.cloneElement=function(K,me,Ie){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var le=F({},K.props),_e=K.key;if(me!=null)for(Ce in me.key!==void 0&&(_e=""+me.key),me)!B.call(me,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&me.ref===void 0||(le[Ce]=me[Ce]);var Ce=arguments.length-2;if(Ce===1)le.children=Ie;else if(1<Ce){for(var Fe=Array(Ce),Be=0;Be<Ce;Be++)Fe[Be]=arguments[Be+2];le.children=Fe}return O(K.type,_e,le)},ft.createContext=function(K){return K={$$typeof:l,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:o,_context:K},K},ft.createElement=function(K,me,Ie){var le,_e={},Ce=null;if(me!=null)for(le in me.key!==void 0&&(Ce=""+me.key),me)B.call(me,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(_e[le]=me[le]);var Fe=arguments.length-2;if(Fe===1)_e.children=Ie;else if(1<Fe){for(var Be=Array(Fe),Ye=0;Ye<Fe;Ye++)Be[Ye]=arguments[Ye+2];_e.children=Be}if(K&&K.defaultProps)for(le in Fe=K.defaultProps,Fe)_e[le]===void 0&&(_e[le]=Fe[le]);return O(K,Ce,_e)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(K){return{$$typeof:d,render:K}},ft.isValidElement=G,ft.lazy=function(K){return{$$typeof:v,_payload:{_status:-1,_result:K},_init:be}},ft.memo=function(K,me){return{$$typeof:p,type:K,compare:me===void 0?null:me}},ft.startTransition=function(K){var me=k.T,Ie={};k.T=Ie;try{var le=K(),_e=k.S;_e!==null&&_e(Ie,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(Y,it)}catch(Ce){it(Ce)}finally{me!==null&&Ie.types!==null&&(me.types=Ie.types),k.T=me}},ft.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},ft.use=function(K){return k.H.use(K)},ft.useActionState=function(K,me,Ie){return k.H.useActionState(K,me,Ie)},ft.useCallback=function(K,me){return k.H.useCallback(K,me)},ft.useContext=function(K){return k.H.useContext(K)},ft.useDebugValue=function(){},ft.useDeferredValue=function(K,me){return k.H.useDeferredValue(K,me)},ft.useEffect=function(K,me){return k.H.useEffect(K,me)},ft.useEffectEvent=function(K){return k.H.useEffectEvent(K)},ft.useId=function(){return k.H.useId()},ft.useImperativeHandle=function(K,me,Ie){return k.H.useImperativeHandle(K,me,Ie)},ft.useInsertionEffect=function(K,me){return k.H.useInsertionEffect(K,me)},ft.useLayoutEffect=function(K,me){return k.H.useLayoutEffect(K,me)},ft.useMemo=function(K,me){return k.H.useMemo(K,me)},ft.useOptimistic=function(K,me){return k.H.useOptimistic(K,me)},ft.useReducer=function(K,me,Ie){return k.H.useReducer(K,me,Ie)},ft.useRef=function(K){return k.H.useRef(K)},ft.useState=function(K){return k.H.useState(K)},ft.useSyncExternalStore=function(K,me,Ie){return k.H.useSyncExternalStore(K,me,Ie)},ft.useTransition=function(){return k.H.useTransition()},ft.version="19.2.0",ft}var XS;function Z0(){return XS||(XS=1,av.exports=AD()),av.exports}var Z=Z0();const af=J0(Z);var lv={exports:{}},Eh={},uv={exports:{}},cv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eb;function ND(){return eb||(eb=1,(function(n){function e(se,Se){var be=se.length;se.push(Se);e:for(;0<be;){var it=be-1>>>1,Pe=se[it];if(0<s(Pe,Se))se[it]=Se,se[be]=Pe,be=it;else break e}}function t(se){return se.length===0?null:se[0]}function i(se){if(se.length===0)return null;var Se=se[0],be=se.pop();if(be!==Se){se[0]=be;e:for(var it=0,Pe=se.length,K=Pe>>>1;it<K;){var me=2*(it+1)-1,Ie=se[me],le=me+1,_e=se[le];if(0>s(Ie,be))le<Pe&&0>s(_e,Ie)?(se[it]=_e,se[le]=be,it=le):(se[it]=Ie,se[me]=be,it=me);else if(le<Pe&&0>s(_e,be))se[it]=_e,se[le]=be,it=le;else break e}}return Se}function s(se,Se){var be=se.sortIndex-Se.sortIndex;return be!==0?be:se.id-Se.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,d=l.now();n.unstable_now=function(){return l.now()-d}}var h=[],p=[],v=1,x=null,b=3,A=!1,P=!1,F=!1,H=!1,X=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;function he(se){for(var Se=t(p);Se!==null;){if(Se.callback===null)i(p);else if(Se.startTime<=se)i(p),Se.sortIndex=Se.expirationTime,e(h,Se);else break;Se=t(p)}}function fe(se){if(F=!1,he(se),!P)if(t(h)!==null)P=!0,Y||(Y=!0,W());else{var Se=t(p);Se!==null&&Qe(fe,Se.startTime-se)}}var Y=!1,k=-1,B=5,O=-1;function q(){return H?!0:!(n.unstable_now()-O<B)}function G(){if(H=!1,Y){var se=n.unstable_now();O=se;var Se=!0;try{e:{P=!1,F&&(F=!1,re(k),k=-1),A=!0;var be=b;try{t:{for(he(se),x=t(h);x!==null&&!(x.expirationTime>se&&q());){var it=x.callback;if(typeof it=="function"){x.callback=null,b=x.priorityLevel;var Pe=it(x.expirationTime<=se);if(se=n.unstable_now(),typeof Pe=="function"){x.callback=Pe,he(se),Se=!0;break t}x===t(h)&&i(h),he(se)}else i(h);x=t(h)}if(x!==null)Se=!0;else{var K=t(p);K!==null&&Qe(fe,K.startTime-se),Se=!1}}break e}finally{x=null,b=be,A=!1}Se=void 0}}finally{Se?W():Y=!1}}}var W;if(typeof Q=="function")W=function(){Q(G)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,He=z.port2;z.port1.onmessage=G,W=function(){He.postMessage(null)}}else W=function(){X(G,0)};function Qe(se,Se){k=X(function(){se(n.unstable_now())},Se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(se){se.callback=null},n.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<se?Math.floor(1e3/se):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(se){switch(b){case 1:case 2:case 3:var Se=3;break;default:Se=b}var be=b;b=Se;try{return se()}finally{b=be}},n.unstable_requestPaint=function(){H=!0},n.unstable_runWithPriority=function(se,Se){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var be=b;b=se;try{return Se()}finally{b=be}},n.unstable_scheduleCallback=function(se,Se,be){var it=n.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?it+be:it):be=it,se){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=be+Pe,se={id:v++,callback:Se,priorityLevel:se,startTime:be,expirationTime:Pe,sortIndex:-1},be>it?(se.sortIndex=be,e(p,se),t(h)===null&&se===t(p)&&(F?(re(k),k=-1):F=!0,Qe(fe,be-it))):(se.sortIndex=Pe,e(h,se),P||A||(P=!0,Y||(Y=!0,W()))),se},n.unstable_shouldYield=q,n.unstable_wrapCallback=function(se){var Se=b;return function(){var be=b;b=Se;try{return se.apply(this,arguments)}finally{b=be}}}})(cv)),cv}var tb;function RD(){return tb||(tb=1,uv.exports=ND()),uv.exports}var dv={exports:{}},Mi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nb;function MD(){if(nb)return Mi;nb=1;var n=Z0();function e(h){var p="https://react.dev/errors/"+h;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)p+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+h+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(h,p,v){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:x==null?null:""+x,children:h,containerInfo:p,implementation:v}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(h,p){if(h==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Mi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Mi.createPortal=function(h,p){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return o(h,p,null,v)},Mi.flushSync=function(h){var p=l.T,v=i.p;try{if(l.T=null,i.p=2,h)return h()}finally{l.T=p,i.p=v,i.d.f()}},Mi.preconnect=function(h,p){typeof h=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(h,p))},Mi.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},Mi.preinit=function(h,p){if(typeof h=="string"&&p&&typeof p.as=="string"){var v=p.as,x=d(v,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,A=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;v==="style"?i.d.S(h,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:x,integrity:b,fetchPriority:A}):v==="script"&&i.d.X(h,{crossOrigin:x,integrity:b,fetchPriority:A,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Mi.preinitModule=function(h,p){if(typeof h=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var v=d(p.as,p.crossOrigin);i.d.M(h,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(h)},Mi.preload=function(h,p){if(typeof h=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var v=p.as,x=d(v,p.crossOrigin);i.d.L(h,v,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Mi.preloadModule=function(h,p){if(typeof h=="string")if(p){var v=d(p.as,p.crossOrigin);i.d.m(h,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(h)},Mi.requestFormReset=function(h){i.d.r(h)},Mi.unstable_batchedUpdates=function(h,p){return h(p)},Mi.useFormState=function(h,p,v){return l.H.useFormState(h,p,v)},Mi.useFormStatus=function(){return l.H.useHostTransitionStatus()},Mi.version="19.2.0",Mi}var ib;function x1(){if(ib)return dv.exports;ib=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),dv.exports=MD(),dv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sb;function PD(){if(sb)return Eh;sb=1;var n=RD(),e=Z0(),t=x1();function i(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,c=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(c=a.return),r=a.return;while(r)}return a.tag===3?c:null}function l(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function d(r){if(r.tag===31){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function h(r){if(o(r)!==r)throw Error(i(188))}function p(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(i(188));return a!==r?null:r}for(var c=r,m=a;;){var w=c.return;if(w===null)break;var S=w.alternate;if(S===null){if(m=w.return,m!==null){c=m;continue}break}if(w.child===S.child){for(S=w.child;S;){if(S===c)return h(w),r;if(S===m)return h(w),a;S=S.sibling}throw Error(i(188))}if(c.return!==m.return)c=w,m=S;else{for(var R=!1,V=w.child;V;){if(V===c){R=!0,c=w,m=S;break}if(V===m){R=!0,m=w,c=S;break}V=V.sibling}if(!R){for(V=S.child;V;){if(V===c){R=!0,c=S,m=w;break}if(V===m){R=!0,m=S,c=w;break}V=V.sibling}if(!R)throw Error(i(189))}}if(c.alternate!==m)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?r:a}function v(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=v(r),a!==null)return a;r=r.sibling}return null}var x=Object.assign,b=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),H=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),re=Symbol.for("react.consumer"),Q=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),fe=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),q=Symbol.for("react.memo_cache_sentinel"),G=Symbol.iterator;function W(r){return r===null||typeof r!="object"?null:(r=G&&r[G]||r["@@iterator"],typeof r=="function"?r:null)}var z=Symbol.for("react.client.reference");function He(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===z?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case F:return"Fragment";case X:return"Profiler";case H:return"StrictMode";case fe:return"Suspense";case Y:return"SuspenseList";case O:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case P:return"Portal";case Q:return r.displayName||"Context";case re:return(r._context.displayName||"Context")+".Consumer";case he:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case k:return a=r.displayName||null,a!==null?a:He(r.type)||"Memo";case B:a=r._payload,r=r._init;try{return He(r(a))}catch{}}return null}var Qe=Array.isArray,se=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,be={pending:!1,data:null,method:null,action:null},it=[],Pe=-1;function K(r){return{current:r}}function me(r){0>Pe||(r.current=it[Pe],it[Pe]=null,Pe--)}function Ie(r,a){Pe++,it[Pe]=r.current,r.current=a}var le=K(null),_e=K(null),Ce=K(null),Fe=K(null);function Be(r,a){switch(Ie(Ce,a),Ie(_e,r),Ie(le,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?vS(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=vS(a),r=TS(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}me(le),Ie(le,r)}function Ye(){me(le),me(_e),me(Ce)}function At(r){r.memoizedState!==null&&Ie(Fe,r);var a=le.current,c=TS(a,r.type);a!==c&&(Ie(_e,r),Ie(le,c))}function Jt(r){_e.current===r&&(me(le),me(_e)),Fe.current===r&&(me(Fe),gh._currentValue=be)}var ct,mn;function Rn(r){if(ct===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);ct=a&&a[1]||"",mn=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ct+r+mn}var Yt=!1;function Nt(r,a){if(!r||Yt)return"";Yt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(a){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(ge){var ce=ge}Reflect.construct(r,[],xe)}else{try{xe.call()}catch(ge){ce=ge}r.call(xe.prototype)}}else{try{throw Error()}catch(ge){ce=ge}(xe=r())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(ge){if(ge&&ce&&typeof ge.stack=="string")return[ge.stack,ce.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=m.DetermineComponentFrameRoot(),R=S[0],V=S[1];if(R&&V){var J=R.split(`
`),ae=V.split(`
`);for(w=m=0;m<J.length&&!J[m].includes("DetermineComponentFrameRoot");)m++;for(;w<ae.length&&!ae[w].includes("DetermineComponentFrameRoot");)w++;if(m===J.length||w===ae.length)for(m=J.length-1,w=ae.length-1;1<=m&&0<=w&&J[m]!==ae[w];)w--;for(;1<=m&&0<=w;m--,w--)if(J[m]!==ae[w]){if(m!==1||w!==1)do if(m--,w--,0>w||J[m]!==ae[w]){var ye=`
`+J[m].replace(" at new "," at ");return r.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",r.displayName)),ye}while(1<=m&&0<=w);break}}}finally{Yt=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?Rn(c):""}function Rt(r,a){switch(r.tag){case 26:case 27:case 5:return Rn(r.type);case 16:return Rn("Lazy");case 13:return r.child!==a&&a!==null?Rn("Suspense Fallback"):Rn("Suspense");case 19:return Rn("SuspenseList");case 0:case 15:return Nt(r.type,!1);case 11:return Nt(r.type.render,!1);case 1:return Nt(r.type,!0);case 31:return Rn("Activity");default:return""}}function Mt(r){try{var a="",c=null;do a+=Rt(r,c),c=r,r=r.return;while(r);return a}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var we=Object.prototype.hasOwnProperty,pe=n.unstable_scheduleCallback,De=n.unstable_cancelCallback,je=n.unstable_shouldYield,nt=n.unstable_requestPaint,lt=n.unstable_now,rn=n.unstable_getCurrentPriorityLevel,jn=n.unstable_ImmediatePriority,vi=n.unstable_UserBlockingPriority,pn=n.unstable_NormalPriority,Ts=n.unstable_LowPriority,Lr=n.unstable_IdlePriority,Vr=n.log,co=n.unstable_setDisableYieldValue,Ti=null,Ne=null;function ht(r){if(typeof Vr=="function"&&co(r),Ne&&typeof Ne.setStrictMode=="function")try{Ne.setStrictMode(Ti,r)}catch{}}var dt=Math.clz32?Math.clz32:Es,on=Math.log,Si=Math.LN2;function Es(r){return r>>>=0,r===0?32:31-(on(r)/Si|0)|0}var Fn=256,Zi=262144,gn=4194304;function zi(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function qi(r,a,c){var m=r.pendingLanes;if(m===0)return 0;var w=0,S=r.suspendedLanes,R=r.pingedLanes;r=r.warmLanes;var V=m&134217727;return V!==0?(m=V&~S,m!==0?w=zi(m):(R&=V,R!==0?w=zi(R):c||(c=V&~r,c!==0&&(w=zi(c))))):(V=m&~S,V!==0?w=zi(V):R!==0?w=zi(R):c||(c=m&~r,c!==0&&(w=zi(c)))),w===0?0:a!==0&&a!==w&&(a&S)===0&&(S=w&-w,c=a&-a,S>=c||S===32&&(c&4194048)!==0)?a:w}function ei(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function Vd(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gu(){var r=gn;return gn<<=1,(gn&62914560)===0&&(gn=4194304),r}function Hs(r){for(var a=[],c=0;31>c;c++)a.push(r);return a}function dr(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Od(r,a,c,m,w,S){var R=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var V=r.entanglements,J=r.expirationTimes,ae=r.hiddenUpdates;for(c=R&~c;0<c;){var ye=31-dt(c),xe=1<<ye;V[ye]=0,J[ye]=-1;var ce=ae[ye];if(ce!==null)for(ae[ye]=null,ye=0;ye<ce.length;ye++){var ge=ce[ye];ge!==null&&(ge.lane&=-536870913)}c&=~xe}m!==0&&ho(r,m,0),S!==0&&w===0&&r.tag!==0&&(r.suspendedLanes|=S&~(R&~a))}function ho(r,a,c){r.pendingLanes|=a,r.suspendedLanes&=~a;var m=31-dt(a);r.entangledLanes|=a,r.entanglements[m]=r.entanglements[m]|1073741824|c&261930}function El(r,a){var c=r.entangledLanes|=a;for(r=r.entanglements;c;){var m=31-dt(c),w=1<<m;w&a|r[m]&a&&(r[m]|=a),c&=~w}}function xl(r,a){var c=a&-a;return c=(c&42)!==0?1:oi(c),(c&(r.suspendedLanes|a))!==0?0:c}function oi(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ze(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function wl(){var r=Se.p;return r!==0?r:(r=window.event,r===void 0?32:GS(r.type))}function Qi(r,a){var c=Se.p;try{return Se.p=r,a()}finally{Se.p=c}}var $i=Math.random().toString(36).slice(2),Cn="__reactFiber$"+$i,Mn="__reactProps$"+$i,xs="__reactContainer$"+$i,ws="__reactEvents$"+$i,Hu="__reactListeners$"+$i,ju="__reactHandles$"+$i,Ku="__reactResources$"+$i,js="__reactMarker$"+$i;function ra(r){delete r[Cn],delete r[Mn],delete r[ws],delete r[Hu],delete r[ju]}function Ss(r){var a=r[Cn];if(a)return a;for(var c=r.parentNode;c;){if(a=c[xs]||c[Cn]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(r=IS(r);r!==null;){if(c=r[Cn])return c;r=IS(r)}return a}r=c,c=r.parentNode}return null}function Xi(r){if(r=r[Cn]||r[xs]){var a=r.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return r}return null}function ai(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(i(33))}function Ks(r){var a=r[Ku];return a||(a=r[Ku]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Pn(r){r[js]=!0}var Sl=new Set,bl={};function Ws(r,a){es(r,a),es(r+"Capture",a)}function es(r,a){for(bl[r]=a,r=0;r<a.length;r++)Sl.add(a[r])}var hr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),oa={},aa={};function Or(r){return we.call(aa,r)?!0:we.call(oa,r)?!1:hr.test(r)?aa[r]=!0:(oa[r]=!0,!1)}function yt(r,a,c){if(Or(a))if(c===null)r.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var m=a.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+c)}}function Et(r,a,c){if(c===null)r.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+c)}}function yn(r,a,c,m){if(m===null)r.removeAttribute(c);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(a,c,""+m)}}function vn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Gi(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function fo(r,a,c){var m=Object.getOwnPropertyDescriptor(r.constructor.prototype,a);if(!r.hasOwnProperty(a)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var w=m.get,S=m.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return w.call(this)},set:function(R){c=""+R,S.call(this,R)}}),Object.defineProperty(r,a,{enumerable:m.enumerable}),{getValue:function(){return c},setValue:function(R){c=""+R},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function Ue(r){if(!r._valueTracker){var a=Gi(r)?"checked":"value";r._valueTracker=fo(r,a,""+r[a])}}function Zt(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var c=a.getValue(),m="";return r&&(m=Gi(r)?r.checked?"true":"false":r.value),r=m,r!==c?(a.setValue(r),!0):!1}function ts(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ys=/[\n"\\]/g;function cn(r){return r.replace(Ys,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function la(r,a,c,m,w,S,R,V){r.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?r.type=R:r.removeAttribute("type"),a!=null?R==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+vn(a)):r.value!==""+vn(a)&&(r.value=""+vn(a)):R!=="submit"&&R!=="reset"||r.removeAttribute("value"),a!=null?bs(r,R,vn(a)):c!=null?bs(r,R,vn(c)):m!=null&&r.removeAttribute("value"),w==null&&S!=null&&(r.defaultChecked=!!S),w!=null&&(r.checked=w&&typeof w!="function"&&typeof w!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?r.name=""+vn(V):r.removeAttribute("name")}function mo(r,a,c,m,w,S,R,V){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.type=S),a!=null||c!=null){if(!(S!=="submit"&&S!=="reset"||a!=null)){Ue(r);return}c=c!=null?""+vn(c):"",a=a!=null?""+vn(a):c,V||a===r.value||(r.value=a),r.defaultValue=a}m=m??w,m=typeof m!="function"&&typeof m!="symbol"&&!!m,r.checked=V?r.checked:!!m,r.defaultChecked=!!m,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(r.name=R),Ue(r)}function bs(r,a,c){a==="number"&&ts(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function Qt(r,a,c,m){if(r=r.options,a){a={};for(var w=0;w<c.length;w++)a["$"+c[w]]=!0;for(c=0;c<r.length;c++)w=a.hasOwnProperty("$"+r[c].value),r[c].selected!==w&&(r[c].selected=w),w&&m&&(r[c].defaultSelected=!0)}else{for(c=""+vn(c),a=null,w=0;w<r.length;w++){if(r[w].value===c){r[w].selected=!0,m&&(r[w].defaultSelected=!0);return}a!==null||r[w].disabled||(a=r[w])}a!==null&&(a.selected=!0)}}function Js(r,a,c){if(a!=null&&(a=""+vn(a),a!==r.value&&(r.value=a),c==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=c!=null?""+vn(c):""}function ns(r,a,c,m){if(a==null){if(m!=null){if(c!=null)throw Error(i(92));if(Qe(m)){if(1<m.length)throw Error(i(93));m=m[0]}c=m}c==null&&(c=""),a=c}c=vn(a),r.defaultValue=c,m=r.textContent,m===c&&m!==""&&m!==null&&(r.value=m),Ue(r)}function Kn(r,a){if(a){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=a;return}}r.textContent=a}var ua=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fr(r,a,c){var m=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?m?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":m?r.setProperty(a,c):typeof c!="number"||c===0||ua.has(a)?a==="float"?r.cssFloat=c:r[a]=(""+c).trim():r[a]=c+"px"}function po(r,a,c){if(a!=null&&typeof a!="object")throw Error(i(62));if(r=r.style,c!=null){for(var m in c)!c.hasOwnProperty(m)||a!=null&&a.hasOwnProperty(m)||(m.indexOf("--")===0?r.setProperty(m,""):m==="float"?r.cssFloat="":r[m]="");for(var w in a)m=a[w],a.hasOwnProperty(w)&&c[w]!==m&&fr(r,w,m)}else for(var S in a)a.hasOwnProperty(S)&&fr(r,S,a[S])}function Ur(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var go=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fr(r){return Zs.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function bi(){}var ca=null;function Ci(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Br=null,et=null;function li(r){var a=Xi(r);if(a&&(r=a.stateNode)){var c=r[Mn]||null;e:switch(r=a.stateNode,a.type){case"input":if(la(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+cn(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var m=c[a];if(m!==r&&m.form===r.form){var w=m[Mn]||null;if(!w)throw Error(i(90));la(m,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(a=0;a<c.length;a++)m=c[a],m.form===r.form&&Zt(m)}break e;case"textarea":Js(r,c.value,c.defaultValue);break e;case"select":a=c.value,a!=null&&Qt(r,!!c.multiple,a,!1)}}}var Ft=!1;function mr(r,a,c){if(Ft)return r(a,c);Ft=!0;try{var m=r(a);return m}finally{if(Ft=!1,(Br!==null||et!==null)&&(Rm(),Br&&(a=Br,r=et,et=Br=null,li(a),r)))for(a=0;a<r.length;a++)li(r[a])}}function Hi(r,a){var c=r.stateNode;if(c===null)return null;var m=c[Mn]||null;if(m===null)return null;c=m[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(r=r.type,m=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!m;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(i(231,a,typeof c));return c}var Ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pr=!1;if(Ii)try{var Pt={};Object.defineProperty(Pt,"passive",{get:function(){pr=!0}}),window.addEventListener("test",Pt,Pt),window.removeEventListener("test",Pt,Pt)}catch{pr=!1}var is=null,gr=null,Tn=null;function Cs(){if(Tn)return Tn;var r,a=gr,c=a.length,m,w="value"in is?is.value:is.textContent,S=w.length;for(r=0;r<c&&a[r]===w[r];r++);var R=c-r;for(m=1;m<=R&&a[c-m]===w[S-m];m++);return Tn=w.slice(r,1<m?1-m:void 0)}function zr(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function Qs(){return!0}function Is(){return!1}function Wn(r){function a(c,m,w,S,R){this._reactName=c,this._targetInst=w,this.type=m,this.nativeEvent=S,this.target=R,this.currentTarget=null;for(var V in r)r.hasOwnProperty(V)&&(c=r[V],this[V]=c?c(S):S[V]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Qs:Is,this.isPropagationStopped=Is,this}return x(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Qs)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Qs)},persist:function(){},isPersistent:Qs}),a}var As={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$s=Wn(As),_r=x({},As,{view:0,detail:0}),_t=Wn(_r),qr,ui,Ai,_o=x({},_r,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gr,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ai&&(Ai&&r.type==="mousemove"?(qr=r.screenX-Ai.screenX,ui=r.screenY-Ai.screenY):ui=qr=0,Ai=r),qr)},movementY:function(r){return"movementY"in r?r.movementY:ui}}),Cl=Wn(_o),yr=x({},_o,{dataTransfer:0}),Wu=Wn(yr),Il=x({},_r,{relatedTarget:0}),yo=Wn(Il),Al=x({},As,{animationName:0,elapsedTime:0,pseudoElement:0}),da=Wn(Al),ha=x({},As,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),ji=Wn(ha),Yu=x({},As,{data:0}),Ns=Wn(Yu),Rs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fa(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=Rl[r])?!!a[r]:!1}function Gr(){return fa}var ci=x({},_r,{key:function(r){if(r.key){var a=Rs[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=zr(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Nl[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gr,charCode:function(r){return r.type==="keypress"?zr(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?zr(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Ml=Wn(ci),Ju=x({},_o,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vr=Wn(Ju),T=x({},_r,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gr}),I=Wn(T),M=x({},As,{propertyName:0,elapsedTime:0,pseudoElement:0}),U=Wn(M),ne=x({},_o,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),de=Wn(ne),Re=x({},As,{newState:0,oldState:0}),st=Wn(Re),Vt=[9,13,27,32],Ot=Ii&&"CompositionEvent"in window,dn=null;Ii&&"documentMode"in document&&(dn=document.documentMode);var ss=Ii&&"TextEvent"in window&&!dn,rs=Ii&&(!Ot||dn&&8<dn&&11>=dn),Ki=" ",Ms=!1;function vo(r,a){switch(r){case"keyup":return Vt.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function To(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ma=!1;function Ps(r,a){switch(r){case"compositionend":return To(a);case"keypress":return a.which!==32?null:(Ms=!0,Ki);case"textInput":return r=a.data,r===Ki&&Ms?null:r;default:return null}}function pa(r,a){if(ma)return r==="compositionend"||!Ot&&vo(r,a)?(r=Cs(),Tn=gr=is=null,ma=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return rs&&a.locale!=="ko"?null:a.data;default:return null}}var S_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xs(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!S_[r.type]:a==="textarea"}function Wf(r,a,c,m){Br?et?et.push(m):et=[m]:Br=m,a=Om(a,"onChange"),0<a.length&&(c=new $s("onChange","change",null,c,m),r.push({event:c,listeners:a}))}var er=null,Pl=null;function kl(r){fS(r,0)}function Dl(r){var a=ai(r);if(Zt(a))return r}function Ll(r,a){if(r==="change")return a}var Yf=!1;if(Ii){var tr;if(Ii){var ga="oninput"in document;if(!ga){var Jf=document.createElement("div");Jf.setAttribute("oninput","return;"),ga=typeof Jf.oninput=="function"}tr=ga}else tr=!1;Yf=tr&&(!document.documentMode||9<document.documentMode)}function Zu(){er&&(er.detachEvent("onpropertychange",Zf),Pl=er=null)}function Zf(r){if(r.propertyName==="value"&&Dl(Pl)){var a=[];Wf(a,Pl,r,Ci(r)),mr(kl,a)}}function Tr(r,a,c){r==="focusin"?(Zu(),er=a,Pl=c,er.attachEvent("onpropertychange",Zf)):r==="focusout"&&Zu()}function b_(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Dl(Pl)}function _a(r,a){if(r==="click")return Dl(a)}function C_(r,a){if(r==="input"||r==="change")return Dl(a)}function Er(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var di=typeof Object.is=="function"?Object.is:Er;function ya(r,a){if(di(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var c=Object.keys(r),m=Object.keys(a);if(c.length!==m.length)return!1;for(m=0;m<c.length;m++){var w=c[m];if(!we.call(a,w)||!di(r[w],a[w]))return!1}return!0}function Qu(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Vl(r,a){var c=Qu(r);r=0;for(var m;c;){if(c.nodeType===3){if(m=r+c.textContent.length,r<=a&&m>=a)return{node:c,offset:a-r};r=m}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Qu(c)}}function $u(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?$u(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function Ol(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=ts(r.document);a instanceof r.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)r=a.contentWindow;else break;a=ts(r.document)}return a}function Hr(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var Xu=Ii&&"documentMode"in document&&11>=document.documentMode,jr=null,ec=null,Ul=null,va=!1;function Qf(r,a,c){var m=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;va||jr==null||jr!==ts(m)||(m=jr,"selectionStart"in m&&Hr(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Ul&&ya(Ul,m)||(Ul=m,m=Om(ec,"onSelect"),0<m.length&&(a=new $s("onSelect","select",null,a,c),r.push({event:a,listeners:m}),a.target=jr)))}function Kr(r,a){var c={};return c[r.toLowerCase()]=a.toLowerCase(),c["Webkit"+r]="webkit"+a,c["Moz"+r]="moz"+a,c}var Ta={animationend:Kr("Animation","AnimationEnd"),animationiteration:Kr("Animation","AnimationIteration"),animationstart:Kr("Animation","AnimationStart"),transitionrun:Kr("Transition","TransitionRun"),transitionstart:Kr("Transition","TransitionStart"),transitioncancel:Kr("Transition","TransitionCancel"),transitionend:Kr("Transition","TransitionEnd")},tc={},$f={};Ii&&($f=document.createElement("div").style,"AnimationEvent"in window||(delete Ta.animationend.animation,delete Ta.animationiteration.animation,delete Ta.animationstart.animation),"TransitionEvent"in window||delete Ta.transitionend.transition);function hi(r){if(tc[r])return tc[r];if(!Ta[r])return r;var a=Ta[r],c;for(c in a)if(a.hasOwnProperty(c)&&c in $f)return tc[r]=a[c];return r}var Fl=hi("animationend"),Xf=hi("animationiteration"),Bl=hi("animationstart"),I_=hi("transitionrun"),em=hi("transitionstart"),A_=hi("transitioncancel"),Ea=hi("transitionend"),tm=new Map,Wr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Wr.push("scrollEnd");function os(r,a){tm.set(r,a),Ws(a,[r])}var zl=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},as=[],Ni=0,nc=0;function ql(){for(var r=Ni,a=nc=Ni=0;a<r;){var c=as[a];as[a++]=null;var m=as[a];as[a++]=null;var w=as[a];as[a++]=null;var S=as[a];if(as[a++]=null,m!==null&&w!==null){var R=m.pending;R===null?w.next=w:(w.next=R.next,R.next=w),m.pending=w}S!==0&&xa(c,w,S)}}function Yr(r,a,c,m){as[Ni++]=r,as[Ni++]=a,as[Ni++]=c,as[Ni++]=m,nc|=m,r.lanes|=m,r=r.alternate,r!==null&&(r.lanes|=m)}function Ud(r,a,c,m){return Yr(r,a,c,m),Gl(r)}function nr(r,a){return Yr(r,null,null,a),Gl(r)}function xa(r,a,c){r.lanes|=c;var m=r.alternate;m!==null&&(m.lanes|=c);for(var w=!1,S=r.return;S!==null;)S.childLanes|=c,m=S.alternate,m!==null&&(m.childLanes|=c),S.tag===22&&(r=S.stateNode,r===null||r._visibility&1||(w=!0)),r=S,S=S.return;return r.tag===3?(S=r.stateNode,w&&a!==null&&(w=31-dt(c),r=S.hiddenUpdates,m=r[w],m===null?r[w]=[a]:m.push(a),a.lane=c|536870912),S):null}function Gl(r){if(50<uh)throw uh=0,Ry=null,Error(i(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var Eo={};function N_(r,a,c,m){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ri(r,a,c,m){return new N_(r,a,c,m)}function ic(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ir(r,a){var c=r.alternate;return c===null?(c=Ri(r.tag,a,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=a,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,a=r.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function Fd(r,a){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,a=c.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function Hl(r,a,c,m,w,S){var R=0;if(m=r,typeof r=="function")ic(r)&&(R=1);else if(typeof r=="string")R=mD(r,c,le.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case O:return r=Ri(31,c,a,w),r.elementType=O,r.lanes=S,r;case F:return xo(c.children,w,S,a);case H:R=8,w|=24;break;case X:return r=Ri(12,c,a,w|2),r.elementType=X,r.lanes=S,r;case fe:return r=Ri(13,c,a,w),r.elementType=fe,r.lanes=S,r;case Y:return r=Ri(19,c,a,w),r.elementType=Y,r.lanes=S,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Q:R=10;break e;case re:R=9;break e;case he:R=11;break e;case k:R=14;break e;case B:R=16,m=null;break e}R=29,c=Error(i(130,r===null?"null":typeof r,"")),m=null}return a=Ri(R,c,a,w),a.elementType=r,a.type=m,a.lanes=S,a}function xo(r,a,c,m){return r=Ri(7,r,m,a),r.lanes=c,r}function sc(r,a,c){return r=Ri(6,r,null,a),r.lanes=c,r}function Bd(r){var a=Ri(18,null,null,0);return a.stateNode=r,a}function zd(r,a,c){return a=Ri(4,r.children!==null?r.children:[],r.key,a),a.lanes=c,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var u=new WeakMap;function f(r,a){if(typeof r=="object"&&r!==null){var c=u.get(r);return c!==void 0?c:(a={value:r,source:a,stack:Mt(a)},u.set(r,a),a)}return{value:r,source:a,stack:Mt(a)}}var E=[],C=0,N=null,D=0,j=[],te=0,ue=null,Ee=1,Le="";function Je(r,a){E[C++]=D,E[C++]=N,N=r,D=a}function pt(r,a,c){j[te++]=Ee,j[te++]=Le,j[te++]=ue,ue=r;var m=Ee;r=Le;var w=32-dt(m)-1;m&=~(1<<w),c+=1;var S=32-dt(a)+w;if(30<S){var R=w-w%5;S=(m&(1<<R)-1).toString(32),m>>=R,w-=R,Ee=1<<32-dt(a)+w|c<<w|m,Le=S+r}else Ee=1<<S|c<<w|m,Le=r}function ti(r){r.return!==null&&(Je(r,1),pt(r,1,0))}function kn(r){for(;r===N;)N=E[--C],E[C]=null,D=E[--C],E[C]=null;for(;r===ue;)ue=j[--te],j[te]=null,Le=j[--te],j[te]=null,Ee=j[--te],j[te]=null}function Wi(r,a){j[te++]=Ee,j[te++]=Le,j[te++]=ue,Ee=a.id,Le=a.overflow,ue=r}var Bt=null,zt=null,xt=!1,Jr=null,ls=!1,rc=Error(i(519));function Zr(r){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw jl(f(a,r)),rc}function qd(r){var a=r.stateNode,c=r.type,m=r.memoizedProps;switch(a[Cn]=r,a[Mn]=m,c){case"dialog":St("cancel",a),St("close",a);break;case"iframe":case"object":case"embed":St("load",a);break;case"video":case"audio":for(c=0;c<dh.length;c++)St(dh[c],a);break;case"source":St("error",a);break;case"img":case"image":case"link":St("error",a),St("load",a);break;case"details":St("toggle",a);break;case"input":St("invalid",a),mo(a,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":St("invalid",a);break;case"textarea":St("invalid",a),ns(a,m.value,m.defaultValue,m.children)}c=m.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||m.suppressHydrationWarning===!0||_S(a.textContent,c)?(m.popover!=null&&(St("beforetoggle",a),St("toggle",a)),m.onScroll!=null&&St("scroll",a),m.onScrollEnd!=null&&St("scrollend",a),m.onClick!=null&&(a.onclick=bi),a=!0):a=!1,a||Zr(r,!0)}function In(r){for(Bt=r.return;Bt;)switch(Bt.tag){case 5:case 31:case 13:ls=!1;return;case 27:case 3:ls=!0;return;default:Bt=Bt.return}}function xr(r){if(r!==Bt)return!1;if(!xt)return In(r),xt=!0,!1;var a=r.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||jy(r.type,r.memoizedProps)),c=!c),c&&zt&&Zr(r),In(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));zt=CS(r)}else if(a===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));zt=CS(r)}else a===27?(a=zt,Va(r.type)?(r=Zy,Zy=null,zt=r):zt=a):zt=Bt?rr(r.stateNode.nextSibling):null;return!0}function wo(){zt=Bt=null,xt=!1}function Gd(){var r=Jr;return r!==null&&(hs===null?hs=r:hs.push.apply(hs,r),Jr=null),r}function jl(r){Jr===null?Jr=[r]:Jr.push(r)}var Kl=K(null),Qr=null,wr=null;function wa(r,a,c){Ie(Kl,a._currentValue),a._currentValue=c}function So(r){r._currentValue=Kl.current,me(Kl)}function R_(r,a,c){for(;r!==null;){var m=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,m!==null&&(m.childLanes|=a)):m!==null&&(m.childLanes&a)!==a&&(m.childLanes|=a),r===c)break;r=r.return}}function M_(r,a,c,m){var w=r.child;for(w!==null&&(w.return=r);w!==null;){var S=w.dependencies;if(S!==null){var R=w.child;S=S.firstContext;e:for(;S!==null;){var V=S;S=w;for(var J=0;J<a.length;J++)if(V.context===a[J]){S.lanes|=c,V=S.alternate,V!==null&&(V.lanes|=c),R_(S.return,c,r),m||(R=null);break e}S=V.next}}else if(w.tag===18){if(R=w.return,R===null)throw Error(i(341));R.lanes|=c,S=R.alternate,S!==null&&(S.lanes|=c),R_(R,c,r),R=null}else R=w.child;if(R!==null)R.return=w;else for(R=w;R!==null;){if(R===r){R=null;break}if(w=R.sibling,w!==null){w.return=R.return,R=w;break}R=R.return}w=R}}function oc(r,a,c,m){r=null;for(var w=a,S=!1;w!==null;){if(!S){if((w.flags&524288)!==0)S=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var R=w.alternate;if(R===null)throw Error(i(387));if(R=R.memoizedProps,R!==null){var V=w.type;di(w.pendingProps.value,R.value)||(r!==null?r.push(V):r=[V])}}else if(w===Fe.current){if(R=w.alternate,R===null)throw Error(i(387));R.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(r!==null?r.push(gh):r=[gh])}w=w.return}r!==null&&M_(a,r,c,m),a.flags|=262144}function nm(r){for(r=r.firstContext;r!==null;){if(!di(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Wl(r){Qr=r,wr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Ei(r){return nx(Qr,r)}function im(r,a){return Qr===null&&Wl(r),nx(r,a)}function nx(r,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},wr===null){if(r===null)throw Error(i(308));wr=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else wr=wr.next=a;return c}var ck=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(c,m){r.push(m)}};this.abort=function(){a.aborted=!0,r.forEach(function(c){return c()})}},dk=n.unstable_scheduleCallback,hk=n.unstable_NormalPriority,Yn={$$typeof:Q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function P_(){return{controller:new ck,data:new Map,refCount:0}}function Hd(r){r.refCount--,r.refCount===0&&dk(hk,function(){r.controller.abort()})}var jd=null,k_=0,ac=0,lc=null;function fk(r,a){if(jd===null){var c=jd=[];k_=0,ac=Vy(),lc={status:"pending",value:void 0,then:function(m){c.push(m)}}}return k_++,a.then(ix,ix),a}function ix(){if(--k_===0&&jd!==null){lc!==null&&(lc.status="fulfilled");var r=jd;jd=null,ac=0,lc=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function mk(r,a){var c=[],m={status:"pending",value:null,reason:null,then:function(w){c.push(w)}};return r.then(function(){m.status="fulfilled",m.value=a;for(var w=0;w<c.length;w++)(0,c[w])(a)},function(w){for(m.status="rejected",m.reason=w,w=0;w<c.length;w++)(0,c[w])(void 0)}),m}var sx=se.S;se.S=function(r,a){zw=lt(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&fk(r,a),sx!==null&&sx(r,a)};var Yl=K(null);function D_(){var r=Yl.current;return r!==null?r:hn.pooledCache}function sm(r,a){a===null?Ie(Yl,Yl.current):Ie(Yl,a.pool)}function rx(){var r=D_();return r===null?null:{parent:Yn._currentValue,pool:r}}var uc=Error(i(460)),L_=Error(i(474)),rm=Error(i(542)),om={then:function(){}};function ox(r){return r=r.status,r==="fulfilled"||r==="rejected"}function ax(r,a,c){switch(c=r[c],c===void 0?r.push(a):c!==a&&(a.then(bi,bi),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,ux(r),r;default:if(typeof a.status=="string")a.then(bi,bi);else{if(r=hn,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=a,r.status="pending",r.then(function(m){if(a.status==="pending"){var w=a;w.status="fulfilled",w.value=m}},function(m){if(a.status==="pending"){var w=a;w.status="rejected",w.reason=m}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,ux(r),r}throw Zl=a,uc}}function Jl(r){try{var a=r._init;return a(r._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Zl=c,uc):c}}var Zl=null;function lx(){if(Zl===null)throw Error(i(459));var r=Zl;return Zl=null,r}function ux(r){if(r===uc||r===rm)throw Error(i(483))}var cc=null,Kd=0;function am(r){var a=Kd;return Kd+=1,cc===null&&(cc=[]),ax(cc,r,a)}function Wd(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function lm(r,a){throw a.$$typeof===b?Error(i(525)):(r=Object.prototype.toString.call(a),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function cx(r){function a(ee,$){if(r){var oe=ee.deletions;oe===null?(ee.deletions=[$],ee.flags|=16):oe.push($)}}function c(ee,$){if(!r)return null;for(;$!==null;)a(ee,$),$=$.sibling;return null}function m(ee){for(var $=new Map;ee!==null;)ee.key!==null?$.set(ee.key,ee):$.set(ee.index,ee),ee=ee.sibling;return $}function w(ee,$){return ee=ir(ee,$),ee.index=0,ee.sibling=null,ee}function S(ee,$,oe){return ee.index=oe,r?(oe=ee.alternate,oe!==null?(oe=oe.index,oe<$?(ee.flags|=67108866,$):oe):(ee.flags|=67108866,$)):(ee.flags|=1048576,$)}function R(ee){return r&&ee.alternate===null&&(ee.flags|=67108866),ee}function V(ee,$,oe,Te){return $===null||$.tag!==6?($=sc(oe,ee.mode,Te),$.return=ee,$):($=w($,oe),$.return=ee,$)}function J(ee,$,oe,Te){var $e=oe.type;return $e===F?ye(ee,$,oe.props.children,Te,oe.key):$!==null&&($.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===B&&Jl($e)===$.type)?($=w($,oe.props),Wd($,oe),$.return=ee,$):($=Hl(oe.type,oe.key,oe.props,null,ee.mode,Te),Wd($,oe),$.return=ee,$)}function ae(ee,$,oe,Te){return $===null||$.tag!==4||$.stateNode.containerInfo!==oe.containerInfo||$.stateNode.implementation!==oe.implementation?($=zd(oe,ee.mode,Te),$.return=ee,$):($=w($,oe.children||[]),$.return=ee,$)}function ye(ee,$,oe,Te,$e){return $===null||$.tag!==7?($=xo(oe,ee.mode,Te,$e),$.return=ee,$):($=w($,oe),$.return=ee,$)}function xe(ee,$,oe){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=sc(""+$,ee.mode,oe),$.return=ee,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case A:return oe=Hl($.type,$.key,$.props,null,ee.mode,oe),Wd(oe,$),oe.return=ee,oe;case P:return $=zd($,ee.mode,oe),$.return=ee,$;case B:return $=Jl($),xe(ee,$,oe)}if(Qe($)||W($))return $=xo($,ee.mode,oe,null),$.return=ee,$;if(typeof $.then=="function")return xe(ee,am($),oe);if($.$$typeof===Q)return xe(ee,im(ee,$),oe);lm(ee,$)}return null}function ce(ee,$,oe,Te){var $e=$!==null?$.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return $e!==null?null:V(ee,$,""+oe,Te);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case A:return oe.key===$e?J(ee,$,oe,Te):null;case P:return oe.key===$e?ae(ee,$,oe,Te):null;case B:return oe=Jl(oe),ce(ee,$,oe,Te)}if(Qe(oe)||W(oe))return $e!==null?null:ye(ee,$,oe,Te,null);if(typeof oe.then=="function")return ce(ee,$,am(oe),Te);if(oe.$$typeof===Q)return ce(ee,$,im(ee,oe),Te);lm(ee,oe)}return null}function ge(ee,$,oe,Te,$e){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return ee=ee.get(oe)||null,V($,ee,""+Te,$e);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case A:return ee=ee.get(Te.key===null?oe:Te.key)||null,J($,ee,Te,$e);case P:return ee=ee.get(Te.key===null?oe:Te.key)||null,ae($,ee,Te,$e);case B:return Te=Jl(Te),ge(ee,$,oe,Te,$e)}if(Qe(Te)||W(Te))return ee=ee.get(oe)||null,ye($,ee,Te,$e,null);if(typeof Te.then=="function")return ge(ee,$,oe,am(Te),$e);if(Te.$$typeof===Q)return ge(ee,$,oe,im($,Te),$e);lm($,Te)}return null}function Ge(ee,$,oe,Te){for(var $e=null,qt=null,We=$,gt=$=0,Dt=null;We!==null&&gt<oe.length;gt++){We.index>gt?(Dt=We,We=null):Dt=We.sibling;var Gt=ce(ee,We,oe[gt],Te);if(Gt===null){We===null&&(We=Dt);break}r&&We&&Gt.alternate===null&&a(ee,We),$=S(Gt,$,gt),qt===null?$e=Gt:qt.sibling=Gt,qt=Gt,We=Dt}if(gt===oe.length)return c(ee,We),xt&&Je(ee,gt),$e;if(We===null){for(;gt<oe.length;gt++)We=xe(ee,oe[gt],Te),We!==null&&($=S(We,$,gt),qt===null?$e=We:qt.sibling=We,qt=We);return xt&&Je(ee,gt),$e}for(We=m(We);gt<oe.length;gt++)Dt=ge(We,ee,gt,oe[gt],Te),Dt!==null&&(r&&Dt.alternate!==null&&We.delete(Dt.key===null?gt:Dt.key),$=S(Dt,$,gt),qt===null?$e=Dt:qt.sibling=Dt,qt=Dt);return r&&We.forEach(function(za){return a(ee,za)}),xt&&Je(ee,gt),$e}function tt(ee,$,oe,Te){if(oe==null)throw Error(i(151));for(var $e=null,qt=null,We=$,gt=$=0,Dt=null,Gt=oe.next();We!==null&&!Gt.done;gt++,Gt=oe.next()){We.index>gt?(Dt=We,We=null):Dt=We.sibling;var za=ce(ee,We,Gt.value,Te);if(za===null){We===null&&(We=Dt);break}r&&We&&za.alternate===null&&a(ee,We),$=S(za,$,gt),qt===null?$e=za:qt.sibling=za,qt=za,We=Dt}if(Gt.done)return c(ee,We),xt&&Je(ee,gt),$e;if(We===null){for(;!Gt.done;gt++,Gt=oe.next())Gt=xe(ee,Gt.value,Te),Gt!==null&&($=S(Gt,$,gt),qt===null?$e=Gt:qt.sibling=Gt,qt=Gt);return xt&&Je(ee,gt),$e}for(We=m(We);!Gt.done;gt++,Gt=oe.next())Gt=ge(We,ee,gt,Gt.value,Te),Gt!==null&&(r&&Gt.alternate!==null&&We.delete(Gt.key===null?gt:Gt.key),$=S(Gt,$,gt),qt===null?$e=Gt:qt.sibling=Gt,qt=Gt);return r&&We.forEach(function(bD){return a(ee,bD)}),xt&&Je(ee,gt),$e}function un(ee,$,oe,Te){if(typeof oe=="object"&&oe!==null&&oe.type===F&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case A:e:{for(var $e=oe.key;$!==null;){if($.key===$e){if($e=oe.type,$e===F){if($.tag===7){c(ee,$.sibling),Te=w($,oe.props.children),Te.return=ee,ee=Te;break e}}else if($.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===B&&Jl($e)===$.type){c(ee,$.sibling),Te=w($,oe.props),Wd(Te,oe),Te.return=ee,ee=Te;break e}c(ee,$);break}else a(ee,$);$=$.sibling}oe.type===F?(Te=xo(oe.props.children,ee.mode,Te,oe.key),Te.return=ee,ee=Te):(Te=Hl(oe.type,oe.key,oe.props,null,ee.mode,Te),Wd(Te,oe),Te.return=ee,ee=Te)}return R(ee);case P:e:{for($e=oe.key;$!==null;){if($.key===$e)if($.tag===4&&$.stateNode.containerInfo===oe.containerInfo&&$.stateNode.implementation===oe.implementation){c(ee,$.sibling),Te=w($,oe.children||[]),Te.return=ee,ee=Te;break e}else{c(ee,$);break}else a(ee,$);$=$.sibling}Te=zd(oe,ee.mode,Te),Te.return=ee,ee=Te}return R(ee);case B:return oe=Jl(oe),un(ee,$,oe,Te)}if(Qe(oe))return Ge(ee,$,oe,Te);if(W(oe)){if($e=W(oe),typeof $e!="function")throw Error(i(150));return oe=$e.call(oe),tt(ee,$,oe,Te)}if(typeof oe.then=="function")return un(ee,$,am(oe),Te);if(oe.$$typeof===Q)return un(ee,$,im(ee,oe),Te);lm(ee,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,$!==null&&$.tag===6?(c(ee,$.sibling),Te=w($,oe),Te.return=ee,ee=Te):(c(ee,$),Te=sc(oe,ee.mode,Te),Te.return=ee,ee=Te),R(ee)):c(ee,$)}return function(ee,$,oe,Te){try{Kd=0;var $e=un(ee,$,oe,Te);return cc=null,$e}catch(We){if(We===uc||We===rm)throw We;var qt=Ri(29,We,null,ee.mode);return qt.lanes=Te,qt.return=ee,qt}finally{}}}var Ql=cx(!0),dx=cx(!1),Sa=!1;function V_(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function O_(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ba(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Ca(r,a,c){var m=r.updateQueue;if(m===null)return null;if(m=m.shared,(jt&2)!==0){var w=m.pending;return w===null?a.next=a:(a.next=w.next,w.next=a),m.pending=a,a=Gl(r),xa(r,null,c),a}return Yr(r,m,a,c),Gl(r)}function Yd(r,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var m=a.lanes;m&=r.pendingLanes,c|=m,a.lanes=c,El(r,c)}}function U_(r,a){var c=r.updateQueue,m=r.alternate;if(m!==null&&(m=m.updateQueue,c===m)){var w=null,S=null;if(c=c.firstBaseUpdate,c!==null){do{var R={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};S===null?w=S=R:S=S.next=R,c=c.next}while(c!==null);S===null?w=S=a:S=S.next=a}else w=S=a;c={baseState:m.baseState,firstBaseUpdate:w,lastBaseUpdate:S,shared:m.shared,callbacks:m.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=a:r.next=a,c.lastBaseUpdate=a}var F_=!1;function Jd(){if(F_){var r=lc;if(r!==null)throw r}}function Zd(r,a,c,m){F_=!1;var w=r.updateQueue;Sa=!1;var S=w.firstBaseUpdate,R=w.lastBaseUpdate,V=w.shared.pending;if(V!==null){w.shared.pending=null;var J=V,ae=J.next;J.next=null,R===null?S=ae:R.next=ae,R=J;var ye=r.alternate;ye!==null&&(ye=ye.updateQueue,V=ye.lastBaseUpdate,V!==R&&(V===null?ye.firstBaseUpdate=ae:V.next=ae,ye.lastBaseUpdate=J))}if(S!==null){var xe=w.baseState;R=0,ye=ae=J=null,V=S;do{var ce=V.lane&-536870913,ge=ce!==V.lane;if(ge?(kt&ce)===ce:(m&ce)===ce){ce!==0&&ce===ac&&(F_=!0),ye!==null&&(ye=ye.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var Ge=r,tt=V;ce=a;var un=c;switch(tt.tag){case 1:if(Ge=tt.payload,typeof Ge=="function"){xe=Ge.call(un,xe,ce);break e}xe=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=tt.payload,ce=typeof Ge=="function"?Ge.call(un,xe,ce):Ge,ce==null)break e;xe=x({},xe,ce);break e;case 2:Sa=!0}}ce=V.callback,ce!==null&&(r.flags|=64,ge&&(r.flags|=8192),ge=w.callbacks,ge===null?w.callbacks=[ce]:ge.push(ce))}else ge={lane:ce,tag:V.tag,payload:V.payload,callback:V.callback,next:null},ye===null?(ae=ye=ge,J=xe):ye=ye.next=ge,R|=ce;if(V=V.next,V===null){if(V=w.shared.pending,V===null)break;ge=V,V=ge.next,ge.next=null,w.lastBaseUpdate=ge,w.shared.pending=null}}while(!0);ye===null&&(J=xe),w.baseState=J,w.firstBaseUpdate=ae,w.lastBaseUpdate=ye,S===null&&(w.shared.lanes=0),Ma|=R,r.lanes=R,r.memoizedState=xe}}function hx(r,a){if(typeof r!="function")throw Error(i(191,r));r.call(a)}function fx(r,a){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)hx(c[r],a)}var dc=K(null),um=K(0);function mx(r,a){r=ko,Ie(um,r),Ie(dc,a),ko=r|a.baseLanes}function B_(){Ie(um,ko),Ie(dc,dc.current)}function z_(){ko=um.current,me(dc),me(um)}var ks=K(null),sr=null;function Ia(r){var a=r.alternate;Ie(Bn,Bn.current&1),Ie(ks,r),sr===null&&(a===null||dc.current!==null||a.memoizedState!==null)&&(sr=r)}function q_(r){Ie(Bn,Bn.current),Ie(ks,r),sr===null&&(sr=r)}function px(r){r.tag===22?(Ie(Bn,Bn.current),Ie(ks,r),sr===null&&(sr=r)):Aa()}function Aa(){Ie(Bn,Bn.current),Ie(ks,ks.current)}function Ds(r){me(ks),sr===r&&(sr=null),me(Bn)}var Bn=K(0);function cm(r){for(var a=r;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Yy(c)||Jy(c)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var bo=0,mt=null,an=null,Jn=null,dm=!1,hc=!1,$l=!1,hm=0,Qd=0,fc=null,pk=0;function Dn(){throw Error(i(321))}function G_(r,a){if(a===null)return!1;for(var c=0;c<a.length&&c<r.length;c++)if(!di(r[c],a[c]))return!1;return!0}function H_(r,a,c,m,w,S){return bo=S,mt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,se.H=r===null||r.memoizedState===null?$x:ry,$l=!1,S=c(m,w),$l=!1,hc&&(S=_x(a,c,m,w)),gx(r),S}function gx(r){se.H=eh;var a=an!==null&&an.next!==null;if(bo=0,Jn=an=mt=null,dm=!1,Qd=0,fc=null,a)throw Error(i(300));r===null||Zn||(r=r.dependencies,r!==null&&nm(r)&&(Zn=!0))}function _x(r,a,c,m){mt=r;var w=0;do{if(hc&&(fc=null),Qd=0,hc=!1,25<=w)throw Error(i(301));if(w+=1,Jn=an=null,r.updateQueue!=null){var S=r.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}se.H=Xx,S=a(c,m)}while(hc);return S}function gk(){var r=se.H,a=r.useState()[0];return a=typeof a.then=="function"?$d(a):a,r=r.useState()[0],(an!==null?an.memoizedState:null)!==r&&(mt.flags|=1024),a}function j_(){var r=hm!==0;return hm=0,r}function K_(r,a,c){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~c}function W_(r){if(dm){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}dm=!1}bo=0,Jn=an=mt=null,hc=!1,Qd=hm=0,fc=null}function Yi(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?mt.memoizedState=Jn=r:Jn=Jn.next=r,Jn}function zn(){if(an===null){var r=mt.alternate;r=r!==null?r.memoizedState:null}else r=an.next;var a=Jn===null?mt.memoizedState:Jn.next;if(a!==null)Jn=a,an=r;else{if(r===null)throw mt.alternate===null?Error(i(467)):Error(i(310));an=r,r={memoizedState:an.memoizedState,baseState:an.baseState,baseQueue:an.baseQueue,queue:an.queue,next:null},Jn===null?mt.memoizedState=Jn=r:Jn=Jn.next=r}return Jn}function fm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $d(r){var a=Qd;return Qd+=1,fc===null&&(fc=[]),r=ax(fc,r,a),a=mt,(Jn===null?a.memoizedState:Jn.next)===null&&(a=a.alternate,se.H=a===null||a.memoizedState===null?$x:ry),r}function mm(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return $d(r);if(r.$$typeof===Q)return Ei(r)}throw Error(i(438,String(r)))}function Y_(r){var a=null,c=mt.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var m=mt.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(a={data:m.data.map(function(w){return w.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=fm(),mt.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(r),m=0;m<r;m++)c[m]=q;return a.index++,c}function Co(r,a){return typeof a=="function"?a(r):a}function pm(r){var a=zn();return J_(a,an,r)}function J_(r,a,c){var m=r.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=c;var w=r.baseQueue,S=m.pending;if(S!==null){if(w!==null){var R=w.next;w.next=S.next,S.next=R}a.baseQueue=w=S,m.pending=null}if(S=r.baseState,w===null)r.memoizedState=S;else{a=w.next;var V=R=null,J=null,ae=a,ye=!1;do{var xe=ae.lane&-536870913;if(xe!==ae.lane?(kt&xe)===xe:(bo&xe)===xe){var ce=ae.revertLane;if(ce===0)J!==null&&(J=J.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),xe===ac&&(ye=!0);else if((bo&ce)===ce){ae=ae.next,ce===ac&&(ye=!0);continue}else xe={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},J===null?(V=J=xe,R=S):J=J.next=xe,mt.lanes|=ce,Ma|=ce;xe=ae.action,$l&&c(S,xe),S=ae.hasEagerState?ae.eagerState:c(S,xe)}else ce={lane:xe,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},J===null?(V=J=ce,R=S):J=J.next=ce,mt.lanes|=xe,Ma|=xe;ae=ae.next}while(ae!==null&&ae!==a);if(J===null?R=S:J.next=V,!di(S,r.memoizedState)&&(Zn=!0,ye&&(c=lc,c!==null)))throw c;r.memoizedState=S,r.baseState=R,r.baseQueue=J,m.lastRenderedState=S}return w===null&&(m.lanes=0),[r.memoizedState,m.dispatch]}function Z_(r){var a=zn(),c=a.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=r;var m=c.dispatch,w=c.pending,S=a.memoizedState;if(w!==null){c.pending=null;var R=w=w.next;do S=r(S,R.action),R=R.next;while(R!==w);di(S,a.memoizedState)||(Zn=!0),a.memoizedState=S,a.baseQueue===null&&(a.baseState=S),c.lastRenderedState=S}return[S,m]}function yx(r,a,c){var m=mt,w=zn(),S=xt;if(S){if(c===void 0)throw Error(i(407));c=c()}else c=a();var R=!di((an||w).memoizedState,c);if(R&&(w.memoizedState=c,Zn=!0),w=w.queue,X_(Ex.bind(null,m,w,r),[r]),w.getSnapshot!==a||R||Jn!==null&&Jn.memoizedState.tag&1){if(m.flags|=2048,mc(9,{destroy:void 0},Tx.bind(null,m,w,c,a),null),hn===null)throw Error(i(349));S||(bo&127)!==0||vx(m,a,c)}return c}function vx(r,a,c){r.flags|=16384,r={getSnapshot:a,value:c},a=mt.updateQueue,a===null?(a=fm(),mt.updateQueue=a,a.stores=[r]):(c=a.stores,c===null?a.stores=[r]:c.push(r))}function Tx(r,a,c,m){a.value=c,a.getSnapshot=m,xx(a)&&wx(r)}function Ex(r,a,c){return c(function(){xx(a)&&wx(r)})}function xx(r){var a=r.getSnapshot;r=r.value;try{var c=a();return!di(r,c)}catch{return!0}}function wx(r){var a=nr(r,2);a!==null&&fs(a,r,2)}function Q_(r){var a=Yi();if(typeof r=="function"){var c=r;if(r=c(),$l){ht(!0);try{c()}finally{ht(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:r},a}function Sx(r,a,c,m){return r.baseState=c,J_(r,an,typeof m=="function"?m:Co)}function _k(r,a,c,m,w){if(ym(r))throw Error(i(485));if(r=a.action,r!==null){var S={payload:w,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){S.listeners.push(R)}};se.T!==null?c(!0):S.isTransition=!1,m(S),c=a.pending,c===null?(S.next=a.pending=S,bx(a,S)):(S.next=c.next,a.pending=c.next=S)}}function bx(r,a){var c=a.action,m=a.payload,w=r.state;if(a.isTransition){var S=se.T,R={};se.T=R;try{var V=c(w,m),J=se.S;J!==null&&J(R,V),Cx(r,a,V)}catch(ae){$_(r,a,ae)}finally{S!==null&&R.types!==null&&(S.types=R.types),se.T=S}}else try{S=c(w,m),Cx(r,a,S)}catch(ae){$_(r,a,ae)}}function Cx(r,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(m){Ix(r,a,m)},function(m){return $_(r,a,m)}):Ix(r,a,c)}function Ix(r,a,c){a.status="fulfilled",a.value=c,Ax(a),r.state=c,a=r.pending,a!==null&&(c=a.next,c===a?r.pending=null:(c=c.next,a.next=c,bx(r,c)))}function $_(r,a,c){var m=r.pending;if(r.pending=null,m!==null){m=m.next;do a.status="rejected",a.reason=c,Ax(a),a=a.next;while(a!==m)}r.action=null}function Ax(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function Nx(r,a){return a}function Rx(r,a){if(xt){var c=hn.formState;if(c!==null){e:{var m=mt;if(xt){if(zt){t:{for(var w=zt,S=ls;w.nodeType!==8;){if(!S){w=null;break t}if(w=rr(w.nextSibling),w===null){w=null;break t}}S=w.data,w=S==="F!"||S==="F"?w:null}if(w){zt=rr(w.nextSibling),m=w.data==="F!";break e}}Zr(m)}m=!1}m&&(a=c[0])}}return c=Yi(),c.memoizedState=c.baseState=a,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Nx,lastRenderedState:a},c.queue=m,c=Jx.bind(null,mt,m),m.dispatch=c,m=Q_(!1),S=sy.bind(null,mt,!1,m.queue),m=Yi(),w={state:a,dispatch:null,action:r,pending:null},m.queue=w,c=_k.bind(null,mt,w,S,c),w.dispatch=c,m.memoizedState=r,[a,c,!1]}function Mx(r){var a=zn();return Px(a,an,r)}function Px(r,a,c){if(a=J_(r,a,Nx)[0],r=pm(Co)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var m=$d(a)}catch(R){throw R===uc?rm:R}else m=a;a=zn();var w=a.queue,S=w.dispatch;return c!==a.memoizedState&&(mt.flags|=2048,mc(9,{destroy:void 0},yk.bind(null,w,c),null)),[m,S,r]}function yk(r,a){r.action=a}function kx(r){var a=zn(),c=an;if(c!==null)return Px(a,c,r);zn(),a=a.memoizedState,c=zn();var m=c.queue.dispatch;return c.memoizedState=r,[a,m,!1]}function mc(r,a,c,m){return r={tag:r,create:c,deps:m,inst:a,next:null},a=mt.updateQueue,a===null&&(a=fm(),mt.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=r.next=r:(m=c.next,c.next=r,r.next=m,a.lastEffect=r),r}function Dx(){return zn().memoizedState}function gm(r,a,c,m){var w=Yi();mt.flags|=r,w.memoizedState=mc(1|a,{destroy:void 0},c,m===void 0?null:m)}function _m(r,a,c,m){var w=zn();m=m===void 0?null:m;var S=w.memoizedState.inst;an!==null&&m!==null&&G_(m,an.memoizedState.deps)?w.memoizedState=mc(a,S,c,m):(mt.flags|=r,w.memoizedState=mc(1|a,S,c,m))}function Lx(r,a){gm(8390656,8,r,a)}function X_(r,a){_m(2048,8,r,a)}function vk(r){mt.flags|=4;var a=mt.updateQueue;if(a===null)a=fm(),mt.updateQueue=a,a.events=[r];else{var c=a.events;c===null?a.events=[r]:c.push(r)}}function Vx(r){var a=zn().memoizedState;return vk({ref:a,nextImpl:r}),function(){if((jt&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function Ox(r,a){return _m(4,2,r,a)}function Ux(r,a){return _m(4,4,r,a)}function Fx(r,a){if(typeof a=="function"){r=r();var c=a(r);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function Bx(r,a,c){c=c!=null?c.concat([r]):null,_m(4,4,Fx.bind(null,a,r),c)}function ey(){}function zx(r,a){var c=zn();a=a===void 0?null:a;var m=c.memoizedState;return a!==null&&G_(a,m[1])?m[0]:(c.memoizedState=[r,a],r)}function qx(r,a){var c=zn();a=a===void 0?null:a;var m=c.memoizedState;if(a!==null&&G_(a,m[1]))return m[0];if(m=r(),$l){ht(!0);try{r()}finally{ht(!1)}}return c.memoizedState=[m,a],m}function ty(r,a,c){return c===void 0||(bo&1073741824)!==0&&(kt&261930)===0?r.memoizedState=a:(r.memoizedState=c,r=Gw(),mt.lanes|=r,Ma|=r,c)}function Gx(r,a,c,m){return di(c,a)?c:dc.current!==null?(r=ty(r,c,m),di(r,a)||(Zn=!0),r):(bo&42)===0||(bo&1073741824)!==0&&(kt&261930)===0?(Zn=!0,r.memoizedState=c):(r=Gw(),mt.lanes|=r,Ma|=r,a)}function Hx(r,a,c,m,w){var S=Se.p;Se.p=S!==0&&8>S?S:8;var R=se.T,V={};se.T=V,sy(r,!1,a,c);try{var J=w(),ae=se.S;if(ae!==null&&ae(V,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var ye=mk(J,m);Xd(r,a,ye,Os(r))}else Xd(r,a,m,Os(r))}catch(xe){Xd(r,a,{then:function(){},status:"rejected",reason:xe},Os())}finally{Se.p=S,R!==null&&V.types!==null&&(R.types=V.types),se.T=R}}function Tk(){}function ny(r,a,c,m){if(r.tag!==5)throw Error(i(476));var w=jx(r).queue;Hx(r,w,a,be,c===null?Tk:function(){return Kx(r),c(m)})}function jx(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:be,baseState:be,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:be},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:c},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function Kx(r){var a=jx(r);a.next===null&&(a=r.alternate.memoizedState),Xd(r,a.next.queue,{},Os())}function iy(){return Ei(gh)}function Wx(){return zn().memoizedState}function Yx(){return zn().memoizedState}function Ek(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var c=Os();r=ba(c);var m=Ca(a,r,c);m!==null&&(fs(m,a,c),Yd(m,a,c)),a={cache:P_()},r.payload=a;return}a=a.return}}function xk(r,a,c){var m=Os();c={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},ym(r)?Zx(a,c):(c=Ud(r,a,c,m),c!==null&&(fs(c,r,m),Qx(c,a,m)))}function Jx(r,a,c){var m=Os();Xd(r,a,c,m)}function Xd(r,a,c,m){var w={lane:m,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(ym(r))Zx(a,w);else{var S=r.alternate;if(r.lanes===0&&(S===null||S.lanes===0)&&(S=a.lastRenderedReducer,S!==null))try{var R=a.lastRenderedState,V=S(R,c);if(w.hasEagerState=!0,w.eagerState=V,di(V,R))return Yr(r,a,w,0),hn===null&&ql(),!1}catch{}finally{}if(c=Ud(r,a,w,m),c!==null)return fs(c,r,m),Qx(c,a,m),!0}return!1}function sy(r,a,c,m){if(m={lane:2,revertLane:Vy(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},ym(r)){if(a)throw Error(i(479))}else a=Ud(r,c,m,2),a!==null&&fs(a,r,2)}function ym(r){var a=r.alternate;return r===mt||a!==null&&a===mt}function Zx(r,a){hc=dm=!0;var c=r.pending;c===null?a.next=a:(a.next=c.next,c.next=a),r.pending=a}function Qx(r,a,c){if((c&4194048)!==0){var m=a.lanes;m&=r.pendingLanes,c|=m,a.lanes=c,El(r,c)}}var eh={readContext:Ei,use:mm,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useLayoutEffect:Dn,useInsertionEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useSyncExternalStore:Dn,useId:Dn,useHostTransitionStatus:Dn,useFormState:Dn,useActionState:Dn,useOptimistic:Dn,useMemoCache:Dn,useCacheRefresh:Dn};eh.useEffectEvent=Dn;var $x={readContext:Ei,use:mm,useCallback:function(r,a){return Yi().memoizedState=[r,a===void 0?null:a],r},useContext:Ei,useEffect:Lx,useImperativeHandle:function(r,a,c){c=c!=null?c.concat([r]):null,gm(4194308,4,Fx.bind(null,a,r),c)},useLayoutEffect:function(r,a){return gm(4194308,4,r,a)},useInsertionEffect:function(r,a){gm(4,2,r,a)},useMemo:function(r,a){var c=Yi();a=a===void 0?null:a;var m=r();if($l){ht(!0);try{r()}finally{ht(!1)}}return c.memoizedState=[m,a],m},useReducer:function(r,a,c){var m=Yi();if(c!==void 0){var w=c(a);if($l){ht(!0);try{c(a)}finally{ht(!1)}}}else w=a;return m.memoizedState=m.baseState=w,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:w},m.queue=r,r=r.dispatch=xk.bind(null,mt,r),[m.memoizedState,r]},useRef:function(r){var a=Yi();return r={current:r},a.memoizedState=r},useState:function(r){r=Q_(r);var a=r.queue,c=Jx.bind(null,mt,a);return a.dispatch=c,[r.memoizedState,c]},useDebugValue:ey,useDeferredValue:function(r,a){var c=Yi();return ty(c,r,a)},useTransition:function(){var r=Q_(!1);return r=Hx.bind(null,mt,r.queue,!0,!1),Yi().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,c){var m=mt,w=Yi();if(xt){if(c===void 0)throw Error(i(407));c=c()}else{if(c=a(),hn===null)throw Error(i(349));(kt&127)!==0||vx(m,a,c)}w.memoizedState=c;var S={value:c,getSnapshot:a};return w.queue=S,Lx(Ex.bind(null,m,S,r),[r]),m.flags|=2048,mc(9,{destroy:void 0},Tx.bind(null,m,S,c,a),null),c},useId:function(){var r=Yi(),a=hn.identifierPrefix;if(xt){var c=Le,m=Ee;c=(m&~(1<<32-dt(m)-1)).toString(32)+c,a="_"+a+"R_"+c,c=hm++,0<c&&(a+="H"+c.toString(32)),a+="_"}else c=pk++,a="_"+a+"r_"+c.toString(32)+"_";return r.memoizedState=a},useHostTransitionStatus:iy,useFormState:Rx,useActionState:Rx,useOptimistic:function(r){var a=Yi();a.memoizedState=a.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=sy.bind(null,mt,!0,c),c.dispatch=a,[r,a]},useMemoCache:Y_,useCacheRefresh:function(){return Yi().memoizedState=Ek.bind(null,mt)},useEffectEvent:function(r){var a=Yi(),c={impl:r};return a.memoizedState=c,function(){if((jt&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},ry={readContext:Ei,use:mm,useCallback:zx,useContext:Ei,useEffect:X_,useImperativeHandle:Bx,useInsertionEffect:Ox,useLayoutEffect:Ux,useMemo:qx,useReducer:pm,useRef:Dx,useState:function(){return pm(Co)},useDebugValue:ey,useDeferredValue:function(r,a){var c=zn();return Gx(c,an.memoizedState,r,a)},useTransition:function(){var r=pm(Co)[0],a=zn().memoizedState;return[typeof r=="boolean"?r:$d(r),a]},useSyncExternalStore:yx,useId:Wx,useHostTransitionStatus:iy,useFormState:Mx,useActionState:Mx,useOptimistic:function(r,a){var c=zn();return Sx(c,an,r,a)},useMemoCache:Y_,useCacheRefresh:Yx};ry.useEffectEvent=Vx;var Xx={readContext:Ei,use:mm,useCallback:zx,useContext:Ei,useEffect:X_,useImperativeHandle:Bx,useInsertionEffect:Ox,useLayoutEffect:Ux,useMemo:qx,useReducer:Z_,useRef:Dx,useState:function(){return Z_(Co)},useDebugValue:ey,useDeferredValue:function(r,a){var c=zn();return an===null?ty(c,r,a):Gx(c,an.memoizedState,r,a)},useTransition:function(){var r=Z_(Co)[0],a=zn().memoizedState;return[typeof r=="boolean"?r:$d(r),a]},useSyncExternalStore:yx,useId:Wx,useHostTransitionStatus:iy,useFormState:kx,useActionState:kx,useOptimistic:function(r,a){var c=zn();return an!==null?Sx(c,an,r,a):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:Y_,useCacheRefresh:Yx};Xx.useEffectEvent=Vx;function oy(r,a,c,m){a=r.memoizedState,c=c(m,a),c=c==null?a:x({},a,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var ay={enqueueSetState:function(r,a,c){r=r._reactInternals;var m=Os(),w=ba(m);w.payload=a,c!=null&&(w.callback=c),a=Ca(r,w,m),a!==null&&(fs(a,r,m),Yd(a,r,m))},enqueueReplaceState:function(r,a,c){r=r._reactInternals;var m=Os(),w=ba(m);w.tag=1,w.payload=a,c!=null&&(w.callback=c),a=Ca(r,w,m),a!==null&&(fs(a,r,m),Yd(a,r,m))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var c=Os(),m=ba(c);m.tag=2,a!=null&&(m.callback=a),a=Ca(r,m,c),a!==null&&(fs(a,r,c),Yd(a,r,c))}};function ew(r,a,c,m,w,S,R){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(m,S,R):a.prototype&&a.prototype.isPureReactComponent?!ya(c,m)||!ya(w,S):!0}function tw(r,a,c,m){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,m),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,m),a.state!==r&&ay.enqueueReplaceState(a,a.state,null)}function Xl(r,a){var c=a;if("ref"in a){c={};for(var m in a)m!=="ref"&&(c[m]=a[m])}if(r=r.defaultProps){c===a&&(c=x({},c));for(var w in r)c[w]===void 0&&(c[w]=r[w])}return c}function nw(r){zl(r)}function iw(r){console.error(r)}function sw(r){zl(r)}function vm(r,a){try{var c=r.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(m){setTimeout(function(){throw m})}}function rw(r,a,c){try{var m=r.onCaughtError;m(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function ly(r,a,c){return c=ba(c),c.tag=3,c.payload={element:null},c.callback=function(){vm(r,a)},c}function ow(r){return r=ba(r),r.tag=3,r}function aw(r,a,c,m){var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var S=m.value;r.payload=function(){return w(S)},r.callback=function(){rw(a,c,m)}}var R=c.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(r.callback=function(){rw(a,c,m),typeof w!="function"&&(Pa===null?Pa=new Set([this]):Pa.add(this));var V=m.stack;this.componentDidCatch(m.value,{componentStack:V!==null?V:""})})}function wk(r,a,c,m,w){if(c.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(a=c.alternate,a!==null&&oc(a,c,w,!0),c=ks.current,c!==null){switch(c.tag){case 31:case 13:return sr===null?Mm():c.alternate===null&&Ln===0&&(Ln=3),c.flags&=-257,c.flags|=65536,c.lanes=w,m===om?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([m]):a.add(m),ky(r,m,w)),!1;case 22:return c.flags|=65536,m===om?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([m])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([m]):c.add(m)),ky(r,m,w)),!1}throw Error(i(435,c.tag))}return ky(r,m,w),Mm(),!1}if(xt)return a=ks.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=w,m!==rc&&(r=Error(i(422),{cause:m}),jl(f(r,c)))):(m!==rc&&(a=Error(i(423),{cause:m}),jl(f(a,c))),r=r.current.alternate,r.flags|=65536,w&=-w,r.lanes|=w,m=f(m,c),w=ly(r.stateNode,m,w),U_(r,w),Ln!==4&&(Ln=2)),!1;var S=Error(i(520),{cause:m});if(S=f(S,c),lh===null?lh=[S]:lh.push(S),Ln!==4&&(Ln=2),a===null)return!0;m=f(m,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,r=w&-w,c.lanes|=r,r=ly(c.stateNode,m,r),U_(c,r),!1;case 1:if(a=c.type,S=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Pa===null||!Pa.has(S))))return c.flags|=65536,w&=-w,c.lanes|=w,w=ow(w),aw(w,r,c,m),U_(c,w),!1}c=c.return}while(c!==null);return!1}var uy=Error(i(461)),Zn=!1;function xi(r,a,c,m){a.child=r===null?dx(a,null,c,m):Ql(a,r.child,c,m)}function lw(r,a,c,m,w){c=c.render;var S=a.ref;if("ref"in m){var R={};for(var V in m)V!=="ref"&&(R[V]=m[V])}else R=m;return Wl(a),m=H_(r,a,c,R,S,w),V=j_(),r!==null&&!Zn?(K_(r,a,w),Io(r,a,w)):(xt&&V&&ti(a),a.flags|=1,xi(r,a,m,w),a.child)}function uw(r,a,c,m,w){if(r===null){var S=c.type;return typeof S=="function"&&!ic(S)&&S.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=S,cw(r,a,S,m,w)):(r=Hl(c.type,null,m,a,a.mode,w),r.ref=a.ref,r.return=a,a.child=r)}if(S=r.child,!_y(r,w)){var R=S.memoizedProps;if(c=c.compare,c=c!==null?c:ya,c(R,m)&&r.ref===a.ref)return Io(r,a,w)}return a.flags|=1,r=ir(S,m),r.ref=a.ref,r.return=a,a.child=r}function cw(r,a,c,m,w){if(r!==null){var S=r.memoizedProps;if(ya(S,m)&&r.ref===a.ref)if(Zn=!1,a.pendingProps=m=S,_y(r,w))(r.flags&131072)!==0&&(Zn=!0);else return a.lanes=r.lanes,Io(r,a,w)}return cy(r,a,c,m,w)}function dw(r,a,c,m){var w=m.children,S=r!==null?r.memoizedState:null;if(r===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((a.flags&128)!==0){if(S=S!==null?S.baseLanes|c:c,r!==null){for(m=a.child=r.child,w=0;m!==null;)w=w|m.lanes|m.childLanes,m=m.sibling;m=w&~S}else m=0,a.child=null;return hw(r,a,S,c,m)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&sm(a,S!==null?S.cachePool:null),S!==null?mx(a,S):B_(),px(a);else return m=a.lanes=536870912,hw(r,a,S!==null?S.baseLanes|c:c,c,m)}else S!==null?(sm(a,S.cachePool),mx(a,S),Aa(),a.memoizedState=null):(r!==null&&sm(a,null),B_(),Aa());return xi(r,a,w,c),a.child}function th(r,a){return r!==null&&r.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function hw(r,a,c,m,w){var S=D_();return S=S===null?null:{parent:Yn._currentValue,pool:S},a.memoizedState={baseLanes:c,cachePool:S},r!==null&&sm(a,null),B_(),px(a),r!==null&&oc(r,a,m,!0),a.childLanes=w,null}function Tm(r,a){return a=xm({mode:a.mode,children:a.children},r.mode),a.ref=r.ref,r.child=a,a.return=r,a}function fw(r,a,c){return Ql(a,r.child,null,c),r=Tm(a,a.pendingProps),r.flags|=2,Ds(a),a.memoizedState=null,r}function Sk(r,a,c){var m=a.pendingProps,w=(a.flags&128)!==0;if(a.flags&=-129,r===null){if(xt){if(m.mode==="hidden")return r=Tm(a,m),a.lanes=536870912,th(null,r);if(q_(a),(r=zt)?(r=bS(r,ls),r=r!==null&&r.data==="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:ue!==null?{id:Ee,overflow:Le}:null,retryLane:536870912,hydrationErrors:null},c=Bd(r),c.return=a,a.child=c,Bt=a,zt=null)):r=null,r===null)throw Zr(a);return a.lanes=536870912,null}return Tm(a,m)}var S=r.memoizedState;if(S!==null){var R=S.dehydrated;if(q_(a),w)if(a.flags&256)a.flags&=-257,a=fw(r,a,c);else if(a.memoizedState!==null)a.child=r.child,a.flags|=128,a=null;else throw Error(i(558));else if(Zn||oc(r,a,c,!1),w=(c&r.childLanes)!==0,Zn||w){if(m=hn,m!==null&&(R=xl(m,c),R!==0&&R!==S.retryLane))throw S.retryLane=R,nr(r,R),fs(m,r,R),uy;Mm(),a=fw(r,a,c)}else r=S.treeContext,zt=rr(R.nextSibling),Bt=a,xt=!0,Jr=null,ls=!1,r!==null&&Wi(a,r),a=Tm(a,m),a.flags|=4096;return a}return r=ir(r.child,{mode:m.mode,children:m.children}),r.ref=a.ref,a.child=r,r.return=a,r}function Em(r,a){var c=a.ref;if(c===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(r===null||r.ref!==c)&&(a.flags|=4194816)}}function cy(r,a,c,m,w){return Wl(a),c=H_(r,a,c,m,void 0,w),m=j_(),r!==null&&!Zn?(K_(r,a,w),Io(r,a,w)):(xt&&m&&ti(a),a.flags|=1,xi(r,a,c,w),a.child)}function mw(r,a,c,m,w,S){return Wl(a),a.updateQueue=null,c=_x(a,m,c,w),gx(r),m=j_(),r!==null&&!Zn?(K_(r,a,S),Io(r,a,S)):(xt&&m&&ti(a),a.flags|=1,xi(r,a,c,S),a.child)}function pw(r,a,c,m,w){if(Wl(a),a.stateNode===null){var S=Eo,R=c.contextType;typeof R=="object"&&R!==null&&(S=Ei(R)),S=new c(m,S),a.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=ay,a.stateNode=S,S._reactInternals=a,S=a.stateNode,S.props=m,S.state=a.memoizedState,S.refs={},V_(a),R=c.contextType,S.context=typeof R=="object"&&R!==null?Ei(R):Eo,S.state=a.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&(oy(a,c,R,m),S.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(R=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),R!==S.state&&ay.enqueueReplaceState(S,S.state,null),Zd(a,m,S,w),Jd(),S.state=a.memoizedState),typeof S.componentDidMount=="function"&&(a.flags|=4194308),m=!0}else if(r===null){S=a.stateNode;var V=a.memoizedProps,J=Xl(c,V);S.props=J;var ae=S.context,ye=c.contextType;R=Eo,typeof ye=="object"&&ye!==null&&(R=Ei(ye));var xe=c.getDerivedStateFromProps;ye=typeof xe=="function"||typeof S.getSnapshotBeforeUpdate=="function",V=a.pendingProps!==V,ye||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(V||ae!==R)&&tw(a,S,m,R),Sa=!1;var ce=a.memoizedState;S.state=ce,Zd(a,m,S,w),Jd(),ae=a.memoizedState,V||ce!==ae||Sa?(typeof xe=="function"&&(oy(a,c,xe,m),ae=a.memoizedState),(J=Sa||ew(a,c,J,m,ce,ae,R))?(ye||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=m,a.memoizedState=ae),S.props=m,S.state=ae,S.context=R,m=J):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),m=!1)}else{S=a.stateNode,O_(r,a),R=a.memoizedProps,ye=Xl(c,R),S.props=ye,xe=a.pendingProps,ce=S.context,ae=c.contextType,J=Eo,typeof ae=="object"&&ae!==null&&(J=Ei(ae)),V=c.getDerivedStateFromProps,(ae=typeof V=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(R!==xe||ce!==J)&&tw(a,S,m,J),Sa=!1,ce=a.memoizedState,S.state=ce,Zd(a,m,S,w),Jd();var ge=a.memoizedState;R!==xe||ce!==ge||Sa||r!==null&&r.dependencies!==null&&nm(r.dependencies)?(typeof V=="function"&&(oy(a,c,V,m),ge=a.memoizedState),(ye=Sa||ew(a,c,ye,m,ce,ge,J)||r!==null&&r.dependencies!==null&&nm(r.dependencies))?(ae||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(m,ge,J),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(m,ge,J)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||R===r.memoizedProps&&ce===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&ce===r.memoizedState||(a.flags|=1024),a.memoizedProps=m,a.memoizedState=ge),S.props=m,S.state=ge,S.context=J,m=ye):(typeof S.componentDidUpdate!="function"||R===r.memoizedProps&&ce===r.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||R===r.memoizedProps&&ce===r.memoizedState||(a.flags|=1024),m=!1)}return S=m,Em(r,a),m=(a.flags&128)!==0,S||m?(S=a.stateNode,c=m&&typeof c.getDerivedStateFromError!="function"?null:S.render(),a.flags|=1,r!==null&&m?(a.child=Ql(a,r.child,null,w),a.child=Ql(a,null,c,w)):xi(r,a,c,w),a.memoizedState=S.state,r=a.child):r=Io(r,a,w),r}function gw(r,a,c,m){return wo(),a.flags|=256,xi(r,a,c,m),a.child}var dy={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hy(r){return{baseLanes:r,cachePool:rx()}}function fy(r,a,c){return r=r!==null?r.childLanes&~c:0,a&&(r|=Vs),r}function _w(r,a,c){var m=a.pendingProps,w=!1,S=(a.flags&128)!==0,R;if((R=S)||(R=r!==null&&r.memoizedState===null?!1:(Bn.current&2)!==0),R&&(w=!0,a.flags&=-129),R=(a.flags&32)!==0,a.flags&=-33,r===null){if(xt){if(w?Ia(a):Aa(),(r=zt)?(r=bS(r,ls),r=r!==null&&r.data!=="&"?r:null,r!==null&&(a.memoizedState={dehydrated:r,treeContext:ue!==null?{id:Ee,overflow:Le}:null,retryLane:536870912,hydrationErrors:null},c=Bd(r),c.return=a,a.child=c,Bt=a,zt=null)):r=null,r===null)throw Zr(a);return Jy(r)?a.lanes=32:a.lanes=536870912,null}var V=m.children;return m=m.fallback,w?(Aa(),w=a.mode,V=xm({mode:"hidden",children:V},w),m=xo(m,w,c,null),V.return=a,m.return=a,V.sibling=m,a.child=V,m=a.child,m.memoizedState=hy(c),m.childLanes=fy(r,R,c),a.memoizedState=dy,th(null,m)):(Ia(a),my(a,V))}var J=r.memoizedState;if(J!==null&&(V=J.dehydrated,V!==null)){if(S)a.flags&256?(Ia(a),a.flags&=-257,a=py(r,a,c)):a.memoizedState!==null?(Aa(),a.child=r.child,a.flags|=128,a=null):(Aa(),V=m.fallback,w=a.mode,m=xm({mode:"visible",children:m.children},w),V=xo(V,w,c,null),V.flags|=2,m.return=a,V.return=a,m.sibling=V,a.child=m,Ql(a,r.child,null,c),m=a.child,m.memoizedState=hy(c),m.childLanes=fy(r,R,c),a.memoizedState=dy,a=th(null,m));else if(Ia(a),Jy(V)){if(R=V.nextSibling&&V.nextSibling.dataset,R)var ae=R.dgst;R=ae,m=Error(i(419)),m.stack="",m.digest=R,jl({value:m,source:null,stack:null}),a=py(r,a,c)}else if(Zn||oc(r,a,c,!1),R=(c&r.childLanes)!==0,Zn||R){if(R=hn,R!==null&&(m=xl(R,c),m!==0&&m!==J.retryLane))throw J.retryLane=m,nr(r,m),fs(R,r,m),uy;Yy(V)||Mm(),a=py(r,a,c)}else Yy(V)?(a.flags|=192,a.child=r.child,a=null):(r=J.treeContext,zt=rr(V.nextSibling),Bt=a,xt=!0,Jr=null,ls=!1,r!==null&&Wi(a,r),a=my(a,m.children),a.flags|=4096);return a}return w?(Aa(),V=m.fallback,w=a.mode,J=r.child,ae=J.sibling,m=ir(J,{mode:"hidden",children:m.children}),m.subtreeFlags=J.subtreeFlags&65011712,ae!==null?V=ir(ae,V):(V=xo(V,w,c,null),V.flags|=2),V.return=a,m.return=a,m.sibling=V,a.child=m,th(null,m),m=a.child,V=r.child.memoizedState,V===null?V=hy(c):(w=V.cachePool,w!==null?(J=Yn._currentValue,w=w.parent!==J?{parent:J,pool:J}:w):w=rx(),V={baseLanes:V.baseLanes|c,cachePool:w}),m.memoizedState=V,m.childLanes=fy(r,R,c),a.memoizedState=dy,th(r.child,m)):(Ia(a),c=r.child,r=c.sibling,c=ir(c,{mode:"visible",children:m.children}),c.return=a,c.sibling=null,r!==null&&(R=a.deletions,R===null?(a.deletions=[r],a.flags|=16):R.push(r)),a.child=c,a.memoizedState=null,c)}function my(r,a){return a=xm({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function xm(r,a){return r=Ri(22,r,null,a),r.lanes=0,r}function py(r,a,c){return Ql(a,r.child,null,c),r=my(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function yw(r,a,c){r.lanes|=a;var m=r.alternate;m!==null&&(m.lanes|=a),R_(r.return,a,c)}function gy(r,a,c,m,w,S){var R=r.memoizedState;R===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:m,tail:c,tailMode:w,treeForkCount:S}:(R.isBackwards=a,R.rendering=null,R.renderingStartTime=0,R.last=m,R.tail=c,R.tailMode=w,R.treeForkCount=S)}function vw(r,a,c){var m=a.pendingProps,w=m.revealOrder,S=m.tail;m=m.children;var R=Bn.current,V=(R&2)!==0;if(V?(R=R&1|2,a.flags|=128):R&=1,Ie(Bn,R),xi(r,a,m,c),m=xt?D:0,!V&&r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&yw(r,c,a);else if(r.tag===19)yw(r,c,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(w){case"forwards":for(c=a.child,w=null;c!==null;)r=c.alternate,r!==null&&cm(r)===null&&(w=c),c=c.sibling;c=w,c===null?(w=a.child,a.child=null):(w=c.sibling,c.sibling=null),gy(a,!1,w,c,S,m);break;case"backwards":case"unstable_legacy-backwards":for(c=null,w=a.child,a.child=null;w!==null;){if(r=w.alternate,r!==null&&cm(r)===null){a.child=w;break}r=w.sibling,w.sibling=c,c=w,w=r}gy(a,!0,c,null,S,m);break;case"together":gy(a,!1,null,null,void 0,m);break;default:a.memoizedState=null}return a.child}function Io(r,a,c){if(r!==null&&(a.dependencies=r.dependencies),Ma|=a.lanes,(c&a.childLanes)===0)if(r!==null){if(oc(r,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(i(153));if(a.child!==null){for(r=a.child,c=ir(r,r.pendingProps),a.child=c,c.return=a;r.sibling!==null;)r=r.sibling,c=c.sibling=ir(r,r.pendingProps),c.return=a;c.sibling=null}return a.child}function _y(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&nm(r)))}function bk(r,a,c){switch(a.tag){case 3:Be(a,a.stateNode.containerInfo),wa(a,Yn,r.memoizedState.cache),wo();break;case 27:case 5:At(a);break;case 4:Be(a,a.stateNode.containerInfo);break;case 10:wa(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,q_(a),null;break;case 13:var m=a.memoizedState;if(m!==null)return m.dehydrated!==null?(Ia(a),a.flags|=128,null):(c&a.child.childLanes)!==0?_w(r,a,c):(Ia(a),r=Io(r,a,c),r!==null?r.sibling:null);Ia(a);break;case 19:var w=(r.flags&128)!==0;if(m=(c&a.childLanes)!==0,m||(oc(r,a,c,!1),m=(c&a.childLanes)!==0),w){if(m)return vw(r,a,c);a.flags|=128}if(w=a.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Ie(Bn,Bn.current),m)break;return null;case 22:return a.lanes=0,dw(r,a,c,a.pendingProps);case 24:wa(a,Yn,r.memoizedState.cache)}return Io(r,a,c)}function Tw(r,a,c){if(r!==null)if(r.memoizedProps!==a.pendingProps)Zn=!0;else{if(!_y(r,c)&&(a.flags&128)===0)return Zn=!1,bk(r,a,c);Zn=(r.flags&131072)!==0}else Zn=!1,xt&&(a.flags&1048576)!==0&&pt(a,D,a.index);switch(a.lanes=0,a.tag){case 16:e:{var m=a.pendingProps;if(r=Jl(a.elementType),a.type=r,typeof r=="function")ic(r)?(m=Xl(r,m),a.tag=1,a=pw(null,a,r,m,c)):(a.tag=0,a=cy(null,a,r,m,c));else{if(r!=null){var w=r.$$typeof;if(w===he){a.tag=11,a=lw(null,a,r,m,c);break e}else if(w===k){a.tag=14,a=uw(null,a,r,m,c);break e}}throw a=He(r)||r,Error(i(306,a,""))}}return a;case 0:return cy(r,a,a.type,a.pendingProps,c);case 1:return m=a.type,w=Xl(m,a.pendingProps),pw(r,a,m,w,c);case 3:e:{if(Be(a,a.stateNode.containerInfo),r===null)throw Error(i(387));m=a.pendingProps;var S=a.memoizedState;w=S.element,O_(r,a),Zd(a,m,null,c);var R=a.memoizedState;if(m=R.cache,wa(a,Yn,m),m!==S.cache&&M_(a,[Yn],c,!0),Jd(),m=R.element,S.isDehydrated)if(S={element:m,isDehydrated:!1,cache:R.cache},a.updateQueue.baseState=S,a.memoizedState=S,a.flags&256){a=gw(r,a,m,c);break e}else if(m!==w){w=f(Error(i(424)),a),jl(w),a=gw(r,a,m,c);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(zt=rr(r.firstChild),Bt=a,xt=!0,Jr=null,ls=!0,c=dx(a,null,m,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(wo(),m===w){a=Io(r,a,c);break e}xi(r,a,m,c)}a=a.child}return a;case 26:return Em(r,a),r===null?(c=MS(a.type,null,a.pendingProps,null))?a.memoizedState=c:xt||(c=a.type,r=a.pendingProps,m=Um(Ce.current).createElement(c),m[Cn]=a,m[Mn]=r,wi(m,c,r),Pn(m),a.stateNode=m):a.memoizedState=MS(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return At(a),r===null&&xt&&(m=a.stateNode=AS(a.type,a.pendingProps,Ce.current),Bt=a,ls=!0,w=zt,Va(a.type)?(Zy=w,zt=rr(m.firstChild)):zt=w),xi(r,a,a.pendingProps.children,c),Em(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&xt&&((w=m=zt)&&(m=tD(m,a.type,a.pendingProps,ls),m!==null?(a.stateNode=m,Bt=a,zt=rr(m.firstChild),ls=!1,w=!0):w=!1),w||Zr(a)),At(a),w=a.type,S=a.pendingProps,R=r!==null?r.memoizedProps:null,m=S.children,jy(w,S)?m=null:R!==null&&jy(w,R)&&(a.flags|=32),a.memoizedState!==null&&(w=H_(r,a,gk,null,null,c),gh._currentValue=w),Em(r,a),xi(r,a,m,c),a.child;case 6:return r===null&&xt&&((r=c=zt)&&(c=nD(c,a.pendingProps,ls),c!==null?(a.stateNode=c,Bt=a,zt=null,r=!0):r=!1),r||Zr(a)),null;case 13:return _w(r,a,c);case 4:return Be(a,a.stateNode.containerInfo),m=a.pendingProps,r===null?a.child=Ql(a,null,m,c):xi(r,a,m,c),a.child;case 11:return lw(r,a,a.type,a.pendingProps,c);case 7:return xi(r,a,a.pendingProps,c),a.child;case 8:return xi(r,a,a.pendingProps.children,c),a.child;case 12:return xi(r,a,a.pendingProps.children,c),a.child;case 10:return m=a.pendingProps,wa(a,a.type,m.value),xi(r,a,m.children,c),a.child;case 9:return w=a.type._context,m=a.pendingProps.children,Wl(a),w=Ei(w),m=m(w),a.flags|=1,xi(r,a,m,c),a.child;case 14:return uw(r,a,a.type,a.pendingProps,c);case 15:return cw(r,a,a.type,a.pendingProps,c);case 19:return vw(r,a,c);case 31:return Sk(r,a,c);case 22:return dw(r,a,c,a.pendingProps);case 24:return Wl(a),m=Ei(Yn),r===null?(w=D_(),w===null&&(w=hn,S=P_(),w.pooledCache=S,S.refCount++,S!==null&&(w.pooledCacheLanes|=c),w=S),a.memoizedState={parent:m,cache:w},V_(a),wa(a,Yn,w)):((r.lanes&c)!==0&&(O_(r,a),Zd(a,null,null,c),Jd()),w=r.memoizedState,S=a.memoizedState,w.parent!==m?(w={parent:m,cache:m},a.memoizedState=w,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=w),wa(a,Yn,m)):(m=S.cache,wa(a,Yn,m),m!==w.cache&&M_(a,[Yn],c,!0))),xi(r,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Ao(r){r.flags|=4}function yy(r,a,c,m,w){if((a=(r.mode&32)!==0)&&(a=!1),a){if(r.flags|=16777216,(w&335544128)===w)if(r.stateNode.complete)r.flags|=8192;else if(Ww())r.flags|=8192;else throw Zl=om,L_}else r.flags&=-16777217}function Ew(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!VS(a))if(Ww())r.flags|=8192;else throw Zl=om,L_}function wm(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?Gu():536870912,r.lanes|=a,yc|=a)}function nh(r,a){if(!xt)switch(r.tailMode){case"hidden":a=r.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var m=null;c!==null;)c.alternate!==null&&(m=c),c=c.sibling;m===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:m.sibling=null}}function En(r){var a=r.alternate!==null&&r.alternate.child===r.child,c=0,m=0;if(a)for(var w=r.child;w!==null;)c|=w.lanes|w.childLanes,m|=w.subtreeFlags&65011712,m|=w.flags&65011712,w.return=r,w=w.sibling;else for(w=r.child;w!==null;)c|=w.lanes|w.childLanes,m|=w.subtreeFlags,m|=w.flags,w.return=r,w=w.sibling;return r.subtreeFlags|=m,r.childLanes=c,a}function Ck(r,a,c){var m=a.pendingProps;switch(kn(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return En(a),null;case 1:return En(a),null;case 3:return c=a.stateNode,m=null,r!==null&&(m=r.memoizedState.cache),a.memoizedState.cache!==m&&(a.flags|=2048),So(Yn),Ye(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(xr(a)?Ao(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Gd())),En(a),null;case 26:var w=a.type,S=a.memoizedState;return r===null?(Ao(a),S!==null?(En(a),Ew(a,S)):(En(a),yy(a,w,null,m,c))):S?S!==r.memoizedState?(Ao(a),En(a),Ew(a,S)):(En(a),a.flags&=-16777217):(r=r.memoizedProps,r!==m&&Ao(a),En(a),yy(a,w,r,m,c)),null;case 27:if(Jt(a),c=Ce.current,w=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==m&&Ao(a);else{if(!m){if(a.stateNode===null)throw Error(i(166));return En(a),null}r=le.current,xr(a)?qd(a):(r=AS(w,m,c),a.stateNode=r,Ao(a))}return En(a),null;case 5:if(Jt(a),w=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==m&&Ao(a);else{if(!m){if(a.stateNode===null)throw Error(i(166));return En(a),null}if(S=le.current,xr(a))qd(a);else{var R=Um(Ce.current);switch(S){case 1:S=R.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:S=R.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":S=R.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":S=R.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":S=R.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof m.is=="string"?R.createElement("select",{is:m.is}):R.createElement("select"),m.multiple?S.multiple=!0:m.size&&(S.size=m.size);break;default:S=typeof m.is=="string"?R.createElement(w,{is:m.is}):R.createElement(w)}}S[Cn]=a,S[Mn]=m;e:for(R=a.child;R!==null;){if(R.tag===5||R.tag===6)S.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===a)break e;for(;R.sibling===null;){if(R.return===null||R.return===a)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}a.stateNode=S;e:switch(wi(S,w,m),w){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&Ao(a)}}return En(a),yy(a,a.type,r===null?null:r.memoizedProps,a.pendingProps,c),null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==m&&Ao(a);else{if(typeof m!="string"&&a.stateNode===null)throw Error(i(166));if(r=Ce.current,xr(a)){if(r=a.stateNode,c=a.memoizedProps,m=null,w=Bt,w!==null)switch(w.tag){case 27:case 5:m=w.memoizedProps}r[Cn]=a,r=!!(r.nodeValue===c||m!==null&&m.suppressHydrationWarning===!0||_S(r.nodeValue,c)),r||Zr(a,!0)}else r=Um(r).createTextNode(m),r[Cn]=a,a.stateNode=r}return En(a),null;case 31:if(c=a.memoizedState,r===null||r.memoizedState!==null){if(m=xr(a),c!==null){if(r===null){if(!m)throw Error(i(318));if(r=a.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Cn]=a}else wo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;En(a),r=!1}else c=Gd(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=c),r=!0;if(!r)return a.flags&256?(Ds(a),a):(Ds(a),null);if((a.flags&128)!==0)throw Error(i(558))}return En(a),null;case 13:if(m=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(w=xr(a),m!==null&&m.dehydrated!==null){if(r===null){if(!w)throw Error(i(318));if(w=a.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(i(317));w[Cn]=a}else wo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;En(a),w=!1}else w=Gd(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=w),w=!0;if(!w)return a.flags&256?(Ds(a),a):(Ds(a),null)}return Ds(a),(a.flags&128)!==0?(a.lanes=c,a):(c=m!==null,r=r!==null&&r.memoizedState!==null,c&&(m=a.child,w=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(w=m.alternate.memoizedState.cachePool.pool),S=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(S=m.memoizedState.cachePool.pool),S!==w&&(m.flags|=2048)),c!==r&&c&&(a.child.flags|=8192),wm(a,a.updateQueue),En(a),null);case 4:return Ye(),r===null&&By(a.stateNode.containerInfo),En(a),null;case 10:return So(a.type),En(a),null;case 19:if(me(Bn),m=a.memoizedState,m===null)return En(a),null;if(w=(a.flags&128)!==0,S=m.rendering,S===null)if(w)nh(m,!1);else{if(Ln!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(S=cm(r),S!==null){for(a.flags|=128,nh(m,!1),r=S.updateQueue,a.updateQueue=r,wm(a,r),a.subtreeFlags=0,r=c,c=a.child;c!==null;)Fd(c,r),c=c.sibling;return Ie(Bn,Bn.current&1|2),xt&&Je(a,m.treeForkCount),a.child}r=r.sibling}m.tail!==null&&lt()>Am&&(a.flags|=128,w=!0,nh(m,!1),a.lanes=4194304)}else{if(!w)if(r=cm(S),r!==null){if(a.flags|=128,w=!0,r=r.updateQueue,a.updateQueue=r,wm(a,r),nh(m,!0),m.tail===null&&m.tailMode==="hidden"&&!S.alternate&&!xt)return En(a),null}else 2*lt()-m.renderingStartTime>Am&&c!==536870912&&(a.flags|=128,w=!0,nh(m,!1),a.lanes=4194304);m.isBackwards?(S.sibling=a.child,a.child=S):(r=m.last,r!==null?r.sibling=S:a.child=S,m.last=S)}return m.tail!==null?(r=m.tail,m.rendering=r,m.tail=r.sibling,m.renderingStartTime=lt(),r.sibling=null,c=Bn.current,Ie(Bn,w?c&1|2:c&1),xt&&Je(a,m.treeForkCount),r):(En(a),null);case 22:case 23:return Ds(a),z_(),m=a.memoizedState!==null,r!==null?r.memoizedState!==null!==m&&(a.flags|=8192):m&&(a.flags|=8192),m?(c&536870912)!==0&&(a.flags&128)===0&&(En(a),a.subtreeFlags&6&&(a.flags|=8192)):En(a),c=a.updateQueue,c!==null&&wm(a,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),m=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(m=a.memoizedState.cachePool.pool),m!==c&&(a.flags|=2048),r!==null&&me(Yl),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),So(Yn),En(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function Ik(r,a){switch(kn(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return So(Yn),Ye(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return Jt(a),null;case 31:if(a.memoizedState!==null){if(Ds(a),a.alternate===null)throw Error(i(340));wo()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 13:if(Ds(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(i(340));wo()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return me(Bn),null;case 4:return Ye(),null;case 10:return So(a.type),null;case 22:case 23:return Ds(a),z_(),r!==null&&me(Yl),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return So(Yn),null;case 25:return null;default:return null}}function xw(r,a){switch(kn(a),a.tag){case 3:So(Yn),Ye();break;case 26:case 27:case 5:Jt(a);break;case 4:Ye();break;case 31:a.memoizedState!==null&&Ds(a);break;case 13:Ds(a);break;case 19:me(Bn);break;case 10:So(a.type);break;case 22:case 23:Ds(a),z_(),r!==null&&me(Yl);break;case 24:So(Yn)}}function ih(r,a){try{var c=a.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var w=m.next;c=w;do{if((c.tag&r)===r){m=void 0;var S=c.create,R=c.inst;m=S(),R.destroy=m}c=c.next}while(c!==w)}}catch(V){Xt(a,a.return,V)}}function Na(r,a,c){try{var m=a.updateQueue,w=m!==null?m.lastEffect:null;if(w!==null){var S=w.next;m=S;do{if((m.tag&r)===r){var R=m.inst,V=R.destroy;if(V!==void 0){R.destroy=void 0,w=a;var J=c,ae=V;try{ae()}catch(ye){Xt(w,J,ye)}}}m=m.next}while(m!==S)}}catch(ye){Xt(a,a.return,ye)}}function ww(r){var a=r.updateQueue;if(a!==null){var c=r.stateNode;try{fx(a,c)}catch(m){Xt(r,r.return,m)}}}function Sw(r,a,c){c.props=Xl(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(m){Xt(r,a,m)}}function sh(r,a){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var m=r.stateNode;break;case 30:m=r.stateNode;break;default:m=r.stateNode}typeof c=="function"?r.refCleanup=c(m):c.current=m}}catch(w){Xt(r,a,w)}}function $r(r,a){var c=r.ref,m=r.refCleanup;if(c!==null)if(typeof m=="function")try{m()}catch(w){Xt(r,a,w)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(w){Xt(r,a,w)}else c.current=null}function bw(r){var a=r.type,c=r.memoizedProps,m=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&m.focus();break e;case"img":c.src?m.src=c.src:c.srcSet&&(m.srcset=c.srcSet)}}catch(w){Xt(r,r.return,w)}}function vy(r,a,c){try{var m=r.stateNode;Jk(m,r.type,c,a),m[Mn]=a}catch(w){Xt(r,r.return,w)}}function Cw(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Va(r.type)||r.tag===4}function Ty(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Cw(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Va(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Ey(r,a,c){var m=r.tag;if(m===5||m===6)r=r.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(r),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=bi));else if(m!==4&&(m===27&&Va(r.type)&&(c=r.stateNode,a=null),r=r.child,r!==null))for(Ey(r,a,c),r=r.sibling;r!==null;)Ey(r,a,c),r=r.sibling}function Sm(r,a,c){var m=r.tag;if(m===5||m===6)r=r.stateNode,a?c.insertBefore(r,a):c.appendChild(r);else if(m!==4&&(m===27&&Va(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(Sm(r,a,c),r=r.sibling;r!==null;)Sm(r,a,c),r=r.sibling}function Iw(r){var a=r.stateNode,c=r.memoizedProps;try{for(var m=r.type,w=a.attributes;w.length;)a.removeAttributeNode(w[0]);wi(a,m,c),a[Cn]=r,a[Mn]=c}catch(S){Xt(r,r.return,S)}}var No=!1,Qn=!1,xy=!1,Aw=typeof WeakSet=="function"?WeakSet:Set,fi=null;function Ak(r,a){if(r=r.containerInfo,Gy=jm,r=Ol(r),Hr(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var m=c.getSelection&&c.getSelection();if(m&&m.rangeCount!==0){c=m.anchorNode;var w=m.anchorOffset,S=m.focusNode;m=m.focusOffset;try{c.nodeType,S.nodeType}catch{c=null;break e}var R=0,V=-1,J=-1,ae=0,ye=0,xe=r,ce=null;t:for(;;){for(var ge;xe!==c||w!==0&&xe.nodeType!==3||(V=R+w),xe!==S||m!==0&&xe.nodeType!==3||(J=R+m),xe.nodeType===3&&(R+=xe.nodeValue.length),(ge=xe.firstChild)!==null;)ce=xe,xe=ge;for(;;){if(xe===r)break t;if(ce===c&&++ae===w&&(V=R),ce===S&&++ye===m&&(J=R),(ge=xe.nextSibling)!==null)break;xe=ce,ce=xe.parentNode}xe=ge}c=V===-1||J===-1?null:{start:V,end:J}}else c=null}c=c||{start:0,end:0}}else c=null;for(Hy={focusedElem:r,selectionRange:c},jm=!1,fi=a;fi!==null;)if(a=fi,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,fi=r;else for(;fi!==null;){switch(a=fi,S=a.alternate,r=a.flags,a.tag){case 0:if((r&4)!==0&&(r=a.updateQueue,r=r!==null?r.events:null,r!==null))for(c=0;c<r.length;c++)w=r[c],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&S!==null){r=void 0,c=a,w=S.memoizedProps,S=S.memoizedState,m=c.stateNode;try{var Ge=Xl(c.type,w);r=m.getSnapshotBeforeUpdate(Ge,S),m.__reactInternalSnapshotBeforeUpdate=r}catch(tt){Xt(c,c.return,tt)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,c=r.nodeType,c===9)Wy(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Wy(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=a.sibling,r!==null){r.return=a.return,fi=r;break}fi=a.return}}function Nw(r,a,c){var m=c.flags;switch(c.tag){case 0:case 11:case 15:Mo(r,c),m&4&&ih(5,c);break;case 1:if(Mo(r,c),m&4)if(r=c.stateNode,a===null)try{r.componentDidMount()}catch(R){Xt(c,c.return,R)}else{var w=Xl(c.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(w,a,r.__reactInternalSnapshotBeforeUpdate)}catch(R){Xt(c,c.return,R)}}m&64&&ww(c),m&512&&sh(c,c.return);break;case 3:if(Mo(r,c),m&64&&(r=c.updateQueue,r!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{fx(r,a)}catch(R){Xt(c,c.return,R)}}break;case 27:a===null&&m&4&&Iw(c);case 26:case 5:Mo(r,c),a===null&&m&4&&bw(c),m&512&&sh(c,c.return);break;case 12:Mo(r,c);break;case 31:Mo(r,c),m&4&&Pw(r,c);break;case 13:Mo(r,c),m&4&&kw(r,c),m&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=Ok.bind(null,c),iD(r,c))));break;case 22:if(m=c.memoizedState!==null||No,!m){a=a!==null&&a.memoizedState!==null||Qn,w=No;var S=Qn;No=m,(Qn=a)&&!S?Po(r,c,(c.subtreeFlags&8772)!==0):Mo(r,c),No=w,Qn=S}break;case 30:break;default:Mo(r,c)}}function Rw(r){var a=r.alternate;a!==null&&(r.alternate=null,Rw(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&ra(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Sn=null,us=!1;function Ro(r,a,c){for(c=c.child;c!==null;)Mw(r,a,c),c=c.sibling}function Mw(r,a,c){if(Ne&&typeof Ne.onCommitFiberUnmount=="function")try{Ne.onCommitFiberUnmount(Ti,c)}catch{}switch(c.tag){case 26:Qn||$r(c,a),Ro(r,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Qn||$r(c,a);var m=Sn,w=us;Va(c.type)&&(Sn=c.stateNode,us=!1),Ro(r,a,c),fh(c.stateNode),Sn=m,us=w;break;case 5:Qn||$r(c,a);case 6:if(m=Sn,w=us,Sn=null,Ro(r,a,c),Sn=m,us=w,Sn!==null)if(us)try{(Sn.nodeType===9?Sn.body:Sn.nodeName==="HTML"?Sn.ownerDocument.body:Sn).removeChild(c.stateNode)}catch(S){Xt(c,a,S)}else try{Sn.removeChild(c.stateNode)}catch(S){Xt(c,a,S)}break;case 18:Sn!==null&&(us?(r=Sn,wS(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),Cc(r)):wS(Sn,c.stateNode));break;case 4:m=Sn,w=us,Sn=c.stateNode.containerInfo,us=!0,Ro(r,a,c),Sn=m,us=w;break;case 0:case 11:case 14:case 15:Na(2,c,a),Qn||Na(4,c,a),Ro(r,a,c);break;case 1:Qn||($r(c,a),m=c.stateNode,typeof m.componentWillUnmount=="function"&&Sw(c,a,m)),Ro(r,a,c);break;case 21:Ro(r,a,c);break;case 22:Qn=(m=Qn)||c.memoizedState!==null,Ro(r,a,c),Qn=m;break;default:Ro(r,a,c)}}function Pw(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Cc(r)}catch(c){Xt(a,a.return,c)}}}function kw(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Cc(r)}catch(c){Xt(a,a.return,c)}}function Nk(r){switch(r.tag){case 31:case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new Aw),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new Aw),a;default:throw Error(i(435,r.tag))}}function bm(r,a){var c=Nk(r);a.forEach(function(m){if(!c.has(m)){c.add(m);var w=Uk.bind(null,r,m);m.then(w,w)}})}function cs(r,a){var c=a.deletions;if(c!==null)for(var m=0;m<c.length;m++){var w=c[m],S=r,R=a,V=R;e:for(;V!==null;){switch(V.tag){case 27:if(Va(V.type)){Sn=V.stateNode,us=!1;break e}break;case 5:Sn=V.stateNode,us=!1;break e;case 3:case 4:Sn=V.stateNode.containerInfo,us=!0;break e}V=V.return}if(Sn===null)throw Error(i(160));Mw(S,R,w),Sn=null,us=!1,S=w.alternate,S!==null&&(S.return=null),w.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Dw(a,r),a=a.sibling}var Sr=null;function Dw(r,a){var c=r.alternate,m=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:cs(a,r),ds(r),m&4&&(Na(3,r,r.return),ih(3,r),Na(5,r,r.return));break;case 1:cs(a,r),ds(r),m&512&&(Qn||c===null||$r(c,c.return)),m&64&&No&&(r=r.updateQueue,r!==null&&(m=r.callbacks,m!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?m:c.concat(m))));break;case 26:var w=Sr;if(cs(a,r),ds(r),m&512&&(Qn||c===null||$r(c,c.return)),m&4){var S=c!==null?c.memoizedState:null;if(m=r.memoizedState,c===null)if(m===null)if(r.stateNode===null){e:{m=r.type,c=r.memoizedProps,w=w.ownerDocument||w;t:switch(m){case"title":S=w.getElementsByTagName("title")[0],(!S||S[js]||S[Cn]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=w.createElement(m),w.head.insertBefore(S,w.querySelector("head > title"))),wi(S,m,c),S[Cn]=r,Pn(S),m=S;break e;case"link":var R=DS("link","href",w).get(m+(c.href||""));if(R){for(var V=0;V<R.length;V++)if(S=R[V],S.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&S.getAttribute("rel")===(c.rel==null?null:c.rel)&&S.getAttribute("title")===(c.title==null?null:c.title)&&S.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){R.splice(V,1);break t}}S=w.createElement(m),wi(S,m,c),w.head.appendChild(S);break;case"meta":if(R=DS("meta","content",w).get(m+(c.content||""))){for(V=0;V<R.length;V++)if(S=R[V],S.getAttribute("content")===(c.content==null?null:""+c.content)&&S.getAttribute("name")===(c.name==null?null:c.name)&&S.getAttribute("property")===(c.property==null?null:c.property)&&S.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&S.getAttribute("charset")===(c.charSet==null?null:c.charSet)){R.splice(V,1);break t}}S=w.createElement(m),wi(S,m,c),w.head.appendChild(S);break;default:throw Error(i(468,m))}S[Cn]=r,Pn(S),m=S}r.stateNode=m}else LS(w,r.type,r.stateNode);else r.stateNode=kS(w,m,r.memoizedProps);else S!==m?(S===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):S.count--,m===null?LS(w,r.type,r.stateNode):kS(w,m,r.memoizedProps)):m===null&&r.stateNode!==null&&vy(r,r.memoizedProps,c.memoizedProps)}break;case 27:cs(a,r),ds(r),m&512&&(Qn||c===null||$r(c,c.return)),c!==null&&m&4&&vy(r,r.memoizedProps,c.memoizedProps);break;case 5:if(cs(a,r),ds(r),m&512&&(Qn||c===null||$r(c,c.return)),r.flags&32){w=r.stateNode;try{Kn(w,"")}catch(Ge){Xt(r,r.return,Ge)}}m&4&&r.stateNode!=null&&(w=r.memoizedProps,vy(r,w,c!==null?c.memoizedProps:w)),m&1024&&(xy=!0);break;case 6:if(cs(a,r),ds(r),m&4){if(r.stateNode===null)throw Error(i(162));m=r.memoizedProps,c=r.stateNode;try{c.nodeValue=m}catch(Ge){Xt(r,r.return,Ge)}}break;case 3:if(zm=null,w=Sr,Sr=Fm(a.containerInfo),cs(a,r),Sr=w,ds(r),m&4&&c!==null&&c.memoizedState.isDehydrated)try{Cc(a.containerInfo)}catch(Ge){Xt(r,r.return,Ge)}xy&&(xy=!1,Lw(r));break;case 4:m=Sr,Sr=Fm(r.stateNode.containerInfo),cs(a,r),ds(r),Sr=m;break;case 12:cs(a,r),ds(r);break;case 31:cs(a,r),ds(r),m&4&&(m=r.updateQueue,m!==null&&(r.updateQueue=null,bm(r,m)));break;case 13:cs(a,r),ds(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Im=lt()),m&4&&(m=r.updateQueue,m!==null&&(r.updateQueue=null,bm(r,m)));break;case 22:w=r.memoizedState!==null;var J=c!==null&&c.memoizedState!==null,ae=No,ye=Qn;if(No=ae||w,Qn=ye||J,cs(a,r),Qn=ye,No=ae,ds(r),m&8192)e:for(a=r.stateNode,a._visibility=w?a._visibility&-2:a._visibility|1,w&&(c===null||J||No||Qn||eu(r)),c=null,a=r;;){if(a.tag===5||a.tag===26){if(c===null){J=c=a;try{if(S=J.stateNode,w)R=S.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{V=J.stateNode;var xe=J.memoizedProps.style,ce=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;V.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(Ge){Xt(J,J.return,Ge)}}}else if(a.tag===6){if(c===null){J=a;try{J.stateNode.nodeValue=w?"":J.memoizedProps}catch(Ge){Xt(J,J.return,Ge)}}}else if(a.tag===18){if(c===null){J=a;try{var ge=J.stateNode;w?SS(ge,!0):SS(J.stateNode,!1)}catch(Ge){Xt(J,J.return,Ge)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}m&4&&(m=r.updateQueue,m!==null&&(c=m.retryQueue,c!==null&&(m.retryQueue=null,bm(r,c))));break;case 19:cs(a,r),ds(r),m&4&&(m=r.updateQueue,m!==null&&(r.updateQueue=null,bm(r,m)));break;case 30:break;case 21:break;default:cs(a,r),ds(r)}}function ds(r){var a=r.flags;if(a&2){try{for(var c,m=r.return;m!==null;){if(Cw(m)){c=m;break}m=m.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var w=c.stateNode,S=Ty(r);Sm(r,S,w);break;case 5:var R=c.stateNode;c.flags&32&&(Kn(R,""),c.flags&=-33);var V=Ty(r);Sm(r,V,R);break;case 3:case 4:var J=c.stateNode.containerInfo,ae=Ty(r);Ey(r,ae,J);break;default:throw Error(i(161))}}catch(ye){Xt(r,r.return,ye)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function Lw(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;Lw(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function Mo(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Nw(r,a.alternate,a),a=a.sibling}function eu(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:Na(4,a,a.return),eu(a);break;case 1:$r(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&Sw(a,a.return,c),eu(a);break;case 27:fh(a.stateNode);case 26:case 5:$r(a,a.return),eu(a);break;case 22:a.memoizedState===null&&eu(a);break;case 30:eu(a);break;default:eu(a)}r=r.sibling}}function Po(r,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var m=a.alternate,w=r,S=a,R=S.flags;switch(S.tag){case 0:case 11:case 15:Po(w,S,c),ih(4,S);break;case 1:if(Po(w,S,c),m=S,w=m.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(ae){Xt(m,m.return,ae)}if(m=S,w=m.updateQueue,w!==null){var V=m.stateNode;try{var J=w.shared.hiddenCallbacks;if(J!==null)for(w.shared.hiddenCallbacks=null,w=0;w<J.length;w++)hx(J[w],V)}catch(ae){Xt(m,m.return,ae)}}c&&R&64&&ww(S),sh(S,S.return);break;case 27:Iw(S);case 26:case 5:Po(w,S,c),c&&m===null&&R&4&&bw(S),sh(S,S.return);break;case 12:Po(w,S,c);break;case 31:Po(w,S,c),c&&R&4&&Pw(w,S);break;case 13:Po(w,S,c),c&&R&4&&kw(w,S);break;case 22:S.memoizedState===null&&Po(w,S,c),sh(S,S.return);break;case 30:break;default:Po(w,S,c)}a=a.sibling}}function wy(r,a){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&Hd(c))}function Sy(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Hd(r))}function br(r,a,c,m){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Vw(r,a,c,m),a=a.sibling}function Vw(r,a,c,m){var w=a.flags;switch(a.tag){case 0:case 11:case 15:br(r,a,c,m),w&2048&&ih(9,a);break;case 1:br(r,a,c,m);break;case 3:br(r,a,c,m),w&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Hd(r)));break;case 12:if(w&2048){br(r,a,c,m),r=a.stateNode;try{var S=a.memoizedProps,R=S.id,V=S.onPostCommit;typeof V=="function"&&V(R,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(J){Xt(a,a.return,J)}}else br(r,a,c,m);break;case 31:br(r,a,c,m);break;case 13:br(r,a,c,m);break;case 23:break;case 22:S=a.stateNode,R=a.alternate,a.memoizedState!==null?S._visibility&2?br(r,a,c,m):rh(r,a):S._visibility&2?br(r,a,c,m):(S._visibility|=2,pc(r,a,c,m,(a.subtreeFlags&10256)!==0||!1)),w&2048&&wy(R,a);break;case 24:br(r,a,c,m),w&2048&&Sy(a.alternate,a);break;default:br(r,a,c,m)}}function pc(r,a,c,m,w){for(w=w&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var S=r,R=a,V=c,J=m,ae=R.flags;switch(R.tag){case 0:case 11:case 15:pc(S,R,V,J,w),ih(8,R);break;case 23:break;case 22:var ye=R.stateNode;R.memoizedState!==null?ye._visibility&2?pc(S,R,V,J,w):rh(S,R):(ye._visibility|=2,pc(S,R,V,J,w)),w&&ae&2048&&wy(R.alternate,R);break;case 24:pc(S,R,V,J,w),w&&ae&2048&&Sy(R.alternate,R);break;default:pc(S,R,V,J,w)}a=a.sibling}}function rh(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=r,m=a,w=m.flags;switch(m.tag){case 22:rh(c,m),w&2048&&wy(m.alternate,m);break;case 24:rh(c,m),w&2048&&Sy(m.alternate,m);break;default:rh(c,m)}a=a.sibling}}var oh=8192;function gc(r,a,c){if(r.subtreeFlags&oh)for(r=r.child;r!==null;)Ow(r,a,c),r=r.sibling}function Ow(r,a,c){switch(r.tag){case 26:gc(r,a,c),r.flags&oh&&r.memoizedState!==null&&pD(c,Sr,r.memoizedState,r.memoizedProps);break;case 5:gc(r,a,c);break;case 3:case 4:var m=Sr;Sr=Fm(r.stateNode.containerInfo),gc(r,a,c),Sr=m;break;case 22:r.memoizedState===null&&(m=r.alternate,m!==null&&m.memoizedState!==null?(m=oh,oh=16777216,gc(r,a,c),oh=m):gc(r,a,c));break;default:gc(r,a,c)}}function Uw(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function ah(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var m=a[c];fi=m,Bw(m,r)}Uw(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Fw(r),r=r.sibling}function Fw(r){switch(r.tag){case 0:case 11:case 15:ah(r),r.flags&2048&&Na(9,r,r.return);break;case 3:ah(r);break;case 12:ah(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,Cm(r)):ah(r);break;default:ah(r)}}function Cm(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var m=a[c];fi=m,Bw(m,r)}Uw(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:Na(8,a,a.return),Cm(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,Cm(a));break;default:Cm(a)}r=r.sibling}}function Bw(r,a){for(;fi!==null;){var c=fi;switch(c.tag){case 0:case 11:case 15:Na(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var m=c.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:Hd(c.memoizedState.cache)}if(m=c.child,m!==null)m.return=c,fi=m;else e:for(c=r;fi!==null;){m=fi;var w=m.sibling,S=m.return;if(Rw(m),m===c){fi=null;break e}if(w!==null){w.return=S,fi=w;break e}fi=S}}}var Rk={getCacheForType:function(r){var a=Ei(Yn),c=a.data.get(r);return c===void 0&&(c=r(),a.data.set(r,c)),c},cacheSignal:function(){return Ei(Yn).controller.signal}},Mk=typeof WeakMap=="function"?WeakMap:Map,jt=0,hn=null,wt=null,kt=0,$t=0,Ls=null,Ra=!1,_c=!1,by=!1,ko=0,Ln=0,Ma=0,tu=0,Cy=0,Vs=0,yc=0,lh=null,hs=null,Iy=!1,Im=0,zw=0,Am=1/0,Nm=null,Pa=null,ni=0,ka=null,vc=null,Do=0,Ay=0,Ny=null,qw=null,uh=0,Ry=null;function Os(){return(jt&2)!==0&&kt!==0?kt&-kt:se.T!==null?Vy():wl()}function Gw(){if(Vs===0)if((kt&536870912)===0||xt){var r=Zi;Zi<<=1,(Zi&3932160)===0&&(Zi=262144),Vs=r}else Vs=536870912;return r=ks.current,r!==null&&(r.flags|=32),Vs}function fs(r,a,c){(r===hn&&($t===2||$t===9)||r.cancelPendingCommit!==null)&&(Tc(r,0),Da(r,kt,Vs,!1)),dr(r,c),((jt&2)===0||r!==hn)&&(r===hn&&((jt&2)===0&&(tu|=c),Ln===4&&Da(r,kt,Vs,!1)),Xr(r))}function Hw(r,a,c){if((jt&6)!==0)throw Error(i(327));var m=!c&&(a&127)===0&&(a&r.expiredLanes)===0||ei(r,a),w=m?Dk(r,a):Py(r,a,!0),S=m;do{if(w===0){_c&&!m&&Da(r,a,0,!1);break}else{if(c=r.current.alternate,S&&!Pk(c)){w=Py(r,a,!1),S=!1;continue}if(w===2){if(S=a,r.errorRecoveryDisabledLanes&S)var R=0;else R=r.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){a=R;e:{var V=r;w=lh;var J=V.current.memoizedState.isDehydrated;if(J&&(Tc(V,R).flags|=256),R=Py(V,R,!1),R!==2){if(by&&!J){V.errorRecoveryDisabledLanes|=S,tu|=S,w=4;break e}S=hs,hs=w,S!==null&&(hs===null?hs=S:hs.push.apply(hs,S))}w=R}if(S=!1,w!==2)continue}}if(w===1){Tc(r,0),Da(r,a,0,!0);break}e:{switch(m=r,S=w,S){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:Da(m,a,Vs,!Ra);break e;case 2:hs=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(w=Im+300-lt(),10<w)){if(Da(m,a,Vs,!Ra),qi(m,0,!0)!==0)break e;Do=a,m.timeoutHandle=ES(jw.bind(null,m,c,hs,Nm,Iy,a,Vs,tu,yc,Ra,S,"Throttled",-0,0),w);break e}jw(m,c,hs,Nm,Iy,a,Vs,tu,yc,Ra,S,null,-0,0)}}break}while(!0);Xr(r)}function jw(r,a,c,m,w,S,R,V,J,ae,ye,xe,ce,ge){if(r.timeoutHandle=-1,xe=a.subtreeFlags,xe&8192||(xe&16785408)===16785408){xe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:bi},Ow(a,S,xe);var Ge=(S&62914560)===S?Im-lt():(S&4194048)===S?zw-lt():0;if(Ge=gD(xe,Ge),Ge!==null){Do=S,r.cancelPendingCommit=Ge(Xw.bind(null,r,a,S,c,m,w,R,V,J,ye,xe,null,ce,ge)),Da(r,S,R,!ae);return}}Xw(r,a,S,c,m,w,R,V,J)}function Pk(r){for(var a=r;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var m=0;m<c.length;m++){var w=c[m],S=w.getSnapshot;w=w.value;try{if(!di(S(),w))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Da(r,a,c,m){a&=~Cy,a&=~tu,r.suspendedLanes|=a,r.pingedLanes&=~a,m&&(r.warmLanes|=a),m=r.expirationTimes;for(var w=a;0<w;){var S=31-dt(w),R=1<<S;m[S]=-1,w&=~R}c!==0&&ho(r,c,a)}function Rm(){return(jt&6)===0?(ch(0),!1):!0}function My(){if(wt!==null){if($t===0)var r=wt.return;else r=wt,wr=Qr=null,W_(r),cc=null,Kd=0,r=wt;for(;r!==null;)xw(r.alternate,r),r=r.return;wt=null}}function Tc(r,a){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,$k(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),Do=0,My(),hn=r,wt=c=ir(r.current,null),kt=a,$t=0,Ls=null,Ra=!1,_c=ei(r,a),by=!1,yc=Vs=Cy=tu=Ma=Ln=0,hs=lh=null,Iy=!1,(a&8)!==0&&(a|=a&32);var m=r.entangledLanes;if(m!==0)for(r=r.entanglements,m&=a;0<m;){var w=31-dt(m),S=1<<w;a|=r[w],m&=~S}return ko=a,ql(),c}function Kw(r,a){mt=null,se.H=eh,a===uc||a===rm?(a=lx(),$t=3):a===L_?(a=lx(),$t=4):$t=a===uy?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ls=a,wt===null&&(Ln=1,vm(r,f(a,r.current)))}function Ww(){var r=ks.current;return r===null?!0:(kt&4194048)===kt?sr===null:(kt&62914560)===kt||(kt&536870912)!==0?r===sr:!1}function Yw(){var r=se.H;return se.H=eh,r===null?eh:r}function Jw(){var r=se.A;return se.A=Rk,r}function Mm(){Ln=4,Ra||(kt&4194048)!==kt&&ks.current!==null||(_c=!0),(Ma&134217727)===0&&(tu&134217727)===0||hn===null||Da(hn,kt,Vs,!1)}function Py(r,a,c){var m=jt;jt|=2;var w=Yw(),S=Jw();(hn!==r||kt!==a)&&(Nm=null,Tc(r,a)),a=!1;var R=Ln;e:do try{if($t!==0&&wt!==null){var V=wt,J=Ls;switch($t){case 8:My(),R=6;break e;case 3:case 2:case 9:case 6:ks.current===null&&(a=!0);var ae=$t;if($t=0,Ls=null,Ec(r,V,J,ae),c&&_c){R=0;break e}break;default:ae=$t,$t=0,Ls=null,Ec(r,V,J,ae)}}kk(),R=Ln;break}catch(ye){Kw(r,ye)}while(!0);return a&&r.shellSuspendCounter++,wr=Qr=null,jt=m,se.H=w,se.A=S,wt===null&&(hn=null,kt=0,ql()),R}function kk(){for(;wt!==null;)Zw(wt)}function Dk(r,a){var c=jt;jt|=2;var m=Yw(),w=Jw();hn!==r||kt!==a?(Nm=null,Am=lt()+500,Tc(r,a)):_c=ei(r,a);e:do try{if($t!==0&&wt!==null){a=wt;var S=Ls;t:switch($t){case 1:$t=0,Ls=null,Ec(r,a,S,1);break;case 2:case 9:if(ox(S)){$t=0,Ls=null,Qw(a);break}a=function(){$t!==2&&$t!==9||hn!==r||($t=7),Xr(r)},S.then(a,a);break e;case 3:$t=7;break e;case 4:$t=5;break e;case 7:ox(S)?($t=0,Ls=null,Qw(a)):($t=0,Ls=null,Ec(r,a,S,7));break;case 5:var R=null;switch(wt.tag){case 26:R=wt.memoizedState;case 5:case 27:var V=wt;if(R?VS(R):V.stateNode.complete){$t=0,Ls=null;var J=V.sibling;if(J!==null)wt=J;else{var ae=V.return;ae!==null?(wt=ae,Pm(ae)):wt=null}break t}}$t=0,Ls=null,Ec(r,a,S,5);break;case 6:$t=0,Ls=null,Ec(r,a,S,6);break;case 8:My(),Ln=6;break e;default:throw Error(i(462))}}Lk();break}catch(ye){Kw(r,ye)}while(!0);return wr=Qr=null,se.H=m,se.A=w,jt=c,wt!==null?0:(hn=null,kt=0,ql(),Ln)}function Lk(){for(;wt!==null&&!je();)Zw(wt)}function Zw(r){var a=Tw(r.alternate,r,ko);r.memoizedProps=r.pendingProps,a===null?Pm(r):wt=a}function Qw(r){var a=r,c=a.alternate;switch(a.tag){case 15:case 0:a=mw(c,a,a.pendingProps,a.type,void 0,kt);break;case 11:a=mw(c,a,a.pendingProps,a.type.render,a.ref,kt);break;case 5:W_(a);default:xw(c,a),a=wt=Fd(a,ko),a=Tw(c,a,ko)}r.memoizedProps=r.pendingProps,a===null?Pm(r):wt=a}function Ec(r,a,c,m){wr=Qr=null,W_(a),cc=null,Kd=0;var w=a.return;try{if(wk(r,w,a,c,kt)){Ln=1,vm(r,f(c,r.current)),wt=null;return}}catch(S){if(w!==null)throw wt=w,S;Ln=1,vm(r,f(c,r.current)),wt=null;return}a.flags&32768?(xt||m===1?r=!0:_c||(kt&536870912)!==0?r=!1:(Ra=r=!0,(m===2||m===9||m===3||m===6)&&(m=ks.current,m!==null&&m.tag===13&&(m.flags|=16384))),$w(a,r)):Pm(a)}function Pm(r){var a=r;do{if((a.flags&32768)!==0){$w(a,Ra);return}r=a.return;var c=Ck(a.alternate,a,ko);if(c!==null){wt=c;return}if(a=a.sibling,a!==null){wt=a;return}wt=a=r}while(a!==null);Ln===0&&(Ln=5)}function $w(r,a){do{var c=Ik(r.alternate,r);if(c!==null){c.flags&=32767,wt=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(r=r.sibling,r!==null)){wt=r;return}wt=r=c}while(r!==null);Ln=6,wt=null}function Xw(r,a,c,m,w,S,R,V,J){r.cancelPendingCommit=null;do km();while(ni!==0);if((jt&6)!==0)throw Error(i(327));if(a!==null){if(a===r.current)throw Error(i(177));if(S=a.lanes|a.childLanes,S|=nc,Od(r,c,S,R,V,J),r===hn&&(wt=hn=null,kt=0),vc=a,ka=r,Do=c,Ay=S,Ny=w,qw=m,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Fk(pn,function(){return sS(),null})):(r.callbackNode=null,r.callbackPriority=0),m=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||m){m=se.T,se.T=null,w=Se.p,Se.p=2,R=jt,jt|=4;try{Ak(r,a,c)}finally{jt=R,Se.p=w,se.T=m}}ni=1,eS(),tS(),nS()}}function eS(){if(ni===1){ni=0;var r=ka,a=vc,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=se.T,se.T=null;var m=Se.p;Se.p=2;var w=jt;jt|=4;try{Dw(a,r);var S=Hy,R=Ol(r.containerInfo),V=S.focusedElem,J=S.selectionRange;if(R!==V&&V&&V.ownerDocument&&$u(V.ownerDocument.documentElement,V)){if(J!==null&&Hr(V)){var ae=J.start,ye=J.end;if(ye===void 0&&(ye=ae),"selectionStart"in V)V.selectionStart=ae,V.selectionEnd=Math.min(ye,V.value.length);else{var xe=V.ownerDocument||document,ce=xe&&xe.defaultView||window;if(ce.getSelection){var ge=ce.getSelection(),Ge=V.textContent.length,tt=Math.min(J.start,Ge),un=J.end===void 0?tt:Math.min(J.end,Ge);!ge.extend&&tt>un&&(R=un,un=tt,tt=R);var ee=Vl(V,tt),$=Vl(V,un);if(ee&&$&&(ge.rangeCount!==1||ge.anchorNode!==ee.node||ge.anchorOffset!==ee.offset||ge.focusNode!==$.node||ge.focusOffset!==$.offset)){var oe=xe.createRange();oe.setStart(ee.node,ee.offset),ge.removeAllRanges(),tt>un?(ge.addRange(oe),ge.extend($.node,$.offset)):(oe.setEnd($.node,$.offset),ge.addRange(oe))}}}}for(xe=[],ge=V;ge=ge.parentNode;)ge.nodeType===1&&xe.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<xe.length;V++){var Te=xe[V];Te.element.scrollLeft=Te.left,Te.element.scrollTop=Te.top}}jm=!!Gy,Hy=Gy=null}finally{jt=w,Se.p=m,se.T=c}}r.current=a,ni=2}}function tS(){if(ni===2){ni=0;var r=ka,a=vc,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=se.T,se.T=null;var m=Se.p;Se.p=2;var w=jt;jt|=4;try{Nw(r,a.alternate,a)}finally{jt=w,Se.p=m,se.T=c}}ni=3}}function nS(){if(ni===4||ni===3){ni=0,nt();var r=ka,a=vc,c=Do,m=qw;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?ni=5:(ni=0,vc=ka=null,iS(r,r.pendingLanes));var w=r.pendingLanes;if(w===0&&(Pa=null),ze(c),a=a.stateNode,Ne&&typeof Ne.onCommitFiberRoot=="function")try{Ne.onCommitFiberRoot(Ti,a,void 0,(a.current.flags&128)===128)}catch{}if(m!==null){a=se.T,w=Se.p,Se.p=2,se.T=null;try{for(var S=r.onRecoverableError,R=0;R<m.length;R++){var V=m[R];S(V.value,{componentStack:V.stack})}}finally{se.T=a,Se.p=w}}(Do&3)!==0&&km(),Xr(r),w=r.pendingLanes,(c&261930)!==0&&(w&42)!==0?r===Ry?uh++:(uh=0,Ry=r):uh=0,ch(0)}}function iS(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,Hd(a)))}function km(){return eS(),tS(),nS(),sS()}function sS(){if(ni!==5)return!1;var r=ka,a=Ay;Ay=0;var c=ze(Do),m=se.T,w=Se.p;try{Se.p=32>c?32:c,se.T=null,c=Ny,Ny=null;var S=ka,R=Do;if(ni=0,vc=ka=null,Do=0,(jt&6)!==0)throw Error(i(331));var V=jt;if(jt|=4,Fw(S.current),Vw(S,S.current,R,c),jt=V,ch(0,!1),Ne&&typeof Ne.onPostCommitFiberRoot=="function")try{Ne.onPostCommitFiberRoot(Ti,S)}catch{}return!0}finally{Se.p=w,se.T=m,iS(r,a)}}function rS(r,a,c){a=f(c,a),a=ly(r.stateNode,a,2),r=Ca(r,a,2),r!==null&&(dr(r,2),Xr(r))}function Xt(r,a,c){if(r.tag===3)rS(r,r,c);else for(;a!==null;){if(a.tag===3){rS(a,r,c);break}else if(a.tag===1){var m=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Pa===null||!Pa.has(m))){r=f(c,r),c=ow(2),m=Ca(a,c,2),m!==null&&(aw(c,m,a,r),dr(m,2),Xr(m));break}}a=a.return}}function ky(r,a,c){var m=r.pingCache;if(m===null){m=r.pingCache=new Mk;var w=new Set;m.set(a,w)}else w=m.get(a),w===void 0&&(w=new Set,m.set(a,w));w.has(c)||(by=!0,w.add(c),r=Vk.bind(null,r,a,c),a.then(r,r))}function Vk(r,a,c){var m=r.pingCache;m!==null&&m.delete(a),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,hn===r&&(kt&c)===c&&(Ln===4||Ln===3&&(kt&62914560)===kt&&300>lt()-Im?(jt&2)===0&&Tc(r,0):Cy|=c,yc===kt&&(yc=0)),Xr(r)}function oS(r,a){a===0&&(a=Gu()),r=nr(r,a),r!==null&&(dr(r,a),Xr(r))}function Ok(r){var a=r.memoizedState,c=0;a!==null&&(c=a.retryLane),oS(r,c)}function Uk(r,a){var c=0;switch(r.tag){case 31:case 13:var m=r.stateNode,w=r.memoizedState;w!==null&&(c=w.retryLane);break;case 19:m=r.stateNode;break;case 22:m=r.stateNode._retryCache;break;default:throw Error(i(314))}m!==null&&m.delete(a),oS(r,c)}function Fk(r,a){return pe(r,a)}var Dm=null,xc=null,Dy=!1,Lm=!1,Ly=!1,La=0;function Xr(r){r!==xc&&r.next===null&&(xc===null?Dm=xc=r:xc=xc.next=r),Lm=!0,Dy||(Dy=!0,zk())}function ch(r,a){if(!Ly&&Lm){Ly=!0;do for(var c=!1,m=Dm;m!==null;){if(r!==0){var w=m.pendingLanes;if(w===0)var S=0;else{var R=m.suspendedLanes,V=m.pingedLanes;S=(1<<31-dt(42|r)+1)-1,S&=w&~(R&~V),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(c=!0,cS(m,S))}else S=kt,S=qi(m,m===hn?S:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(S&3)===0||ei(m,S)||(c=!0,cS(m,S));m=m.next}while(c);Ly=!1}}function Bk(){aS()}function aS(){Lm=Dy=!1;var r=0;La!==0&&Qk()&&(r=La);for(var a=lt(),c=null,m=Dm;m!==null;){var w=m.next,S=lS(m,a);S===0?(m.next=null,c===null?Dm=w:c.next=w,w===null&&(xc=c)):(c=m,(r!==0||(S&3)!==0)&&(Lm=!0)),m=w}ni!==0&&ni!==5||ch(r),La!==0&&(La=0)}function lS(r,a){for(var c=r.suspendedLanes,m=r.pingedLanes,w=r.expirationTimes,S=r.pendingLanes&-62914561;0<S;){var R=31-dt(S),V=1<<R,J=w[R];J===-1?((V&c)===0||(V&m)!==0)&&(w[R]=Vd(V,a)):J<=a&&(r.expiredLanes|=V),S&=~V}if(a=hn,c=kt,c=qi(r,r===a?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),m=r.callbackNode,c===0||r===a&&($t===2||$t===9)||r.cancelPendingCommit!==null)return m!==null&&m!==null&&De(m),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||ei(r,c)){if(a=c&-c,a===r.callbackPriority)return a;switch(m!==null&&De(m),ze(c)){case 2:case 8:c=vi;break;case 32:c=pn;break;case 268435456:c=Lr;break;default:c=pn}return m=uS.bind(null,r),c=pe(c,m),r.callbackPriority=a,r.callbackNode=c,a}return m!==null&&m!==null&&De(m),r.callbackPriority=2,r.callbackNode=null,2}function uS(r,a){if(ni!==0&&ni!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(km()&&r.callbackNode!==c)return null;var m=kt;return m=qi(r,r===hn?m:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),m===0?null:(Hw(r,m,a),lS(r,lt()),r.callbackNode!=null&&r.callbackNode===c?uS.bind(null,r):null)}function cS(r,a){if(km())return null;Hw(r,a,!0)}function zk(){Xk(function(){(jt&6)!==0?pe(jn,Bk):aS()})}function Vy(){if(La===0){var r=ac;r===0&&(r=Fn,Fn<<=1,(Fn&261888)===0&&(Fn=256)),La=r}return La}function dS(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Fr(""+r)}function hS(r,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,r.id&&c.setAttribute("form",r.id),a.parentNode.insertBefore(c,a),r=new FormData(r),c.parentNode.removeChild(c),r}function qk(r,a,c,m,w){if(a==="submit"&&c&&c.stateNode===w){var S=dS((w[Mn]||null).action),R=m.submitter;R&&(a=(a=R[Mn]||null)?dS(a.formAction):R.getAttribute("formAction"),a!==null&&(S=a,R=null));var V=new $s("action","action",null,m,w);r.push({event:V,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(La!==0){var J=R?hS(w,R):new FormData(w);ny(c,{pending:!0,data:J,method:w.method,action:S},null,J)}}else typeof S=="function"&&(V.preventDefault(),J=R?hS(w,R):new FormData(w),ny(c,{pending:!0,data:J,method:w.method,action:S},S,J))},currentTarget:w}]})}}for(var Oy=0;Oy<Wr.length;Oy++){var Uy=Wr[Oy],Gk=Uy.toLowerCase(),Hk=Uy[0].toUpperCase()+Uy.slice(1);os(Gk,"on"+Hk)}os(Fl,"onAnimationEnd"),os(Xf,"onAnimationIteration"),os(Bl,"onAnimationStart"),os("dblclick","onDoubleClick"),os("focusin","onFocus"),os("focusout","onBlur"),os(I_,"onTransitionRun"),os(em,"onTransitionStart"),os(A_,"onTransitionCancel"),os(Ea,"onTransitionEnd"),es("onMouseEnter",["mouseout","mouseover"]),es("onMouseLeave",["mouseout","mouseover"]),es("onPointerEnter",["pointerout","pointerover"]),es("onPointerLeave",["pointerout","pointerover"]),Ws("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ws("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ws("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ws("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ws("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ws("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(dh));function fS(r,a){a=(a&4)!==0;for(var c=0;c<r.length;c++){var m=r[c],w=m.event;m=m.listeners;e:{var S=void 0;if(a)for(var R=m.length-1;0<=R;R--){var V=m[R],J=V.instance,ae=V.currentTarget;if(V=V.listener,J!==S&&w.isPropagationStopped())break e;S=V,w.currentTarget=ae;try{S(w)}catch(ye){zl(ye)}w.currentTarget=null,S=J}else for(R=0;R<m.length;R++){if(V=m[R],J=V.instance,ae=V.currentTarget,V=V.listener,J!==S&&w.isPropagationStopped())break e;S=V,w.currentTarget=ae;try{S(w)}catch(ye){zl(ye)}w.currentTarget=null,S=J}}}}function St(r,a){var c=a[ws];c===void 0&&(c=a[ws]=new Set);var m=r+"__bubble";c.has(m)||(mS(a,r,2,!1),c.add(m))}function Fy(r,a,c){var m=0;a&&(m|=4),mS(c,r,m,a)}var Vm="_reactListening"+Math.random().toString(36).slice(2);function By(r){if(!r[Vm]){r[Vm]=!0,Sl.forEach(function(c){c!=="selectionchange"&&(jk.has(c)||Fy(c,!1,r),Fy(c,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[Vm]||(a[Vm]=!0,Fy("selectionchange",!1,a))}}function mS(r,a,c,m){switch(GS(a)){case 2:var w=vD;break;case 8:w=TD;break;default:w=tv}c=w.bind(null,a,c,r),w=void 0,!pr||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(w=!0),m?w!==void 0?r.addEventListener(a,c,{capture:!0,passive:w}):r.addEventListener(a,c,!0):w!==void 0?r.addEventListener(a,c,{passive:w}):r.addEventListener(a,c,!1)}function zy(r,a,c,m,w){var S=m;if((a&1)===0&&(a&2)===0&&m!==null)e:for(;;){if(m===null)return;var R=m.tag;if(R===3||R===4){var V=m.stateNode.containerInfo;if(V===w)break;if(R===4)for(R=m.return;R!==null;){var J=R.tag;if((J===3||J===4)&&R.stateNode.containerInfo===w)return;R=R.return}for(;V!==null;){if(R=Ss(V),R===null)return;if(J=R.tag,J===5||J===6||J===26||J===27){m=S=R;continue e}V=V.parentNode}}m=m.return}mr(function(){var ae=S,ye=Ci(c),xe=[];e:{var ce=tm.get(r);if(ce!==void 0){var ge=$s,Ge=r;switch(r){case"keypress":if(zr(c)===0)break e;case"keydown":case"keyup":ge=Ml;break;case"focusin":Ge="focus",ge=yo;break;case"focusout":Ge="blur",ge=yo;break;case"beforeblur":case"afterblur":ge=yo;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=Cl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=Wu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=I;break;case Fl:case Xf:case Bl:ge=da;break;case Ea:ge=U;break;case"scroll":case"scrollend":ge=_t;break;case"wheel":ge=de;break;case"copy":case"cut":case"paste":ge=ji;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=vr;break;case"toggle":case"beforetoggle":ge=st}var tt=(a&4)!==0,un=!tt&&(r==="scroll"||r==="scrollend"),ee=tt?ce!==null?ce+"Capture":null:ce;tt=[];for(var $=ae,oe;$!==null;){var Te=$;if(oe=Te.stateNode,Te=Te.tag,Te!==5&&Te!==26&&Te!==27||oe===null||ee===null||(Te=Hi($,ee),Te!=null&&tt.push(hh($,Te,oe))),un)break;$=$.return}0<tt.length&&(ce=new ge(ce,Ge,null,c,ye),xe.push({event:ce,listeners:tt}))}}if((a&7)===0){e:{if(ce=r==="mouseover"||r==="pointerover",ge=r==="mouseout"||r==="pointerout",ce&&c!==ca&&(Ge=c.relatedTarget||c.fromElement)&&(Ss(Ge)||Ge[xs]))break e;if((ge||ce)&&(ce=ye.window===ye?ye:(ce=ye.ownerDocument)?ce.defaultView||ce.parentWindow:window,ge?(Ge=c.relatedTarget||c.toElement,ge=ae,Ge=Ge?Ss(Ge):null,Ge!==null&&(un=o(Ge),tt=Ge.tag,Ge!==un||tt!==5&&tt!==27&&tt!==6)&&(Ge=null)):(ge=null,Ge=ae),ge!==Ge)){if(tt=Cl,Te="onMouseLeave",ee="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(tt=vr,Te="onPointerLeave",ee="onPointerEnter",$="pointer"),un=ge==null?ce:ai(ge),oe=Ge==null?ce:ai(Ge),ce=new tt(Te,$+"leave",ge,c,ye),ce.target=un,ce.relatedTarget=oe,Te=null,Ss(ye)===ae&&(tt=new tt(ee,$+"enter",Ge,c,ye),tt.target=oe,tt.relatedTarget=un,Te=tt),un=Te,ge&&Ge)t:{for(tt=Kk,ee=ge,$=Ge,oe=0,Te=ee;Te;Te=tt(Te))oe++;Te=0;for(var $e=$;$e;$e=tt($e))Te++;for(;0<oe-Te;)ee=tt(ee),oe--;for(;0<Te-oe;)$=tt($),Te--;for(;oe--;){if(ee===$||$!==null&&ee===$.alternate){tt=ee;break t}ee=tt(ee),$=tt($)}tt=null}else tt=null;ge!==null&&pS(xe,ce,ge,tt,!1),Ge!==null&&un!==null&&pS(xe,un,Ge,tt,!0)}}e:{if(ce=ae?ai(ae):window,ge=ce.nodeName&&ce.nodeName.toLowerCase(),ge==="select"||ge==="input"&&ce.type==="file")var qt=Ll;else if(Xs(ce))if(Yf)qt=C_;else{qt=b_;var We=Tr}else ge=ce.nodeName,!ge||ge.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?ae&&Ur(ae.elementType)&&(qt=Ll):qt=_a;if(qt&&(qt=qt(r,ae))){Wf(xe,qt,c,ye);break e}We&&We(r,ce,ae),r==="focusout"&&ae&&ce.type==="number"&&ae.memoizedProps.value!=null&&bs(ce,"number",ce.value)}switch(We=ae?ai(ae):window,r){case"focusin":(Xs(We)||We.contentEditable==="true")&&(jr=We,ec=ae,Ul=null);break;case"focusout":Ul=ec=jr=null;break;case"mousedown":va=!0;break;case"contextmenu":case"mouseup":case"dragend":va=!1,Qf(xe,c,ye);break;case"selectionchange":if(Xu)break;case"keydown":case"keyup":Qf(xe,c,ye)}var gt;if(Ot)e:{switch(r){case"compositionstart":var Dt="onCompositionStart";break e;case"compositionend":Dt="onCompositionEnd";break e;case"compositionupdate":Dt="onCompositionUpdate";break e}Dt=void 0}else ma?vo(r,c)&&(Dt="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(Dt="onCompositionStart");Dt&&(rs&&c.locale!=="ko"&&(ma||Dt!=="onCompositionStart"?Dt==="onCompositionEnd"&&ma&&(gt=Cs()):(is=ye,gr="value"in is?is.value:is.textContent,ma=!0)),We=Om(ae,Dt),0<We.length&&(Dt=new Ns(Dt,r,null,c,ye),xe.push({event:Dt,listeners:We}),gt?Dt.data=gt:(gt=To(c),gt!==null&&(Dt.data=gt)))),(gt=ss?Ps(r,c):pa(r,c))&&(Dt=Om(ae,"onBeforeInput"),0<Dt.length&&(We=new Ns("onBeforeInput","beforeinput",null,c,ye),xe.push({event:We,listeners:Dt}),We.data=gt)),qk(xe,r,ae,c,ye)}fS(xe,a)})}function hh(r,a,c){return{instance:r,listener:a,currentTarget:c}}function Om(r,a){for(var c=a+"Capture",m=[];r!==null;){var w=r,S=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||S===null||(w=Hi(r,c),w!=null&&m.unshift(hh(r,w,S)),w=Hi(r,a),w!=null&&m.push(hh(r,w,S))),r.tag===3)return m;r=r.return}return[]}function Kk(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function pS(r,a,c,m,w){for(var S=a._reactName,R=[];c!==null&&c!==m;){var V=c,J=V.alternate,ae=V.stateNode;if(V=V.tag,J!==null&&J===m)break;V!==5&&V!==26&&V!==27||ae===null||(J=ae,w?(ae=Hi(c,S),ae!=null&&R.unshift(hh(c,ae,J))):w||(ae=Hi(c,S),ae!=null&&R.push(hh(c,ae,J)))),c=c.return}R.length!==0&&r.push({event:a,listeners:R})}var Wk=/\r\n?/g,Yk=/\u0000|\uFFFD/g;function gS(r){return(typeof r=="string"?r:""+r).replace(Wk,`
`).replace(Yk,"")}function _S(r,a){return a=gS(a),gS(r)===a}function ln(r,a,c,m,w,S){switch(c){case"children":typeof m=="string"?a==="body"||a==="textarea"&&m===""||Kn(r,m):(typeof m=="number"||typeof m=="bigint")&&a!=="body"&&Kn(r,""+m);break;case"className":Et(r,"class",m);break;case"tabIndex":Et(r,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Et(r,c,m);break;case"style":po(r,m,S);break;case"data":if(a!=="object"){Et(r,"data",m);break}case"src":case"href":if(m===""&&(a!=="a"||c!=="href")){r.removeAttribute(c);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){r.removeAttribute(c);break}m=Fr(""+m),r.setAttribute(c,m);break;case"action":case"formAction":if(typeof m=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(c==="formAction"?(a!=="input"&&ln(r,a,"name",w.name,w,null),ln(r,a,"formEncType",w.formEncType,w,null),ln(r,a,"formMethod",w.formMethod,w,null),ln(r,a,"formTarget",w.formTarget,w,null)):(ln(r,a,"encType",w.encType,w,null),ln(r,a,"method",w.method,w,null),ln(r,a,"target",w.target,w,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){r.removeAttribute(c);break}m=Fr(""+m),r.setAttribute(c,m);break;case"onClick":m!=null&&(r.onclick=bi);break;case"onScroll":m!=null&&St("scroll",r);break;case"onScrollEnd":m!=null&&St("scrollend",r);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(c=m.__html,c!=null){if(w.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"multiple":r.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":r.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){r.removeAttribute("xlink:href");break}c=Fr(""+m),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?r.setAttribute(c,""+m):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":m===!0?r.setAttribute(c,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?r.setAttribute(c,m):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?r.setAttribute(c,m):r.removeAttribute(c);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?r.removeAttribute(c):r.setAttribute(c,m);break;case"popover":St("beforetoggle",r),St("toggle",r),yt(r,"popover",m);break;case"xlinkActuate":yn(r,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":yn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":yn(r,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":yn(r,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":yn(r,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":yn(r,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":yn(r,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":yn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":yn(r,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":yt(r,"is",m);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=go.get(c)||c,yt(r,c,m))}}function qy(r,a,c,m,w,S){switch(c){case"style":po(r,m,S);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(i(61));if(c=m.__html,c!=null){if(w.children!=null)throw Error(i(60));r.innerHTML=c}}break;case"children":typeof m=="string"?Kn(r,m):(typeof m=="number"||typeof m=="bigint")&&Kn(r,""+m);break;case"onScroll":m!=null&&St("scroll",r);break;case"onScrollEnd":m!=null&&St("scrollend",r);break;case"onClick":m!=null&&(r.onclick=bi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!bl.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(w=c.endsWith("Capture"),a=c.slice(2,w?c.length-7:void 0),S=r[Mn]||null,S=S!=null?S[c]:null,typeof S=="function"&&r.removeEventListener(a,S,w),typeof m=="function")){typeof S!="function"&&S!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(a,m,w);break e}c in r?r[c]=m:m===!0?r.setAttribute(c,""):yt(r,c,m)}}}function wi(r,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":St("error",r),St("load",r);var m=!1,w=!1,S;for(S in c)if(c.hasOwnProperty(S)){var R=c[S];if(R!=null)switch(S){case"src":m=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:ln(r,a,S,R,c,null)}}w&&ln(r,a,"srcSet",c.srcSet,c,null),m&&ln(r,a,"src",c.src,c,null);return;case"input":St("invalid",r);var V=S=R=w=null,J=null,ae=null;for(m in c)if(c.hasOwnProperty(m)){var ye=c[m];if(ye!=null)switch(m){case"name":w=ye;break;case"type":R=ye;break;case"checked":J=ye;break;case"defaultChecked":ae=ye;break;case"value":S=ye;break;case"defaultValue":V=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(i(137,a));break;default:ln(r,a,m,ye,c,null)}}mo(r,S,V,J,ae,R,w,!1);return;case"select":St("invalid",r),m=R=S=null;for(w in c)if(c.hasOwnProperty(w)&&(V=c[w],V!=null))switch(w){case"value":S=V;break;case"defaultValue":R=V;break;case"multiple":m=V;default:ln(r,a,w,V,c,null)}a=S,c=R,r.multiple=!!m,a!=null?Qt(r,!!m,a,!1):c!=null&&Qt(r,!!m,c,!0);return;case"textarea":St("invalid",r),S=w=m=null;for(R in c)if(c.hasOwnProperty(R)&&(V=c[R],V!=null))switch(R){case"value":m=V;break;case"defaultValue":w=V;break;case"children":S=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(i(91));break;default:ln(r,a,R,V,c,null)}ns(r,m,w,S);return;case"option":for(J in c)if(c.hasOwnProperty(J)&&(m=c[J],m!=null))switch(J){case"selected":r.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:ln(r,a,J,m,c,null)}return;case"dialog":St("beforetoggle",r),St("toggle",r),St("cancel",r),St("close",r);break;case"iframe":case"object":St("load",r);break;case"video":case"audio":for(m=0;m<dh.length;m++)St(dh[m],r);break;case"image":St("error",r),St("load",r);break;case"details":St("toggle",r);break;case"embed":case"source":case"link":St("error",r),St("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in c)if(c.hasOwnProperty(ae)&&(m=c[ae],m!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:ln(r,a,ae,m,c,null)}return;default:if(Ur(a)){for(ye in c)c.hasOwnProperty(ye)&&(m=c[ye],m!==void 0&&qy(r,a,ye,m,c,void 0));return}}for(V in c)c.hasOwnProperty(V)&&(m=c[V],m!=null&&ln(r,a,V,m,c,null))}function Jk(r,a,c,m){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,S=null,R=null,V=null,J=null,ae=null,ye=null;for(ge in c){var xe=c[ge];if(c.hasOwnProperty(ge)&&xe!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":J=xe;default:m.hasOwnProperty(ge)||ln(r,a,ge,null,m,xe)}}for(var ce in m){var ge=m[ce];if(xe=c[ce],m.hasOwnProperty(ce)&&(ge!=null||xe!=null))switch(ce){case"type":S=ge;break;case"name":w=ge;break;case"checked":ae=ge;break;case"defaultChecked":ye=ge;break;case"value":R=ge;break;case"defaultValue":V=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(i(137,a));break;default:ge!==xe&&ln(r,a,ce,ge,m,xe)}}la(r,R,V,J,ae,ye,S,w);return;case"select":ge=R=V=ce=null;for(S in c)if(J=c[S],c.hasOwnProperty(S)&&J!=null)switch(S){case"value":break;case"multiple":ge=J;default:m.hasOwnProperty(S)||ln(r,a,S,null,m,J)}for(w in m)if(S=m[w],J=c[w],m.hasOwnProperty(w)&&(S!=null||J!=null))switch(w){case"value":ce=S;break;case"defaultValue":V=S;break;case"multiple":R=S;default:S!==J&&ln(r,a,w,S,m,J)}a=V,c=R,m=ge,ce!=null?Qt(r,!!c,ce,!1):!!m!=!!c&&(a!=null?Qt(r,!!c,a,!0):Qt(r,!!c,c?[]:"",!1));return;case"textarea":ge=ce=null;for(V in c)if(w=c[V],c.hasOwnProperty(V)&&w!=null&&!m.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:ln(r,a,V,null,m,w)}for(R in m)if(w=m[R],S=c[R],m.hasOwnProperty(R)&&(w!=null||S!=null))switch(R){case"value":ce=w;break;case"defaultValue":ge=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(i(91));break;default:w!==S&&ln(r,a,R,w,m,S)}Js(r,ce,ge);return;case"option":for(var Ge in c)if(ce=c[Ge],c.hasOwnProperty(Ge)&&ce!=null&&!m.hasOwnProperty(Ge))switch(Ge){case"selected":r.selected=!1;break;default:ln(r,a,Ge,null,m,ce)}for(J in m)if(ce=m[J],ge=c[J],m.hasOwnProperty(J)&&ce!==ge&&(ce!=null||ge!=null))switch(J){case"selected":r.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:ln(r,a,J,ce,m,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var tt in c)ce=c[tt],c.hasOwnProperty(tt)&&ce!=null&&!m.hasOwnProperty(tt)&&ln(r,a,tt,null,m,ce);for(ae in m)if(ce=m[ae],ge=c[ae],m.hasOwnProperty(ae)&&ce!==ge&&(ce!=null||ge!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,a));break;default:ln(r,a,ae,ce,m,ge)}return;default:if(Ur(a)){for(var un in c)ce=c[un],c.hasOwnProperty(un)&&ce!==void 0&&!m.hasOwnProperty(un)&&qy(r,a,un,void 0,m,ce);for(ye in m)ce=m[ye],ge=c[ye],!m.hasOwnProperty(ye)||ce===ge||ce===void 0&&ge===void 0||qy(r,a,ye,ce,m,ge);return}}for(var ee in c)ce=c[ee],c.hasOwnProperty(ee)&&ce!=null&&!m.hasOwnProperty(ee)&&ln(r,a,ee,null,m,ce);for(xe in m)ce=m[xe],ge=c[xe],!m.hasOwnProperty(xe)||ce===ge||ce==null&&ge==null||ln(r,a,xe,ce,m,ge)}function yS(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Zk(){if(typeof performance.getEntriesByType=="function"){for(var r=0,a=0,c=performance.getEntriesByType("resource"),m=0;m<c.length;m++){var w=c[m],S=w.transferSize,R=w.initiatorType,V=w.duration;if(S&&V&&yS(R)){for(R=0,V=w.responseEnd,m+=1;m<c.length;m++){var J=c[m],ae=J.startTime;if(ae>V)break;var ye=J.transferSize,xe=J.initiatorType;ye&&yS(xe)&&(J=J.responseEnd,R+=ye*(J<V?1:(V-ae)/(J-ae)))}if(--m,a+=8*(S+R)/(w.duration/1e3),r++,10<r)break}}if(0<r)return a/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Gy=null,Hy=null;function Um(r){return r.nodeType===9?r:r.ownerDocument}function vS(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function TS(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function jy(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Ky=null;function Qk(){var r=window.event;return r&&r.type==="popstate"?r===Ky?!1:(Ky=r,!0):(Ky=null,!1)}var ES=typeof setTimeout=="function"?setTimeout:void 0,$k=typeof clearTimeout=="function"?clearTimeout:void 0,xS=typeof Promise=="function"?Promise:void 0,Xk=typeof queueMicrotask=="function"?queueMicrotask:typeof xS<"u"?function(r){return xS.resolve(null).then(r).catch(eD)}:ES;function eD(r){setTimeout(function(){throw r})}function Va(r){return r==="head"}function wS(r,a){var c=a,m=0;do{var w=c.nextSibling;if(r.removeChild(c),w&&w.nodeType===8)if(c=w.data,c==="/$"||c==="/&"){if(m===0){r.removeChild(w),Cc(a);return}m--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")m++;else if(c==="html")fh(r.ownerDocument.documentElement);else if(c==="head"){c=r.ownerDocument.head,fh(c);for(var S=c.firstChild;S;){var R=S.nextSibling,V=S.nodeName;S[js]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&S.rel.toLowerCase()==="stylesheet"||c.removeChild(S),S=R}}else c==="body"&&fh(r.ownerDocument.body);c=w}while(c);Cc(a)}function SS(r,a){var c=r;r=0;do{var m=c.nextSibling;if(c.nodeType===1?a?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(a?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(r===0)break;r--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||r++;c=m}while(c)}function Wy(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Wy(c),ra(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function tD(r,a,c,m){for(;r.nodeType===1;){var w=c;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!m&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(m){if(!r[js])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(S=r.getAttribute("rel"),S==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(S!==w.rel||r.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||r.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||r.getAttribute("title")!==(w.title==null?null:w.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(S=r.getAttribute("src"),(S!==(w.src==null?null:w.src)||r.getAttribute("type")!==(w.type==null?null:w.type)||r.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&S&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var S=w.name==null?null:""+w.name;if(w.type==="hidden"&&r.getAttribute("name")===S)return r}else return r;if(r=rr(r.nextSibling),r===null)break}return null}function nD(r,a,c){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=rr(r.nextSibling),r===null))return null;return r}function bS(r,a){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!a||(r=rr(r.nextSibling),r===null))return null;return r}function Yy(r){return r.data==="$?"||r.data==="$~"}function Jy(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function iD(r,a){var c=r.ownerDocument;if(r.data==="$~")r._reactRetry=a;else if(r.data!=="$?"||c.readyState!=="loading")a();else{var m=function(){a(),c.removeEventListener("DOMContentLoaded",m)};c.addEventListener("DOMContentLoaded",m),r._reactRetry=m}}function rr(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return r}var Zy=null;function CS(r){r=r.nextSibling;for(var a=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"||c==="/&"){if(a===0)return rr(r.nextSibling);a--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||a++}r=r.nextSibling}return null}function IS(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(a===0)return r;a--}else c!=="/$"&&c!=="/&"||a++}r=r.previousSibling}return null}function AS(r,a,c){switch(a=Um(c),r){case"html":if(r=a.documentElement,!r)throw Error(i(452));return r;case"head":if(r=a.head,!r)throw Error(i(453));return r;case"body":if(r=a.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function fh(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);ra(r)}var or=new Map,NS=new Set;function Fm(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Lo=Se.d;Se.d={f:sD,r:rD,D:oD,C:aD,L:lD,m:uD,X:dD,S:cD,M:hD};function sD(){var r=Lo.f(),a=Rm();return r||a}function rD(r){var a=Xi(r);a!==null&&a.tag===5&&a.type==="form"?Kx(a):Lo.r(r)}var wc=typeof document>"u"?null:document;function RS(r,a,c){var m=wc;if(m&&typeof a=="string"&&a){var w=cn(a);w='link[rel="'+r+'"][href="'+w+'"]',typeof c=="string"&&(w+='[crossorigin="'+c+'"]'),NS.has(w)||(NS.add(w),r={rel:r,crossOrigin:c,href:a},m.querySelector(w)===null&&(a=m.createElement("link"),wi(a,"link",r),Pn(a),m.head.appendChild(a)))}}function oD(r){Lo.D(r),RS("dns-prefetch",r,null)}function aD(r,a){Lo.C(r,a),RS("preconnect",r,a)}function lD(r,a,c){Lo.L(r,a,c);var m=wc;if(m&&r&&a){var w='link[rel="preload"][as="'+cn(a)+'"]';a==="image"&&c&&c.imageSrcSet?(w+='[imagesrcset="'+cn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(w+='[imagesizes="'+cn(c.imageSizes)+'"]')):w+='[href="'+cn(r)+'"]';var S=w;switch(a){case"style":S=Sc(r);break;case"script":S=bc(r)}or.has(S)||(r=x({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:r,as:a},c),or.set(S,r),m.querySelector(w)!==null||a==="style"&&m.querySelector(mh(S))||a==="script"&&m.querySelector(ph(S))||(a=m.createElement("link"),wi(a,"link",r),Pn(a),m.head.appendChild(a)))}}function uD(r,a){Lo.m(r,a);var c=wc;if(c&&r){var m=a&&typeof a.as=="string"?a.as:"script",w='link[rel="modulepreload"][as="'+cn(m)+'"][href="'+cn(r)+'"]',S=w;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=bc(r)}if(!or.has(S)&&(r=x({rel:"modulepreload",href:r},a),or.set(S,r),c.querySelector(w)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(ph(S)))return}m=c.createElement("link"),wi(m,"link",r),Pn(m),c.head.appendChild(m)}}}function cD(r,a,c){Lo.S(r,a,c);var m=wc;if(m&&r){var w=Ks(m).hoistableStyles,S=Sc(r);a=a||"default";var R=w.get(S);if(!R){var V={loading:0,preload:null};if(R=m.querySelector(mh(S)))V.loading=5;else{r=x({rel:"stylesheet",href:r,"data-precedence":a},c),(c=or.get(S))&&Qy(r,c);var J=R=m.createElement("link");Pn(J),wi(J,"link",r),J._p=new Promise(function(ae,ye){J.onload=ae,J.onerror=ye}),J.addEventListener("load",function(){V.loading|=1}),J.addEventListener("error",function(){V.loading|=2}),V.loading|=4,Bm(R,a,m)}R={type:"stylesheet",instance:R,count:1,state:V},w.set(S,R)}}}function dD(r,a){Lo.X(r,a);var c=wc;if(c&&r){var m=Ks(c).hoistableScripts,w=bc(r),S=m.get(w);S||(S=c.querySelector(ph(w)),S||(r=x({src:r,async:!0},a),(a=or.get(w))&&$y(r,a),S=c.createElement("script"),Pn(S),wi(S,"link",r),c.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},m.set(w,S))}}function hD(r,a){Lo.M(r,a);var c=wc;if(c&&r){var m=Ks(c).hoistableScripts,w=bc(r),S=m.get(w);S||(S=c.querySelector(ph(w)),S||(r=x({src:r,async:!0,type:"module"},a),(a=or.get(w))&&$y(r,a),S=c.createElement("script"),Pn(S),wi(S,"link",r),c.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},m.set(w,S))}}function MS(r,a,c,m){var w=(w=Ce.current)?Fm(w):null;if(!w)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=Sc(c.href),c=Ks(w).hoistableStyles,m=c.get(a),m||(m={type:"style",instance:null,count:0,state:null},c.set(a,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=Sc(c.href);var S=Ks(w).hoistableStyles,R=S.get(r);if(R||(w=w.ownerDocument||w,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(r,R),(S=w.querySelector(mh(r)))&&!S._p&&(R.instance=S,R.state.loading=5),or.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},or.set(r,c),S||fD(w,r,c,R.state))),a&&m===null)throw Error(i(528,""));return R}if(a&&m!==null)throw Error(i(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=bc(c),c=Ks(w).hoistableScripts,m=c.get(a),m||(m={type:"script",instance:null,count:0,state:null},c.set(a,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Sc(r){return'href="'+cn(r)+'"'}function mh(r){return'link[rel="stylesheet"]['+r+"]"}function PS(r){return x({},r,{"data-precedence":r.precedence,precedence:null})}function fD(r,a,c,m){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?m.loading=1:(a=r.createElement("link"),m.preload=a,a.addEventListener("load",function(){return m.loading|=1}),a.addEventListener("error",function(){return m.loading|=2}),wi(a,"link",c),Pn(a),r.head.appendChild(a))}function bc(r){return'[src="'+cn(r)+'"]'}function ph(r){return"script[async]"+r}function kS(r,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var m=r.querySelector('style[data-href~="'+cn(c.href)+'"]');if(m)return a.instance=m,Pn(m),m;var w=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return m=(r.ownerDocument||r).createElement("style"),Pn(m),wi(m,"style",w),Bm(m,c.precedence,r),a.instance=m;case"stylesheet":w=Sc(c.href);var S=r.querySelector(mh(w));if(S)return a.state.loading|=4,a.instance=S,Pn(S),S;m=PS(c),(w=or.get(w))&&Qy(m,w),S=(r.ownerDocument||r).createElement("link"),Pn(S);var R=S;return R._p=new Promise(function(V,J){R.onload=V,R.onerror=J}),wi(S,"link",m),a.state.loading|=4,Bm(S,c.precedence,r),a.instance=S;case"script":return S=bc(c.src),(w=r.querySelector(ph(S)))?(a.instance=w,Pn(w),w):(m=c,(w=or.get(S))&&(m=x({},c),$y(m,w)),r=r.ownerDocument||r,w=r.createElement("script"),Pn(w),wi(w,"link",m),r.head.appendChild(w),a.instance=w);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(m=a.instance,a.state.loading|=4,Bm(m,c.precedence,r));return a.instance}function Bm(r,a,c){for(var m=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=m.length?m[m.length-1]:null,S=w,R=0;R<m.length;R++){var V=m[R];if(V.dataset.precedence===a)S=V;else if(S!==w)break}S?S.parentNode.insertBefore(r,S.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(r,a.firstChild))}function Qy(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function $y(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var zm=null;function DS(r,a,c){if(zm===null){var m=new Map,w=zm=new Map;w.set(c,m)}else w=zm,m=w.get(c),m||(m=new Map,w.set(c,m));if(m.has(r))return m;for(m.set(r,null),c=c.getElementsByTagName(r),w=0;w<c.length;w++){var S=c[w];if(!(S[js]||S[Cn]||r==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var R=S.getAttribute(a)||"";R=r+R;var V=m.get(R);V?V.push(S):m.set(R,[S])}}return m}function LS(r,a,c){r=r.ownerDocument||r,r.head.insertBefore(c,a==="title"?r.querySelector("head > title"):null)}function mD(r,a,c){if(c===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function VS(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function pD(r,a,c,m){if(c.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var w=Sc(m.href),S=a.querySelector(mh(w));if(S){a=S._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(r.count++,r=qm.bind(r),a.then(r,r)),c.state.loading|=4,c.instance=S,Pn(S);return}S=a.ownerDocument||a,m=PS(m),(w=or.get(w))&&Qy(m,w),S=S.createElement("link"),Pn(S);var R=S;R._p=new Promise(function(V,J){R.onload=V,R.onerror=J}),wi(S,"link",m),c.instance=S}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(c,a),(a=c.state.preload)&&(c.state.loading&3)===0&&(r.count++,c=qm.bind(r),a.addEventListener("load",c),a.addEventListener("error",c))}}var Xy=0;function gD(r,a){return r.stylesheets&&r.count===0&&Hm(r,r.stylesheets),0<r.count||0<r.imgCount?function(c){var m=setTimeout(function(){if(r.stylesheets&&Hm(r,r.stylesheets),r.unsuspend){var S=r.unsuspend;r.unsuspend=null,S()}},6e4+a);0<r.imgBytes&&Xy===0&&(Xy=62500*Zk());var w=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Hm(r,r.stylesheets),r.unsuspend)){var S=r.unsuspend;r.unsuspend=null,S()}},(r.imgBytes>Xy?50:800)+a);return r.unsuspend=c,function(){r.unsuspend=null,clearTimeout(m),clearTimeout(w)}}:null}function qm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Hm(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Gm=null;function Hm(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Gm=new Map,a.forEach(_D,r),Gm=null,qm.call(r))}function _D(r,a){if(!(a.state.loading&4)){var c=Gm.get(r);if(c)var m=c.get(null);else{c=new Map,Gm.set(r,c);for(var w=r.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<w.length;S++){var R=w[S];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(c.set(R.dataset.precedence,R),m=R)}m&&c.set(null,m)}w=a.instance,R=w.getAttribute("data-precedence"),S=c.get(R)||m,S===m&&c.set(null,w),c.set(R,w),this.count++,m=qm.bind(this),w.addEventListener("load",m),w.addEventListener("error",m),S?S.parentNode.insertBefore(w,S.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(w,r.firstChild)),a.state.loading|=4}}var gh={$$typeof:Q,Provider:null,Consumer:null,_currentValue:be,_currentValue2:be,_threadCount:0};function yD(r,a,c,m,w,S,R,V,J){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Hs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hs(0),this.hiddenUpdates=Hs(null),this.identifierPrefix=m,this.onUncaughtError=w,this.onCaughtError=S,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=J,this.incompleteTransitions=new Map}function OS(r,a,c,m,w,S,R,V,J,ae,ye,xe){return r=new yD(r,a,c,R,J,ae,ye,xe,V),a=1,S===!0&&(a|=24),S=Ri(3,null,null,a),r.current=S,S.stateNode=r,a=P_(),a.refCount++,r.pooledCache=a,a.refCount++,S.memoizedState={element:m,isDehydrated:c,cache:a},V_(S),r}function US(r){return r?(r=Eo,r):Eo}function FS(r,a,c,m,w,S){w=US(w),m.context===null?m.context=w:m.pendingContext=w,m=ba(a),m.payload={element:c},S=S===void 0?null:S,S!==null&&(m.callback=S),c=Ca(r,m,a),c!==null&&(fs(c,r,a),Yd(c,r,a))}function BS(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<a?c:a}}function ev(r,a){BS(r,a),(r=r.alternate)&&BS(r,a)}function zS(r){if(r.tag===13||r.tag===31){var a=nr(r,67108864);a!==null&&fs(a,r,67108864),ev(r,67108864)}}function qS(r){if(r.tag===13||r.tag===31){var a=Os();a=oi(a);var c=nr(r,a);c!==null&&fs(c,r,a),ev(r,a)}}var jm=!0;function vD(r,a,c,m){var w=se.T;se.T=null;var S=Se.p;try{Se.p=2,tv(r,a,c,m)}finally{Se.p=S,se.T=w}}function TD(r,a,c,m){var w=se.T;se.T=null;var S=Se.p;try{Se.p=8,tv(r,a,c,m)}finally{Se.p=S,se.T=w}}function tv(r,a,c,m){if(jm){var w=nv(m);if(w===null)zy(r,a,m,Km,c),HS(r,m);else if(xD(w,r,a,c,m))m.stopPropagation();else if(HS(r,m),a&4&&-1<ED.indexOf(r)){for(;w!==null;){var S=Xi(w);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var R=zi(S.pendingLanes);if(R!==0){var V=S;for(V.pendingLanes|=2,V.entangledLanes|=2;R;){var J=1<<31-dt(R);V.entanglements[1]|=J,R&=~J}Xr(S),(jt&6)===0&&(Am=lt()+500,ch(0))}}break;case 31:case 13:V=nr(S,2),V!==null&&fs(V,S,2),Rm(),ev(S,2)}if(S=nv(m),S===null&&zy(r,a,m,Km,c),S===w)break;w=S}w!==null&&m.stopPropagation()}else zy(r,a,m,null,c)}}function nv(r){return r=Ci(r),iv(r)}var Km=null;function iv(r){if(Km=null,r=Ss(r),r!==null){var a=o(r);if(a===null)r=null;else{var c=a.tag;if(c===13){if(r=l(a),r!==null)return r;r=null}else if(c===31){if(r=d(a),r!==null)return r;r=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return Km=r,null}function GS(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(rn()){case jn:return 2;case vi:return 8;case pn:case Ts:return 32;case Lr:return 268435456;default:return 32}default:return 32}}var sv=!1,Oa=null,Ua=null,Fa=null,_h=new Map,yh=new Map,Ba=[],ED="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function HS(r,a){switch(r){case"focusin":case"focusout":Oa=null;break;case"dragenter":case"dragleave":Ua=null;break;case"mouseover":case"mouseout":Fa=null;break;case"pointerover":case"pointerout":_h.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":yh.delete(a.pointerId)}}function vh(r,a,c,m,w,S){return r===null||r.nativeEvent!==S?(r={blockedOn:a,domEventName:c,eventSystemFlags:m,nativeEvent:S,targetContainers:[w]},a!==null&&(a=Xi(a),a!==null&&zS(a)),r):(r.eventSystemFlags|=m,a=r.targetContainers,w!==null&&a.indexOf(w)===-1&&a.push(w),r)}function xD(r,a,c,m,w){switch(a){case"focusin":return Oa=vh(Oa,r,a,c,m,w),!0;case"dragenter":return Ua=vh(Ua,r,a,c,m,w),!0;case"mouseover":return Fa=vh(Fa,r,a,c,m,w),!0;case"pointerover":var S=w.pointerId;return _h.set(S,vh(_h.get(S)||null,r,a,c,m,w)),!0;case"gotpointercapture":return S=w.pointerId,yh.set(S,vh(yh.get(S)||null,r,a,c,m,w)),!0}return!1}function jS(r){var a=Ss(r.target);if(a!==null){var c=o(a);if(c!==null){if(a=c.tag,a===13){if(a=l(c),a!==null){r.blockedOn=a,Qi(r.priority,function(){qS(c)});return}}else if(a===31){if(a=d(c),a!==null){r.blockedOn=a,Qi(r.priority,function(){qS(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Wm(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var c=nv(r.nativeEvent);if(c===null){c=r.nativeEvent;var m=new c.constructor(c.type,c);ca=m,c.target.dispatchEvent(m),ca=null}else return a=Xi(c),a!==null&&zS(a),r.blockedOn=c,!1;a.shift()}return!0}function KS(r,a,c){Wm(r)&&c.delete(a)}function wD(){sv=!1,Oa!==null&&Wm(Oa)&&(Oa=null),Ua!==null&&Wm(Ua)&&(Ua=null),Fa!==null&&Wm(Fa)&&(Fa=null),_h.forEach(KS),yh.forEach(KS)}function Ym(r,a){r.blockedOn===a&&(r.blockedOn=null,sv||(sv=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,wD)))}var Jm=null;function WS(r){Jm!==r&&(Jm=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Jm===r&&(Jm=null);for(var a=0;a<r.length;a+=3){var c=r[a],m=r[a+1],w=r[a+2];if(typeof m!="function"){if(iv(m||c)===null)continue;break}var S=Xi(c);S!==null&&(r.splice(a,3),a-=3,ny(S,{pending:!0,data:w,method:c.method,action:m},m,w))}}))}function Cc(r){function a(J){return Ym(J,r)}Oa!==null&&Ym(Oa,r),Ua!==null&&Ym(Ua,r),Fa!==null&&Ym(Fa,r),_h.forEach(a),yh.forEach(a);for(var c=0;c<Ba.length;c++){var m=Ba[c];m.blockedOn===r&&(m.blockedOn=null)}for(;0<Ba.length&&(c=Ba[0],c.blockedOn===null);)jS(c),c.blockedOn===null&&Ba.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(m=0;m<c.length;m+=3){var w=c[m],S=c[m+1],R=w[Mn]||null;if(typeof S=="function")R||WS(c);else if(R){var V=null;if(S&&S.hasAttribute("formAction")){if(w=S,R=S[Mn]||null)V=R.formAction;else if(iv(w)!==null)continue}else V=R.action;typeof V=="function"?c[m+1]=V:(c.splice(m,3),m-=3),WS(c)}}}function YS(){function r(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(R){return w=R})},focusReset:"manual",scroll:"manual"})}function a(){w!==null&&(w(),w=null),m||setTimeout(c,20)}function c(){if(!m&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,w=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(c,100),function(){m=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),w!==null&&(w(),w=null)}}}function rv(r){this._internalRoot=r}Zm.prototype.render=rv.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(i(409));var c=a.current,m=Os();FS(c,m,r,a,null,null)},Zm.prototype.unmount=rv.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;FS(r.current,2,null,r,null,null),Rm(),a[xs]=null}};function Zm(r){this._internalRoot=r}Zm.prototype.unstable_scheduleHydration=function(r){if(r){var a=wl();r={blockedOn:null,target:r,priority:a};for(var c=0;c<Ba.length&&a!==0&&a<Ba[c].priority;c++);Ba.splice(c,0,r),c===0&&jS(r)}};var JS=e.version;if(JS!=="19.2.0")throw Error(i(527,JS,"19.2.0"));Se.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=p(a),r=r!==null?v(r):null,r=r===null?null:r.stateNode,r};var SD={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:se,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qm.isDisabled&&Qm.supportsFiber)try{Ti=Qm.inject(SD),Ne=Qm}catch{}}return Eh.createRoot=function(r,a){if(!s(r))throw Error(i(299));var c=!1,m="",w=nw,S=iw,R=sw;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onUncaughtError!==void 0&&(w=a.onUncaughtError),a.onCaughtError!==void 0&&(S=a.onCaughtError),a.onRecoverableError!==void 0&&(R=a.onRecoverableError)),a=OS(r,1,!1,null,null,c,m,null,w,S,R,YS),r[xs]=a.current,By(r),new rv(a)},Eh.hydrateRoot=function(r,a,c){if(!s(r))throw Error(i(299));var m=!1,w="",S=nw,R=iw,V=sw,J=null;return c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(w=c.identifierPrefix),c.onUncaughtError!==void 0&&(S=c.onUncaughtError),c.onCaughtError!==void 0&&(R=c.onCaughtError),c.onRecoverableError!==void 0&&(V=c.onRecoverableError),c.formState!==void 0&&(J=c.formState)),a=OS(r,1,!0,a,c??null,m,w,J,S,R,V,YS),a.context=US(null),c=a.current,m=Os(),m=oi(m),w=ba(m),w.callback=null,Ca(c,w,m),c=m,a.current.lanes=c,dr(a,c),Xr(a),r[xs]=a.current,By(r),new Zm(a)},Eh.version="19.2.0",Eh}var rb;function kD(){if(rb)return lv.exports;rb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),lv.exports=PD(),lv.exports}var DD=kD();const LD=J0(DD);var ot=(n=>(n.HOME="HOME",n.ADD_TRIP="ADD_TRIP",n.TRIP_DETAILS="TRIP_DETAILS",n.SETTINGS="SETTINGS",n.MAGIC_EDITOR="MAGIC_EDITOR",n.AI_PLANNER="AI_PLANNER",n.TOOLS="TOOLS",n.TRIP_MEMORY="TRIP_MEMORY",n))(ot||{});const ob=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})}),VD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),OD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),bg=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),$a=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"})}),$c=({className:n})=>_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})]}),Vv=({className:n})=>_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})]}),vs=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})}),Ov=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})}),UD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),w1=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:_.jsx("path",{d:"M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5Z"})}),S1=({className:n})=>_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"})]}),b1=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"})}),C1=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 9.75a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 0 1 .778-.332 48.294 48.294 0 0 0 5.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})}),FD=({className:n})=>_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:[_.jsx("path",{d:"M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.85 7h10.29l1.08 3.11H5.77L6.85 7zM19 17H5v-5h14v5z"}),_.jsx("circle",{cx:"7.5",cy:"14.5",r:"1.5"}),_.jsx("circle",{cx:"16.5",cy:"14.5",r:"1.5"})]}),ab=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"})}),Q0=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z"})}),ol=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),BD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"})}),zD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15a4.5 4.5 0 0 0 4.5 4.5H18a3.75 3.75 0 0 0 1.332-7.257 3 3 0 0 0-3.758-3.848 5.25 5.25 0 0 0-10.233 2.33A4.502 4.502 0 0 0 2.25 15Z"})}),I1=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),qD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 0 1-2.25 2.25M16.5 7.5V18a2.25 2.25 0 0 0 2.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 0 0 2.25 2.25h13.5M6 7.5h3v3H6v-3Z"})}),Uv=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-1.94c.955-.13 1.93-.32 2.795-.591 3.615-1.133 4.705-4.884 2.636-7.962-1.373-2.042-3.738-3.257-6.236-3.257-4.14 0-7.5 3.36-7.5 7.5 0 2.053.84 3.942 2.22 5.297.808.796 1.83 1.344 2.923 1.564V18m2.25 0h-4.5m4.5 0a2.25 2.25 0 0 1-2.25 2.25h-1.5A2.25 2.25 0 0 1 7.5 18m9-9h.008v.008H16.5V9Zm-4.5 0h.008v.008H12V9Zm-4.5 0h.008v.008H7.5V9Z"})}),GD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h3.375c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125h-3.375c-.621 0-1.125-.504-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125Zm-3 7.5h10.5a.75.75 0 0 1 .75.75v3.375a3 3 0 0 1-3 3h-6a3 3 0 0 1-3-3V10.5a.75.75 0 0 1 .75-.75Zm9.375 12a1.125 1.125 0 1 0 0-2.25 1.125 1.125 0 0 0 0 2.25Z"})}),HD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"})}),lb=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6 0 3.375 3.375 0 0 1 6 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"})}),A1=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 17.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),jD=({className:n})=>_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 0 1 1.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.559.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.894.149c-.424.07-.764.383-.929.78-.165.398-.143.854.107 1.204l-.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 0 1-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 0 1-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 0 1 .12-1.45l.773-.773a1.125 1.125 0 0 1 1.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894Z"}),_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),KD=({className:n})=>_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}),_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),WD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"})}),N1=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),R1=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 01-1.12-1.243l1.264-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.119 1.007zM8.625 10.5a.375.375 0 11-.75 0 .375.375 0 01.75 0zm7.5 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})}),YD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 016-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 01-3.827-5.802"})}),JD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})}),ub=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0 1 18 16.5h-2.25m-7.5 0h7.5m-7.5 0-1 3m8.5-3 1 3m0 0 .5 1.5m-.5-1.5h-9.5m0 0-.5 1.5M9 11.25v1.5M12 9v3m3-3v3M9 3.75V5.25m3-1.5h3m-3 0v1.5m0-1.5h-3m3 0v1.5M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})}),ZD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:_.jsx("path",{d:"M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4S4 2.5 4 6v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z"})}),QD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:_.jsx("path",{d:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"})}),$D=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),XD=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})}),e5=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})}),t5=({className:n})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"})}),nn={"zh-TW":{back:"",cancel:"",confirm:"",save:"",delete:"",edit:"",loading:"...",day:"Day",my_trips:"",start_adventure:"",click_to_add:"",trips_count:"",new_trip:"",trip_destination_title:" / ",cover_photo:"",upload_photo:"",ai_generate_cover:"AI ",start_date:"",end_date:"",create_trip:"",add_trip_hint:"",itinerary:"",map:"",budget:"",bookings:"",shopping_list:"",shopping:"",origin:"",label_destination:"",status_confirmed:"",status_pending:"",status_cancelled:"",ai_guide:"AI ",add_activity:"",edit_activity:"",add_expense:"",add_booking:"",weather:"",nav_quick_jump:"",no_itinerary:"",no_bookings:"",no_shopping_items:"",click_add:"",delete_trip_title:"",delete_trip_confirm:"{title}",confirm_delete:"",activity_name:"",time:"",location:"",notes:" ()",duration:"",details:"",placeholder_duration:"15 ",placeholder_details:"JR ",ai_route:"AI ",optimize_route:"AI ",expense_item:"",amount:"",payer:"",payment_method:"",booking_type:"",provider:" / ",booking_ref:" ()",booking_type_flight:"",booking_type_hotel:"",booking_type_train:"",label_departure:"",label_arrival:"",label_ref:"",placeholder_provider:" / ...",placeholder_pnr:" / PNR...",placeholder_origin:" (: TPE)...",placeholder_dest:" (: NRT)...",ai_planner_title:"AI ",ai_planner_intro:" AI ",ai_planning:" 10-20 ",ai_done:"",input_placeholder:"...",planning_process:"...",magic_editor_title:"",upload_hint:"",magic_prompt_placeholder:"...",start_magic:"",generating:"...",settings_title:"",general:"",language:"",appearance:"",minimalist_mode:"",minimalist_desc:"",data_mgmt:"",reset_all:"",reset_confirm:"",tools_title:"",tool_emergency:"",tool_card:"",tool_map:"",tool_restroom:"",tool_visa:"",tool_translation:"",tool_culture:"",api_settings:"API ",api_key_label:"Gemini API Key",api_key_placeholder:" API Key",api_key_help:" Key ",api_key_saved:"API Key ",test_ai_connection:" AI ",test_ai_success:"",test_ai_failed:"",test_ai_testing:"...",api_source:"",theme_color:"",payer_me:"",payer_other:"",payment_cash:"",payment_card:"",split_individual:"",split_shared:"",translate_to:"",enter_text:"...",translate_result:"",desc_translator:"AI ",desc_emergency:" / ",desc_card:"",desc_map:"",desc_restroom:"",desc_visa:"",desc_culture:"",prompt_tokyo:"",prompt_bangkok:"",prompt_paris:"",placeholder_item:"",placeholder_payer:"",lang_ja:"",lang_en:"",lang_zh:"",lang_ko:"",lang_th:"",lang_fr:"",lang_es:"",share_trip:"",share_success:"",travel_time:"",travel_mode:"",travel_details:" ( JR )",mode_walk:"",mode_train:"/",mode_bus:"/",mode_car:"/",mode_flight:"",minutes:"",search_placeholder:" (: )",search_location:""},"en-US":{back:"Back",cancel:"Cancel",confirm:"Confirm",save:"Save",delete:"Delete",edit:"Edit",loading:"Loading...",day:"Day",my_trips:"My Trips",start_adventure:"Start New Adventure",click_to_add:"Click button below to add trip",trips_count:"items",new_trip:"New Trip",trip_destination_title:"Destination / Title",cover_photo:"Cover Photo",upload_photo:"Upload",ai_generate_cover:"AI Generate",start_date:"Start Date",end_date:"End Date",create_trip:"Create Trip",add_trip_hint:"You can add detailed itinerary later",itinerary:"Itinerary",map:"Map",budget:"Budget",shopping_list:"Shopping List",shopping:"Shopping",bookings:"Bookings",origin:"Origin",label_destination:"Destination",status_confirmed:"Confirmed",status_pending:"Pending",status_cancelled:"Cancelled",ai_guide:"AI Guide",add_activity:"Add Activity",edit_activity:"Edit Activity",add_expense:"Add Expense",add_booking:"Add Booking",weather:"Weather",nav_quick_jump:"Jump to",no_itinerary:"No itinerary yet",no_bookings:"No bookings yet",click_add:"Click button to add",delete_trip_title:"Delete Trip?",delete_trip_confirm:'Are you sure you want to delete "{title}"? This cannot be undone.',confirm_delete:"Delete",activity_name:"Activity Name",time:"Time",location:"Location",notes:"Notes (Optional)",duration:"Duration",details:"Details",placeholder_duration:"e.g. 15 min",placeholder_details:"e.g. JR Line",ai_route:"AI Route",optimize_route:"AI Route Optimization",expense_item:"Item Name",amount:"Amount",payer:"Payer",payment_method:"Method",booking_type:"Type",provider:"Provider / Name",booking_ref:"Ref Number (Optional)",ai_planner_title:"AI Planner",ai_planner_intro:"Hi! I am your AI travel assistant. Where do you want to go?",ai_planning:"Sure! I am planning your trip. This takes about 10-20 seconds.",ai_done:"Planning complete! Check your trip list. ",input_placeholder:"Enter your travel ideas...",planning_process:"Processing...",magic_editor_title:"Magic Editor",upload_hint:"Upload Photo",magic_prompt_placeholder:"Make it sunny, add balloons...",start_magic:"Generate",generating:"Processing...",settings_title:"Settings",api_settings:"API Settings",api_key_label:"Gemini API Key",api_key_placeholder:"Paste your API Key here",api_key_help:"Your key is stored locally in your browser.",api_key_saved:"API Key Saved",general:"General",language:"Language",appearance:"Appearance",minimalist_mode:"Minimalist Mode",minimalist_desc:"Hide images, focus on text",data_mgmt:"Data Management",reset_all:"Reset All Data",reset_confirm:"Are you sure? This will delete all trips and settings. This cannot be undone.",tools_title:"Tools",tool_emergency:"Emergency",tool_card:"Card Tips",tool_map:"Scratch Map",tool_restroom:"Restroom",tool_visa:"Visa Check",tool_culture:"Culture",share_trip:"Share Trip",share_success:"Copied to clipboard!",travel_time:"Travel Time",travel_mode:"Travel Mode",travel_details:"Details (e.g. JR Line)",mode_walk:"Walk",mode_train:"Train/Subway",mode_bus:"Bus",mode_car:"Car/Taxi",mode_flight:"Flight",minutes:"min",search_placeholder:"Search location (e.g. Tokyo Tower)",search_location:"Search"},"ja-JP":{back:"",cancel:"",confirm:"",save:"",delete:"",edit:"",loading:"...",day:"Day",my_trips:"",start_adventure:"",click_to_add:"",trips_count:"",new_trip:"",trip_destination_title:" / ",cover_photo:"",upload_photo:"",ai_generate_cover:"AI",start_date:"",end_date:"",create_trip:"",add_trip_hint:"",itinerary:"",map:"",budget:"",shopping_list:"",shopping:"",bookings:"",origin:"",label_destination:"",status_confirmed:"",status_pending:"",status_cancelled:"",ai_guide:"AI",add_activity:"",edit_activity:"",add_expense:"",add_booking:"",weather:"",nav_quick_jump:"",no_itinerary:"",no_bookings:"",click_add:"",delete_trip_title:"",delete_trip_confirm:"{title}",confirm_delete:"",activity_name:"",time:"",location:"",notes:" ()",duration:"",details:"",placeholder_duration:"15",placeholder_details:"JR",ai_route:"AI",optimize_route:"AI",expense_item:"",amount:"",payer:"",payment_method:"",booking_type:"",provider:" / ",booking_ref:" ()",ai_planner_title:"AI",ai_planner_intro:"AI",ai_planning:"1020",ai_done:"",input_placeholder:"...",planning_process:"...",magic_editor_title:"",upload_hint:"",magic_prompt_placeholder:"...",start_magic:"",generating:"...",settings_title:"",general:"",language:"",appearance:"",minimalist_mode:"",minimalist_desc:"",data_mgmt:"",reset_all:"",reset_confirm:"",tools_title:"",tool_emergency:"",tool_card:"",tool_map:"",tool_restroom:"",tool_visa:"",tool_culture:"",share_trip:"",share_success:"",travel_time:"",travel_mode:"",travel_details:" (: JR)",mode_walk:"",mode_train:"/",mode_bus:"",mode_car:"/",mode_flight:"",minutes:"",search_placeholder:" (: )",search_location:""}},n5=({trips:n,onSelectTrip:e,onAddTrip:t,onOpenSettings:i,settings:s})=>{const[o,l]=Z.useState(new Set),[d,h]=Z.useState(new Set),p=nn[s.language]||nn["zh-TW"],v=x=>{l(b=>{const A=new Set(b);return A.add(x),A})};return _.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[_.jsxs("div",{className:"px-6 py-5 sticky top-0 z-10 flex justify-between items-center bg-paper/90 backdrop-blur-sm",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"w-14 h-14 flex items-center justify-center overflow-hidden",children:_.jsx("img",{src:"/nomadai-travel-journal_app_icon.png",alt:"Icon",className:"w-full h-full object-cover"})}),_.jsx("h1",{className:"text-3xl font-extrabold text-ink tracking-tight",children:p.my_trips})]}),_.jsx("button",{onClick:i,className:"p-2.5 bg-white shadow-card rounded-full text-gray-400 hover:text-coral transition-colors active:scale-95",children:_.jsx(jD,{className:"w-6 h-6"})})]}),_.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-2 space-y-6 pb-32 no-scrollbar",children:n.length===0?_.jsxs("div",{className:"flex flex-col items-center justify-center h-80 text-center animate-fade-in border-2 border-dashed border-sand rounded-3xl m-4",children:[_.jsx("div",{className:"w-16 h-16 bg-white shadow-soft rounded-full flex items-center justify-center mb-4 text-coral",children:_.jsx(Vv,{className:"w-8 h-8"})}),_.jsx("h3",{className:"text-xl font-bold text-ink mb-1",children:p.start_adventure}),_.jsx("p",{className:"text-gray-400 text-sm",children:p.click_to_add})]}):n==null?void 0:n.map(x=>{var b;return _.jsxs("div",{onClick:()=>e(x),className:`group cursor-pointer active:scale-[0.98] transition-all transform bg-white rounded-3xl shadow-card hover:shadow-soft overflow-hidden ${s.minimalistMode?"p-5 border border-sand":"p-3"}`,children:[!s.minimalistMode&&_.jsxs("div",{className:"aspect-[2/1] w-full relative overflow-hidden rounded-2xl bg-gray-100 mb-4 shadow-inner group",children:[x.coverImage&&!o.has(x.id)?_.jsxs(_.Fragment,{children:[_.jsx("div",{className:`absolute inset-0 bg-gray-200 transition-opacity duration-500 ${d.has(x.id)?"opacity-0 pointer-events-none":"opacity-100"}`}),_.jsx("img",{src:x.coverImage,alt:x.title,onLoad:()=>h(A=>new Set(A).add(x.id)),onError:()=>v(x.id),className:`w-full h-full object-cover transition-all duration-700 ${d.has(x.id)?"opacity-100 group-hover:scale-105":"opacity-0"}`})]}):_.jsx("div",{className:"w-full h-full bg-sand/30 flex items-center justify-center",children:_.jsx(Vv,{className:"w-12 h-12 text-gray-300"})}),_.jsxs("div",{className:"absolute top-3 right-3 bg-white/90 backdrop-blur text-ink text-xs font-bold px-3 py-1.5 rounded-full shadow-sm z-10",children:[((b=x.itinerary)==null?void 0:b.length)||0," ",p.trips_count]})]}),_.jsxs("div",{className:`${s.minimalistMode?"flex justify-between items-center":"px-2 pb-2"}`,children:[_.jsxs("div",{children:[_.jsx("h3",{className:`font-bold text-ink leading-tight ${s.minimalistMode?"text-lg":"text-xl mb-1"}`,children:x.title}),_.jsxs("div",{className:"flex items-center text-sm text-gray-400 font-medium",children:[_.jsx(Ov,{className:"w-4 h-4 mr-1.5 text-coral"}),_.jsxs("span",{children:[x.startDate," - ",x.endDate]})]})]}),s.minimalistMode&&_.jsx("div",{className:"w-8 h-8 bg-paper rounded-full flex items-center justify-center text-coral",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-4 h-4",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})})})]})]},x.id)})}),_.jsx("button",{onClick:t,className:"fixed bottom-28 right-6 w-16 h-16 bg-coral text-white rounded-full shadow-float flex items-center justify-center transition-all active:scale-90 hover:bg-coralDark z-50 ring-4 ring-white",children:_.jsx(bg,{className:"w-8 h-8 stroke-[2]"})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let i5,s5;function r5(){return{geminiUrl:i5,vertexUrl:s5}}function o5(n,e,t,i){var s,o;if(!(n!=null&&n.baseUrl)){const l=r5();return e?(s=l.vertexUrl)!==null&&s!==void 0?s:t:(o=l.geminiUrl)!==null&&o!==void 0?o:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xo{}function Oe(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const o=e[s];return o!=null?String(o):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function y(n,e,t){for(let o=0;o<e.length-1;o++){const l=e[o];if(l.endsWith("[]")){const d=l.slice(0,-2);if(!(d in n))if(Array.isArray(t))n[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(n[d])){const h=n[d];if(Array.isArray(t))for(let p=0;p<h.length;p++){const v=h[p];y(v,e.slice(o+1),t[p])}else for(const p of h)y(p,e.slice(o+1),t)}return}else if(l.endsWith("[0]")){const d=l.slice(0,-3);d in n||(n[d]=[{}]);const h=n[d];y(h[0],e.slice(o+1),t);return}(!n[l]||typeof n[l]!="object")&&(n[l]={}),n=n[l]}const i=e[e.length-1],s=n[i];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function g(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const s=e[i];if(s.endsWith("[]")){const o=s.slice(0,-2);if(o in n){const l=n[o];return Array.isArray(l)?l.map(d=>g(d,e.slice(i+1),t)):t}else return t}else n=n[s]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function a5(n,e){for(const[t,i]of Object.entries(e)){const s=t.split("."),o=i.split("."),l=new Set;let d=-1;for(let h=0;h<s.length;h++)if(s[h]==="*"){d=h;break}if(d!==-1&&o.length>d)for(let h=d;h<o.length;h++){const p=o[h];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&l.add(p)}Fv(n,s,o,0,l)}}function Fv(n,e,t,i,s){if(i>=e.length||typeof n!="object"||n===null)return;const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2),d=n;if(l in d&&Array.isArray(d[l]))for(const h of d[l])Fv(h,e,t,i+1,s)}else if(o==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const l=n,d=Object.keys(l).filter(p=>!p.startsWith("_")&&!s.has(p)),h={};for(const p of d)h[p]=l[p];for(const[p,v]of Object.entries(h)){const x=[];for(const b of t.slice(i))b==="*"?x.push(p):x.push(b);y(l,x,v)}for(const p of d)delete l[p]}}else{const l=n;o in l&&Fv(l[o],e,t,i+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $0(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function l5(n){const e={},t=g(n,["operationName"]);t!=null&&y(e,["operationName"],t);const i=g(n,["resourceName"]);return i!=null&&y(e,["_url","resourceName"],i),e}function u5(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["metadata"]);i!=null&&y(e,["metadata"],i);const s=g(n,["done"]);s!=null&&y(e,["done"],s);const o=g(n,["error"]);o!=null&&y(e,["error"],o);const l=g(n,["response","generateVideoResponse"]);return l!=null&&y(e,["response"],d5(l)),e}function c5(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["metadata"]);i!=null&&y(e,["metadata"],i);const s=g(n,["done"]);s!=null&&y(e,["done"],s);const o=g(n,["error"]);o!=null&&y(e,["error"],o);const l=g(n,["response"]);return l!=null&&y(e,["response"],h5(l)),e}function d5(n){const e={},t=g(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>f5(l))),y(e,["generatedVideos"],o)}const i=g(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const s=g(n,["raiMediaFilteredReasons"]);return s!=null&&y(e,["raiMediaFilteredReasons"],s),e}function h5(n){const e={},t=g(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>m5(l))),y(e,["generatedVideos"],o)}const i=g(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const s=g(n,["raiMediaFilteredReasons"]);return s!=null&&y(e,["raiMediaFilteredReasons"],s),e}function f5(n){const e={},t=g(n,["video"]);return t!=null&&y(e,["video"],T5(t)),e}function m5(n){const e={},t=g(n,["_self"]);return t!=null&&y(e,["video"],E5(t)),e}function p5(n){const e={},t=g(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function g5(n){const e={},t=g(n,["operationName"]);return t!=null&&y(e,["_url","operationName"],t),e}function _5(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["metadata"]);i!=null&&y(e,["metadata"],i);const s=g(n,["done"]);s!=null&&y(e,["done"],s);const o=g(n,["error"]);o!=null&&y(e,["error"],o);const l=g(n,["response"]);return l!=null&&y(e,["response"],y5(l)),e}function y5(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["parent"]);i!=null&&y(e,["parent"],i);const s=g(n,["documentName"]);return s!=null&&y(e,["documentName"],s),e}function M1(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["metadata"]);i!=null&&y(e,["metadata"],i);const s=g(n,["done"]);s!=null&&y(e,["done"],s);const o=g(n,["error"]);o!=null&&y(e,["error"],o);const l=g(n,["response"]);return l!=null&&y(e,["response"],v5(l)),e}function v5(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["parent"]);i!=null&&y(e,["parent"],i);const s=g(n,["documentName"]);return s!=null&&y(e,["documentName"],s),e}function T5(n){const e={},t=g(n,["uri"]);t!=null&&y(e,["uri"],t);const i=g(n,["encodedVideo"]);i!=null&&y(e,["videoBytes"],$0(i));const s=g(n,["encoding"]);return s!=null&&y(e,["mimeType"],s),e}function E5(n){const e={},t=g(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=g(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],$0(i));const s=g(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var cb;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(cb||(cb={}));var db;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(db||(db={}));var hb;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(hb||(hb={}));var Za;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Za||(Za={}));var fb;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(fb||(fb={}));var mb;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(mb||(mb={}));var pb;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(pb||(pb={}));var gb;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(gb||(gb={}));var _b;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(_b||(_b={}));var yb;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(yb||(yb={}));var vb;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(vb||(vb={}));var Tb;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Tb||(Tb={}));var Eb;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Eb||(Eb={}));var xb;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(xb||(xb={}));var wb;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(wb||(wb={}));var Sb;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Sb||(Sb={}));var bb;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(bb||(bb={}));var Cb;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(Cb||(Cb={}));var Ib;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Ib||(Ib={}));var Rp;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Rp||(Rp={}));var Ab;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Ab||(Ab={}));var Nb;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Nb||(Nb={}));var Rb;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Rb||(Rb={}));var Bv;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Bv||(Bv={}));var Mb;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Mb||(Mb={}));var Pb;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Pb||(Pb={}));var kb;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(kb||(kb={}));var Db;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(Db||(Db={}));var Lb;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Lb||(Lb={}));var Vb;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Vb||(Vb={}));var Ob;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(Ob||(Ob={}));var Ub;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Ub||(Ub={}));var Fb;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(Fb||(Fb={}));var Bb;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(Bb||(Bb={}));var zb;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(zb||(zb={}));var qb;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(qb||(qb={}));var Gb;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Gb||(Gb={}));var Hb;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Hb||(Hb={}));var jb;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(jb||(jb={}));var Kb;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(Kb||(Kb={}));var Wb;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(Wb||(Wb={}));var Yb;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(Yb||(Yb={}));var Jb;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Jb||(Jb={}));var Zb;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(Zb||(Zb={}));var Qb;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(Qb||(Qb={}));var $b;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})($b||($b={}));var Xb;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Xb||(Xb={}));var eC;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(eC||(eC={}));var tC;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(tC||(tC={}));var nC;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(nC||(nC={}));var iC;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(iC||(iC={}));var sC;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(sC||(sC={}));var rC;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(rC||(rC={}));var oC;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(oC||(oC={}));var Fc;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Fc||(Fc={}));class zv{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class xh{get text(){var e,t,i,s,o,l,d,h;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",v=!1;const x=[];for(const b of(h=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&h!==void 0?h:[]){for(const[A,P]of Object.entries(b))A!=="text"&&A!=="thought"&&A!=="thoughtSignature"&&(P!==null||P!==void 0)&&x.push(A);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;v=!0,p+=b.text}}return x.length>0&&console.warn(`there are non-text parts ${x} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),v?p:void 0}get data(){var e,t,i,s,o,l,d,h;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const v=[];for(const x of(h=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&h!==void 0?h:[]){for(const[b,A]of Object.entries(x))b!=="inlineData"&&(A!==null||A!==void 0)&&v.push(b);x.inlineData&&typeof x.inlineData.data=="string"&&(p+=atob(x.inlineData.data))}return v.length>0&&console.warn(`there are non-data parts ${v} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,s,o,l,d,h;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(h=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||h===void 0?void 0:h.filter(v=>v.functionCall).map(v=>v.functionCall).filter(v=>v!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,s,o,l,d,h,p;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const v=(h=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||h===void 0?void 0:h.filter(x=>x.executableCode).map(x=>x.executableCode).filter(x=>x!==void 0);if((v==null?void 0:v.length)!==0)return(p=v==null?void 0:v[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,s,o,l,d,h,p;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const v=(h=(d=(l=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||h===void 0?void 0:h.filter(x=>x.codeExecutionResult).map(x=>x.codeExecutionResult).filter(x=>x!==void 0);if((v==null?void 0:v.length)!==0)return(p=v==null?void 0:v[0])===null||p===void 0?void 0:p.output}}class aC{}class lC{}class x5{}class w5{}class S5{}class b5{}class uC{}class cC{}class dC{}class C5{}class Mp{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Mp;let s;const o=e;return t?s=c5(o):s=u5(o),Object.assign(i,s),i}}class hC{}class fC{}class mC{}class I5{}class A5{}class N5{}class X0{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new X0,o=_5(e);return Object.assign(i,o),i}}class R5{}class M5{}class P5{}class pC{}class k5{get text(){var e,t,i;let s="",o=!1;const l=[];for(const d of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[h,p]of Object.entries(d))h!=="text"&&h!=="thought"&&p!==null&&l.push(h);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;o=!0,s+=d.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?s:void 0}get data(){var e,t,i;let s="";const o=[];for(const l of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[d,h]of Object.entries(l))d!=="inlineData"&&h!==null&&o.push(d);l.inlineData&&typeof l.inlineData.data=="string"&&(s+=atob(l.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class D5{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class eT{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new eT,o=M1(e);return Object.assign(i,o),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ht(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function P1(n,e){const t=Ht(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function k1(n){return Array.isArray(n)?n.map(e=>Pp(e)):[Pp(n)]}function Pp(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function D1(n){const e=Pp(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function L1(n){const e=Pp(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function gC(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function V1(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>gC(e)):[gC(n)]}function qv(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function _C(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function yC(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Oi(n){if(n==null)throw new Error("ContentUnion is required");return qv(n)?n:{role:"user",parts:V1(n)}}function tT(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=Oi(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=Oi(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Oi(t)):[Oi(e)]}function ur(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(_C(n)||yC(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Oi(n)]}const e=[],t=[],i=qv(n[0]);for(const s of n){const o=qv(s);if(o!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(s);else{if(_C(s)||yC(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return i||e.push({role:"user",parts:V1(t)}),e}function L5(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(Za).includes(t[0].toUpperCase())?t[0].toUpperCase():Za.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(Za).includes(i.toUpperCase())?i.toUpperCase():Za.TYPE_UNSPECIFIED})}}function qc(n){const e={},t=["items"],i=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=n.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,n=o[1]):o[1].type==="null"&&(e.nullable=!0,n=o[0])),n.type instanceof Array&&L5(n.type,e);for(const[l,d]of Object.entries(n))if(d!=null)if(l=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(Za).includes(d.toUpperCase())?d.toUpperCase():Za.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=qc(d);else if(i.includes(l)){const h=[];for(const p of d){if(p.type=="null"){e.nullable=!0;continue}h.push(qc(p))}e[l]=h}else if(s.includes(l)){const h={};for(const[p,v]of Object.entries(d))h[p]=qc(v);e[l]=h}else{if(l==="additionalProperties")continue;e[l]=d}return e}function nT(n){return qc(n)}function iT(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function sT(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Ed(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=qc(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=qc(e.response));return n}function xd(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function V5(n,e,t,i=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function ea(n,e){if(typeof e!="string")throw new Error("name must be a string");return V5(n,e,"cachedContents")}function O1(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function ml(n){return $0(n)}function O5(n){return n!=null&&typeof n=="object"&&"name"in n}function U5(n){return n!=null&&typeof n=="object"&&"video"in n}function F5(n){return n!=null&&typeof n=="object"&&"uri"in n}function U1(n){var e;let t;if(O5(n)&&(t=n.name),!(F5(n)&&(t=n.uri,t===void 0))&&!(U5(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function F1(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function B1(n){for(const e of["models","tunedModels","publisherModels"])if(B5(n,e))return n[e];return[]}function B5(n,e){return n!==null&&typeof n=="object"&&e in n}function z5(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function q5(n,e={}){const t=[],i=new Set;for(const s of n){const o=s.name;if(i.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);i.add(o);const l=z5(s,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function z1(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(s>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function G5(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function q1(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return n;let o=!1;for(const l of s){if(typeof l!="object"||l===null)continue;const h=l.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function wd(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function G1(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function H5(n){const e={},t=g(n,["responsesFile"]);t!=null&&y(e,["fileName"],t);const i=g(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>SL(l))),y(e,["inlinedResponses"],o)}const s=g(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["inlinedEmbedContentResponses"],o)}return e}function j5(n){const e={},t=g(n,["predictionsFormat"]);t!=null&&y(e,["format"],t);const i=g(n,["gcsDestination","outputUriPrefix"]);i!=null&&y(e,["gcsUri"],i);const s=g(n,["bigqueryDestination","outputUri"]);return s!=null&&y(e,["bigqueryUri"],s),e}function K5(n){const e={},t=g(n,["format"]);t!=null&&y(e,["predictionsFormat"],t);const i=g(n,["gcsUri"]);i!=null&&y(e,["gcsDestination","outputUriPrefix"],i);const s=g(n,["bigqueryUri"]);if(s!=null&&y(e,["bigqueryDestination","outputUri"],s),g(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(g(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function up(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["metadata","displayName"]);i!=null&&y(e,["displayName"],i);const s=g(n,["metadata","state"]);s!=null&&y(e,["state"],G1(s));const o=g(n,["metadata","createTime"]);o!=null&&y(e,["createTime"],o);const l=g(n,["metadata","endTime"]);l!=null&&y(e,["endTime"],l);const d=g(n,["metadata","updateTime"]);d!=null&&y(e,["updateTime"],d);const h=g(n,["metadata","model"]);h!=null&&y(e,["model"],h);const p=g(n,["metadata","output"]);return p!=null&&y(e,["dest"],H5(q1(p))),e}function Gv(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["displayName"]);i!=null&&y(e,["displayName"],i);const s=g(n,["state"]);s!=null&&y(e,["state"],G1(s));const o=g(n,["error"]);o!=null&&y(e,["error"],o);const l=g(n,["createTime"]);l!=null&&y(e,["createTime"],l);const d=g(n,["startTime"]);d!=null&&y(e,["startTime"],d);const h=g(n,["endTime"]);h!=null&&y(e,["endTime"],h);const p=g(n,["updateTime"]);p!=null&&y(e,["updateTime"],p);const v=g(n,["model"]);v!=null&&y(e,["model"],v);const x=g(n,["inputConfig"]);x!=null&&y(e,["src"],W5(x));const b=g(n,["outputConfig"]);b!=null&&y(e,["dest"],j5(q1(b)));const A=g(n,["completionStats"]);return A!=null&&y(e,["completionStats"],A),e}function W5(n){const e={},t=g(n,["instancesFormat"]);t!=null&&y(e,["format"],t);const i=g(n,["gcsSource","uris"]);i!=null&&y(e,["gcsUri"],i);const s=g(n,["bigquerySource","inputUri"]);return s!=null&&y(e,["bigqueryUri"],s),e}function Y5(n,e){const t={};if(g(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(g(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=g(e,["fileName"]);i!=null&&y(t,["fileName"],i);const s=g(e,["inlinedRequests"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>wL(n,l))),y(t,["requests","requests"],o)}return t}function J5(n){const e={},t=g(n,["format"]);t!=null&&y(e,["instancesFormat"],t);const i=g(n,["gcsUri"]);i!=null&&y(e,["gcsSource","uris"],i);const s=g(n,["bigqueryUri"]);if(s!=null&&y(e,["bigquerySource","inputUri"],s),g(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Z5(n){const e={},t=g(n,["data"]);if(t!=null&&y(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function Q5(n,e){const t={},i=g(e,["name"]);return i!=null&&y(t,["_url","name"],wd(n,i)),t}function $5(n,e){const t={},i=g(e,["name"]);return i!=null&&y(t,["_url","name"],wd(n,i)),t}function X5(n){const e={},t=g(n,["content"]);t!=null&&y(e,["content"],t);const i=g(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],eL(i));const s=g(n,["tokenCount"]);s!=null&&y(e,["tokenCount"],s);const o=g(n,["finishReason"]);o!=null&&y(e,["finishReason"],o);const l=g(n,["avgLogprobs"]);l!=null&&y(e,["avgLogprobs"],l);const d=g(n,["groundingMetadata"]);d!=null&&y(e,["groundingMetadata"],d);const h=g(n,["index"]);h!=null&&y(e,["index"],h);const p=g(n,["logprobsResult"]);p!=null&&y(e,["logprobsResult"],p);const v=g(n,["safetyRatings"]);if(v!=null){let b=v;Array.isArray(b)&&(b=b.map(A=>A)),y(e,["safetyRatings"],b)}const x=g(n,["urlContextMetadata"]);return x!=null&&y(e,["urlContextMetadata"],x),e}function eL(n){const e={},t=g(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),y(e,["citations"],i)}return e}function H1(n){const e={},t=g(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>ML(o))),y(e,["parts"],s)}const i=g(n,["role"]);return i!=null&&y(e,["role"],i),e}function tL(n,e){const t={},i=g(n,["displayName"]);if(e!==void 0&&i!=null&&y(e,["batch","displayName"],i),g(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function nL(n,e){const t={},i=g(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const s=g(n,["dest"]);return e!==void 0&&s!=null&&y(e,["outputConfig"],K5(G5(s))),t}function vC(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["src"]);s!=null&&y(t,["batch","inputConfig"],Y5(n,z1(n,s)));const o=g(e,["config"]);return o!=null&&tL(o,t),t}function iL(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["model"],Ht(n,i));const s=g(e,["src"]);s!=null&&y(t,["inputConfig"],J5(z1(n,s)));const o=g(e,["config"]);return o!=null&&nL(o,t),t}function sL(n,e){const t={},i=g(n,["displayName"]);return e!==void 0&&i!=null&&y(e,["batch","displayName"],i),t}function rL(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["src"]);s!=null&&y(t,["batch","inputConfig"],hL(n,s));const o=g(e,["config"]);return o!=null&&sL(o,t),t}function oL(n,e){const t={},i=g(e,["name"]);return i!=null&&y(t,["_url","name"],wd(n,i)),t}function aL(n,e){const t={},i=g(e,["name"]);return i!=null&&y(t,["_url","name"],wd(n,i)),t}function lL(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["name"]);i!=null&&y(e,["name"],i);const s=g(n,["done"]);s!=null&&y(e,["done"],s);const o=g(n,["error"]);return o!=null&&y(e,["error"],o),e}function uL(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["name"]);i!=null&&y(e,["name"],i);const s=g(n,["done"]);s!=null&&y(e,["done"],s);const o=g(n,["error"]);return o!=null&&y(e,["error"],o),e}function cL(n,e){const t={},i=g(e,["contents"]);if(i!=null){let o=tT(n,i);Array.isArray(o)&&(o=o.map(l=>l)),y(t,["requests[]","request","content"],o)}const s=g(e,["config"]);return s!=null&&(y(t,["_self"],dL(s,t)),a5(t,{"requests[].*":"requests[].request.*"})),t}function dL(n,e){const t={},i=g(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const s=g(n,["title"]);e!==void 0&&s!=null&&y(e,["requests[]","title"],s);const o=g(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&y(e,["requests[]","outputDimensionality"],o),g(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function hL(n,e){const t={},i=g(e,["fileName"]);i!=null&&y(t,["file_name"],i);const s=g(e,["inlinedRequests"]);return s!=null&&y(t,["requests"],cL(n,s)),t}function fL(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function mL(n){const e={},t=g(n,["id"]);t!=null&&y(e,["id"],t);const i=g(n,["args"]);i!=null&&y(e,["args"],i);const s=g(n,["name"]);if(s!=null&&y(e,["name"],s),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function pL(n){const e={},t=g(n,["mode"]);t!=null&&y(e,["mode"],t);const i=g(n,["allowedFunctionNames"]);if(i!=null&&y(e,["allowedFunctionNames"],i),g(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function gL(n,e,t){const i={},s=g(e,["systemInstruction"]);t!==void 0&&s!=null&&y(t,["systemInstruction"],H1(Oi(s)));const o=g(e,["temperature"]);o!=null&&y(i,["temperature"],o);const l=g(e,["topP"]);l!=null&&y(i,["topP"],l);const d=g(e,["topK"]);d!=null&&y(i,["topK"],d);const h=g(e,["candidateCount"]);h!=null&&y(i,["candidateCount"],h);const p=g(e,["maxOutputTokens"]);p!=null&&y(i,["maxOutputTokens"],p);const v=g(e,["stopSequences"]);v!=null&&y(i,["stopSequences"],v);const x=g(e,["responseLogprobs"]);x!=null&&y(i,["responseLogprobs"],x);const b=g(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const A=g(e,["presencePenalty"]);A!=null&&y(i,["presencePenalty"],A);const P=g(e,["frequencyPenalty"]);P!=null&&y(i,["frequencyPenalty"],P);const F=g(e,["seed"]);F!=null&&y(i,["seed"],F);const H=g(e,["responseMimeType"]);H!=null&&y(i,["responseMimeType"],H);const X=g(e,["responseSchema"]);X!=null&&y(i,["responseSchema"],nT(X));const re=g(e,["responseJsonSchema"]);if(re!=null&&y(i,["responseJsonSchema"],re),g(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const Q=g(e,["safetySettings"]);if(t!==void 0&&Q!=null){let W=Q;Array.isArray(W)&&(W=W.map(z=>PL(z))),y(t,["safetySettings"],W)}const he=g(e,["tools"]);if(t!==void 0&&he!=null){let W=xd(he);Array.isArray(W)&&(W=W.map(z=>DL(Ed(z)))),y(t,["tools"],W)}const fe=g(e,["toolConfig"]);if(t!==void 0&&fe!=null&&y(t,["toolConfig"],kL(fe)),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const Y=g(e,["cachedContent"]);t!==void 0&&Y!=null&&y(t,["cachedContent"],ea(n,Y));const k=g(e,["responseModalities"]);k!=null&&y(i,["responseModalities"],k);const B=g(e,["mediaResolution"]);B!=null&&y(i,["mediaResolution"],B);const O=g(e,["speechConfig"]);if(O!=null&&y(i,["speechConfig"],iT(O)),g(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const q=g(e,["thinkingConfig"]);q!=null&&y(i,["thinkingConfig"],q);const G=g(e,["imageConfig"]);return G!=null&&y(i,["imageConfig"],xL(G)),i}function _L(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["candidates"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(p=>X5(p))),y(e,["candidates"],h)}const s=g(n,["modelVersion"]);s!=null&&y(e,["modelVersion"],s);const o=g(n,["promptFeedback"]);o!=null&&y(e,["promptFeedback"],o);const l=g(n,["responseId"]);l!=null&&y(e,["responseId"],l);const d=g(n,["usageMetadata"]);return d!=null&&y(e,["usageMetadata"],d),e}function yL(n,e){const t={},i=g(e,["name"]);return i!=null&&y(t,["_url","name"],wd(n,i)),t}function vL(n,e){const t={},i=g(e,["name"]);return i!=null&&y(t,["_url","name"],wd(n,i)),t}function TL(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function EL(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function xL(n){const e={},t=g(n,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const i=g(n,["imageSize"]);if(i!=null&&y(e,["imageSize"],i),g(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function wL(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["request","model"],Ht(n,i));const s=g(e,["contents"]);if(s!=null){let d=ur(s);Array.isArray(d)&&(d=d.map(h=>H1(h))),y(t,["request","contents"],d)}const o=g(e,["metadata"]);o!=null&&y(t,["metadata"],o);const l=g(e,["config"]);return l!=null&&y(t,["request","generationConfig"],gL(n,l,g(t,["request"],{}))),t}function SL(n){const e={},t=g(n,["response"]);t!=null&&y(e,["response"],_L(t));const i=g(n,["error"]);return i!=null&&y(e,["error"],i),e}function bL(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const s=g(n,["pageToken"]);if(e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),g(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function CL(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const s=g(n,["pageToken"]);e!==void 0&&s!=null&&y(e,["_query","pageToken"],s);const o=g(n,["filter"]);return e!==void 0&&o!=null&&y(e,["_query","filter"],o),t}function IL(n){const e={},t=g(n,["config"]);return t!=null&&bL(t,e),e}function AL(n){const e={},t=g(n,["config"]);return t!=null&&CL(t,e),e}function NL(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const s=g(n,["operations"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>up(l))),y(e,["batchJobs"],o)}return e}function RL(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const s=g(n,["batchPredictionJobs"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>Gv(l))),y(e,["batchJobs"],o)}return e}function ML(n){const e={},t=g(n,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const i=g(n,["codeExecutionResult"]);i!=null&&y(e,["codeExecutionResult"],i);const s=g(n,["executableCode"]);s!=null&&y(e,["executableCode"],s);const o=g(n,["fileData"]);o!=null&&y(e,["fileData"],fL(o));const l=g(n,["functionCall"]);l!=null&&y(e,["functionCall"],mL(l));const d=g(n,["functionResponse"]);d!=null&&y(e,["functionResponse"],d);const h=g(n,["inlineData"]);h!=null&&y(e,["inlineData"],Z5(h));const p=g(n,["text"]);p!=null&&y(e,["text"],p);const v=g(n,["thought"]);v!=null&&y(e,["thought"],v);const x=g(n,["thoughtSignature"]);x!=null&&y(e,["thoughtSignature"],x);const b=g(n,["videoMetadata"]);return b!=null&&y(e,["videoMetadata"],b),e}function PL(n){const e={},t=g(n,["category"]);if(t!=null&&y(e,["category"],t),g(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=g(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function kL(n){const e={},t=g(n,["functionCallingConfig"]);t!=null&&y(e,["functionCallingConfig"],pL(t));const i=g(n,["retrievalConfig"]);return i!=null&&y(e,["retrievalConfig"],i),e}function DL(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(x=>x)),y(e,["functionDeclarations"],v)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=g(n,["googleSearchRetrieval"]);i!=null&&y(e,["googleSearchRetrieval"],i);const s=g(n,["computerUse"]);s!=null&&y(e,["computerUse"],s);const o=g(n,["fileSearch"]);o!=null&&y(e,["fileSearch"],o);const l=g(n,["codeExecution"]);if(l!=null&&y(e,["codeExecution"],l),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=g(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],TL(d));const h=g(n,["googleSearch"]);h!=null&&y(e,["googleSearch"],EL(h));const p=g(n,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var jo;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(jo||(jo={}));class Vu{constructor(e,t,i,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,s)}init(e,t,i){var s,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!i||Object.keys(i).length===0?l={config:{}}:typeof i=="object"?l=Object.assign({},i):l=i,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(o=(s=l.config)===null||s===void 0?void 0:s.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class LL extends Xo{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new Vu(jo.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=vC(this.apiClient,e),i=t._url,s=Oe("{model}:batchGenerateContent",i),d=t.batch.inputConfig.requests,h=d.requests,p=[];for(const v of h){const x=Object.assign({},v);if(x.systemInstruction){const b=x.systemInstruction;delete x.systemInstruction;const A=x.request;A.systemInstruction=b,x.request=A}p.push(x)}return d.requests=p,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},s=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${s}`),i.dest===void 0){const o=this.getGcsUri(e),l=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?i.dest=`${o.slice(0,-6)}/dest`:i.dest=`${o}_dest_${s}`;else if(l)i.dest=`${l}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=iL(this.apiClient,e);return d=Oe("batchPredictionJobs",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),l.then(v=>Gv(v))}else{const p=vC(this.apiClient,e);return d=Oe("{model}:batchGenerateContent",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),l.then(v=>up(v))}}async createEmbeddingsInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=rL(this.apiClient,e);return o=Oe("{model}:asyncBatchEmbedContent",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>up(h))}}async get(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=vL(this.apiClient,e);return d=Oe("batchPredictionJobs/{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),l.then(v=>Gv(v))}else{const p=yL(this.apiClient,e);return d=Oe("batches/{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),l.then(v=>up(v))}}async cancel(e){var t,i,s,o;let l="",d={};if(this.apiClient.isVertexAI()){const h=$5(this.apiClient,e);l=Oe("batchPredictionJobs/{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const h=Q5(this.apiClient,e);l=Oe("batches/{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=AL(e);return d=Oe("batchPredictionJobs",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=RL(v),b=new pC;return Object.assign(b,x),b})}else{const p=IL(e);return d=Oe("batches",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=NL(v),b=new pC;return Object.assign(b,x),b})}}async delete(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=aL(this.apiClient,e);return d=Oe("batchPredictionJobs/{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>uL(v))}else{const p=oL(this.apiClient,e);return d=Oe("batches/{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>lL(v))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function VL(n){const e={},t=g(n,["data"]);if(t!=null&&y(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function TC(n){const e={},t=g(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>r4(o))),y(e,["parts"],s)}const i=g(n,["role"]);return i!=null&&y(e,["role"],i),e}function OL(n,e){const t={},i=g(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const s=g(n,["expireTime"]);e!==void 0&&s!=null&&y(e,["expireTime"],s);const o=g(n,["displayName"]);e!==void 0&&o!=null&&y(e,["displayName"],o);const l=g(n,["contents"]);if(e!==void 0&&l!=null){let v=ur(l);Array.isArray(v)&&(v=v.map(x=>TC(x))),y(e,["contents"],v)}const d=g(n,["systemInstruction"]);e!==void 0&&d!=null&&y(e,["systemInstruction"],TC(Oi(d)));const h=g(n,["tools"]);if(e!==void 0&&h!=null){let v=h;Array.isArray(v)&&(v=v.map(x=>a4(x))),y(e,["tools"],v)}const p=g(n,["toolConfig"]);if(e!==void 0&&p!=null&&y(e,["toolConfig"],o4(p)),g(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function UL(n,e){const t={},i=g(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const s=g(n,["expireTime"]);e!==void 0&&s!=null&&y(e,["expireTime"],s);const o=g(n,["displayName"]);e!==void 0&&o!=null&&y(e,["displayName"],o);const l=g(n,["contents"]);if(e!==void 0&&l!=null){let x=ur(l);Array.isArray(x)&&(x=x.map(b=>b)),y(e,["contents"],x)}const d=g(n,["systemInstruction"]);e!==void 0&&d!=null&&y(e,["systemInstruction"],Oi(d));const h=g(n,["tools"]);if(e!==void 0&&h!=null){let x=h;Array.isArray(x)&&(x=x.map(b=>l4(b))),y(e,["tools"],x)}const p=g(n,["toolConfig"]);e!==void 0&&p!=null&&y(e,["toolConfig"],p);const v=g(n,["kmsKeyName"]);return e!==void 0&&v!=null&&y(e,["encryption_spec","kmsKeyName"],v),t}function FL(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["model"],P1(n,i));const s=g(e,["config"]);return s!=null&&OL(s,t),t}function BL(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["model"],P1(n,i));const s=g(e,["config"]);return s!=null&&UL(s,t),t}function zL(n,e){const t={},i=g(e,["name"]);return i!=null&&y(t,["_url","name"],ea(n,i)),t}function qL(n,e){const t={},i=g(e,["name"]);return i!=null&&y(t,["_url","name"],ea(n,i)),t}function GL(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function HL(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function jL(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function KL(n){const e={},t=g(n,["id"]);t!=null&&y(e,["id"],t);const i=g(n,["args"]);i!=null&&y(e,["args"],i);const s=g(n,["name"]);if(s!=null&&y(e,["name"],s),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function WL(n){const e={},t=g(n,["mode"]);t!=null&&y(e,["mode"],t);const i=g(n,["allowedFunctionNames"]);if(i!=null&&y(e,["allowedFunctionNames"],i),g(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function YL(n){const e={};if(g(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=g(n,["description"]);t!=null&&y(e,["description"],t);const i=g(n,["name"]);i!=null&&y(e,["name"],i);const s=g(n,["parameters"]);s!=null&&y(e,["parameters"],s);const o=g(n,["parametersJsonSchema"]);o!=null&&y(e,["parametersJsonSchema"],o);const l=g(n,["response"]);l!=null&&y(e,["response"],l);const d=g(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function JL(n,e){const t={},i=g(e,["name"]);return i!=null&&y(t,["_url","name"],ea(n,i)),t}function ZL(n,e){const t={},i=g(e,["name"]);return i!=null&&y(t,["_url","name"],ea(n,i)),t}function QL(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function $L(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function XL(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const s=g(n,["pageToken"]);return e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),t}function e4(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const s=g(n,["pageToken"]);return e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),t}function t4(n){const e={},t=g(n,["config"]);return t!=null&&XL(t,e),e}function n4(n){const e={},t=g(n,["config"]);return t!=null&&e4(t,e),e}function i4(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const s=g(n,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["cachedContents"],o)}return e}function s4(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const s=g(n,["cachedContents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["cachedContents"],o)}return e}function r4(n){const e={},t=g(n,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const i=g(n,["codeExecutionResult"]);i!=null&&y(e,["codeExecutionResult"],i);const s=g(n,["executableCode"]);s!=null&&y(e,["executableCode"],s);const o=g(n,["fileData"]);o!=null&&y(e,["fileData"],jL(o));const l=g(n,["functionCall"]);l!=null&&y(e,["functionCall"],KL(l));const d=g(n,["functionResponse"]);d!=null&&y(e,["functionResponse"],d);const h=g(n,["inlineData"]);h!=null&&y(e,["inlineData"],VL(h));const p=g(n,["text"]);p!=null&&y(e,["text"],p);const v=g(n,["thought"]);v!=null&&y(e,["thought"],v);const x=g(n,["thoughtSignature"]);x!=null&&y(e,["thoughtSignature"],x);const b=g(n,["videoMetadata"]);return b!=null&&y(e,["videoMetadata"],b),e}function o4(n){const e={},t=g(n,["functionCallingConfig"]);t!=null&&y(e,["functionCallingConfig"],WL(t));const i=g(n,["retrievalConfig"]);return i!=null&&y(e,["retrievalConfig"],i),e}function a4(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(x=>x)),y(e,["functionDeclarations"],v)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=g(n,["googleSearchRetrieval"]);i!=null&&y(e,["googleSearchRetrieval"],i);const s=g(n,["computerUse"]);s!=null&&y(e,["computerUse"],s);const o=g(n,["fileSearch"]);o!=null&&y(e,["fileSearch"],o);const l=g(n,["codeExecution"]);if(l!=null&&y(e,["codeExecution"],l),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=g(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],QL(d));const h=g(n,["googleSearch"]);h!=null&&y(e,["googleSearch"],$L(h));const p=g(n,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}function l4(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(b=>YL(b))),y(e,["functionDeclarations"],x)}const i=g(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const s=g(n,["googleSearchRetrieval"]);s!=null&&y(e,["googleSearchRetrieval"],s);const o=g(n,["computerUse"]);if(o!=null&&y(e,["computerUse"],o),g(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=g(n,["codeExecution"]);l!=null&&y(e,["codeExecution"],l);const d=g(n,["enterpriseWebSearch"]);d!=null&&y(e,["enterpriseWebSearch"],d);const h=g(n,["googleMaps"]);h!=null&&y(e,["googleMaps"],h);const p=g(n,["googleSearch"]);p!=null&&y(e,["googleSearch"],p);const v=g(n,["urlContext"]);return v!=null&&y(e,["urlContext"],v),e}function u4(n,e){const t={},i=g(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const s=g(n,["expireTime"]);return e!==void 0&&s!=null&&y(e,["expireTime"],s),t}function c4(n,e){const t={},i=g(n,["ttl"]);e!==void 0&&i!=null&&y(e,["ttl"],i);const s=g(n,["expireTime"]);return e!==void 0&&s!=null&&y(e,["expireTime"],s),t}function d4(n,e){const t={},i=g(e,["name"]);i!=null&&y(t,["_url","name"],ea(n,i));const s=g(e,["config"]);return s!=null&&u4(s,t),t}function h4(n,e){const t={},i=g(e,["name"]);i!=null&&y(t,["_url","name"],ea(n,i));const s=g(e,["config"]);return s!=null&&c4(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class f4 extends Xo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Vu(jo.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=BL(this.apiClient,e);return d=Oe("cachedContents",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),l.then(v=>v)}else{const p=FL(this.apiClient,e);return d=Oe("cachedContents",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),l.then(v=>v)}}async get(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=ZL(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),l.then(v=>v)}else{const p=JL(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),l.then(v=>v)}}async delete(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=qL(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=HL(v),b=new fC;return Object.assign(b,x),b})}else{const p=zL(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=GL(v),b=new fC;return Object.assign(b,x),b})}}async update(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=h4(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),l.then(v=>v)}else{const p=d4(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),l.then(v=>v)}}async listInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=n4(e);return d=Oe("cachedContents",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=s4(v),b=new mC;return Object.assign(b,x),b})}else{const p=t4(e);return d=Oe("cachedContents",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=i4(v),b=new mC;return Object.assign(b,x),b})}}}function EC(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xn(n){return this instanceof xn?(this.v=n,this):new xn(n)}function Gc(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,o=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(A){return function(P){return Promise.resolve(P).then(A,x)}}function d(A,P){i[A]&&(s[A]=function(F){return new Promise(function(H,X){o.push([A,F,H,X])>1||h(A,F)})},P&&(s[A]=P(s[A])))}function h(A,P){try{p(i[A](P))}catch(F){b(o[0][3],F)}}function p(A){A.value instanceof xn?Promise.resolve(A.value.v).then(v,x):b(o[0][2],A)}function v(A){h("next",A)}function x(A){h("throw",A)}function b(A,P){A(P),o.shift(),o.length&&h(o[0][0],o[0][1])}}function zh(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof EC=="function"?EC(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(l){return new Promise(function(d,h){l=n[o](l),s(d,h,l.done,l.value)})}}function s(o,l,d,h){Promise.resolve(h).then(function(p){o({value:p,done:d})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function m4(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:j1(t)}function j1(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function p4(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function xC(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const s=[];let o=!0;for(;i<t&&n[i].role==="model";)s.push(n[i]),o&&!j1(n[i])&&(o=!1),i++;o?e.push(...s):e.pop()}return e}class g4{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new _4(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class _4{constructor(e,t,i,s={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=s,this.history=o,this.sendPromise=Promise.resolve(),p4(o)}async sendMessage(e){var t;await this.sendPromise;const i=Oi(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,l,d;const h=await s,p=(l=(o=h.candidates)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.content,v=h.automaticFunctionCallingHistory,x=this.getHistory(!0).length;let b=[];v!=null&&(b=(d=v.slice(x))!==null&&d!==void 0?d:[]);const A=p?[p]:[];this.recordHistory(i,A,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const i=Oi(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const o=await s;return this.processStreamResponse(o,i)}getHistory(e=!1){const t=e?xC(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,s;return Gc(this,arguments,function*(){var l,d,h,p;const v=[];try{for(var x=!0,b=zh(e),A;A=yield xn(b.next()),l=A.done,!l;x=!0){p=A.value,x=!1;const P=p;if(m4(P)){const F=(s=(i=P.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content;F!==void 0&&v.push(F)}yield yield xn(P)}}catch(P){d={error:P}}finally{try{!x&&!l&&(h=b.return)&&(yield xn(h.call(b)))}finally{if(d)throw d.error}}this.recordHistory(t,v)})}recordHistory(e,t,i){let s=[];t.length>0&&t.every(o=>o.role!==void 0)?s=t:s.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...xC(i)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cg extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Cg.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function y4(n){const e={},t=g(n,["file"]);return t!=null&&y(e,["file"],t),e}function v4(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function T4(n){const e={},t=g(n,["name"]);return t!=null&&y(e,["_url","file"],U1(t)),e}function E4(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function x4(n){const e={},t=g(n,["name"]);return t!=null&&y(e,["_url","file"],U1(t)),e}function w4(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const s=g(n,["pageToken"]);return e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),t}function S4(n){const e={},t=g(n,["config"]);return t!=null&&w4(t,e),e}function b4(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const s=g(n,["files"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class C4 extends Xo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Vu(jo.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=S4(e);return o=Oe("files",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),s.then(h=>{const p=b4(h),v=new R5;return Object.assign(v,p),v})}}async createInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=y4(e);return o=Oe("upload/v1beta/files",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=v4(h),v=new M5;return Object.assign(v,p),v})}}async get(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=x4(e);return o=Oe("files/{file}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=T4(e);return o=Oe("files/{file}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),s.then(h=>{const p=E4(h),v=new P5;return Object.assign(v,p),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cp(n){const e={},t=g(n,["data"]);if(t!=null&&y(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function I4(n){const e={},t=g(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>G4(o))),y(e,["parts"],s)}const i=g(n,["role"]);return i!=null&&y(e,["role"],i),e}function A4(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function N4(n){const e={},t=g(n,["id"]);t!=null&&y(e,["id"],t);const i=g(n,["args"]);i!=null&&y(e,["args"],i);const s=g(n,["name"]);if(s!=null&&y(e,["name"],s),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function R4(n){const e={};if(g(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=g(n,["description"]);t!=null&&y(e,["description"],t);const i=g(n,["name"]);i!=null&&y(e,["name"],i);const s=g(n,["parameters"]);s!=null&&y(e,["parameters"],s);const o=g(n,["parametersJsonSchema"]);o!=null&&y(e,["parametersJsonSchema"],o);const l=g(n,["response"]);l!=null&&y(e,["response"],l);const d=g(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function M4(n){const e={},t=g(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=g(n,["responseJsonSchema"]);i!=null&&y(e,["responseJsonSchema"],i);const s=g(n,["audioTimestamp"]);s!=null&&y(e,["audioTimestamp"],s);const o=g(n,["candidateCount"]);o!=null&&y(e,["candidateCount"],o);const l=g(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const d=g(n,["frequencyPenalty"]);d!=null&&y(e,["frequencyPenalty"],d);const h=g(n,["logprobs"]);h!=null&&y(e,["logprobs"],h);const p=g(n,["maxOutputTokens"]);p!=null&&y(e,["maxOutputTokens"],p);const v=g(n,["mediaResolution"]);v!=null&&y(e,["mediaResolution"],v);const x=g(n,["presencePenalty"]);x!=null&&y(e,["presencePenalty"],x);const b=g(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const A=g(n,["responseMimeType"]);A!=null&&y(e,["responseMimeType"],A);const P=g(n,["responseModalities"]);P!=null&&y(e,["responseModalities"],P);const F=g(n,["responseSchema"]);F!=null&&y(e,["responseSchema"],F);const H=g(n,["routingConfig"]);H!=null&&y(e,["routingConfig"],H);const X=g(n,["seed"]);X!=null&&y(e,["seed"],X);const re=g(n,["speechConfig"]);re!=null&&y(e,["speechConfig"],K1(re));const Q=g(n,["stopSequences"]);Q!=null&&y(e,["stopSequences"],Q);const he=g(n,["temperature"]);he!=null&&y(e,["temperature"],he);const fe=g(n,["thinkingConfig"]);fe!=null&&y(e,["thinkingConfig"],fe);const Y=g(n,["topK"]);Y!=null&&y(e,["topK"],Y);const k=g(n,["topP"]);if(k!=null&&y(e,["topP"],k),g(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function P4(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function k4(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function D4(n,e){const t={},i=g(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const s=g(n,["responseModalities"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig","responseModalities"],s);const o=g(n,["temperature"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","temperature"],o);const l=g(n,["topP"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","topP"],l);const d=g(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const h=g(n,["maxOutputTokens"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","maxOutputTokens"],h);const p=g(n,["mediaResolution"]);e!==void 0&&p!=null&&y(e,["setup","generationConfig","mediaResolution"],p);const v=g(n,["seed"]);e!==void 0&&v!=null&&y(e,["setup","generationConfig","seed"],v);const x=g(n,["speechConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","speechConfig"],sT(x));const b=g(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const A=g(n,["enableAffectiveDialog"]);e!==void 0&&A!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],A);const P=g(n,["systemInstruction"]);e!==void 0&&P!=null&&y(e,["setup","systemInstruction"],I4(Oi(P)));const F=g(n,["tools"]);if(e!==void 0&&F!=null){let Y=xd(F);Array.isArray(Y)&&(Y=Y.map(k=>j4(Ed(k)))),y(e,["setup","tools"],Y)}const H=g(n,["sessionResumption"]);e!==void 0&&H!=null&&y(e,["setup","sessionResumption"],H4(H));const X=g(n,["inputAudioTranscription"]);e!==void 0&&X!=null&&y(e,["setup","inputAudioTranscription"],X);const re=g(n,["outputAudioTranscription"]);e!==void 0&&re!=null&&y(e,["setup","outputAudioTranscription"],re);const Q=g(n,["realtimeInputConfig"]);e!==void 0&&Q!=null&&y(e,["setup","realtimeInputConfig"],Q);const he=g(n,["contextWindowCompression"]);e!==void 0&&he!=null&&y(e,["setup","contextWindowCompression"],he);const fe=g(n,["proactivity"]);return e!==void 0&&fe!=null&&y(e,["setup","proactivity"],fe),t}function L4(n,e){const t={},i=g(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],M4(i));const s=g(n,["responseModalities"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig","responseModalities"],s);const o=g(n,["temperature"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","temperature"],o);const l=g(n,["topP"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","topP"],l);const d=g(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const h=g(n,["maxOutputTokens"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","maxOutputTokens"],h);const p=g(n,["mediaResolution"]);e!==void 0&&p!=null&&y(e,["setup","generationConfig","mediaResolution"],p);const v=g(n,["seed"]);e!==void 0&&v!=null&&y(e,["setup","generationConfig","seed"],v);const x=g(n,["speechConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","speechConfig"],K1(sT(x)));const b=g(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const A=g(n,["enableAffectiveDialog"]);e!==void 0&&A!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],A);const P=g(n,["systemInstruction"]);e!==void 0&&P!=null&&y(e,["setup","systemInstruction"],Oi(P));const F=g(n,["tools"]);if(e!==void 0&&F!=null){let Y=xd(F);Array.isArray(Y)&&(Y=Y.map(k=>K4(Ed(k)))),y(e,["setup","tools"],Y)}const H=g(n,["sessionResumption"]);e!==void 0&&H!=null&&y(e,["setup","sessionResumption"],H);const X=g(n,["inputAudioTranscription"]);e!==void 0&&X!=null&&y(e,["setup","inputAudioTranscription"],X);const re=g(n,["outputAudioTranscription"]);e!==void 0&&re!=null&&y(e,["setup","outputAudioTranscription"],re);const Q=g(n,["realtimeInputConfig"]);e!==void 0&&Q!=null&&y(e,["setup","realtimeInputConfig"],Q);const he=g(n,["contextWindowCompression"]);e!==void 0&&he!=null&&y(e,["setup","contextWindowCompression"],he);const fe=g(n,["proactivity"]);return e!==void 0&&fe!=null&&y(e,["setup","proactivity"],fe),t}function V4(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["setup","model"],Ht(n,i));const s=g(e,["config"]);return s!=null&&y(t,["config"],D4(s,t)),t}function O4(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["setup","model"],Ht(n,i));const s=g(e,["config"]);return s!=null&&y(t,["config"],L4(s,t)),t}function U4(n){const e={},t=g(n,["musicGenerationConfig"]);return t!=null&&y(e,["musicGenerationConfig"],t),e}function F4(n){const e={},t=g(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),y(e,["weightedPrompts"],i)}return e}function B4(n){const e={},t=g(n,["media"]);if(t!=null){let p=k1(t);Array.isArray(p)&&(p=p.map(v=>cp(v))),y(e,["mediaChunks"],p)}const i=g(n,["audio"]);i!=null&&y(e,["audio"],cp(L1(i)));const s=g(n,["audioStreamEnd"]);s!=null&&y(e,["audioStreamEnd"],s);const o=g(n,["video"]);o!=null&&y(e,["video"],cp(D1(o)));const l=g(n,["text"]);l!=null&&y(e,["text"],l);const d=g(n,["activityStart"]);d!=null&&y(e,["activityStart"],d);const h=g(n,["activityEnd"]);return h!=null&&y(e,["activityEnd"],h),e}function z4(n){const e={},t=g(n,["media"]);if(t!=null){let p=k1(t);Array.isArray(p)&&(p=p.map(v=>v)),y(e,["mediaChunks"],p)}const i=g(n,["audio"]);i!=null&&y(e,["audio"],L1(i));const s=g(n,["audioStreamEnd"]);s!=null&&y(e,["audioStreamEnd"],s);const o=g(n,["video"]);o!=null&&y(e,["video"],D1(o));const l=g(n,["text"]);l!=null&&y(e,["text"],l);const d=g(n,["activityStart"]);d!=null&&y(e,["activityStart"],d);const h=g(n,["activityEnd"]);return h!=null&&y(e,["activityEnd"],h),e}function q4(n){const e={},t=g(n,["setupComplete"]);t!=null&&y(e,["setupComplete"],t);const i=g(n,["serverContent"]);i!=null&&y(e,["serverContent"],i);const s=g(n,["toolCall"]);s!=null&&y(e,["toolCall"],s);const o=g(n,["toolCallCancellation"]);o!=null&&y(e,["toolCallCancellation"],o);const l=g(n,["usageMetadata"]);l!=null&&y(e,["usageMetadata"],W4(l));const d=g(n,["goAway"]);d!=null&&y(e,["goAway"],d);const h=g(n,["sessionResumptionUpdate"]);return h!=null&&y(e,["sessionResumptionUpdate"],h),e}function G4(n){const e={},t=g(n,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const i=g(n,["codeExecutionResult"]);i!=null&&y(e,["codeExecutionResult"],i);const s=g(n,["executableCode"]);s!=null&&y(e,["executableCode"],s);const o=g(n,["fileData"]);o!=null&&y(e,["fileData"],A4(o));const l=g(n,["functionCall"]);l!=null&&y(e,["functionCall"],N4(l));const d=g(n,["functionResponse"]);d!=null&&y(e,["functionResponse"],d);const h=g(n,["inlineData"]);h!=null&&y(e,["inlineData"],cp(h));const p=g(n,["text"]);p!=null&&y(e,["text"],p);const v=g(n,["thought"]);v!=null&&y(e,["thought"],v);const x=g(n,["thoughtSignature"]);x!=null&&y(e,["thoughtSignature"],x);const b=g(n,["videoMetadata"]);return b!=null&&y(e,["videoMetadata"],b),e}function H4(n){const e={},t=g(n,["handle"]);if(t!=null&&y(e,["handle"],t),g(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function K1(n){const e={},t=g(n,["languageCode"]);t!=null&&y(e,["languageCode"],t);const i=g(n,["voiceConfig"]);if(i!=null&&y(e,["voiceConfig"],i),g(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function j4(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(x=>x)),y(e,["functionDeclarations"],v)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=g(n,["googleSearchRetrieval"]);i!=null&&y(e,["googleSearchRetrieval"],i);const s=g(n,["computerUse"]);s!=null&&y(e,["computerUse"],s);const o=g(n,["fileSearch"]);o!=null&&y(e,["fileSearch"],o);const l=g(n,["codeExecution"]);if(l!=null&&y(e,["codeExecution"],l),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=g(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],P4(d));const h=g(n,["googleSearch"]);h!=null&&y(e,["googleSearch"],k4(h));const p=g(n,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}function K4(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(b=>R4(b))),y(e,["functionDeclarations"],x)}const i=g(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const s=g(n,["googleSearchRetrieval"]);s!=null&&y(e,["googleSearchRetrieval"],s);const o=g(n,["computerUse"]);if(o!=null&&y(e,["computerUse"],o),g(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=g(n,["codeExecution"]);l!=null&&y(e,["codeExecution"],l);const d=g(n,["enterpriseWebSearch"]);d!=null&&y(e,["enterpriseWebSearch"],d);const h=g(n,["googleMaps"]);h!=null&&y(e,["googleMaps"],h);const p=g(n,["googleSearch"]);p!=null&&y(e,["googleSearch"],p);const v=g(n,["urlContext"]);return v!=null&&y(e,["urlContext"],v),e}function W4(n){const e={},t=g(n,["promptTokenCount"]);t!=null&&y(e,["promptTokenCount"],t);const i=g(n,["cachedContentTokenCount"]);i!=null&&y(e,["cachedContentTokenCount"],i);const s=g(n,["candidatesTokenCount"]);s!=null&&y(e,["responseTokenCount"],s);const o=g(n,["toolUsePromptTokenCount"]);o!=null&&y(e,["toolUsePromptTokenCount"],o);const l=g(n,["thoughtsTokenCount"]);l!=null&&y(e,["thoughtsTokenCount"],l);const d=g(n,["totalTokenCount"]);d!=null&&y(e,["totalTokenCount"],d);const h=g(n,["promptTokensDetails"]);if(h!=null){let A=h;Array.isArray(A)&&(A=A.map(P=>P)),y(e,["promptTokensDetails"],A)}const p=g(n,["cacheTokensDetails"]);if(p!=null){let A=p;Array.isArray(A)&&(A=A.map(P=>P)),y(e,["cacheTokensDetails"],A)}const v=g(n,["candidatesTokensDetails"]);if(v!=null){let A=v;Array.isArray(A)&&(A=A.map(P=>P)),y(e,["responseTokensDetails"],A)}const x=g(n,["toolUsePromptTokensDetails"]);if(x!=null){let A=x;Array.isArray(A)&&(A=A.map(P=>P)),y(e,["toolUsePromptTokensDetails"],A)}const b=g(n,["trafficType"]);return b!=null&&y(e,["trafficType"],b),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Y4(n){const e={},t=g(n,["data"]);if(t!=null&&y(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function J4(n){const e={},t=g(n,["content"]);t!=null&&y(e,["content"],t);const i=g(n,["citationMetadata"]);i!=null&&y(e,["citationMetadata"],Z4(i));const s=g(n,["tokenCount"]);s!=null&&y(e,["tokenCount"],s);const o=g(n,["finishReason"]);o!=null&&y(e,["finishReason"],o);const l=g(n,["avgLogprobs"]);l!=null&&y(e,["avgLogprobs"],l);const d=g(n,["groundingMetadata"]);d!=null&&y(e,["groundingMetadata"],d);const h=g(n,["index"]);h!=null&&y(e,["index"],h);const p=g(n,["logprobsResult"]);p!=null&&y(e,["logprobsResult"],p);const v=g(n,["safetyRatings"]);if(v!=null){let b=v;Array.isArray(b)&&(b=b.map(A=>A)),y(e,["safetyRatings"],b)}const x=g(n,["urlContextMetadata"]);return x!=null&&y(e,["urlContextMetadata"],x),e}function Z4(n){const e={},t=g(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),y(e,["citations"],i)}return e}function Q4(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["contents"]);if(s!=null){let o=ur(s);Array.isArray(o)&&(o=o.map(l=>l)),y(t,["contents"],o)}return t}function $4(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["tokensInfo"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),y(e,["tokensInfo"],s)}return e}function X4(n){const e={},t=g(n,["values"]);t!=null&&y(e,["values"],t);const i=g(n,["statistics"]);return i!=null&&y(e,["statistics"],e3(i)),e}function e3(n){const e={},t=g(n,["truncated"]);t!=null&&y(e,["truncated"],t);const i=g(n,["token_count"]);return i!=null&&y(e,["tokenCount"],i),e}function Ig(n){const e={},t=g(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>uV(o))),y(e,["parts"],s)}const i=g(n,["role"]);return i!=null&&y(e,["role"],i),e}function t3(n){const e={},t=g(n,["controlType"]);t!=null&&y(e,["controlType"],t);const i=g(n,["enableControlImageComputation"]);return i!=null&&y(e,["computeControl"],i),e}function n3(n){const e={};if(g(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(g(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(g(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function i3(n,e){const t={},i=g(n,["systemInstruction"]);e!==void 0&&i!=null&&y(e,["systemInstruction"],Oi(i));const s=g(n,["tools"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(d=>Q1(d))),y(e,["tools"],l)}const o=g(n,["generationConfig"]);return e!==void 0&&o!=null&&y(e,["generationConfig"],Y3(o)),t}function s3(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["contents"]);if(s!=null){let l=ur(s);Array.isArray(l)&&(l=l.map(d=>Ig(d))),y(t,["contents"],l)}const o=g(e,["config"]);return o!=null&&n3(o),t}function r3(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["contents"]);if(s!=null){let l=ur(s);Array.isArray(l)&&(l=l.map(d=>d)),y(t,["contents"],l)}const o=g(e,["config"]);return o!=null&&i3(o,t),t}function o3(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["totalTokens"]);i!=null&&y(e,["totalTokens"],i);const s=g(n,["cachedContentTokenCount"]);return s!=null&&y(e,["cachedContentTokenCount"],s),e}function a3(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["totalTokens"]);return i!=null&&y(e,["totalTokens"],i),e}function l3(n,e){const t={},i=g(e,["model"]);return i!=null&&y(t,["_url","name"],Ht(n,i)),t}function u3(n,e){const t={},i=g(e,["model"]);return i!=null&&y(t,["_url","name"],Ht(n,i)),t}function c3(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function d3(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}function h3(n,e){const t={},i=g(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const s=g(n,["negativePrompt"]);e!==void 0&&s!=null&&y(e,["parameters","negativePrompt"],s);const o=g(n,["numberOfImages"]);e!==void 0&&o!=null&&y(e,["parameters","sampleCount"],o);const l=g(n,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const d=g(n,["guidanceScale"]);e!==void 0&&d!=null&&y(e,["parameters","guidanceScale"],d);const h=g(n,["seed"]);e!==void 0&&h!=null&&y(e,["parameters","seed"],h);const p=g(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&y(e,["parameters","safetySetting"],p);const v=g(n,["personGeneration"]);e!==void 0&&v!=null&&y(e,["parameters","personGeneration"],v);const x=g(n,["includeSafetyAttributes"]);e!==void 0&&x!=null&&y(e,["parameters","includeSafetyAttributes"],x);const b=g(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const A=g(n,["language"]);e!==void 0&&A!=null&&y(e,["parameters","language"],A);const P=g(n,["outputMimeType"]);e!==void 0&&P!=null&&y(e,["parameters","outputOptions","mimeType"],P);const F=g(n,["outputCompressionQuality"]);e!==void 0&&F!=null&&y(e,["parameters","outputOptions","compressionQuality"],F);const H=g(n,["addWatermark"]);e!==void 0&&H!=null&&y(e,["parameters","addWatermark"],H);const X=g(n,["labels"]);e!==void 0&&X!=null&&y(e,["labels"],X);const re=g(n,["editMode"]);e!==void 0&&re!=null&&y(e,["parameters","editMode"],re);const Q=g(n,["baseSteps"]);return e!==void 0&&Q!=null&&y(e,["parameters","editConfig","baseSteps"],Q),t}function f3(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["prompt"]);s!=null&&y(t,["instances[0]","prompt"],s);const o=g(e,["referenceImages"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(h=>pV(h))),y(t,["instances[0]","referenceImages"],d)}const l=g(e,["config"]);return l!=null&&h3(l,t),t}function m3(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Ag(o))),y(e,["generatedImages"],s)}return e}function p3(n,e){const t={},i=g(n,["taskType"]);e!==void 0&&i!=null&&y(e,["requests[]","taskType"],i);const s=g(n,["title"]);e!==void 0&&s!=null&&y(e,["requests[]","title"],s);const o=g(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&y(e,["requests[]","outputDimensionality"],o),g(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function g3(n,e){const t={},i=g(n,["taskType"]);e!==void 0&&i!=null&&y(e,["instances[]","task_type"],i);const s=g(n,["title"]);e!==void 0&&s!=null&&y(e,["instances[]","title"],s);const o=g(n,["outputDimensionality"]);e!==void 0&&o!=null&&y(e,["parameters","outputDimensionality"],o);const l=g(n,["mimeType"]);e!==void 0&&l!=null&&y(e,["instances[]","mimeType"],l);const d=g(n,["autoTruncate"]);return e!==void 0&&d!=null&&y(e,["parameters","autoTruncate"],d),t}function _3(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["contents"]);if(s!=null){let d=tT(n,s);Array.isArray(d)&&(d=d.map(h=>h)),y(t,["requests[]","content"],d)}const o=g(e,["config"]);o!=null&&p3(o,t);const l=g(e,["model"]);return l!==void 0&&y(t,["requests[]","model"],Ht(n,l)),t}function y3(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["contents"]);if(s!=null){let l=tT(n,s);Array.isArray(l)&&(l=l.map(d=>d)),y(t,["instances[]","content"],l)}const o=g(e,["config"]);return o!=null&&g3(o,t),t}function v3(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["embeddings"],o)}const s=g(n,["metadata"]);return s!=null&&y(e,["metadata"],s),e}function T3(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["predictions[]","embeddings"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>X4(l))),y(e,["embeddings"],o)}const s=g(n,["metadata"]);return s!=null&&y(e,["metadata"],s),e}function E3(n){const e={},t=g(n,["endpoint"]);t!=null&&y(e,["name"],t);const i=g(n,["deployedModelId"]);return i!=null&&y(e,["deployedModelId"],i),e}function x3(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function w3(n){const e={},t=g(n,["id"]);t!=null&&y(e,["id"],t);const i=g(n,["args"]);i!=null&&y(e,["args"],i);const s=g(n,["name"]);if(s!=null&&y(e,["name"],s),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function S3(n){const e={},t=g(n,["mode"]);t!=null&&y(e,["mode"],t);const i=g(n,["allowedFunctionNames"]);if(i!=null&&y(e,["allowedFunctionNames"],i),g(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function b3(n){const e={};if(g(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=g(n,["description"]);t!=null&&y(e,["description"],t);const i=g(n,["name"]);i!=null&&y(e,["name"],i);const s=g(n,["parameters"]);s!=null&&y(e,["parameters"],s);const o=g(n,["parametersJsonSchema"]);o!=null&&y(e,["parametersJsonSchema"],o);const l=g(n,["response"]);l!=null&&y(e,["response"],l);const d=g(n,["responseJsonSchema"]);return d!=null&&y(e,["responseJsonSchema"],d),e}function C3(n,e,t){const i={},s=g(e,["systemInstruction"]);t!==void 0&&s!=null&&y(t,["systemInstruction"],Ig(Oi(s)));const o=g(e,["temperature"]);o!=null&&y(i,["temperature"],o);const l=g(e,["topP"]);l!=null&&y(i,["topP"],l);const d=g(e,["topK"]);d!=null&&y(i,["topK"],d);const h=g(e,["candidateCount"]);h!=null&&y(i,["candidateCount"],h);const p=g(e,["maxOutputTokens"]);p!=null&&y(i,["maxOutputTokens"],p);const v=g(e,["stopSequences"]);v!=null&&y(i,["stopSequences"],v);const x=g(e,["responseLogprobs"]);x!=null&&y(i,["responseLogprobs"],x);const b=g(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const A=g(e,["presencePenalty"]);A!=null&&y(i,["presencePenalty"],A);const P=g(e,["frequencyPenalty"]);P!=null&&y(i,["frequencyPenalty"],P);const F=g(e,["seed"]);F!=null&&y(i,["seed"],F);const H=g(e,["responseMimeType"]);H!=null&&y(i,["responseMimeType"],H);const X=g(e,["responseSchema"]);X!=null&&y(i,["responseSchema"],nT(X));const re=g(e,["responseJsonSchema"]);if(re!=null&&y(i,["responseJsonSchema"],re),g(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const Q=g(e,["safetySettings"]);if(t!==void 0&&Q!=null){let W=Q;Array.isArray(W)&&(W=W.map(z=>gV(z))),y(t,["safetySettings"],W)}const he=g(e,["tools"]);if(t!==void 0&&he!=null){let W=xd(he);Array.isArray(W)&&(W=W.map(z=>wV(Ed(z)))),y(t,["tools"],W)}const fe=g(e,["toolConfig"]);if(t!==void 0&&fe!=null&&y(t,["toolConfig"],xV(fe)),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const Y=g(e,["cachedContent"]);t!==void 0&&Y!=null&&y(t,["cachedContent"],ea(n,Y));const k=g(e,["responseModalities"]);k!=null&&y(i,["responseModalities"],k);const B=g(e,["mediaResolution"]);B!=null&&y(i,["mediaResolution"],B);const O=g(e,["speechConfig"]);if(O!=null&&y(i,["speechConfig"],iT(O)),g(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const q=g(e,["thinkingConfig"]);q!=null&&y(i,["thinkingConfig"],q);const G=g(e,["imageConfig"]);return G!=null&&y(i,["imageConfig"],X3(G)),i}function I3(n,e,t){const i={},s=g(e,["systemInstruction"]);t!==void 0&&s!=null&&y(t,["systemInstruction"],Oi(s));const o=g(e,["temperature"]);o!=null&&y(i,["temperature"],o);const l=g(e,["topP"]);l!=null&&y(i,["topP"],l);const d=g(e,["topK"]);d!=null&&y(i,["topK"],d);const h=g(e,["candidateCount"]);h!=null&&y(i,["candidateCount"],h);const p=g(e,["maxOutputTokens"]);p!=null&&y(i,["maxOutputTokens"],p);const v=g(e,["stopSequences"]);v!=null&&y(i,["stopSequences"],v);const x=g(e,["responseLogprobs"]);x!=null&&y(i,["responseLogprobs"],x);const b=g(e,["logprobs"]);b!=null&&y(i,["logprobs"],b);const A=g(e,["presencePenalty"]);A!=null&&y(i,["presencePenalty"],A);const P=g(e,["frequencyPenalty"]);P!=null&&y(i,["frequencyPenalty"],P);const F=g(e,["seed"]);F!=null&&y(i,["seed"],F);const H=g(e,["responseMimeType"]);H!=null&&y(i,["responseMimeType"],H);const X=g(e,["responseSchema"]);X!=null&&y(i,["responseSchema"],nT(X));const re=g(e,["responseJsonSchema"]);re!=null&&y(i,["responseJsonSchema"],re);const Q=g(e,["routingConfig"]);Q!=null&&y(i,["routingConfig"],Q);const he=g(e,["modelSelectionConfig"]);he!=null&&y(i,["modelConfig"],he);const fe=g(e,["safetySettings"]);if(t!==void 0&&fe!=null){let se=fe;Array.isArray(se)&&(se=se.map(Se=>Se)),y(t,["safetySettings"],se)}const Y=g(e,["tools"]);if(t!==void 0&&Y!=null){let se=xd(Y);Array.isArray(se)&&(se=se.map(Se=>Q1(Ed(Se)))),y(t,["tools"],se)}const k=g(e,["toolConfig"]);t!==void 0&&k!=null&&y(t,["toolConfig"],k);const B=g(e,["labels"]);t!==void 0&&B!=null&&y(t,["labels"],B);const O=g(e,["cachedContent"]);t!==void 0&&O!=null&&y(t,["cachedContent"],ea(n,O));const q=g(e,["responseModalities"]);q!=null&&y(i,["responseModalities"],q);const G=g(e,["mediaResolution"]);G!=null&&y(i,["mediaResolution"],G);const W=g(e,["speechConfig"]);W!=null&&y(i,["speechConfig"],Z1(iT(W)));const z=g(e,["audioTimestamp"]);z!=null&&y(i,["audioTimestamp"],z);const He=g(e,["thinkingConfig"]);He!=null&&y(i,["thinkingConfig"],He);const Qe=g(e,["imageConfig"]);return Qe!=null&&y(i,["imageConfig"],eV(Qe)),i}function wC(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["contents"]);if(s!=null){let l=ur(s);Array.isArray(l)&&(l=l.map(d=>Ig(d))),y(t,["contents"],l)}const o=g(e,["config"]);return o!=null&&y(t,["generationConfig"],C3(n,o,t)),t}function SC(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["contents"]);if(s!=null){let l=ur(s);Array.isArray(l)&&(l=l.map(d=>d)),y(t,["contents"],l)}const o=g(e,["config"]);return o!=null&&y(t,["generationConfig"],I3(n,o,t)),t}function bC(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["candidates"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(p=>J4(p))),y(e,["candidates"],h)}const s=g(n,["modelVersion"]);s!=null&&y(e,["modelVersion"],s);const o=g(n,["promptFeedback"]);o!=null&&y(e,["promptFeedback"],o);const l=g(n,["responseId"]);l!=null&&y(e,["responseId"],l);const d=g(n,["usageMetadata"]);return d!=null&&y(e,["usageMetadata"],d),e}function CC(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(v=>v)),y(e,["candidates"],p)}const s=g(n,["createTime"]);s!=null&&y(e,["createTime"],s);const o=g(n,["modelVersion"]);o!=null&&y(e,["modelVersion"],o);const l=g(n,["promptFeedback"]);l!=null&&y(e,["promptFeedback"],l);const d=g(n,["responseId"]);d!=null&&y(e,["responseId"],d);const h=g(n,["usageMetadata"]);return h!=null&&y(e,["usageMetadata"],h),e}function A3(n,e){const t={};if(g(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=g(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const s=g(n,["aspectRatio"]);e!==void 0&&s!=null&&y(e,["parameters","aspectRatio"],s);const o=g(n,["guidanceScale"]);if(e!==void 0&&o!=null&&y(e,["parameters","guidanceScale"],o),g(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=g(n,["safetyFilterLevel"]);e!==void 0&&l!=null&&y(e,["parameters","safetySetting"],l);const d=g(n,["personGeneration"]);e!==void 0&&d!=null&&y(e,["parameters","personGeneration"],d);const h=g(n,["includeSafetyAttributes"]);e!==void 0&&h!=null&&y(e,["parameters","includeSafetyAttributes"],h);const p=g(n,["includeRaiReason"]);e!==void 0&&p!=null&&y(e,["parameters","includeRaiReason"],p);const v=g(n,["language"]);e!==void 0&&v!=null&&y(e,["parameters","language"],v);const x=g(n,["outputMimeType"]);e!==void 0&&x!=null&&y(e,["parameters","outputOptions","mimeType"],x);const b=g(n,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&y(e,["parameters","outputOptions","compressionQuality"],b),g(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(g(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=g(n,["imageSize"]);if(e!==void 0&&A!=null&&y(e,["parameters","sampleImageSize"],A),g(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function N3(n,e){const t={},i=g(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const s=g(n,["negativePrompt"]);e!==void 0&&s!=null&&y(e,["parameters","negativePrompt"],s);const o=g(n,["numberOfImages"]);e!==void 0&&o!=null&&y(e,["parameters","sampleCount"],o);const l=g(n,["aspectRatio"]);e!==void 0&&l!=null&&y(e,["parameters","aspectRatio"],l);const d=g(n,["guidanceScale"]);e!==void 0&&d!=null&&y(e,["parameters","guidanceScale"],d);const h=g(n,["seed"]);e!==void 0&&h!=null&&y(e,["parameters","seed"],h);const p=g(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&y(e,["parameters","safetySetting"],p);const v=g(n,["personGeneration"]);e!==void 0&&v!=null&&y(e,["parameters","personGeneration"],v);const x=g(n,["includeSafetyAttributes"]);e!==void 0&&x!=null&&y(e,["parameters","includeSafetyAttributes"],x);const b=g(n,["includeRaiReason"]);e!==void 0&&b!=null&&y(e,["parameters","includeRaiReason"],b);const A=g(n,["language"]);e!==void 0&&A!=null&&y(e,["parameters","language"],A);const P=g(n,["outputMimeType"]);e!==void 0&&P!=null&&y(e,["parameters","outputOptions","mimeType"],P);const F=g(n,["outputCompressionQuality"]);e!==void 0&&F!=null&&y(e,["parameters","outputOptions","compressionQuality"],F);const H=g(n,["addWatermark"]);e!==void 0&&H!=null&&y(e,["parameters","addWatermark"],H);const X=g(n,["labels"]);e!==void 0&&X!=null&&y(e,["labels"],X);const re=g(n,["imageSize"]);e!==void 0&&re!=null&&y(e,["parameters","sampleImageSize"],re);const Q=g(n,["enhancePrompt"]);return e!==void 0&&Q!=null&&y(e,["parameters","enhancePrompt"],Q),t}function R3(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["prompt"]);s!=null&&y(t,["instances[0]","prompt"],s);const o=g(e,["config"]);return o!=null&&A3(o,t),t}function M3(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["prompt"]);s!=null&&y(t,["instances[0]","prompt"],s);const o=g(e,["config"]);return o!=null&&N3(o,t),t}function P3(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>H3(l))),y(e,["generatedImages"],o)}const s=g(n,["positivePromptSafetyAttributes"]);return s!=null&&y(e,["positivePromptSafetyAttributes"],Y1(s)),e}function k3(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>Ag(l))),y(e,["generatedImages"],o)}const s=g(n,["positivePromptSafetyAttributes"]);return s!=null&&y(e,["positivePromptSafetyAttributes"],J1(s)),e}function D3(n,e){const t={},i=g(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i),g(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=g(n,["durationSeconds"]);if(e!==void 0&&s!=null&&y(e,["parameters","durationSeconds"],s),g(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=g(n,["aspectRatio"]);e!==void 0&&o!=null&&y(e,["parameters","aspectRatio"],o);const l=g(n,["resolution"]);e!==void 0&&l!=null&&y(e,["parameters","resolution"],l);const d=g(n,["personGeneration"]);if(e!==void 0&&d!=null&&y(e,["parameters","personGeneration"],d),g(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=g(n,["negativePrompt"]);e!==void 0&&h!=null&&y(e,["parameters","negativePrompt"],h);const p=g(n,["enhancePrompt"]);if(e!==void 0&&p!=null&&y(e,["parameters","enhancePrompt"],p),g(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const v=g(n,["lastFrame"]);e!==void 0&&v!=null&&y(e,["instances[0]","lastFrame"],Ng(v));const x=g(n,["referenceImages"]);if(e!==void 0&&x!=null){let b=x;Array.isArray(b)&&(b=b.map(A=>VV(A))),y(e,["instances[0]","referenceImages"],b)}if(g(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(g(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function L3(n,e){const t={},i=g(n,["numberOfVideos"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const s=g(n,["outputGcsUri"]);e!==void 0&&s!=null&&y(e,["parameters","storageUri"],s);const o=g(n,["fps"]);e!==void 0&&o!=null&&y(e,["parameters","fps"],o);const l=g(n,["durationSeconds"]);e!==void 0&&l!=null&&y(e,["parameters","durationSeconds"],l);const d=g(n,["seed"]);e!==void 0&&d!=null&&y(e,["parameters","seed"],d);const h=g(n,["aspectRatio"]);e!==void 0&&h!=null&&y(e,["parameters","aspectRatio"],h);const p=g(n,["resolution"]);e!==void 0&&p!=null&&y(e,["parameters","resolution"],p);const v=g(n,["personGeneration"]);e!==void 0&&v!=null&&y(e,["parameters","personGeneration"],v);const x=g(n,["pubsubTopic"]);e!==void 0&&x!=null&&y(e,["parameters","pubsubTopic"],x);const b=g(n,["negativePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","negativePrompt"],b);const A=g(n,["enhancePrompt"]);e!==void 0&&A!=null&&y(e,["parameters","enhancePrompt"],A);const P=g(n,["generateAudio"]);e!==void 0&&P!=null&&y(e,["parameters","generateAudio"],P);const F=g(n,["lastFrame"]);e!==void 0&&F!=null&&y(e,["instances[0]","lastFrame"],kr(F));const H=g(n,["referenceImages"]);if(e!==void 0&&H!=null){let Q=H;Array.isArray(Q)&&(Q=Q.map(he=>OV(he))),y(e,["instances[0]","referenceImages"],Q)}const X=g(n,["mask"]);e!==void 0&&X!=null&&y(e,["instances[0]","mask"],LV(X));const re=g(n,["compressionQuality"]);return e!==void 0&&re!=null&&y(e,["parameters","compressionQuality"],re),t}function V3(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["metadata"]);i!=null&&y(e,["metadata"],i);const s=g(n,["done"]);s!=null&&y(e,["done"],s);const o=g(n,["error"]);o!=null&&y(e,["error"],o);const l=g(n,["response","generateVideoResponse"]);return l!=null&&y(e,["response"],B3(l)),e}function O3(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["metadata"]);i!=null&&y(e,["metadata"],i);const s=g(n,["done"]);s!=null&&y(e,["done"],s);const o=g(n,["error"]);o!=null&&y(e,["error"],o);const l=g(n,["response"]);return l!=null&&y(e,["response"],z3(l)),e}function U3(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["prompt"]);s!=null&&y(t,["instances[0]","prompt"],s);const o=g(e,["image"]);o!=null&&y(t,["instances[0]","image"],Ng(o));const l=g(e,["video"]);l!=null&&y(t,["instances[0]","video"],$1(l));const d=g(e,["source"]);d!=null&&q3(d,t);const h=g(e,["config"]);return h!=null&&D3(h,t),t}function F3(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["prompt"]);s!=null&&y(t,["instances[0]","prompt"],s);const o=g(e,["image"]);o!=null&&y(t,["instances[0]","image"],kr(o));const l=g(e,["video"]);l!=null&&y(t,["instances[0]","video"],X1(l));const d=g(e,["source"]);d!=null&&G3(d,t);const h=g(e,["config"]);return h!=null&&L3(h,t),t}function B3(n){const e={},t=g(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>K3(l))),y(e,["generatedVideos"],o)}const i=g(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const s=g(n,["raiMediaFilteredReasons"]);return s!=null&&y(e,["raiMediaFilteredReasons"],s),e}function z3(n){const e={},t=g(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(l=>W3(l))),y(e,["generatedVideos"],o)}const i=g(n,["raiMediaFilteredCount"]);i!=null&&y(e,["raiMediaFilteredCount"],i);const s=g(n,["raiMediaFilteredReasons"]);return s!=null&&y(e,["raiMediaFilteredReasons"],s),e}function q3(n,e){const t={},i=g(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const s=g(n,["image"]);e!==void 0&&s!=null&&y(e,["instances[0]","image"],Ng(s));const o=g(n,["video"]);return e!==void 0&&o!=null&&y(e,["instances[0]","video"],$1(o)),t}function G3(n,e){const t={},i=g(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const s=g(n,["image"]);e!==void 0&&s!=null&&y(e,["instances[0]","image"],kr(s));const o=g(n,["video"]);return e!==void 0&&o!=null&&y(e,["instances[0]","video"],X1(o)),t}function H3(n){const e={},t=g(n,["_self"]);t!=null&&y(e,["image"],tV(t));const i=g(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const s=g(n,["_self"]);return s!=null&&y(e,["safetyAttributes"],Y1(s)),e}function Ag(n){const e={},t=g(n,["_self"]);t!=null&&y(e,["image"],W1(t));const i=g(n,["raiFilteredReason"]);i!=null&&y(e,["raiFilteredReason"],i);const s=g(n,["_self"]);s!=null&&y(e,["safetyAttributes"],J1(s));const o=g(n,["prompt"]);return o!=null&&y(e,["enhancedPrompt"],o),e}function j3(n){const e={},t=g(n,["_self"]);t!=null&&y(e,["mask"],W1(t));const i=g(n,["labels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),y(e,["labels"],s)}return e}function K3(n){const e={},t=g(n,["video"]);return t!=null&&y(e,["video"],kV(t)),e}function W3(n){const e={},t=g(n,["_self"]);return t!=null&&y(e,["video"],DV(t)),e}function Y3(n){const e={},t=g(n,["modelSelectionConfig"]);t!=null&&y(e,["modelConfig"],t);const i=g(n,["responseJsonSchema"]);i!=null&&y(e,["responseJsonSchema"],i);const s=g(n,["audioTimestamp"]);s!=null&&y(e,["audioTimestamp"],s);const o=g(n,["candidateCount"]);o!=null&&y(e,["candidateCount"],o);const l=g(n,["enableAffectiveDialog"]);l!=null&&y(e,["enableAffectiveDialog"],l);const d=g(n,["frequencyPenalty"]);d!=null&&y(e,["frequencyPenalty"],d);const h=g(n,["logprobs"]);h!=null&&y(e,["logprobs"],h);const p=g(n,["maxOutputTokens"]);p!=null&&y(e,["maxOutputTokens"],p);const v=g(n,["mediaResolution"]);v!=null&&y(e,["mediaResolution"],v);const x=g(n,["presencePenalty"]);x!=null&&y(e,["presencePenalty"],x);const b=g(n,["responseLogprobs"]);b!=null&&y(e,["responseLogprobs"],b);const A=g(n,["responseMimeType"]);A!=null&&y(e,["responseMimeType"],A);const P=g(n,["responseModalities"]);P!=null&&y(e,["responseModalities"],P);const F=g(n,["responseSchema"]);F!=null&&y(e,["responseSchema"],F);const H=g(n,["routingConfig"]);H!=null&&y(e,["routingConfig"],H);const X=g(n,["seed"]);X!=null&&y(e,["seed"],X);const re=g(n,["speechConfig"]);re!=null&&y(e,["speechConfig"],Z1(re));const Q=g(n,["stopSequences"]);Q!=null&&y(e,["stopSequences"],Q);const he=g(n,["temperature"]);he!=null&&y(e,["temperature"],he);const fe=g(n,["thinkingConfig"]);fe!=null&&y(e,["thinkingConfig"],fe);const Y=g(n,["topK"]);Y!=null&&y(e,["topK"],Y);const k=g(n,["topP"]);if(k!=null&&y(e,["topP"],k),g(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function J3(n,e){const t={},i=g(e,["model"]);return i!=null&&y(t,["_url","name"],Ht(n,i)),t}function Z3(n,e){const t={},i=g(e,["model"]);return i!=null&&y(t,["_url","name"],Ht(n,i)),t}function Q3(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function $3(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function X3(n){const e={},t=g(n,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const i=g(n,["imageSize"]);if(i!=null&&y(e,["imageSize"],i),g(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function eV(n){const e={},t=g(n,["aspectRatio"]);t!=null&&y(e,["aspectRatio"],t);const i=g(n,["imageSize"]);i!=null&&y(e,["imageSize"],i);const s=g(n,["outputMimeType"]);s!=null&&y(e,["imageOutputOptions","mimeType"],s);const o=g(n,["outputCompressionQuality"]);return o!=null&&y(e,["imageOutputOptions","compressionQuality"],o),e}function tV(n){const e={},t=g(n,["bytesBase64Encoded"]);t!=null&&y(e,["imageBytes"],ml(t));const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function W1(n){const e={},t=g(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=g(n,["bytesBase64Encoded"]);i!=null&&y(e,["imageBytes"],ml(i));const s=g(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function Ng(n){const e={};if(g(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=g(n,["imageBytes"]);t!=null&&y(e,["bytesBase64Encoded"],ml(t));const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function kr(n){const e={},t=g(n,["gcsUri"]);t!=null&&y(e,["gcsUri"],t);const i=g(n,["imageBytes"]);i!=null&&y(e,["bytesBase64Encoded"],ml(i));const s=g(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function nV(n,e,t){const i={},s=g(e,["pageSize"]);t!==void 0&&s!=null&&y(t,["_query","pageSize"],s);const o=g(e,["pageToken"]);t!==void 0&&o!=null&&y(t,["_query","pageToken"],o);const l=g(e,["filter"]);t!==void 0&&l!=null&&y(t,["_query","filter"],l);const d=g(e,["queryBase"]);return t!==void 0&&d!=null&&y(t,["_url","models_url"],F1(n,d)),i}function iV(n,e,t){const i={},s=g(e,["pageSize"]);t!==void 0&&s!=null&&y(t,["_query","pageSize"],s);const o=g(e,["pageToken"]);t!==void 0&&o!=null&&y(t,["_query","pageToken"],o);const l=g(e,["filter"]);t!==void 0&&l!=null&&y(t,["_query","filter"],l);const d=g(e,["queryBase"]);return t!==void 0&&d!=null&&y(t,["_url","models_url"],F1(n,d)),i}function sV(n,e){const t={},i=g(e,["config"]);return i!=null&&nV(n,i,t),t}function rV(n,e){const t={},i=g(e,["config"]);return i!=null&&iV(n,i,t),t}function oV(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const s=g(n,["_self"]);if(s!=null){let o=B1(s);Array.isArray(o)&&(o=o.map(l=>Hv(l))),y(e,["models"],o)}return e}function aV(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const s=g(n,["_self"]);if(s!=null){let o=B1(s);Array.isArray(o)&&(o=o.map(l=>jv(l))),y(e,["models"],o)}return e}function lV(n){const e={},t=g(n,["maskMode"]);t!=null&&y(e,["maskMode"],t);const i=g(n,["segmentationClasses"]);i!=null&&y(e,["maskClasses"],i);const s=g(n,["maskDilation"]);return s!=null&&y(e,["dilation"],s),e}function Hv(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["displayName"]);i!=null&&y(e,["displayName"],i);const s=g(n,["description"]);s!=null&&y(e,["description"],s);const o=g(n,["version"]);o!=null&&y(e,["version"],o);const l=g(n,["_self"]);l!=null&&y(e,["tunedModelInfo"],SV(l));const d=g(n,["inputTokenLimit"]);d!=null&&y(e,["inputTokenLimit"],d);const h=g(n,["outputTokenLimit"]);h!=null&&y(e,["outputTokenLimit"],h);const p=g(n,["supportedGenerationMethods"]);p!=null&&y(e,["supportedActions"],p);const v=g(n,["temperature"]);v!=null&&y(e,["temperature"],v);const x=g(n,["maxTemperature"]);x!=null&&y(e,["maxTemperature"],x);const b=g(n,["topP"]);b!=null&&y(e,["topP"],b);const A=g(n,["topK"]);A!=null&&y(e,["topK"],A);const P=g(n,["thinking"]);return P!=null&&y(e,["thinking"],P),e}function jv(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["displayName"]);i!=null&&y(e,["displayName"],i);const s=g(n,["description"]);s!=null&&y(e,["description"],s);const o=g(n,["versionId"]);o!=null&&y(e,["version"],o);const l=g(n,["deployedModels"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(b=>E3(b))),y(e,["endpoints"],x)}const d=g(n,["labels"]);d!=null&&y(e,["labels"],d);const h=g(n,["_self"]);h!=null&&y(e,["tunedModelInfo"],bV(h));const p=g(n,["defaultCheckpointId"]);p!=null&&y(e,["defaultCheckpointId"],p);const v=g(n,["checkpoints"]);if(v!=null){let x=v;Array.isArray(x)&&(x=x.map(b=>b)),y(e,["checkpoints"],x)}return e}function uV(n){const e={},t=g(n,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const i=g(n,["codeExecutionResult"]);i!=null&&y(e,["codeExecutionResult"],i);const s=g(n,["executableCode"]);s!=null&&y(e,["executableCode"],s);const o=g(n,["fileData"]);o!=null&&y(e,["fileData"],x3(o));const l=g(n,["functionCall"]);l!=null&&y(e,["functionCall"],w3(l));const d=g(n,["functionResponse"]);d!=null&&y(e,["functionResponse"],d);const h=g(n,["inlineData"]);h!=null&&y(e,["inlineData"],Y4(h));const p=g(n,["text"]);p!=null&&y(e,["text"],p);const v=g(n,["thought"]);v!=null&&y(e,["thought"],v);const x=g(n,["thoughtSignature"]);x!=null&&y(e,["thoughtSignature"],x);const b=g(n,["videoMetadata"]);return b!=null&&y(e,["videoMetadata"],b),e}function cV(n){const e={},t=g(n,["productImage"]);return t!=null&&y(e,["image"],kr(t)),e}function dV(n,e){const t={},i=g(n,["numberOfImages"]);e!==void 0&&i!=null&&y(e,["parameters","sampleCount"],i);const s=g(n,["baseSteps"]);e!==void 0&&s!=null&&y(e,["parameters","baseSteps"],s);const o=g(n,["outputGcsUri"]);e!==void 0&&o!=null&&y(e,["parameters","storageUri"],o);const l=g(n,["seed"]);e!==void 0&&l!=null&&y(e,["parameters","seed"],l);const d=g(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&y(e,["parameters","safetySetting"],d);const h=g(n,["personGeneration"]);e!==void 0&&h!=null&&y(e,["parameters","personGeneration"],h);const p=g(n,["addWatermark"]);e!==void 0&&p!=null&&y(e,["parameters","addWatermark"],p);const v=g(n,["outputMimeType"]);e!==void 0&&v!=null&&y(e,["parameters","outputOptions","mimeType"],v);const x=g(n,["outputCompressionQuality"]);e!==void 0&&x!=null&&y(e,["parameters","outputOptions","compressionQuality"],x);const b=g(n,["enhancePrompt"]);e!==void 0&&b!=null&&y(e,["parameters","enhancePrompt"],b);const A=g(n,["labels"]);return e!==void 0&&A!=null&&y(e,["labels"],A),t}function hV(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["source"]);s!=null&&mV(s,t);const o=g(e,["config"]);return o!=null&&dV(o,t),t}function fV(n){const e={},t=g(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>Ag(s))),y(e,["generatedImages"],i)}return e}function mV(n,e){const t={},i=g(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const s=g(n,["personImage"]);e!==void 0&&s!=null&&y(e,["instances[0]","personImage","image"],kr(s));const o=g(n,["productImages"]);if(e!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(d=>cV(d))),y(e,["instances[0]","productImages"],l)}return t}function pV(n){const e={},t=g(n,["referenceImage"]);t!=null&&y(e,["referenceImage"],kr(t));const i=g(n,["referenceId"]);i!=null&&y(e,["referenceId"],i);const s=g(n,["referenceType"]);s!=null&&y(e,["referenceType"],s);const o=g(n,["maskImageConfig"]);o!=null&&y(e,["maskImageConfig"],lV(o));const l=g(n,["controlImageConfig"]);l!=null&&y(e,["controlImageConfig"],t3(l));const d=g(n,["styleImageConfig"]);d!=null&&y(e,["styleImageConfig"],d);const h=g(n,["subjectImageConfig"]);return h!=null&&y(e,["subjectImageConfig"],h),e}function Y1(n){const e={},t=g(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=g(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const s=g(n,["contentType"]);return s!=null&&y(e,["contentType"],s),e}function J1(n){const e={},t=g(n,["safetyAttributes","categories"]);t!=null&&y(e,["categories"],t);const i=g(n,["safetyAttributes","scores"]);i!=null&&y(e,["scores"],i);const s=g(n,["contentType"]);return s!=null&&y(e,["contentType"],s),e}function gV(n){const e={},t=g(n,["category"]);if(t!=null&&y(e,["category"],t),g(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=g(n,["threshold"]);return i!=null&&y(e,["threshold"],i),e}function _V(n){const e={},t=g(n,["image"]);return t!=null&&y(e,["image"],kr(t)),e}function yV(n,e){const t={},i=g(n,["mode"]);e!==void 0&&i!=null&&y(e,["parameters","mode"],i);const s=g(n,["maxPredictions"]);e!==void 0&&s!=null&&y(e,["parameters","maxPredictions"],s);const o=g(n,["confidenceThreshold"]);e!==void 0&&o!=null&&y(e,["parameters","confidenceThreshold"],o);const l=g(n,["maskDilation"]);e!==void 0&&l!=null&&y(e,["parameters","maskDilation"],l);const d=g(n,["binaryColorThreshold"]);e!==void 0&&d!=null&&y(e,["parameters","binaryColorThreshold"],d);const h=g(n,["labels"]);return e!==void 0&&h!=null&&y(e,["labels"],h),t}function vV(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["source"]);s!=null&&EV(s,t);const o=g(e,["config"]);return o!=null&&yV(o,t),t}function TV(n){const e={},t=g(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>j3(s))),y(e,["generatedMasks"],i)}return e}function EV(n,e){const t={},i=g(n,["prompt"]);e!==void 0&&i!=null&&y(e,["instances[0]","prompt"],i);const s=g(n,["image"]);e!==void 0&&s!=null&&y(e,["instances[0]","image"],kr(s));const o=g(n,["scribbleImage"]);return e!==void 0&&o!=null&&y(e,["instances[0]","scribble"],_V(o)),t}function Z1(n){const e={},t=g(n,["languageCode"]);t!=null&&y(e,["languageCode"],t);const i=g(n,["voiceConfig"]);if(i!=null&&y(e,["voiceConfig"],i),g(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function xV(n){const e={},t=g(n,["functionCallingConfig"]);t!=null&&y(e,["functionCallingConfig"],S3(t));const i=g(n,["retrievalConfig"]);return i!=null&&y(e,["retrievalConfig"],i),e}function wV(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(x=>x)),y(e,["functionDeclarations"],v)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=g(n,["googleSearchRetrieval"]);i!=null&&y(e,["googleSearchRetrieval"],i);const s=g(n,["computerUse"]);s!=null&&y(e,["computerUse"],s);const o=g(n,["fileSearch"]);o!=null&&y(e,["fileSearch"],o);const l=g(n,["codeExecution"]);if(l!=null&&y(e,["codeExecution"],l),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=g(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],Q3(d));const h=g(n,["googleSearch"]);h!=null&&y(e,["googleSearch"],$3(h));const p=g(n,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}function Q1(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(b=>b3(b))),y(e,["functionDeclarations"],x)}const i=g(n,["retrieval"]);i!=null&&y(e,["retrieval"],i);const s=g(n,["googleSearchRetrieval"]);s!=null&&y(e,["googleSearchRetrieval"],s);const o=g(n,["computerUse"]);if(o!=null&&y(e,["computerUse"],o),g(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=g(n,["codeExecution"]);l!=null&&y(e,["codeExecution"],l);const d=g(n,["enterpriseWebSearch"]);d!=null&&y(e,["enterpriseWebSearch"],d);const h=g(n,["googleMaps"]);h!=null&&y(e,["googleMaps"],h);const p=g(n,["googleSearch"]);p!=null&&y(e,["googleSearch"],p);const v=g(n,["urlContext"]);return v!=null&&y(e,["urlContext"],v),e}function SV(n){const e={},t=g(n,["baseModel"]);t!=null&&y(e,["baseModel"],t);const i=g(n,["createTime"]);i!=null&&y(e,["createTime"],i);const s=g(n,["updateTime"]);return s!=null&&y(e,["updateTime"],s),e}function bV(n){const e={},t=g(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&y(e,["baseModel"],t);const i=g(n,["createTime"]);i!=null&&y(e,["createTime"],i);const s=g(n,["updateTime"]);return s!=null&&y(e,["updateTime"],s),e}function CV(n,e){const t={},i=g(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const s=g(n,["description"]);e!==void 0&&s!=null&&y(e,["description"],s);const o=g(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&y(e,["defaultCheckpointId"],o),t}function IV(n,e){const t={},i=g(n,["displayName"]);e!==void 0&&i!=null&&y(e,["displayName"],i);const s=g(n,["description"]);e!==void 0&&s!=null&&y(e,["description"],s);const o=g(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&y(e,["defaultCheckpointId"],o),t}function AV(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","name"],Ht(n,i));const s=g(e,["config"]);return s!=null&&CV(s,t),t}function NV(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["config"]);return s!=null&&IV(s,t),t}function RV(n,e){const t={},i=g(n,["outputGcsUri"]);e!==void 0&&i!=null&&y(e,["parameters","storageUri"],i);const s=g(n,["safetyFilterLevel"]);e!==void 0&&s!=null&&y(e,["parameters","safetySetting"],s);const o=g(n,["personGeneration"]);e!==void 0&&o!=null&&y(e,["parameters","personGeneration"],o);const l=g(n,["includeRaiReason"]);e!==void 0&&l!=null&&y(e,["parameters","includeRaiReason"],l);const d=g(n,["outputMimeType"]);e!==void 0&&d!=null&&y(e,["parameters","outputOptions","mimeType"],d);const h=g(n,["outputCompressionQuality"]);e!==void 0&&h!=null&&y(e,["parameters","outputOptions","compressionQuality"],h);const p=g(n,["enhanceInputImage"]);e!==void 0&&p!=null&&y(e,["parameters","upscaleConfig","enhanceInputImage"],p);const v=g(n,["imagePreservationFactor"]);e!==void 0&&v!=null&&y(e,["parameters","upscaleConfig","imagePreservationFactor"],v);const x=g(n,["labels"]);e!==void 0&&x!=null&&y(e,["labels"],x);const b=g(n,["numberOfImages"]);e!==void 0&&b!=null&&y(e,["parameters","sampleCount"],b);const A=g(n,["mode"]);return e!==void 0&&A!=null&&y(e,["parameters","mode"],A),t}function MV(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["_url","model"],Ht(n,i));const s=g(e,["image"]);s!=null&&y(t,["instances[0]","image"],kr(s));const o=g(e,["upscaleFactor"]);o!=null&&y(t,["parameters","upscaleConfig","upscaleFactor"],o);const l=g(e,["config"]);return l!=null&&RV(l,t),t}function PV(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Ag(o))),y(e,["generatedImages"],s)}return e}function kV(n){const e={},t=g(n,["uri"]);t!=null&&y(e,["uri"],t);const i=g(n,["encodedVideo"]);i!=null&&y(e,["videoBytes"],ml(i));const s=g(n,["encoding"]);return s!=null&&y(e,["mimeType"],s),e}function DV(n){const e={},t=g(n,["gcsUri"]);t!=null&&y(e,["uri"],t);const i=g(n,["bytesBase64Encoded"]);i!=null&&y(e,["videoBytes"],ml(i));const s=g(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}function LV(n){const e={},t=g(n,["image"]);t!=null&&y(e,["_self"],kr(t));const i=g(n,["maskMode"]);return i!=null&&y(e,["maskMode"],i),e}function VV(n){const e={},t=g(n,["image"]);t!=null&&y(e,["image"],Ng(t));const i=g(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function OV(n){const e={},t=g(n,["image"]);t!=null&&y(e,["image"],kr(t));const i=g(n,["referenceType"]);return i!=null&&y(e,["referenceType"],i),e}function $1(n){const e={},t=g(n,["uri"]);t!=null&&y(e,["uri"],t);const i=g(n,["videoBytes"]);i!=null&&y(e,["encodedVideo"],ml(i));const s=g(n,["mimeType"]);return s!=null&&y(e,["encoding"],s),e}function X1(n){const e={},t=g(n,["uri"]);t!=null&&y(e,["gcsUri"],t);const i=g(n,["videoBytes"]);i!=null&&y(e,["bytesBase64Encoded"],ml(i));const s=g(n,["mimeType"]);return s!=null&&y(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const UV="Content-Type",FV="X-Server-Timeout",BV="User-Agent",Kv="x-goog-api-client",zV="1.30.0",qV=`google-genai-sdk/${zV}`,GV="v1beta1",HV="v1beta",IC=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class jV{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:GV,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:HV,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const s=[this.getRequestUrlInternal(t)];return i&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[l,d]of Object.entries(e.queryParams))s.searchParams.append(l,String(d));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.unaryApiCall(s,o,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[s,o]of Object.entries(t))typeof o=="object"?i[s]=Object.assign(Object.assign({},i[s]),o):o!==void 0&&(i[s]=o);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,s.toString(),e.abortSignal),this.streamApiCall(s,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,s){if(t&&t.timeout||s){const o=new AbortController,l=o.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const d=setTimeout(()=>o.abort(),t.timeout);d&&typeof d.unref=="function"&&d.unref()}s&&s.addEventListener("abort",()=>{o.abort()}),e.signal=l}return t&&t.extraBody!==null&&KV(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await AC(s),new zv(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await AC(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return Gc(this,arguments,function*(){const s=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let l="";for(;;){const{done:d,value:h}=yield xn(s.read());if(d){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=o.decode(h,{stream:!0});try{const x=JSON.parse(p);if("error"in x){const b=JSON.parse(JSON.stringify(x.error)),A=b.status,P=b.code,F=`got status: ${A}. ${JSON.stringify(x)}`;if(P>=400&&P<600)throw new Cg({message:F,status:P})}}catch(x){if(x.name==="ApiError")throw x}l+=p;let v=l.match(IC);for(;v;){const x=v[1];try{const b=new Response(x,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield xn(new zv(b)),l=l.slice(v[0].length),v=l.match(IC)}catch(b){throw new Error(`exception parsing stream chunk ${x}. ${b}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=qV+" "+this.clientOptions.userAgentExtra;return e[BV]=t,e[Kv]=t,e[UV]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[s,o]of Object.entries(e.headers))i.append(s,o);e.timeout&&e.timeout>0&&i.append(FV,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const o=this.clientOptions.uploader,l=await o.stat(e);s.sizeBytes=String(l.size);const d=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=d;const h={file:s},p=this.getFileName(e),v=Oe("upload/v1beta/files",h._url),x=await this.fetchUploadUrl(v,s.sizeBytes,s.mimeType,p,h,t==null?void 0:t.httpOptions);return o.upload(e,x,this)}async uploadFileToFileSearchStore(e,t,i){var s;const o=this.clientOptions.uploader,l=await o.stat(t),d=String(l.size),h=(s=i==null?void 0:i.mimeType)!==null&&s!==void 0?s:l.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,v=this.getFileName(t),x={};i!=null&&i.customMetadata&&(x.customMetadata=i.customMetadata),i!=null&&i.chunkingConfig&&(x.chunkingConfig=i.chunkingConfig);const b=await this.fetchUploadUrl(p,d,h,v,x,i==null?void 0:i.httpOptions);return o.uploadToFileSearchStore(t,b,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,s,o,l){var d;let h={};l?h=l:h={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},s?{"X-Goog-Upload-File-Name":s}:{})};const p=await this.request({path:e,body:JSON.stringify(o),httpMethod:"POST",httpOptions:h});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const v=(d=p==null?void 0:p.headers)===null||d===void 0?void 0:d["x-goog-upload-url"];if(v===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return v}}async function AC(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const s=JSON.stringify(i);throw t>=400&&t<600?new Cg({message:s,status:t}):new Error(s)}}function KV(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const o=JSON.parse(n.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(o,l){const d=Object.assign({},o);for(const h in l)if(Object.prototype.hasOwnProperty.call(l,h)){const p=l[h],v=d[h];p&&typeof p=="object"&&!Array.isArray(p)&&v&&typeof v=="object"&&!Array.isArray(v)?d[h]=i(v,p):(v&&p&&typeof v!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof v}, New type: ${typeof p}. Overwriting.`),d[h]=p)}return d}const s=i(t,e);n.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WV="mcp_used/unknown";let YV=!1;function eN(n){for(const e of n)if(JV(e)||typeof e=="object"&&"inputSchema"in e)return!0;return YV}function tN(n){var e;const t=(e=n[Kv])!==null&&e!==void 0?e:"";n[Kv]=(t+` ${WV}`).trimStart()}function JV(n){return n!==null&&typeof n=="object"&&n instanceof rT}function ZV(n,e=100){return Gc(this,arguments,function*(){let i,s=0;for(;s<e;){const o=yield xn(n.listTools({cursor:i}));for(const l of o.tools)yield yield xn(l),s++;if(!o.nextCursor)break;i=o.nextCursor}})}class rT{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new rT(e,t)}async initialize(){var e,t,i,s;if(this.mcpTools.length>0)return;const o={},l=[];for(const v of this.mcpClients)try{for(var d=!0,h=(t=void 0,zh(ZV(v))),p;p=await h.next(),e=p.done,!e;d=!0){s=p.value,d=!1;const x=s;l.push(x);const b=x.name;if(o[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);o[b]=v}}catch(x){t={error:x}}finally{try{!d&&!e&&(i=h.return)&&await i.call(h)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),q5(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[i.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const l=await s.callTool({name:i.name,arguments:i.args},void 0,o);t.push({functionResponse:{name:i.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function QV(n,e,t){const i=new D5;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(i,s),e(i)}class $V{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),l=tO(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),h=`${s}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${d}`;let p=()=>{};const v=new Promise(Q=>{p=Q}),x=e.callbacks,b=function(){p({})},A=this.apiClient,P={onopen:b,onmessage:Q=>{QV(A,x.onmessage,Q)},onerror:(t=x==null?void 0:x.onerror)!==null&&t!==void 0?t:function(Q){},onclose:(i=x==null?void 0:x.onclose)!==null&&i!==void 0?i:function(Q){}},F=this.webSocketFactory.create(h,eO(l),P);F.connect(),await v;const re={setup:{model:Ht(this.apiClient,e.model)}};return F.send(JSON.stringify(re)),new XV(F,this.apiClient)}}class XV{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=F4(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=U4(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Fc.PLAY)}pause(){this.sendPlaybackControl(Fc.PAUSE)}stop(){this.sendPlaybackControl(Fc.STOP)}resetContext(){this.sendPlaybackControl(Fc.RESET_CONTEXT)}close(){this.conn.close()}}function eO(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function tO(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nO="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function iO(n,e,t){const i=new k5;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const o=JSON.parse(s);if(n.isVertexAI()){const l=q4(o);Object.assign(i,l)}else Object.assign(i,o);e(i)}class sO{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new $V(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,s,o,l,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let v;const x=this.apiClient.getHeaders();e.config&&e.config.tools&&eN(e.config.tools)&&tN(x);const b=lO(x);if(this.apiClient.isVertexAI())v=`${h}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b,v);else{const O=this.apiClient.getApiKey();let q="BidiGenerateContent",G="key";O!=null&&O.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),q="BidiGenerateContentConstrained",G="access_token"),v=`${h}/ws/google.ai.generativelanguage.${p}.GenerativeService.${q}?${G}=${O}`}let A=()=>{};const P=new Promise(O=>{A=O}),F=e.callbacks,H=function(){var O;(O=F==null?void 0:F.onopen)===null||O===void 0||O.call(F),A({})},X=this.apiClient,re={onopen:H,onmessage:O=>{iO(X,F.onmessage,O)},onerror:(t=F==null?void 0:F.onerror)!==null&&t!==void 0?t:function(O){},onclose:(i=F==null?void 0:F.onclose)!==null&&i!==void 0?i:function(O){}},Q=this.webSocketFactory.create(v,aO(b),re);Q.connect(),await P;let he=Ht(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&he.startsWith("publishers/")){const O=this.apiClient.getProject(),q=this.apiClient.getLocation();he=`projects/${O}/locations/${q}/`+he}let fe={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Rp.AUDIO]}:e.config.responseModalities=[Rp.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const Y=(d=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&d!==void 0?d:[],k=[];for(const O of Y)if(this.isCallableTool(O)){const q=O;k.push(await q.tool())}else k.push(O);k.length>0&&(e.config.tools=k);const B={model:he,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?fe=O4(this.apiClient,B):fe=V4(this.apiClient,B),delete fe.config,Q.send(JSON.stringify(fe)),new oO(Q,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const rO={turnComplete:!0};class oO{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=ur(t.turns),e.isVertexAI()||(i=i.map(s=>Ig(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const o of i){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(nO)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},rO),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:z4(e)}:t={realtimeInput:B4(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function aO(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function lO(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const NC=10;function RC(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const l of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Hc(l)){s=!0;break}if(!s)return!0;const o=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Hc(n){return"callTool"in n&&typeof n.callTool=="function"}function uO(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>Hc(s)))!==null&&i!==void 0?i:!1}function MC(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,s)=>{if(Hc(i))return;const o=i;o.functionDeclarations&&o.functionDeclarations.length>0&&t.push(s)}),t}function PC(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cO extends Xo{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,s,o,l,d;const h=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!uO(t)||RC(t.config))return await this.generateContentInternal(h);const p=MC(t);if(p.length>0){const F=p.map(H=>`tools[${H}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${F}.`)}let v,x;const b=ur(h.contents),A=(o=(s=(i=h.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&o!==void 0?o:NC;let P=0;for(;P<A&&(v=await this.generateContentInternal(h),!(!v.functionCalls||v.functionCalls.length===0));){const F=v.candidates[0].content,H=[];for(const X of(d=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&d!==void 0?d:[])if(Hc(X)){const Q=await X.callTool(v.functionCalls);H.push(...Q)}P++,x={role:"user",parts:H},h.contents=ur(h.contents),h.contents.push(F),h.contents.push(x),PC(h.config)&&(b.push(F),b.push(x))}return PC(h.config)&&(v.automaticFunctionCallingHistory=b),v},this.generateContentStream=async t=>{var i,s,o,l,d;if(this.maybeMoveToResponseJsonSchem(t),RC(t.config)){const x=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(x)}const h=MC(t);if(h.length>0){const x=h.map(b=>`tools[${b}]`).join(", ");throw new Error(`Incompatible tools found at ${x}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(o=(s=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,v=(d=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||d===void 0?void 0:d.disable;if(p&&!v)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var s;let o;const l=[];if(i!=null&&i.generatedImages)for(const h of i.generatedImages)h&&(h!=null&&h.safetyAttributes)&&((s=h==null?void 0:h.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?o=h==null?void 0:h.safetyAttributes:l.push(h);let d;return o?d={generatedImages:l,positivePromptSafetyAttributes:o,sdkHttpResponse:i.sdkHttpResponse}:d={generatedImages:l,sdkHttpResponse:i.sdkHttpResponse},d}),this.list=async t=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Vu(jo.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(l),l)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var i,s,o,l,d,h;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(o=t.source)===null||o===void 0?void 0:o.video)===null||l===void 0)&&l.uri&&(!((h=(d=t.source)===null||d===void 0?void 0:d.video)===null||h===void 0)&&h.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,s;const o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;const l=await Promise.all(o.map(async h=>Hc(h)?await h.tool():h)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(d.config.tools=l,e.config&&e.config.tools&&eN(e.config.tools)){const h=(s=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&s!==void 0?s:{};let p=Object.assign({},h);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),tN(p),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return d}async initAfcToolsMap(e){var t,i,s;const o=new Map;for(const l of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(Hc(l)){const d=l,h=await d.tool();for(const p of(s=h.functionDeclarations)!==null&&s!==void 0?s:[]){if(!p.name)throw new Error("Function declaration name is required.");if(o.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);o.set(p.name,d)}}return o}async processAfcStream(e){var t,i,s;const o=(s=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:NC;let l=!1,d=0;const h=await this.initAfcToolsMap(e);return(function(p,v,x){var b,A;return Gc(this,arguments,function*(){for(var P,F,H,X;d<o;){l&&(d++,l=!1);const fe=yield xn(p.processParamsMaybeAddMcpUsage(x)),Y=yield xn(p.generateContentStreamInternal(fe)),k=[],B=[];try{for(var re=!0,Q=(F=void 0,zh(Y)),he;he=yield xn(Q.next()),P=he.done,!P;re=!0){X=he.value,re=!1;const O=X;if(yield yield xn(O),O.candidates&&(!((b=O.candidates[0])===null||b===void 0)&&b.content)){B.push(O.candidates[0].content);for(const q of(A=O.candidates[0].content.parts)!==null&&A!==void 0?A:[])if(d<o&&q.functionCall){if(!q.functionCall.name)throw new Error("Function call name was not returned by the model.");if(v.has(q.functionCall.name)){const G=yield xn(v.get(q.functionCall.name).callTool([q.functionCall]));k.push(...G)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${v.keys()}, mising tool: ${q.functionCall.name}`)}}}}catch(O){F={error:O}}finally{try{!re&&!P&&(H=Q.return)&&(yield xn(H.call(Q)))}finally{if(F)throw F.error}}if(k.length>0){l=!0;const O=new xh;O.candidates=[{content:{role:"user",parts:k}}],yield yield xn(O);const q=[];q.push(...B),q.push({role:"user",parts:k});const G=ur(x.contents).concat(q);x.contents=G}else break}})})(this,h,e)}async generateContentInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=SC(this.apiClient,e);return d=Oe("{model}:generateContent",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=CC(v),b=new xh;return Object.assign(b,x),b})}else{const p=wC(this.apiClient,e);return d=Oe("{model}:generateContent",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=bC(v),b=new xh;return Object.assign(b,x),b})}}async generateContentStreamInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=SC(this.apiClient,e);return d=Oe("{model}:streamGenerateContent?alt=sse",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.requestStream({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(x){return Gc(this,arguments,function*(){var b,A,P,F;try{for(var H=!0,X=zh(x),re;re=yield xn(X.next()),b=re.done,!b;H=!0){F=re.value,H=!1;const Q=F,he=CC(yield xn(Q.json()));he.sdkHttpResponse={headers:Q.headers};const fe=new xh;Object.assign(fe,he),yield yield xn(fe)}}catch(Q){A={error:Q}}finally{try{!H&&!b&&(P=X.return)&&(yield xn(P.call(X)))}finally{if(A)throw A.error}}})})}else{const p=wC(this.apiClient,e);return d=Oe("{model}:streamGenerateContent?alt=sse",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.requestStream({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),l.then(function(x){return Gc(this,arguments,function*(){var b,A,P,F;try{for(var H=!0,X=zh(x),re;re=yield xn(X.next()),b=re.done,!b;H=!0){F=re.value,H=!1;const Q=F,he=bC(yield xn(Q.json()));he.sdkHttpResponse={headers:Q.headers};const fe=new xh;Object.assign(fe,he),yield yield xn(fe)}}catch(Q){A={error:Q}}finally{try{!H&&!b&&(P=X.return)&&(yield xn(P.call(X)))}finally{if(A)throw A.error}}})})}}async embedContent(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=y3(this.apiClient,e);return d=Oe("{model}:predict",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=T3(v),b=new aC;return Object.assign(b,x),b})}else{const p=_3(this.apiClient,e);return d=Oe("{model}:batchEmbedContents",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=v3(v),b=new aC;return Object.assign(b,x),b})}}async generateImagesInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=M3(this.apiClient,e);return d=Oe("{model}:predict",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=k3(v),b=new lC;return Object.assign(b,x),b})}else{const p=R3(this.apiClient,e);return d=Oe("{model}:predict",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=P3(v),b=new lC;return Object.assign(b,x),b})}}async editImageInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI()){const d=f3(this.apiClient,e);return o=Oe("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),s.then(h=>{const p=m3(h),v=new x5;return Object.assign(v,p),v})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI()){const d=MV(this.apiClient,e);return o=Oe("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),s.then(h=>{const p=PV(h),v=new w5;return Object.assign(v,p),v})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI()){const d=hV(this.apiClient,e);return o=Oe("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=fV(h),v=new S5;return Object.assign(v,p),v})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI()){const d=vV(this.apiClient,e);return o=Oe("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=TV(h),v=new b5;return Object.assign(v,p),v})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=Z3(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),l.then(v=>jv(v))}else{const p=J3(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),l.then(v=>Hv(v))}}async listInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=rV(this.apiClient,e);return d=Oe("{models_url}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=aV(v),b=new uC;return Object.assign(b,x),b})}else{const p=sV(this.apiClient,e);return d=Oe("{models_url}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=oV(v),b=new uC;return Object.assign(b,x),b})}}async update(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=NV(this.apiClient,e);return d=Oe("{model}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),l.then(v=>jv(v))}else{const p=AV(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),l.then(v=>Hv(v))}}async delete(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=u3(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=d3(v),b=new cC;return Object.assign(b,x),b})}else{const p=l3(this.apiClient,e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=c3(v),b=new cC;return Object.assign(b,x),b})}}async countTokens(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=r3(this.apiClient,e);return d=Oe("{model}:countTokens",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=a3(v),b=new dC;return Object.assign(b,x),b})}else{const p=s3(this.apiClient,e);return d=Oe("{model}:countTokens",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=o3(v),b=new dC;return Object.assign(b,x),b})}}async computeTokens(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI()){const d=Q4(this.apiClient,e);return o=Oe("{model}:computeTokens",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),s.then(h=>{const p=$4(h),v=new C5;return Object.assign(v,p),v})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=F3(this.apiClient,e);return d=Oe("{model}:predictLongRunning",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),l.then(v=>{const x=O3(v),b=new Mp;return Object.assign(b,x),b})}else{const p=U3(this.apiClient,e);return d=Oe("{model}:predictLongRunning",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),l.then(v=>{const x=V3(v),b=new Mp;return Object.assign(b,x),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dO extends Xo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let o;i&&"httpOptions"in i&&(o=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let o;i&&"httpOptions"in i&&(o=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=g5(e);return d=Oe("{operationName}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json()),l}else{const p=p5(e);return d=Oe("{operationName}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),l}}async fetchPredictVideosOperationInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI()){const d=l5(e);return o=Oe("{resourceName}:fetchPredictOperation",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hO(n){const e={},t=g(n,["data"]);if(t!=null&&y(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function fO(n){const e={},t=g(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(o=>xO(o))),y(e,["parts"],s)}const i=g(n,["role"]);return i!=null&&y(e,["role"],i),e}function mO(n,e,t){const i={},s=g(e,["expireTime"]);t!==void 0&&s!=null&&y(t,["expireTime"],s);const o=g(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&y(t,["newSessionExpireTime"],o);const l=g(e,["uses"]);t!==void 0&&l!=null&&y(t,["uses"],l);const d=g(e,["liveConnectConstraints"]);t!==void 0&&d!=null&&y(t,["bidiGenerateContentSetup"],EO(n,d));const h=g(e,["lockAdditionalFields"]);return t!==void 0&&h!=null&&y(t,["fieldMask"],h),i}function pO(n,e){const t={},i=g(e,["config"]);return i!=null&&y(t,["config"],mO(n,i,t)),t}function gO(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&y(e,["fileUri"],t);const i=g(n,["mimeType"]);return i!=null&&y(e,["mimeType"],i),e}function _O(n){const e={},t=g(n,["id"]);t!=null&&y(e,["id"],t);const i=g(n,["args"]);i!=null&&y(e,["args"],i);const s=g(n,["name"]);if(s!=null&&y(e,["name"],s),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function yO(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&y(e,["enableWidget"],t),e}function vO(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&y(e,["timeRangeFilter"],t),e}function TO(n,e){const t={},i=g(n,["generationConfig"]);e!==void 0&&i!=null&&y(e,["setup","generationConfig"],i);const s=g(n,["responseModalities"]);e!==void 0&&s!=null&&y(e,["setup","generationConfig","responseModalities"],s);const o=g(n,["temperature"]);e!==void 0&&o!=null&&y(e,["setup","generationConfig","temperature"],o);const l=g(n,["topP"]);e!==void 0&&l!=null&&y(e,["setup","generationConfig","topP"],l);const d=g(n,["topK"]);e!==void 0&&d!=null&&y(e,["setup","generationConfig","topK"],d);const h=g(n,["maxOutputTokens"]);e!==void 0&&h!=null&&y(e,["setup","generationConfig","maxOutputTokens"],h);const p=g(n,["mediaResolution"]);e!==void 0&&p!=null&&y(e,["setup","generationConfig","mediaResolution"],p);const v=g(n,["seed"]);e!==void 0&&v!=null&&y(e,["setup","generationConfig","seed"],v);const x=g(n,["speechConfig"]);e!==void 0&&x!=null&&y(e,["setup","generationConfig","speechConfig"],sT(x));const b=g(n,["thinkingConfig"]);e!==void 0&&b!=null&&y(e,["setup","generationConfig","thinkingConfig"],b);const A=g(n,["enableAffectiveDialog"]);e!==void 0&&A!=null&&y(e,["setup","generationConfig","enableAffectiveDialog"],A);const P=g(n,["systemInstruction"]);e!==void 0&&P!=null&&y(e,["setup","systemInstruction"],fO(Oi(P)));const F=g(n,["tools"]);if(e!==void 0&&F!=null){let Y=xd(F);Array.isArray(Y)&&(Y=Y.map(k=>SO(Ed(k)))),y(e,["setup","tools"],Y)}const H=g(n,["sessionResumption"]);e!==void 0&&H!=null&&y(e,["setup","sessionResumption"],wO(H));const X=g(n,["inputAudioTranscription"]);e!==void 0&&X!=null&&y(e,["setup","inputAudioTranscription"],X);const re=g(n,["outputAudioTranscription"]);e!==void 0&&re!=null&&y(e,["setup","outputAudioTranscription"],re);const Q=g(n,["realtimeInputConfig"]);e!==void 0&&Q!=null&&y(e,["setup","realtimeInputConfig"],Q);const he=g(n,["contextWindowCompression"]);e!==void 0&&he!=null&&y(e,["setup","contextWindowCompression"],he);const fe=g(n,["proactivity"]);return e!==void 0&&fe!=null&&y(e,["setup","proactivity"],fe),t}function EO(n,e){const t={},i=g(e,["model"]);i!=null&&y(t,["setup","model"],Ht(n,i));const s=g(e,["config"]);return s!=null&&y(t,["config"],TO(s,t)),t}function xO(n){const e={},t=g(n,["mediaResolution"]);t!=null&&y(e,["mediaResolution"],t);const i=g(n,["codeExecutionResult"]);i!=null&&y(e,["codeExecutionResult"],i);const s=g(n,["executableCode"]);s!=null&&y(e,["executableCode"],s);const o=g(n,["fileData"]);o!=null&&y(e,["fileData"],gO(o));const l=g(n,["functionCall"]);l!=null&&y(e,["functionCall"],_O(l));const d=g(n,["functionResponse"]);d!=null&&y(e,["functionResponse"],d);const h=g(n,["inlineData"]);h!=null&&y(e,["inlineData"],hO(h));const p=g(n,["text"]);p!=null&&y(e,["text"],p);const v=g(n,["thought"]);v!=null&&y(e,["thought"],v);const x=g(n,["thoughtSignature"]);x!=null&&y(e,["thoughtSignature"],x);const b=g(n,["videoMetadata"]);return b!=null&&y(e,["videoMetadata"],b),e}function wO(n){const e={},t=g(n,["handle"]);if(t!=null&&y(e,["handle"],t),g(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function SO(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let v=t;Array.isArray(v)&&(v=v.map(x=>x)),y(e,["functionDeclarations"],v)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=g(n,["googleSearchRetrieval"]);i!=null&&y(e,["googleSearchRetrieval"],i);const s=g(n,["computerUse"]);s!=null&&y(e,["computerUse"],s);const o=g(n,["fileSearch"]);o!=null&&y(e,["fileSearch"],o);const l=g(n,["codeExecution"]);if(l!=null&&y(e,["codeExecution"],l),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=g(n,["googleMaps"]);d!=null&&y(e,["googleMaps"],yO(d));const h=g(n,["googleSearch"]);h!=null&&y(e,["googleSearch"],vO(h));const p=g(n,["urlContext"]);return p!=null&&y(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bO(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const s=Object.keys(i).map(o=>`${t}.${o}`);e.push(...s)}else e.push(t)}return e.join(",")}function CO(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const o=i.setup;typeof o=="object"&&o!==null?(n.bidiGenerateContentSetup=o,t=o):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const s=n.fieldMask;if(t){const o=bO(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?n.fieldMask=o:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];s.length>0&&(d=s.map(p=>l.includes(p)?`generationConfig.${p}`:p));const h=[];o&&h.push(o),d.length>0&&h.push(...d),h.length>0?n.fieldMask=h.join(","):delete n.fieldMask}else delete n.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?n.fieldMask=s.join(","):delete n.fieldMask;return n}class IO extends Xo{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=pO(this.apiClient,e);o=Oe("auth_tokens",d._url),l=d._query,delete d.config,delete d._url,delete d._query;const h=CO(d,e.config);return s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),s.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AO(n,e){const t={},i=g(n,["displayName"]);return e!==void 0&&i!=null&&y(e,["displayName"],i),t}function NO(n){const e={},t=g(n,["config"]);return t!=null&&AO(t,e),e}function RO(n,e){const t={},i=g(n,["force"]);return e!==void 0&&i!=null&&y(e,["_query","force"],i),t}function MO(n){const e={},t=g(n,["name"]);t!=null&&y(e,["_url","name"],t);const i=g(n,["config"]);return i!=null&&RO(i,e),e}function PO(n){const e={},t=g(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function kO(n,e){const t={},i=g(n,["customMetadata"]);if(e!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["customMetadata"],o)}const s=g(n,["chunkingConfig"]);return e!==void 0&&s!=null&&y(e,["chunkingConfig"],s),t}function DO(n){const e={},t=g(n,["name"]);t!=null&&y(e,["name"],t);const i=g(n,["metadata"]);i!=null&&y(e,["metadata"],i);const s=g(n,["done"]);s!=null&&y(e,["done"],s);const o=g(n,["error"]);o!=null&&y(e,["error"],o);const l=g(n,["response"]);return l!=null&&y(e,["response"],VO(l)),e}function LO(n){const e={},t=g(n,["fileSearchStoreName"]);t!=null&&y(e,["_url","file_search_store_name"],t);const i=g(n,["fileName"]);i!=null&&y(e,["fileName"],i);const s=g(n,["config"]);return s!=null&&kO(s,e),e}function VO(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["parent"]);i!=null&&y(e,["parent"],i);const s=g(n,["documentName"]);return s!=null&&y(e,["documentName"],s),e}function OO(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const s=g(n,["pageToken"]);return e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),t}function UO(n){const e={},t=g(n,["config"]);return t!=null&&OO(t,e),e}function FO(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const s=g(n,["fileSearchStores"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["fileSearchStores"],o)}return e}function BO(n,e){const t={},i=g(n,["mimeType"]);e!==void 0&&i!=null&&y(e,["mimeType"],i);const s=g(n,["displayName"]);e!==void 0&&s!=null&&y(e,["displayName"],s);const o=g(n,["customMetadata"]);if(e!==void 0&&o!=null){let d=o;Array.isArray(d)&&(d=d.map(h=>h)),y(e,["customMetadata"],d)}const l=g(n,["chunkingConfig"]);return e!==void 0&&l!=null&&y(e,["chunkingConfig"],l),t}function zO(n){const e={},t=g(n,["fileSearchStoreName"]);t!=null&&y(e,["_url","file_search_store_name"],t);const i=g(n,["config"]);return i!=null&&BO(i,e),e}function qO(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&y(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GO(n,e){const t={},i=g(n,["force"]);return e!==void 0&&i!=null&&y(e,["_query","force"],i),t}function HO(n){const e={},t=g(n,["name"]);t!=null&&y(e,["_url","name"],t);const i=g(n,["config"]);return i!=null&&GO(i,e),e}function jO(n){const e={},t=g(n,["name"]);return t!=null&&y(e,["_url","name"],t),e}function KO(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&y(e,["_query","pageSize"],i);const s=g(n,["pageToken"]);return e!==void 0&&s!=null&&y(e,["_query","pageToken"],s),t}function WO(n){const e={},t=g(n,["parent"]);t!=null&&y(e,["_url","parent"],t);const i=g(n,["config"]);return i!=null&&KO(i,e),e}function YO(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&y(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&y(e,["nextPageToken"],i);const s=g(n,["documents"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>l)),y(e,["documents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JO extends Xo{constructor(e){super(),this.apiClient=e,this.list=async t=>new Vu(jo.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=jO(e);return o=Oe("{name}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,i;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=HO(e);s=Oe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=WO(e);return o=Oe("{parent}/documents",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=YO(h),v=new I5;return Object.assign(v,p),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZO extends Xo{constructor(e,t=new JO(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new Vu(jo.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=NO(e);return o=Oe("fileSearchStores",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async get(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=PO(e);return o=Oe("{name}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,i;let s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=MO(e);s=Oe("{name}",l._url),o=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=UO(e);return o=Oe("fileSearchStores",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=FO(h),v=new A5;return Object.assign(v,p),v})}}async uploadToFileSearchStoreInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=zO(e);return o=Oe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=qO(h),v=new N5;return Object.assign(v,p),v})}}async importFile(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=LO(e);return o=Oe("{file_search_store_name}:importFile",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=DO(h),v=new X0;return Object.assign(v,p),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QO(n,e){const t={},i=g(n,["name"]);return i!=null&&y(t,["_url","name"],i),t}function $O(n,e){const t={},i=g(n,["name"]);return i!=null&&y(t,["_url","name"],i),t}function XO(n,e,t){const i={};if(g(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=g(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&y(e,["displayName"],s),g(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=g(n,["epochCount"]);e!==void 0&&o!=null&&y(e,["tuningTask","hyperparameters","epochCount"],o);const l=g(n,["learningRateMultiplier"]);if(l!=null&&y(i,["tuningTask","hyperparameters","learningRateMultiplier"],l),g(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(g(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(g(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=g(n,["batchSize"]);e!==void 0&&d!=null&&y(e,["tuningTask","hyperparameters","batchSize"],d);const h=g(n,["learningRate"]);if(e!==void 0&&h!=null&&y(e,["tuningTask","hyperparameters","learningRate"],h),g(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(g(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function e6(n,e,t){const i={};let s=g(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const A=g(n,["validationDataset"]);e!==void 0&&A!=null&&y(e,["supervisedTuningSpec"],kC(A))}else if(s==="PREFERENCE_TUNING"){const A=g(n,["validationDataset"]);e!==void 0&&A!=null&&y(e,["preferenceOptimizationSpec"],kC(A))}const o=g(n,["tunedModelDisplayName"]);e!==void 0&&o!=null&&y(e,["tunedModelDisplayName"],o);const l=g(n,["description"]);e!==void 0&&l!=null&&y(e,["description"],l);let d=g(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const A=g(n,["epochCount"]);e!==void 0&&A!=null&&y(e,["supervisedTuningSpec","hyperParameters","epochCount"],A)}else if(d==="PREFERENCE_TUNING"){const A=g(n,["epochCount"]);e!==void 0&&A!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],A)}let h=g(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const A=g(n,["learningRateMultiplier"]);e!==void 0&&A!=null&&y(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],A)}else if(h==="PREFERENCE_TUNING"){const A=g(n,["learningRateMultiplier"]);e!==void 0&&A!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],A)}let p=g(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const A=g(n,["exportLastCheckpointOnly"]);e!==void 0&&A!=null&&y(e,["supervisedTuningSpec","exportLastCheckpointOnly"],A)}else if(p==="PREFERENCE_TUNING"){const A=g(n,["exportLastCheckpointOnly"]);e!==void 0&&A!=null&&y(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],A)}let v=g(t,["config","method"]);if(v===void 0&&(v="SUPERVISED_FINE_TUNING"),v==="SUPERVISED_FINE_TUNING"){const A=g(n,["adapterSize"]);e!==void 0&&A!=null&&y(e,["supervisedTuningSpec","hyperParameters","adapterSize"],A)}else if(v==="PREFERENCE_TUNING"){const A=g(n,["adapterSize"]);e!==void 0&&A!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],A)}if(g(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(g(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const x=g(n,["labels"]);e!==void 0&&x!=null&&y(e,["labels"],x);const b=g(n,["beta"]);return e!==void 0&&b!=null&&y(e,["preferenceOptimizationSpec","hyperParameters","beta"],b),i}function t6(n,e){const t={},i=g(n,["baseModel"]);i!=null&&y(t,["baseModel"],i);const s=g(n,["preTunedModel"]);s!=null&&y(t,["preTunedModel"],s);const o=g(n,["trainingDataset"]);o!=null&&h6(o);const l=g(n,["config"]);return l!=null&&XO(l,t),t}function n6(n,e){const t={},i=g(n,["baseModel"]);i!=null&&y(t,["baseModel"],i);const s=g(n,["preTunedModel"]);s!=null&&y(t,["preTunedModel"],s);const o=g(n,["trainingDataset"]);o!=null&&f6(o,t,e);const l=g(n,["config"]);return l!=null&&e6(l,t,e),t}function i6(n,e){const t={},i=g(n,["name"]);return i!=null&&y(t,["_url","name"],i),t}function s6(n,e){const t={},i=g(n,["name"]);return i!=null&&y(t,["_url","name"],i),t}function r6(n,e,t){const i={},s=g(n,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const o=g(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=g(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),i}function o6(n,e,t){const i={},s=g(n,["pageSize"]);e!==void 0&&s!=null&&y(e,["_query","pageSize"],s);const o=g(n,["pageToken"]);e!==void 0&&o!=null&&y(e,["_query","pageToken"],o);const l=g(n,["filter"]);return e!==void 0&&l!=null&&y(e,["_query","filter"],l),i}function a6(n,e){const t={},i=g(n,["config"]);return i!=null&&r6(i,t),t}function l6(n,e){const t={},i=g(n,["config"]);return i!=null&&o6(i,t),t}function u6(n,e){const t={},i=g(n,["sdkHttpResponse"]);i!=null&&y(t,["sdkHttpResponse"],i);const s=g(n,["nextPageToken"]);s!=null&&y(t,["nextPageToken"],s);const o=g(n,["tunedModels"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(d=>nN(d))),y(t,["tuningJobs"],l)}return t}function c6(n,e){const t={},i=g(n,["sdkHttpResponse"]);i!=null&&y(t,["sdkHttpResponse"],i);const s=g(n,["nextPageToken"]);s!=null&&y(t,["nextPageToken"],s);const o=g(n,["tuningJobs"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(d=>Wv(d))),y(t,["tuningJobs"],l)}return t}function d6(n,e){const t={},i=g(n,["name"]);i!=null&&y(t,["model"],i);const s=g(n,["name"]);return s!=null&&y(t,["endpoint"],s),t}function h6(n,e){const t={};if(g(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=g(n,["examples"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>o)),y(t,["examples","examples"],s)}return t}function f6(n,e,t){const i={};let s=g(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=g(n,["gcsUri"]);e!==void 0&&l!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=g(n,["gcsUri"]);e!==void 0&&l!=null&&y(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let o=g(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const l=g(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&y(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(o==="PREFERENCE_TUNING"){const l=g(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&y(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(g(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function nN(n,e){const t={},i=g(n,["sdkHttpResponse"]);i!=null&&y(t,["sdkHttpResponse"],i);const s=g(n,["name"]);s!=null&&y(t,["name"],s);const o=g(n,["state"]);o!=null&&y(t,["state"],O1(o));const l=g(n,["createTime"]);l!=null&&y(t,["createTime"],l);const d=g(n,["tuningTask","startTime"]);d!=null&&y(t,["startTime"],d);const h=g(n,["tuningTask","completeTime"]);h!=null&&y(t,["endTime"],h);const p=g(n,["updateTime"]);p!=null&&y(t,["updateTime"],p);const v=g(n,["description"]);v!=null&&y(t,["description"],v);const x=g(n,["baseModel"]);x!=null&&y(t,["baseModel"],x);const b=g(n,["_self"]);return b!=null&&y(t,["tunedModel"],d6(b)),t}function Wv(n,e){const t={},i=g(n,["sdkHttpResponse"]);i!=null&&y(t,["sdkHttpResponse"],i);const s=g(n,["name"]);s!=null&&y(t,["name"],s);const o=g(n,["state"]);o!=null&&y(t,["state"],O1(o));const l=g(n,["createTime"]);l!=null&&y(t,["createTime"],l);const d=g(n,["startTime"]);d!=null&&y(t,["startTime"],d);const h=g(n,["endTime"]);h!=null&&y(t,["endTime"],h);const p=g(n,["updateTime"]);p!=null&&y(t,["updateTime"],p);const v=g(n,["error"]);v!=null&&y(t,["error"],v);const x=g(n,["description"]);x!=null&&y(t,["description"],x);const b=g(n,["baseModel"]);b!=null&&y(t,["baseModel"],b);const A=g(n,["tunedModel"]);A!=null&&y(t,["tunedModel"],A);const P=g(n,["preTunedModel"]);P!=null&&y(t,["preTunedModel"],P);const F=g(n,["supervisedTuningSpec"]);F!=null&&y(t,["supervisedTuningSpec"],F);const H=g(n,["preferenceOptimizationSpec"]);H!=null&&y(t,["preferenceOptimizationSpec"],H);const X=g(n,["tuningDataStats"]);X!=null&&y(t,["tuningDataStats"],X);const re=g(n,["encryptionSpec"]);re!=null&&y(t,["encryptionSpec"],re);const Q=g(n,["partnerModelTuningSpec"]);Q!=null&&y(t,["partnerModelTuningSpec"],Q);const he=g(n,["customBaseModel"]);he!=null&&y(t,["customBaseModel"],he);const fe=g(n,["experiment"]);fe!=null&&y(t,["experiment"],fe);const Y=g(n,["labels"]);Y!=null&&y(t,["labels"],Y);const k=g(n,["outputUri"]);k!=null&&y(t,["outputUri"],k);const B=g(n,["pipelineJob"]);B!=null&&y(t,["pipelineJob"],B);const O=g(n,["serviceAccount"]);O!=null&&y(t,["serviceAccount"],O);const q=g(n,["tunedModelDisplayName"]);q!=null&&y(t,["tunedModelDisplayName"],q);const G=g(n,["veoTuningSpec"]);return G!=null&&y(t,["veoTuningSpec"],G),t}function m6(n,e){const t={},i=g(n,["sdkHttpResponse"]);i!=null&&y(t,["sdkHttpResponse"],i);const s=g(n,["name"]);s!=null&&y(t,["name"],s);const o=g(n,["metadata"]);o!=null&&y(t,["metadata"],o);const l=g(n,["done"]);l!=null&&y(t,["done"],l);const d=g(n,["error"]);return d!=null&&y(t,["error"],d),t}function kC(n,e){const t={},i=g(n,["gcsUri"]);i!=null&&y(t,["validationDatasetUri"],i);const s=g(n,["vertexDatasetResource"]);return s!=null&&y(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class p6 extends Xo{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Vu(jo.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},t),{preTunedModel:s});return o.baseModel=void 0,await this.tuneInternal(o)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),o=await this.tuneMldevInternal(s);let l="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?l=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(l=o.name.split("/operations/")[0]),{name:l,state:Bv.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=s6(e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>Wv(v))}else{const p=i6(e);return d=Oe("{name}",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>nN(v))}}async listInternal(e){var t,i,s,o;let l,d="",h={};if(this.apiClient.isVertexAI()){const p=l6(e);return d=Oe("tuningJobs",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=c6(v),b=new hC;return Object.assign(b,x),b})}else{const p=a6(e);return d=Oe("tunedModels",p._url),h=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(x=>{const b=x;return b.sdkHttpResponse={headers:v.headers},b})),l.then(v=>{const x=u6(v),b=new hC;return Object.assign(b,x),b})}}async cancel(e){var t,i,s,o;let l="",d={};if(this.apiClient.isVertexAI()){const h=$O(e);l=Oe("{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const h=QO(e);l=Oe("{name}:cancel",h._url),d=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async tuneInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI()){const d=n6(e,e);return o=Oe("tuningJobs",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),s.then(h=>Wv(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let s,o="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=t6(e);return o=Oe("tunedModels",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const v=p;return v.sdkHttpResponse={headers:h.headers},v})),s.then(h=>m6(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class g6{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const _6=1024*1024*8,y6=3,v6=1e3,T6=2,kp="x-goog-upload-status";async function E6(n,e,t){var i;const s=await iN(n,e,t),o=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[kp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function x6(n,e,t){var i;const s=await iN(n,e,t),o=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[kp])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=M1(o),d=new eT;return Object.assign(d,l),d}async function iN(n,e,t){var i,s;let o=0,l=0,d=new zv(new Response),h="upload";for(o=n.size;l<o;){const p=Math.min(_6,o-l),v=n.slice(l,l+p);l+p>=o&&(h+=", finalize");let x=0,b=v6;for(;x<y6&&(d=await t.request({path:"",body:v,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(l),"Content-Length":String(p)}}}),!(!((i=d==null?void 0:d.headers)===null||i===void 0)&&i[kp]));)x++,await S6(b),b=b*T6;if(l+=p,((s=d==null?void 0:d.headers)===null||s===void 0?void 0:s[kp])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return d}async function w6(n){return{size:n.size,type:n.type}}function S6(n){return new Promise(e=>setTimeout(e,n))}class b6{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await E6(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await x6(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await w6(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class C6{create(e,t,i){return new I6(e,t,i)}}class I6{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const DC="x-goog-api-key";class A6{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(DC)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(DC,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const N6="gl-node/";class oT{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=o5(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const s=new A6(this.apiKey);this.apiClient=new jV({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:N6+"web",uploader:new b6,downloader:new g6}),this.models=new cO(this.apiClient),this.live=new sO(this.apiClient,s,new C6),this.batches=new LL(this.apiClient),this.chats=new g4(this.models,this.apiClient),this.caches=new f4(this.apiClient),this.files=new C4(this.apiClient),this.operations=new dO(this.apiClient),this.authTokens=new IO(this.apiClient),this.tunings=new p6(this.apiClient),this.fileSearchStores=new ZO(this.apiClient)}}const R6={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var Dp={};const aT=()=>{try{if(typeof window<"u"&&window.localStorage){const n=localStorage.getItem("nomad_user_api_key");if(n)return n}if(typeof import.meta<"u"&&R6)return"";if(typeof process<"u"&&Dp)return Dp.VITE_API_KEY||""}catch(n){console.warn("Failed to access API key",n)}return""},sN=async()=>{const n=aT();let e="None";if(typeof window<"u"&&window.localStorage&&localStorage.getItem("nomad_user_api_key")?e="LocalStorage":typeof process<"u"&&Dp&&Dp.VITE_API_KEY&&(e="Node Env"),!n)return{success:!1,message:"No API Key found.",source:e};if(n.length<30)return{success:!1,message:`Key too short (${n.length} chars). Check copy-paste.`,source:e};if(n.includes(" "))return{success:!1,message:"Key contains spaces. Please re-paste.",source:e};if(!n.startsWith("AIza"))return{success:!1,message:'Key should start with "AIza". Wrong key?',source:e};try{const i=await new oT({apiKey:n}).models.generateContent({model:"gemini-flash-latest",contents:'Reply with "OK"'});return{success:!0,message:`Connected! Response: ${cr(i)}`,source:e}}catch(t){return{success:!1,message:t.message||t.toString(),source:e}}},M6=["gemini-2.5-flash-lite","gemini-2.0-flash","gemini-flash-latest"],Dr=async n=>{var s;const e=aT();if(!e)throw new Error("API key is missing. Please provide a valid API key in Settings.");const t=new oT({apiKey:e});let i=null;for(const o of M6)try{return console.log(`Trying AI model: ${o}`),await n(t,o)}catch(l){if(console.warn(`Model ${o} failed`,l),i=l,(s=l.message)!=null&&s.includes("403")||l.toString().includes("403"))throw new Error("Invalid API Key (403). Please check your key in Settings.")}throw new Error(`All AI models failed. Last error: ${(i==null?void 0:i.message)||i||"Unknown error"}`)},Bi={"zh-TW":"Traditional Chinese (Taiwan) ()","en-US":"English","ja-JP":"Japanese"},cr=n=>{if(typeof n.text=="string")return n.text;if(typeof n.text=="function")return n.text();if(n.candidates&&n.candidates[0]&&n.candidates[0].content&&n.candidates[0].content.parts&&n.candidates[0].content.parts[0].text)return n.candidates[0].content.parts[0].text;throw new Error("No text found in AI response")},rN=async(n,e)=>(console.warn("Image editing is not supported. Returning original image."),n),lT=async n=>{try{return`https://loremflickr.com/1200/800/${encodeURIComponent(n)},travel,landmark/all`}catch(e){return console.error("Failed to generate cover image:",e),`https://via.placeholder.com/1200x800/D4A574/FFFFFF?text=${encodeURIComponent(n)}`}},oN=async(n,e="zh-TW")=>{const t=Bi[e]||Bi["zh-TW"];return Dr(async(i,s)=>{const o=await i.models.generateContent({model:s,contents:`Help me plan a trip. ${n}`,config:{systemInstruction:`You are a professional travel agent AI. 
                Create a detailed itinerary based on the user's request. 
                
                CRITICAL PLANNING RULES:
                1. **Distance & Logic**: Group attractions that are geographically close to each other on the same day.
                2. **Feasibility**: Ensure the schedule is realistic.
                3. **Language**: All content MUST be in ${t}.
                4. **Travel Info**: You MUST estimate the travel mode and duration to the NEXT activity. This is mandatory for all items except the last one of the day.
                5. **Completeness**: You MUST generate a FULL itinerary with at least 3 activities per day. Do not leave the itinerary empty.
                
                FORMAT REQUIREMENTS:
                Return response in valid JSON format. Do not use Markdown code blocks.
                The JSON must strictly follow this structure:
                {
                    "title": "Trip Title",
                    "startDate": "YYYY-MM-DD",
                    "endDate": "YYYY-MM-DD",
                    "itinerary": [
                        {
                            "id": "unique_id",
                            "day": 1,
                            "time": "09:00",
                            "activity": "Activity Name",
                            "location": "Location Address",
                            "notes": "Tips",
                            "travelToNext": {
                                "mode": "WALK/TRAIN/BUS/CAR",
                                "duration": "15 min",
                                "details": "Route details"
                            }
                        }
                    ],
                    "budget": {
                        "total": 10000,
                        "currency": "TWD",
                        "expenses": []
                    },
                    "packingList": [],
                    "weather": [
                        {
                            "date": "YYYY-MM-DD",
                            "condition": "Sunny",
                            "tempLow": 20,
                            "tempHigh": 30,
                            "icon": ""
                        }
                    ]
                }
                `,responseMimeType:"application/json"}}),l=cr(o);if(l){const d=l.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(d)}throw new Error("Empty response from AI")})},aN=async(n,e,t="zh-TW")=>{const i=Bi[t]||Bi["zh-TW"];return Dr(async(s,o)=>{const l=await s.models.generateContent({model:o,contents:`Help me modify an existing trip plan.
            
            Current Trip JSON:
            ${JSON.stringify(n)}
            
            User Request: "${e}"
            
            INSTRUCTIONS:
            1. Modify the "Current Trip JSON" based on the "User Request".
            2. Keep the same structure and fields.
            3. Update the "itinerary", "bookings", "budget", etc. as needed.
            4. Ensure the response is valid JSON matching the Trip structure.
            5. All content MUST be in ${i}.
            6. Return ONLY the updated JSON.
            `,config:{responseMimeType:"application/json"}}),d=cr(l);if(d){const h=d.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(h)}throw new Error("Empty response from AI")})},lN=async(n,e,t="zh-TW")=>{const i=Bi[t]||Bi["zh-TW"];return Dr(async(s,o)=>{try{const l=await s.models.generateContent({model:o,contents:`I hold a ${n} passport and want to travel to ${e}. 
                Provide visa requirements in STRICT JSON format.
                
                Required JSON Structure:
                {
                  "difficulty": "Easy / Moderate / Hard",
                  "summary": "One sentence summary",
                  "requirements": ["Requirement 1", "Requirement 2"]
                }
                
                Translate all content to ${i}.
                Return ONLY valid JSON.`,config:{responseMimeType:"application/json"}}),d=cr(l);return JSON.parse(d)}catch(l){return console.error(l),null}})},uN=async(n,e="zh-TW")=>{const t=Bi[e]||Bi["zh-TW"];return Dr(async(i,s)=>{try{const o=await i.models.generateContent({model:s,contents:`I am currently in (or planning to go to) ${n}. 
                Provide cultural etiquette guide in STRICT JSON format.
                
                Required JSON Structure:
                {
                  "tipping": "Tipping advice",
                  "dos": ["Do 1", "Do 2"],
                  "donts": ["Don't 1", "Don't 2"],
                  "dressCode": "Dress code advice"
                }
                
                Translate all content to ${t}.
                Return ONLY valid JSON.`,config:{responseMimeType:"application/json"}}),l=cr(o);return JSON.parse(l)}catch(o){return console.error(o),null}})},cN=async(n,e,t="zh-TW")=>{const i=Bi[t]||Bi["zh-TW"];return Dr(async(s,o)=>{try{const l=await s.models.generateContent({model:o,contents:`Tell me about "${e}" at "${n}". 
                Provide a very short fun fact, the best photo spot, and one "pro tip" for visiting.
                Format as simple Markdown (bold keys). Keep it under 100 words.
                Response MUST be in ${i}.`});return cr(l)}catch(l){return console.error("Error fetching attraction guide:",l),""}})},dN=async(n,e="zh-TW")=>{const t=Bi[e]||Bi["zh-TW"];return Dr(async(i,s)=>{try{const o=await i.models.generateContent({model:s,contents:`I am travelling in ${n}. 
                Provide emergency contact info in STRICT JSON format.
                
                Required JSON Structure:
                {
                  "numbers": [
                    {"label": "Title (e.g. Police)", "number": "110"}
                  ],
                  "hospital": {
                    "name": "Name of nearest major hospital in capital",
                    "address": "Address",
                    "phone": "Phone number"
                  }
                }
                
                Translate all labels and values to ${t}.
                Return ONLY valid JSON. Do not include markdown formatting.`}),l=cr(o);if(!l)throw new Error("Empty response");const d=l.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(d)}catch(o){return console.error("Emergency Info Error:",o),null}})},hN=async(n,e="zh-TW")=>{const t=Bi[e]||Bi["zh-TW"];return Dr(async(i,s)=>{try{const o=await i.models.generateContent({model:s,contents:`I am travelling to ${n}. 
                Provide credit card advice in STRICT JSON format.
                
                Required JSON Structure:
                {
                  "bestCards": ["Visa", "Mastercard"],
                  "cashInfo": "Advice on cash usage",
                  "tips": ["Tip 1", "Tip 2"]
                }
                
                Translate all content to ${t}.
                Return ONLY valid JSON.`,config:{responseMimeType:"application/json"}}),l=cr(o);return JSON.parse(l)}catch(o){return console.error(o),null}})},fN=async(n,e="zh-TW")=>Dr(async(t,i)=>{const s=n.map(d=>({id:d.id,activity:d.activity,location:d.location,time:d.time})),o=await t.models.generateContent({model:i,contents:`I have a list of activities for one day. Reorder them to create the most efficient geographical route.
            
            Current Items: ${JSON.stringify(s)}
            
            Return ONLY a JSON array of strings, where each string is the 'id' of the activity in the new order.
            Do not change the time, just the order of visiting.
            Example response: ["id1", "id3", "id2"]`,config:{responseMimeType:"application/json"}}),l=cr(o);if(l)return JSON.parse(l);throw new Error("Empty response")}),mN=async(n,e,t="zh-TW")=>Dr(async(i,s)=>{try{const o=await i.models.generateContent({model:s,contents:`Translate the following text to ${e}.
                Text: "${n}"
                
                Only provide the translated text.`});return cr(o)}catch(o){return console.error("Translation Error:",o),null}}),pN=async(n,e,t="zh-TW")=>{const i=Bi[t]||Bi["zh-TW"];return Dr(async(s,o)=>{try{const l=n.map(h=>`${h.date}: ${h.condition}, ${h.tempLow}C - ${h.tempHigh}C`).join(`
`),d=await s.models.generateContent({model:o,contents:`I am travelling to ${e}. Here is the weather forecast:
                ${l}
                
                Based on this weather, give me a VERY SHORT, ONE-LINE clothing advice summary.
                Example: "It's rainy and cold, so bring a heavy coat and umbrella."
                Keep it under 20 words.
                Response MUST be in ${i}.`});return cr(d)}catch(l){return console.error("Clothing Advice Error:",l),""}})},uT=async(n,e)=>{try{return await Dr(async(t,i)=>{try{const s=await t.models.generateContent({model:i,contents:`What is the current exchange rate from ${n} to ${e}?
                    Return ONLY the number. Example: 0.23
                    If you are unsure, return "null".`}),o=cr(s),l=parseFloat(o);return isNaN(l)?null:l.toString()}catch(s){return console.error("Exchange Rate Error:",s),null}})}catch(t){return console.warn("Call AI failed for exchange rate:",t),null}},P6=Object.freeze(Object.defineProperty({__proto__:null,editTravelPhoto:rN,generateCoverImage:lT,generateTripPlan:oN,getApiKey:aT,getAttractionGuide:cN,getClothingAdvice:pN,getCreditCardAdvice:hN,getCulturalEtiquette:uN,getEmergencyInfo:dN,getExchangeRate:uT,getTranslation:mN,getVisaRequirements:lN,optimizeRoute:fN,testGeminiConnection:sN,updateTripPlan:aN},Symbol.toStringTag,{value:"Module"})),k6=({onSave:n,onCancel:e,settings:t,currentUser:i})=>{const s=nn[t.language]||nn["zh-TW"],[o,l]=Z.useState(""),[d,h]=Z.useState(""),[p,v]=Z.useState(""),[x,b]=Z.useState(null),[A,P]=Z.useState(!1),F=Z.useRef(null),H=Q=>{var fe;const he=(fe=Q.target.files)==null?void 0:fe[0];if(he){const Y=new FileReader;Y.onloadend=()=>{b(Y.result)},Y.readAsDataURL(he)}},X=async()=>{if(!o){alert("Please enter title");return}P(!0);try{const Q=await lT(o);b(Q)}catch(Q){console.error(Q),alert("Error")}finally{P(!1)}},re=async Q=>{if(Q.preventDefault(),!o||!d)return;let he=x;if(!he)try{const Y=`Cinematic travel photography of ${o}, 4k, high quality, sunny day`,k=encodeURIComponent(Y),B=Math.floor(Math.random()*1e6);he=`https://image.pollinations.ai/prompt/${k}?width=1600&height=900&nologo=true&seed=${B}&model=flux`}catch(Y){console.error("Failed to generate default cover",Y),he=`https://via.placeholder.com/1600x900/D4A574/FFFFFF?text=${encodeURIComponent(o)}`}const fe={id:Date.now().toString(),title:o,startDate:d,endDate:p,itinerary:[],coverImage:he,ownerId:i.id,userIds:[i.id],collaborators:[]};n(fe)};return _.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe pt-12",children:[_.jsxs("div",{className:"px-4 py-3 flex items-center gap-2 bg-paper sticky top-0 z-10 border-b border-sand/50",children:[_.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-white text-gray-500 active:scale-90 transition-transform",children:_.jsx(vs,{className:"w-6 h-6"})}),_.jsx("h2",{className:"text-lg font-bold text-ink",children:s.new_trip})]}),_.jsxs("form",{onSubmit:re,className:"p-6 space-y-8 flex-1 overflow-y-auto no-scrollbar pb-32",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase",children:s.trip_destination_title}),_.jsx("div",{className:"relative",children:_.jsx("input",{type:"text",required:!0,value:o,onChange:Q=>l(Q.target.value),placeholder:"...",className:"w-full p-5 bg-white rounded-3xl border border-sand focus:border-coral focus:ring-1 focus:ring-coral/50 transition-all text-lg font-bold text-ink outline-none placeholder:text-gray-300 shadow-sm"})})]}),_.jsxs("div",{className:"space-y-3",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase",children:s.cover_photo}),_.jsxs("div",{className:"w-full aspect-video rounded-3xl overflow-hidden bg-white border-2 border-dashed border-sand relative shadow-inner",children:[x?_.jsx("img",{src:x,alt:"Cover",className:"w-full h-full object-cover"}):_.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-300",children:[_.jsx($c,{className:"w-10 h-10 mb-2 opacity-50"}),_.jsx("span",{className:"text-xs font-bold",children:"Preview"})]}),x&&_.jsx("button",{type:"button",onClick:()=>b(null),className:"absolute top-2 right-2 bg-black/50 text-white p-1.5 rounded-full backdrop-blur-sm",children:_.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),_.jsxs("div",{className:"flex gap-3 mt-2",children:[_.jsxs("button",{type:"button",onClick:()=>{var Q;return(Q=F.current)==null?void 0:Q.click()},className:"flex-1 py-3 bg-white text-gray-600 rounded-2xl font-bold text-sm border border-sand hover:border-coral hover:text-coral transition-colors flex items-center justify-center gap-1.5 shadow-sm",children:[_.jsx($c,{className:"w-4 h-4"})," ",s.upload_photo]}),_.jsx("input",{type:"file",ref:F,className:"hidden",accept:"image/*",onChange:H}),_.jsx("button",{type:"button",onClick:X,disabled:A||!o,className:"flex-1 py-3 bg-purple-50 text-purple-600 rounded-2xl font-bold text-sm hover:bg-purple-100 transition-colors flex items-center justify-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed border border-purple-100",children:A?_.jsx("span",{className:"animate-pulse",children:"..."}):_.jsxs(_.Fragment,{children:[_.jsx($a,{className:"w-4 h-4"})," ",s.ai_generate_cover]})})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsxs("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase flex items-center gap-1",children:[_.jsx(Ov,{className:"w-3 h-3 text-coral"})," ",s.start_date]}),_.jsx("input",{type:"date",required:!0,value:d,onChange:Q=>h(Q.target.value),className:"w-full p-4 bg-white rounded-2xl border border-sand focus:border-coral outline-none text-sm font-bold text-ink shadow-sm"})]}),_.jsxs("div",{className:"space-y-3",children:[_.jsxs("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase flex items-center gap-1",children:[_.jsx(Ov,{className:"w-3 h-3 text-gray-400"})," ",s.end_date]}),_.jsx("input",{type:"date",value:p,onChange:Q=>v(Q.target.value),className:"w-full p-4 bg-white rounded-2xl border border-sand focus:border-coral outline-none text-sm font-bold text-ink shadow-sm"})]})]}),_.jsxs("div",{className:"pt-4",children:[_.jsxs("button",{type:"submit",className:"w-full py-4 bg-coral text-white rounded-2xl font-bold text-lg shadow-float active:scale-[0.98] transition-all flex items-center justify-center gap-2 hover:bg-coralDark ring-4 ring-white",children:[_.jsx("span",{children:s.create_trip}),_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 text-white/70",children:_.jsx("path",{fillRule:"evenodd",d:"M3 10a.75.75 0 01.75-.75h10.638L10.23 5.29a.75.75 0 111.04-1.08l5.5 5.25a.75.75 0 010 1.08l-5.5 5.25a.75.75 0 11-1.04-1.08l4.158-3.96H3.75A.75.75 0 013 10z",clipRule:"evenodd"})})]}),_.jsx("p",{className:"text-center text-xs text-gray-400 mt-6 font-medium",children:s.add_trip_hint})]})]})]})},D6=({settings:n,onBack:e})=>{const t=(n==null?void 0:n.language)||"zh-TW",i=nn[t]||nn["zh-TW"],[s,o]=Z.useState(null),[l,d]=Z.useState(null),[h,p]=Z.useState(""),[v,x]=Z.useState(!1),[b,A]=Z.useState(null),P=Z.useRef(null),F=X=>{var Q;const re=(Q=X.target.files)==null?void 0:Q[0];if(re){const he=new FileReader;he.onloadend=()=>{const fe=he.result;o(fe),d(null),A(null)},he.readAsDataURL(re)}},H=async()=>{if(!(!s||!h)){x(!0),A(null);try{const X=await rN(s,h);d(X)}catch(X){A("Error"),console.error(X)}finally{x(!1)}}};return _.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[_.jsxs("div",{className:"px-5 py-4 pt-9 bg-paper sticky top-0 z-10 flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("button",{onClick:e,children:_.jsx(vs,{className:"w-6 h-6 text-gray-500"})}),_.jsxs("h2",{className:"text-xl font-extrabold text-ink flex items-center gap-2",children:[_.jsx($a,{className:"w-6 h-6 text-coral"}),i.magic_editor_title]})]}),_.jsx("span",{className:"text-[10px] font-bold bg-white text-coral border border-coral/20 px-2 py-1 rounded-lg uppercase tracking-wider shadow-sm",children:"Beta"})]}),_.jsx("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 pb-32 no-scrollbar",children:s?_.jsxs("div",{className:"space-y-6 animate-fade-in",children:[_.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-6 snap-x no-scrollbar px-2",children:[_.jsxs("div",{className:"snap-center shrink-0 w-full bg-white p-3 pb-12 rounded-sm shadow-polaroid rotate-1 relative transition-transform hover:rotate-0 duration-300",children:[_.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden mb-2",children:_.jsx("img",{src:s,alt:"Original",className:"w-full h-full object-cover"})}),_.jsx("div",{className:"absolute bottom-4 left-4 font-handwriting text-gray-500 text-sm font-bold",children:"#Original"}),_.jsx("button",{onClick:()=>{o(null),d(null),p("")},className:"absolute -top-2 -right-2 bg-white text-ink p-2 rounded-full shadow-lg border border-sand hover:text-coral",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:_.jsx("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"})})})]}),l&&_.jsxs("div",{className:"snap-center shrink-0 w-full bg-white p-3 pb-12 rounded-sm shadow-polaroid -rotate-1 relative transition-transform hover:rotate-0 duration-300 ring-2 ring-coral/20",children:[_.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden mb-2",children:_.jsx("img",{src:l,alt:"Magic Result",className:"w-full h-full object-cover"})}),_.jsxs("div",{className:"absolute bottom-4 left-4 font-handwriting text-coral font-bold flex items-center gap-1",children:[_.jsx($a,{className:"w-4 h-4"})," #MagicEdit"]})]})]}),_.jsxs("div",{className:"bg-white p-2 rounded-3xl shadow-card border border-sand",children:[_.jsxs("div",{className:"p-4",children:[_.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2 uppercase tracking-wider",children:"Prompt"}),_.jsx("textarea",{value:h,onChange:X=>p(X.target.value),placeholder:i.magic_prompt_placeholder,className:"w-full p-4 rounded-2xl bg-paper border-0 focus:ring-2 focus:ring-coral/50 outline-none text-base resize-none h-24 placeholder:text-gray-300 font-medium text-ink"})]}),b&&_.jsxs("div",{className:"mx-4 mb-2 text-red-500 text-xs bg-red-50 p-3 rounded-xl flex items-center gap-2 font-bold",children:[_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:_.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),b]}),_.jsx("div",{className:"p-2",children:_.jsx("button",{onClick:H,disabled:v||!h.trim(),className:`w-full py-4 rounded-2xl font-bold text-white shadow-lg flex items-center justify-center gap-2 transition-all ${v||!h.trim()?"bg-gray-300 cursor-not-allowed text-gray-500 shadow-none":"bg-coral hover:bg-coralDark hover:shadow-coral/30 active:scale-[0.98]"}`,children:v?_.jsxs(_.Fragment,{children:[_.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[_.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),_.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i.generating]}):_.jsxs(_.Fragment,{children:[_.jsx($a,{className:"w-5 h-5 stroke-[2]"}),i.start_magic]})})})]})]}):_.jsxs("div",{onClick:()=>{var X;return(X=P.current)==null?void 0:X.click()},className:"border-2 border-dashed border-sand rounded-3xl h-80 flex flex-col items-center justify-center bg-white cursor-pointer active:scale-[0.98] transition-all hover:border-coral hover:bg-white/80 group shadow-card",children:[_.jsx("div",{className:"w-20 h-20 bg-paper rounded-full shadow-inner flex items-center justify-center mb-5 group-hover:scale-110 transition-transform",children:_.jsx($c,{className:"w-10 h-10 text-coral"})}),_.jsx("span",{className:"text-ink font-bold text-lg",children:i.upload_hint}),_.jsx("input",{type:"file",ref:P,onChange:F,className:"hidden",accept:"image/*"})]})})]})},L6="modulepreload",V6=function(n){return"/"+n},LC={},Rg=function(e,t,i){let s=Promise.resolve();if(t&&t.length>0){let l=function(p){return Promise.all(p.map(v=>Promise.resolve(v).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=l(t.map(p=>{if(p=V6(p),p in LC)return;LC[p]=!0;const v=p.endsWith(".css"),x=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${x}`))return;const b=document.createElement("link");if(b.rel=v?"stylesheet":L6,v||(b.as="script"),b.crossOrigin="",b.href=p,h&&b.setAttribute("nonce",h),document.head.appendChild(b),v)return new Promise((A,P)=>{b.addEventListener("load",A),b.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(l){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=l,window.dispatchEvent(d),!d.defaultPrevented)throw l}return s.then(l=>{for(const d of l||[])d.status==="rejected"&&o(d.reason);return e().catch(o)})},O6=({items:n,onUpdateItems:e,settings:t})=>{const i=nn[t.language]||nn["zh-TW"],[s,o]=Z.useState(""),[l,d]=Z.useState(""),[h,p]=Z.useState(!1),v=()=>{if(!s.trim())return;const A={id:Date.now().toString(),item:s,bought:!1,notes:l},P=[...n,A];e(P),o(""),d(""),p(!1)},x=A=>{const P=n.map(F=>F.id===A?{...F,bought:!F.bought}:F);e(P)},b=A=>{const P=n.filter(F=>F.id!==A);e(P)};return _.jsxs("div",{className:"pb-40",children:[_.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-soft text-center mt-2 border border-sand relative overflow-hidden mb-6",children:[_.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-coral"}),_.jsx("h3",{className:"text-gray-400 text-sm font-bold uppercase tracking-widest mb-2",children:i.shopping_list}),_.jsxs("div",{className:"text-5xl font-black text-ink mb-2 tracking-tight",children:[(n==null?void 0:n.filter(A=>A.bought).length)||0,_.jsx("span",{className:"text-2xl text-gray-300 mx-2",children:"/"}),_.jsx("span",{className:"text-3xl text-gray-400",children:(n==null?void 0:n.length)||0})]})]}),(n==null?void 0:n.length)>0?_.jsx("div",{className:"space-y-3",children:n==null?void 0:n.map(A=>_.jsxs("div",{className:`bg-white p-4 rounded-2xl border ${A.bought?"border-green-200 bg-green-50/30":"border-sand"} shadow-card flex items-center justify-between group transition-all`,children:[_.jsxs("div",{className:"flex items-center gap-4 flex-1",onClick:()=>x(A.id),children:[_.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center cursor-pointer transition-colors ${A.bought?"bg-green-500 border-green-500":"border-gray-300 hover:border-coral"}`,children:A.bought&&_.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),_.jsxs("div",{children:[_.jsx("div",{className:`font-bold text-lg ${A.bought?"text-gray-400 line-through":"text-ink"}`,children:A.item}),A.notes&&_.jsx("div",{className:"text-xs text-gray-400 font-medium mt-0.5",children:A.notes})]})]}),_.jsx("button",{onClick:()=>b(A.id),className:"p-2 text-gray-300 hover:text-red-500 transition-colors",children:_.jsx(ol,{className:"w-5 h-5"})})]},A.id))}):_.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[_.jsx("div",{className:"w-16 h-16 bg-sand/30 rounded-full flex items-center justify-center text-gray-400",children:_.jsx(R1,{className:"w-8 h-8"})}),_.jsxs("p",{className:"text-gray-400 font-medium",children:[i.no_shopping_items||"No items",_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:i.click_add})]})]}),h&&_.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>p(!1),children:_.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:A=>A.stopPropagation(),children:[_.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_activity}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.activity_name}),_.jsx("input",{value:s,onChange:A=>o(A.target.value),placeholder:i.placeholder_item||"Item name",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal",autoFocus:!0})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.notes}),_.jsx("input",{value:l,onChange:A=>d(A.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-medium border-none shadow-sm outline-none placeholder:font-normal"})]}),_.jsx("button",{onClick:v,disabled:!s.trim(),className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 mt-4 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:i.confirm})]})]})}),_.jsx("button",{onClick:()=>p(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-coral text-white rounded-full shadow-xl shadow-coral/40 flex items-center justify-center z-30 hover:bg-coralDark active:scale-90 transition-all",children:_.jsx(bg,{className:"w-8 h-8 stroke-[2]"})})]})};var Lp=x1();const U6=({trip:n,settings:e,onUpdateTrip:t,onOpenQuickExpense:i})=>{var we;const s=nn[e.language]||nn["zh-TW"],[o,l]=Z.useState(null),[d,h]=Z.useState(""),[p,v]=Z.useState(!1),[x,b]=Z.useState(!1),A=Z.useRef(null),[P,F]=Z.useState(!1),[H,X]=Z.useState(null),[re,Q]=Z.useState(1),[he,fe]=Z.useState("09:00"),[Y,k]=Z.useState(""),[B,O]=Z.useState(""),[q,G]=Z.useState(""),[W,z]=Z.useState(null),[He,Qe]=Z.useState("TRAIN"),[se,Se]=Z.useState(""),[be,it]=Z.useState(""),[Pe,K]=Z.useState(null),[me,Ie]=Z.useState(!1),le=Z.useMemo(()=>{const pe=n.itinerary||[],De={};return[...pe].sort((nt,lt)=>nt.time.localeCompare(lt.time)).forEach(nt=>{const lt=nt.day||1;De[lt]||(De[lt]=[]),De[lt].push(nt)}),De},[n.itinerary]),_e=Z.useMemo(()=>Object.keys(le).map(Number).sort((pe,De)=>pe-De),[le]);Z.useEffect(()=>{o||At()},[o]),Z.useEffect(()=>()=>{window.speechSynthesis.cancel()},[]);const Ce=async()=>{const pe=[`${n.title} (${n.startDate} - ${n.endDate})`];_e.forEach(je=>{pe.push(`
Day ${je}:`),le[je].forEach(nt=>{pe.push(`${nt.time} ${nt.activity}`),nt.travelToNext&&pe.push(`   ${nt.travelToNext.mode} (${nt.travelToNext.duration})`)})});const De=pe.join(`
`);try{navigator.share?await navigator.share({title:n.title,text:De}):(await navigator.clipboard.writeText(De),alert(s.share_success))}catch(je){console.error("Error sharing:",je)}},Fe=async()=>{if(!(!n.weather||n.weather.length===0)){Ie(!0);try{const pe=await pN(n.weather,n.title,e.language);K(pe)}catch{K("")}finally{Ie(!1)}}},Be=async(pe,De)=>{l({name:pe,location:De}),h(""),v(!0);try{const je=await cN(De,pe);h(je||"")}catch{h("")}finally{v(!1)}},Ye=()=>{if(x){At();return}if(!d)return;const pe=new SpeechSynthesisUtterance(d);pe.lang=e.language==="en-US"?"en-US":"zh-TW",pe.rate=1,pe.onend=()=>b(!1),A.current=pe,window.speechSynthesis.speak(pe),b(!0)},At=()=>{window.speechSynthesis.cancel(),b(!1)},Jt=async pe=>{const De=le[pe];if(!De||(De==null?void 0:De.length)<3){alert(s.optimize_route_min_items||"Need at least 3 items to optimize.");return}z(pe);try{const nt=(await fN(De,e.language)).map(pn=>De.find(Ts=>Ts.id===pn)).filter(Boolean),lt=De.map(pn=>pn.time).sort(),rn=nt.map((pn,Ts)=>({...pn,time:lt[Ts]})),vi=[...(n.itinerary||[]).filter(pn=>pn.day!==pe),...rn];t==null||t({...n,itinerary:vi})}catch(je){console.error("Optimization failed",je),alert("Route optimization failed.")}finally{z(null)}},ct=pe=>{X(pe.id),Q(pe.day),fe(pe.time),k(pe.activity),O(pe.location),G(pe.notes||""),pe.travelToNext?(Qe(pe.travelToNext.mode),Se(pe.travelToNext.duration),it(pe.travelToNext.details||"")):(Se(""),it("")),F(!0)},mn=async()=>{var lt;if(!Y)return;let pe=null;if(B)try{const{geocodeAddress:rn}=await Rg(async()=>{const{geocodeAddress:pn}=await Promise.resolve().then(()=>uU);return{geocodeAddress:pn}},void 0),jn=rn(B),vi=new Promise((pn,Ts)=>setTimeout(()=>Ts(new Error("Geocoding timeout")),5e3));pe=await Promise.race([jn,vi])}catch(rn){console.error("Auto-geocoding failed or timed out",rn)}const De=H?(lt=n.itinerary)==null?void 0:lt.find(rn=>rn.id===H):null,je={id:H||Date.now().toString(),day:Number(re),time:he,activity:Y,location:B,notes:q,coordinates:pe||(De==null?void 0:De.coordinates)||null,lat:(pe==null?void 0:pe.lat)??(De==null?void 0:De.lat)??null,lng:(pe==null?void 0:pe.lng)??(De==null?void 0:De.lng)??null,attachments:(De==null?void 0:De.attachments)||[],...se?{travelToNext:{mode:He,duration:se,details:be}}:{}};let nt;H?nt=(n.itinerary||[]).map(rn=>rn.id===H?je:rn):nt=[...n.itinerary||[],je],t==null||t({...n,itinerary:nt}),X(null),k(""),O(""),G(""),Se(""),it(""),F(!1)},Rn=pe=>{if(confirm(s.delete_trip_confirm.replace("{title}",s.itinerary))){const De=(n.itinerary||[]).filter(je=>je.id!==pe);t==null||t({...n,itinerary:De})}},Yt=pe=>{pe&&window.open(pe,"_blank")},Nt=pe=>{switch(pe){case"WALK":return _.jsx(QD,{className:"w-4 h-4"});case"TRAIN":return _.jsx(ub,{className:"w-4 h-4"});case"BUS":return _.jsx(ZD,{className:"w-4 h-4"});case"CAR":return _.jsx(FD,{className:"w-4 h-4"});case"FLIGHT":return _.jsx(w1,{className:"w-4 h-4"});default:return _.jsx(ub,{className:"w-4 h-4"})}},Rt=()=>{var pe,De;return!n.weather||((pe=n.weather)==null?void 0:pe.length)===0?null:_.jsxs("div",{className:"mb-6",children:[_.jsxs("div",{className:"flex items-center justify-between mb-3",children:[_.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1",children:s.weather}),_.jsxs("button",{onClick:Fe,disabled:me,className:"text-xs font-bold text-coral flex items-center gap-1 hover:bg-coral/10 px-2 py-1 rounded-lg transition-colors",children:[_.jsx(Uv,{className:"w-3 h-3"}),me?"...":""]})]}),_.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar pb-2",children:(De=n.weather)==null?void 0:De.map((je,nt)=>_.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center justify-center gap-1 bg-white border border-sand p-3 rounded-2xl min-w-[70px] shadow-sm",children:[_.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:je.date}),_.jsx("span",{className:"text-2xl drop-shadow-sm",children:je.icon}),_.jsxs("span",{className:"text-xs font-bold text-ink",children:[je.tempHigh,""]})]},nt))}),Pe&&_.jsxs("div",{className:"mt-4 bg-white p-5 rounded-3xl shadow-card border border-sand animate-fade-in relative",children:[_.jsx("button",{onClick:()=>K(null),className:"absolute top-3 right-3 text-gray-300 hover:text-gray-500",children:_.jsx(ol,{className:"w-4 h-4"})}),_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx("div",{className:"bg-orange-100 p-2 rounded-full text-orange-500 shrink-0",children:_.jsx(Uv,{className:"w-5 h-5"})}),_.jsxs("div",{children:[_.jsx("h5",{className:"font-bold text-ink mb-2",children:"AI "}),_.jsx("div",{className:"prose prose-sm text-gray-600 leading-relaxed whitespace-pre-line",children:Pe})]})]})]})]})},Mt=e==null?void 0:e.minimalistMode;return _.jsxs("div",{className:"pb-40 relative min-h-full",children:[_.jsxs("div",{className:"sticky top-0 z-20 bg-paper/95 backdrop-blur-md border-b border-sand/50 py-3 mb-6 -mx-5 px-5 flex items-center justify-between shadow-sm",children:[_.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar flex-1 mr-2",children:[_.jsx("span",{className:"text-xs font-bold text-gray-400 shrink-0 mr-1",children:s.nav_quick_jump}),_e.map(pe=>_.jsxs("button",{onClick:()=>{const De=document.getElementById(`day-header-${pe}`);De&&De.scrollIntoView({behavior:"smooth",block:"start"})},className:"flex-shrink-0 px-4 py-1.5 bg-white border border-sand rounded-full font-bold text-ink text-xs hover:border-coral hover:text-coral hover:shadow-md active:bg-coral active:text-white transition-all whitespace-nowrap",children:[s.day," ",pe]},`nav-${pe}`))]}),_.jsx("button",{onClick:Ce,className:"p-2 bg-white rounded-full border border-sand text-coral hover:bg-coral hover:text-white transition-colors shadow-sm shrink-0",children:_.jsx(JD,{className:"w-5 h-5"})})]}),!Mt&&Rt(),((we=n.itinerary)==null?void 0:we.length)>0?_.jsxs("div",{children:[!Mt&&_.jsx("h4",{className:"text-xs font-bold text-gray-400 mb-4 uppercase tracking-wider ml-1",children:s.itinerary}),_e.map(pe=>{var De;return _.jsxs("div",{className:"mb-8 scroll-mt-48",id:`day-header-${pe}`,children:[_.jsxs("div",{className:"flex items-center gap-3 mb-4 sticky top-[60px] bg-paper py-2 z-10 border-b border-sand/50 shadow-sm",children:[_.jsxs("div",{className:"bg-coral text-white px-3 py-1 rounded-lg text-sm font-bold shadow-sm",children:[s.day," ",pe]}),_.jsx("div",{className:"h-px bg-sand flex-1"}),_.jsxs("button",{onClick:()=>Jt(pe),disabled:W===pe,className:"flex items-center gap-1 text-xs font-bold text-coral bg-white border border-coral px-2 py-1 rounded-lg hover:bg-coral hover:text-white transition-colors disabled:opacity-50",children:[W===pe?_.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"}):_.jsx($a,{className:"w-3 h-3"}),s.optimize_route||"AI Route"]})]}),_.jsx("div",{className:`space-y-0 relative ${Mt?"":"border-l-2 border-sand ml-4"}`,children:(De=le[pe])==null?void 0:De.map((je,nt)=>_.jsxs("div",{className:"relative group",children:[_.jsxs("div",{className:`relative ${Mt?"mb-4 border-b border-sand pb-4":"pl-8 pb-10 last:pb-0"}`,children:[!Mt&&_.jsx("div",{className:"absolute -left-[7px] top-1.5 w-3.5 h-3.5 rounded-full border-2 border-paper shadow-sm bg-gray-300 group-hover:bg-coral transition-colors"}),_.jsxs("div",{className:"transition-all opacity-90 group-hover:opacity-100",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsx("div",{className:"flex items-center gap-2",children:_.jsx("span",{className:"text-xs font-bold font-mono text-coral bg-coral/10 px-2 py-1 rounded-lg",children:je.time})}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("button",{onClick:lt=>{lt.stopPropagation(),i(je)},className:"p-1.5 bg-white text-gray-400 rounded-full border border-sand hover:text-green-600 hover:border-green-600 shadow-sm",title:"",children:_.jsx(S1,{className:"w-3 h-3"})}),_.jsx("button",{onClick:lt=>{lt.stopPropagation(),ct(je)},className:"p-1.5 bg-white text-gray-400 rounded-full border border-sand hover:text-coral hover:border-coral shadow-sm",title:"",children:_.jsx(N1,{className:"w-3 h-3"})}),_.jsx("button",{onClick:lt=>{lt.stopPropagation(),Rn(je.id)},className:"p-1.5 bg-white text-red-400 rounded-full border border-red-200 hover:bg-red-50 hover:text-red-600 hover:border-red-500 shadow-sm transition-colors",title:"",children:_.jsx(ol,{className:"w-3 h-3"})})]})]}),_.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-card border border-transparent hover:border-sand transition-all relative",children:[_.jsx("button",{onClick:lt=>{lt.stopPropagation(),Be(je.activity,je.location)},className:"absolute top-4 right-4 text-gray-300 hover:text-coral transition-colors",children:_.jsx(BD,{className:"w-5 h-5"})}),_.jsx("h4",{className:`font-bold text-ink ${Mt?"text-base":"text-lg"} mb-1 pr-6`,children:je.activity}),_.jsxs("div",{onClick:()=>Yt(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(je.location)}`),className:"flex items-center gap-1.5 text-sm text-gray-500 cursor-pointer hover:text-coral truncate mt-1",children:[_.jsx(Vv,{className:"w-3.5 h-3.5 shrink-0 text-coral"}),je.location]}),je.notes&&!Mt&&_.jsx("p",{className:"text-sm text-gray-600 mt-3 pt-3 border-t border-gray-50 leading-relaxed",children:je.notes})]})]})]}),je.travelToNext&&!Mt&&_.jsxs("div",{className:"pl-8 pb-10 relative",children:[_.jsx("div",{className:"absolute left-[0px] top-0 bottom-0 w-0.5 border-l-2 border-dotted border-gray-300 -ml-[1px]"}),_.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-sand rounded-xl p-3 w-fit max-w-[80%]",children:[_.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-sand flex items-center justify-center text-gray-500 shadow-sm shrink-0",children:Nt(je.travelToNext.mode)}),_.jsx("div",{children:_.jsxs("div",{className:"text-xs font-bold text-gray-500 flex items-center gap-1",children:[je.travelToNext.duration,je.travelToNext.details&&_.jsxs("span",{className:"font-normal text-gray-400",children:[" ",je.travelToNext.details]})]})})]})]})]},je.id||nt))})]},pe)})]}):_.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[_.jsx("div",{className:"w-16 h-16 bg-sand/30 rounded-full flex items-center justify-center text-gray-400",children:_.jsx(A1,{className:"w-8 h-8"})}),_.jsxs("p",{className:"text-gray-400 font-medium",children:[s.no_itinerary,_.jsx("br",{}),_.jsx("span",{className:"text-xs",children:s.click_add})]})]}),o&&typeof document<"u"&&Lp.createPortal(_.jsx("div",{className:"fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>l(null),children:_.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[80vh] overflow-y-auto",onClick:pe=>pe.stopPropagation(),children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsx("h3",{className:"text-xl font-bold text-ink",children:o.name}),_.jsx("button",{onClick:Ye,className:`p-2 rounded-full ${x?"bg-coral text-white":"bg-gray-100 text-gray-500"}`,children:_.jsx(F6,{className:"w-5 h-5"})})]}),p?_.jsx("div",{className:"flex justify-center py-10",children:_.jsx("div",{className:"w-8 h-8 border-4 border-coral border-t-transparent rounded-full animate-spin"})}):_.jsx("div",{className:"prose prose-sm text-gray-600 leading-relaxed whitespace-pre-line",children:d})]})}),document.body),P&&typeof document<"u"&&Lp.createPortal(_.jsx("div",{className:"fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>F(!1),children:_.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",onClick:pe=>pe.stopPropagation(),children:[_.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:H?s.edit_activity:s.add_activity}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:s.day}),_.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-sand px-3",children:[_.jsx("span",{className:"text-sm font-bold text-gray-400 mr-2",children:s.day}),_.jsx("input",{type:"number",min:"1",value:re,onChange:pe=>Q(parseInt(pe.target.value)||1),className:"w-full bg-transparent p-3 text-lg font-bold border-none outline-none text-ink"})]})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:s.time}),_.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-sand px-3",children:[_.jsx(UD,{className:"w-5 h-5 text-gray-400 mr-2"}),_.jsx("input",{type:"time",value:he,onChange:pe=>fe(pe.target.value),className:"w-full bg-transparent p-3 text-lg font-bold border-none outline-none text-ink"})]})]})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:s.activity_name}),_.jsx("input",{value:Y,onChange:pe=>k(pe.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300",autoFocus:!0})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:s.location}),_.jsx("input",{value:B,onChange:pe=>O(pe.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300"})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:s.notes}),_.jsx("textarea",{value:q,onChange:pe=>G(pe.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-medium border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300 min-h-[80px]"})]}),_.jsxs("div",{className:"pt-4 border-t border-sand",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 mb-2 block",children:s.travel_to_next}),_.jsx("div",{className:"flex gap-2 mb-3 overflow-x-auto no-scrollbar",children:["WALK","TRAIN","BUS","CAR","FLIGHT"].map(pe=>_.jsx("button",{onClick:()=>Qe(pe),className:`p-2 rounded-lg border ${He===pe?"bg-ink text-white border-ink":"bg-white text-gray-400 border-sand"}`,children:Nt(pe)},pe))}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsx("input",{value:se,onChange:pe=>Se(pe.target.value),placeholder:"1h 30m",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"}),_.jsx("input",{value:be,onChange:pe=>it(pe.target.value),placeholder:"...",className:"w-full bg-white p-3 rounded-xl text-sm font-medium border-none shadow-sm outline-none"})]})]}),_.jsx("div",{className:"sticky bottom-0 bg-paper pt-4 mt-4 border-t border-sand z-10 pb-6",children:_.jsx("button",{onClick:mn,disabled:!Y,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:H?s.confirm:s.add_activity})})]})]})}),document.body),_.jsx("button",{onClick:()=>{X(null),Q(1),fe("09:00"),k(""),O(""),G(""),Se(""),it(""),F(!0)},className:"fixed bottom-24 right-6 w-14 h-14 bg-coral text-white rounded-full shadow-xl shadow-coral/40 flex items-center justify-center z-30 hover:bg-coralDark active:scale-90 transition-all",children:_.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})},F6=({className:n})=>_.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:n,children:[_.jsx("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 001.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06zM18.584 5.106a.75.75 0 011.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 11-1.06-1.06 8.25 8.25 0 000-11.668.75.75 0 010-1.06z"}),_.jsx("path",{d:"M15.932 7.757a.75.75 0 011.061 0 6 6 0 010 8.486.75.75 0 01-1.06-1.061 4.5 4.5 0 000-6.364.75.75 0 010-1.06z"})]}),cT=[{code:"TWD",symbol:"NT$",name:""},{code:"JPY",symbol:"",name:""},{code:"USD",symbol:"$",name:""},{code:"EUR",symbol:"",name:""},{code:"KRW",symbol:"",name:""},{code:"CNY",symbol:"",name:""},{code:"HKD",symbol:"HK$",name:""},{code:"GBP",symbol:"",name:""},{code:"THB",symbol:"",name:""},{code:"SGD",symbol:"S$",name:""}],du=n=>{const e=cT.find(t=>t.code===n);return e?e.symbol:n},B6=(n,e,t)=>{const i={};e.forEach(p=>i[p]=0),n.forEach(p=>{i[p.payer]===void 0&&(i[p.payer]=0),(p.participants&&p.participants.length>0?p.participants:e).forEach(x=>{i[x]===void 0&&(i[x]=0)})}),n.forEach(p=>{const v=p.amount,x=p.payer,b=p.participants&&p.participants.length>0?p.participants:e.filter(P=>P!=="ME"&&P!==t).length>0?e:[x];i[x]+=v;const A=v/b.length;b.forEach(P=>{i[P]-=A})});const s=[],o=[];Object.entries(i).forEach(([p,v])=>{const x=Math.round(v*100)/100;x<-.01?s.push({id:p,amount:x}):x>.01&&o.push({id:p,amount:x})}),s.sort((p,v)=>p.amount-v.amount),o.sort((p,v)=>v.amount-p.amount);const l=[];let d=0,h=0;for(;d<s.length&&h<o.length;){const p=s[d],v=o[h],x=Math.min(Math.abs(p.amount),v.amount);x>0&&l.push({from:p.id,to:v.id,amount:Math.round(x)}),p.amount+=x,v.amount-=x,Math.abs(p.amount)<.01&&d++,v.amount<.01&&h++}return l},wh=(n,e,t)=>n?n===e||n==="ME"?" (You)":(t==null?void 0:t[n])||(typeof n=="string"&&n.length>4?n.substring(0,4)+"...":n):"Unknown",z6=({trip:n,settings:e,onUpdateTrip:t,currentUserId:i})=>{var Ye,At,Jt,ct,mn,Rn,Yt,Nt,Rt,Mt;const s=nn[e.language]||nn["zh-TW"],[o,l]=Z.useState("EXPENSES"),[d,h]=Z.useState(!1),[p,v]=Z.useState(""),[x,b]=Z.useState(""),[A,P]=Z.useState(i),[F,H]=Z.useState([]),[X,re]=Z.useState("Cash"),[Q,he]=Z.useState(((Ye=n.budget)==null?void 0:Ye.currency)||"TWD"),[fe,Y]=Z.useState(""),[k,B]=Z.useState(0),[O,q]=Z.useState(!1),[G,W]=Z.useState(null),[z,He]=Z.useState(!1),[Qe,se]=Z.useState(""),Se=Z.useMemo(()=>{const we=[...n.userIds||[]];return we.includes(i)||we.push(i),Array.from(new Set(we))},[n.userIds,i]),be=()=>{var pe,De;const we=parseInt(Qe);if(!isNaN(we)&&we>=0){const je={...n,budget:{...n.budget,total:we,currency:((pe=n.budget)==null?void 0:pe.currency)||"TWD",expenses:((De=n.budget)==null?void 0:De.expenses)||[]}};t==null||t(je)}He(!1)};Z.useEffect(()=>{var we;d&&(he(((we=n.budget)==null?void 0:we.currency)||"TWD"),Y(""),P(i),H(Se))},[d,(At=n.budget)==null?void 0:At.currency,i,n.userIds]),Z.useEffect(()=>{(async()=>{var De;const pe=((De=n.budget)==null?void 0:De.currency)||"TWD";if(W(null),Q!==pe&&(e.apiKey||void 0||typeof window<"u"&&localStorage.getItem("nomad_user_api_key"))){q(!0);try{const nt=await uT(Q,pe);nt?Y(nt):W(" (API Key )")}catch(nt){console.error(nt),W("")}q(!1)}})()},[Q,(Jt=n.budget)==null?void 0:Jt.currency,e.apiKey]),Z.useEffect(()=>{const we=parseFloat(x)||0,pe=parseFloat(fe)||1;B(Math.round(we*pe))},[x,fe]);const it=()=>{var rn,jn,vi;if(!p||!x)return;const we=parseFloat(x);if(we<=0){alert(s.amount_invalid||"Amount must be greater than 0");return}const pe=parseFloat(fe)||1,De=Math.round(we*pe),je={id:Date.now().toString(),title:p,amount:De,category:"Other",date:new Date().toISOString().split("T")[0],payer:A,paymentMethod:X,participants:F,originalCurrency:Q,originalAmount:we,exchangeRate:pe},nt=((rn=n.budget)==null?void 0:rn.expenses)||[],lt={...n,budget:{...n.budget,total:((jn=n.budget)==null?void 0:jn.total)||0,currency:((vi=n.budget)==null?void 0:vi.currency)||"TWD",expenses:[je,...nt]}};t==null||t(lt),h(!1),v(""),b("")},Pe=we=>{var nt,lt,rn;const De=(((nt=n.budget)==null?void 0:nt.expenses)||[]).filter(jn=>jn.id!==we),je={...n,budget:{...n.budget,total:((lt=n.budget)==null?void 0:lt.total)||0,currency:((rn=n.budget)==null?void 0:rn.currency)||"TWD",expenses:De}};t==null||t(je)},K=we=>{F.includes(we)?F.length>1&&H(F.filter(pe=>pe!==we)):H([...F,we])},me=(((ct=n.budget)==null?void 0:ct.expenses)||[]).reduce((we,pe)=>we+(pe.amount||0),0),Ie=((mn=n.budget)==null?void 0:mn.total)||0,le=Ie>0?me/Ie*100:0,_e=isNaN(le)?0:Math.min(le,100),Ce=((Rn=n.budget)==null?void 0:Rn.currency)||"TWD",Fe=du(Ce),Be=B6(((Yt=n.budget)==null?void 0:Yt.expenses)||[],Se,i);return _.jsxs("div",{className:"pb-32",children:[_.jsxs("div",{className:"flex gap-2 mb-6 bg-white p-1 rounded-2xl border border-sand",children:[_.jsxs("button",{onClick:()=>l("EXPENSES"),className:`flex-1 py-3 text-sm font-bold rounded-xl transition-all flex items-center justify-center gap-2 ${o==="EXPENSES"?"bg-ink text-white shadow-md":"text-gray-400 hover:bg-sand/30"}`,children:[_.jsx(I1,{className:"w-4 h-4"}),s.expense_list||""]}),_.jsxs("button",{onClick:()=>l("SETTLEMENT"),className:`flex-1 py-3 text-sm font-bold rounded-xl transition-all flex items-center justify-center gap-2 ${o==="SETTLEMENT"?"bg-ink text-white shadow-md":"text-gray-400 hover:bg-sand/30"}`,children:[_.jsx(lb,{className:"w-4 h-4"}),s.settlement||""]})]}),o==="EXPENSES"&&_.jsxs("div",{className:"bg-ink text-white p-6 rounded-3xl shadow-xl mb-8 relative overflow-hidden",children:[_.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -mr-10 -mt-10 blur-2xl"}),_.jsxs("div",{className:"relative z-10",children:[_.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-1",children:s.budget_total}),_.jsx("div",{className:"flex items-center gap-2 mb-6 group",children:z?_.jsxs("div",{className:"flex items-center",children:[_.jsx("span",{className:"text-2xl mr-1 font-black",children:Fe}),_.jsx("input",{type:"number",value:Qe,onChange:we=>se(we.target.value),onBlur:be,onKeyDown:we=>we.key==="Enter"&&be(),className:"bg-transparent text-4xl font-black text-white border-b-2 border-white/20 outline-none w-48",autoFocus:!0})]}):_.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[_.jsxs("h2",{className:"text-4xl font-black cursor-pointer hover:opacity-80 transition-opacity flex items-center",onClick:()=>{se(Ie.toString()),He(!0)},children:[_.jsx("span",{className:"text-2xl mr-1",children:Fe}),(Ie||0).toLocaleString()]}),_.jsx("button",{onClick:()=>{se(Ie.toString()),He(!0)},className:"p-2 bg-white/10 rounded-full hover:bg-white/20 transition-colors flex-shrink-0",children:_.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]})}),_.jsxs("div",{className:"mb-2 flex justify-between text-sm font-bold",children:[_.jsx("span",{className:"text-gray-300",children:s.budget_spent}),_.jsxs("span",{children:[Fe,(me||0).toLocaleString()]})]}),_.jsx("div",{className:"h-3 bg-gray-700 rounded-full overflow-hidden mb-4",children:_.jsx("div",{className:`h-full rounded-full ${_e>90?"bg-red-500":"bg-coral"}`,style:{width:`${_e}%`}})}),_.jsxs("div",{className:"flex justify-between text-xs text-gray-400 font-medium",children:[_.jsxs("span",{children:[_e.toFixed(1),"%"]}),_.jsxs("span",{children:[": ",Fe,(me||0).toLocaleString()]})]})]})]}),o==="EXPENSES"&&_.jsxs("div",{className:"space-y-4",children:[_.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1 mb-2",children:s.expense_list}),(Rt=(Nt=n.budget)==null?void 0:Nt.expenses)==null?void 0:Rt.map(we=>{var pe;return _.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-sand flex items-center justify-between group",children:[_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-xs font-bold border-2 ${we.payer===i?"bg-coral/10 text-coral border-coral":"bg-gray-100 text-gray-500 border-gray-200"}`,children:(wh(we.payer,i)||"?").slice(0,1)}),_.jsxs("div",{children:[_.jsx("h4",{className:"font-bold text-ink",children:we.title}),_.jsxs("p",{className:"text-xs text-gray-400",children:[we.date,"  ",we.paymentMethod," ",(we.participants||[]).length===Se.length?" Everyone":` ${(we.participants||[]).length} ppl`]}),we.originalCurrency&&we.originalCurrency!==Ce&&_.jsxs("p",{className:"text-xs text-coral font-medium mt-0.5",children:[du(we.originalCurrency),(pe=we.originalAmount)==null?void 0:pe.toLocaleString(),_.jsx("span",{className:"text-gray-400 mx-1",children:""}),Fe,(we.amount||0).toLocaleString()]})]})]}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsxs("span",{className:"font-bold text-ink text-lg",children:[Fe,(we.amount||0).toLocaleString()]}),_.jsx("button",{onClick:()=>Pe(we.id),className:"text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all",children:_.jsx(ol,{className:"w-5 h-5"})})]})]},we.id)}),(!((Mt=n.budget)!=null&&Mt.expenses)||n.budget.expenses.length===0)&&_.jsx("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:s.no_expenses})]}),o==="SETTLEMENT"&&_.jsx("div",{className:"space-y-6",children:_.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-sm border border-sand",children:[_.jsxs("h3",{className:"text-lg font-bold text-ink mb-4 flex items-center gap-2",children:[_.jsx(lb,{className:"w-5 h-5 text-coral"}),""]}),Be.length>0?_.jsx("div",{className:"space-y-4",children:Be.map((we,pe)=>_.jsxs("div",{className:"flex items-center justify-between p-4 bg-sand/20 rounded-xl relative overflow-hidden",children:[_.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 opacity-10 pointer-events-none",children:_.jsx("svg",{className:"w-24 h-24 text-ink",fill:"currentColor",viewBox:"0 0 24 24",children:_.jsx("path",{d:"M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"})})}),_.jsxs("div",{className:"flex flex-col items-start z-10",children:[_.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:"FROM"}),_.jsx("span",{className:"font-bold text-ink text-lg",children:wh(we.from,i)})]}),_.jsxs("div",{className:"flex flex-col items-center z-10",children:[_.jsx("span",{className:"text-xs font-bold text-coral bg-coral/10 px-2 py-1 rounded-full mb-1",children:"PAY"}),_.jsxs("span",{className:"font-black text-2xl text-ink",children:[Fe,(we.amount||0).toLocaleString()]})]}),_.jsxs("div",{className:"flex flex-col items-end z-10",children:[_.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:"TO"}),_.jsx("span",{className:"font-bold text-ink text-lg",children:wh(we.to,i)})]})]},pe))}):_.jsxs("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:[_.jsx("p",{children:" "}),_.jsx("p",{className:"text-xs opacity-70 mt-1",children:""})]})]})}),d&&_.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>h(!1),children:_.jsxs("div",{className:"bg-paper w-full max-w-md rounded-3xl shadow-2xl p-6 animate-slide-up relative max-h-[90vh] overflow-y-auto no-scrollbar",onClick:we=>we.stopPropagation(),children:[_.jsx("button",{onClick:()=>h(!1),className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:_.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),_.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:s.add_expense}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:s.expense_item}),_.jsx("input",{value:p,onChange:we=>v(we.target.value),placeholder:": ",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal",autoFocus:!0})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:s.amount}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("select",{value:Q,onChange:we=>he(we.target.value),className:"bg-white rounded-xl border-none shadow-sm px-3 font-bold text-ink outline-none",children:cT.map(we=>_.jsx("option",{value:we.code,children:we.code},we.code))}),_.jsxs("div",{className:"flex-1 flex items-center bg-white rounded-xl border-none shadow-sm px-4",children:[_.jsx("span",{className:"text-gray-400 font-bold mr-2",children:du(Q)}),_.jsx("input",{value:x,onChange:we=>b(we.target.value),type:"number",placeholder:"0",className:"w-full bg-transparent py-4 text-xl font-bold border-none outline-none placeholder:font-normal"})]})]})]}),Q!==Ce&&_.jsxs("div",{className:"space-y-1 bg-sand/30 p-3 rounded-xl",children:[_.jsxs("div",{className:"flex justify-between items-center mb-2",children:[_.jsxs("label",{className:"text-xs font-bold text-gray-500",children:[" (",Q,"  ",Ce,")"]}),_.jsxs("span",{className:"text-xs font-bold text-coral",children:[" ",Fe,(k||0).toLocaleString()]})]}),_.jsx("div",{className:"relative",children:_.jsx("input",{value:fe,onChange:we=>Y(we.target.value),type:"number",step:"0.01",placeholder:O?"...":"Exchange Rate",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none",disabled:O})})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:" (Payer)"}),_.jsx("div",{className:"flex flex-wrap gap-2",children:Se.map(we=>_.jsx("button",{onClick:()=>P(we),className:`px-4 py-2 rounded-full text-sm font-bold transition-all border-2 ${A===we?"bg-ink text-white border-ink":"bg-white text-gray-400 border-transparent hover:border-gray-200"}`,children:wh(we,i)},we))})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:" (Split)"}),_.jsx("div",{className:"grid grid-cols-2 gap-2",children:Se.map(we=>_.jsxs("button",{onClick:()=>K(we),className:`p-3 rounded-xl flex items-center gap-2 transition-all border-2 ${F.includes(we)?"bg-coral/5 border-coral text-ink":"bg-white border-transparent grayscale opacity-60 hover:opacity-100"}`,children:[_.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold ${F.includes(we)?"bg-coral text-white":"bg-gray-200 text-gray-500"}`,children:we===i?"Me":we.slice(0,1)}),_.jsx("span",{className:"text-sm font-bold truncate",children:wh(we,i)})]},we))})]}),_.jsx("div",{className:"space-y-3 pt-4",children:_.jsx("button",{onClick:it,disabled:!p||!x,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:"+ "})})]})]})}),_.jsx("button",{onClick:()=>h(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-ink text-white rounded-full shadow-xl shadow-ink/40 flex items-center justify-center z-30 hover:scale-105 active:scale-95 transition-all",children:_.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})},q6=({trip:n,settings:e,onUpdateTrip:t})=>{var Y;const i=nn[e.language]||nn["zh-TW"],[s,o]=Z.useState(!1),[l,d]=Z.useState("FLIGHT"),[h,p]=Z.useState(""),[v,x]=Z.useState(""),[b,A]=Z.useState(""),[P,F]=Z.useState(""),[H,X]=Z.useState(""),[re,Q]=Z.useState(""),he=()=>{if(!h)return;const B=[{id:Date.now().toString(),type:l,airline:h,number:v||"N/A",origin:b||"-",destination:P||"-",departureTime:H?`${H} ${re}`:re||"00:00",arrivalTime:"-",status:"Confirmed",bookingUrl:""},...n.bookings||[]];t==null||t({...n,bookings:B}),p(""),x(""),A(""),F(""),X(""),Q(""),o(!1)},fe=k=>{if(confirm(i.delete_trip_confirm.replace("{title}",i.bookings))){const O=(n.bookings||[]).filter(q=>q.id!==k);t==null||t({...n,bookings:O})}};return _.jsxs("div",{className:"pb-32",children:[_.jsxs("div",{className:"space-y-4",children:[(Y=n.bookings)==null?void 0:Y.map(k=>_.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-sand relative group",children:[_.jsxs("div",{className:"flex justify-between items-start mb-4",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"w-10 h-10 bg-blue-50 text-blue-500 rounded-xl flex items-center justify-center",children:k.type==="FLIGHT"?_.jsx(w1,{className:"w-5 h-5"}):_.jsx(b1,{className:"w-5 h-5"})}),_.jsxs("div",{children:[_.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:k.type==="FLIGHT"?i.booking_type_flight:k.type==="HOTEL"?i.booking_type_hotel:k.type==="TRAIN"?i.booking_type_train:k.type}),_.jsx("h4",{className:"font-bold text-ink text-lg",children:k.airline})]})]}),_.jsx("div",{className:"text-right",children:_.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-bold ${k.status==="Confirmed"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-500"}`,children:k.status})})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[_.jsxs("div",{children:[_.jsx("p",{className:"text-xs text-gray-400 font-bold mb-1",children:i.label_departure||"DEPARTURE"}),_.jsx("p",{className:"text-ink font-bold text-lg",children:k.origin}),_.jsx("p",{className:"text-sm text-gray-500",children:k.departureTime})]}),_.jsxs("div",{className:"text-right",children:[_.jsx("p",{className:"text-xs text-gray-400 font-bold mb-1",children:i.label_arrival||"ARRIVAL"}),_.jsx("p",{className:"text-ink font-bold text-lg",children:k.destination}),_.jsx("p",{className:"text-sm text-gray-500",children:k.arrivalTime})]})]}),_.jsxs("div",{className:"pt-4 border-t border-sand flex justify-between items-center",children:[_.jsxs("div",{className:"text-xs text-gray-400 font-mono",children:[i.label_ref||"REF",": ",_.jsx("span",{className:"text-ink font-bold",children:k.number})]}),_.jsx("button",{onClick:()=>fe(k.id),className:"text-gray-300 hover:text-red-500 transition-colors",children:_.jsx(ol,{className:"w-4 h-4"})})]})]},k.id)),(!n.bookings||n.bookings.length===0)&&_.jsx("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:i.no_bookings})]}),s&&_.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>o(!1),children:_.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",onClick:k=>k.stopPropagation(),children:[_.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_booking}),_.jsxs("div",{className:"space-y-4",children:[_.jsx("div",{className:"flex bg-white rounded-xl p-1 shadow-sm mb-4",children:["FLIGHT","HOTEL","TRAIN"].map(k=>_.jsx("button",{onClick:()=>d(k),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${l===k?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:k==="FLIGHT"?i.booking_type_flight:k==="HOTEL"?i.booking_type_hotel:k==="TRAIN"?i.booking_type_train:k},k))}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.provider}),_.jsx("input",{value:h,onChange:k=>p(k.target.value),placeholder:i.placeholder_provider,className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none",autoFocus:!0})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.ref_number}),_.jsx("input",{value:v,onChange:k=>x(k.target.value),placeholder:i.placeholder_pnr,className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.date}),_.jsx("input",{type:"date",value:H,onChange:k=>X(k.target.value),className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.origin}),_.jsx("input",{value:b,onChange:k=>A(k.target.value),placeholder:i.placeholder_origin,className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.label_destination}),_.jsx("input",{value:P,onChange:k=>F(k.target.value),placeholder:i.placeholder_dest,className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]})]}),_.jsx("button",{onClick:he,disabled:!h,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 mt-4 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:i.confirm})]})]})}),_.jsx("button",{onClick:()=>o(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-blue-500 text-white rounded-full shadow-xl shadow-blue-500/40 flex items-center justify-center z-30 hover:scale-105 active:scale-95 transition-all",children:_.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})};function gN(n,e){const t=Z.useRef(e);Z.useEffect(function(){e!==t.current&&n.attributionControl!=null&&(t.current!=null&&n.attributionControl.removeAttribution(t.current),e!=null&&n.attributionControl.addAttribution(e)),t.current=e},[n,e])}const G6=1;function H6(n){return Object.freeze({__version:G6,map:n})}function _N(n,e){return Object.freeze({...n,...e})}const dT=Z.createContext(null);function Mg(){const n=Z.use(dT);if(n==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}function yN(n){function e(t,i){const{instance:s,context:o}=n(t).current;Z.useImperativeHandle(i,()=>s);const{children:l}=t;return l==null?null:af.createElement(dT,{value:o},l)}return Z.forwardRef(e)}function j6(n){function e(t,i){const[s,o]=Z.useState(!1),{instance:l}=n(t,o).current;Z.useImperativeHandle(i,()=>l),Z.useEffect(function(){s&&l.update()},[l,s,t.children]);const d=l._contentNode;return d?Lp.createPortal(t.children,d):null}return Z.forwardRef(e)}function K6(n){function e(t,i){const{instance:s}=n(t).current;return Z.useImperativeHandle(i,()=>s),null}return Z.forwardRef(e)}function hT(n,e){const t=Z.useRef(void 0);Z.useEffect(function(){return e!=null&&n.instance.on(e),t.current=e,function(){t.current!=null&&n.instance.off(t.current),t.current=null}},[n,e])}function Pg(n,e){const t=n.pane??e.pane;return t?{...n,pane:t}:n}function W6(n,e){return function(i,s){const o=Mg(),l=n(Pg(i,o),o);return gN(o.map,i.attribution),hT(l.current,i.eventHandlers),e(l.current,o,i,s),l}}var Lh={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var Y6=Lh.exports,VC;function J6(){return VC||(VC=1,(function(n,e){(function(t,i){i(e)})(Y6,(function(t){var i="1.9.4";function s(u){var f,E,C,N;for(E=1,C=arguments.length;E<C;E++){N=arguments[E];for(f in N)u[f]=N[f]}return u}var o=Object.create||(function(){function u(){}return function(f){return u.prototype=f,new u}})();function l(u,f){var E=Array.prototype.slice;if(u.bind)return u.bind.apply(u,E.call(arguments,1));var C=E.call(arguments,2);return function(){return u.apply(f,C.length?C.concat(E.call(arguments)):arguments)}}var d=0;function h(u){return"_leaflet_id"in u||(u._leaflet_id=++d),u._leaflet_id}function p(u,f,E){var C,N,D,j;return j=function(){C=!1,N&&(D.apply(E,N),N=!1)},D=function(){C?N=arguments:(u.apply(E,arguments),setTimeout(j,f),C=!0)},D}function v(u,f,E){var C=f[1],N=f[0],D=C-N;return u===C&&E?u:((u-N)%D+D)%D+N}function x(){return!1}function b(u,f){if(f===!1)return u;var E=Math.pow(10,f===void 0?6:f);return Math.round(u*E)/E}function A(u){return u.trim?u.trim():u.replace(/^\s+|\s+$/g,"")}function P(u){return A(u).split(/\s+/)}function F(u,f){Object.prototype.hasOwnProperty.call(u,"options")||(u.options=u.options?o(u.options):{});for(var E in f)u.options[E]=f[E];return u.options}function H(u,f,E){var C=[];for(var N in u)C.push(encodeURIComponent(E?N.toUpperCase():N)+"="+encodeURIComponent(u[N]));return(!f||f.indexOf("?")===-1?"?":"&")+C.join("&")}var X=/\{ *([\w_ -]+) *\}/g;function re(u,f){return u.replace(X,function(E,C){var N=f[C];if(N===void 0)throw new Error("No value provided for variable "+E);return typeof N=="function"&&(N=N(f)),N})}var Q=Array.isArray||function(u){return Object.prototype.toString.call(u)==="[object Array]"};function he(u,f){for(var E=0;E<u.length;E++)if(u[E]===f)return E;return-1}var fe="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Y(u){return window["webkit"+u]||window["moz"+u]||window["ms"+u]}var k=0;function B(u){var f=+new Date,E=Math.max(0,16-(f-k));return k=f+E,window.setTimeout(u,E)}var O=window.requestAnimationFrame||Y("RequestAnimationFrame")||B,q=window.cancelAnimationFrame||Y("CancelAnimationFrame")||Y("CancelRequestAnimationFrame")||function(u){window.clearTimeout(u)};function G(u,f,E){if(E&&O===B)u.call(f);else return O.call(window,l(u,f))}function W(u){u&&q.call(window,u)}var z={__proto__:null,extend:s,create:o,bind:l,get lastId(){return d},stamp:h,throttle:p,wrapNum:v,falseFn:x,formatNum:b,trim:A,splitWords:P,setOptions:F,getParamString:H,template:re,isArray:Q,indexOf:he,emptyImageUrl:fe,requestFn:O,cancelFn:q,requestAnimFrame:G,cancelAnimFrame:W};function He(){}He.extend=function(u){var f=function(){F(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},E=f.__super__=this.prototype,C=o(E);C.constructor=f,f.prototype=C;for(var N in this)Object.prototype.hasOwnProperty.call(this,N)&&N!=="prototype"&&N!=="__super__"&&(f[N]=this[N]);return u.statics&&s(f,u.statics),u.includes&&(Qe(u.includes),s.apply(null,[C].concat(u.includes))),s(C,u),delete C.statics,delete C.includes,C.options&&(C.options=E.options?o(E.options):{},s(C.options,u.options)),C._initHooks=[],C.callInitHooks=function(){if(!this._initHooksCalled){E.callInitHooks&&E.callInitHooks.call(this),this._initHooksCalled=!0;for(var D=0,j=C._initHooks.length;D<j;D++)C._initHooks[D].call(this)}},f},He.include=function(u){var f=this.prototype.options;return s(this.prototype,u),u.options&&(this.prototype.options=f,this.mergeOptions(u.options)),this},He.mergeOptions=function(u){return s(this.prototype.options,u),this},He.addInitHook=function(u){var f=Array.prototype.slice.call(arguments,1),E=typeof u=="function"?u:function(){this[u].apply(this,f)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(E),this};function Qe(u){if(!(typeof L>"u"||!L||!L.Mixin)){u=Q(u)?u:[u];for(var f=0;f<u.length;f++)u[f]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var se={on:function(u,f,E){if(typeof u=="object")for(var C in u)this._on(C,u[C],f);else{u=P(u);for(var N=0,D=u.length;N<D;N++)this._on(u[N],f,E)}return this},off:function(u,f,E){if(!arguments.length)delete this._events;else if(typeof u=="object")for(var C in u)this._off(C,u[C],f);else{u=P(u);for(var N=arguments.length===1,D=0,j=u.length;D<j;D++)N?this._off(u[D]):this._off(u[D],f,E)}return this},_on:function(u,f,E,C){if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}if(this._listens(u,f,E)===!1){E===this&&(E=void 0);var N={fn:f,ctx:E};C&&(N.once=!0),this._events=this._events||{},this._events[u]=this._events[u]||[],this._events[u].push(N)}},_off:function(u,f,E){var C,N,D;if(this._events&&(C=this._events[u],!!C)){if(arguments.length===1){if(this._firingCount)for(N=0,D=C.length;N<D;N++)C[N].fn=x;delete this._events[u];return}if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}var j=this._listens(u,f,E);if(j!==!1){var te=C[j];this._firingCount&&(te.fn=x,this._events[u]=C=C.slice()),C.splice(j,1)}}},fire:function(u,f,E){if(!this.listens(u,E))return this;var C=s({},f,{type:u,target:this,sourceTarget:f&&f.sourceTarget||this});if(this._events){var N=this._events[u];if(N){this._firingCount=this._firingCount+1||1;for(var D=0,j=N.length;D<j;D++){var te=N[D],ue=te.fn;te.once&&this.off(u,ue,te.ctx),ue.call(te.ctx||this,C)}this._firingCount--}}return E&&this._propagateEvent(C),this},listens:function(u,f,E,C){typeof u!="string"&&console.warn('"string" type argument expected');var N=f;typeof f!="function"&&(C=!!f,N=void 0,E=void 0);var D=this._events&&this._events[u];if(D&&D.length&&this._listens(u,N,E)!==!1)return!0;if(C){for(var j in this._eventParents)if(this._eventParents[j].listens(u,f,E,C))return!0}return!1},_listens:function(u,f,E){if(!this._events)return!1;var C=this._events[u]||[];if(!f)return!!C.length;E===this&&(E=void 0);for(var N=0,D=C.length;N<D;N++)if(C[N].fn===f&&C[N].ctx===E)return N;return!1},once:function(u,f,E){if(typeof u=="object")for(var C in u)this._on(C,u[C],f,!0);else{u=P(u);for(var N=0,D=u.length;N<D;N++)this._on(u[N],f,E,!0)}return this},addEventParent:function(u){return this._eventParents=this._eventParents||{},this._eventParents[h(u)]=u,this},removeEventParent:function(u){return this._eventParents&&delete this._eventParents[h(u)],this},_propagateEvent:function(u){for(var f in this._eventParents)this._eventParents[f].fire(u.type,s({layer:u.target,propagatedFrom:u.target},u),!0)}};se.addEventListener=se.on,se.removeEventListener=se.clearAllEventListeners=se.off,se.addOneTimeEventListener=se.once,se.fireEvent=se.fire,se.hasEventListeners=se.listens;var Se=He.extend(se);function be(u,f,E){this.x=E?Math.round(u):u,this.y=E?Math.round(f):f}var it=Math.trunc||function(u){return u>0?Math.floor(u):Math.ceil(u)};be.prototype={clone:function(){return new be(this.x,this.y)},add:function(u){return this.clone()._add(Pe(u))},_add:function(u){return this.x+=u.x,this.y+=u.y,this},subtract:function(u){return this.clone()._subtract(Pe(u))},_subtract:function(u){return this.x-=u.x,this.y-=u.y,this},divideBy:function(u){return this.clone()._divideBy(u)},_divideBy:function(u){return this.x/=u,this.y/=u,this},multiplyBy:function(u){return this.clone()._multiplyBy(u)},_multiplyBy:function(u){return this.x*=u,this.y*=u,this},scaleBy:function(u){return new be(this.x*u.x,this.y*u.y)},unscaleBy:function(u){return new be(this.x/u.x,this.y/u.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=it(this.x),this.y=it(this.y),this},distanceTo:function(u){u=Pe(u);var f=u.x-this.x,E=u.y-this.y;return Math.sqrt(f*f+E*E)},equals:function(u){return u=Pe(u),u.x===this.x&&u.y===this.y},contains:function(u){return u=Pe(u),Math.abs(u.x)<=Math.abs(this.x)&&Math.abs(u.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}};function Pe(u,f,E){return u instanceof be?u:Q(u)?new be(u[0],u[1]):u==null?u:typeof u=="object"&&"x"in u&&"y"in u?new be(u.x,u.y):new be(u,f,E)}function K(u,f){if(u)for(var E=f?[u,f]:u,C=0,N=E.length;C<N;C++)this.extend(E[C])}K.prototype={extend:function(u){var f,E;if(!u)return this;if(u instanceof be||typeof u[0]=="number"||"x"in u)f=E=Pe(u);else if(u=me(u),f=u.min,E=u.max,!f||!E)return this;return!this.min&&!this.max?(this.min=f.clone(),this.max=E.clone()):(this.min.x=Math.min(f.x,this.min.x),this.max.x=Math.max(E.x,this.max.x),this.min.y=Math.min(f.y,this.min.y),this.max.y=Math.max(E.y,this.max.y)),this},getCenter:function(u){return Pe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,u)},getBottomLeft:function(){return Pe(this.min.x,this.max.y)},getTopRight:function(){return Pe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(u){var f,E;return typeof u[0]=="number"||u instanceof be?u=Pe(u):u=me(u),u instanceof K?(f=u.min,E=u.max):f=E=u,f.x>=this.min.x&&E.x<=this.max.x&&f.y>=this.min.y&&E.y<=this.max.y},intersects:function(u){u=me(u);var f=this.min,E=this.max,C=u.min,N=u.max,D=N.x>=f.x&&C.x<=E.x,j=N.y>=f.y&&C.y<=E.y;return D&&j},overlaps:function(u){u=me(u);var f=this.min,E=this.max,C=u.min,N=u.max,D=N.x>f.x&&C.x<E.x,j=N.y>f.y&&C.y<E.y;return D&&j},isValid:function(){return!!(this.min&&this.max)},pad:function(u){var f=this.min,E=this.max,C=Math.abs(f.x-E.x)*u,N=Math.abs(f.y-E.y)*u;return me(Pe(f.x-C,f.y-N),Pe(E.x+C,E.y+N))},equals:function(u){return u?(u=me(u),this.min.equals(u.getTopLeft())&&this.max.equals(u.getBottomRight())):!1}};function me(u,f){return!u||u instanceof K?u:new K(u,f)}function Ie(u,f){if(u)for(var E=f?[u,f]:u,C=0,N=E.length;C<N;C++)this.extend(E[C])}Ie.prototype={extend:function(u){var f=this._southWest,E=this._northEast,C,N;if(u instanceof _e)C=u,N=u;else if(u instanceof Ie){if(C=u._southWest,N=u._northEast,!C||!N)return this}else return u?this.extend(Ce(u)||le(u)):this;return!f&&!E?(this._southWest=new _e(C.lat,C.lng),this._northEast=new _e(N.lat,N.lng)):(f.lat=Math.min(C.lat,f.lat),f.lng=Math.min(C.lng,f.lng),E.lat=Math.max(N.lat,E.lat),E.lng=Math.max(N.lng,E.lng)),this},pad:function(u){var f=this._southWest,E=this._northEast,C=Math.abs(f.lat-E.lat)*u,N=Math.abs(f.lng-E.lng)*u;return new Ie(new _e(f.lat-C,f.lng-N),new _e(E.lat+C,E.lng+N))},getCenter:function(){return new _e((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new _e(this.getNorth(),this.getWest())},getSouthEast:function(){return new _e(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(u){typeof u[0]=="number"||u instanceof _e||"lat"in u?u=Ce(u):u=le(u);var f=this._southWest,E=this._northEast,C,N;return u instanceof Ie?(C=u.getSouthWest(),N=u.getNorthEast()):C=N=u,C.lat>=f.lat&&N.lat<=E.lat&&C.lng>=f.lng&&N.lng<=E.lng},intersects:function(u){u=le(u);var f=this._southWest,E=this._northEast,C=u.getSouthWest(),N=u.getNorthEast(),D=N.lat>=f.lat&&C.lat<=E.lat,j=N.lng>=f.lng&&C.lng<=E.lng;return D&&j},overlaps:function(u){u=le(u);var f=this._southWest,E=this._northEast,C=u.getSouthWest(),N=u.getNorthEast(),D=N.lat>f.lat&&C.lat<E.lat,j=N.lng>f.lng&&C.lng<E.lng;return D&&j},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(u,f){return u?(u=le(u),this._southWest.equals(u.getSouthWest(),f)&&this._northEast.equals(u.getNorthEast(),f)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function le(u,f){return u instanceof Ie?u:new Ie(u,f)}function _e(u,f,E){if(isNaN(u)||isNaN(f))throw new Error("Invalid LatLng object: ("+u+", "+f+")");this.lat=+u,this.lng=+f,E!==void 0&&(this.alt=+E)}_e.prototype={equals:function(u,f){if(!u)return!1;u=Ce(u);var E=Math.max(Math.abs(this.lat-u.lat),Math.abs(this.lng-u.lng));return E<=(f===void 0?1e-9:f)},toString:function(u){return"LatLng("+b(this.lat,u)+", "+b(this.lng,u)+")"},distanceTo:function(u){return Be.distance(this,Ce(u))},wrap:function(){return Be.wrapLatLng(this)},toBounds:function(u){var f=180*u/40075017,E=f/Math.cos(Math.PI/180*this.lat);return le([this.lat-f,this.lng-E],[this.lat+f,this.lng+E])},clone:function(){return new _e(this.lat,this.lng,this.alt)}};function Ce(u,f,E){return u instanceof _e?u:Q(u)&&typeof u[0]!="object"?u.length===3?new _e(u[0],u[1],u[2]):u.length===2?new _e(u[0],u[1]):null:u==null?u:typeof u=="object"&&"lat"in u?new _e(u.lat,"lng"in u?u.lng:u.lon,u.alt):f===void 0?null:new _e(u,f,E)}var Fe={latLngToPoint:function(u,f){var E=this.projection.project(u),C=this.scale(f);return this.transformation._transform(E,C)},pointToLatLng:function(u,f){var E=this.scale(f),C=this.transformation.untransform(u,E);return this.projection.unproject(C)},project:function(u){return this.projection.project(u)},unproject:function(u){return this.projection.unproject(u)},scale:function(u){return 256*Math.pow(2,u)},zoom:function(u){return Math.log(u/256)/Math.LN2},getProjectedBounds:function(u){if(this.infinite)return null;var f=this.projection.bounds,E=this.scale(u),C=this.transformation.transform(f.min,E),N=this.transformation.transform(f.max,E);return new K(C,N)},infinite:!1,wrapLatLng:function(u){var f=this.wrapLng?v(u.lng,this.wrapLng,!0):u.lng,E=this.wrapLat?v(u.lat,this.wrapLat,!0):u.lat,C=u.alt;return new _e(E,f,C)},wrapLatLngBounds:function(u){var f=u.getCenter(),E=this.wrapLatLng(f),C=f.lat-E.lat,N=f.lng-E.lng;if(C===0&&N===0)return u;var D=u.getSouthWest(),j=u.getNorthEast(),te=new _e(D.lat-C,D.lng-N),ue=new _e(j.lat-C,j.lng-N);return new Ie(te,ue)}},Be=s({},Fe,{wrapLng:[-180,180],R:6371e3,distance:function(u,f){var E=Math.PI/180,C=u.lat*E,N=f.lat*E,D=Math.sin((f.lat-u.lat)*E/2),j=Math.sin((f.lng-u.lng)*E/2),te=D*D+Math.cos(C)*Math.cos(N)*j*j,ue=2*Math.atan2(Math.sqrt(te),Math.sqrt(1-te));return this.R*ue}}),Ye=6378137,At={R:Ye,MAX_LATITUDE:85.0511287798,project:function(u){var f=Math.PI/180,E=this.MAX_LATITUDE,C=Math.max(Math.min(E,u.lat),-E),N=Math.sin(C*f);return new be(this.R*u.lng*f,this.R*Math.log((1+N)/(1-N))/2)},unproject:function(u){var f=180/Math.PI;return new _e((2*Math.atan(Math.exp(u.y/this.R))-Math.PI/2)*f,u.x*f/this.R)},bounds:(function(){var u=Ye*Math.PI;return new K([-u,-u],[u,u])})()};function Jt(u,f,E,C){if(Q(u)){this._a=u[0],this._b=u[1],this._c=u[2],this._d=u[3];return}this._a=u,this._b=f,this._c=E,this._d=C}Jt.prototype={transform:function(u,f){return this._transform(u.clone(),f)},_transform:function(u,f){return f=f||1,u.x=f*(this._a*u.x+this._b),u.y=f*(this._c*u.y+this._d),u},untransform:function(u,f){return f=f||1,new be((u.x/f-this._b)/this._a,(u.y/f-this._d)/this._c)}};function ct(u,f,E,C){return new Jt(u,f,E,C)}var mn=s({},Be,{code:"EPSG:3857",projection:At,transformation:(function(){var u=.5/(Math.PI*At.R);return ct(u,.5,-u,.5)})()}),Rn=s({},mn,{code:"EPSG:900913"});function Yt(u){return document.createElementNS("http://www.w3.org/2000/svg",u)}function Nt(u,f){var E="",C,N,D,j,te,ue;for(C=0,D=u.length;C<D;C++){for(te=u[C],N=0,j=te.length;N<j;N++)ue=te[N],E+=(N?"L":"M")+ue.x+" "+ue.y;E+=f?ze.svg?"z":"x":""}return E||"M0 0"}var Rt=document.documentElement.style,Mt="ActiveXObject"in window,we=Mt&&!document.addEventListener,pe="msLaunchUri"in navigator&&!("documentMode"in document),De=oi("webkit"),je=oi("android"),nt=oi("android 2")||oi("android 3"),lt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),rn=je&&oi("Google")&&lt<537&&!("AudioNode"in window),jn=!!window.opera,vi=!pe&&oi("chrome"),pn=oi("gecko")&&!De&&!jn&&!Mt,Ts=!vi&&oi("safari"),Lr=oi("phantom"),Vr="OTransition"in Rt,co=navigator.platform.indexOf("Win")===0,Ti=Mt&&"transition"in Rt,Ne="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!nt,ht="MozPerspective"in Rt,dt=!window.L_DISABLE_3D&&(Ti||Ne||ht)&&!Vr&&!Lr,on=typeof orientation<"u"||oi("mobile"),Si=on&&De,Es=on&&Ne,Fn=!window.PointerEvent&&window.MSPointerEvent,Zi=!!(window.PointerEvent||Fn),gn="ontouchstart"in window||!!window.TouchEvent,zi=!window.L_NO_TOUCH&&(gn||Zi),qi=on&&jn,ei=on&&pn,Vd=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Gu=(function(){var u=!1;try{var f=Object.defineProperty({},"passive",{get:function(){u=!0}});window.addEventListener("testPassiveEventSupport",x,f),window.removeEventListener("testPassiveEventSupport",x,f)}catch{}return u})(),Hs=(function(){return!!document.createElement("canvas").getContext})(),dr=!!(document.createElementNS&&Yt("svg").createSVGRect),Od=!!dr&&(function(){var u=document.createElement("div");return u.innerHTML="<svg/>",(u.firstChild&&u.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ho=!dr&&(function(){try{var u=document.createElement("div");u.innerHTML='<v:shape adj="1"/>';var f=u.firstChild;return f.style.behavior="url(#default#VML)",f&&typeof f.adj=="object"}catch{return!1}})(),El=navigator.platform.indexOf("Mac")===0,xl=navigator.platform.indexOf("Linux")===0;function oi(u){return navigator.userAgent.toLowerCase().indexOf(u)>=0}var ze={ie:Mt,ielt9:we,edge:pe,webkit:De,android:je,android23:nt,androidStock:rn,opera:jn,chrome:vi,gecko:pn,safari:Ts,phantom:Lr,opera12:Vr,win:co,ie3d:Ti,webkit3d:Ne,gecko3d:ht,any3d:dt,mobile:on,mobileWebkit:Si,mobileWebkit3d:Es,msPointer:Fn,pointer:Zi,touch:zi,touchNative:gn,mobileOpera:qi,mobileGecko:ei,retina:Vd,passiveEvents:Gu,canvas:Hs,svg:dr,vml:ho,inlineSvg:Od,mac:El,linux:xl},wl=ze.msPointer?"MSPointerDown":"pointerdown",Qi=ze.msPointer?"MSPointerMove":"pointermove",$i=ze.msPointer?"MSPointerUp":"pointerup",Cn=ze.msPointer?"MSPointerCancel":"pointercancel",Mn={touchstart:wl,touchmove:Qi,touchend:$i,touchcancel:Cn},xs={touchstart:Ks,touchmove:ai,touchend:ai,touchcancel:ai},ws={},Hu=!1;function ju(u,f,E){return f==="touchstart"&&Xi(),xs[f]?(E=xs[f].bind(this,E),u.addEventListener(Mn[f],E,!1),E):(console.warn("wrong event specified:",f),x)}function Ku(u,f,E){if(!Mn[f]){console.warn("wrong event specified:",f);return}u.removeEventListener(Mn[f],E,!1)}function js(u){ws[u.pointerId]=u}function ra(u){ws[u.pointerId]&&(ws[u.pointerId]=u)}function Ss(u){delete ws[u.pointerId]}function Xi(){Hu||(document.addEventListener(wl,js,!0),document.addEventListener(Qi,ra,!0),document.addEventListener($i,Ss,!0),document.addEventListener(Cn,Ss,!0),Hu=!0)}function ai(u,f){if(f.pointerType!==(f.MSPOINTER_TYPE_MOUSE||"mouse")){f.touches=[];for(var E in ws)f.touches.push(ws[E]);f.changedTouches=[f],u(f)}}function Ks(u,f){f.MSPOINTER_TYPE_TOUCH&&f.pointerType===f.MSPOINTER_TYPE_TOUCH&&Tn(f),ai(u,f)}function Pn(u){var f={},E,C;for(C in u)E=u[C],f[C]=E&&E.bind?E.bind(u):E;return u=f,f.type="dblclick",f.detail=2,f.isTrusted=!1,f._simulated=!0,f}var Sl=200;function bl(u,f){u.addEventListener("dblclick",f);var E=0,C;function N(D){if(D.detail!==1){C=D.detail;return}if(!(D.pointerType==="mouse"||D.sourceCapabilities&&!D.sourceCapabilities.firesTouchEvents)){var j=zr(D);if(!(j.some(function(ue){return ue instanceof HTMLLabelElement&&ue.attributes.for})&&!j.some(function(ue){return ue instanceof HTMLInputElement||ue instanceof HTMLSelectElement}))){var te=Date.now();te-E<=Sl?(C++,C===2&&f(Pn(D))):C=1,E=te}}}return u.addEventListener("click",N),{dblclick:f,simDblclick:N}}function Ws(u,f){u.removeEventListener("dblclick",f.dblclick),u.removeEventListener("click",f.simDblclick)}var es=mo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),hr=mo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),oa=hr==="webkitTransition"||hr==="OTransition"?hr+"End":"transitionend";function aa(u){return typeof u=="string"?document.getElementById(u):u}function Or(u,f){var E=u.style[f]||u.currentStyle&&u.currentStyle[f];if((!E||E==="auto")&&document.defaultView){var C=document.defaultView.getComputedStyle(u,null);E=C?C[f]:null}return E==="auto"?null:E}function yt(u,f,E){var C=document.createElement(u);return C.className=f||"",E&&E.appendChild(C),C}function Et(u){var f=u.parentNode;f&&f.removeChild(u)}function yn(u){for(;u.firstChild;)u.removeChild(u.firstChild)}function vn(u){var f=u.parentNode;f&&f.lastChild!==u&&f.appendChild(u)}function Gi(u){var f=u.parentNode;f&&f.firstChild!==u&&f.insertBefore(u,f.firstChild)}function fo(u,f){if(u.classList!==void 0)return u.classList.contains(f);var E=Ys(u);return E.length>0&&new RegExp("(^|\\s)"+f+"(\\s|$)").test(E)}function Ue(u,f){if(u.classList!==void 0)for(var E=P(f),C=0,N=E.length;C<N;C++)u.classList.add(E[C]);else if(!fo(u,f)){var D=Ys(u);ts(u,(D?D+" ":"")+f)}}function Zt(u,f){u.classList!==void 0?u.classList.remove(f):ts(u,A((" "+Ys(u)+" ").replace(" "+f+" "," ")))}function ts(u,f){u.className.baseVal===void 0?u.className=f:u.className.baseVal=f}function Ys(u){return u.correspondingElement&&(u=u.correspondingElement),u.className.baseVal===void 0?u.className:u.className.baseVal}function cn(u,f){"opacity"in u.style?u.style.opacity=f:"filter"in u.style&&la(u,f)}function la(u,f){var E=!1,C="DXImageTransform.Microsoft.Alpha";try{E=u.filters.item(C)}catch{if(f===1)return}f=Math.round(f*100),E?(E.Enabled=f!==100,E.Opacity=f):u.style.filter+=" progid:"+C+"(opacity="+f+")"}function mo(u){for(var f=document.documentElement.style,E=0;E<u.length;E++)if(u[E]in f)return u[E];return!1}function bs(u,f,E){var C=f||new be(0,0);u.style[es]=(ze.ie3d?"translate("+C.x+"px,"+C.y+"px)":"translate3d("+C.x+"px,"+C.y+"px,0)")+(E?" scale("+E+")":"")}function Qt(u,f){u._leaflet_pos=f,ze.any3d?bs(u,f):(u.style.left=f.x+"px",u.style.top=f.y+"px")}function Js(u){return u._leaflet_pos||new be(0,0)}var ns,Kn,ua;if("onselectstart"in document)ns=function(){et(window,"selectstart",Tn)},Kn=function(){Ft(window,"selectstart",Tn)};else{var fr=mo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ns=function(){if(fr){var u=document.documentElement.style;ua=u[fr],u[fr]="none"}},Kn=function(){fr&&(document.documentElement.style[fr]=ua,ua=void 0)}}function po(){et(window,"dragstart",Tn)}function Ur(){Ft(window,"dragstart",Tn)}var go,Zs;function Fr(u){for(;u.tabIndex===-1;)u=u.parentNode;u.style&&(bi(),go=u,Zs=u.style.outlineStyle,u.style.outlineStyle="none",et(window,"keydown",bi))}function bi(){go&&(go.style.outlineStyle=Zs,go=void 0,Zs=void 0,Ft(window,"keydown",bi))}function ca(u){do u=u.parentNode;while((!u.offsetWidth||!u.offsetHeight)&&u!==document.body);return u}function Ci(u){var f=u.getBoundingClientRect();return{x:f.width/u.offsetWidth||1,y:f.height/u.offsetHeight||1,boundingClientRect:f}}var Br={__proto__:null,TRANSFORM:es,TRANSITION:hr,TRANSITION_END:oa,get:aa,getStyle:Or,create:yt,remove:Et,empty:yn,toFront:vn,toBack:Gi,hasClass:fo,addClass:Ue,removeClass:Zt,setClass:ts,getClass:Ys,setOpacity:cn,testProp:mo,setTransform:bs,setPosition:Qt,getPosition:Js,get disableTextSelection(){return ns},get enableTextSelection(){return Kn},disableImageDrag:po,enableImageDrag:Ur,preventOutline:Fr,restoreOutline:bi,getSizedParentNode:ca,getScale:Ci};function et(u,f,E,C){if(f&&typeof f=="object")for(var N in f)Ii(u,N,f[N],E);else{f=P(f);for(var D=0,j=f.length;D<j;D++)Ii(u,f[D],E,C)}return this}var li="_leaflet_events";function Ft(u,f,E,C){if(arguments.length===1)mr(u),delete u[li];else if(f&&typeof f=="object")for(var N in f)pr(u,N,f[N],E);else if(f=P(f),arguments.length===2)mr(u,function(te){return he(f,te)!==-1});else for(var D=0,j=f.length;D<j;D++)pr(u,f[D],E,C);return this}function mr(u,f){for(var E in u[li]){var C=E.split(/\d/)[0];(!f||f(C))&&pr(u,C,null,null,E)}}var Hi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ii(u,f,E,C){var N=f+h(E)+(C?"_"+h(C):"");if(u[li]&&u[li][N])return this;var D=function(te){return E.call(C||u,te||window.event)},j=D;!ze.touchNative&&ze.pointer&&f.indexOf("touch")===0?D=ju(u,f,D):ze.touch&&f==="dblclick"?D=bl(u,D):"addEventListener"in u?f==="touchstart"||f==="touchmove"||f==="wheel"||f==="mousewheel"?u.addEventListener(Hi[f]||f,D,ze.passiveEvents?{passive:!1}:!1):f==="mouseenter"||f==="mouseleave"?(D=function(te){te=te||window.event,As(u,te)&&j(te)},u.addEventListener(Hi[f],D,!1)):u.addEventListener(f,j,!1):u.attachEvent("on"+f,D),u[li]=u[li]||{},u[li][N]=D}function pr(u,f,E,C,N){N=N||f+h(E)+(C?"_"+h(C):"");var D=u[li]&&u[li][N];if(!D)return this;!ze.touchNative&&ze.pointer&&f.indexOf("touch")===0?Ku(u,f,D):ze.touch&&f==="dblclick"?Ws(u,D):"removeEventListener"in u?u.removeEventListener(Hi[f]||f,D,!1):u.detachEvent("on"+f,D),u[li][N]=null}function Pt(u){return u.stopPropagation?u.stopPropagation():u.originalEvent?u.originalEvent._stopped=!0:u.cancelBubble=!0,this}function is(u){return Ii(u,"wheel",Pt),this}function gr(u){return et(u,"mousedown touchstart dblclick contextmenu",Pt),u._leaflet_disable_click=!0,this}function Tn(u){return u.preventDefault?u.preventDefault():u.returnValue=!1,this}function Cs(u){return Tn(u),Pt(u),this}function zr(u){if(u.composedPath)return u.composedPath();for(var f=[],E=u.target;E;)f.push(E),E=E.parentNode;return f}function Qs(u,f){if(!f)return new be(u.clientX,u.clientY);var E=Ci(f),C=E.boundingClientRect;return new be((u.clientX-C.left)/E.x-f.clientLeft,(u.clientY-C.top)/E.y-f.clientTop)}var Is=ze.linux&&ze.chrome?window.devicePixelRatio:ze.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Wn(u){return ze.edge?u.wheelDeltaY/2:u.deltaY&&u.deltaMode===0?-u.deltaY/Is:u.deltaY&&u.deltaMode===1?-u.deltaY*20:u.deltaY&&u.deltaMode===2?-u.deltaY*60:u.deltaX||u.deltaZ?0:u.wheelDelta?(u.wheelDeltaY||u.wheelDelta)/2:u.detail&&Math.abs(u.detail)<32765?-u.detail*20:u.detail?u.detail/-32765*60:0}function As(u,f){var E=f.relatedTarget;if(!E)return!0;try{for(;E&&E!==u;)E=E.parentNode}catch{return!1}return E!==u}var $s={__proto__:null,on:et,off:Ft,stopPropagation:Pt,disableScrollPropagation:is,disableClickPropagation:gr,preventDefault:Tn,stop:Cs,getPropagationPath:zr,getMousePosition:Qs,getWheelDelta:Wn,isExternalTarget:As,addListener:et,removeListener:Ft},_r=Se.extend({run:function(u,f,E,C){this.stop(),this._el=u,this._inProgress=!0,this._duration=E||.25,this._easeOutPower=1/Math.max(C||.5,.2),this._startPos=Js(u),this._offset=f.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=G(this._animate,this),this._step()},_step:function(u){var f=+new Date-this._startTime,E=this._duration*1e3;f<E?this._runFrame(this._easeOut(f/E),u):(this._runFrame(1),this._complete())},_runFrame:function(u,f){var E=this._startPos.add(this._offset.multiplyBy(u));f&&E._round(),Qt(this._el,E),this.fire("step")},_complete:function(){W(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(u){return 1-Math.pow(1-u,this._easeOutPower)}}),_t=Se.extend({options:{crs:mn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(u,f){f=F(this,f),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(u),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),f.maxBounds&&this.setMaxBounds(f.maxBounds),f.zoom!==void 0&&(this._zoom=this._limitZoom(f.zoom)),f.center&&f.zoom!==void 0&&this.setView(Ce(f.center),f.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=hr&&ze.any3d&&!ze.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),et(this._proxy,oa,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(u,f,E){if(f=f===void 0?this._zoom:this._limitZoom(f),u=this._limitCenter(Ce(u),f,this.options.maxBounds),E=E||{},this._stop(),this._loaded&&!E.reset&&E!==!0){E.animate!==void 0&&(E.zoom=s({animate:E.animate},E.zoom),E.pan=s({animate:E.animate,duration:E.duration},E.pan));var C=this._zoom!==f?this._tryAnimatedZoom&&this._tryAnimatedZoom(u,f,E.zoom):this._tryAnimatedPan(u,E.pan);if(C)return clearTimeout(this._sizeTimer),this}return this._resetView(u,f,E.pan&&E.pan.noMoveStart),this},setZoom:function(u,f){return this._loaded?this.setView(this.getCenter(),u,{zoom:f}):(this._zoom=u,this)},zoomIn:function(u,f){return u=u||(ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+u,f)},zoomOut:function(u,f){return u=u||(ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-u,f)},setZoomAround:function(u,f,E){var C=this.getZoomScale(f),N=this.getSize().divideBy(2),D=u instanceof be?u:this.latLngToContainerPoint(u),j=D.subtract(N).multiplyBy(1-1/C),te=this.containerPointToLatLng(N.add(j));return this.setView(te,f,{zoom:E})},_getBoundsCenterZoom:function(u,f){f=f||{},u=u.getBounds?u.getBounds():le(u);var E=Pe(f.paddingTopLeft||f.padding||[0,0]),C=Pe(f.paddingBottomRight||f.padding||[0,0]),N=this.getBoundsZoom(u,!1,E.add(C));if(N=typeof f.maxZoom=="number"?Math.min(f.maxZoom,N):N,N===1/0)return{center:u.getCenter(),zoom:N};var D=C.subtract(E).divideBy(2),j=this.project(u.getSouthWest(),N),te=this.project(u.getNorthEast(),N),ue=this.unproject(j.add(te).divideBy(2).add(D),N);return{center:ue,zoom:N}},fitBounds:function(u,f){if(u=le(u),!u.isValid())throw new Error("Bounds are not valid.");var E=this._getBoundsCenterZoom(u,f);return this.setView(E.center,E.zoom,f)},fitWorld:function(u){return this.fitBounds([[-90,-180],[90,180]],u)},panTo:function(u,f){return this.setView(u,this._zoom,{pan:f})},panBy:function(u,f){if(u=Pe(u).round(),f=f||{},!u.x&&!u.y)return this.fire("moveend");if(f.animate!==!0&&!this.getSize().contains(u))return this._resetView(this.unproject(this.project(this.getCenter()).add(u)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new _r,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),f.noMoveStart||this.fire("movestart"),f.animate!==!1){Ue(this._mapPane,"leaflet-pan-anim");var E=this._getMapPanePos().subtract(u).round();this._panAnim.run(this._mapPane,E,f.duration||.25,f.easeLinearity)}else this._rawPanBy(u),this.fire("move").fire("moveend");return this},flyTo:function(u,f,E){if(E=E||{},E.animate===!1||!ze.any3d)return this.setView(u,f,E);this._stop();var C=this.project(this.getCenter()),N=this.project(u),D=this.getSize(),j=this._zoom;u=Ce(u),f=f===void 0?j:f;var te=Math.max(D.x,D.y),ue=te*this.getZoomScale(j,f),Ee=N.distanceTo(C)||1,Le=1.42,Je=Le*Le;function pt(In){var xr=In?-1:1,wo=In?ue:te,Gd=ue*ue-te*te+xr*Je*Je*Ee*Ee,jl=2*wo*Je*Ee,Kl=Gd/jl,Qr=Math.sqrt(Kl*Kl+1)-Kl,wr=Qr<1e-9?-18:Math.log(Qr);return wr}function ti(In){return(Math.exp(In)-Math.exp(-In))/2}function kn(In){return(Math.exp(In)+Math.exp(-In))/2}function Wi(In){return ti(In)/kn(In)}var Bt=pt(0);function zt(In){return te*(kn(Bt)/kn(Bt+Le*In))}function xt(In){return te*(kn(Bt)*Wi(Bt+Le*In)-ti(Bt))/Je}function Jr(In){return 1-Math.pow(1-In,1.5)}var ls=Date.now(),rc=(pt(1)-Bt)/Le,Zr=E.duration?1e3*E.duration:1e3*rc*.8;function qd(){var In=(Date.now()-ls)/Zr,xr=Jr(In)*rc;In<=1?(this._flyToFrame=G(qd,this),this._move(this.unproject(C.add(N.subtract(C).multiplyBy(xt(xr)/Ee)),j),this.getScaleZoom(te/zt(xr),j),{flyTo:!0})):this._move(u,f)._moveEnd(!0)}return this._moveStart(!0,E.noMoveStart),qd.call(this),this},flyToBounds:function(u,f){var E=this._getBoundsCenterZoom(u,f);return this.flyTo(E.center,E.zoom,f)},setMaxBounds:function(u){return u=le(u),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),u.isValid()?(this.options.maxBounds=u,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(u){var f=this.options.minZoom;return this.options.minZoom=u,this._loaded&&f!==u&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(u):this},setMaxZoom:function(u){var f=this.options.maxZoom;return this.options.maxZoom=u,this._loaded&&f!==u&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(u):this},panInsideBounds:function(u,f){this._enforcingBounds=!0;var E=this.getCenter(),C=this._limitCenter(E,this._zoom,le(u));return E.equals(C)||this.panTo(C,f),this._enforcingBounds=!1,this},panInside:function(u,f){f=f||{};var E=Pe(f.paddingTopLeft||f.padding||[0,0]),C=Pe(f.paddingBottomRight||f.padding||[0,0]),N=this.project(this.getCenter()),D=this.project(u),j=this.getPixelBounds(),te=me([j.min.add(E),j.max.subtract(C)]),ue=te.getSize();if(!te.contains(D)){this._enforcingBounds=!0;var Ee=D.subtract(te.getCenter()),Le=te.extend(D).getSize().subtract(ue);N.x+=Ee.x<0?-Le.x:Le.x,N.y+=Ee.y<0?-Le.y:Le.y,this.panTo(this.unproject(N),f),this._enforcingBounds=!1}return this},invalidateSize:function(u){if(!this._loaded)return this;u=s({animate:!1,pan:!0},u===!0?{animate:!0}:u);var f=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var E=this.getSize(),C=f.divideBy(2).round(),N=E.divideBy(2).round(),D=C.subtract(N);return!D.x&&!D.y?this:(u.animate&&u.pan?this.panBy(D):(u.pan&&this._rawPanBy(D),this.fire("move"),u.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:f,newSize:E}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(u){if(u=this._locateOptions=s({timeout:1e4,watch:!1},u),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var f=l(this._handleGeolocationResponse,this),E=l(this._handleGeolocationError,this);return u.watch?this._locationWatchId=navigator.geolocation.watchPosition(f,E,u):navigator.geolocation.getCurrentPosition(f,E,u),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(u){if(this._container._leaflet_id){var f=u.code,E=u.message||(f===1?"permission denied":f===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:f,message:"Geolocation error: "+E+"."})}},_handleGeolocationResponse:function(u){if(this._container._leaflet_id){var f=u.coords.latitude,E=u.coords.longitude,C=new _e(f,E),N=C.toBounds(u.coords.accuracy*2),D=this._locateOptions;if(D.setView){var j=this.getBoundsZoom(N);this.setView(C,D.maxZoom?Math.min(j,D.maxZoom):j)}var te={latlng:C,bounds:N,timestamp:u.timestamp};for(var ue in u.coords)typeof u.coords[ue]=="number"&&(te[ue]=u.coords[ue]);this.fire("locationfound",te)}},addHandler:function(u,f){if(!f)return this;var E=this[u]=new f(this);return this._handlers.push(E),this.options[u]&&E.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Et(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(W(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var u;for(u in this._layers)this._layers[u].remove();for(u in this._panes)Et(this._panes[u]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(u,f){var E="leaflet-pane"+(u?" leaflet-"+u.replace("Pane","")+"-pane":""),C=yt("div",E,f||this._mapPane);return u&&(this._panes[u]=C),C},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var u=this.getPixelBounds(),f=this.unproject(u.getBottomLeft()),E=this.unproject(u.getTopRight());return new Ie(f,E)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(u,f,E){u=le(u),E=Pe(E||[0,0]);var C=this.getZoom()||0,N=this.getMinZoom(),D=this.getMaxZoom(),j=u.getNorthWest(),te=u.getSouthEast(),ue=this.getSize().subtract(E),Ee=me(this.project(te,C),this.project(j,C)).getSize(),Le=ze.any3d?this.options.zoomSnap:1,Je=ue.x/Ee.x,pt=ue.y/Ee.y,ti=f?Math.max(Je,pt):Math.min(Je,pt);return C=this.getScaleZoom(ti,C),Le&&(C=Math.round(C/(Le/100))*(Le/100),C=f?Math.ceil(C/Le)*Le:Math.floor(C/Le)*Le),Math.max(N,Math.min(D,C))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new be(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(u,f){var E=this._getTopLeftPoint(u,f);return new K(E,E.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(u){return this.options.crs.getProjectedBounds(u===void 0?this.getZoom():u)},getPane:function(u){return typeof u=="string"?this._panes[u]:u},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(u,f){var E=this.options.crs;return f=f===void 0?this._zoom:f,E.scale(u)/E.scale(f)},getScaleZoom:function(u,f){var E=this.options.crs;f=f===void 0?this._zoom:f;var C=E.zoom(u*E.scale(f));return isNaN(C)?1/0:C},project:function(u,f){return f=f===void 0?this._zoom:f,this.options.crs.latLngToPoint(Ce(u),f)},unproject:function(u,f){return f=f===void 0?this._zoom:f,this.options.crs.pointToLatLng(Pe(u),f)},layerPointToLatLng:function(u){var f=Pe(u).add(this.getPixelOrigin());return this.unproject(f)},latLngToLayerPoint:function(u){var f=this.project(Ce(u))._round();return f._subtract(this.getPixelOrigin())},wrapLatLng:function(u){return this.options.crs.wrapLatLng(Ce(u))},wrapLatLngBounds:function(u){return this.options.crs.wrapLatLngBounds(le(u))},distance:function(u,f){return this.options.crs.distance(Ce(u),Ce(f))},containerPointToLayerPoint:function(u){return Pe(u).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(u){return Pe(u).add(this._getMapPanePos())},containerPointToLatLng:function(u){var f=this.containerPointToLayerPoint(Pe(u));return this.layerPointToLatLng(f)},latLngToContainerPoint:function(u){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ce(u)))},mouseEventToContainerPoint:function(u){return Qs(u,this._container)},mouseEventToLayerPoint:function(u){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(u))},mouseEventToLatLng:function(u){return this.layerPointToLatLng(this.mouseEventToLayerPoint(u))},_initContainer:function(u){var f=this._container=aa(u);if(f){if(f._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");et(f,"scroll",this._onScroll,this),this._containerId=h(f)},_initLayout:function(){var u=this._container;this._fadeAnimated=this.options.fadeAnimation&&ze.any3d,Ue(u,"leaflet-container"+(ze.touch?" leaflet-touch":"")+(ze.retina?" leaflet-retina":"")+(ze.ielt9?" leaflet-oldie":"")+(ze.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var f=Or(u,"position");f!=="absolute"&&f!=="relative"&&f!=="fixed"&&f!=="sticky"&&(u.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var u=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Qt(this._mapPane,new be(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ue(u.markerPane,"leaflet-zoom-hide"),Ue(u.shadowPane,"leaflet-zoom-hide"))},_resetView:function(u,f,E){Qt(this._mapPane,new be(0,0));var C=!this._loaded;this._loaded=!0,f=this._limitZoom(f),this.fire("viewprereset");var N=this._zoom!==f;this._moveStart(N,E)._move(u,f)._moveEnd(N),this.fire("viewreset"),C&&this.fire("load")},_moveStart:function(u,f){return u&&this.fire("zoomstart"),f||this.fire("movestart"),this},_move:function(u,f,E,C){f===void 0&&(f=this._zoom);var N=this._zoom!==f;return this._zoom=f,this._lastCenter=u,this._pixelOrigin=this._getNewPixelOrigin(u),C?E&&E.pinch&&this.fire("zoom",E):((N||E&&E.pinch)&&this.fire("zoom",E),this.fire("move",E)),this},_moveEnd:function(u){return u&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return W(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(u){Qt(this._mapPane,this._getMapPanePos().subtract(u))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(u){this._targets={},this._targets[h(this._container)]=this;var f=u?Ft:et;f(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&f(window,"resize",this._onResize,this),ze.any3d&&this.options.transform3DLimit&&(u?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){W(this._resizeRequest),this._resizeRequest=G(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var u=this._getMapPanePos();Math.max(Math.abs(u.x),Math.abs(u.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(u,f){for(var E=[],C,N=f==="mouseout"||f==="mouseover",D=u.target||u.srcElement,j=!1;D;){if(C=this._targets[h(D)],C&&(f==="click"||f==="preclick")&&this._draggableMoved(C)){j=!0;break}if(C&&C.listens(f,!0)&&(N&&!As(D,u)||(E.push(C),N))||D===this._container)break;D=D.parentNode}return!E.length&&!j&&!N&&this.listens(f,!0)&&(E=[this]),E},_isClickDisabled:function(u){for(;u&&u!==this._container;){if(u._leaflet_disable_click)return!0;u=u.parentNode}},_handleDOMEvent:function(u){var f=u.target||u.srcElement;if(!(!this._loaded||f._leaflet_disable_events||u.type==="click"&&this._isClickDisabled(f))){var E=u.type;E==="mousedown"&&Fr(f),this._fireDOMEvent(u,E)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(u,f,E){if(u.type==="click"){var C=s({},u);C.type="preclick",this._fireDOMEvent(C,C.type,E)}var N=this._findEventTargets(u,f);if(E){for(var D=[],j=0;j<E.length;j++)E[j].listens(f,!0)&&D.push(E[j]);N=D.concat(N)}if(N.length){f==="contextmenu"&&Tn(u);var te=N[0],ue={originalEvent:u};if(u.type!=="keypress"&&u.type!=="keydown"&&u.type!=="keyup"){var Ee=te.getLatLng&&(!te._radius||te._radius<=10);ue.containerPoint=Ee?this.latLngToContainerPoint(te.getLatLng()):this.mouseEventToContainerPoint(u),ue.layerPoint=this.containerPointToLayerPoint(ue.containerPoint),ue.latlng=Ee?te.getLatLng():this.layerPointToLatLng(ue.layerPoint)}for(j=0;j<N.length;j++)if(N[j].fire(f,ue,!0),ue.originalEvent._stopped||N[j].options.bubblingMouseEvents===!1&&he(this._mouseEvents,f)!==-1)return}},_draggableMoved:function(u){return u=u.dragging&&u.dragging.enabled()?u:this,u.dragging&&u.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var u=0,f=this._handlers.length;u<f;u++)this._handlers[u].disable()},whenReady:function(u,f){return this._loaded?u.call(f||this,{target:this}):this.on("load",u,f),this},_getMapPanePos:function(){return Js(this._mapPane)||new be(0,0)},_moved:function(){var u=this._getMapPanePos();return u&&!u.equals([0,0])},_getTopLeftPoint:function(u,f){var E=u&&f!==void 0?this._getNewPixelOrigin(u,f):this.getPixelOrigin();return E.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(u,f){var E=this.getSize()._divideBy(2);return this.project(u,f)._subtract(E)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(u,f,E){var C=this._getNewPixelOrigin(E,f);return this.project(u,f)._subtract(C)},_latLngBoundsToNewLayerBounds:function(u,f,E){var C=this._getNewPixelOrigin(E,f);return me([this.project(u.getSouthWest(),f)._subtract(C),this.project(u.getNorthWest(),f)._subtract(C),this.project(u.getSouthEast(),f)._subtract(C),this.project(u.getNorthEast(),f)._subtract(C)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(u){return this.latLngToLayerPoint(u).subtract(this._getCenterLayerPoint())},_limitCenter:function(u,f,E){if(!E)return u;var C=this.project(u,f),N=this.getSize().divideBy(2),D=new K(C.subtract(N),C.add(N)),j=this._getBoundsOffset(D,E,f);return Math.abs(j.x)<=1&&Math.abs(j.y)<=1?u:this.unproject(C.add(j),f)},_limitOffset:function(u,f){if(!f)return u;var E=this.getPixelBounds(),C=new K(E.min.add(u),E.max.add(u));return u.add(this._getBoundsOffset(C,f))},_getBoundsOffset:function(u,f,E){var C=me(this.project(f.getNorthEast(),E),this.project(f.getSouthWest(),E)),N=C.min.subtract(u.min),D=C.max.subtract(u.max),j=this._rebound(N.x,-D.x),te=this._rebound(N.y,-D.y);return new be(j,te)},_rebound:function(u,f){return u+f>0?Math.round(u-f)/2:Math.max(0,Math.ceil(u))-Math.max(0,Math.floor(f))},_limitZoom:function(u){var f=this.getMinZoom(),E=this.getMaxZoom(),C=ze.any3d?this.options.zoomSnap:1;return C&&(u=Math.round(u/C)*C),Math.max(f,Math.min(E,u))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Zt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(u,f){var E=this._getCenterOffset(u)._trunc();return(f&&f.animate)!==!0&&!this.getSize().contains(E)?!1:(this.panBy(E,f),!0)},_createAnimProxy:function(){var u=this._proxy=yt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(u),this.on("zoomanim",function(f){var E=es,C=this._proxy.style[E];bs(this._proxy,this.project(f.center,f.zoom),this.getZoomScale(f.zoom,1)),C===this._proxy.style[E]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Et(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var u=this.getCenter(),f=this.getZoom();bs(this._proxy,this.project(u,f),this.getZoomScale(f,1))},_catchTransitionEnd:function(u){this._animatingZoom&&u.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(u,f,E){if(this._animatingZoom)return!0;if(E=E||{},!this._zoomAnimated||E.animate===!1||this._nothingToAnimate()||Math.abs(f-this._zoom)>this.options.zoomAnimationThreshold)return!1;var C=this.getZoomScale(f),N=this._getCenterOffset(u)._divideBy(1-1/C);return E.animate!==!0&&!this.getSize().contains(N)?!1:(G(function(){this._moveStart(!0,E.noMoveStart||!1)._animateZoom(u,f,!0)},this),!0)},_animateZoom:function(u,f,E,C){this._mapPane&&(E&&(this._animatingZoom=!0,this._animateToCenter=u,this._animateToZoom=f,Ue(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:u,zoom:f,noUpdate:C}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Zt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function qr(u,f){return new _t(u,f)}var ui=He.extend({options:{position:"topright"},initialize:function(u){F(this,u)},getPosition:function(){return this.options.position},setPosition:function(u){var f=this._map;return f&&f.removeControl(this),this.options.position=u,f&&f.addControl(this),this},getContainer:function(){return this._container},addTo:function(u){this.remove(),this._map=u;var f=this._container=this.onAdd(u),E=this.getPosition(),C=u._controlCorners[E];return Ue(f,"leaflet-control"),E.indexOf("bottom")!==-1?C.insertBefore(f,C.firstChild):C.appendChild(f),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Et(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(u){this._map&&u&&u.screenX>0&&u.screenY>0&&this._map.getContainer().focus()}}),Ai=function(u){return new ui(u)};_t.include({addControl:function(u){return u.addTo(this),this},removeControl:function(u){return u.remove(),this},_initControlPos:function(){var u=this._controlCorners={},f="leaflet-",E=this._controlContainer=yt("div",f+"control-container",this._container);function C(N,D){var j=f+N+" "+f+D;u[N+D]=yt("div",j,E)}C("top","left"),C("top","right"),C("bottom","left"),C("bottom","right")},_clearControlPos:function(){for(var u in this._controlCorners)Et(this._controlCorners[u]);Et(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var _o=ui.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(u,f,E,C){return E<C?-1:C<E?1:0}},initialize:function(u,f,E){F(this,E),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var C in u)this._addLayer(u[C],C);for(C in f)this._addLayer(f[C],C,!0)},onAdd:function(u){this._initLayout(),this._update(),this._map=u,u.on("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(u){return ui.prototype.addTo.call(this,u),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(u,f){return this._addLayer(u,f),this._map?this._update():this},addOverlay:function(u,f){return this._addLayer(u,f,!0),this._map?this._update():this},removeLayer:function(u){u.off("add remove",this._onLayerChange,this);var f=this._getLayer(h(u));return f&&this._layers.splice(this._layers.indexOf(f),1),this._map?this._update():this},expand:function(){Ue(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var u=this._map.getSize().y-(this._container.offsetTop+50);return u<this._section.clientHeight?(Ue(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=u+"px"):Zt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Zt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var u="leaflet-control-layers",f=this._container=yt("div",u),E=this.options.collapsed;f.setAttribute("aria-haspopup",!0),gr(f),is(f);var C=this._section=yt("section",u+"-list");E&&(this._map.on("click",this.collapse,this),et(f,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var N=this._layersLink=yt("a",u+"-toggle",f);N.href="#",N.title="Layers",N.setAttribute("role","button"),et(N,{keydown:function(D){D.keyCode===13&&this._expandSafely()},click:function(D){Tn(D),this._expandSafely()}},this),E||this.expand(),this._baseLayersList=yt("div",u+"-base",C),this._separator=yt("div",u+"-separator",C),this._overlaysList=yt("div",u+"-overlays",C),f.appendChild(C)},_getLayer:function(u){for(var f=0;f<this._layers.length;f++)if(this._layers[f]&&h(this._layers[f].layer)===u)return this._layers[f]},_addLayer:function(u,f,E){this._map&&u.on("add remove",this._onLayerChange,this),this._layers.push({layer:u,name:f,overlay:E}),this.options.sortLayers&&this._layers.sort(l(function(C,N){return this.options.sortFunction(C.layer,N.layer,C.name,N.name)},this)),this.options.autoZIndex&&u.setZIndex&&(this._lastZIndex++,u.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;yn(this._baseLayersList),yn(this._overlaysList),this._layerControlInputs=[];var u,f,E,C,N=0;for(E=0;E<this._layers.length;E++)C=this._layers[E],this._addItem(C),f=f||C.overlay,u=u||!C.overlay,N+=C.overlay?0:1;return this.options.hideSingleBase&&(u=u&&N>1,this._baseLayersList.style.display=u?"":"none"),this._separator.style.display=f&&u?"":"none",this},_onLayerChange:function(u){this._handlingClick||this._update();var f=this._getLayer(h(u.target)),E=f.overlay?u.type==="add"?"overlayadd":"overlayremove":u.type==="add"?"baselayerchange":null;E&&this._map.fire(E,f)},_createRadioElement:function(u,f){var E='<input type="radio" class="leaflet-control-layers-selector" name="'+u+'"'+(f?' checked="checked"':"")+"/>",C=document.createElement("div");return C.innerHTML=E,C.firstChild},_addItem:function(u){var f=document.createElement("label"),E=this._map.hasLayer(u.layer),C;u.overlay?(C=document.createElement("input"),C.type="checkbox",C.className="leaflet-control-layers-selector",C.defaultChecked=E):C=this._createRadioElement("leaflet-base-layers_"+h(this),E),this._layerControlInputs.push(C),C.layerId=h(u.layer),et(C,"click",this._onInputClick,this);var N=document.createElement("span");N.innerHTML=" "+u.name;var D=document.createElement("span");f.appendChild(D),D.appendChild(C),D.appendChild(N);var j=u.overlay?this._overlaysList:this._baseLayersList;return j.appendChild(f),this._checkDisabledLayers(),f},_onInputClick:function(){if(!this._preventClick){var u=this._layerControlInputs,f,E,C=[],N=[];this._handlingClick=!0;for(var D=u.length-1;D>=0;D--)f=u[D],E=this._getLayer(f.layerId).layer,f.checked?C.push(E):f.checked||N.push(E);for(D=0;D<N.length;D++)this._map.hasLayer(N[D])&&this._map.removeLayer(N[D]);for(D=0;D<C.length;D++)this._map.hasLayer(C[D])||this._map.addLayer(C[D]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var u=this._layerControlInputs,f,E,C=this._map.getZoom(),N=u.length-1;N>=0;N--)f=u[N],E=this._getLayer(f.layerId).layer,f.disabled=E.options.minZoom!==void 0&&C<E.options.minZoom||E.options.maxZoom!==void 0&&C>E.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var u=this._section;this._preventClick=!0,et(u,"click",Tn),this.expand();var f=this;setTimeout(function(){Ft(u,"click",Tn),f._preventClick=!1})}}),Cl=function(u,f,E){return new _o(u,f,E)},yr=ui.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(u){var f="leaflet-control-zoom",E=yt("div",f+" leaflet-bar"),C=this.options;return this._zoomInButton=this._createButton(C.zoomInText,C.zoomInTitle,f+"-in",E,this._zoomIn),this._zoomOutButton=this._createButton(C.zoomOutText,C.zoomOutTitle,f+"-out",E,this._zoomOut),this._updateDisabled(),u.on("zoomend zoomlevelschange",this._updateDisabled,this),E},onRemove:function(u){u.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(u){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(u.shiftKey?3:1))},_zoomOut:function(u){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(u.shiftKey?3:1))},_createButton:function(u,f,E,C,N){var D=yt("a",E,C);return D.innerHTML=u,D.href="#",D.title=f,D.setAttribute("role","button"),D.setAttribute("aria-label",f),gr(D),et(D,"click",Cs),et(D,"click",N,this),et(D,"click",this._refocusOnMap,this),D},_updateDisabled:function(){var u=this._map,f="leaflet-disabled";Zt(this._zoomInButton,f),Zt(this._zoomOutButton,f),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||u._zoom===u.getMinZoom())&&(Ue(this._zoomOutButton,f),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||u._zoom===u.getMaxZoom())&&(Ue(this._zoomInButton,f),this._zoomInButton.setAttribute("aria-disabled","true"))}});_t.mergeOptions({zoomControl:!0}),_t.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new yr,this.addControl(this.zoomControl))});var Wu=function(u){return new yr(u)},Il=ui.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(u){var f="leaflet-control-scale",E=yt("div",f),C=this.options;return this._addScales(C,f+"-line",E),u.on(C.updateWhenIdle?"moveend":"move",this._update,this),u.whenReady(this._update,this),E},onRemove:function(u){u.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(u,f,E){u.metric&&(this._mScale=yt("div",f,E)),u.imperial&&(this._iScale=yt("div",f,E))},_update:function(){var u=this._map,f=u.getSize().y/2,E=u.distance(u.containerPointToLatLng([0,f]),u.containerPointToLatLng([this.options.maxWidth,f]));this._updateScales(E)},_updateScales:function(u){this.options.metric&&u&&this._updateMetric(u),this.options.imperial&&u&&this._updateImperial(u)},_updateMetric:function(u){var f=this._getRoundNum(u),E=f<1e3?f+" m":f/1e3+" km";this._updateScale(this._mScale,E,f/u)},_updateImperial:function(u){var f=u*3.2808399,E,C,N;f>5280?(E=f/5280,C=this._getRoundNum(E),this._updateScale(this._iScale,C+" mi",C/E)):(N=this._getRoundNum(f),this._updateScale(this._iScale,N+" ft",N/f))},_updateScale:function(u,f,E){u.style.width=Math.round(this.options.maxWidth*E)+"px",u.innerHTML=f},_getRoundNum:function(u){var f=Math.pow(10,(Math.floor(u)+"").length-1),E=u/f;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:1,f*E}}),yo=function(u){return new Il(u)},Al='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',da=ui.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ze.inlineSvg?Al+" ":"")+"Leaflet</a>"},initialize:function(u){F(this,u),this._attributions={}},onAdd:function(u){u.attributionControl=this,this._container=yt("div","leaflet-control-attribution"),gr(this._container);for(var f in u._layers)u._layers[f].getAttribution&&this.addAttribution(u._layers[f].getAttribution());return this._update(),u.on("layeradd",this._addAttribution,this),this._container},onRemove:function(u){u.off("layeradd",this._addAttribution,this)},_addAttribution:function(u){u.layer.getAttribution&&(this.addAttribution(u.layer.getAttribution()),u.layer.once("remove",function(){this.removeAttribution(u.layer.getAttribution())},this))},setPrefix:function(u){return this.options.prefix=u,this._update(),this},addAttribution:function(u){return u?(this._attributions[u]||(this._attributions[u]=0),this._attributions[u]++,this._update(),this):this},removeAttribution:function(u){return u?(this._attributions[u]&&(this._attributions[u]--,this._update()),this):this},_update:function(){if(this._map){var u=[];for(var f in this._attributions)this._attributions[f]&&u.push(f);var E=[];this.options.prefix&&E.push(this.options.prefix),u.length&&E.push(u.join(", ")),this._container.innerHTML=E.join(' <span aria-hidden="true">|</span> ')}}});_t.mergeOptions({attributionControl:!0}),_t.addInitHook(function(){this.options.attributionControl&&new da().addTo(this)});var ha=function(u){return new da(u)};ui.Layers=_o,ui.Zoom=yr,ui.Scale=Il,ui.Attribution=da,Ai.layers=Cl,Ai.zoom=Wu,Ai.scale=yo,Ai.attribution=ha;var ji=He.extend({initialize:function(u){this._map=u},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ji.addTo=function(u,f){return u.addHandler(f,this),this};var Yu={Events:se},Ns=ze.touch?"touchstart mousedown":"mousedown",Rs=Se.extend({options:{clickTolerance:3},initialize:function(u,f,E,C){F(this,C),this._element=u,this._dragStartTarget=f||u,this._preventOutline=E},enable:function(){this._enabled||(et(this._dragStartTarget,Ns,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Rs._dragging===this&&this.finishDrag(!0),Ft(this._dragStartTarget,Ns,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(u){if(this._enabled&&(this._moved=!1,!fo(this._element,"leaflet-zoom-anim"))){if(u.touches&&u.touches.length!==1){Rs._dragging===this&&this.finishDrag();return}if(!(Rs._dragging||u.shiftKey||u.which!==1&&u.button!==1&&!u.touches)&&(Rs._dragging=this,this._preventOutline&&Fr(this._element),po(),ns(),!this._moving)){this.fire("down");var f=u.touches?u.touches[0]:u,E=ca(this._element);this._startPoint=new be(f.clientX,f.clientY),this._startPos=Js(this._element),this._parentScale=Ci(E);var C=u.type==="mousedown";et(document,C?"mousemove":"touchmove",this._onMove,this),et(document,C?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(u){if(this._enabled){if(u.touches&&u.touches.length>1){this._moved=!0;return}var f=u.touches&&u.touches.length===1?u.touches[0]:u,E=new be(f.clientX,f.clientY)._subtract(this._startPoint);!E.x&&!E.y||Math.abs(E.x)+Math.abs(E.y)<this.options.clickTolerance||(E.x/=this._parentScale.x,E.y/=this._parentScale.y,Tn(u),this._moved||(this.fire("dragstart"),this._moved=!0,Ue(document.body,"leaflet-dragging"),this._lastTarget=u.target||u.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ue(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(E),this._moving=!0,this._lastEvent=u,this._updatePosition())}},_updatePosition:function(){var u={originalEvent:this._lastEvent};this.fire("predrag",u),Qt(this._element,this._newPos),this.fire("drag",u)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(u){Zt(document.body,"leaflet-dragging"),this._lastTarget&&(Zt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ft(document,"mousemove touchmove",this._onMove,this),Ft(document,"mouseup touchend touchcancel",this._onUp,this),Ur(),Kn();var f=this._moved&&this._moving;this._moving=!1,Rs._dragging=!1,f&&this.fire("dragend",{noInertia:u,distance:this._newPos.distanceTo(this._startPos)})}});function Nl(u,f,E){var C,N=[1,4,2,8],D,j,te,ue,Ee,Le,Je,pt;for(D=0,Le=u.length;D<Le;D++)u[D]._code=de(u[D],f);for(te=0;te<4;te++){for(Je=N[te],C=[],D=0,Le=u.length,j=Le-1;D<Le;j=D++)ue=u[D],Ee=u[j],ue._code&Je?Ee._code&Je||(pt=ne(Ee,ue,Je,f,E),pt._code=de(pt,f),C.push(pt)):(Ee._code&Je&&(pt=ne(Ee,ue,Je,f,E),pt._code=de(pt,f),C.push(pt)),C.push(ue));u=C}return u}function Rl(u,f){var E,C,N,D,j,te,ue,Ee,Le;if(!u||u.length===0)throw new Error("latlngs not passed");Vt(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var Je=Ce([0,0]),pt=le(u),ti=pt.getNorthWest().distanceTo(pt.getSouthWest())*pt.getNorthEast().distanceTo(pt.getNorthWest());ti<1700&&(Je=fa(u));var kn=u.length,Wi=[];for(E=0;E<kn;E++){var Bt=Ce(u[E]);Wi.push(f.project(Ce([Bt.lat-Je.lat,Bt.lng-Je.lng])))}for(te=ue=Ee=0,E=0,C=kn-1;E<kn;C=E++)N=Wi[E],D=Wi[C],j=N.y*D.x-D.y*N.x,ue+=(N.x+D.x)*j,Ee+=(N.y+D.y)*j,te+=j*3;te===0?Le=Wi[0]:Le=[ue/te,Ee/te];var zt=f.unproject(Pe(Le));return Ce([zt.lat+Je.lat,zt.lng+Je.lng])}function fa(u){for(var f=0,E=0,C=0,N=0;N<u.length;N++){var D=Ce(u[N]);f+=D.lat,E+=D.lng,C++}return Ce([f/C,E/C])}var Gr={__proto__:null,clipPolygon:Nl,polygonCenter:Rl,centroid:fa};function ci(u,f){if(!f||!u.length)return u.slice();var E=f*f;return u=I(u,E),u=vr(u,E),u}function Ml(u,f,E){return Math.sqrt(st(u,f,E,!0))}function Ju(u,f,E){return st(u,f,E)}function vr(u,f){var E=u.length,C=typeof Uint8Array<"u"?Uint8Array:Array,N=new C(E);N[0]=N[E-1]=1,T(u,N,f,0,E-1);var D,j=[];for(D=0;D<E;D++)N[D]&&j.push(u[D]);return j}function T(u,f,E,C,N){var D=0,j,te,ue;for(te=C+1;te<=N-1;te++)ue=st(u[te],u[C],u[N],!0),ue>D&&(j=te,D=ue);D>E&&(f[j]=1,T(u,f,E,C,j),T(u,f,E,j,N))}function I(u,f){for(var E=[u[0]],C=1,N=0,D=u.length;C<D;C++)Re(u[C],u[N])>f&&(E.push(u[C]),N=C);return N<D-1&&E.push(u[D-1]),E}var M;function U(u,f,E,C,N){var D=C?M:de(u,E),j=de(f,E),te,ue,Ee;for(M=j;;){if(!(D|j))return[u,f];if(D&j)return!1;te=D||j,ue=ne(u,f,te,E,N),Ee=de(ue,E),te===D?(u=ue,D=Ee):(f=ue,j=Ee)}}function ne(u,f,E,C,N){var D=f.x-u.x,j=f.y-u.y,te=C.min,ue=C.max,Ee,Le;return E&8?(Ee=u.x+D*(ue.y-u.y)/j,Le=ue.y):E&4?(Ee=u.x+D*(te.y-u.y)/j,Le=te.y):E&2?(Ee=ue.x,Le=u.y+j*(ue.x-u.x)/D):E&1&&(Ee=te.x,Le=u.y+j*(te.x-u.x)/D),new be(Ee,Le,N)}function de(u,f){var E=0;return u.x<f.min.x?E|=1:u.x>f.max.x&&(E|=2),u.y<f.min.y?E|=4:u.y>f.max.y&&(E|=8),E}function Re(u,f){var E=f.x-u.x,C=f.y-u.y;return E*E+C*C}function st(u,f,E,C){var N=f.x,D=f.y,j=E.x-N,te=E.y-D,ue=j*j+te*te,Ee;return ue>0&&(Ee=((u.x-N)*j+(u.y-D)*te)/ue,Ee>1?(N=E.x,D=E.y):Ee>0&&(N+=j*Ee,D+=te*Ee)),j=u.x-N,te=u.y-D,C?j*j+te*te:new be(N,D)}function Vt(u){return!Q(u[0])||typeof u[0][0]!="object"&&typeof u[0][0]<"u"}function Ot(u){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Vt(u)}function dn(u,f){var E,C,N,D,j,te,ue,Ee;if(!u||u.length===0)throw new Error("latlngs not passed");Vt(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var Le=Ce([0,0]),Je=le(u),pt=Je.getNorthWest().distanceTo(Je.getSouthWest())*Je.getNorthEast().distanceTo(Je.getNorthWest());pt<1700&&(Le=fa(u));var ti=u.length,kn=[];for(E=0;E<ti;E++){var Wi=Ce(u[E]);kn.push(f.project(Ce([Wi.lat-Le.lat,Wi.lng-Le.lng])))}for(E=0,C=0;E<ti-1;E++)C+=kn[E].distanceTo(kn[E+1])/2;if(C===0)Ee=kn[0];else for(E=0,D=0;E<ti-1;E++)if(j=kn[E],te=kn[E+1],N=j.distanceTo(te),D+=N,D>C){ue=(D-C)/N,Ee=[te.x-ue*(te.x-j.x),te.y-ue*(te.y-j.y)];break}var Bt=f.unproject(Pe(Ee));return Ce([Bt.lat+Le.lat,Bt.lng+Le.lng])}var ss={__proto__:null,simplify:ci,pointToSegmentDistance:Ml,closestPointOnSegment:Ju,clipSegment:U,_getEdgeIntersection:ne,_getBitCode:de,_sqClosestPointOnSegment:st,isFlat:Vt,_flat:Ot,polylineCenter:dn},rs={project:function(u){return new be(u.lng,u.lat)},unproject:function(u){return new _e(u.y,u.x)},bounds:new K([-180,-90],[180,90])},Ki={R:6378137,R_MINOR:6356752314245179e-9,bounds:new K([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(u){var f=Math.PI/180,E=this.R,C=u.lat*f,N=this.R_MINOR/E,D=Math.sqrt(1-N*N),j=D*Math.sin(C),te=Math.tan(Math.PI/4-C/2)/Math.pow((1-j)/(1+j),D/2);return C=-E*Math.log(Math.max(te,1e-10)),new be(u.lng*f*E,C)},unproject:function(u){for(var f=180/Math.PI,E=this.R,C=this.R_MINOR/E,N=Math.sqrt(1-C*C),D=Math.exp(-u.y/E),j=Math.PI/2-2*Math.atan(D),te=0,ue=.1,Ee;te<15&&Math.abs(ue)>1e-7;te++)Ee=N*Math.sin(j),Ee=Math.pow((1-Ee)/(1+Ee),N/2),ue=Math.PI/2-2*Math.atan(D*Ee)-j,j+=ue;return new _e(j*f,u.x*f/E)}},Ms={__proto__:null,LonLat:rs,Mercator:Ki,SphericalMercator:At},vo=s({},Be,{code:"EPSG:3395",projection:Ki,transformation:(function(){var u=.5/(Math.PI*Ki.R);return ct(u,.5,-u,.5)})()}),To=s({},Be,{code:"EPSG:4326",projection:rs,transformation:ct(1/180,1,-1/180,.5)}),ma=s({},Fe,{projection:rs,transformation:ct(1,0,-1,0),scale:function(u){return Math.pow(2,u)},zoom:function(u){return Math.log(u)/Math.LN2},distance:function(u,f){var E=f.lng-u.lng,C=f.lat-u.lat;return Math.sqrt(E*E+C*C)},infinite:!0});Fe.Earth=Be,Fe.EPSG3395=vo,Fe.EPSG3857=mn,Fe.EPSG900913=Rn,Fe.EPSG4326=To,Fe.Simple=ma;var Ps=Se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(u){return u.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(u){return u&&u.removeLayer(this),this},getPane:function(u){return this._map.getPane(u?this.options[u]||u:this.options.pane)},addInteractiveTarget:function(u){return this._map._targets[h(u)]=this,this},removeInteractiveTarget:function(u){return delete this._map._targets[h(u)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(u){var f=u.target;if(f.hasLayer(this)){if(this._map=f,this._zoomAnimated=f._zoomAnimated,this.getEvents){var E=this.getEvents();f.on(E,this),this.once("remove",function(){f.off(E,this)},this)}this.onAdd(f),this.fire("add"),f.fire("layeradd",{layer:this})}}});_t.include({addLayer:function(u){if(!u._layerAdd)throw new Error("The provided object is not a Layer.");var f=h(u);return this._layers[f]?this:(this._layers[f]=u,u._mapToAdd=this,u.beforeAdd&&u.beforeAdd(this),this.whenReady(u._layerAdd,u),this)},removeLayer:function(u){var f=h(u);return this._layers[f]?(this._loaded&&u.onRemove(this),delete this._layers[f],this._loaded&&(this.fire("layerremove",{layer:u}),u.fire("remove")),u._map=u._mapToAdd=null,this):this},hasLayer:function(u){return h(u)in this._layers},eachLayer:function(u,f){for(var E in this._layers)u.call(f,this._layers[E]);return this},_addLayers:function(u){u=u?Q(u)?u:[u]:[];for(var f=0,E=u.length;f<E;f++)this.addLayer(u[f])},_addZoomLimit:function(u){(!isNaN(u.options.maxZoom)||!isNaN(u.options.minZoom))&&(this._zoomBoundLayers[h(u)]=u,this._updateZoomLevels())},_removeZoomLimit:function(u){var f=h(u);this._zoomBoundLayers[f]&&(delete this._zoomBoundLayers[f],this._updateZoomLevels())},_updateZoomLevels:function(){var u=1/0,f=-1/0,E=this._getZoomSpan();for(var C in this._zoomBoundLayers){var N=this._zoomBoundLayers[C].options;u=N.minZoom===void 0?u:Math.min(u,N.minZoom),f=N.maxZoom===void 0?f:Math.max(f,N.maxZoom)}this._layersMaxZoom=f===-1/0?void 0:f,this._layersMinZoom=u===1/0?void 0:u,E!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var pa=Ps.extend({initialize:function(u,f){F(this,f),this._layers={};var E,C;if(u)for(E=0,C=u.length;E<C;E++)this.addLayer(u[E])},addLayer:function(u){var f=this.getLayerId(u);return this._layers[f]=u,this._map&&this._map.addLayer(u),this},removeLayer:function(u){var f=u in this._layers?u:this.getLayerId(u);return this._map&&this._layers[f]&&this._map.removeLayer(this._layers[f]),delete this._layers[f],this},hasLayer:function(u){var f=typeof u=="number"?u:this.getLayerId(u);return f in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(u){var f=Array.prototype.slice.call(arguments,1),E,C;for(E in this._layers)C=this._layers[E],C[u]&&C[u].apply(C,f);return this},onAdd:function(u){this.eachLayer(u.addLayer,u)},onRemove:function(u){this.eachLayer(u.removeLayer,u)},eachLayer:function(u,f){for(var E in this._layers)u.call(f,this._layers[E]);return this},getLayer:function(u){return this._layers[u]},getLayers:function(){var u=[];return this.eachLayer(u.push,u),u},setZIndex:function(u){return this.invoke("setZIndex",u)},getLayerId:function(u){return h(u)}}),S_=function(u,f){return new pa(u,f)},Xs=pa.extend({addLayer:function(u){return this.hasLayer(u)?this:(u.addEventParent(this),pa.prototype.addLayer.call(this,u),this.fire("layeradd",{layer:u}))},removeLayer:function(u){return this.hasLayer(u)?(u in this._layers&&(u=this._layers[u]),u.removeEventParent(this),pa.prototype.removeLayer.call(this,u),this.fire("layerremove",{layer:u})):this},setStyle:function(u){return this.invoke("setStyle",u)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var u=new Ie;for(var f in this._layers){var E=this._layers[f];u.extend(E.getBounds?E.getBounds():E.getLatLng())}return u}}),Wf=function(u,f){return new Xs(u,f)},er=He.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(u){F(this,u)},createIcon:function(u){return this._createIcon("icon",u)},createShadow:function(u){return this._createIcon("shadow",u)},_createIcon:function(u,f){var E=this._getIconUrl(u);if(!E){if(u==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var C=this._createImg(E,f&&f.tagName==="IMG"?f:null);return this._setIconStyles(C,u),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),C},_setIconStyles:function(u,f){var E=this.options,C=E[f+"Size"];typeof C=="number"&&(C=[C,C]);var N=Pe(C),D=Pe(f==="shadow"&&E.shadowAnchor||E.iconAnchor||N&&N.divideBy(2,!0));u.className="leaflet-marker-"+f+" "+(E.className||""),D&&(u.style.marginLeft=-D.x+"px",u.style.marginTop=-D.y+"px"),N&&(u.style.width=N.x+"px",u.style.height=N.y+"px")},_createImg:function(u,f){return f=f||document.createElement("img"),f.src=u,f},_getIconUrl:function(u){return ze.retina&&this.options[u+"RetinaUrl"]||this.options[u+"Url"]}});function Pl(u){return new er(u)}var kl=er.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(u){return typeof kl.imagePath!="string"&&(kl.imagePath=this._detectIconPath()),(this.options.imagePath||kl.imagePath)+er.prototype._getIconUrl.call(this,u)},_stripUrl:function(u){var f=function(E,C,N){var D=C.exec(E);return D&&D[N]};return u=f(u,/^url\((['"])?(.+)\1\)$/,2),u&&f(u,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var u=yt("div","leaflet-default-icon-path",document.body),f=Or(u,"background-image")||Or(u,"backgroundImage");if(document.body.removeChild(u),f=this._stripUrl(f),f)return f;var E=document.querySelector('link[href$="leaflet.css"]');return E?E.href.substring(0,E.href.length-11-1):""}}),Dl=ji.extend({initialize:function(u){this._marker=u},addHooks:function(){var u=this._marker._icon;this._draggable||(this._draggable=new Rs(u,u,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ue(u,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Zt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(u){var f=this._marker,E=f._map,C=this._marker.options.autoPanSpeed,N=this._marker.options.autoPanPadding,D=Js(f._icon),j=E.getPixelBounds(),te=E.getPixelOrigin(),ue=me(j.min._subtract(te).add(N),j.max._subtract(te).subtract(N));if(!ue.contains(D)){var Ee=Pe((Math.max(ue.max.x,D.x)-ue.max.x)/(j.max.x-ue.max.x)-(Math.min(ue.min.x,D.x)-ue.min.x)/(j.min.x-ue.min.x),(Math.max(ue.max.y,D.y)-ue.max.y)/(j.max.y-ue.max.y)-(Math.min(ue.min.y,D.y)-ue.min.y)/(j.min.y-ue.min.y)).multiplyBy(C);E.panBy(Ee,{animate:!1}),this._draggable._newPos._add(Ee),this._draggable._startPos._add(Ee),Qt(f._icon,this._draggable._newPos),this._onDrag(u),this._panRequest=G(this._adjustPan.bind(this,u))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(u){this._marker.options.autoPan&&(W(this._panRequest),this._panRequest=G(this._adjustPan.bind(this,u)))},_onDrag:function(u){var f=this._marker,E=f._shadow,C=Js(f._icon),N=f._map.layerPointToLatLng(C);E&&Qt(E,C),f._latlng=N,u.latlng=N,u.oldLatLng=this._oldLatLng,f.fire("move",u).fire("drag",u)},_onDragEnd:function(u){W(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",u)}}),Ll=Ps.extend({options:{icon:new kl,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(u,f){F(this,f),this._latlng=Ce(u)},onAdd:function(u){this._zoomAnimated=this._zoomAnimated&&u.options.markerZoomAnimation,this._zoomAnimated&&u.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(u){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&u.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(u){var f=this._latlng;return this._latlng=Ce(u),this.update(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},setZIndexOffset:function(u){return this.options.zIndexOffset=u,this.update()},getIcon:function(){return this.options.icon},setIcon:function(u){return this.options.icon=u,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var u=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(u)}return this},_initIcon:function(){var u=this.options,f="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),E=u.icon.createIcon(this._icon),C=!1;E!==this._icon&&(this._icon&&this._removeIcon(),C=!0,u.title&&(E.title=u.title),E.tagName==="IMG"&&(E.alt=u.alt||"")),Ue(E,f),u.keyboard&&(E.tabIndex="0",E.setAttribute("role","button")),this._icon=E,u.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&et(E,"focus",this._panOnFocus,this);var N=u.icon.createShadow(this._shadow),D=!1;N!==this._shadow&&(this._removeShadow(),D=!0),N&&(Ue(N,f),N.alt=""),this._shadow=N,u.opacity<1&&this._updateOpacity(),C&&this.getPane().appendChild(this._icon),this._initInteraction(),N&&D&&this.getPane(u.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ft(this._icon,"focus",this._panOnFocus,this),Et(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Et(this._shadow),this._shadow=null},_setPos:function(u){this._icon&&Qt(this._icon,u),this._shadow&&Qt(this._shadow,u),this._zIndex=u.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(u){this._icon&&(this._icon.style.zIndex=this._zIndex+u)},_animateZoom:function(u){var f=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center).round();this._setPos(f)},_initInteraction:function(){if(this.options.interactive&&(Ue(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Dl)){var u=this.options.draggable;this.dragging&&(u=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Dl(this),u&&this.dragging.enable()}},setOpacity:function(u){return this.options.opacity=u,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var u=this.options.opacity;this._icon&&cn(this._icon,u),this._shadow&&cn(this._shadow,u)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var u=this._map;if(u){var f=this.options.icon.options,E=f.iconSize?Pe(f.iconSize):Pe(0,0),C=f.iconAnchor?Pe(f.iconAnchor):Pe(0,0);u.panInside(this._latlng,{paddingTopLeft:C,paddingBottomRight:E.subtract(C)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Yf(u,f){return new Ll(u,f)}var tr=Ps.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(u){this._renderer=u.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(u){return F(this,u),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&u&&Object.prototype.hasOwnProperty.call(u,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ga=tr.extend({options:{fill:!0,radius:10},initialize:function(u,f){F(this,f),this._latlng=Ce(u),this._radius=this.options.radius},setLatLng:function(u){var f=this._latlng;return this._latlng=Ce(u),this.redraw(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(u){return this.options.radius=this._radius=u,this.redraw()},getRadius:function(){return this._radius},setStyle:function(u){var f=u&&u.radius||this._radius;return tr.prototype.setStyle.call(this,u),this.setRadius(f),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var u=this._radius,f=this._radiusY||u,E=this._clickTolerance(),C=[u+E,f+E];this._pxBounds=new K(this._point.subtract(C),this._point.add(C))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(u){return u.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Jf(u,f){return new ga(u,f)}var Zu=ga.extend({initialize:function(u,f,E){if(typeof f=="number"&&(f=s({},E,{radius:f})),F(this,f),this._latlng=Ce(u),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(u){return this._mRadius=u,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var u=[this._radius,this._radiusY||this._radius];return new Ie(this._map.layerPointToLatLng(this._point.subtract(u)),this._map.layerPointToLatLng(this._point.add(u)))},setStyle:tr.prototype.setStyle,_project:function(){var u=this._latlng.lng,f=this._latlng.lat,E=this._map,C=E.options.crs;if(C.distance===Be.distance){var N=Math.PI/180,D=this._mRadius/Be.R/N,j=E.project([f+D,u]),te=E.project([f-D,u]),ue=j.add(te).divideBy(2),Ee=E.unproject(ue).lat,Le=Math.acos((Math.cos(D*N)-Math.sin(f*N)*Math.sin(Ee*N))/(Math.cos(f*N)*Math.cos(Ee*N)))/N;(isNaN(Le)||Le===0)&&(Le=D/Math.cos(Math.PI/180*f)),this._point=ue.subtract(E.getPixelOrigin()),this._radius=isNaN(Le)?0:ue.x-E.project([Ee,u-Le]).x,this._radiusY=ue.y-j.y}else{var Je=C.unproject(C.project(this._latlng).subtract([this._mRadius,0]));this._point=E.latLngToLayerPoint(this._latlng),this._radius=this._point.x-E.latLngToLayerPoint(Je).x}this._updateBounds()}});function Zf(u,f,E){return new Zu(u,f,E)}var Tr=tr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(u,f){F(this,f),this._setLatLngs(u)},getLatLngs:function(){return this._latlngs},setLatLngs:function(u){return this._setLatLngs(u),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(u){for(var f=1/0,E=null,C=st,N,D,j=0,te=this._parts.length;j<te;j++)for(var ue=this._parts[j],Ee=1,Le=ue.length;Ee<Le;Ee++){N=ue[Ee-1],D=ue[Ee];var Je=C(u,N,D,!0);Je<f&&(f=Je,E=C(u,N,D))}return E&&(E.distance=Math.sqrt(f)),E},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return dn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(u,f){return f=f||this._defaultShape(),u=Ce(u),f.push(u),this._bounds.extend(u),this.redraw()},_setLatLngs:function(u){this._bounds=new Ie,this._latlngs=this._convertLatLngs(u)},_defaultShape:function(){return Vt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(u){for(var f=[],E=Vt(u),C=0,N=u.length;C<N;C++)E?(f[C]=Ce(u[C]),this._bounds.extend(f[C])):f[C]=this._convertLatLngs(u[C]);return f},_project:function(){var u=new K;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,u),this._bounds.isValid()&&u.isValid()&&(this._rawPxBounds=u,this._updateBounds())},_updateBounds:function(){var u=this._clickTolerance(),f=new be(u,u);this._rawPxBounds&&(this._pxBounds=new K([this._rawPxBounds.min.subtract(f),this._rawPxBounds.max.add(f)]))},_projectLatlngs:function(u,f,E){var C=u[0]instanceof _e,N=u.length,D,j;if(C){for(j=[],D=0;D<N;D++)j[D]=this._map.latLngToLayerPoint(u[D]),E.extend(j[D]);f.push(j)}else for(D=0;D<N;D++)this._projectLatlngs(u[D],f,E)},_clipPoints:function(){var u=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}var f=this._parts,E,C,N,D,j,te,ue;for(E=0,N=0,D=this._rings.length;E<D;E++)for(ue=this._rings[E],C=0,j=ue.length;C<j-1;C++)te=U(ue[C],ue[C+1],u,C,!0),te&&(f[N]=f[N]||[],f[N].push(te[0]),(te[1]!==ue[C+1]||C===j-2)&&(f[N].push(te[1]),N++))}},_simplifyPoints:function(){for(var u=this._parts,f=this.options.smoothFactor,E=0,C=u.length;E<C;E++)u[E]=ci(u[E],f)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(u,f){var E,C,N,D,j,te,ue=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(E=0,D=this._parts.length;E<D;E++)for(te=this._parts[E],C=0,j=te.length,N=j-1;C<j;N=C++)if(!(!f&&C===0)&&Ml(u,te[N],te[C])<=ue)return!0;return!1}});function b_(u,f){return new Tr(u,f)}Tr._flat=Ot;var _a=Tr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Rl(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(u){var f=Tr.prototype._convertLatLngs.call(this,u),E=f.length;return E>=2&&f[0]instanceof _e&&f[0].equals(f[E-1])&&f.pop(),f},_setLatLngs:function(u){Tr.prototype._setLatLngs.call(this,u),Vt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Vt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var u=this._renderer._bounds,f=this.options.weight,E=new be(f,f);if(u=new K(u.min.subtract(E),u.max.add(E)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}for(var C=0,N=this._rings.length,D;C<N;C++)D=Nl(this._rings[C],u,!0),D.length&&this._parts.push(D)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(u){var f=!1,E,C,N,D,j,te,ue,Ee;if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(D=0,ue=this._parts.length;D<ue;D++)for(E=this._parts[D],j=0,Ee=E.length,te=Ee-1;j<Ee;te=j++)C=E[j],N=E[te],C.y>u.y!=N.y>u.y&&u.x<(N.x-C.x)*(u.y-C.y)/(N.y-C.y)+C.x&&(f=!f);return f||Tr.prototype._containsPoint.call(this,u,!0)}});function C_(u,f){return new _a(u,f)}var Er=Xs.extend({initialize:function(u,f){F(this,f),this._layers={},u&&this.addData(u)},addData:function(u){var f=Q(u)?u:u.features,E,C,N;if(f){for(E=0,C=f.length;E<C;E++)N=f[E],(N.geometries||N.geometry||N.features||N.coordinates)&&this.addData(N);return this}var D=this.options;if(D.filter&&!D.filter(u))return this;var j=di(u,D);return j?(j.feature=Xu(u),j.defaultOptions=j.options,this.resetStyle(j),D.onEachFeature&&D.onEachFeature(u,j),this.addLayer(j)):this},resetStyle:function(u){return u===void 0?this.eachLayer(this.resetStyle,this):(u.options=s({},u.defaultOptions),this._setLayerStyle(u,this.options.style),this)},setStyle:function(u){return this.eachLayer(function(f){this._setLayerStyle(f,u)},this)},_setLayerStyle:function(u,f){u.setStyle&&(typeof f=="function"&&(f=f(u.feature)),u.setStyle(f))}});function di(u,f){var E=u.type==="Feature"?u.geometry:u,C=E?E.coordinates:null,N=[],D=f&&f.pointToLayer,j=f&&f.coordsToLatLng||Qu,te,ue,Ee,Le;if(!C&&!E)return null;switch(E.type){case"Point":return te=j(C),ya(D,u,te,f);case"MultiPoint":for(Ee=0,Le=C.length;Ee<Le;Ee++)te=j(C[Ee]),N.push(ya(D,u,te,f));return new Xs(N);case"LineString":case"MultiLineString":return ue=Vl(C,E.type==="LineString"?0:1,j),new Tr(ue,f);case"Polygon":case"MultiPolygon":return ue=Vl(C,E.type==="Polygon"?1:2,j),new _a(ue,f);case"GeometryCollection":for(Ee=0,Le=E.geometries.length;Ee<Le;Ee++){var Je=di({geometry:E.geometries[Ee],type:"Feature",properties:u.properties},f);Je&&N.push(Je)}return new Xs(N);case"FeatureCollection":for(Ee=0,Le=E.features.length;Ee<Le;Ee++){var pt=di(E.features[Ee],f);pt&&N.push(pt)}return new Xs(N);default:throw new Error("Invalid GeoJSON object.")}}function ya(u,f,E,C){return u?u(f,E):new Ll(E,C&&C.markersInheritOptions&&C)}function Qu(u){return new _e(u[1],u[0],u[2])}function Vl(u,f,E){for(var C=[],N=0,D=u.length,j;N<D;N++)j=f?Vl(u[N],f-1,E):(E||Qu)(u[N]),C.push(j);return C}function $u(u,f){return u=Ce(u),u.alt!==void 0?[b(u.lng,f),b(u.lat,f),b(u.alt,f)]:[b(u.lng,f),b(u.lat,f)]}function Ol(u,f,E,C){for(var N=[],D=0,j=u.length;D<j;D++)N.push(f?Ol(u[D],Vt(u[D])?0:f-1,E,C):$u(u[D],C));return!f&&E&&N.length>0&&N.push(N[0].slice()),N}function Hr(u,f){return u.feature?s({},u.feature,{geometry:f}):Xu(f)}function Xu(u){return u.type==="Feature"||u.type==="FeatureCollection"?u:{type:"Feature",properties:{},geometry:u}}var jr={toGeoJSON:function(u){return Hr(this,{type:"Point",coordinates:$u(this.getLatLng(),u)})}};Ll.include(jr),Zu.include(jr),ga.include(jr),Tr.include({toGeoJSON:function(u){var f=!Vt(this._latlngs),E=Ol(this._latlngs,f?1:0,!1,u);return Hr(this,{type:(f?"Multi":"")+"LineString",coordinates:E})}}),_a.include({toGeoJSON:function(u){var f=!Vt(this._latlngs),E=f&&!Vt(this._latlngs[0]),C=Ol(this._latlngs,E?2:f?1:0,!0,u);return f||(C=[C]),Hr(this,{type:(E?"Multi":"")+"Polygon",coordinates:C})}}),pa.include({toMultiPoint:function(u){var f=[];return this.eachLayer(function(E){f.push(E.toGeoJSON(u).geometry.coordinates)}),Hr(this,{type:"MultiPoint",coordinates:f})},toGeoJSON:function(u){var f=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(f==="MultiPoint")return this.toMultiPoint(u);var E=f==="GeometryCollection",C=[];return this.eachLayer(function(N){if(N.toGeoJSON){var D=N.toGeoJSON(u);if(E)C.push(D.geometry);else{var j=Xu(D);j.type==="FeatureCollection"?C.push.apply(C,j.features):C.push(j)}}}),E?Hr(this,{geometries:C,type:"GeometryCollection"}):{type:"FeatureCollection",features:C}}});function ec(u,f){return new Er(u,f)}var Ul=ec,va=Ps.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(u,f,E){this._url=u,this._bounds=le(f),F(this,E)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ue(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Et(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(u){return this.options.opacity=u,this._image&&this._updateOpacity(),this},setStyle:function(u){return u.opacity&&this.setOpacity(u.opacity),this},bringToFront:function(){return this._map&&vn(this._image),this},bringToBack:function(){return this._map&&Gi(this._image),this},setUrl:function(u){return this._url=u,this._image&&(this._image.src=u),this},setBounds:function(u){return this._bounds=le(u),this._map&&this._reset(),this},getEvents:function(){var u={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var u=this._url.tagName==="IMG",f=this._image=u?this._url:yt("img");if(Ue(f,"leaflet-image-layer"),this._zoomAnimated&&Ue(f,"leaflet-zoom-animated"),this.options.className&&Ue(f,this.options.className),f.onselectstart=x,f.onmousemove=x,f.onload=l(this.fire,this,"load"),f.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),u){this._url=f.src;return}f.src=this._url,f.alt=this.options.alt},_animateZoom:function(u){var f=this._map.getZoomScale(u.zoom),E=this._map._latLngBoundsToNewLayerBounds(this._bounds,u.zoom,u.center).min;bs(this._image,E,f)},_reset:function(){var u=this._image,f=new K(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),E=f.getSize();Qt(u,f.min),u.style.width=E.x+"px",u.style.height=E.y+"px"},_updateOpacity:function(){cn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var u=this.options.errorOverlayUrl;u&&this._url!==u&&(this._url=u,this._image.src=u)},getCenter:function(){return this._bounds.getCenter()}}),Qf=function(u,f,E){return new va(u,f,E)},Kr=va.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var u=this._url.tagName==="VIDEO",f=this._image=u?this._url:yt("video");if(Ue(f,"leaflet-image-layer"),this._zoomAnimated&&Ue(f,"leaflet-zoom-animated"),this.options.className&&Ue(f,this.options.className),f.onselectstart=x,f.onmousemove=x,f.onloadeddata=l(this.fire,this,"load"),u){for(var E=f.getElementsByTagName("source"),C=[],N=0;N<E.length;N++)C.push(E[N].src);this._url=E.length>0?C:[f.src];return}Q(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(f.style,"objectFit")&&(f.style.objectFit="fill"),f.autoplay=!!this.options.autoplay,f.loop=!!this.options.loop,f.muted=!!this.options.muted,f.playsInline=!!this.options.playsInline;for(var D=0;D<this._url.length;D++){var j=yt("source");j.src=this._url[D],f.appendChild(j)}}});function Ta(u,f,E){return new Kr(u,f,E)}var tc=va.extend({_initImage:function(){var u=this._image=this._url;Ue(u,"leaflet-image-layer"),this._zoomAnimated&&Ue(u,"leaflet-zoom-animated"),this.options.className&&Ue(u,this.options.className),u.onselectstart=x,u.onmousemove=x}});function $f(u,f,E){return new tc(u,f,E)}var hi=Ps.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(u,f){u&&(u instanceof _e||Q(u))?(this._latlng=Ce(u),F(this,f)):(F(this,u),this._source=f),this.options.content&&(this._content=this.options.content)},openOn:function(u){return u=arguments.length?u:this._source._map,u.hasLayer(this)||u.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(u){return this._map?this.close():(arguments.length?this._source=u:u=this._source,this._prepareOpen(),this.openOn(u._map)),this},onAdd:function(u){this._zoomAnimated=u._zoomAnimated,this._container||this._initLayout(),u._fadeAnimated&&cn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),u._fadeAnimated&&cn(this._container,1),this.bringToFront(),this.options.interactive&&(Ue(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(u){u._fadeAnimated?(cn(this._container,0),this._removeTimeout=setTimeout(l(Et,void 0,this._container),200)):Et(this._container),this.options.interactive&&(Zt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(u){return this._latlng=Ce(u),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(u){return this._content=u,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var u={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&vn(this._container),this},bringToBack:function(){return this._map&&Gi(this._container),this},_prepareOpen:function(u){var f=this._source;if(!f._map)return!1;if(f instanceof Xs){f=null;var E=this._source._layers;for(var C in E)if(E[C]._map){f=E[C];break}if(!f)return!1;this._source=f}if(!u)if(f.getCenter)u=f.getCenter();else if(f.getLatLng)u=f.getLatLng();else if(f.getBounds)u=f.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(u),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var u=this._contentNode,f=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof f=="string")u.innerHTML=f;else{for(;u.hasChildNodes();)u.removeChild(u.firstChild);u.appendChild(f)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var u=this._map.latLngToLayerPoint(this._latlng),f=Pe(this.options.offset),E=this._getAnchor();this._zoomAnimated?Qt(this._container,u.add(E)):f=f.add(u).add(E);var C=this._containerBottom=-f.y,N=this._containerLeft=-Math.round(this._containerWidth/2)+f.x;this._container.style.bottom=C+"px",this._container.style.left=N+"px"}},_getAnchor:function(){return[0,0]}});_t.include({_initOverlay:function(u,f,E,C){var N=f;return N instanceof u||(N=new u(C).setContent(f)),E&&N.setLatLng(E),N}}),Ps.include({_initOverlay:function(u,f,E,C){var N=E;return N instanceof u?(F(N,C),N._source=this):(N=f&&!C?f:new u(C,this),N.setContent(E)),N}});var Fl=hi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(u){return u=arguments.length?u:this._source._map,!u.hasLayer(this)&&u._popup&&u._popup.options.autoClose&&u.removeLayer(u._popup),u._popup=this,hi.prototype.openOn.call(this,u)},onAdd:function(u){hi.prototype.onAdd.call(this,u),u.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof tr||this._source.on("preclick",Pt))},onRemove:function(u){hi.prototype.onRemove.call(this,u),u.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof tr||this._source.off("preclick",Pt))},getEvents:function(){var u=hi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(u.preclick=this.close),this.options.keepInView&&(u.moveend=this._adjustPan),u},_initLayout:function(){var u="leaflet-popup",f=this._container=yt("div",u+" "+(this.options.className||"")+" leaflet-zoom-animated"),E=this._wrapper=yt("div",u+"-content-wrapper",f);if(this._contentNode=yt("div",u+"-content",E),gr(f),is(this._contentNode),et(f,"contextmenu",Pt),this._tipContainer=yt("div",u+"-tip-container",f),this._tip=yt("div",u+"-tip",this._tipContainer),this.options.closeButton){var C=this._closeButton=yt("a",u+"-close-button",f);C.setAttribute("role","button"),C.setAttribute("aria-label","Close popup"),C.href="#close",C.innerHTML='<span aria-hidden="true">&#215;</span>',et(C,"click",function(N){Tn(N),this.close()},this)}},_updateLayout:function(){var u=this._contentNode,f=u.style;f.width="",f.whiteSpace="nowrap";var E=u.offsetWidth;E=Math.min(E,this.options.maxWidth),E=Math.max(E,this.options.minWidth),f.width=E+1+"px",f.whiteSpace="",f.height="";var C=u.offsetHeight,N=this.options.maxHeight,D="leaflet-popup-scrolled";N&&C>N?(f.height=N+"px",Ue(u,D)):Zt(u,D),this._containerWidth=this._container.offsetWidth},_animateZoom:function(u){var f=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center),E=this._getAnchor();Qt(this._container,f.add(E))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var u=this._map,f=parseInt(Or(this._container,"marginBottom"),10)||0,E=this._container.offsetHeight+f,C=this._containerWidth,N=new be(this._containerLeft,-E-this._containerBottom);N._add(Js(this._container));var D=u.layerPointToContainerPoint(N),j=Pe(this.options.autoPanPadding),te=Pe(this.options.autoPanPaddingTopLeft||j),ue=Pe(this.options.autoPanPaddingBottomRight||j),Ee=u.getSize(),Le=0,Je=0;D.x+C+ue.x>Ee.x&&(Le=D.x+C-Ee.x+ue.x),D.x-Le-te.x<0&&(Le=D.x-te.x),D.y+E+ue.y>Ee.y&&(Je=D.y+E-Ee.y+ue.y),D.y-Je-te.y<0&&(Je=D.y-te.y),(Le||Je)&&(this.options.keepInView&&(this._autopanning=!0),u.fire("autopanstart").panBy([Le,Je]))}},_getAnchor:function(){return Pe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Xf=function(u,f){return new Fl(u,f)};_t.mergeOptions({closePopupOnClick:!0}),_t.include({openPopup:function(u,f,E){return this._initOverlay(Fl,u,f,E).openOn(this),this},closePopup:function(u){return u=arguments.length?u:this._popup,u&&u.close(),this}}),Ps.include({bindPopup:function(u,f){return this._popup=this._initOverlay(Fl,this._popup,u,f),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(u){return this._popup&&(this instanceof Xs||(this._popup._source=this),this._popup._prepareOpen(u||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(u){return this._popup&&this._popup.setContent(u),this},getPopup:function(){return this._popup},_openPopup:function(u){if(!(!this._popup||!this._map)){Cs(u);var f=u.layer||u.target;if(this._popup._source===f&&!(f instanceof tr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(u.latlng);return}this._popup._source=f,this.openPopup(u.latlng)}},_movePopup:function(u){this._popup.setLatLng(u.latlng)},_onKeyPress:function(u){u.originalEvent.keyCode===13&&this._openPopup(u)}});var Bl=hi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(u){hi.prototype.onAdd.call(this,u),this.setOpacity(this.options.opacity),u.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(u){hi.prototype.onRemove.call(this,u),u.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var u=hi.prototype.getEvents.call(this);return this.options.permanent||(u.preclick=this.close),u},_initLayout:function(){var u="leaflet-tooltip",f=u+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=yt("div",f),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+h(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(u){var f,E,C=this._map,N=this._container,D=C.latLngToContainerPoint(C.getCenter()),j=C.layerPointToContainerPoint(u),te=this.options.direction,ue=N.offsetWidth,Ee=N.offsetHeight,Le=Pe(this.options.offset),Je=this._getAnchor();te==="top"?(f=ue/2,E=Ee):te==="bottom"?(f=ue/2,E=0):te==="center"?(f=ue/2,E=Ee/2):te==="right"?(f=0,E=Ee/2):te==="left"?(f=ue,E=Ee/2):j.x<D.x?(te="right",f=0,E=Ee/2):(te="left",f=ue+(Le.x+Je.x)*2,E=Ee/2),u=u.subtract(Pe(f,E,!0)).add(Le).add(Je),Zt(N,"leaflet-tooltip-right"),Zt(N,"leaflet-tooltip-left"),Zt(N,"leaflet-tooltip-top"),Zt(N,"leaflet-tooltip-bottom"),Ue(N,"leaflet-tooltip-"+te),Qt(N,u)},_updatePosition:function(){var u=this._map.latLngToLayerPoint(this._latlng);this._setPosition(u)},setOpacity:function(u){this.options.opacity=u,this._container&&cn(this._container,u)},_animateZoom:function(u){var f=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center);this._setPosition(f)},_getAnchor:function(){return Pe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),I_=function(u,f){return new Bl(u,f)};_t.include({openTooltip:function(u,f,E){return this._initOverlay(Bl,u,f,E).openOn(this),this},closeTooltip:function(u){return u.close(),this}}),Ps.include({bindTooltip:function(u,f){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Bl,this._tooltip,u,f),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(u){if(!(!u&&this._tooltipHandlersAdded)){var f=u?"off":"on",E={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?E.add=this._openTooltip:(E.mouseover=this._openTooltip,E.mouseout=this.closeTooltip,E.click=this._openTooltip,this._map?this._addFocusListeners():E.add=this._addFocusListeners),this._tooltip.options.sticky&&(E.mousemove=this._moveTooltip),this[f](E),this._tooltipHandlersAdded=!u}},openTooltip:function(u){return this._tooltip&&(this instanceof Xs||(this._tooltip._source=this),this._tooltip._prepareOpen(u)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(u){return this._tooltip&&this._tooltip.setContent(u),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(u){var f=typeof u.getElement=="function"&&u.getElement();f&&(et(f,"focus",function(){this._tooltip._source=u,this.openTooltip()},this),et(f,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(u){var f=typeof u.getElement=="function"&&u.getElement();f&&f.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(u){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var f=this;this._map.once("moveend",function(){f._openOnceFlag=!1,f._openTooltip(u)});return}this._tooltip._source=u.layer||u.target,this.openTooltip(this._tooltip.options.sticky?u.latlng:void 0)}},_moveTooltip:function(u){var f=u.latlng,E,C;this._tooltip.options.sticky&&u.originalEvent&&(E=this._map.mouseEventToContainerPoint(u.originalEvent),C=this._map.containerPointToLayerPoint(E),f=this._map.layerPointToLatLng(C)),this._tooltip.setLatLng(f)}});var em=er.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(u){var f=u&&u.tagName==="DIV"?u:document.createElement("div"),E=this.options;if(E.html instanceof Element?(yn(f),f.appendChild(E.html)):f.innerHTML=E.html!==!1?E.html:"",E.bgPos){var C=Pe(E.bgPos);f.style.backgroundPosition=-C.x+"px "+-C.y+"px"}return this._setIconStyles(f,"icon"),f},createShadow:function(){return null}});function A_(u){return new em(u)}er.Default=kl;var Ea=Ps.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ze.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(u){F(this,u)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(u){u._addZoomLimit(this)},onRemove:function(u){this._removeAllTiles(),Et(this._container),u._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(vn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Gi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(u){return this.options.opacity=u,this._updateOpacity(),this},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var u=this._clampZoom(this._map.getZoom());u!==this._tileZoom&&(this._tileZoom=u,this._updateLevels()),this._update()}return this},getEvents:function(){var u={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),u.move=this._onMove),this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},createTile:function(){return document.createElement("div")},getTileSize:function(){var u=this.options.tileSize;return u instanceof be?u:new be(u,u)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(u){for(var f=this.getPane().children,E=-u(-1/0,1/0),C=0,N=f.length,D;C<N;C++)D=f[C].style.zIndex,f[C]!==this._container&&D&&(E=u(E,+D));isFinite(E)&&(this.options.zIndex=E+u(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ze.ielt9){cn(this._container,this.options.opacity);var u=+new Date,f=!1,E=!1;for(var C in this._tiles){var N=this._tiles[C];if(!(!N.current||!N.loaded)){var D=Math.min(1,(u-N.loaded)/200);cn(N.el,D),D<1?f=!0:(N.active?E=!0:this._onOpaqueTile(N),N.active=!0)}}E&&!this._noPrune&&this._pruneTiles(),f&&(W(this._fadeFrame),this._fadeFrame=G(this._updateOpacity,this))}},_onOpaqueTile:x,_initContainer:function(){this._container||(this._container=yt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var u=this._tileZoom,f=this.options.maxZoom;if(u!==void 0){for(var E in this._levels)E=Number(E),this._levels[E].el.children.length||E===u?(this._levels[E].el.style.zIndex=f-Math.abs(u-E),this._onUpdateLevel(E)):(Et(this._levels[E].el),this._removeTilesAtZoom(E),this._onRemoveLevel(E),delete this._levels[E]);var C=this._levels[u],N=this._map;return C||(C=this._levels[u]={},C.el=yt("div","leaflet-tile-container leaflet-zoom-animated",this._container),C.el.style.zIndex=f,C.origin=N.project(N.unproject(N.getPixelOrigin()),u).round(),C.zoom=u,this._setZoomTransform(C,N.getCenter(),N.getZoom()),x(C.el.offsetWidth),this._onCreateLevel(C)),this._level=C,C}},_onUpdateLevel:x,_onRemoveLevel:x,_onCreateLevel:x,_pruneTiles:function(){if(this._map){var u,f,E=this._map.getZoom();if(E>this.options.maxZoom||E<this.options.minZoom){this._removeAllTiles();return}for(u in this._tiles)f=this._tiles[u],f.retain=f.current;for(u in this._tiles)if(f=this._tiles[u],f.current&&!f.active){var C=f.coords;this._retainParent(C.x,C.y,C.z,C.z-5)||this._retainChildren(C.x,C.y,C.z,C.z+2)}for(u in this._tiles)this._tiles[u].retain||this._removeTile(u)}},_removeTilesAtZoom:function(u){for(var f in this._tiles)this._tiles[f].coords.z===u&&this._removeTile(f)},_removeAllTiles:function(){for(var u in this._tiles)this._removeTile(u)},_invalidateAll:function(){for(var u in this._levels)Et(this._levels[u].el),this._onRemoveLevel(Number(u)),delete this._levels[u];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(u,f,E,C){var N=Math.floor(u/2),D=Math.floor(f/2),j=E-1,te=new be(+N,+D);te.z=+j;var ue=this._tileCoordsToKey(te),Ee=this._tiles[ue];return Ee&&Ee.active?(Ee.retain=!0,!0):(Ee&&Ee.loaded&&(Ee.retain=!0),j>C?this._retainParent(N,D,j,C):!1)},_retainChildren:function(u,f,E,C){for(var N=2*u;N<2*u+2;N++)for(var D=2*f;D<2*f+2;D++){var j=new be(N,D);j.z=E+1;var te=this._tileCoordsToKey(j),ue=this._tiles[te];if(ue&&ue.active){ue.retain=!0;continue}else ue&&ue.loaded&&(ue.retain=!0);E+1<C&&this._retainChildren(N,D,E+1,C)}},_resetView:function(u){var f=u&&(u.pinch||u.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),f,f)},_animateZoom:function(u){this._setView(u.center,u.zoom,!0,u.noUpdate)},_clampZoom:function(u){var f=this.options;return f.minNativeZoom!==void 0&&u<f.minNativeZoom?f.minNativeZoom:f.maxNativeZoom!==void 0&&f.maxNativeZoom<u?f.maxNativeZoom:u},_setView:function(u,f,E,C){var N=Math.round(f);this.options.maxZoom!==void 0&&N>this.options.maxZoom||this.options.minZoom!==void 0&&N<this.options.minZoom?N=void 0:N=this._clampZoom(N);var D=this.options.updateWhenZooming&&N!==this._tileZoom;(!C||D)&&(this._tileZoom=N,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),N!==void 0&&this._update(u),E||this._pruneTiles(),this._noPrune=!!E),this._setZoomTransforms(u,f)},_setZoomTransforms:function(u,f){for(var E in this._levels)this._setZoomTransform(this._levels[E],u,f)},_setZoomTransform:function(u,f,E){var C=this._map.getZoomScale(E,u.zoom),N=u.origin.multiplyBy(C).subtract(this._map._getNewPixelOrigin(f,E)).round();ze.any3d?bs(u.el,N,C):Qt(u.el,N)},_resetGrid:function(){var u=this._map,f=u.options.crs,E=this._tileSize=this.getTileSize(),C=this._tileZoom,N=this._map.getPixelWorldBounds(this._tileZoom);N&&(this._globalTileRange=this._pxBoundsToTileRange(N)),this._wrapX=f.wrapLng&&!this.options.noWrap&&[Math.floor(u.project([0,f.wrapLng[0]],C).x/E.x),Math.ceil(u.project([0,f.wrapLng[1]],C).x/E.y)],this._wrapY=f.wrapLat&&!this.options.noWrap&&[Math.floor(u.project([f.wrapLat[0],0],C).y/E.x),Math.ceil(u.project([f.wrapLat[1],0],C).y/E.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(u){var f=this._map,E=f._animatingZoom?Math.max(f._animateToZoom,f.getZoom()):f.getZoom(),C=f.getZoomScale(E,this._tileZoom),N=f.project(u,this._tileZoom).floor(),D=f.getSize().divideBy(C*2);return new K(N.subtract(D),N.add(D))},_update:function(u){var f=this._map;if(f){var E=this._clampZoom(f.getZoom());if(u===void 0&&(u=f.getCenter()),this._tileZoom!==void 0){var C=this._getTiledPixelBounds(u),N=this._pxBoundsToTileRange(C),D=N.getCenter(),j=[],te=this.options.keepBuffer,ue=new K(N.getBottomLeft().subtract([te,-te]),N.getTopRight().add([te,-te]));if(!(isFinite(N.min.x)&&isFinite(N.min.y)&&isFinite(N.max.x)&&isFinite(N.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ee in this._tiles){var Le=this._tiles[Ee].coords;(Le.z!==this._tileZoom||!ue.contains(new be(Le.x,Le.y)))&&(this._tiles[Ee].current=!1)}if(Math.abs(E-this._tileZoom)>1){this._setView(u,E);return}for(var Je=N.min.y;Je<=N.max.y;Je++)for(var pt=N.min.x;pt<=N.max.x;pt++){var ti=new be(pt,Je);if(ti.z=this._tileZoom,!!this._isValidTile(ti)){var kn=this._tiles[this._tileCoordsToKey(ti)];kn?kn.current=!0:j.push(ti)}}if(j.sort(function(Bt,zt){return Bt.distanceTo(D)-zt.distanceTo(D)}),j.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Wi=document.createDocumentFragment();for(pt=0;pt<j.length;pt++)this._addTile(j[pt],Wi);this._level.el.appendChild(Wi)}}}},_isValidTile:function(u){var f=this._map.options.crs;if(!f.infinite){var E=this._globalTileRange;if(!f.wrapLng&&(u.x<E.min.x||u.x>E.max.x)||!f.wrapLat&&(u.y<E.min.y||u.y>E.max.y))return!1}if(!this.options.bounds)return!0;var C=this._tileCoordsToBounds(u);return le(this.options.bounds).overlaps(C)},_keyToBounds:function(u){return this._tileCoordsToBounds(this._keyToTileCoords(u))},_tileCoordsToNwSe:function(u){var f=this._map,E=this.getTileSize(),C=u.scaleBy(E),N=C.add(E),D=f.unproject(C,u.z),j=f.unproject(N,u.z);return[D,j]},_tileCoordsToBounds:function(u){var f=this._tileCoordsToNwSe(u),E=new Ie(f[0],f[1]);return this.options.noWrap||(E=this._map.wrapLatLngBounds(E)),E},_tileCoordsToKey:function(u){return u.x+":"+u.y+":"+u.z},_keyToTileCoords:function(u){var f=u.split(":"),E=new be(+f[0],+f[1]);return E.z=+f[2],E},_removeTile:function(u){var f=this._tiles[u];f&&(Et(f.el),delete this._tiles[u],this.fire("tileunload",{tile:f.el,coords:this._keyToTileCoords(u)}))},_initTile:function(u){Ue(u,"leaflet-tile");var f=this.getTileSize();u.style.width=f.x+"px",u.style.height=f.y+"px",u.onselectstart=x,u.onmousemove=x,ze.ielt9&&this.options.opacity<1&&cn(u,this.options.opacity)},_addTile:function(u,f){var E=this._getTilePos(u),C=this._tileCoordsToKey(u),N=this.createTile(this._wrapCoords(u),l(this._tileReady,this,u));this._initTile(N),this.createTile.length<2&&G(l(this._tileReady,this,u,null,N)),Qt(N,E),this._tiles[C]={el:N,coords:u,current:!0},f.appendChild(N),this.fire("tileloadstart",{tile:N,coords:u})},_tileReady:function(u,f,E){f&&this.fire("tileerror",{error:f,tile:E,coords:u});var C=this._tileCoordsToKey(u);E=this._tiles[C],E&&(E.loaded=+new Date,this._map._fadeAnimated?(cn(E.el,0),W(this._fadeFrame),this._fadeFrame=G(this._updateOpacity,this)):(E.active=!0,this._pruneTiles()),f||(Ue(E.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:E.el,coords:u})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ze.ielt9||!this._map._fadeAnimated?G(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(u){return u.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(u){var f=new be(this._wrapX?v(u.x,this._wrapX):u.x,this._wrapY?v(u.y,this._wrapY):u.y);return f.z=u.z,f},_pxBoundsToTileRange:function(u){var f=this.getTileSize();return new K(u.min.unscaleBy(f).floor(),u.max.unscaleBy(f).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var u in this._tiles)if(!this._tiles[u].loaded)return!1;return!0}});function tm(u){return new Ea(u)}var Wr=Ea.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(u,f){this._url=u,f=F(this,f),f.detectRetina&&ze.retina&&f.maxZoom>0?(f.tileSize=Math.floor(f.tileSize/2),f.zoomReverse?(f.zoomOffset--,f.minZoom=Math.min(f.maxZoom,f.minZoom+1)):(f.zoomOffset++,f.maxZoom=Math.max(f.minZoom,f.maxZoom-1)),f.minZoom=Math.max(0,f.minZoom)):f.zoomReverse?f.minZoom=Math.min(f.maxZoom,f.minZoom):f.maxZoom=Math.max(f.minZoom,f.maxZoom),typeof f.subdomains=="string"&&(f.subdomains=f.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(u,f){return this._url===u&&f===void 0&&(f=!0),this._url=u,f||this.redraw(),this},createTile:function(u,f){var E=document.createElement("img");return et(E,"load",l(this._tileOnLoad,this,f,E)),et(E,"error",l(this._tileOnError,this,f,E)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(E.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(E.referrerPolicy=this.options.referrerPolicy),E.alt="",E.src=this.getTileUrl(u),E},getTileUrl:function(u){var f={r:ze.retina?"@2x":"",s:this._getSubdomain(u),x:u.x,y:u.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var E=this._globalTileRange.max.y-u.y;this.options.tms&&(f.y=E),f["-y"]=E}return re(this._url,s(f,this.options))},_tileOnLoad:function(u,f){ze.ielt9?setTimeout(l(u,this,null,f),0):u(null,f)},_tileOnError:function(u,f,E){var C=this.options.errorTileUrl;C&&f.getAttribute("src")!==C&&(f.src=C),u(E,f)},_onTileRemove:function(u){u.tile.onload=null},_getZoomForUrl:function(){var u=this._tileZoom,f=this.options.maxZoom,E=this.options.zoomReverse,C=this.options.zoomOffset;return E&&(u=f-u),u+C},_getSubdomain:function(u){var f=Math.abs(u.x+u.y)%this.options.subdomains.length;return this.options.subdomains[f]},_abortLoading:function(){var u,f;for(u in this._tiles)if(this._tiles[u].coords.z!==this._tileZoom&&(f=this._tiles[u].el,f.onload=x,f.onerror=x,!f.complete)){f.src=fe;var E=this._tiles[u].coords;Et(f),delete this._tiles[u],this.fire("tileabort",{tile:f,coords:E})}},_removeTile:function(u){var f=this._tiles[u];if(f)return f.el.setAttribute("src",fe),Ea.prototype._removeTile.call(this,u)},_tileReady:function(u,f,E){if(!(!this._map||E&&E.getAttribute("src")===fe))return Ea.prototype._tileReady.call(this,u,f,E)}});function os(u,f){return new Wr(u,f)}var zl=Wr.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(u,f){this._url=u;var E=s({},this.defaultWmsParams);for(var C in f)C in this.options||(E[C]=f[C]);f=F(this,f);var N=f.detectRetina&&ze.retina?2:1,D=this.getTileSize();E.width=D.x*N,E.height=D.y*N,this.wmsParams=E},onAdd:function(u){this._crs=this.options.crs||u.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var f=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[f]=this._crs.code,Wr.prototype.onAdd.call(this,u)},getTileUrl:function(u){var f=this._tileCoordsToNwSe(u),E=this._crs,C=me(E.project(f[0]),E.project(f[1])),N=C.min,D=C.max,j=(this._wmsVersion>=1.3&&this._crs===To?[N.y,N.x,D.y,D.x]:[N.x,N.y,D.x,D.y]).join(","),te=Wr.prototype.getTileUrl.call(this,u);return te+H(this.wmsParams,te,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+j},setParams:function(u,f){return s(this.wmsParams,u),f||this.redraw(),this}});function as(u,f){return new zl(u,f)}Wr.WMS=zl,os.wms=as;var Ni=Ps.extend({options:{padding:.1},initialize:function(u){F(this,u),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ue(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var u={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(u.zoomanim=this._onAnimZoom),u},_onAnimZoom:function(u){this._updateTransform(u.center,u.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(u,f){var E=this._map.getZoomScale(f,this._zoom),C=this._map.getSize().multiplyBy(.5+this.options.padding),N=this._map.project(this._center,f),D=C.multiplyBy(-E).add(N).subtract(this._map._getNewPixelOrigin(u,f));ze.any3d?bs(this._container,D,E):Qt(this._container,D)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var u in this._layers)this._layers[u]._reset()},_onZoomEnd:function(){for(var u in this._layers)this._layers[u]._project()},_updatePaths:function(){for(var u in this._layers)this._layers[u]._update()},_update:function(){var u=this.options.padding,f=this._map.getSize(),E=this._map.containerPointToLayerPoint(f.multiplyBy(-u)).round();this._bounds=new K(E,E.add(f.multiplyBy(1+u*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),nc=Ni.extend({options:{tolerance:0},getEvents:function(){var u=Ni.prototype.getEvents.call(this);return u.viewprereset=this._onViewPreReset,u},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ni.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var u=this._container=document.createElement("canvas");et(u,"mousemove",this._onMouseMove,this),et(u,"click dblclick mousedown mouseup contextmenu",this._onClick,this),et(u,"mouseout",this._handleMouseOut,this),u._leaflet_disable_events=!0,this._ctx=u.getContext("2d")},_destroyContainer:function(){W(this._redrawRequest),delete this._ctx,Et(this._container),Ft(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var u;this._redrawBounds=null;for(var f in this._layers)u=this._layers[f],u._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ni.prototype._update.call(this);var u=this._bounds,f=this._container,E=u.getSize(),C=ze.retina?2:1;Qt(f,u.min),f.width=C*E.x,f.height=C*E.y,f.style.width=E.x+"px",f.style.height=E.y+"px",ze.retina&&this._ctx.scale(2,2),this._ctx.translate(-u.min.x,-u.min.y),this.fire("update")}},_reset:function(){Ni.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(u){this._updateDashArray(u),this._layers[h(u)]=u;var f=u._order={layer:u,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=f),this._drawLast=f,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(u){this._requestRedraw(u)},_removePath:function(u){var f=u._order,E=f.next,C=f.prev;E?E.prev=C:this._drawLast=C,C?C.next=E:this._drawFirst=E,delete u._order,delete this._layers[h(u)],this._requestRedraw(u)},_updatePath:function(u){this._extendRedrawBounds(u),u._project(),u._update(),this._requestRedraw(u)},_updateStyle:function(u){this._updateDashArray(u),this._requestRedraw(u)},_updateDashArray:function(u){if(typeof u.options.dashArray=="string"){var f=u.options.dashArray.split(/[, ]+/),E=[],C,N;for(N=0;N<f.length;N++){if(C=Number(f[N]),isNaN(C))return;E.push(C)}u.options._dashArray=E}else u.options._dashArray=u.options.dashArray},_requestRedraw:function(u){this._map&&(this._extendRedrawBounds(u),this._redrawRequest=this._redrawRequest||G(this._redraw,this))},_extendRedrawBounds:function(u){if(u._pxBounds){var f=(u.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new K,this._redrawBounds.extend(u._pxBounds.min.subtract([f,f])),this._redrawBounds.extend(u._pxBounds.max.add([f,f]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var u=this._redrawBounds;if(u){var f=u.getSize();this._ctx.clearRect(u.min.x,u.min.y,f.x,f.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var u,f=this._redrawBounds;if(this._ctx.save(),f){var E=f.getSize();this._ctx.beginPath(),this._ctx.rect(f.min.x,f.min.y,E.x,E.y),this._ctx.clip()}this._drawing=!0;for(var C=this._drawFirst;C;C=C.next)u=C.layer,(!f||u._pxBounds&&u._pxBounds.intersects(f))&&u._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(u,f){if(this._drawing){var E,C,N,D,j=u._parts,te=j.length,ue=this._ctx;if(te){for(ue.beginPath(),E=0;E<te;E++){for(C=0,N=j[E].length;C<N;C++)D=j[E][C],ue[C?"lineTo":"moveTo"](D.x,D.y);f&&ue.closePath()}this._fillStroke(ue,u)}}},_updateCircle:function(u){if(!(!this._drawing||u._empty())){var f=u._point,E=this._ctx,C=Math.max(Math.round(u._radius),1),N=(Math.max(Math.round(u._radiusY),1)||C)/C;N!==1&&(E.save(),E.scale(1,N)),E.beginPath(),E.arc(f.x,f.y/N,C,0,Math.PI*2,!1),N!==1&&E.restore(),this._fillStroke(E,u)}},_fillStroke:function(u,f){var E=f.options;E.fill&&(u.globalAlpha=E.fillOpacity,u.fillStyle=E.fillColor||E.color,u.fill(E.fillRule||"evenodd")),E.stroke&&E.weight!==0&&(u.setLineDash&&u.setLineDash(f.options&&f.options._dashArray||[]),u.globalAlpha=E.opacity,u.lineWidth=E.weight,u.strokeStyle=E.color,u.lineCap=E.lineCap,u.lineJoin=E.lineJoin,u.stroke())},_onClick:function(u){for(var f=this._map.mouseEventToLayerPoint(u),E,C,N=this._drawFirst;N;N=N.next)E=N.layer,E.options.interactive&&E._containsPoint(f)&&(!(u.type==="click"||u.type==="preclick")||!this._map._draggableMoved(E))&&(C=E);this._fireEvent(C?[C]:!1,u)},_onMouseMove:function(u){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var f=this._map.mouseEventToLayerPoint(u);this._handleMouseHover(u,f)}},_handleMouseOut:function(u){var f=this._hoveredLayer;f&&(Zt(this._container,"leaflet-interactive"),this._fireEvent([f],u,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(u,f){if(!this._mouseHoverThrottled){for(var E,C,N=this._drawFirst;N;N=N.next)E=N.layer,E.options.interactive&&E._containsPoint(f)&&(C=E);C!==this._hoveredLayer&&(this._handleMouseOut(u),C&&(Ue(this._container,"leaflet-interactive"),this._fireEvent([C],u,"mouseover"),this._hoveredLayer=C)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,u),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(u,f,E){this._map._fireDOMEvent(f,E||f.type,u)},_bringToFront:function(u){var f=u._order;if(f){var E=f.next,C=f.prev;if(E)E.prev=C;else return;C?C.next=E:E&&(this._drawFirst=E),f.prev=this._drawLast,this._drawLast.next=f,f.next=null,this._drawLast=f,this._requestRedraw(u)}},_bringToBack:function(u){var f=u._order;if(f){var E=f.next,C=f.prev;if(C)C.next=E;else return;E?E.prev=C:C&&(this._drawLast=C),f.prev=null,f.next=this._drawFirst,this._drawFirst.prev=f,this._drawFirst=f,this._requestRedraw(u)}}});function ql(u){return ze.canvas?new nc(u):null}var Yr=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(u){return document.createElement("<lvml:"+u+' class="lvml">')}}catch{}return function(u){return document.createElement("<"+u+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Ud={_initContainer:function(){this._container=yt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ni.prototype._update.call(this),this.fire("update"))},_initPath:function(u){var f=u._container=Yr("shape");Ue(f,"leaflet-vml-shape "+(this.options.className||"")),f.coordsize="1 1",u._path=Yr("path"),f.appendChild(u._path),this._updateStyle(u),this._layers[h(u)]=u},_addPath:function(u){var f=u._container;this._container.appendChild(f),u.options.interactive&&u.addInteractiveTarget(f)},_removePath:function(u){var f=u._container;Et(f),u.removeInteractiveTarget(f),delete this._layers[h(u)]},_updateStyle:function(u){var f=u._stroke,E=u._fill,C=u.options,N=u._container;N.stroked=!!C.stroke,N.filled=!!C.fill,C.stroke?(f||(f=u._stroke=Yr("stroke")),N.appendChild(f),f.weight=C.weight+"px",f.color=C.color,f.opacity=C.opacity,C.dashArray?f.dashStyle=Q(C.dashArray)?C.dashArray.join(" "):C.dashArray.replace(/( *, *)/g," "):f.dashStyle="",f.endcap=C.lineCap.replace("butt","flat"),f.joinstyle=C.lineJoin):f&&(N.removeChild(f),u._stroke=null),C.fill?(E||(E=u._fill=Yr("fill")),N.appendChild(E),E.color=C.fillColor||C.color,E.opacity=C.fillOpacity):E&&(N.removeChild(E),u._fill=null)},_updateCircle:function(u){var f=u._point.round(),E=Math.round(u._radius),C=Math.round(u._radiusY||E);this._setPath(u,u._empty()?"M0 0":"AL "+f.x+","+f.y+" "+E+","+C+" 0,"+65535*360)},_setPath:function(u,f){u._path.v=f},_bringToFront:function(u){vn(u._container)},_bringToBack:function(u){Gi(u._container)}},nr=ze.vml?Yr:Yt,xa=Ni.extend({_initContainer:function(){this._container=nr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=nr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Et(this._container),Ft(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ni.prototype._update.call(this);var u=this._bounds,f=u.getSize(),E=this._container;(!this._svgSize||!this._svgSize.equals(f))&&(this._svgSize=f,E.setAttribute("width",f.x),E.setAttribute("height",f.y)),Qt(E,u.min),E.setAttribute("viewBox",[u.min.x,u.min.y,f.x,f.y].join(" ")),this.fire("update")}},_initPath:function(u){var f=u._path=nr("path");u.options.className&&Ue(f,u.options.className),u.options.interactive&&Ue(f,"leaflet-interactive"),this._updateStyle(u),this._layers[h(u)]=u},_addPath:function(u){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(u._path),u.addInteractiveTarget(u._path)},_removePath:function(u){Et(u._path),u.removeInteractiveTarget(u._path),delete this._layers[h(u)]},_updatePath:function(u){u._project(),u._update()},_updateStyle:function(u){var f=u._path,E=u.options;f&&(E.stroke?(f.setAttribute("stroke",E.color),f.setAttribute("stroke-opacity",E.opacity),f.setAttribute("stroke-width",E.weight),f.setAttribute("stroke-linecap",E.lineCap),f.setAttribute("stroke-linejoin",E.lineJoin),E.dashArray?f.setAttribute("stroke-dasharray",E.dashArray):f.removeAttribute("stroke-dasharray"),E.dashOffset?f.setAttribute("stroke-dashoffset",E.dashOffset):f.removeAttribute("stroke-dashoffset")):f.setAttribute("stroke","none"),E.fill?(f.setAttribute("fill",E.fillColor||E.color),f.setAttribute("fill-opacity",E.fillOpacity),f.setAttribute("fill-rule",E.fillRule||"evenodd")):f.setAttribute("fill","none"))},_updatePoly:function(u,f){this._setPath(u,Nt(u._parts,f))},_updateCircle:function(u){var f=u._point,E=Math.max(Math.round(u._radius),1),C=Math.max(Math.round(u._radiusY),1)||E,N="a"+E+","+C+" 0 1,0 ",D=u._empty()?"M0 0":"M"+(f.x-E)+","+f.y+N+E*2+",0 "+N+-E*2+",0 ";this._setPath(u,D)},_setPath:function(u,f){u._path.setAttribute("d",f)},_bringToFront:function(u){vn(u._path)},_bringToBack:function(u){Gi(u._path)}});ze.vml&&xa.include(Ud);function Gl(u){return ze.svg||ze.vml?new xa(u):null}_t.include({getRenderer:function(u){var f=u.options.renderer||this._getPaneRenderer(u.options.pane)||this.options.renderer||this._renderer;return f||(f=this._renderer=this._createRenderer()),this.hasLayer(f)||this.addLayer(f),f},_getPaneRenderer:function(u){if(u==="overlayPane"||u===void 0)return!1;var f=this._paneRenderers[u];return f===void 0&&(f=this._createRenderer({pane:u}),this._paneRenderers[u]=f),f},_createRenderer:function(u){return this.options.preferCanvas&&ql(u)||Gl(u)}});var Eo=_a.extend({initialize:function(u,f){_a.prototype.initialize.call(this,this._boundsToLatLngs(u),f)},setBounds:function(u){return this.setLatLngs(this._boundsToLatLngs(u))},_boundsToLatLngs:function(u){return u=le(u),[u.getSouthWest(),u.getNorthWest(),u.getNorthEast(),u.getSouthEast()]}});function N_(u,f){return new Eo(u,f)}xa.create=nr,xa.pointsToPath=Nt,Er.geometryToLayer=di,Er.coordsToLatLng=Qu,Er.coordsToLatLngs=Vl,Er.latLngToCoords=$u,Er.latLngsToCoords=Ol,Er.getFeature=Hr,Er.asFeature=Xu,_t.mergeOptions({boxZoom:!0});var Ri=ji.extend({initialize:function(u){this._map=u,this._container=u._container,this._pane=u._panes.overlayPane,this._resetStateTimeout=0,u.on("unload",this._destroy,this)},addHooks:function(){et(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ft(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Et(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(u){if(!u.shiftKey||u.which!==1&&u.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ns(),po(),this._startPoint=this._map.mouseEventToContainerPoint(u),et(document,{contextmenu:Cs,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(u){this._moved||(this._moved=!0,this._box=yt("div","leaflet-zoom-box",this._container),Ue(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(u);var f=new K(this._point,this._startPoint),E=f.getSize();Qt(this._box,f.min),this._box.style.width=E.x+"px",this._box.style.height=E.y+"px"},_finish:function(){this._moved&&(Et(this._box),Zt(this._container,"leaflet-crosshair")),Kn(),Ur(),Ft(document,{contextmenu:Cs,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(u){if(!(u.which!==1&&u.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var f=new Ie(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(f).fire("boxzoomend",{boxZoomBounds:f})}},_onKeyDown:function(u){u.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});_t.addInitHook("addHandler","boxZoom",Ri),_t.mergeOptions({doubleClickZoom:!0});var ic=ji.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(u){var f=this._map,E=f.getZoom(),C=f.options.zoomDelta,N=u.originalEvent.shiftKey?E-C:E+C;f.options.doubleClickZoom==="center"?f.setZoom(N):f.setZoomAround(u.containerPoint,N)}});_t.addInitHook("addHandler","doubleClickZoom",ic),_t.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ir=ji.extend({addHooks:function(){if(!this._draggable){var u=this._map;this._draggable=new Rs(u._mapPane,u._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),u.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),u.on("zoomend",this._onZoomEnd,this),u.whenReady(this._onZoomEnd,this))}Ue(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Zt(this._map._container,"leaflet-grab"),Zt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var u=this._map;if(u._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var f=le(this._map.options.maxBounds);this._offsetLimit=me(this._map.latLngToContainerPoint(f.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(f.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;u.fire("movestart").fire("dragstart"),u.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(u){if(this._map.options.inertia){var f=this._lastTime=+new Date,E=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(E),this._times.push(f),this._prunePositions(f)}this._map.fire("move",u).fire("drag",u)},_prunePositions:function(u){for(;this._positions.length>1&&u-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var u=this._map.getSize().divideBy(2),f=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=f.subtract(u).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(u,f){return u-(u-f)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var u=this._draggable._newPos.subtract(this._draggable._startPos),f=this._offsetLimit;u.x<f.min.x&&(u.x=this._viscousLimit(u.x,f.min.x)),u.y<f.min.y&&(u.y=this._viscousLimit(u.y,f.min.y)),u.x>f.max.x&&(u.x=this._viscousLimit(u.x,f.max.x)),u.y>f.max.y&&(u.y=this._viscousLimit(u.y,f.max.y)),this._draggable._newPos=this._draggable._startPos.add(u)}},_onPreDragWrap:function(){var u=this._worldWidth,f=Math.round(u/2),E=this._initialWorldOffset,C=this._draggable._newPos.x,N=(C-f+E)%u+f-E,D=(C+f+E)%u-f-E,j=Math.abs(N+E)<Math.abs(D+E)?N:D;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=j},_onDragEnd:function(u){var f=this._map,E=f.options,C=!E.inertia||u.noInertia||this._times.length<2;if(f.fire("dragend",u),C)f.fire("moveend");else{this._prunePositions(+new Date);var N=this._lastPos.subtract(this._positions[0]),D=(this._lastTime-this._times[0])/1e3,j=E.easeLinearity,te=N.multiplyBy(j/D),ue=te.distanceTo([0,0]),Ee=Math.min(E.inertiaMaxSpeed,ue),Le=te.multiplyBy(Ee/ue),Je=Ee/(E.inertiaDeceleration*j),pt=Le.multiplyBy(-Je/2).round();!pt.x&&!pt.y?f.fire("moveend"):(pt=f._limitOffset(pt,f.options.maxBounds),G(function(){f.panBy(pt,{duration:Je,easeLinearity:j,noMoveStart:!0,animate:!0})}))}}});_t.addInitHook("addHandler","dragging",ir),_t.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Fd=ji.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(u){this._map=u,this._setPanDelta(u.options.keyboardPanDelta),this._setZoomDelta(u.options.zoomDelta)},addHooks:function(){var u=this._map._container;u.tabIndex<=0&&(u.tabIndex="0"),et(u,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ft(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var u=document.body,f=document.documentElement,E=u.scrollTop||f.scrollTop,C=u.scrollLeft||f.scrollLeft;this._map._container.focus(),window.scrollTo(C,E)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(u){var f=this._panKeys={},E=this.keyCodes,C,N;for(C=0,N=E.left.length;C<N;C++)f[E.left[C]]=[-1*u,0];for(C=0,N=E.right.length;C<N;C++)f[E.right[C]]=[u,0];for(C=0,N=E.down.length;C<N;C++)f[E.down[C]]=[0,u];for(C=0,N=E.up.length;C<N;C++)f[E.up[C]]=[0,-1*u]},_setZoomDelta:function(u){var f=this._zoomKeys={},E=this.keyCodes,C,N;for(C=0,N=E.zoomIn.length;C<N;C++)f[E.zoomIn[C]]=u;for(C=0,N=E.zoomOut.length;C<N;C++)f[E.zoomOut[C]]=-u},_addHooks:function(){et(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ft(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(u){if(!(u.altKey||u.ctrlKey||u.metaKey)){var f=u.keyCode,E=this._map,C;if(f in this._panKeys){if(!E._panAnim||!E._panAnim._inProgress)if(C=this._panKeys[f],u.shiftKey&&(C=Pe(C).multiplyBy(3)),E.options.maxBounds&&(C=E._limitOffset(Pe(C),E.options.maxBounds)),E.options.worldCopyJump){var N=E.wrapLatLng(E.unproject(E.project(E.getCenter()).add(C)));E.panTo(N)}else E.panBy(C)}else if(f in this._zoomKeys)E.setZoom(E.getZoom()+(u.shiftKey?3:1)*this._zoomKeys[f]);else if(f===27&&E._popup&&E._popup.options.closeOnEscapeKey)E.closePopup();else return;Cs(u)}}});_t.addInitHook("addHandler","keyboard",Fd),_t.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Hl=ji.extend({addHooks:function(){et(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ft(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(u){var f=Wn(u),E=this._map.options.wheelDebounceTime;this._delta+=f,this._lastMousePos=this._map.mouseEventToContainerPoint(u),this._startTime||(this._startTime=+new Date);var C=Math.max(E-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),C),Cs(u)},_performZoom:function(){var u=this._map,f=u.getZoom(),E=this._map.options.zoomSnap||0;u._stop();var C=this._delta/(this._map.options.wheelPxPerZoomLevel*4),N=4*Math.log(2/(1+Math.exp(-Math.abs(C))))/Math.LN2,D=E?Math.ceil(N/E)*E:N,j=u._limitZoom(f+(this._delta>0?D:-D))-f;this._delta=0,this._startTime=null,j&&(u.options.scrollWheelZoom==="center"?u.setZoom(f+j):u.setZoomAround(this._lastMousePos,f+j))}});_t.addInitHook("addHandler","scrollWheelZoom",Hl);var xo=600;_t.mergeOptions({tapHold:ze.touchNative&&ze.safari&&ze.mobile,tapTolerance:15});var sc=ji.extend({addHooks:function(){et(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ft(this._map._container,"touchstart",this._onDown,this)},_onDown:function(u){if(clearTimeout(this._holdTimeout),u.touches.length===1){var f=u.touches[0];this._startPos=this._newPos=new be(f.clientX,f.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(et(document,"touchend",Tn),et(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",f))},this),xo),et(document,"touchend touchcancel contextmenu",this._cancel,this),et(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function u(){Ft(document,"touchend",Tn),Ft(document,"touchend touchcancel",u)},_cancel:function(){clearTimeout(this._holdTimeout),Ft(document,"touchend touchcancel contextmenu",this._cancel,this),Ft(document,"touchmove",this._onMove,this)},_onMove:function(u){var f=u.touches[0];this._newPos=new be(f.clientX,f.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(u,f){var E=new MouseEvent(u,{bubbles:!0,cancelable:!0,view:window,screenX:f.screenX,screenY:f.screenY,clientX:f.clientX,clientY:f.clientY});E._simulated=!0,f.target.dispatchEvent(E)}});_t.addInitHook("addHandler","tapHold",sc),_t.mergeOptions({touchZoom:ze.touch,bounceAtZoomLimits:!0});var Bd=ji.extend({addHooks:function(){Ue(this._map._container,"leaflet-touch-zoom"),et(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Zt(this._map._container,"leaflet-touch-zoom"),Ft(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(u){var f=this._map;if(!(!u.touches||u.touches.length!==2||f._animatingZoom||this._zooming)){var E=f.mouseEventToContainerPoint(u.touches[0]),C=f.mouseEventToContainerPoint(u.touches[1]);this._centerPoint=f.getSize()._divideBy(2),this._startLatLng=f.containerPointToLatLng(this._centerPoint),f.options.touchZoom!=="center"&&(this._pinchStartLatLng=f.containerPointToLatLng(E.add(C)._divideBy(2))),this._startDist=E.distanceTo(C),this._startZoom=f.getZoom(),this._moved=!1,this._zooming=!0,f._stop(),et(document,"touchmove",this._onTouchMove,this),et(document,"touchend touchcancel",this._onTouchEnd,this),Tn(u)}},_onTouchMove:function(u){if(!(!u.touches||u.touches.length!==2||!this._zooming)){var f=this._map,E=f.mouseEventToContainerPoint(u.touches[0]),C=f.mouseEventToContainerPoint(u.touches[1]),N=E.distanceTo(C)/this._startDist;if(this._zoom=f.getScaleZoom(N,this._startZoom),!f.options.bounceAtZoomLimits&&(this._zoom<f.getMinZoom()&&N<1||this._zoom>f.getMaxZoom()&&N>1)&&(this._zoom=f._limitZoom(this._zoom)),f.options.touchZoom==="center"){if(this._center=this._startLatLng,N===1)return}else{var D=E._add(C)._divideBy(2)._subtract(this._centerPoint);if(N===1&&D.x===0&&D.y===0)return;this._center=f.unproject(f.project(this._pinchStartLatLng,this._zoom).subtract(D),this._zoom)}this._moved||(f._moveStart(!0,!1),this._moved=!0),W(this._animRequest);var j=l(f._move,f,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=G(j,this,!0),Tn(u)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,W(this._animRequest),Ft(document,"touchmove",this._onTouchMove,this),Ft(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});_t.addInitHook("addHandler","touchZoom",Bd),_t.BoxZoom=Ri,_t.DoubleClickZoom=ic,_t.Drag=ir,_t.Keyboard=Fd,_t.ScrollWheelZoom=Hl,_t.TapHold=sc,_t.TouchZoom=Bd,t.Bounds=K,t.Browser=ze,t.CRS=Fe,t.Canvas=nc,t.Circle=Zu,t.CircleMarker=ga,t.Class=He,t.Control=ui,t.DivIcon=em,t.DivOverlay=hi,t.DomEvent=$s,t.DomUtil=Br,t.Draggable=Rs,t.Evented=Se,t.FeatureGroup=Xs,t.GeoJSON=Er,t.GridLayer=Ea,t.Handler=ji,t.Icon=er,t.ImageOverlay=va,t.LatLng=_e,t.LatLngBounds=Ie,t.Layer=Ps,t.LayerGroup=pa,t.LineUtil=ss,t.Map=_t,t.Marker=Ll,t.Mixin=Yu,t.Path=tr,t.Point=be,t.PolyUtil=Gr,t.Polygon=_a,t.Polyline=Tr,t.Popup=Fl,t.PosAnimation=_r,t.Projection=Ms,t.Rectangle=Eo,t.Renderer=Ni,t.SVG=xa,t.SVGOverlay=tc,t.TileLayer=Wr,t.Tooltip=Bl,t.Transformation=Jt,t.Util=z,t.VideoOverlay=Kr,t.bind=l,t.bounds=me,t.canvas=ql,t.circle=Zf,t.circleMarker=Jf,t.control=Ai,t.divIcon=A_,t.extend=s,t.featureGroup=Wf,t.geoJSON=ec,t.geoJson=Ul,t.gridLayer=tm,t.icon=Pl,t.imageOverlay=Qf,t.latLng=Ce,t.latLngBounds=le,t.layerGroup=S_,t.map=qr,t.marker=Yf,t.point=Pe,t.polygon=C_,t.polyline=b_,t.popup=Xf,t.rectangle=N_,t.setOptions=F,t.stamp=h,t.svg=Gl,t.svgOverlay=$f,t.tileLayer=os,t.tooltip=I_,t.transformation=ct,t.version=i,t.videoOverlay=Ta;var zd=window.L;t.noConflict=function(){return window.L=zd,this},window.L=t}))})(Lh,Lh.exports)),Lh.exports}var Sd=J6();const Ou=J0(Sd);function kg(n,e,t){return Object.freeze({instance:n,context:e,container:t})}function Dg(n,e){return e==null?function(i,s){const o=Z.useRef(void 0);return o.current||(o.current=n(i,s)),o}:function(i,s){const o=Z.useRef(void 0);o.current||(o.current=n(i,s));const l=Z.useRef(i),{instance:d}=o.current;return Z.useEffect(function(){l.current!==i&&(e(d,i,l.current),l.current=i)},[d,i,e]),o}}function vN(n,e){Z.useEffect(function(){return(e.layerContainer??e.map).addLayer(n.instance),function(){var o;(o=e.layerContainer)==null||o.removeLayer(n.instance),e.map.removeLayer(n.instance)}},[e,n])}function TN(n){return function(t){const i=Mg(),s=n(Pg(t,i),i);return gN(i.map,t.attribution),hT(s.current,t.eventHandlers),vN(s.current,i),s}}function Z6(n,e){const t=Z.useRef(void 0);Z.useEffect(function(){if(e.pathOptions!==t.current){const s=e.pathOptions??{};n.instance.setStyle(s),t.current=s}},[n,e])}function Q6(n){return function(t){const i=Mg(),s=n(Pg(t,i),i);return hT(s.current,t.eventHandlers),vN(s.current,i),Z6(s.current,t),s}}function $6(n,e){const t=Dg(n,e),i=TN(t);return yN(i)}function X6(n,e){const t=Dg(n),i=W6(t,e);return j6(i)}function eU(n,e){const t=Dg(n,e),i=Q6(t);return yN(i)}function tU(n,e){const t=Dg(n,e),i=TN(t);return K6(i)}function nU(n,e,t){const{opacity:i,zIndex:s}=e;i!=null&&i!==t.opacity&&n.setOpacity(i),s!=null&&s!==t.zIndex&&n.setZIndex(s)}function Lg(){return Mg().map}function iU({bounds:n,boundsOptions:e,center:t,children:i,className:s,id:o,placeholder:l,style:d,whenReady:h,zoom:p,...v},x){const[b]=Z.useState({className:s,id:o,style:d}),[A,P]=Z.useState(null),F=Z.useRef(void 0);Z.useImperativeHandle(x,()=>(A==null?void 0:A.map)??null,[A]);const H=Z.useCallback(re=>{if(re!==null&&!F.current){const Q=new Sd.Map(re,v);F.current=Q,t!=null&&p!=null?Q.setView(t,p):n!=null&&Q.fitBounds(n,e),h!=null&&Q.whenReady(h),P(H6(Q))}},[]);Z.useEffect(()=>()=>{A==null||A.map.remove()},[A]);const X=A?af.createElement(dT,{value:A},i):l??null;return af.createElement("div",{...b,ref:H},X)}const EN=Z.forwardRef(iU),fT=$6(function({position:e,...t},i){const s=new Sd.Marker(e,t);return kg(s,_N(i,{overlayContainer:s}))},function(e,t,i){t.position!==i.position&&e.setLatLng(t.position),t.icon!=null&&t.icon!==i.icon&&e.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==i.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==i.opacity&&e.setOpacity(t.opacity),e.dragging!=null&&t.draggable!==i.draggable&&(t.draggable===!0?e.dragging.enable():e.dragging.disable())}),sU=eU(function({positions:e,...t},i){const s=new Sd.Polyline(e,t);return kg(s,_N(i,{overlayContainer:s}))},function(e,t,i){t.positions!==i.positions&&e.setLatLngs(t.positions)}),mT=X6(function(e,t){const i=new Sd.Popup(e,t.overlayContainer);return kg(i,t)},function(e,t,{position:i},s){Z.useEffect(function(){const{instance:l}=e;function d(p){p.popup===l&&(l.update(),s(!0))}function h(p){p.popup===l&&s(!1)}return t.map.on({popupopen:d,popupclose:h}),t.overlayContainer==null?(i!=null&&l.setLatLng(i),l.openOn(t.map)):t.overlayContainer.bindPopup(l),function(){var v;t.map.off({popupopen:d,popupclose:h}),(v=t.overlayContainer)==null||v.unbindPopup(),t.map.removeLayer(l)}},[e,t,s,i])}),xN=tU(function({url:e,...t},i){const s=new Sd.TileLayer(e,Pg(t,i));return kg(s,i)},function(e,t,i){nU(e,t,i);const{url:s}=t;s!=null&&s!==i.url&&e.setUrl(s)}),rU={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var OC={};const oU=()=>{try{if(typeof import.meta<"u"&&rU)return"";if(typeof process<"u"&&OC)return OC.VITE_API_KEY||""}catch(n){console.warn("Failed to access API key",n)}return""},hv=oU(),aU="AIzaSyC2SRWVViygm5tBgGQeGgFEq9_jK_PdT_0",lU=n=>{var e,t,i,s;if(typeof n.text=="string")return n.text;if(typeof n.text=="function")return n.text();if(n.candidates&&((s=(i=(t=(e=n.candidates[0])==null?void 0:e.content)==null?void 0:t.parts)==null?void 0:i[0])!=null&&s.text))return n.candidates[0].content.parts[0].text;throw new Error("No text found in AI response")},UC={1:{lat:25.033,lng:121.5654},"taipei 101":{lat:25.033,lng:121.5654},2:{lat:25.0421,lng:121.5082},3:{lat:25.1024,lng:121.5486},test:{lat:25.033,lng:121.5654},kyoto:{lat:35.0116,lng:135.7681},osaka:{lat:34.6937,lng:135.5023},tokyo:{lat:35.6762,lng:139.6503},:{lat:26.2048,lng:127.6458}," () check in":{lat:26.2048,lng:127.6458},:{lat:26.2048,lng:127.6458},"  ":{lat:26.196,lng:127.665},:{lat:26.196,lng:127.665},:{lat:26.196,lng:127.665},:{lat:26.2206,lng:127.6711},:{lat:26.1308,lng:127.7739},:{lat:26.3164,lng:127.7577},:{lat:26.695,lng:128.022},:{lat:26.6942,lng:127.8779},:{lat:26.505,lng:127.8512},:{lat:26.215,lng:127.685},"tokyo tower":{lat:35.6586,lng:139.7454},:{lat:35.6586,lng:139.7454}},qh=async(n,e)=>{const t=n.toLowerCase().trim();if(UC[t])return console.log(`Using Test Location for: ${n}`),UC[t];const i=async x=>{if(!x)return null;try{const A=await new oT({apiKey:x}).models.generateContent({model:"gemini-2.5-flash-lite",contents:`Convert this address to latitude and longitude coordinates: "${n}". 
                
                IMPORTANT: Return ONLY a JSON object in this exact format:
                {"lat": 25.0330, "lng": 121.5654}
                
                Do not include any explanations, just the JSON object.`,config:{responseMimeType:"application/json"}}),P=lU(A),F=JSON.parse(P);if(F.lat&&F.lng)return{lat:parseFloat(F.lat),lng:parseFloat(F.lng)}}catch(b){return console.warn(`Geocoding failed with key ${x.substring(0,5)}...`,b),null}return null},s=async x=>{if(!x)return null;try{console.log(`Trying Google Maps Geocoding API with key ${x.substring(0,5)}...`);const b=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(n)}&key=${x}`,P=await(await fetch(b)).json();if(P.status==="OK"&&P.results&&P.results.length>0){const F=P.results[0].geometry.location;return{lat:F.lat,lng:F.lng}}else console.warn("Google Maps Geocoding API error:",P.status,P.error_message),typeof window<"u"&&window.localStorage.setItem("last_geocode_error",`${P.status}: ${P.error_message||"Unknown error"}`)}catch(b){console.warn("Google Maps Geocoding API request failed:",b),typeof window<"u"&&window.localStorage.setItem("last_geocode_error",`Network Error: ${b}`)}return null},o=x=>x.split(/|\/|\|/).map(A=>A.trim()).filter(A=>A).map(A=>A.replace(/\(.*\)|.*/g,"").trim()).filter(A=>A.length>0),l=async(x,b={},A=5e3)=>{const P=new AbortController,F=setTimeout(()=>P.abort(),A);try{const H=await fetch(x,{...b,signal:P.signal});return clearTimeout(F),H}catch(H){throw clearTimeout(F),H}},d=async x=>{try{console.log(`[Geocoding] Trying Nominatim for: ${x}`);const b=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(x)}&limit=1`,{headers:{"User-Agent":"NomadAI-Travel-Journal/1.0"}});if(!b.ok)return console.warn(`[Geocoding] Nominatim request failed: ${b.status}`),null;const A=await b.json();if(console.log("[Geocoding] Nominatim response:",A),A&&A.length>0){const P=parseFloat(A[0].lat),F=parseFloat(A[0].lon);return console.log("[Geocoding] Nominatim success:",{lat:P,lng:F}),{lat:P,lng:F}}return null}catch(b){return console.error("Nominatim geocoding error:",b),null}},h=async x=>{try{console.log(`Trying Open-Meteo Geocoding for: "${x}"...`);const b=`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(x)}&count=1&language=zh&format=json`,A=await l(b);if(!A.ok)throw new Error(`Open-Meteo status: ${A.status}`);const P=await A.json();if(P&&P.results&&P.results.length>0){const F=P.results[0];return{lat:F.latitude,lng:F.longitude}}}catch(b){console.warn(`Open-Meteo failed for "${x}":`,b)}return null},p=[n,...o(n)],v=Array.from(new Set(p));console.log("Geocoding candidates:",v);for(const x of v){if(e){let P=await i(e);if(P||(P=await s(e),P))return P}if(hv){let P=await i(hv);if(P||(P=await s(hv),P))return P}{const P=await i(aU);if(P)return P}const b=await d(x);if(b)return b;const A=await h(x);if(A)return A}return null},uU=Object.freeze(Object.defineProperty({__proto__:null,geocodeAddress:qh},Symbol.toStringTag,{value:"Module"})),wN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",SN="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";let cU=Ou.icon({iconUrl:wN,shadowUrl:SN,iconSize:[25,41],iconAnchor:[12,41]});Ou.Marker.prototype.options.icon=cU;const dU=({bounds:n,isMapReady:e})=>{const t=Lg();return Z.useEffect(()=>{e&&n&&n.length>0&&setTimeout(()=>{t.fitBounds(n,{padding:[80,80]})},100)},[n,t,e]),null},hU=({onReady:n})=>{const e=Lg();return Z.useEffect(()=>{const t=setTimeout(()=>{e.invalidateSize(),n()},250);return()=>clearTimeout(t)},[e,n]),null},fU=({selectedLocation:n,searchedLocation:e,isMapReady:t})=>{const i=Lg();return Z.useEffect(()=>{t&&(e?i.flyTo([e.lat,e.lng],16,{animate:!0,duration:1.5}):n&&i.flyTo([n.lat,n.lng],16,{animate:!0,duration:1.5}))},[n,e,i,t]),null},mU=({item:n,index:e,isSelected:t,color:i,onClick:s})=>{var h,p;const o=af.useRef(null);Z.useEffect(()=>{t&&o.current&&o.current.openPopup()},[t]);const l=((h=n.coordinates)==null?void 0:h.lat)||n.lat,d=((p=n.coordinates)==null?void 0:p.lng)||n.lng;return!l||!d?null:_.jsx(fT,{ref:o,position:[l,d],icon:Ou.divIcon({className:"custom-div-icon",html:`<div style="background-color: ${t?"#C5A059":i}; width: ${t?"32px":"24px"}; height: ${t?"32px":"24px"}; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: ${t?"14px":"12px"}; transition: all 0.3s ease;">${e+1}</div>`,iconSize:[t?32:24,t?32:24],iconAnchor:[t?16:12,t?16:12]}),eventHandlers:{click:s},children:_.jsx(mT,{children:_.jsxs("div",{className:"text-center",children:[_.jsxs("div",{className:"font-bold text-ink",children:[e+1,". ",n.activity]}),_.jsx("div",{className:"text-xs text-gray-500",children:n.time}),_.jsxs("div",{className:"text-xs text-coral mt-1",children:["Day ",n.day]})]})})})},pU=({trip:n,settings:e,onUpdateTrip:t,searchedLocation:i,onItemClick:s,mapSearchQuery:o})=>{nn[e.language]||nn["zh-TW"];const[l,d]=Z.useState(null),[h,p]=Z.useState(new Set),[v,x]=Z.useState("ALL"),[b,A]=Z.useState(null),[P,F]=Z.useState(!1),H=Z.useMemo(()=>{const Y=n.itinerary||[];return v==="ALL"?Y:Y.filter(k=>k.day===v)},[n.itinerary,v]),X=Z.useMemo(()=>{const Y={};return(n.itinerary||[]).forEach(k=>{Y[k.day]||(Y[k.day]=[]),Y[k.day].push(k)}),Object.keys(Y).forEach(k=>{Y[Number(k)].sort((B,O)=>B.time.localeCompare(O.time))}),Y},[n.itinerary]),re=Z.useMemo(()=>Object.keys(X).map(Number).sort((Y,k)=>Y-k),[X]),Q=["#FF5733","#33FF57","#3357FF","#FF33F5","#33FFF5","#F5FF33"],he=Z.useMemo(()=>{const Y=H.filter(k=>k.coordinates||k.lat&&k.lng).map(k=>{var B,O;return[((B=k.coordinates)==null?void 0:B.lat)||k.lat,((O=k.coordinates)==null?void 0:O.lng)||k.lng]});return Y.length===0?null:Y},[H]),fe=Z.useMemo(()=>{var k,B,O;if(!b)return null;const Y=(k=n.itinerary)==null?void 0:k.find(q=>q.id===b);return Y&&(Y.coordinates||Y.lat&&Y.lng)?{lat:((B=Y.coordinates)==null?void 0:B.lat)||Y.lat,lng:((O=Y.coordinates)==null?void 0:O.lng)||Y.lng}:null},[b,n.itinerary]);return Z.useEffect(()=>{if(n.itinerary&&n.itinerary.length>0){const Y=Array.from(new Set(n.itinerary.map(k=>Number(k.day)))).sort((k,B)=>k-B);if(Y.length>0){const k=Y[0],B=n.itinerary.filter(O=>O.day===k).sort((O,q)=>O.time.localeCompare(q.time));if(B.length>0){const O=B[0];if(A(O.id),x(k),s){const q=O.location||O.activity;q&&setTimeout(()=>s(q),500)}}}}},[n.id]),Z.useEffect(()=>{window.localStorage.removeItem("last_geocode_error")},[n.id]),_.jsxs("div",{className:"h-full flex flex-col pb-24",children:[_.jsxs("div",{className:"mb-4 flex gap-2 overflow-x-auto no-scrollbar py-1 shrink-0",children:[_.jsx("button",{onClick:()=>{x("ALL"),A(null)},className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${v==="ALL"?"bg-ink text-white":"bg-white text-gray-500 border border-sand"}`,children:"ALL"}),re.map(Y=>_.jsxs("button",{onClick:()=>{x(Y),A(null)},className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${v===Y?"bg-coral text-white":"bg-white text-gray-500 border border-sand"}`,children:["Day ",Y]},Y))]}),_.jsx("div",{className:"h-[35vh] shrink-0 bg-gray-100 rounded-3xl overflow-hidden shadow-inner border border-sand relative z-0 mb-4",children:_.jsxs(EN,{center:[25.033,121.5654],zoom:13,style:{height:"100%",width:"100%"},children:[_.jsx(xN,{attribution:' <a href="https://www.google.com/maps">Google Maps</a>',url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"}),_.jsx(hU,{onReady:()=>F(!0)}),he&&!fe&&!i&&_.jsx(dU,{bounds:he,isMapReady:P}),_.jsx(fU,{selectedLocation:fe,searchedLocation:i,isMapReady:P}),i&&(()=>{const Y=H.findIndex(q=>{var G,W;return((G=q.coordinates)==null?void 0:G.lat)===i.lat&&((W=q.coordinates)==null?void 0:W.lng)===i.lng||q.location===o||q.activity===o}),k=Y!==-1?H[Y]:null;if(k&&k.coordinates)return null;const B=Y!==-1?Y+1:"?",O=k?Q[(k.day-1)%Q.length]:"#FF0000";return _.jsx(fT,{position:[i.lat,i.lng],icon:Ou.divIcon({className:"custom-div-icon",html:`<div style="background-color: ${O}; width: 32px; height: 32px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 16px;">${B}</div>`,iconSize:[32,32],iconAnchor:[16,16]}),children:_.jsx(mT,{children:_.jsx("div",{className:"text-center font-bold",children:"Searched Location"})})})})(),H.map((Y,k)=>_.jsx(mU,{item:Y,index:k,isSelected:b===Y.id,color:Q[(Y.day-1)%Q.length],onClick:()=>A(Y.id)},Y.id||k)),re.map((Y,k)=>{if(v!=="ALL"&&v!==Y)return null;const O=X[Y].filter(q=>{var G,W;return(((G=q.coordinates)==null?void 0:G.lat)||q.lat)&&(((W=q.coordinates)==null?void 0:W.lng)||q.lng)}).map(q=>{var G,W;return[((G=q.coordinates)==null?void 0:G.lat)||q.lat,((W=q.coordinates)==null?void 0:W.lng)||q.lng]});return O.length<2?null:_.jsx(sU,{positions:O,color:Q[k%Q.length],weight:4,opacity:.7,dashArray:"10, 10"},Y)})]})}),_.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-3 px-1",children:H.map((Y,k)=>{var G,W;const B=(((G=Y.coordinates)==null?void 0:G.lat)||Y.lat)&&(((W=Y.coordinates)==null?void 0:W.lng)||Y.lng),O=l===Y.id||l==="BATCH"&&!B,q=h.has(Y.id);return _.jsxs("div",{onClick:async()=>{if(A(Y.id),x(Y.day),s){const z=Y.location||Y.activity;z&&s(z)}if(!B&&!l){if(d(Y.id),h.has(Y.id)){const z=new Set(h);z.delete(Y.id),p(z)}console.log(`[TripMap] Starting geocode for item: ${Y.activity}`);try{let z=Y.location,He=null;if(z&&(console.log(`[TripMap] Trying location: ${z}`),He=await qh(z,e.apiKey)),He||(console.log(`[TripMap] Location failed or empty, trying activity: ${Y.activity}`),He=await qh(Y.activity,e.apiKey)),!He){const Qe=Y.activity.split(/[\(]/)[0].split(/|\/|\|/)[0].trim();Qe&&Qe!==Y.activity&&(console.log(`[TripMap] Activity failed, trying simplified: ${Qe}`),He=await qh(Qe,e.apiKey))}if(console.log("[TripMap] Final geocode result:",He),He&&t){const Qe=[...n.itinerary||[]],se=Qe.findIndex(Se=>Se.id===Y.id);se!==-1&&(console.log(`[TripMap] Updating item ${se} with coords`,He),Qe[se]={...Qe[se],coordinates:He,lat:He.lat,lng:He.lng},t({...n,itinerary:Qe}),console.log("[TripMap] onUpdateTrip called"))}else console.warn(`[TripMap] No coords found for item ${Y.id}`),p(Qe=>new Set(Qe).add(Y.id))}catch(z){console.error("On-demand geocoding failed",z),p(He=>new Set(He).add(Y.id))}finally{d(null)}}},className:`p-4 rounded-2xl border transition-all cursor-pointer flex items-center gap-4 ${b===Y.id?"bg-coral/10 border-coral shadow-md":"bg-white border-sand hover:border-coral/50"}`,children:[_.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold shrink-0 relative",style:{backgroundColor:Q[(Y.day-1)%Q.length]},children:O&&!B?_.jsx("div",{className:"absolute inset-0 border-2 border-white border-t-transparent rounded-full animate-spin"}):k+1}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsxs("div",{className:"flex justify-between items-start",children:[_.jsx("h3",{className:"font-bold text-ink truncate",children:Y.activity}),_.jsxs("span",{className:"text-xs font-bold text-coral bg-coral/10 px-2 py-0.5 rounded-full whitespace-nowrap",children:["Day ",Y.day]})]}),_.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[_.jsx("span",{className:"font-mono bg-gray-100 px-1.5 py-0.5 rounded",children:Y.time}),_.jsxs("span",{className:"truncate flex-1",children:[Y.location,O&&!B&&_.jsx("span",{className:"text-coral ml-1 text-[10px] animate-pulse",children:"..."}),q&&!B&&!O&&!(i&&(Y.location===o||Y.activity===o))&&_.jsx("span",{className:"text-red-500 ml-1 text-[10px]",children:""})]})]})]})]},Y.id||k)})})]})},gU=()=>{};var FC={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Me=function(n,e){if(!n)throw bd(e)},bd=function(n){return new Error("Firebase Database ("+bN.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},_U=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],l=n[t++],d=n[t++],h=((s&7)<<18|(o&63)<<12|(l&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(h>>10)),e[i++]=String.fromCharCode(56320+(h&1023))}else{const o=n[t++],l=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return e.join("")},pT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],l=s+1<n.length,d=l?n[s+1]:0,h=s+2<n.length,p=h?n[s+2]:0,v=o>>2,x=(o&3)<<4|d>>4;let b=(d&15)<<2|p>>6,A=p&63;h||(A=64,l||(b=64)),i.push(t[v],t[x],t[b],t[A])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(CN(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):_U(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],d=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const x=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||d==null||p==null||x==null)throw new yU;const b=o<<2|d>>4;if(i.push(b),p!==64){const A=d<<4&240|p>>2;if(i.push(A),x!==64){const P=p<<6&192|x;i.push(P)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class yU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const IN=function(n){const e=CN(n);return pT.encodeByteArray(e,!0)},Vp=function(n){return IN(n).replace(/\./g,"")},Op=function(n){try{return pT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vU(n){return AN(void 0,n)}function AN(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!TU(t)||(n[t]=AN(n[t],e[t]));return n}function TU(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EU=()=>NN().__FIREBASE_DEFAULTS__,xU=()=>{if(typeof process>"u"||typeof FC>"u")return;const n=FC.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},wU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Op(n[1]);return e&&JSON.parse(e)},Vg=()=>{try{return gU()||EU()||xU()||wU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},RN=n=>{var e,t;return(t=(e=Vg())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},MN=n=>{const e=RN(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},PN=()=>{var n;return(n=Vg())==null?void 0:n.config},kN=n=>{var e;return(e=Vg())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function _T(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Vp(JSON.stringify(t)),Vp(JSON.stringify(l)),""].join(".")}const Gh={};function SU(){const n={prod:[],emulator:[]};for(const e of Object.keys(Gh))Gh[e]?n.emulator.push(e):n.prod.push(e);return n}function bU(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let BC=!1;function yT(n,e){if(typeof window>"u"||typeof document>"u"||!pl(window.location.host)||Gh[n]===e||Gh[n]||BC)return;Gh[n]=e;function t(b){return`__firebase__banner__${b}`}const i="__firebase__banner",o=SU().prod.length>0;function l(){const b=document.getElementById(i);b&&b.remove()}function d(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function h(b,A){b.setAttribute("width","24"),b.setAttribute("id",A),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function p(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{BC=!0,l()},b}function v(b,A){b.setAttribute("id",A),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function x(){const b=bU(i),A=t("text"),P=document.getElementById(A)||document.createElement("span"),F=t("learnmore"),H=document.getElementById(F)||document.createElement("a"),X=t("preprendIcon"),re=document.getElementById(X)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const Q=b.element;d(Q),v(H,F);const he=p();h(re,X),Q.append(re,P,H,he),document.body.appendChild(Q)}o?(P.innerText="Preview backend disconnected.",re.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(re.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(si())}function LN(){var e;const n=(e=Vg())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function CU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function IU(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function VN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function AU(){const n=si();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function NU(){return bN.NODE_ADMIN===!0}function ON(){return!LN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function UN(){return!LN()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function FN(){try{return typeof indexedDB=="object"}catch{return!1}}function RU(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)==null?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MU="FirebaseError";class ta extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=MU,Object.setPrototypeOf(this,ta.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Af.prototype.create)}}class Af{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],l=o?PU(o,i):"Error",d=`${this.serviceName}: ${l} (${s}).`;return new ta(s,d,i)}}function PU(n,e){return n.replace(kU,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const kU=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(n){return JSON.parse(n)}function yi(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BN=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=lf(Op(o[0])||""),t=lf(Op(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},DU=function(n){const e=BN(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},LU=function(n){const e=BN(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function na(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Xc(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Yv(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Up(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function Ko(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],l=e[s];if(zC(o)&&zC(l)){if(!Ko(o,l))return!1}else if(o!==l)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function zC(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let x=0;x<16;x++)i[x]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let x=0;x<16;x++)i[x]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let x=16;x<80;x++){const b=i[x-3]^i[x-8]^i[x-14]^i[x-16];i[x]=(b<<1|b>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],l=this.chain_[2],d=this.chain_[3],h=this.chain_[4],p,v;for(let x=0;x<80;x++){x<40?x<20?(p=d^o&(l^d),v=1518500249):(p=o^l^d,v=1859775393):x<60?(p=o&l|d&(o|l),v=2400959708):(p=o^l^d,v=3395469782);const b=(s<<5|s>>>27)+p+h+v+i[x]&4294967295;h=d,d=l,l=(o<<30|o>>>2)&4294967295,o=s,s=b}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+d&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let l=this.inbuf_;for(;s<t;){if(l===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[l]=e.charCodeAt(s),++l,++s,l===this.blockSize){this.compress_(o),l=0;break}}else for(;s<t;)if(o[l]=e[s],++l,++s,l===this.blockSize){this.compress_(o),l=0;break}}this.inbuf_=l,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function OU(n,e){const t=new UU(n,e);return t.subscribe.bind(t)}class UU{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");FU(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=fv),s.error===void 0&&(s.error=fv),s.complete===void 0&&(s.complete=fv);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function FU(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function fv(){}function zN(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BU=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,Me(i<n.length,"Surrogate pair missing trail surrogate.");const l=n.charCodeAt(i)-56320;s=65536+(o<<10)+l}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Og=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Un(n){return n&&n._delegate?n._delegate:n}class al{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iu="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new gT;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(GU(e))try{this.getOrInitializeService({instanceIdentifier:iu})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=iu){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=iu){return this.instances.has(e)}getOptions(e=iu){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(o);i===d&&l.resolve(s)}return s}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(i)??new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:qU(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=iu){return this.component?this.component.multipleInstances?e:iu:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qU(n){return n===iu?void 0:n}function GU(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new zU(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(bt||(bt={}));const jU={debug:bt.DEBUG,verbose:bt.VERBOSE,info:bt.INFO,warn:bt.WARN,error:bt.ERROR,silent:bt.SILENT},KU=bt.INFO,WU={[bt.DEBUG]:"log",[bt.VERBOSE]:"log",[bt.INFO]:"info",[bt.WARN]:"warn",[bt.ERROR]:"error"},YU=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=WU[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ug{constructor(e){this.name=e,this._logLevel=KU,this._logHandler=YU,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in bt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,bt.DEBUG,...e),this._logHandler(this,bt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,bt.VERBOSE,...e),this._logHandler(this,bt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,bt.INFO,...e),this._logHandler(this,bt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,bt.WARN,...e),this._logHandler(this,bt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,bt.ERROR,...e),this._logHandler(this,bt.ERROR,...e)}}const JU=(n,e)=>e.some(t=>n instanceof t);let qC,GC;function ZU(){return qC||(qC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function QU(){return GC||(GC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qN=new WeakMap,Jv=new WeakMap,GN=new WeakMap,mv=new WeakMap,TT=new WeakMap;function $U(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",l)},o=()=>{t(Xa(n.result)),s()},l=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&qN.set(t,n)}).catch(()=>{}),TT.set(e,n),e}function XU(n){if(Jv.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",l),n.removeEventListener("abort",l)},o=()=>{t(),s()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",l),n.addEventListener("abort",l)});Jv.set(n,e)}let Zv={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Jv.get(n);if(e==="objectStoreNames")return n.objectStoreNames||GN.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xa(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function eF(n){Zv=n(Zv)}function tF(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(pv(this),e,...t);return GN.set(i,e.sort?e.sort():[e]),Xa(i)}:QU().includes(n)?function(...e){return n.apply(pv(this),e),Xa(qN.get(this))}:function(...e){return Xa(n.apply(pv(this),e))}}function nF(n){return typeof n=="function"?tF(n):(n instanceof IDBTransaction&&XU(n),JU(n,ZU())?new Proxy(n,Zv):n)}function Xa(n){if(n instanceof IDBRequest)return $U(n);if(mv.has(n))return mv.get(n);const e=nF(n);return e!==n&&(mv.set(n,e),TT.set(e,n)),e}const pv=n=>TT.get(n);function iF(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const l=indexedDB.open(n,e),d=Xa(l);return i&&l.addEventListener("upgradeneeded",h=>{i(Xa(l.result),h.oldVersion,h.newVersion,Xa(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),d.then(h=>{o&&h.addEventListener("close",()=>o()),s&&h.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),d}const sF=["get","getKey","getAll","getAllKeys","count"],rF=["put","add","delete","clear"],gv=new Map;function HC(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(gv.get(e))return gv.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=rF.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||sF.includes(t)))return;const o=async function(l,...d){const h=this.transaction(l,s?"readwrite":"readonly");let p=h.store;return i&&(p=p.index(d.shift())),(await Promise.all([p[t](...d),s&&h.done]))[0]};return gv.set(e,o),o}eF(n=>({...n,get:(e,t,i)=>HC(e,t)||n.get(e,t,i),has:(e,t)=>!!HC(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(aF(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function aF(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Qv="@firebase/app",jC="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wo=new Ug("@firebase/app"),lF="@firebase/app-compat",uF="@firebase/analytics-compat",cF="@firebase/analytics",dF="@firebase/app-check-compat",hF="@firebase/app-check",fF="@firebase/auth",mF="@firebase/auth-compat",pF="@firebase/database",gF="@firebase/data-connect",_F="@firebase/database-compat",yF="@firebase/functions",vF="@firebase/functions-compat",TF="@firebase/installations",EF="@firebase/installations-compat",xF="@firebase/messaging",wF="@firebase/messaging-compat",SF="@firebase/performance",bF="@firebase/performance-compat",CF="@firebase/remote-config",IF="@firebase/remote-config-compat",AF="@firebase/storage",NF="@firebase/storage-compat",RF="@firebase/firestore",MF="@firebase/ai",PF="@firebase/firestore-compat",kF="firebase",DF="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v="[DEFAULT]",LF={[Qv]:"fire-core",[lF]:"fire-core-compat",[cF]:"fire-analytics",[uF]:"fire-analytics-compat",[hF]:"fire-app-check",[dF]:"fire-app-check-compat",[fF]:"fire-auth",[mF]:"fire-auth-compat",[pF]:"fire-rtdb",[gF]:"fire-data-connect",[_F]:"fire-rtdb-compat",[yF]:"fire-fn",[vF]:"fire-fn-compat",[TF]:"fire-iid",[EF]:"fire-iid-compat",[xF]:"fire-fcm",[wF]:"fire-fcm-compat",[SF]:"fire-perf",[bF]:"fire-perf-compat",[CF]:"fire-rc",[IF]:"fire-rc-compat",[AF]:"fire-gcs",[NF]:"fire-gcs-compat",[RF]:"fire-fst",[PF]:"fire-fst-compat",[MF]:"fire-vertex","fire-js":"fire-js",[kF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fp=new Map,VF=new Map,Xv=new Map;function KC(n,e){try{n.container.addComponent(e)}catch(t){Wo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Eu(n){const e=n.name;if(Xv.has(e))return Wo.debug(`There were multiple attempts to register component ${e}.`),!1;Xv.set(e,n);for(const t of Fp.values())KC(t,n);for(const t of VF.values())KC(t,n);return!0}function Fg(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ar(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},el=new Af("app","Firebase",OF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UF{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new al("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw el.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uu=DF;function HN(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:$v,automaticDataCollectionEnabled:!0,...e},s=i.name;if(typeof s!="string"||!s)throw el.create("bad-app-name",{appName:String(s)});if(t||(t=PN()),!t)throw el.create("no-options");const o=Fp.get(s);if(o){if(Ko(t,o.options)&&Ko(i,o.config))return o;throw el.create("duplicate-app",{appName:s})}const l=new HU(s);for(const h of Xv.values())l.addComponent(h);const d=new UF(t,i,l);return Fp.set(s,d),d}function ET(n=$v){const e=Fp.get(n);if(!e&&n===$v&&PN())return HN();if(!e)throw el.create("no-app",{appName:n});return e}function so(n,e,t){let i=LF[n]??n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Wo.warn(l.join(" "));return}Eu(new al(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FF="firebase-heartbeat-database",BF=1,uf="firebase-heartbeat-store";let _v=null;function jN(){return _v||(_v=iF(FF,BF,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(uf)}catch(t){console.warn(t)}}}}).catch(n=>{throw el.create("idb-open",{originalErrorMessage:n.message})})),_v}async function zF(n){try{const t=(await jN()).transaction(uf),i=await t.objectStore(uf).get(KN(n));return await t.done,i}catch(e){if(e instanceof ta)Wo.warn(e.message);else{const t=el.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Wo.warn(t.message)}}}async function WC(n,e){try{const i=(await jN()).transaction(uf,"readwrite");await i.objectStore(uf).put(e,KN(n)),await i.done}catch(t){if(t instanceof ta)Wo.warn(t.message);else{const i=el.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Wo.warn(i.message)}}}function KN(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qF=1024,GF=30;class HF{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new KF(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=YC();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>GF){const l=WF(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Wo.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=YC(),{heartbeatsToSend:i,unsentEntries:s}=jF(this._heartbeatsCache.heartbeats),o=Vp(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Wo.warn(t),""}}}function YC(){return new Date().toISOString().substring(0,10)}function jF(n,e=qF){const t=[];let i=n.slice();for(const s of n){const o=t.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),JC(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),JC(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class KF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return FN()?RU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zF(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return WC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return WC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function JC(n){return Vp(JSON.stringify({version:2,heartbeats:n})).length}function WF(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YF(n){Eu(new al("platform-logger",e=>new oF(e),"PRIVATE")),Eu(new al("heartbeat",e=>new HF(e),"PRIVATE")),so(Qv,jC,n),so(Qv,jC,"esm2020"),so("fire-js","")}YF("");var JF="firebase",ZF="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */so(JF,ZF,"app");function WN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QF=WN,YN=new Af("auth","Firebase",WN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bp=new Ug("@firebase/auth");function $F(n,...e){Bp.logLevel<=bt.WARN&&Bp.warn(`Auth (${Uu}): ${n}`,...e)}function dp(n,...e){Bp.logLevel<=bt.ERROR&&Bp.error(`Auth (${Uu}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lo(n,...e){throw wT(n,...e)}function Mr(n,...e){return wT(n,...e)}function xT(n,e,t){const i={...QF(),[e]:t};return new Af("auth","Firebase",i).create(e,{appName:n.name})}function pu(n){return xT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function XF(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&lo(n,"argument-error"),xT(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function wT(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return YN.create(n,...e)}function at(n,e,...t){if(!n)throw wT(e,...t)}function Fo(n){const e="INTERNAL ASSERTION FAILED: "+n;throw dp(e),new Error(e)}function Yo(n,e){n||Fo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e0(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function e9(){return ZC()==="http:"||ZC()==="https:"}function ZC(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(e9()||IU()||"connection"in navigator)?navigator.onLine:!0}function n9(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,t){this.shortDelay=e,this.longDelay=t,Yo(t>e,"Short delay should be less than long delay!"),this.isMobile=vT()||VN()}get(){return t9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ST(n,e){Yo(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s9=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],r9=new Nf(3e4,6e4);function bT(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Id(n,e,t,i,s={}){return ZN(n,s,async()=>{let o={},l={};i&&(e==="GET"?l=i:o={body:JSON.stringify(i)});const d=Cd({key:n.config.apiKey,...l}).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:h,...o};return CU()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&pl(n.emulatorConfig.host)&&(p.credentials="include"),JN.fetch()(await QN(n,n.config.apiHost,t,d),p)})}async function ZN(n,e,t){n._canInitEmulator=!1;const i={...i9,...e};try{const s=new a9(n),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw $m(n,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const d=o.ok?l.errorMessage:l.error.message,[h,p]=d.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw $m(n,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw $m(n,"email-already-in-use",l);if(h==="USER_DISABLED")throw $m(n,"user-disabled",l);const v=i[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw xT(n,v,p);lo(n,v)}}catch(s){if(s instanceof ta)throw s;lo(n,"network-request-failed",{message:String(s)})}}async function o9(n,e,t,i,s={}){const o=await Id(n,e,t,i,s);return"mfaPendingCredential"in o&&lo(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function QN(n,e,t,i){const s=`${e}${t}?${i}`,o=n,l=o.config.emulator?ST(n.config,s):`${n.config.apiScheme}://${s}`;return s9.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}class a9{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Mr(this.auth,"network-request-failed")),r9.get())})}}function $m(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=Mr(n,e,i);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l9(n,e){return Id(n,"POST","/v1/accounts:delete",e)}async function zp(n,e){return Id(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hh(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function u9(n,e=!1){const t=Un(n),i=await t.getIdToken(e),s=CT(i);at(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,l=o==null?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:Hh(yv(s.auth_time)),issuedAtTime:Hh(yv(s.iat)),expirationTime:Hh(yv(s.exp)),signInProvider:l||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function yv(n){return Number(n)*1e3}function CT(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return dp("JWT malformed, contained fewer than 3 sections"),null;try{const s=Op(t);return s?JSON.parse(s):(dp("Failed to decode base64 JWT payload"),null)}catch(s){return dp("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function QC(n){const e=CT(n);return at(e,"internal-error"),at(typeof e.exp<"u","internal-error"),at(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cf(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ta&&c9(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function c9({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hh(this.lastLoginAt),this.creationTime=Hh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qp(n){var x;const e=n.auth,t=await n.getIdToken(),i=await cf(n,zp(e,{idToken:t}));at(i==null?void 0:i.users.length,e,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=(x=s.providerUserInfo)!=null&&x.length?$N(s.providerUserInfo):[],l=f9(n.providerData,o),d=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=d?h:!1,v={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new t0(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,v)}async function h9(n){const e=Un(n);await qp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function f9(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function $N(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m9(n,e){const t=await ZN(n,{},async()=>{const i=Cd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,l=await QN(n,s,"/v1/token",`key=${o}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:d,body:i};return n.emulatorConfig&&pl(n.emulatorConfig.host)&&(h.credentials="include"),JN.fetch()(l,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function p9(n,e){return Id(n,"POST","/v2/accounts:revokeToken",bT(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){at(e.idToken,"internal-error"),at(typeof e.idToken<"u","internal-error"),at(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):QC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){at(e.length!==0,"internal-error");const t=QC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(at(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:o}=await m9(e,t);this.updateTokensAndExpiration(i,s,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:o}=t,l=new jc;return i&&(at(typeof i=="string","internal-error",{appName:e}),l.refreshToken=i),s&&(at(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),o&&(at(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jc,this.toJSON())}_performRefresh(){return Fo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qa(n,e){at(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ar{constructor({uid:e,auth:t,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new d9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new t0(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await cf(this,this.stsTokenManager.getToken(this.auth,e));return at(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return u9(this,e)}reload(){return h9(this)}_assign(e){this!==e&&(at(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ar({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){at(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await qp(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ar(this.auth.app))return Promise.reject(pu(this.auth));const e=await this.getIdToken();return await cf(this,l9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,s=t.email??void 0,o=t.phoneNumber??void 0,l=t.photoURL??void 0,d=t.tenantId??void 0,h=t._redirectEventId??void 0,p=t.createdAt??void 0,v=t.lastLoginAt??void 0,{uid:x,emailVerified:b,isAnonymous:A,providerData:P,stsTokenManager:F}=t;at(x&&F,e,"internal-error");const H=jc.fromJSON(this.name,F);at(typeof x=="string",e,"internal-error"),qa(i,e.name),qa(s,e.name),at(typeof b=="boolean",e,"internal-error"),at(typeof A=="boolean",e,"internal-error"),qa(o,e.name),qa(l,e.name),qa(d,e.name),qa(h,e.name),qa(p,e.name),qa(v,e.name);const X=new Ar({uid:x,auth:e,email:s,emailVerified:b,displayName:i,isAnonymous:A,photoURL:l,phoneNumber:o,tenantId:d,stsTokenManager:H,createdAt:p,lastLoginAt:v});return P&&Array.isArray(P)&&(X.providerData=P.map(re=>({...re}))),h&&(X._redirectEventId=h),X}static async _fromIdTokenResponse(e,t,i=!1){const s=new jc;s.updateFromServerResponse(t);const o=new Ar({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await qp(o),o}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];at(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?$N(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),d=new jc;d.updateFromIdToken(i);const h=new Ar({uid:s.localId,auth:e,stsTokenManager:d,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new t0(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(h,p),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=new Map;function Bo(n){Yo(n instanceof Function,"Expected a class definition");let e=$C.get(n);return e?(Yo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,$C.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XN.type="NONE";const XC=XN;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp(n,e,t){return`firebase:${n}:${e}:${t}`}class Kc{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:o}=this.auth;this.fullUserKey=hp(this.userKey,s.apiKey,o),this.fullPersistenceKey=hp("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await zp(this.auth,{idToken:e}).catch(()=>{});return t?Ar._fromGetAccountInfoResponse(this.auth,t,e):null}return Ar._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Kc(Bo(XC),e,i);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=s[0]||Bo(XC);const l=hp(i,e.config.apiKey,e.name);let d=null;for(const p of t)try{const v=await p._get(l);if(v){let x;if(typeof v=="string"){const b=await zp(e,{idToken:v}).catch(()=>{});if(!b)break;x=await Ar._fromGetAccountInfoResponse(e,b,v)}else x=Ar._fromJSON(e,v);p!==o&&(d=x),o=p;break}}catch{}const h=s.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Kc(o,e,i):(o=h[0],d&&await o._set(l,d.toJSON()),await Promise.all(t.map(async p=>{if(p!==o)try{await p._remove(l)}catch{}})),new Kc(o,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(iR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(eR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(rR(e))return"Blackberry";if(oR(e))return"Webos";if(tR(e))return"Safari";if((e.includes("chrome/")||nR(e))&&!e.includes("edge/"))return"Chrome";if(sR(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function eR(n=si()){return/firefox\//i.test(n)}function tR(n=si()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nR(n=si()){return/crios\//i.test(n)}function iR(n=si()){return/iemobile/i.test(n)}function sR(n=si()){return/android/i.test(n)}function rR(n=si()){return/blackberry/i.test(n)}function oR(n=si()){return/webos/i.test(n)}function IT(n=si()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function g9(n=si()){var e;return IT(n)&&!!((e=window.navigator)!=null&&e.standalone)}function _9(){return AU()&&document.documentMode===10}function aR(n=si()){return IT(n)||sR(n)||oR(n)||rR(n)||/windows phone/i.test(n)||iR(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(n,e=[]){let t;switch(n){case"Browser":t=eI(si());break;case"Worker":t=`${eI(si())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Uu}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=o=>new Promise((l,d)=>{try{const h=e(o);l(h)}catch(h){d(h)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v9(n,e={}){return Id(n,"GET","/v2/passwordPolicy",bT(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T9=6;class E9{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??T9,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tI(this),this.idTokenSubscription=new tI(this),this.beforeStateQueue=new y9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=YN,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Bo(t)),this._initializationPromise=this.queue(async()=>{var i,s,o;if(!this._deleted&&(this.persistenceManager=await Kc.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)==null?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await zp(this,{idToken:e}),i=await Ar._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var o;if(ar(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(o=this.redirectUser)==null?void 0:o._redirectEventId,d=i==null?void 0:i._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===d)&&(h!=null&&h.user)&&(i=h.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return at(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await qp(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=n9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ar(this.app))return Promise.reject(pu(this));const t=e?Un(e):null;return t&&at(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&at(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ar(this.app)?Promise.reject(pu(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ar(this.app)?Promise.reject(pu(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Bo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await v9(this),t=new E9(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Af("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await p9(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Bo(e)||this._popupRedirectResolver;at(t,this,"argument-error"),this.redirectPersistenceManager=await Kc.create(this,[Bo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let l=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(at(d,this,"internal-error"),d.then(()=>{l||o(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,i,s);return()=>{l=!0,h()}}else{const h=e.addObserver(t);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return at(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(ar(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&$F(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Bg(n){return Un(n)}class tI{constructor(e){this.auth=e,this.observer=null,this.addObserver=OU(t=>this.observer=t)}get next(){return at(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AT={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function w9(n){AT=n}function S9(n){return AT.loadJS(n)}function b9(){return AT.gapiScript}function C9(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I9(n,e){const t=Fg(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(Ko(o,e??{}))return s;lo(s,"already-initialized")}return t.initialize({options:e})}function A9(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Bo);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function N9(n,e,t){const i=Bg(n);at(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!1,o=uR(e),{host:l,port:d}=R9(e),h=d===null?"":`:${d}`,p={url:`${o}//${l}${h}/`},v=Object.freeze({host:l,port:d,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){at(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),at(Ko(p,i.config.emulator)&&Ko(v,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=v,i.settings.appVerificationDisabledForTesting=!0,pl(l)?(_T(`${o}//${l}${h}`),yT("Auth",!0)):M9()}function uR(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function R9(n){const e=uR(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const o=s[1];return{host:o,port:nI(i.substr(o.length+1))}}else{const[o,l]=i.split(":");return{host:o,port:nI(l)}}}function nI(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function M9(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fo("not implemented")}_getIdTokenResponse(e){return Fo("not implemented")}_linkToIdToken(e,t){return Fo("not implemented")}_getReauthenticationResolver(e){return Fo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wc(n,e){return o9(n,"POST","/v1/accounts:signInWithIdp",bT(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P9="http://localhost";class xu extends cR{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new xu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):lo("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,...o}=t;if(!i||!s)return null;const l=new xu(i,s);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Wc(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Wc(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Wc(e,t)}buildRequest(){const e={requestUri:P9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Cd(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf extends NT{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka extends Rf{constructor(){super("facebook.com")}static credential(e){return xu._fromParams({providerId:Ka.PROVIDER_ID,signInMethod:Ka.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ka.credentialFromTaggedObject(e)}static credentialFromError(e){return Ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ka.credential(e.oauthAccessToken)}catch{return null}}}Ka.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ka.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo extends Rf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return xu._fromParams({providerId:Uo.PROVIDER_ID,signInMethod:Uo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Uo.credentialFromTaggedObject(e)}static credentialFromError(e){return Uo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Uo.credential(t,i)}catch{return null}}}Uo.GOOGLE_SIGN_IN_METHOD="google.com";Uo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa extends Rf{constructor(){super("github.com")}static credential(e){return xu._fromParams({providerId:Wa.PROVIDER_ID,signInMethod:Wa.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wa.credentialFromTaggedObject(e)}static credentialFromError(e){return Wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wa.credential(e.oauthAccessToken)}catch{return null}}}Wa.GITHUB_SIGN_IN_METHOD="github.com";Wa.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya extends Rf{constructor(){super("twitter.com")}static credential(e,t){return xu._fromParams({providerId:Ya.PROVIDER_ID,signInMethod:Ya.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ya.credentialFromTaggedObject(e)}static credentialFromError(e){return Ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ya.credential(t,i)}catch{return null}}}Ya.TWITTER_SIGN_IN_METHOD="twitter.com";Ya.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const o=await Ar._fromIdTokenResponse(e,i,s),l=iI(i);return new ed({user:o,providerId:l,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=iI(i);return new ed({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function iI(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp extends ta{constructor(e,t,i,s){super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,Gp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new Gp(e,t,i,s)}}function dR(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Gp._fromErrorAndOperation(n,o,e,i):o})}async function k9(n,e,t=!1){const i=await cf(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ed._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D9(n,e,t=!1){const{auth:i}=n;if(ar(i.app))return Promise.reject(pu(i));const s="reauthenticate";try{const o=await cf(n,dR(i,s,e,n),t);at(o.idToken,i,"internal-error");const l=CT(o.idToken);at(l,i,"internal-error");const{sub:d}=l;return at(n.uid===d,i,"user-mismatch"),ed._forOperation(n,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&lo(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L9(n,e,t=!1){if(ar(n.app))return Promise.reject(pu(n));const i="signIn",s=await dR(n,i,e),o=await ed._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(o.user),o}function V9(n,e,t,i){return Un(n).onIdTokenChanged(e,t,i)}function O9(n,e,t){return Un(n).beforeAuthStateChanged(e,t)}function U9(n,e,t,i){return Un(n).onAuthStateChanged(e,t,i)}function F9(n){return Un(n).signOut()}const Hp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Hp,"1"),this.storage.removeItem(Hp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B9=1e3,z9=10;class fR extends hR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=aR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,d,h)=>{this.notifyListeners(l,h)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(i);!t&&this.localCache[i]===l||this.notifyListeners(i,l)},o=this.storage.getItem(i);_9()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,z9):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},B9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}fR.type="LOCAL";const q9=fR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR extends hR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}mR.type="SESSION";const pR=mR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G9(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new zg(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:o}=t.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const d=Array.from(l).map(async p=>p(t.origin,o)),h=await G9(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}zg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RT(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H9{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,l;return new Promise((d,h)=>{const p=RT("",20);s.port1.start();const v=setTimeout(()=>{h(new Error("unsupported_event"))},i);l={messageChannel:s,onMessage(x){const b=x;if(b.data.eventId===p)switch(b.data.status){case"ack":clearTimeout(v),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),d(b.data.response);break;default:clearTimeout(v),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(){return window}function j9(n){ro().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gR(){return typeof ro().WorkerGlobalScope<"u"&&typeof ro().importScripts=="function"}async function K9(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function W9(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function Y9(){return gR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R="firebaseLocalStorageDb",J9=1,jp="firebaseLocalStorage",yR="fbase_key";class Mf{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function qg(n,e){return n.transaction([jp],e?"readwrite":"readonly").objectStore(jp)}function Z9(){const n=indexedDB.deleteDatabase(_R);return new Mf(n).toPromise()}function n0(){const n=indexedDB.open(_R,J9);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(jp,{keyPath:yR})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(jp)?e(i):(i.close(),await Z9(),e(await n0()))})})}async function sI(n,e,t){const i=qg(n,!0).put({[yR]:e,value:t});return new Mf(i).toPromise()}async function Q9(n,e){const t=qg(n,!1).get(e),i=await new Mf(t).toPromise();return i===void 0?null:i.value}function rI(n,e){const t=qg(n,!0).delete(e);return new Mf(t).toPromise()}const $9=800,X9=3;class vR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await n0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>X9)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return gR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=zg._getInstance(Y9()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await K9(),!this.activeServiceWorker)return;this.sender=new H9(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||W9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await n0();return await sI(e,Hp,"1"),await rI(e,Hp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>sI(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>Q9(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>rI(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=qg(s,!1).getAll();return new Mf(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}vR.type="LOCAL";const eB=vR;new Nf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TR(n,e){return e?Bo(e):(at(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MT extends cR{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Wc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Wc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function tB(n){return L9(n.auth,new MT(n),n.bypassAuthState)}function nB(n){const{auth:e,user:t}=n;return at(t,e,"internal-error"),D9(t,new MT(n),n.bypassAuthState)}async function iB(n){const{auth:e,user:t}=n;return at(t,e,"internal-error"),k9(t,new MT(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e,t,i,s,o=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:o,error:l,type:d}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(h))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tB;case"linkViaPopup":case"linkViaRedirect":return iB;case"reauthViaPopup":case"reauthViaRedirect":return nB;default:lo(this.auth,"internal-error")}}resolve(e){Yo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sB=new Nf(2e3,1e4);async function rB(n,e,t){if(ar(n.app))return Promise.reject(Mr(n,"operation-not-supported-in-this-environment"));const i=Bg(n);XF(n,e,NT);const s=TR(i,t);return new hu(i,"signInViaPopup",e,s).executeNotNull()}class hu extends ER{constructor(e,t,i,s,o){super(e,t,s,o),this.provider=i,this.authWindow=null,this.pollId=null,hu.currentPopupAction&&hu.currentPopupAction.cancel(),hu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return at(e,this.auth,"internal-error"),e}async onExecution(){Yo(this.filter.length===1,"Popup operations only handle one event");const e=RT();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Mr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Mr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,hu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Mr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,sB.get())};e()}}hu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oB="pendingRedirect",fp=new Map;class aB extends ER{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=fp.get(this.auth._key());if(!e){try{const i=await lB(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}fp.set(this.auth._key(),e)}return this.bypassAuthState||fp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function lB(n,e){const t=dB(e),i=cB(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}function uB(n,e){fp.set(n._key(),e)}function cB(n){return Bo(n._redirectPersistence)}function dB(n){return hp(oB,n.config.apiKey,n.name)}async function hB(n,e,t=!1){if(ar(n.app))return Promise.reject(pu(n));const i=Bg(n),s=TR(i,e),l=await new aB(i,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await i._persistUserIfCurrent(l.user),await i._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fB=600*1e3;class mB{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!pB(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!xR(e)){const s=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Mr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=fB&&this.cachedEventUids.clear(),this.cachedEventUids.has(oI(e))}saveEventToCache(e){this.cachedEventUids.add(oI(e)),this.lastProcessedEventTime=Date.now()}}function oI(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function xR({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function pB(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xR(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gB(n,e={}){return Id(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _B=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yB=/^https?/;async function vB(n){if(n.config.emulator)return;const{authorizedDomains:e}=await gB(n);for(const t of e)try{if(TB(t))return}catch{}lo(n,"unauthorized-domain")}function TB(n){const e=e0(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===i}if(!yB.test(t))return!1;if(_B.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EB=new Nf(3e4,6e4);function aI(){const n=ro().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function xB(n){return new Promise((e,t)=>{var s,o,l;function i(){aI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{aI(),t(Mr(n,"network-request-failed"))},timeout:EB.get()})}if((o=(s=ro().gapi)==null?void 0:s.iframes)!=null&&o.Iframe)e(gapi.iframes.getContext());else if((l=ro().gapi)!=null&&l.load)i();else{const d=C9("iframefcb");return ro()[d]=()=>{gapi.load?i():t(Mr(n,"network-request-failed"))},S9(`${b9()}?onload=${d}`).catch(h=>t(h))}}).catch(e=>{throw mp=null,e})}let mp=null;function wB(n){return mp=mp||xB(n),mp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SB=new Nf(5e3,15e3),bB="__/auth/iframe",CB="emulator/auth/iframe",IB={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},AB=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NB(n){const e=n.config;at(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ST(e,CB):`https://${n.config.authDomain}/${bB}`,i={apiKey:e.apiKey,appName:n.name,v:Uu},s=AB.get(n.config.apiHost);s&&(i.eid=s);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${Cd(i).slice(1)}`}async function RB(n){const e=await wB(n),t=ro().gapi;return at(t,n,"internal-error"),e.open({where:document.body,url:NB(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IB,dontclear:!0},i=>new Promise(async(s,o)=>{await i.restyle({setHideOnLeave:!1});const l=Mr(n,"network-request-failed"),d=ro().setTimeout(()=>{o(l)},SB.get());function h(){ro().clearTimeout(d),s(i)}i.ping(h).then(h,()=>{o(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MB={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},PB=500,kB=600,DB="_blank",LB="http://localhost";class lI{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VB(n,e,t,i=PB,s=kB){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const h={...MB,width:i.toString(),height:s.toString(),top:o,left:l},p=si().toLowerCase();t&&(d=nR(p)?DB:t),eR(p)&&(e=e||LB,h.scrollbars="yes");const v=Object.entries(h).reduce((b,[A,P])=>`${b}${A}=${P},`,"");if(g9(p)&&d!=="_self")return OB(e||"",d),new lI(null);const x=window.open(e||"",d,v);at(x,n,"popup-blocked");try{x.focus()}catch{}return new lI(x)}function OB(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UB="__/auth/handler",FB="emulator/auth/handler",BB=encodeURIComponent("fac");async function uI(n,e,t,i,s,o){at(n.config.authDomain,n,"auth-domain-config-required"),at(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Uu,eventId:s};if(e instanceof NT){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",Yv(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,x]of Object.entries({}))l[v]=x}if(e instanceof Rf){const v=e.getScopes().filter(x=>x!=="");v.length>0&&(l.scopes=v.join(","))}n.tenantId&&(l.tid=n.tenantId);const d=l;for(const v of Object.keys(d))d[v]===void 0&&delete d[v];const h=await n._getAppCheckToken(),p=h?`#${BB}=${encodeURIComponent(h)}`:"";return`${zB(n)}?${Cd(d).slice(1)}${p}`}function zB({config:n}){return n.emulator?ST(n,FB):`https://${n.authDomain}/${UB}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vv="webStorageSupport";class qB{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pR,this._completeRedirectFn=hB,this._overrideRedirectResult=uB}async _openPopup(e,t,i,s){var l;Yo((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const o=await uI(e,t,i,e0(),s);return VB(e,o,RT())}async _openRedirect(e,t,i,s){await this._originValidation(e);const o=await uI(e,t,i,e0(),s);return j9(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(Yo(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await RB(e),i=new mB(e);return t.register("authEvent",s=>(at(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(vv,{type:vv},s=>{var l;const o=(l=s==null?void 0:s[0])==null?void 0:l[vv];o!==void 0&&t(!!o),lo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=vB(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return aR()||tR()||IT()}}const GB=qB;var cI="@firebase/auth",dI="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HB{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){at(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jB(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function KB(n){Eu(new al("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:d}=i.options;at(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});const h={apiKey:l,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lR(n)},p=new x9(i,s,o,h);return A9(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Eu(new al("auth-internal",e=>{const t=Bg(e.getProvider("auth").getImmediate());return(i=>new HB(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),so(cI,dI,jB(n)),so(cI,dI,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WB=300,YB=kN("authIdTokenMaxAge")||WB;let hI=null;const JB=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>YB)return;const s=t==null?void 0:t.token;hI!==s&&(hI=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function ZB(n=ET()){const e=Fg(n,"auth");if(e.isInitialized())return e.getImmediate();const t=I9(n,{popupRedirectResolver:GB,persistence:[eB,q9,pR]}),i=kN("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const l=JB(o.toString());O9(t,l,()=>l(t.currentUser)),V9(t,d=>l(d))}}const s=RN("auth");return s&&N9(t,`http://${s}`),t}function QB(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}w9({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const o=Mr("internal-error");o.customData=s,t(o)},i.type="text/javascript",i.charset="UTF-8",QB().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});KB("Browser");var fI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var tl,wR;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,B){function O(){}O.prototype=B.prototype,k.F=B.prototype,k.prototype=new O,k.prototype.constructor=k,k.D=function(q,G,W){for(var z=Array(arguments.length-2),He=2;He<arguments.length;He++)z[He-2]=arguments[He];return B.prototype[G].apply(q,z)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,B,O){O||(O=0);const q=Array(16);if(typeof B=="string")for(var G=0;G<16;++G)q[G]=B.charCodeAt(O++)|B.charCodeAt(O++)<<8|B.charCodeAt(O++)<<16|B.charCodeAt(O++)<<24;else for(G=0;G<16;++G)q[G]=B[O++]|B[O++]<<8|B[O++]<<16|B[O++]<<24;B=k.g[0],O=k.g[1],G=k.g[2];let W=k.g[3],z;z=B+(W^O&(G^W))+q[0]+3614090360&4294967295,B=O+(z<<7&4294967295|z>>>25),z=W+(G^B&(O^G))+q[1]+3905402710&4294967295,W=B+(z<<12&4294967295|z>>>20),z=G+(O^W&(B^O))+q[2]+606105819&4294967295,G=W+(z<<17&4294967295|z>>>15),z=O+(B^G&(W^B))+q[3]+3250441966&4294967295,O=G+(z<<22&4294967295|z>>>10),z=B+(W^O&(G^W))+q[4]+4118548399&4294967295,B=O+(z<<7&4294967295|z>>>25),z=W+(G^B&(O^G))+q[5]+1200080426&4294967295,W=B+(z<<12&4294967295|z>>>20),z=G+(O^W&(B^O))+q[6]+2821735955&4294967295,G=W+(z<<17&4294967295|z>>>15),z=O+(B^G&(W^B))+q[7]+4249261313&4294967295,O=G+(z<<22&4294967295|z>>>10),z=B+(W^O&(G^W))+q[8]+1770035416&4294967295,B=O+(z<<7&4294967295|z>>>25),z=W+(G^B&(O^G))+q[9]+2336552879&4294967295,W=B+(z<<12&4294967295|z>>>20),z=G+(O^W&(B^O))+q[10]+4294925233&4294967295,G=W+(z<<17&4294967295|z>>>15),z=O+(B^G&(W^B))+q[11]+2304563134&4294967295,O=G+(z<<22&4294967295|z>>>10),z=B+(W^O&(G^W))+q[12]+1804603682&4294967295,B=O+(z<<7&4294967295|z>>>25),z=W+(G^B&(O^G))+q[13]+4254626195&4294967295,W=B+(z<<12&4294967295|z>>>20),z=G+(O^W&(B^O))+q[14]+2792965006&4294967295,G=W+(z<<17&4294967295|z>>>15),z=O+(B^G&(W^B))+q[15]+1236535329&4294967295,O=G+(z<<22&4294967295|z>>>10),z=B+(G^W&(O^G))+q[1]+4129170786&4294967295,B=O+(z<<5&4294967295|z>>>27),z=W+(O^G&(B^O))+q[6]+3225465664&4294967295,W=B+(z<<9&4294967295|z>>>23),z=G+(B^O&(W^B))+q[11]+643717713&4294967295,G=W+(z<<14&4294967295|z>>>18),z=O+(W^B&(G^W))+q[0]+3921069994&4294967295,O=G+(z<<20&4294967295|z>>>12),z=B+(G^W&(O^G))+q[5]+3593408605&4294967295,B=O+(z<<5&4294967295|z>>>27),z=W+(O^G&(B^O))+q[10]+38016083&4294967295,W=B+(z<<9&4294967295|z>>>23),z=G+(B^O&(W^B))+q[15]+3634488961&4294967295,G=W+(z<<14&4294967295|z>>>18),z=O+(W^B&(G^W))+q[4]+3889429448&4294967295,O=G+(z<<20&4294967295|z>>>12),z=B+(G^W&(O^G))+q[9]+568446438&4294967295,B=O+(z<<5&4294967295|z>>>27),z=W+(O^G&(B^O))+q[14]+3275163606&4294967295,W=B+(z<<9&4294967295|z>>>23),z=G+(B^O&(W^B))+q[3]+4107603335&4294967295,G=W+(z<<14&4294967295|z>>>18),z=O+(W^B&(G^W))+q[8]+1163531501&4294967295,O=G+(z<<20&4294967295|z>>>12),z=B+(G^W&(O^G))+q[13]+2850285829&4294967295,B=O+(z<<5&4294967295|z>>>27),z=W+(O^G&(B^O))+q[2]+4243563512&4294967295,W=B+(z<<9&4294967295|z>>>23),z=G+(B^O&(W^B))+q[7]+1735328473&4294967295,G=W+(z<<14&4294967295|z>>>18),z=O+(W^B&(G^W))+q[12]+2368359562&4294967295,O=G+(z<<20&4294967295|z>>>12),z=B+(O^G^W)+q[5]+4294588738&4294967295,B=O+(z<<4&4294967295|z>>>28),z=W+(B^O^G)+q[8]+2272392833&4294967295,W=B+(z<<11&4294967295|z>>>21),z=G+(W^B^O)+q[11]+1839030562&4294967295,G=W+(z<<16&4294967295|z>>>16),z=O+(G^W^B)+q[14]+4259657740&4294967295,O=G+(z<<23&4294967295|z>>>9),z=B+(O^G^W)+q[1]+2763975236&4294967295,B=O+(z<<4&4294967295|z>>>28),z=W+(B^O^G)+q[4]+1272893353&4294967295,W=B+(z<<11&4294967295|z>>>21),z=G+(W^B^O)+q[7]+4139469664&4294967295,G=W+(z<<16&4294967295|z>>>16),z=O+(G^W^B)+q[10]+3200236656&4294967295,O=G+(z<<23&4294967295|z>>>9),z=B+(O^G^W)+q[13]+681279174&4294967295,B=O+(z<<4&4294967295|z>>>28),z=W+(B^O^G)+q[0]+3936430074&4294967295,W=B+(z<<11&4294967295|z>>>21),z=G+(W^B^O)+q[3]+3572445317&4294967295,G=W+(z<<16&4294967295|z>>>16),z=O+(G^W^B)+q[6]+76029189&4294967295,O=G+(z<<23&4294967295|z>>>9),z=B+(O^G^W)+q[9]+3654602809&4294967295,B=O+(z<<4&4294967295|z>>>28),z=W+(B^O^G)+q[12]+3873151461&4294967295,W=B+(z<<11&4294967295|z>>>21),z=G+(W^B^O)+q[15]+530742520&4294967295,G=W+(z<<16&4294967295|z>>>16),z=O+(G^W^B)+q[2]+3299628645&4294967295,O=G+(z<<23&4294967295|z>>>9),z=B+(G^(O|~W))+q[0]+4096336452&4294967295,B=O+(z<<6&4294967295|z>>>26),z=W+(O^(B|~G))+q[7]+1126891415&4294967295,W=B+(z<<10&4294967295|z>>>22),z=G+(B^(W|~O))+q[14]+2878612391&4294967295,G=W+(z<<15&4294967295|z>>>17),z=O+(W^(G|~B))+q[5]+4237533241&4294967295,O=G+(z<<21&4294967295|z>>>11),z=B+(G^(O|~W))+q[12]+1700485571&4294967295,B=O+(z<<6&4294967295|z>>>26),z=W+(O^(B|~G))+q[3]+2399980690&4294967295,W=B+(z<<10&4294967295|z>>>22),z=G+(B^(W|~O))+q[10]+4293915773&4294967295,G=W+(z<<15&4294967295|z>>>17),z=O+(W^(G|~B))+q[1]+2240044497&4294967295,O=G+(z<<21&4294967295|z>>>11),z=B+(G^(O|~W))+q[8]+1873313359&4294967295,B=O+(z<<6&4294967295|z>>>26),z=W+(O^(B|~G))+q[15]+4264355552&4294967295,W=B+(z<<10&4294967295|z>>>22),z=G+(B^(W|~O))+q[6]+2734768916&4294967295,G=W+(z<<15&4294967295|z>>>17),z=O+(W^(G|~B))+q[13]+1309151649&4294967295,O=G+(z<<21&4294967295|z>>>11),z=B+(G^(O|~W))+q[4]+4149444226&4294967295,B=O+(z<<6&4294967295|z>>>26),z=W+(O^(B|~G))+q[11]+3174756917&4294967295,W=B+(z<<10&4294967295|z>>>22),z=G+(B^(W|~O))+q[2]+718787259&4294967295,G=W+(z<<15&4294967295|z>>>17),z=O+(W^(G|~B))+q[9]+3951481745&4294967295,k.g[0]=k.g[0]+B&4294967295,k.g[1]=k.g[1]+(G+(z<<21&4294967295|z>>>11))&4294967295,k.g[2]=k.g[2]+G&4294967295,k.g[3]=k.g[3]+W&4294967295}i.prototype.v=function(k,B){B===void 0&&(B=k.length);const O=B-this.blockSize,q=this.C;let G=this.h,W=0;for(;W<B;){if(G==0)for(;W<=O;)s(this,k,W),W+=this.blockSize;if(typeof k=="string"){for(;W<B;)if(q[G++]=k.charCodeAt(W++),G==this.blockSize){s(this,q),G=0;break}}else for(;W<B;)if(q[G++]=k[W++],G==this.blockSize){s(this,q),G=0;break}}this.h=G,this.o+=B},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var B=1;B<k.length-8;++B)k[B]=0;B=this.o*8;for(var O=k.length-8;O<k.length;++O)k[O]=B&255,B/=256;for(this.v(k),k=Array(16),B=0,O=0;O<4;++O)for(let q=0;q<32;q+=8)k[B++]=this.g[O]>>>q&255;return k};function o(k,B){var O=d;return Object.prototype.hasOwnProperty.call(O,k)?O[k]:O[k]=B(k)}function l(k,B){this.h=B;const O=[];let q=!0;for(let G=k.length-1;G>=0;G--){const W=k[G]|0;q&&W==B||(O[G]=W,q=!1)}this.g=O}var d={};function h(k){return-128<=k&&k<128?o(k,function(B){return new l([B|0],B<0?-1:0)}):new l([k|0],k<0?-1:0)}function p(k){if(isNaN(k)||!isFinite(k))return x;if(k<0)return H(p(-k));const B=[];let O=1;for(let q=0;k>=O;q++)B[q]=k/O|0,O*=4294967296;return new l(B,0)}function v(k,B){if(k.length==0)throw Error("number format error: empty string");if(B=B||10,B<2||36<B)throw Error("radix out of range: "+B);if(k.charAt(0)=="-")return H(v(k.substring(1),B));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const O=p(Math.pow(B,8));let q=x;for(let W=0;W<k.length;W+=8){var G=Math.min(8,k.length-W);const z=parseInt(k.substring(W,W+G),B);G<8?(G=p(Math.pow(B,G)),q=q.j(G).add(p(z))):(q=q.j(O),q=q.add(p(z)))}return q}var x=h(0),b=h(1),A=h(16777216);n=l.prototype,n.m=function(){if(F(this))return-H(this).m();let k=0,B=1;for(let O=0;O<this.g.length;O++){const q=this.i(O);k+=(q>=0?q:4294967296+q)*B,B*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(P(this))return"0";if(F(this))return"-"+H(this).toString(k);const B=p(Math.pow(k,6));var O=this;let q="";for(;;){const G=he(O,B).g;O=X(O,G.j(B));let W=((O.g.length>0?O.g[0]:O.h)>>>0).toString(k);if(O=G,P(O))return W+q;for(;W.length<6;)W="0"+W;q=W+q}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function P(k){if(k.h!=0)return!1;for(let B=0;B<k.g.length;B++)if(k.g[B]!=0)return!1;return!0}function F(k){return k.h==-1}n.l=function(k){return k=X(this,k),F(k)?-1:P(k)?0:1};function H(k){const B=k.g.length,O=[];for(let q=0;q<B;q++)O[q]=~k.g[q];return new l(O,~k.h).add(b)}n.abs=function(){return F(this)?H(this):this},n.add=function(k){const B=Math.max(this.g.length,k.g.length),O=[];let q=0;for(let G=0;G<=B;G++){let W=q+(this.i(G)&65535)+(k.i(G)&65535),z=(W>>>16)+(this.i(G)>>>16)+(k.i(G)>>>16);q=z>>>16,W&=65535,z&=65535,O[G]=z<<16|W}return new l(O,O[O.length-1]&-2147483648?-1:0)};function X(k,B){return k.add(H(B))}n.j=function(k){if(P(this)||P(k))return x;if(F(this))return F(k)?H(this).j(H(k)):H(H(this).j(k));if(F(k))return H(this.j(H(k)));if(this.l(A)<0&&k.l(A)<0)return p(this.m()*k.m());const B=this.g.length+k.g.length,O=[];for(var q=0;q<2*B;q++)O[q]=0;for(q=0;q<this.g.length;q++)for(let G=0;G<k.g.length;G++){const W=this.i(q)>>>16,z=this.i(q)&65535,He=k.i(G)>>>16,Qe=k.i(G)&65535;O[2*q+2*G]+=z*Qe,re(O,2*q+2*G),O[2*q+2*G+1]+=W*Qe,re(O,2*q+2*G+1),O[2*q+2*G+1]+=z*He,re(O,2*q+2*G+1),O[2*q+2*G+2]+=W*He,re(O,2*q+2*G+2)}for(k=0;k<B;k++)O[k]=O[2*k+1]<<16|O[2*k];for(k=B;k<2*B;k++)O[k]=0;return new l(O,0)};function re(k,B){for(;(k[B]&65535)!=k[B];)k[B+1]+=k[B]>>>16,k[B]&=65535,B++}function Q(k,B){this.g=k,this.h=B}function he(k,B){if(P(B))throw Error("division by zero");if(P(k))return new Q(x,x);if(F(k))return B=he(H(k),B),new Q(H(B.g),H(B.h));if(F(B))return B=he(k,H(B)),new Q(H(B.g),B.h);if(k.g.length>30){if(F(k)||F(B))throw Error("slowDivide_ only works with positive integers.");for(var O=b,q=B;q.l(k)<=0;)O=fe(O),q=fe(q);var G=Y(O,1),W=Y(q,1);for(q=Y(q,2),O=Y(O,2);!P(q);){var z=W.add(q);z.l(k)<=0&&(G=G.add(O),W=z),q=Y(q,1),O=Y(O,1)}return B=X(k,G.j(B)),new Q(G,B)}for(G=x;k.l(B)>=0;){for(O=Math.max(1,Math.floor(k.m()/B.m())),q=Math.ceil(Math.log(O)/Math.LN2),q=q<=48?1:Math.pow(2,q-48),W=p(O),z=W.j(B);F(z)||z.l(k)>0;)O-=q,W=p(O),z=W.j(B);P(W)&&(W=b),G=G.add(W),k=X(k,z)}return new Q(G,k)}n.B=function(k){return he(this,k).h},n.and=function(k){const B=Math.max(this.g.length,k.g.length),O=[];for(let q=0;q<B;q++)O[q]=this.i(q)&k.i(q);return new l(O,this.h&k.h)},n.or=function(k){const B=Math.max(this.g.length,k.g.length),O=[];for(let q=0;q<B;q++)O[q]=this.i(q)|k.i(q);return new l(O,this.h|k.h)},n.xor=function(k){const B=Math.max(this.g.length,k.g.length),O=[];for(let q=0;q<B;q++)O[q]=this.i(q)^k.i(q);return new l(O,this.h^k.h)};function fe(k){const B=k.g.length+1,O=[];for(let q=0;q<B;q++)O[q]=k.i(q)<<1|k.i(q-1)>>>31;return new l(O,k.h)}function Y(k,B){const O=B>>5;B%=32;const q=k.g.length-O,G=[];for(let W=0;W<q;W++)G[W]=B>0?k.i(W+O)>>>B|k.i(W+O+1)<<32-B:k.i(W+O);return new l(G,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,wR=i,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=v,tl=l}).apply(typeof fI<"u"?fI:typeof self<"u"?self:typeof window<"u"?window:{});var Xm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var SR,Vh,bR,pp,i0,CR,IR,AR;(function(){var n,e=Object.defineProperty;function t(T){T=[typeof globalThis=="object"&&globalThis,T,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xm=="object"&&Xm];for(var I=0;I<T.length;++I){var M=T[I];if(M&&M.Math==Math)return M}throw Error("Cannot find global object")}var i=t(this);function s(T,I){if(I)e:{var M=i;T=T.split(".");for(var U=0;U<T.length-1;U++){var ne=T[U];if(!(ne in M))break e;M=M[ne]}T=T[T.length-1],U=M[T],I=I(U),I!=U&&I!=null&&e(M,T,{configurable:!0,writable:!0,value:I})}}s("Symbol.dispose",function(T){return T||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(T){return T||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(T){return T||function(I){var M=[],U;for(U in I)Object.prototype.hasOwnProperty.call(I,U)&&M.push([U,I[U]]);return M}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function d(T){var I=typeof T;return I=="object"&&T!=null||I=="function"}function h(T,I,M){return T.call.apply(T.bind,arguments)}function p(T,I,M){return p=h,p.apply(null,arguments)}function v(T,I){var M=Array.prototype.slice.call(arguments,1);return function(){var U=M.slice();return U.push.apply(U,arguments),T.apply(this,U)}}function x(T,I){function M(){}M.prototype=I.prototype,T.Z=I.prototype,T.prototype=new M,T.prototype.constructor=T,T.Ob=function(U,ne,de){for(var Re=Array(arguments.length-2),st=2;st<arguments.length;st++)Re[st-2]=arguments[st];return I.prototype[ne].apply(U,Re)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?T=>T&&AsyncContext.Snapshot.wrap(T):T=>T;function A(T){const I=T.length;if(I>0){const M=Array(I);for(let U=0;U<I;U++)M[U]=T[U];return M}return[]}function P(T,I){for(let U=1;U<arguments.length;U++){const ne=arguments[U];var M=typeof ne;if(M=M!="object"?M:ne?Array.isArray(ne)?"array":M:"null",M=="array"||M=="object"&&typeof ne.length=="number"){M=T.length||0;const de=ne.length||0;T.length=M+de;for(let Re=0;Re<de;Re++)T[M+Re]=ne[Re]}else T.push(ne)}}class F{constructor(I,M){this.i=I,this.j=M,this.h=0,this.g=null}get(){let I;return this.h>0?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function H(T){l.setTimeout(()=>{throw T},0)}function X(){var T=k;let I=null;return T.g&&(I=T.g,T.g=T.g.next,T.g||(T.h=null),I.next=null),I}class re{constructor(){this.h=this.g=null}add(I,M){const U=Q.get();U.set(I,M),this.h?this.h.next=U:this.g=U,this.h=U}}var Q=new F(()=>new he,T=>T.reset());class he{constructor(){this.next=this.g=this.h=null}set(I,M){this.h=I,this.g=M,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,Y=!1,k=new re,B=()=>{const T=Promise.resolve(void 0);fe=()=>{T.then(O)}};function O(){for(var T;T=X();){try{T.h.call(T.g)}catch(M){H(M)}var I=Q;I.j(T),I.h<100&&(I.h++,T.next=I.g,I.g=T)}Y=!1}function q(){this.u=this.u,this.C=this.C}q.prototype.u=!1,q.prototype.dispose=function(){this.u||(this.u=!0,this.N())},q.prototype[Symbol.dispose]=function(){this.dispose()},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(T,I){this.type=T,this.g=this.target=I,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var W=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var T=!1,I=Object.defineProperty({},"passive",{get:function(){T=!0}});try{const M=()=>{};l.addEventListener("test",M,I),l.removeEventListener("test",M,I)}catch{}return T})();function z(T){return/^[\s\xa0]*$/.test(T)}function He(T,I){G.call(this,T?T.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,T&&this.init(T,I)}x(He,G),He.prototype.init=function(T,I){const M=this.type=T.type,U=T.changedTouches&&T.changedTouches.length?T.changedTouches[0]:null;this.target=T.target||T.srcElement,this.g=I,I=T.relatedTarget,I||(M=="mouseover"?I=T.fromElement:M=="mouseout"&&(I=T.toElement)),this.relatedTarget=I,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0),this.button=T.button,this.key=T.key||"",this.ctrlKey=T.ctrlKey,this.altKey=T.altKey,this.shiftKey=T.shiftKey,this.metaKey=T.metaKey,this.pointerId=T.pointerId||0,this.pointerType=T.pointerType,this.state=T.state,this.i=T,T.defaultPrevented&&He.Z.h.call(this)},He.prototype.h=function(){He.Z.h.call(this);const T=this.i;T.preventDefault?T.preventDefault():T.returnValue=!1};var Qe="closure_listenable_"+(Math.random()*1e6|0),se=0;function Se(T,I,M,U,ne){this.listener=T,this.proxy=null,this.src=I,this.type=M,this.capture=!!U,this.ha=ne,this.key=++se,this.da=this.fa=!1}function be(T){T.da=!0,T.listener=null,T.proxy=null,T.src=null,T.ha=null}function it(T,I,M){for(const U in T)I.call(M,T[U],U,T)}function Pe(T,I){for(const M in T)I.call(void 0,T[M],M,T)}function K(T){const I={};for(const M in T)I[M]=T[M];return I}const me="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ie(T,I){let M,U;for(let ne=1;ne<arguments.length;ne++){U=arguments[ne];for(M in U)T[M]=U[M];for(let de=0;de<me.length;de++)M=me[de],Object.prototype.hasOwnProperty.call(U,M)&&(T[M]=U[M])}}function le(T){this.src=T,this.g={},this.h=0}le.prototype.add=function(T,I,M,U,ne){const de=T.toString();T=this.g[de],T||(T=this.g[de]=[],this.h++);const Re=Ce(T,I,U,ne);return Re>-1?(I=T[Re],M||(I.fa=!1)):(I=new Se(I,this.src,de,!!U,ne),I.fa=M,T.push(I)),I};function _e(T,I){const M=I.type;if(M in T.g){var U=T.g[M],ne=Array.prototype.indexOf.call(U,I,void 0),de;(de=ne>=0)&&Array.prototype.splice.call(U,ne,1),de&&(be(I),T.g[M].length==0&&(delete T.g[M],T.h--))}}function Ce(T,I,M,U){for(let ne=0;ne<T.length;++ne){const de=T[ne];if(!de.da&&de.listener==I&&de.capture==!!M&&de.ha==U)return ne}return-1}var Fe="closure_lm_"+(Math.random()*1e6|0),Be={};function Ye(T,I,M,U,ne){if(Array.isArray(I)){for(let de=0;de<I.length;de++)Ye(T,I[de],M,U,ne);return null}return M=Mt(M),T&&T[Qe]?T.J(I,M,d(U)?!!U.capture:!1,ne):At(T,I,M,!1,U,ne)}function At(T,I,M,U,ne,de){if(!I)throw Error("Invalid event type");const Re=d(ne)?!!ne.capture:!!ne;let st=Nt(T);if(st||(T[Fe]=st=new le(T)),M=st.add(I,M,U,Re,de),M.proxy)return M;if(U=Jt(),M.proxy=U,U.src=T,U.listener=M,T.addEventListener)W||(ne=Re),ne===void 0&&(ne=!1),T.addEventListener(I.toString(),U,ne);else if(T.attachEvent)T.attachEvent(Rn(I.toString()),U);else if(T.addListener&&T.removeListener)T.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return M}function Jt(){function T(M){return I.call(T.src,T.listener,M)}const I=Yt;return T}function ct(T,I,M,U,ne){if(Array.isArray(I))for(var de=0;de<I.length;de++)ct(T,I[de],M,U,ne);else U=d(U)?!!U.capture:!!U,M=Mt(M),T&&T[Qe]?(T=T.i,de=String(I).toString(),de in T.g&&(I=T.g[de],M=Ce(I,M,U,ne),M>-1&&(be(I[M]),Array.prototype.splice.call(I,M,1),I.length==0&&(delete T.g[de],T.h--)))):T&&(T=Nt(T))&&(I=T.g[I.toString()],T=-1,I&&(T=Ce(I,M,U,ne)),(M=T>-1?I[T]:null)&&mn(M))}function mn(T){if(typeof T!="number"&&T&&!T.da){var I=T.src;if(I&&I[Qe])_e(I.i,T);else{var M=T.type,U=T.proxy;I.removeEventListener?I.removeEventListener(M,U,T.capture):I.detachEvent?I.detachEvent(Rn(M),U):I.addListener&&I.removeListener&&I.removeListener(U),(M=Nt(I))?(_e(M,T),M.h==0&&(M.src=null,I[Fe]=null)):be(T)}}}function Rn(T){return T in Be?Be[T]:Be[T]="on"+T}function Yt(T,I){if(T.da)T=!0;else{I=new He(I,this);const M=T.listener,U=T.ha||T.src;T.fa&&mn(T),T=M.call(U,I)}return T}function Nt(T){return T=T[Fe],T instanceof le?T:null}var Rt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Mt(T){return typeof T=="function"?T:(T[Rt]||(T[Rt]=function(I){return T.handleEvent(I)}),T[Rt])}function we(){q.call(this),this.i=new le(this),this.M=this,this.G=null}x(we,q),we.prototype[Qe]=!0,we.prototype.removeEventListener=function(T,I,M,U){ct(this,T,I,M,U)};function pe(T,I){var M,U=T.G;if(U)for(M=[];U;U=U.G)M.push(U);if(T=T.M,U=I.type||I,typeof I=="string")I=new G(I,T);else if(I instanceof G)I.target=I.target||T;else{var ne=I;I=new G(U,T),Ie(I,ne)}ne=!0;let de,Re;if(M)for(Re=M.length-1;Re>=0;Re--)de=I.g=M[Re],ne=De(de,U,!0,I)&&ne;if(de=I.g=T,ne=De(de,U,!0,I)&&ne,ne=De(de,U,!1,I)&&ne,M)for(Re=0;Re<M.length;Re++)de=I.g=M[Re],ne=De(de,U,!1,I)&&ne}we.prototype.N=function(){if(we.Z.N.call(this),this.i){var T=this.i;for(const I in T.g){const M=T.g[I];for(let U=0;U<M.length;U++)be(M[U]);delete T.g[I],T.h--}}this.G=null},we.prototype.J=function(T,I,M,U){return this.i.add(String(T),I,!1,M,U)},we.prototype.K=function(T,I,M,U){return this.i.add(String(T),I,!0,M,U)};function De(T,I,M,U){if(I=T.i.g[String(I)],!I)return!0;I=I.concat();let ne=!0;for(let de=0;de<I.length;++de){const Re=I[de];if(Re&&!Re.da&&Re.capture==M){const st=Re.listener,Vt=Re.ha||Re.src;Re.fa&&_e(T.i,Re),ne=st.call(Vt,U)!==!1&&ne}}return ne&&!U.defaultPrevented}function je(T,I){if(typeof T!="function")if(T&&typeof T.handleEvent=="function")T=p(T.handleEvent,T);else throw Error("Invalid listener argument");return Number(I)>2147483647?-1:l.setTimeout(T,I||0)}function nt(T){T.g=je(()=>{T.g=null,T.i&&(T.i=!1,nt(T))},T.l);const I=T.h;T.h=null,T.m.apply(null,I)}class lt extends q{constructor(I,M){super(),this.m=I,this.l=M,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:nt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function rn(T){q.call(this),this.h=T,this.g={}}x(rn,q);var jn=[];function vi(T){it(T.g,function(I,M){this.g.hasOwnProperty(M)&&mn(I)},T),T.g={}}rn.prototype.N=function(){rn.Z.N.call(this),vi(this)},rn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pn=l.JSON.stringify,Ts=l.JSON.parse,Lr=class{stringify(T){return l.JSON.stringify(T,void 0)}parse(T){return l.JSON.parse(T,void 0)}};function Vr(){}function co(){}var Ti={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ne(){G.call(this,"d")}x(Ne,G);function ht(){G.call(this,"c")}x(ht,G);var dt={},on=null;function Si(){return on=on||new we}dt.Ia="serverreachability";function Es(T){G.call(this,dt.Ia,T)}x(Es,G);function Fn(T){const I=Si();pe(I,new Es(I))}dt.STAT_EVENT="statevent";function Zi(T,I){G.call(this,dt.STAT_EVENT,T),this.stat=I}x(Zi,G);function gn(T){const I=Si();pe(I,new Zi(I,T))}dt.Ja="timingevent";function zi(T,I){G.call(this,dt.Ja,T),this.size=I}x(zi,G);function qi(T,I){if(typeof T!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){T()},I)}function ei(){this.g=!0}ei.prototype.ua=function(){this.g=!1};function Vd(T,I,M,U,ne,de){T.info(function(){if(T.g)if(de){var Re="",st=de.split("&");for(let Ot=0;Ot<st.length;Ot++){var Vt=st[Ot].split("=");if(Vt.length>1){const dn=Vt[0];Vt=Vt[1];const ss=dn.split("_");Re=ss.length>=2&&ss[1]=="type"?Re+(dn+"="+Vt+"&"):Re+(dn+"=redacted&")}}}else Re=null;else Re=de;return"XMLHTTP REQ ("+U+") [attempt "+ne+"]: "+I+`
`+M+`
`+Re})}function Gu(T,I,M,U,ne,de,Re){T.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+ne+"]: "+I+`
`+M+`
`+de+" "+Re})}function Hs(T,I,M,U){T.info(function(){return"XMLHTTP TEXT ("+I+"): "+Od(T,M)+(U?" "+U:"")})}function dr(T,I){T.info(function(){return"TIMEOUT: "+I})}ei.prototype.info=function(){};function Od(T,I){if(!T.g)return I;if(!I)return null;try{const de=JSON.parse(I);if(de){for(T=0;T<de.length;T++)if(Array.isArray(de[T])){var M=de[T];if(!(M.length<2)){var U=M[1];if(Array.isArray(U)&&!(U.length<1)){var ne=U[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(let Re=1;Re<U.length;Re++)U[Re]=""}}}}return pn(de)}catch{return I}}var ho={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},El={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},xl;function oi(){}x(oi,Vr),oi.prototype.g=function(){return new XMLHttpRequest},xl=new oi;function ze(T){return encodeURIComponent(String(T))}function wl(T){var I=1;T=T.split(":");const M=[];for(;I>0&&T.length;)M.push(T.shift()),I--;return T.length&&M.push(T.join(":")),M}function Qi(T,I,M,U){this.j=T,this.i=I,this.l=M,this.S=U||1,this.V=new rn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new $i}function $i(){this.i=null,this.g="",this.h=!1}var Cn={},Mn={};function xs(T,I,M){T.M=1,T.A=Zt(yn(I)),T.u=M,T.R=!0,ws(T,null)}function ws(T,I){T.F=Date.now(),js(T),T.B=yn(T.A);var M=T.B,U=T.S;Array.isArray(U)||(U=[String(U)]),Ur(M.i,"t",U),T.C=0,M=T.j.L,T.h=new $i,T.g=Rl(T.j,M?I:null,!T.u),T.P>0&&(T.O=new lt(p(T.Y,T,T.g),T.P)),I=T.V,M=T.g,U=T.ba;var ne="readystatechange";Array.isArray(ne)||(ne&&(jn[0]=ne.toString()),ne=jn);for(let de=0;de<ne.length;de++){const Re=Ye(M,ne[de],U||I.handleEvent,!1,I.h||I);if(!Re)break;I.g[Re.key]=Re}I=T.J?K(T.J):{},T.u?(T.v||(T.v="POST"),I["Content-Type"]="application/x-www-form-urlencoded",T.g.ea(T.B,T.v,T.u,I)):(T.v="GET",T.g.ea(T.B,T.v,null,I)),Fn(),Vd(T.i,T.v,T.B,T.l,T.S,T.u)}Qi.prototype.ba=function(T){T=T.target;const I=this.O;I&&Is(T)==3?I.j():this.Y(T)},Qi.prototype.Y=function(T){try{if(T==this.g)e:{const st=Is(this.g),Vt=this.g.ya(),Ot=this.g.ca();if(!(st<3)&&(st!=3||this.g&&(this.h.h||this.g.la()||Wn(this.g)))){this.K||st!=4||Vt==7||(Vt==8||Ot<=0?Fn(3):Fn(2)),Ss(this);var I=this.g.ca();this.X=I;var M=Hu(this);if(this.o=I==200,Gu(this.i,this.v,this.B,this.l,this.S,st,I),this.o){if(this.U&&!this.L){t:{if(this.g){var U,ne=this.g;if((U=ne.g?ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(U)){var de=U;break t}}de=null}if(T=de)Hs(this.i,this.l,T,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ks(this,T);else{this.o=!1,this.m=3,gn(12),ai(this),Xi(this);break e}}if(this.R){T=!0;let dn;for(;!this.K&&this.C<M.length;)if(dn=Ku(this,M),dn==Mn){st==4&&(this.m=4,gn(14),T=!1),Hs(this.i,this.l,null,"[Incomplete Response]");break}else if(dn==Cn){this.m=4,gn(15),Hs(this.i,this.l,M,"[Invalid Chunk]"),T=!1;break}else Hs(this.i,this.l,dn,null),Ks(this,dn);if(ju(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),st!=4||M.length!=0||this.h.h||(this.m=1,gn(16),T=!1),this.o=this.o&&T,!T)Hs(this.i,this.l,M,"[Invalid Chunked Response]"),ai(this),Xi(this);else if(M.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+M.length),Al(Re),Re.P=!0,gn(11))}}else Hs(this.i,this.l,M,null),Ks(this,M);st==4&&ai(this),this.o&&!this.K&&(st==4?ji(this.j,this):(this.o=!1,js(this)))}else As(this.g),I==400&&M.indexOf("Unknown SID")>0?(this.m=3,gn(12)):(this.m=0,gn(13)),ai(this),Xi(this)}}}catch{}finally{}};function Hu(T){if(!ju(T))return T.g.la();const I=Wn(T.g);if(I==="")return"";let M="";const U=I.length,ne=Is(T.g)==4;if(!T.h.i){if(typeof TextDecoder>"u")return ai(T),Xi(T),"";T.h.i=new l.TextDecoder}for(let de=0;de<U;de++)T.h.h=!0,M+=T.h.i.decode(I[de],{stream:!(ne&&de==U-1)});return I.length=0,T.h.g+=M,T.C=0,T.h.g}function ju(T){return T.g?T.v=="GET"&&T.M!=2&&T.j.Aa:!1}function Ku(T,I){var M=T.C,U=I.indexOf(`
`,M);return U==-1?Mn:(M=Number(I.substring(M,U)),isNaN(M)?Cn:(U+=1,U+M>I.length?Mn:(I=I.slice(U,U+M),T.C=U+M,I)))}Qi.prototype.cancel=function(){this.K=!0,ai(this)};function js(T){T.T=Date.now()+T.H,ra(T,T.H)}function ra(T,I){if(T.D!=null)throw Error("WatchDog timer not null");T.D=qi(p(T.aa,T),I)}function Ss(T){T.D&&(l.clearTimeout(T.D),T.D=null)}Qi.prototype.aa=function(){this.D=null;const T=Date.now();T-this.T>=0?(dr(this.i,this.B),this.M!=2&&(Fn(),gn(17)),ai(this),this.m=2,Xi(this)):ra(this,this.T-T)};function Xi(T){T.j.I==0||T.K||ji(T.j,T)}function ai(T){Ss(T);var I=T.O;I&&typeof I.dispose=="function"&&I.dispose(),T.O=null,vi(T.V),T.g&&(I=T.g,T.g=null,I.abort(),I.dispose())}function Ks(T,I){try{var M=T.j;if(M.I!=0&&(M.g==T||es(M.h,T))){if(!T.L&&es(M.h,T)&&M.I==3){try{var U=M.Ba.g.parse(I)}catch{U=null}if(Array.isArray(U)&&U.length==3){var ne=U;if(ne[0]==0){e:if(!M.v){if(M.g)if(M.g.F+3e3<T.F)ha(M),qr(M);else break e;yo(M),gn(18)}}else M.xa=ne[1],0<M.xa-M.K&&ne[2]<37500&&M.F&&M.A==0&&!M.C&&(M.C=qi(p(M.Va,M),6e3));Ws(M.h)<=1&&M.ta&&(M.ta=void 0)}else Ns(M,11)}else if((T.L||M.g==T)&&ha(M),!z(I))for(ne=M.Ba.g.parse(I),I=0;I<ne.length;I++){let Ot=ne[I];const dn=Ot[0];if(!(dn<=M.K))if(M.K=dn,Ot=Ot[1],M.I==2)if(Ot[0]=="c"){M.M=Ot[1],M.ba=Ot[2];const ss=Ot[3];ss!=null&&(M.ka=ss,M.j.info("VER="+M.ka));const rs=Ot[4];rs!=null&&(M.za=rs,M.j.info("SVER="+M.za));const Ki=Ot[5];Ki!=null&&typeof Ki=="number"&&Ki>0&&(U=1.5*Ki,M.O=U,M.j.info("backChannelRequestTimeoutMs_="+U)),U=M;const Ms=T.g;if(Ms){const vo=Ms.g?Ms.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vo){var de=U.h;de.g||vo.indexOf("spdy")==-1&&vo.indexOf("quic")==-1&&vo.indexOf("h2")==-1||(de.j=de.l,de.g=new Set,de.h&&(hr(de,de.h),de.h=null))}if(U.G){const To=Ms.g?Ms.g.getResponseHeader("X-HTTP-Session-Id"):null;To&&(U.wa=To,Ue(U.J,U.G,To))}}M.I=3,M.l&&M.l.ra(),M.aa&&(M.T=Date.now()-T.F,M.j.info("Handshake RTT: "+M.T+"ms")),U=M;var Re=T;if(U.na=Nl(U,U.L?U.ba:null,U.W),Re.L){oa(U.h,Re);var st=Re,Vt=U.O;Vt&&(st.H=Vt),st.D&&(Ss(st),js(st)),U.g=Re}else Il(U);M.i.length>0&&Ai(M)}else Ot[0]!="stop"&&Ot[0]!="close"||Ns(M,7);else M.I==3&&(Ot[0]=="stop"||Ot[0]=="close"?Ot[0]=="stop"?Ns(M,7):_t(M):Ot[0]!="noop"&&M.l&&M.l.qa(Ot),M.A=0)}}Fn(4)}catch{}}var Pn=class{constructor(T,I){this.g=T,this.map=I}};function Sl(T){this.l=T||10,l.PerformanceNavigationTiming?(T=l.performance.getEntriesByType("navigation"),T=T.length>0&&(T[0].nextHopProtocol=="hq"||T[0].nextHopProtocol=="h2")):T=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=T?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function bl(T){return T.h?!0:T.g?T.g.size>=T.j:!1}function Ws(T){return T.h?1:T.g?T.g.size:0}function es(T,I){return T.h?T.h==I:T.g?T.g.has(I):!1}function hr(T,I){T.g?T.g.add(I):T.h=I}function oa(T,I){T.h&&T.h==I?T.h=null:T.g&&T.g.has(I)&&T.g.delete(I)}Sl.prototype.cancel=function(){if(this.i=aa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const T of this.g.values())T.cancel();this.g.clear()}};function aa(T){if(T.h!=null)return T.i.concat(T.h.G);if(T.g!=null&&T.g.size!==0){let I=T.i;for(const M of T.g.values())I=I.concat(M.G);return I}return A(T.i)}var Or=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yt(T,I){if(T){T=T.split("&");for(let M=0;M<T.length;M++){const U=T[M].indexOf("=");let ne,de=null;U>=0?(ne=T[M].substring(0,U),de=T[M].substring(U+1)):ne=T[M],I(ne,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function Et(T){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let I;T instanceof Et?(this.l=T.l,vn(this,T.j),this.o=T.o,this.g=T.g,Gi(this,T.u),this.h=T.h,fo(this,go(T.i)),this.m=T.m):T&&(I=String(T).match(Or))?(this.l=!1,vn(this,I[1]||"",!0),this.o=ts(I[2]||""),this.g=ts(I[3]||"",!0),Gi(this,I[4]),this.h=ts(I[5]||"",!0),fo(this,I[6]||"",!0),this.m=ts(I[7]||"")):(this.l=!1,this.i=new ns(null,this.l))}Et.prototype.toString=function(){const T=[];var I=this.j;I&&T.push(Ys(I,la,!0),":");var M=this.g;return(M||I=="file")&&(T.push("//"),(I=this.o)&&T.push(Ys(I,la,!0),"@"),T.push(ze(M).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),M=this.u,M!=null&&T.push(":",String(M))),(M=this.h)&&(this.g&&M.charAt(0)!="/"&&T.push("/"),T.push(Ys(M,M.charAt(0)=="/"?bs:mo,!0))),(M=this.i.toString())&&T.push("?",M),(M=this.m)&&T.push("#",Ys(M,Js)),T.join("")},Et.prototype.resolve=function(T){const I=yn(this);let M=!!T.j;M?vn(I,T.j):M=!!T.o,M?I.o=T.o:M=!!T.g,M?I.g=T.g:M=T.u!=null;var U=T.h;if(M)Gi(I,T.u);else if(M=!!T.h){if(U.charAt(0)!="/")if(this.g&&!this.h)U="/"+U;else{var ne=I.h.lastIndexOf("/");ne!=-1&&(U=I.h.slice(0,ne+1)+U)}if(ne=U,ne==".."||ne==".")U="";else if(ne.indexOf("./")!=-1||ne.indexOf("/.")!=-1){U=ne.lastIndexOf("/",0)==0,ne=ne.split("/");const de=[];for(let Re=0;Re<ne.length;){const st=ne[Re++];st=="."?U&&Re==ne.length&&de.push(""):st==".."?((de.length>1||de.length==1&&de[0]!="")&&de.pop(),U&&Re==ne.length&&de.push("")):(de.push(st),U=!0)}U=de.join("/")}else U=ne}return M?I.h=U:M=T.i.toString()!=="",M?fo(I,go(T.i)):M=!!T.m,M&&(I.m=T.m),I};function yn(T){return new Et(T)}function vn(T,I,M){T.j=M?ts(I,!0):I,T.j&&(T.j=T.j.replace(/:$/,""))}function Gi(T,I){if(I){if(I=Number(I),isNaN(I)||I<0)throw Error("Bad port number "+I);T.u=I}else T.u=null}function fo(T,I,M){I instanceof ns?(T.i=I,Fr(T.i,T.l)):(M||(I=Ys(I,Qt)),T.i=new ns(I,T.l))}function Ue(T,I,M){T.i.set(I,M)}function Zt(T){return Ue(T,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),T}function ts(T,I){return T?I?decodeURI(T.replace(/%25/g,"%2525")):decodeURIComponent(T):""}function Ys(T,I,M){return typeof T=="string"?(T=encodeURI(T).replace(I,cn),M&&(T=T.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),T):null}function cn(T){return T=T.charCodeAt(0),"%"+(T>>4&15).toString(16)+(T&15).toString(16)}var la=/[#\/\?@]/g,mo=/[#\?:]/g,bs=/[#\?]/g,Qt=/[#\?@]/g,Js=/#/g;function ns(T,I){this.h=this.g=null,this.i=T||null,this.j=!!I}function Kn(T){T.g||(T.g=new Map,T.h=0,T.i&&yt(T.i,function(I,M){T.add(decodeURIComponent(I.replace(/\+/g," ")),M)}))}n=ns.prototype,n.add=function(T,I){Kn(this),this.i=null,T=Zs(this,T);let M=this.g.get(T);return M||this.g.set(T,M=[]),M.push(I),this.h+=1,this};function ua(T,I){Kn(T),I=Zs(T,I),T.g.has(I)&&(T.i=null,T.h-=T.g.get(I).length,T.g.delete(I))}function fr(T,I){return Kn(T),I=Zs(T,I),T.g.has(I)}n.forEach=function(T,I){Kn(this),this.g.forEach(function(M,U){M.forEach(function(ne){T.call(I,ne,U,this)},this)},this)};function po(T,I){Kn(T);let M=[];if(typeof I=="string")fr(T,I)&&(M=M.concat(T.g.get(Zs(T,I))));else for(T=Array.from(T.g.values()),I=0;I<T.length;I++)M=M.concat(T[I]);return M}n.set=function(T,I){return Kn(this),this.i=null,T=Zs(this,T),fr(this,T)&&(this.h-=this.g.get(T).length),this.g.set(T,[I]),this.h+=1,this},n.get=function(T,I){return T?(T=po(this,T),T.length>0?String(T[0]):I):I};function Ur(T,I,M){ua(T,I),M.length>0&&(T.i=null,T.g.set(Zs(T,I),A(M)),T.h+=M.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const T=[],I=Array.from(this.g.keys());for(let U=0;U<I.length;U++){var M=I[U];const ne=ze(M);M=po(this,M);for(let de=0;de<M.length;de++){let Re=ne;M[de]!==""&&(Re+="="+ze(M[de])),T.push(Re)}}return this.i=T.join("&")};function go(T){const I=new ns;return I.i=T.i,T.g&&(I.g=new Map(T.g),I.h=T.h),I}function Zs(T,I){return I=String(I),T.j&&(I=I.toLowerCase()),I}function Fr(T,I){I&&!T.j&&(Kn(T),T.i=null,T.g.forEach(function(M,U){const ne=U.toLowerCase();U!=ne&&(ua(this,U),Ur(this,ne,M))},T)),T.j=I}function bi(T,I){const M=new ei;if(l.Image){const U=new Image;U.onload=v(Ci,M,"TestLoadImage: loaded",!0,I,U),U.onerror=v(Ci,M,"TestLoadImage: error",!1,I,U),U.onabort=v(Ci,M,"TestLoadImage: abort",!1,I,U),U.ontimeout=v(Ci,M,"TestLoadImage: timeout",!1,I,U),l.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=T}else I(!1)}function ca(T,I){const M=new ei,U=new AbortController,ne=setTimeout(()=>{U.abort(),Ci(M,"TestPingServer: timeout",!1,I)},1e4);fetch(T,{signal:U.signal}).then(de=>{clearTimeout(ne),de.ok?Ci(M,"TestPingServer: ok",!0,I):Ci(M,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(ne),Ci(M,"TestPingServer: error",!1,I)})}function Ci(T,I,M,U,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),U(M)}catch{}}function Br(){this.g=new Lr}function et(T){this.i=T.Sb||null,this.h=T.ab||!1}x(et,Vr),et.prototype.g=function(){return new li(this.i,this.h)};function li(T,I){we.call(this),this.H=T,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(li,we),n=li.prototype,n.open=function(T,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=T,this.D=I,this.readyState=1,Hi(this)},n.send=function(T){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const I={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};T&&(I.body=T),(this.H||l).fetch(new Request(this.D,I)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,mr(this)),this.readyState=0},n.Pa=function(T){if(this.g&&(this.l=T,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=T.headers,this.readyState=2,Hi(this)),this.g&&(this.readyState=3,Hi(this),this.g)))if(this.responseType==="arraybuffer")T.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in T){if(this.j=T.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ft(this)}else T.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ft(T){T.j.read().then(T.Ma.bind(T)).catch(T.ga.bind(T))}n.Ma=function(T){if(this.g){if(this.o&&T.value)this.response.push(T.value);else if(!this.o){var I=T.value?T.value:new Uint8Array(0);(I=this.B.decode(I,{stream:!T.done}))&&(this.response=this.responseText+=I)}T.done?mr(this):Hi(this),this.readyState==3&&Ft(this)}},n.Oa=function(T){this.g&&(this.response=this.responseText=T,mr(this))},n.Na=function(T){this.g&&(this.response=T,mr(this))},n.ga=function(){this.g&&mr(this)};function mr(T){T.readyState=4,T.l=null,T.j=null,T.B=null,Hi(T)}n.setRequestHeader=function(T,I){this.A.append(T,I)},n.getResponseHeader=function(T){return this.h&&this.h.get(T.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const T=[],I=this.h.entries();for(var M=I.next();!M.done;)M=M.value,T.push(M[0]+": "+M[1]),M=I.next();return T.join(`\r
`)};function Hi(T){T.onreadystatechange&&T.onreadystatechange.call(T)}Object.defineProperty(li.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(T){this.m=T?"include":"same-origin"}});function Ii(T){let I="";return it(T,function(M,U){I+=U,I+=":",I+=M,I+=`\r
`}),I}function pr(T,I,M){e:{for(U in M){var U=!1;break e}U=!0}U||(M=Ii(M),typeof T=="string"?M!=null&&ze(M):Ue(T,I,M))}function Pt(T){we.call(this),this.headers=new Map,this.L=T||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(Pt,we);var is=/^https?$/i,gr=["POST","PUT"];n=Pt.prototype,n.Fa=function(T){this.H=T},n.ea=function(T,I,M,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+T);I=I?I.toUpperCase():"GET",this.D=T,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():xl.g(),this.g.onreadystatechange=b(p(this.Ca,this));try{this.B=!0,this.g.open(I,String(T),!0),this.B=!1}catch(de){Tn(this,de);return}if(T=M||"",M=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var ne in U)M.set(ne,U[ne]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const de of U.keys())M.set(de,U.get(de));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(M.keys()).find(de=>de.toLowerCase()=="content-type"),ne=l.FormData&&T instanceof l.FormData,!(Array.prototype.indexOf.call(gr,I,void 0)>=0)||U||ne||M.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[de,Re]of M)this.g.setRequestHeader(de,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(T),this.v=!1}catch(de){Tn(this,de)}};function Tn(T,I){T.h=!1,T.g&&(T.j=!0,T.g.abort(),T.j=!1),T.l=I,T.o=5,Cs(T),Qs(T)}function Cs(T){T.A||(T.A=!0,pe(T,"complete"),pe(T,"error"))}n.abort=function(T){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=T||7,pe(this,"complete"),pe(this,"abort"),Qs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Qs(this,!0)),Pt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?zr(this):this.Xa())},n.Xa=function(){zr(this)};function zr(T){if(T.h&&typeof o<"u"){if(T.v&&Is(T)==4)setTimeout(T.Ca.bind(T),0);else if(pe(T,"readystatechange"),Is(T)==4){T.h=!1;try{const de=T.ca();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var M;if(!(M=I)){var U;if(U=de===0){let Re=String(T.D).match(Or)[1]||null;!Re&&l.self&&l.self.location&&(Re=l.self.location.protocol.slice(0,-1)),U=!is.test(Re?Re.toLowerCase():"")}M=U}if(M)pe(T,"complete"),pe(T,"success");else{T.o=6;try{var ne=Is(T)>2?T.g.statusText:""}catch{ne=""}T.l=ne+" ["+T.ca()+"]",Cs(T)}}finally{Qs(T)}}}}function Qs(T,I){if(T.g){T.m&&(clearTimeout(T.m),T.m=null);const M=T.g;T.g=null,I||pe(T,"ready");try{M.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Is(T){return T.g?T.g.readyState:0}n.ca=function(){try{return Is(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(T){if(this.g){var I=this.g.responseText;return T&&I.indexOf(T)==0&&(I=I.substring(T.length)),Ts(I)}};function Wn(T){try{if(!T.g)return null;if("response"in T.g)return T.g.response;switch(T.F){case"":case"text":return T.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in T.g)return T.g.mozResponseArrayBuffer}return null}catch{return null}}function As(T){const I={};T=(T.g&&Is(T)>=2&&T.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<T.length;U++){if(z(T[U]))continue;var M=wl(T[U]);const ne=M[0];if(M=M[1],typeof M!="string")continue;M=M.trim();const de=I[ne]||[];I[ne]=de,de.push(M)}Pe(I,function(U){return U.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function $s(T,I,M){return M&&M.internalChannelParams&&M.internalChannelParams[T]||I}function _r(T){this.za=0,this.i=[],this.j=new ei,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=$s("failFast",!1,T),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=$s("baseRetryDelayMs",5e3,T),this.Za=$s("retryDelaySeedMs",1e4,T),this.Ta=$s("forwardChannelMaxRetries",2,T),this.va=$s("forwardChannelRequestTimeoutMs",2e4,T),this.ma=T&&T.xmlHttpFactory||void 0,this.Ua=T&&T.Rb||void 0,this.Aa=T&&T.useFetchStreams||!1,this.O=void 0,this.L=T&&T.supportsCrossDomainXhr||!1,this.M="",this.h=new Sl(T&&T.concurrentRequestLimit),this.Ba=new Br,this.S=T&&T.fastHandshake||!1,this.R=T&&T.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=T&&T.Pb||!1,T&&T.ua&&this.j.ua(),T&&T.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&T&&T.detectBufferingProxy||!1,this.ia=void 0,T&&T.longPollingTimeout&&T.longPollingTimeout>0&&(this.ia=T.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=_r.prototype,n.ka=8,n.I=1,n.connect=function(T,I,M,U){gn(0),this.W=T,this.H=I||{},M&&U!==void 0&&(this.H.OSID=M,this.H.OAID=U),this.F=this.X,this.J=Nl(this,null,this.W),Ai(this)};function _t(T){if(ui(T),T.I==3){var I=T.V++,M=yn(T.J);if(Ue(M,"SID",T.M),Ue(M,"RID",I),Ue(M,"TYPE","terminate"),yr(T,M),I=new Qi(T,T.j,I),I.M=2,I.A=Zt(yn(M)),M=!1,l.navigator&&l.navigator.sendBeacon)try{M=l.navigator.sendBeacon(I.A.toString(),"")}catch{}!M&&l.Image&&(new Image().src=I.A,M=!0),M||(I.g=Rl(I.j,null),I.g.ea(I.A)),I.F=Date.now(),js(I)}Rs(T)}function qr(T){T.g&&(Al(T),T.g.cancel(),T.g=null)}function ui(T){qr(T),T.v&&(l.clearTimeout(T.v),T.v=null),ha(T),T.h.cancel(),T.m&&(typeof T.m=="number"&&l.clearTimeout(T.m),T.m=null)}function Ai(T){if(!bl(T.h)&&!T.m){T.m=!0;var I=T.Ea;fe||B(),Y||(fe(),Y=!0),k.add(I,T),T.D=0}}function _o(T,I){return Ws(T.h)>=T.h.j-(T.m?1:0)?!1:T.m?(T.i=I.G.concat(T.i),!0):T.I==1||T.I==2||T.D>=(T.Sa?0:T.Ta)?!1:(T.m=qi(p(T.Ea,T,I),Yu(T,T.D)),T.D++,!0)}n.Ea=function(T){if(this.m)if(this.m=null,this.I==1){if(!T){this.V=Math.floor(Math.random()*1e5),T=this.V++;const ne=new Qi(this,this.j,T);let de=this.o;if(this.U&&(de?(de=K(de),Ie(de,this.U)):de=this.U),this.u!==null||this.R||(ne.J=de,de=null),this.S)e:{for(var I=0,M=0;M<this.i.length;M++){t:{var U=this.i[M];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(I+=U,I>4096){I=M;break e}if(I===4096||M===this.i.length-1){I=M+1;break e}}I=1e3}else I=1e3;I=Wu(this,ne,I),M=yn(this.J),Ue(M,"RID",T),Ue(M,"CVER",22),this.G&&Ue(M,"X-HTTP-Session-Id",this.G),yr(this,M),de&&(this.R?I="headers="+ze(Ii(de))+"&"+I:this.u&&pr(M,this.u,de)),hr(this.h,ne),this.Ra&&Ue(M,"TYPE","init"),this.S?(Ue(M,"$req",I),Ue(M,"SID","null"),ne.U=!0,xs(ne,M,null)):xs(ne,M,I),this.I=2}}else this.I==3&&(T?Cl(this,T):this.i.length==0||bl(this.h)||Cl(this))};function Cl(T,I){var M;I?M=I.l:M=T.V++;const U=yn(T.J);Ue(U,"SID",T.M),Ue(U,"RID",M),Ue(U,"AID",T.K),yr(T,U),T.u&&T.o&&pr(U,T.u,T.o),M=new Qi(T,T.j,M,T.D+1),T.u===null&&(M.J=T.o),I&&(T.i=I.G.concat(T.i)),I=Wu(T,M,1e3),M.H=Math.round(T.va*.5)+Math.round(T.va*.5*Math.random()),hr(T.h,M),xs(M,U,I)}function yr(T,I){T.H&&it(T.H,function(M,U){Ue(I,U,M)}),T.l&&it({},function(M,U){Ue(I,U,M)})}function Wu(T,I,M){M=Math.min(T.i.length,M);const U=T.l?p(T.l.Ka,T.l,T):null;e:{var ne=T.i;let st=-1;for(;;){const Vt=["count="+M];st==-1?M>0?(st=ne[0].g,Vt.push("ofs="+st)):st=0:Vt.push("ofs="+st);let Ot=!0;for(let dn=0;dn<M;dn++){var de=ne[dn].g;const ss=ne[dn].map;if(de-=st,de<0)st=Math.max(0,ne[dn].g-100),Ot=!1;else try{de="req"+de+"_"||"";try{var Re=ss instanceof Map?ss:Object.entries(ss);for(const[rs,Ki]of Re){let Ms=Ki;d(Ki)&&(Ms=pn(Ki)),Vt.push(de+rs+"="+encodeURIComponent(Ms))}}catch(rs){throw Vt.push(de+"type="+encodeURIComponent("_badmap")),rs}}catch{U&&U(ss)}}if(Ot){Re=Vt.join("&");break e}}Re=void 0}return T=T.i.splice(0,M),I.G=T,Re}function Il(T){if(!T.g&&!T.v){T.Y=1;var I=T.Da;fe||B(),Y||(fe(),Y=!0),k.add(I,T),T.A=0}}function yo(T){return T.g||T.v||T.A>=3?!1:(T.Y++,T.v=qi(p(T.Da,T),Yu(T,T.A)),T.A++,!0)}n.Da=function(){if(this.v=null,da(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var T=4*this.T;this.j.info("BP detection timer enabled: "+T),this.B=qi(p(this.Wa,this),T)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,gn(10),qr(this),da(this))};function Al(T){T.B!=null&&(l.clearTimeout(T.B),T.B=null)}function da(T){T.g=new Qi(T,T.j,"rpc",T.Y),T.u===null&&(T.g.J=T.o),T.g.P=0;var I=yn(T.na);Ue(I,"RID","rpc"),Ue(I,"SID",T.M),Ue(I,"AID",T.K),Ue(I,"CI",T.F?"0":"1"),!T.F&&T.ia&&Ue(I,"TO",T.ia),Ue(I,"TYPE","xmlhttp"),yr(T,I),T.u&&T.o&&pr(I,T.u,T.o),T.O&&(T.g.H=T.O);var M=T.g;T=T.ba,M.M=1,M.A=Zt(yn(I)),M.u=null,M.R=!0,ws(M,T)}n.Va=function(){this.C!=null&&(this.C=null,qr(this),yo(this),gn(19))};function ha(T){T.C!=null&&(l.clearTimeout(T.C),T.C=null)}function ji(T,I){var M=null;if(T.g==I){ha(T),Al(T),T.g=null;var U=2}else if(es(T.h,I))M=I.G,oa(T.h,I),U=1;else return;if(T.I!=0){if(I.o)if(U==1){M=I.u?I.u.length:0,I=Date.now()-I.F;var ne=T.D;U=Si(),pe(U,new zi(U,M)),Ai(T)}else Il(T);else if(ne=I.m,ne==3||ne==0&&I.X>0||!(U==1&&_o(T,I)||U==2&&yo(T)))switch(M&&M.length>0&&(I=T.h,I.i=I.i.concat(M)),ne){case 1:Ns(T,5);break;case 4:Ns(T,10);break;case 3:Ns(T,6);break;default:Ns(T,2)}}}function Yu(T,I){let M=T.Qa+Math.floor(Math.random()*T.Za);return T.isActive()||(M*=2),M*I}function Ns(T,I){if(T.j.info("Error code "+I),I==2){var M=p(T.bb,T),U=T.Ua;const ne=!U;U=new Et(U||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||vn(U,"https"),Zt(U),ne?bi(U.toString(),M):ca(U.toString(),M)}else gn(2);T.I=0,T.l&&T.l.pa(I),Rs(T),ui(T)}n.bb=function(T){T?(this.j.info("Successfully pinged google.com"),gn(2)):(this.j.info("Failed to ping google.com"),gn(1))};function Rs(T){if(T.I=0,T.ja=[],T.l){const I=aa(T.h);(I.length!=0||T.i.length!=0)&&(P(T.ja,I),P(T.ja,T.i),T.h.i.length=0,A(T.i),T.i.length=0),T.l.oa()}}function Nl(T,I,M){var U=M instanceof Et?yn(M):new Et(M);if(U.g!="")I&&(U.g=I+"."+U.g),Gi(U,U.u);else{var ne=l.location;U=ne.protocol,I=I?I+"."+ne.hostname:ne.hostname,ne=+ne.port;const de=new Et(null);U&&vn(de,U),I&&(de.g=I),ne&&Gi(de,ne),M&&(de.h=M),U=de}return M=T.G,I=T.wa,M&&I&&Ue(U,M,I),Ue(U,"VER",T.ka),yr(T,U),U}function Rl(T,I,M){if(I&&!T.L)throw Error("Can't create secondary domain capable XhrIo object.");return I=T.Aa&&!T.ma?new Pt(new et({ab:M})):new Pt(T.ma),I.Fa(T.L),I}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function fa(){}n=fa.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Gr(){}Gr.prototype.g=function(T,I){return new ci(T,I)};function ci(T,I){we.call(this),this.g=new _r(I),this.l=T,this.h=I&&I.messageUrlParams||null,T=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(T?T["X-Client-Protocol"]="webchannel":T={"X-Client-Protocol":"webchannel"}),this.g.o=T,T=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(T?T["X-WebChannel-Content-Type"]=I.messageContentType:T={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.sa&&(T?T["X-WebChannel-Client-Profile"]=I.sa:T={"X-WebChannel-Client-Profile":I.sa}),this.g.U=T,(T=I&&I.Qb)&&!z(T)&&(this.g.u=T),this.A=I&&I.supportsCrossDomainXhr||!1,this.v=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!z(I)&&(this.g.G=I,T=this.h,T!==null&&I in T&&(T=this.h,I in T&&delete T[I])),this.j=new vr(this)}x(ci,we),ci.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},ci.prototype.close=function(){_t(this.g)},ci.prototype.o=function(T){var I=this.g;if(typeof T=="string"){var M={};M.__data__=T,T=M}else this.v&&(M={},M.__data__=pn(T),T=M);I.i.push(new Pn(I.Ya++,T)),I.I==3&&Ai(I)},ci.prototype.N=function(){this.g.l=null,delete this.j,_t(this.g),delete this.g,ci.Z.N.call(this)};function Ml(T){Ne.call(this),T.__headers__&&(this.headers=T.__headers__,this.statusCode=T.__status__,delete T.__headers__,delete T.__status__);var I=T.__sm__;if(I){e:{for(const M in I){T=M;break e}T=void 0}(this.i=T)&&(T=this.i,I=I!==null&&T in I?I[T]:void 0),this.data=I}else this.data=T}x(Ml,Ne);function Ju(){ht.call(this),this.status=1}x(Ju,ht);function vr(T){this.g=T}x(vr,fa),vr.prototype.ra=function(){pe(this.g,"a")},vr.prototype.qa=function(T){pe(this.g,new Ml(T))},vr.prototype.pa=function(T){pe(this.g,new Ju)},vr.prototype.oa=function(){pe(this.g,"b")},Gr.prototype.createWebChannel=Gr.prototype.g,ci.prototype.send=ci.prototype.o,ci.prototype.open=ci.prototype.m,ci.prototype.close=ci.prototype.close,AR=function(){return new Gr},IR=function(){return Si()},CR=dt,i0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ho.NO_ERROR=0,ho.TIMEOUT=8,ho.HTTP_ERROR=6,pp=ho,El.COMPLETE="complete",bR=El,co.EventType=Ti,Ti.OPEN="a",Ti.CLOSE="b",Ti.ERROR="c",Ti.MESSAGE="d",we.prototype.listen=we.prototype.J,Vh=co,Pt.prototype.listenOnce=Pt.prototype.K,Pt.prototype.getLastError=Pt.prototype.Ha,Pt.prototype.getLastErrorCode=Pt.prototype.ya,Pt.prototype.getStatus=Pt.prototype.ca,Pt.prototype.getResponseJson=Pt.prototype.La,Pt.prototype.getResponseText=Pt.prototype.la,Pt.prototype.send=Pt.prototype.ea,Pt.prototype.setWithCredentials=Pt.prototype.Fa,SR=Pt}).apply(typeof Xm<"u"?Xm:typeof self<"u"?self:typeof window<"u"?window:{});const mI="@firebase/firestore",pI="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gi.UNAUTHENTICATED=new gi(null),gi.GOOGLE_CREDENTIALS=new gi("google-credentials-uid"),gi.FIRST_PARTY=new gi("first-party-uid"),gi.MOCK_USER=new gi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ad="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wu=new Ug("@firebase/firestore");function Dc(){return wu.logLevel}function Ae(n,...e){if(wu.logLevel<=bt.DEBUG){const t=e.map(PT);wu.debug(`Firestore (${Ad}): ${n}`,...t)}}function qn(n,...e){if(wu.logLevel<=bt.ERROR){const t=e.map(PT);wu.error(`Firestore (${Ad}): ${n}`,...t)}}function Su(n,...e){if(wu.logLevel<=bt.WARN){const t=e.map(PT);wu.warn(`Firestore (${Ad}): ${n}`,...t)}}function PT(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qe(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,NR(n,i,t)}function NR(n,e,t){let i=`FIRESTORE (${Ad}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw qn(i),new Error(i)}function Ze(n,e,t,i){let s="Unexpected state";typeof t=="string"?s=t:i=t,n||NR(e,s,i)}function Ke(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ve={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ke extends ta{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $B{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(gi.UNAUTHENTICATED)))}shutdown(){}}class XB{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class ez{constructor(e){this.t=e,this.currentUser=gi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let i=this.i;const s=h=>this.i!==i?(i=this.i,t(h)):Promise.resolve();let o=new Go;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Go,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const h=o;e.enqueueRetryable((async()=>{await h.promise,await s(this.currentUser)}))},d=h=>{Ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>d(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?d(h):(Ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Go)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ze(typeof i.accessToken=="string",31837,{l:i}),new RR(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new gi(e)}}class tz{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=gi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class nz{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new tz(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(gi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iz{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ar(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const i=o=>{o.error!=null&&Ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,Ae("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>i(o)))};const s=o=>{Ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>s(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):Ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new gI(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gI(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sz(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=sz(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<t&&(i+=e.charAt(s[o]%62))}return i}}function ut(n,e){return n<e?-1:n>e?1:0}function s0(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const s=n.charAt(i),o=e.charAt(i);if(s!==o)return Tv(s)===Tv(o)?ut(s,o):Tv(s)?1:-1}return ut(n.length,e.length)}const rz=55296,oz=57343;function Tv(n){const e=n.charCodeAt(0);return e>=rz&&e<=oz}function td(n,e,t){return n.length===e.length&&n.every(((i,s)=>t(i,e[s])))}function MR(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I="__name__";class eo{constructor(e,t,i){t===void 0?t=0:t>e.length&&qe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&qe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return eo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof eo?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const o=eo.compareSegments(e.get(s),t.get(s));if(o!==0)return o}return ut(e.length,t.length)}static compareSegments(e,t){const i=eo.isNumericId(e),s=eo.isNumericId(t);return i&&!s?-1:!i&&s?1:i&&s?eo.extractNumericId(e).compare(eo.extractNumericId(t)):s0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return tl.fromString(e.substring(4,e.length-2))}}class Kt extends eo{construct(e,t,i){return new Kt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ke(ve.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((s=>s.length>0)))}return new Kt(t)}static emptyPath(){return new Kt([])}}const az=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class An extends eo{construct(e,t,i){return new An(e,t,i)}static isValidIdentifier(e){return az.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),An.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_I}static keyField(){return new An([_I])}static fromServerFormat(e){const t=[];let i="",s=0;const o=()=>{if(i.length===0)throw new ke(ve.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let l=!1;for(;s<e.length;){const d=e[s];if(d==="\\"){if(s+1===e.length)throw new ke(ve.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new ke(ve.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=h,s+=2}else d==="`"?(l=!l,s++):d!=="."||l?(i+=d,s++):(o(),s++)}if(o(),l)throw new ke(ve.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new An(t)}static emptyPath(){return new An([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.path=e}static fromPath(e){return new Ve(Kt.fromString(e))}static fromName(e){return new Ve(Kt.fromString(e).popFirst(5))}static empty(){return new Ve(Kt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Kt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Kt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ve(new Kt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PR(n,e,t){if(!t)throw new ke(ve.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function lz(n,e,t,i){if(e===!0&&i===!0)throw new ke(ve.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function yI(n){if(!Ve.isDocumentKey(n))throw new ke(ve.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function vI(n){if(Ve.isDocumentKey(n))throw new ke(ve.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function kR(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Gg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":qe(12329,{type:typeof n})}function Bs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ke(ve.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Gg(n);throw new ke(ve.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Pf(n,e){if(!kR(n))throw new ke(ve.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const s=e[i].typeString,o="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const l=n[i];if(s&&typeof l!==s){t=`JSON field '${i}' must be a ${s}.`;break}if(o!==void 0&&l!==o.value){t=`Expected '${i}' field to equal '${o.value}'`;break}}if(t)throw new ke(ve.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=-62135596800,EI=1e6;class en{static now(){return en.fromMillis(Date.now())}static fromDate(e){return en.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*EI);return new en(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ke(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ke(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<TI)throw new ke(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ke(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/EI}_compareTo(e){return this.seconds===e.seconds?ut(this.nanoseconds,e.nanoseconds):ut(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:en._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pf(e,en._jsonSchema))return new en(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-TI;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}en._jsonSchemaVersion="firestore/timestamp/1.0",en._jsonSchema={type:Xn("string",en._jsonSchemaVersion),seconds:Xn("number"),nanoseconds:Xn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new en(0,0))}static max(){return new Xe(new en(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd=-1;class Kp{constructor(e,t,i,s){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=s}}function r0(n){return n.fields.find((e=>e.kind===2))}function su(n){return n.fields.filter((e=>e.kind!==2))}Kp.UNKNOWN_ID=-1;class gp{constructor(e,t){this.fieldPath=e,this.kind=t}}class df{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new df(0,Gs.min())}}function DR(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=Xe.fromTimestamp(i===1e9?new en(t+1,0):new en(t,i));return new Gs(s,Ve.empty(),e)}function LR(n){return new Gs(n.readTime,n.key,nd)}class Gs{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Gs(Xe.min(),Ve.empty(),nd)}static max(){return new Gs(Xe.max(),Ve.empty(),nd)}}function DT(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ve.comparator(n.documentKey,e.documentKey),t!==0?t:ut(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class OR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gl(n){if(n.code!==ve.FAILED_PRECONDITION||n.message!==VR)throw n;Ae("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&qe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ie(((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ie?t:ie.resolve(t)}catch(t){return ie.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ie.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ie.reject(t)}static resolve(e){return new ie(((t,i)=>{t(e)}))}static reject(e){return new ie(((t,i)=>{i(e)}))}static waitFor(e){return new ie(((t,i)=>{let s=0,o=0,l=!1;e.forEach((d=>{++s,d.next((()=>{++o,l&&o===s&&t()}),(h=>i(h)))})),l=!0,o===s&&t()}))}static or(e){let t=ie.resolve(!1);for(const i of e)t=t.next((s=>s?ie.resolve(s):i()));return t}static forEach(e,t){const i=[];return e.forEach(((s,o)=>{i.push(t.call(this,s,o))})),this.waitFor(i)}static mapArray(e,t){return new ie(((i,s)=>{const o=e.length,l=new Array(o);let d=0;for(let h=0;h<o;h++){const p=h;t(e[p]).next((v=>{l[p]=v,++d,d===o&&i(l)}),(v=>s(v)))}}))}static doWhile(e,t){return new ie(((i,s)=>{const o=()=>{e()===!0?t().next((()=>{o()}),s):i()};o()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us="SimpleDb";class Hg{static open(e,t,i,s){try{return new Hg(t,e.transaction(s,i))}catch(o){throw new jh(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Go,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new jh(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const s=LT(i.target.error);this.S.reject(new jh(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ae(Us,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new cz(t)}}class nl{static delete(e){return Ae(Us,"Removing database:",e),au(NN().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!FN())return!1;if(nl.F())return!0;const e=si(),t=nl.M(e),i=0<t&&t<10,s=UR(e),o=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,nl.M(si())===12.2&&qn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ae(Us,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=o=>{const l=o.target.result;t(l)},s.onblocked=()=>{i(new jh(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const l=o.target.error;l.name==="VersionError"?i(new ke(ve.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?i(new ke(ve.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):i(new jh(e,l))},s.onupgradeneeded=o=>{Ae(Us,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const l=o.target.result;this.N.k(l,s.transaction,o.oldVersion,this.version).next((()=>{Ae(Us,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,s){const o=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const d=Hg.open(this.db,e,o?"readonly":"readwrite",i),h=s(d).next((p=>(d.C(),p))).catch((p=>(d.abort(p),ie.reject(p)))).toPromise();return h.catch((()=>{})),await d.D,h}catch(d){const h=d,p=h.name!=="FirebaseError"&&l<3;if(Ae(Us,"Transaction failed with error:",h.message,"Retrying:",p),this.close(),!p)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function UR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class uz{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return au(this.U.delete())}}class jh extends ke{constructor(e,t){super(ve.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function _l(n){return n.name==="IndexedDbTransactionError"}class cz{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(Ae(Us,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(Ae(Us,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),au(i)}add(e){return Ae(Us,"ADD",this.store.name,e,e),au(this.store.add(e))}get(e){return au(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ae(Us,"GET",this.store.name,e,t),t)))}delete(e){return Ae(Us,"DELETE",this.store.name,e),au(this.store.delete(e))}count(){return Ae(Us,"COUNT",this.store.name),au(this.store.count())}J(e,t){const i=this.options(e,t),s=i.index?this.store.index(i.index):this.store;if(typeof s.getAll=="function"){const o=s.getAll(i.range);return new ie(((l,d)=>{o.onerror=h=>{d(h.target.error)},o.onsuccess=h=>{l(h.target.result)}}))}{const o=this.cursor(i),l=[];return this.H(o,((d,h)=>{l.push(h)})).next((()=>l))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new ie(((s,o)=>{i.onerror=l=>{o(l.target.error)},i.onsuccess=l=>{s(l.target.result)}}))}Z(e,t){Ae(Us,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const s=this.cursor(i);return this.H(s,((o,l,d)=>d.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const s=this.cursor(i);return this.H(s,t)}te(e){const t=this.cursor({});return new ie(((i,s)=>{t.onerror=o=>{const l=LT(o.target.error);s(l)},t.onsuccess=o=>{const l=o.target.result;l?e(l.primaryKey,l.value).next((d=>{d?l.continue():i()})):i()}}))}H(e,t){const i=[];return new ie(((s,o)=>{e.onerror=l=>{o(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void s();const h=new uz(d),p=t(d.primaryKey,d.value,h);if(p instanceof ie){const v=p.catch((x=>(h.done(),ie.reject(x))));i.push(v)}h.isDone?s():h.G===null?d.continue():d.continue(h.G)}})).next((()=>ie.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function au(n){return new ie(((e,t)=>{n.onsuccess=i=>{const s=i.target.result;e(s)},n.onerror=i=>{const s=LT(i.target.error);t(s)}}))}let xI=!1;function LT(n){const e=nl.M(si());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new ke("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return xI||(xI=!0,setTimeout((()=>{throw i}),0)),i}}return n}const Kh="IndexBackfiller";class dz{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ae(Kh,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ae(Kh,`Documents written: ${t}`)}catch(t){_l(t)?Ae(Kh,"Ignoring IndexedDB error during index backfill: ",t):await gl(t)}await this.re(6e4)}))}}class hz{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let s=t,o=!0;return ie.doWhile((()=>o===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!i.has(l))return Ae(Kh,`Processing collection: ${l}`),this.oe(e,l,s).next((d=>{s-=d,i.add(l)}));o=!1})))).next((()=>t-s))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,i).next((o=>{const l=o.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(s,o))).next((d=>(Ae(Kh,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>l.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((s,o)=>{const l=LR(o);DT(l,i)>0&&(i=l)})),new Gs(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ms.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gu=-1;function jg(n){return n==null}function hf(n){return n===0&&1/n==-1/0}function FR(n){return typeof n=="number"&&Number.isInteger(n)&&!hf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="";function Fi(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=wI(e)),e=fz(n.get(t),e);return wI(e)}function fz(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const o=n.charAt(s);switch(o){case"\0":t+="";break;case Wp:t+="";break;default:t+=o}}return t}function wI(n){return n+Wp+""}function no(n){const e=n.length;if(Ze(e>=2,64408,{path:n}),e===2)return Ze(n.charAt(0)===Wp&&n.charAt(1)==="",56145,{path:n}),Kt.emptyPath();const t=e-2,i=[];let s="";for(let o=0;o<e;){const l=n.indexOf(Wp,o);switch((l<0||l>t)&&qe(50515,{path:n}),n.charAt(l+1)){case"":const d=n.substring(o,l);let h;s.length===0?h=d:(s+=d,h=s,s=""),i.push(h);break;case"":s+=n.substring(o,l),s+="\0";break;case"":s+=n.substring(o,l+1);break;default:qe(61167,{path:n})}o=l+2}return new Kt(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ru="remoteDocuments",kf="owner",Ic="owner",ff="mutationQueues",mz="userId",Cr="mutations",SI="batchId",fu="userMutationsIndex",bI=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(n,e){return[n,Fi(e)]}function BR(n,e,t){return[n,Fi(e),t]}const pz={},id="documentMutations",Yp="remoteDocumentsV14",gz=["prefixPath","collectionGroup","readTime","documentId"],yp="documentKeyIndex",_z=["prefixPath","collectionGroup","documentId"],zR="collectionGroupIndex",yz=["collectionGroup","readTime","prefixPath","documentId"],mf="remoteDocumentGlobal",o0="remoteDocumentGlobalKey",sd="targets",qR="queryTargetsIndex",vz=["canonicalId","targetId"],rd="targetDocuments",Tz=["targetId","path"],VT="documentTargetsIndex",Ez=["path","targetId"],Jp="targetGlobalKey",_u="targetGlobal",pf="collectionParents",xz=["collectionId","parent"],od="clientMetadata",wz="clientId",Kg="bundles",Sz="bundleId",Wg="namedQueries",bz="name",OT="indexConfiguration",Cz="indexId",a0="collectionGroupIndex",Iz="collectionGroup",Wh="indexState",Az=["indexId","uid"],GR="sequenceNumberIndex",Nz=["uid","sequenceNumber"],Yh="indexEntries",Rz=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],HR="documentKeyIndex",Mz=["indexId","uid","orderedDocumentKey"],Yg="documentOverlays",Pz=["userId","collectionPath","documentId"],l0="collectionPathOverlayIndex",kz=["userId","collectionPath","largestBatchId"],jR="collectionGroupOverlayIndex",Dz=["userId","collectionGroup","largestBatchId"],UT="globals",Lz="name",KR=[ff,Cr,id,ru,sd,kf,_u,rd,od,mf,pf,Kg,Wg],Vz=[...KR,Yg],WR=[ff,Cr,id,Yp,sd,kf,_u,rd,od,mf,pf,Kg,Wg,Yg],YR=WR,FT=[...YR,OT,Wh,Yh],Oz=FT,JR=[...FT,UT],Uz=JR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0 extends OR{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function ri(n,e){const t=Ke(n);return nl.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CI(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function yl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ZR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nn=class c0{constructor(e,t){this.comparator=e,this.root=t||il.EMPTY}insert(e,t){return new c0(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,il.BLACK,null,null))}remove(e){return new c0(this.comparator,this.root.remove(e,this.comparator).copy(null,null,il.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ep(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ep(this.root,e,this.comparator,!1)}getReverseIterator(){return new ep(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ep(this.root,e,this.comparator,!0)}},ep=class{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},il=class Vo{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??Vo.RED,this.left=s??Vo.EMPTY,this.right=o??Vo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,o){return new Vo(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Vo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Vo.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw qe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw qe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw qe(27949);return e+(this.isRed()?0:1)}};il.EMPTY=null,il.RED=!0,il.BLACK=!1;il.EMPTY=new class{constructor(){this.size=0}get key(){throw qe(57766)}get value(){throw qe(16141)}get color(){throw qe(16727)}get left(){throw qe(29726)}get right(){throw qe(36894)}copy(e,t,i,s,o){return this}insert(e,t,i){return new il(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.comparator=e,this.data=new Nn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new II(this.data.getIterator())}getIteratorFrom(e){return new II(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof sn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new sn(this.comparator);return t.data=e,t}}class II{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ac(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e){this.fields=e,e.sort(An.comparator)}static empty(){return new ps([])}unionWith(e){let t=new sn(An.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ps(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return td(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new QR("Invalid base64 string: "+o):o}})(e);return new Hn(t)}static fromUint8Array(e){const t=(function(s){let o="";for(let l=0;l<s.length;++l)o+=String.fromCharCode(s[l]);return o})(e);return new Hn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ut(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hn.EMPTY_BYTE_STRING=new Hn("");const Fz=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Jo(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=Fz.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:bn(n.seconds),nanos:bn(n.nanos)}}function bn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Zo(n){return typeof n=="string"?Hn.fromBase64String(n):Hn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R="server_timestamp",XR="__type__",e2="__previous_value__",t2="__local_write_time__";function BT(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[XR])==null?void 0:i.stringValue)===$R}function Jg(n){const e=n.mapValue.fields[e2];return BT(e)?Jg(e):e}function gf(n){const e=Jo(n.mapValue.fields[t2].timestampValue);return new en(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{constructor(e,t,i,s,o,l,d,h,p,v){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.longPollingOptions=h,this.useFetchStreams=p,this.isUsingEmulator=v}}const Zp="(default)";class bu{constructor(e,t){this.projectId=e,this.database=t||Zp}static empty(){return new bu("","")}get isDefaultDatabase(){return this.database===Zp}isEqual(e){return e instanceof bu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT="__type__",n2="__max__",Qa={mapValue:{fields:{__type__:{stringValue:n2}}}},qT="__vector__",ad="value",vp={nullValue:"NULL_VALUE"};function ll(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?BT(n)?4:i2(n)?9007199254740991:Zg(n)?10:11:qe(28295,{value:n})}function uo(n,e){if(n===e)return!0;const t=ll(n);if(t!==ll(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return gf(n).isEqual(gf(e));case 3:return(function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const l=Jo(s.timestampValue),d=Jo(o.timestampValue);return l.seconds===d.seconds&&l.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,o){return Zo(s.bytesValue).isEqual(Zo(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,o){return bn(s.geoPointValue.latitude)===bn(o.geoPointValue.latitude)&&bn(s.geoPointValue.longitude)===bn(o.geoPointValue.longitude)})(n,e);case 2:return(function(s,o){if("integerValue"in s&&"integerValue"in o)return bn(s.integerValue)===bn(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const l=bn(s.doubleValue),d=bn(o.doubleValue);return l===d?hf(l)===hf(d):isNaN(l)&&isNaN(d)}return!1})(n,e);case 9:return td(n.arrayValue.values||[],e.arrayValue.values||[],uo);case 10:case 11:return(function(s,o){const l=s.mapValue.fields||{},d=o.mapValue.fields||{};if(CI(l)!==CI(d))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(d[h]===void 0||!uo(l[h],d[h])))return!1;return!0})(n,e);default:return qe(52216,{left:n})}}function _f(n,e){return(n.values||[]).find((t=>uo(t,e)))!==void 0}function ul(n,e){if(n===e)return 0;const t=ll(n),i=ll(e);if(t!==i)return ut(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ut(n.booleanValue,e.booleanValue);case 2:return(function(o,l){const d=bn(o.integerValue||o.doubleValue),h=bn(l.integerValue||l.doubleValue);return d<h?-1:d>h?1:d===h?0:isNaN(d)?isNaN(h)?0:-1:1})(n,e);case 3:return AI(n.timestampValue,e.timestampValue);case 4:return AI(gf(n),gf(e));case 5:return s0(n.stringValue,e.stringValue);case 6:return(function(o,l){const d=Zo(o),h=Zo(l);return d.compareTo(h)})(n.bytesValue,e.bytesValue);case 7:return(function(o,l){const d=o.split("/"),h=l.split("/");for(let p=0;p<d.length&&p<h.length;p++){const v=ut(d[p],h[p]);if(v!==0)return v}return ut(d.length,h.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,l){const d=ut(bn(o.latitude),bn(l.latitude));return d!==0?d:ut(bn(o.longitude),bn(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return NI(n.arrayValue,e.arrayValue);case 10:return(function(o,l){var b,A,P,F;const d=o.fields||{},h=l.fields||{},p=(b=d[ad])==null?void 0:b.arrayValue,v=(A=h[ad])==null?void 0:A.arrayValue,x=ut(((P=p==null?void 0:p.values)==null?void 0:P.length)||0,((F=v==null?void 0:v.values)==null?void 0:F.length)||0);return x!==0?x:NI(p,v)})(n.mapValue,e.mapValue);case 11:return(function(o,l){if(o===Qa.mapValue&&l===Qa.mapValue)return 0;if(o===Qa.mapValue)return 1;if(l===Qa.mapValue)return-1;const d=o.fields||{},h=Object.keys(d),p=l.fields||{},v=Object.keys(p);h.sort(),v.sort();for(let x=0;x<h.length&&x<v.length;++x){const b=s0(h[x],v[x]);if(b!==0)return b;const A=ul(d[h[x]],p[v[x]]);if(A!==0)return A}return ut(h.length,v.length)})(n.mapValue,e.mapValue);default:throw qe(23264,{he:t})}}function AI(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ut(n,e);const t=Jo(n),i=Jo(e),s=ut(t.seconds,i.seconds);return s!==0?s:ut(t.nanos,i.nanos)}function NI(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const o=ul(t[s],i[s]);if(o)return o}return ut(t.length,i.length)}function ld(n){return d0(n)}function d0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Jo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Zo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ve.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",s=!0;for(const o of t.values||[])s?s=!1:i+=",",i+=d0(o);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let s="{",o=!0;for(const l of i)o?o=!1:s+=",",s+=`${l}:${d0(t.fields[l])}`;return s+"}"})(n.mapValue):qe(61005,{value:n})}function Tp(n){switch(ll(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Jg(n);return e?16+Tp(e):16;case 5:return 2*n.stringValue.length;case 6:return Zo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((s,o)=>s+Tp(o)),0)})(n.arrayValue);case 10:case 11:return(function(i){let s=0;return yl(i.fields,((o,l)=>{s+=o.length+Tp(l)})),s})(n.mapValue);default:throw qe(13486,{value:n})}}function yf(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function h0(n){return!!n&&"integerValue"in n}function vf(n){return!!n&&"arrayValue"in n}function RI(n){return!!n&&"nullValue"in n}function MI(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ep(n){return!!n&&"mapValue"in n}function Zg(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[zT])==null?void 0:i.stringValue)===qT}function Jh(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return yl(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Jh(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Jh(n.arrayValue.values[t]);return e}return{...n}}function i2(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===n2}const s2={mapValue:{fields:{[zT]:{stringValue:qT},[ad]:{arrayValue:{}}}}};function zz(n){return"nullValue"in n?vp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?yf(bu.empty(),Ve.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Zg(n)?s2:{mapValue:{}}:qe(35942,{value:n})}function qz(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?yf(bu.empty(),Ve.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?s2:"mapValue"in n?Zg(n)?{mapValue:{}}:Qa:qe(61959,{value:n})}function PI(n,e){const t=ul(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function kI(n,e){const t=ul(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e){this.value=e}static empty(){return new Vi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Ep(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Jh(t)}setAll(e){let t=An.emptyPath(),i={},s=[];e.forEach(((l,d)=>{if(!t.isImmediateParentOf(d)){const h=this.getFieldsMap(t);this.applyChanges(h,i,s),i={},s=[],t=d.popLast()}l?i[d.lastSegment()]=Jh(l):s.push(d.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,i,s)}delete(e){const t=this.field(e.popLast());Ep(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return uo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];Ep(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){yl(t,((s,o)=>e[s]=o));for(const s of i)delete e[s]}clone(){return new Vi(Jh(this.value))}}function r2(n){const e=[];return yl(n.fields,((t,i)=>{const s=new An([t]);if(Ep(i)){const o=r2(i.mapValue).fields;if(o.length===0)e.push(s);else for(const l of o)e.push(s.child(l))}else e.push(s)})),new ps(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,t,i,s,o,l,d){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=o,this.data=l,this.documentState=d}static newInvalidDocument(e){return new Vn(e,0,Xe.min(),Xe.min(),Xe.min(),Vi.empty(),0)}static newFoundDocument(e,t,i,s){return new Vn(e,1,t,Xe.min(),i,s,0)}static newNoDocument(e,t){return new Vn(e,2,t,Xe.min(),Xe.min(),Vi.empty(),0)}static newUnknownDocument(e,t){return new Vn(e,3,t,Xe.min(),Xe.min(),Vi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Vn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Vn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e,t){this.position=e,this.inclusive=t}}function DI(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const o=e[s],l=n.position[s];if(o.field.isKeyField()?i=Ve.comparator(Ve.fromName(l.referenceValue),t.key):i=ul(l,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function LI(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!uo(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e,t="asc"){this.field=e,this.dir=t}}function Gz(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{}class Lt extends o2{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Hz(e,t,i):t==="array-contains"?new Wz(e,i):t==="in"?new h2(e,i):t==="not-in"?new Yz(e,i):t==="array-contains-any"?new Jz(e,i):new Lt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new jz(e,i):new Kz(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ul(t,this.value)):t!==null&&ll(this.value)===ll(t)&&this.matchesComparison(ul(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return qe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tn extends o2{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new tn(e,t)}matches(e){return cd(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function cd(n){return n.op==="and"}function f0(n){return n.op==="or"}function GT(n){return a2(n)&&cd(n)}function a2(n){for(const e of n.filters)if(e instanceof tn)return!1;return!0}function m0(n){if(n instanceof Lt)return n.field.canonicalString()+n.op.toString()+ld(n.value);if(GT(n))return n.filters.map((e=>m0(e))).join(",");{const e=n.filters.map((t=>m0(t))).join(",");return`${n.op}(${e})`}}function l2(n,e){return n instanceof Lt?(function(i,s){return s instanceof Lt&&i.op===s.op&&i.field.isEqual(s.field)&&uo(i.value,s.value)})(n,e):n instanceof tn?(function(i,s){return s instanceof tn&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((o,l,d)=>o&&l2(l,s.filters[d])),!0):!1})(n,e):void qe(19439)}function u2(n,e){const t=n.filters.concat(e);return tn.create(t,n.op)}function c2(n){return n instanceof Lt?(function(t){return`${t.field.canonicalString()} ${t.op} ${ld(t.value)}`})(n):n instanceof tn?(function(t){return t.op.toString()+" {"+t.getFilters().map(c2).join(" ,")+"}"})(n):"Filter"}class Hz extends Lt{constructor(e,t,i){super(e,t,i),this.key=Ve.fromName(i.referenceValue)}matches(e){const t=Ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class jz extends Lt{constructor(e,t){super(e,"in",t),this.keys=d2("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Kz extends Lt{constructor(e,t){super(e,"not-in",t),this.keys=d2("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function d2(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Ve.fromName(i.referenceValue)))}class Wz extends Lt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return vf(t)&&_f(t.arrayValue,this.value)}}class h2 extends Lt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&_f(this.value.arrayValue,t)}}class Yz extends Lt{constructor(e,t){super(e,"not-in",t)}matches(e){if(_f(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!_f(this.value.arrayValue,t)}}class Jz extends Lt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!vf(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>_f(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{constructor(e,t=null,i=[],s=[],o=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=l,this.endAt=d,this.Te=null}}function p0(n,e=null,t=[],i=[],s=null,o=null,l=null){return new Zz(n,e,t,i,s,o,l)}function Cu(n){const e=Ke(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>m0(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(o){return o.field.canonicalString()+o.dir})(i))).join(","),jg(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>ld(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>ld(i))).join(",")),e.Te=t}return e.Te}function Df(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Gz(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!l2(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!LI(n.startAt,e.startAt)&&LI(n.endAt,e.endAt)}function $p(n){return Ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Xp(n,e){return n.filters.filter((t=>t instanceof Lt&&t.field.isEqual(e)))}function VI(n,e,t){let i=vp,s=!0;for(const o of Xp(n,e)){let l=vp,d=!0;switch(o.op){case"<":case"<=":l=zz(o.value);break;case"==":case"in":case">=":l=o.value;break;case">":l=o.value,d=!1;break;case"!=":case"not-in":l=vp}PI({value:i,inclusive:s},{value:l,inclusive:d})<0&&(i=l,s=d)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const l=t.position[o];PI({value:i,inclusive:s},{value:l,inclusive:t.inclusive})<0&&(i=l,s=t.inclusive);break}}return{value:i,inclusive:s}}function OI(n,e,t){let i=Qa,s=!0;for(const o of Xp(n,e)){let l=Qa,d=!0;switch(o.op){case">=":case">":l=qz(o.value),d=!1;break;case"==":case"in":case"<=":l=o.value;break;case"<":l=o.value,d=!1;break;case"!=":case"not-in":l=Qa}kI({value:i,inclusive:s},{value:l,inclusive:d})>0&&(i=l,s=d)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const l=t.position[o];kI({value:i,inclusive:s},{value:l,inclusive:t.inclusive})>0&&(i=l,s=t.inclusive);break}}return{value:i,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e,t=null,i=[],s=[],o=null,l="F",d=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=l,this.startAt=d,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function f2(n,e,t,i,s,o,l,d){return new Lf(n,e,t,i,s,o,l,d)}function Qg(n){return new Lf(n)}function UI(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function m2(n){return n.collectionGroup!==null}function Zh(n){const e=Ke(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),t.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let d=new sn(An.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((p=>{p.isInequality()&&(d=d.add(p.field))}))})),d})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new Qp(o,i))})),t.has(An.keyField().canonicalString())||e.Ie.push(new Qp(An.keyField(),i))}return e.Ie}function zs(n){const e=Ke(n);return e.Ee||(e.Ee=Qz(e,Zh(n))),e.Ee}function Qz(n,e){if(n.limitType==="F")return p0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const o=s.dir==="desc"?"asc":"desc";return new Qp(s.field,o)}));const t=n.endAt?new ud(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new ud(n.startAt.position,n.startAt.inclusive):null;return p0(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function g0(n,e){const t=n.filters.concat([e]);return new Lf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function _0(n,e,t){return new Lf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function $g(n,e){return Df(zs(n),zs(e))&&n.limitType===e.limitType}function p2(n){return`${Cu(zs(n))}|lt:${n.limitType}`}function Lc(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((s=>c2(s))).join(", ")}]`),jg(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((s=>ld(s))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((s=>ld(s))).join(",")),`Target(${i})`})(zs(n))}; limitType=${n.limitType})`}function Vf(n,e){return e.isFoundDocument()&&(function(i,s){const o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Ve.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)})(n,e)&&(function(i,s){for(const o of Zh(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(i,s){for(const o of i.filters)if(!o.matches(s))return!1;return!0})(n,e)&&(function(i,s){return!(i.startAt&&!(function(l,d,h){const p=DI(l,d,h);return l.inclusive?p<=0:p<0})(i.startAt,Zh(i),s)||i.endAt&&!(function(l,d,h){const p=DI(l,d,h);return l.inclusive?p>=0:p>0})(i.endAt,Zh(i),s))})(n,e)}function g2(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function _2(n){return(e,t)=>{let i=!1;for(const s of Zh(n)){const o=$z(s,e,t);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function $z(n,e,t){const i=n.field.isKeyField()?Ve.comparator(e.key,t.key):(function(o,l,d){const h=l.data.field(o),p=d.data.field(o);return h!==null&&p!==null?ul(h,p):qe(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return qe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,o]of i)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){yl(this.inner,((t,i)=>{for(const[s,o]of i)e(s,o)}))}isEmpty(){return ZR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xz=new Nn(Ve.comparator);function Fs(){return Xz}const y2=new Nn(Ve.comparator);function Oh(...n){let e=y2;for(const t of n)e=e.insert(t.key,t);return e}function v2(n){let e=y2;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function io(){return Qh()}function T2(){return Qh()}function Qh(){return new ia((n=>n.toString()),((n,e)=>n.isEqual(e)))}const e7=new Nn(Ve.comparator),t7=new sn(Ve.comparator);function vt(...n){let e=t7;for(const t of n)e=e.add(t);return e}const n7=new sn(ut);function HT(){return n7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hf(e)?"-0":e}}function E2(n){return{integerValue:""+n}}function i7(n,e){return FR(e)?E2(e):jT(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{constructor(){this._=void 0}}function s7(n,e,t){return n instanceof dd?(function(s,o){const l={fields:{[XR]:{stringValue:$R},[t2]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&BT(o)&&(o=Jg(o)),o&&(l.fields[e2]=o),{mapValue:l}})(t,e):n instanceof Iu?w2(n,e):n instanceof hd?S2(n,e):(function(s,o){const l=x2(s,o),d=FI(l)+FI(s.Ae);return h0(l)&&h0(s.Ae)?E2(d):jT(s.serializer,d)})(n,e)}function r7(n,e,t){return n instanceof Iu?w2(n,e):n instanceof hd?S2(n,e):t}function x2(n,e){return n instanceof Tf?(function(i){return h0(i)||(function(o){return!!o&&"doubleValue"in o})(i)})(e)?e:{integerValue:0}:null}class dd extends Xg{}class Iu extends Xg{constructor(e){super(),this.elements=e}}function w2(n,e){const t=b2(e);for(const i of n.elements)t.some((s=>uo(s,i)))||t.push(i);return{arrayValue:{values:t}}}class hd extends Xg{constructor(e){super(),this.elements=e}}function S2(n,e){let t=b2(e);for(const i of n.elements)t=t.filter((s=>!uo(s,i)));return{arrayValue:{values:t}}}class Tf extends Xg{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function FI(n){return bn(n.integerValue||n.doubleValue)}function b2(n){return vf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e,t){this.field=e,this.transform=t}}function o7(n,e){return n.field.isEqual(e.field)&&(function(i,s){return i instanceof Iu&&s instanceof Iu||i instanceof hd&&s instanceof hd?td(i.elements,s.elements,uo):i instanceof Tf&&s instanceof Tf?uo(i.Ae,s.Ae):i instanceof dd&&s instanceof dd})(n.transform,e.transform)}class a7{constructor(e,t){this.version=e,this.transformResults=t}}class Ui{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ui}static exists(e){return new Ui(void 0,e)}static updateTime(e){return new Ui(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class e_{}function C2(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new t_(n.key,Ui.none()):new Nd(n.key,n.data,Ui.none());{const t=n.data,i=Vi.empty();let s=new sn(An.comparator);for(let o of e.fields)if(!s.has(o)){let l=t.field(o);l===null&&o.length>1&&(o=o.popLast(),l=t.field(o)),l===null?i.delete(o):i.set(o,l),s=s.add(o)}return new sa(n.key,i,new ps(s.toArray()),Ui.none())}}function l7(n,e,t){n instanceof Nd?(function(s,o,l){const d=s.value.clone(),h=zI(s.fieldTransforms,o,l.transformResults);d.setAll(h),o.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):n instanceof sa?(function(s,o,l){if(!xp(s.precondition,o))return void o.convertToUnknownDocument(l.version);const d=zI(s.fieldTransforms,o,l.transformResults),h=o.data;h.setAll(I2(s)),h.setAll(d),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(n,e,t):(function(s,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function $h(n,e,t,i){return n instanceof Nd?(function(o,l,d,h){if(!xp(o.precondition,l))return d;const p=o.value.clone(),v=qI(o.fieldTransforms,h,l);return p.setAll(v),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof sa?(function(o,l,d,h){if(!xp(o.precondition,l))return d;const p=qI(o.fieldTransforms,h,l),v=l.data;return v.setAll(I2(o)),v.setAll(p),l.convertToFoundDocument(l.version,v).setHasLocalMutations(),d===null?null:d.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((x=>x.field)))})(n,e,t,i):(function(o,l,d){return xp(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):d})(n,e,t)}function u7(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),o=x2(i.transform,s||null);o!=null&&(t===null&&(t=Vi.empty()),t.set(i.field,o))}return t||null}function BI(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&td(i,s,((o,l)=>o7(o,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Nd extends e_{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class sa extends e_{constructor(e,t,i,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function I2(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function zI(n,e,t){const i=new Map;Ze(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const o=n[s],l=o.transform,d=e.data.field(o.field);i.set(o.field,r7(l,d,t[s]))}return i}function qI(n,e,t){const i=new Map;for(const s of n){const o=s.transform,l=t.data.field(s.field);i.set(s.field,s7(o,l,e))}return i}class t_ extends e_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class A2 extends e_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&l7(o,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=$h(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=$h(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=T2();return this.mutations.forEach((s=>{const o=e.get(s.key),l=o.overlayedDocument;let d=this.applyToLocalView(l,o.mutatedFields);d=t.has(s.key)?null:d;const h=C2(l,d);h!==null&&i.set(s.key,h),l.isValidDocument()||l.convertToNoDocument(Xe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),vt())}isEqual(e){return this.batchId===e.batchId&&td(this.mutations,e.mutations,((t,i)=>BI(t,i)))&&td(this.baseMutations,e.baseMutations,((t,i)=>BI(t,i)))}}class YT{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){Ze(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let s=(function(){return e7})();const o=e.mutations;for(let l=0;l<o.length;l++)s=s.insert(o[l].key,i[l].version);return new YT(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c7{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $n,Ut;function d7(n){switch(n){case ve.OK:return qe(64938);case ve.CANCELLED:case ve.UNKNOWN:case ve.DEADLINE_EXCEEDED:case ve.RESOURCE_EXHAUSTED:case ve.INTERNAL:case ve.UNAVAILABLE:case ve.UNAUTHENTICATED:return!1;case ve.INVALID_ARGUMENT:case ve.NOT_FOUND:case ve.ALREADY_EXISTS:case ve.PERMISSION_DENIED:case ve.FAILED_PRECONDITION:case ve.ABORTED:case ve.OUT_OF_RANGE:case ve.UNIMPLEMENTED:case ve.DATA_LOSS:return!0;default:return qe(15467,{code:n})}}function N2(n){if(n===void 0)return qn("GRPC error has no .code"),ve.UNKNOWN;switch(n){case $n.OK:return ve.OK;case $n.CANCELLED:return ve.CANCELLED;case $n.UNKNOWN:return ve.UNKNOWN;case $n.DEADLINE_EXCEEDED:return ve.DEADLINE_EXCEEDED;case $n.RESOURCE_EXHAUSTED:return ve.RESOURCE_EXHAUSTED;case $n.INTERNAL:return ve.INTERNAL;case $n.UNAVAILABLE:return ve.UNAVAILABLE;case $n.UNAUTHENTICATED:return ve.UNAUTHENTICATED;case $n.INVALID_ARGUMENT:return ve.INVALID_ARGUMENT;case $n.NOT_FOUND:return ve.NOT_FOUND;case $n.ALREADY_EXISTS:return ve.ALREADY_EXISTS;case $n.PERMISSION_DENIED:return ve.PERMISSION_DENIED;case $n.FAILED_PRECONDITION:return ve.FAILED_PRECONDITION;case $n.ABORTED:return ve.ABORTED;case $n.OUT_OF_RANGE:return ve.OUT_OF_RANGE;case $n.UNIMPLEMENTED:return ve.UNIMPLEMENTED;case $n.DATA_LOSS:return ve.DATA_LOSS;default:return qe(39323,{code:n})}}(Ut=$n||($n={}))[Ut.OK=0]="OK",Ut[Ut.CANCELLED=1]="CANCELLED",Ut[Ut.UNKNOWN=2]="UNKNOWN",Ut[Ut.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ut[Ut.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ut[Ut.NOT_FOUND=5]="NOT_FOUND",Ut[Ut.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ut[Ut.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ut[Ut.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ut[Ut.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ut[Ut.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ut[Ut.ABORTED=10]="ABORTED",Ut[Ut.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ut[Ut.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ut[Ut.INTERNAL=13]="INTERNAL",Ut[Ut.UNAVAILABLE=14]="UNAVAILABLE",Ut[Ut.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h7(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f7=new tl([4294967295,4294967295],0);function GI(n){const e=h7().encode(n),t=new wR;return t.update(e),new Uint8Array(t.digest())}function HI(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new tl([t,i],0),new tl([s,o],0)]}class ZT{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Uh(`Invalid padding: ${t}`);if(i<0)throw new Uh(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Uh(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Uh(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=tl.fromNumber(this.ge)}ye(e,t,i){let s=e.add(t.multiply(tl.fromNumber(i)));return s.compare(f7)===1&&(s=new tl([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=GI(e),[i,s]=HI(t);for(let o=0;o<this.hashCount;o++){const l=this.ye(i,s,o);if(!this.we(l))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new ZT(o,s,t);return i.forEach((d=>l.insert(d))),l}insert(e){if(this.ge===0)return;const t=GI(e),[i,s]=HI(t);for(let o=0;o<this.hashCount;o++){const l=this.ye(i,s,o);this.Se(l)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Uh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,t,i,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Uf.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Of(Xe.min(),s,new Nn(ut),Fs(),vt())}}class Uf{constructor(e,t,i,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Uf(i,t,vt(),vt(),vt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e,t,i,s){this.be=e,this.removedTargetIds=t,this.key=i,this.De=s}}class R2{constructor(e,t){this.targetId=e,this.Ce=t}}class M2{constructor(e,t,i=Hn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class jI{constructor(){this.ve=0,this.Fe=KI(),this.Me=Hn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=vt(),t=vt(),i=vt();return this.Fe.forEach(((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:qe(38017,{changeType:o})}})),new Uf(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=KI()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ze(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class m7{constructor(e){this.Ge=e,this.ze=new Map,this.je=Fs(),this.Je=tp(),this.He=tp(),this.Ye=new Nn(ut)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:qe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,i=e.Ce.count,s=this.ot(t);if(s){const o=s.target;if($p(o))if(i===0){const l=new Ve(o.path);this.et(t,l,Vn.newNoDocument(l,Xe.min()))}else Ze(i===1,20013,{expectedCount:i});else{const l=this._t(t);if(l!==i){const d=this.ut(e),h=d?this.ct(d,e,l):1;if(h!==0){this.it(t);const p=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=t;let l,d;try{l=Zo(i).toUint8Array()}catch(h){if(h instanceof QR)return Su("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{d=new ZT(l,s,o)}catch(h){return Su(h instanceof Uh?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return d.ge===0?null:d}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let s=0;return i.forEach((o=>{const l=this.Ge.ht(),d=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(d)||(this.et(t,o,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((o,l)=>{const d=this.ot(l);if(d){if(o.current&&$p(d.target)){const h=new Ve(d.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,Vn.newNoDocument(h,e))}o.Be&&(t.set(l,o.ke()),o.qe())}}));let i=vt();this.He.forEach(((o,l)=>{let d=!0;l.forEachWhile((h=>{const p=this.ot(h);return!p||p.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(o))})),this.je.forEach(((o,l)=>l.setReadTime(e)));const s=new Of(e,t,this.Ye,this.je,i);return this.je=Fs(),this.Je=tp(),this.He=tp(),this.Ye=new Nn(ut),s}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new jI,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new sn(ut),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new sn(ut),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ae("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new jI),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function tp(){return new Nn(Ve.comparator)}function KI(){return new Nn(Ve.comparator)}const p7={asc:"ASCENDING",desc:"DESCENDING"},g7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_7={and:"AND",or:"OR"};class y7{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function y0(n,e){return n.useProto3Json||jg(e)?e:{value:e}}function fd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function P2(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function v7(n,e){return fd(n,e.toTimestamp())}function Ji(n){return Ze(!!n,49232),Xe.fromTimestamp((function(t){const i=Jo(t);return new en(i.seconds,i.nanos)})(n))}function QT(n,e){return v0(n,e).canonicalString()}function v0(n,e){const t=(function(s){return new Kt(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function k2(n){const e=Kt.fromString(n);return Ze(q2(e),10190,{key:e.toString()}),e}function eg(n,e){return QT(n.databaseId,e.path)}function yu(n,e){const t=k2(e);if(t.get(1)!==n.databaseId.projectId)throw new ke(ve.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ke(ve.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ve(V2(t))}function D2(n,e){return QT(n.databaseId,e)}function L2(n){const e=k2(n);return e.length===4?Kt.emptyPath():V2(e)}function T0(n){return new Kt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function V2(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function WI(n,e,t){return{name:eg(n,e),fields:t.value.mapValue.fields}}function T7(n,e,t){const i=yu(n,e.name),s=Ji(e.updateTime),o=e.createTime?Ji(e.createTime):Xe.min(),l=new Vi({mapValue:{fields:e.fields}}),d=Vn.newFoundDocument(i,s,o,l);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function E7(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:qe(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=(function(p,v){return p.useProto3Json?(Ze(v===void 0||typeof v=="string",58123),Hn.fromBase64String(v||"")):(Ze(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),Hn.fromUint8Array(v||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&(function(p){const v=p.code===void 0?ve.UNKNOWN:N2(p.code);return new ke(v,p.message||"")})(l);t=new M2(i,s,o,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=yu(n,i.document.name),o=Ji(i.document.updateTime),l=i.document.createTime?Ji(i.document.createTime):Xe.min(),d=new Vi({mapValue:{fields:i.document.fields}}),h=Vn.newFoundDocument(s,o,l,d),p=i.targetIds||[],v=i.removedTargetIds||[];t=new wp(p,v,h.key,h)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=yu(n,i.document),o=i.readTime?Ji(i.readTime):Xe.min(),l=Vn.newNoDocument(s,o),d=i.removedTargetIds||[];t=new wp([],d,l.key,l)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=yu(n,i.document),o=i.removedTargetIds||[];t=new wp([],o,s,null)}else{if(!("filter"in e))return qe(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:o}=i,l=new c7(s,o),d=i.targetId;t=new R2(d,l)}}return t}function tg(n,e){let t;if(e instanceof Nd)t={update:WI(n,e.key,e.value)};else if(e instanceof t_)t={delete:eg(n,e.key)};else if(e instanceof sa)t={update:WI(n,e.key,e.data),updateMask:I7(e.fieldMask)};else{if(!(e instanceof A2))return qe(16599,{Vt:e.type});t={verify:eg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(o,l){const d=l.transform;if(d instanceof dd)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Iu)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof hd)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Tf)return{fieldPath:l.field.canonicalString(),increment:d.Ae};throw qe(20930,{transform:l.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(s,o){return o.updateTime!==void 0?{updateTime:v7(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:qe(27497)})(n,e.precondition)),t}function E0(n,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?Ui.updateTime(Ji(o.updateTime)):o.exists!==void 0?Ui.exists(o.exists):Ui.none()})(e.currentDocument):Ui.none(),i=e.updateTransforms?e.updateTransforms.map((s=>(function(l,d){let h=null;if("setToServerValue"in d)Ze(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),h=new dd;else if("appendMissingElements"in d){const v=d.appendMissingElements.values||[];h=new Iu(v)}else if("removeAllFromArray"in d){const v=d.removeAllFromArray.values||[];h=new hd(v)}else"increment"in d?h=new Tf(l,d.increment):qe(16584,{proto:d});const p=An.fromServerFormat(d.fieldPath);return new KT(p,h)})(n,s))):[];if(e.update){e.update.name;const s=yu(n,e.update.name),o=new Vi({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(h){const p=h.fieldPaths||[];return new ps(p.map((v=>An.fromServerFormat(v))))})(e.updateMask);return new sa(s,o,l,t,i)}return new Nd(s,o,t,i)}if(e.delete){const s=yu(n,e.delete);return new t_(s,t)}if(e.verify){const s=yu(n,e.verify);return new A2(s,t)}return qe(1463,{proto:e})}function x7(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map((t=>(function(s,o){let l=s.updateTime?Ji(s.updateTime):Ji(o);return l.isEqual(Xe.min())&&(l=Ji(o)),new a7(l,s.transformResults||[])})(t,e)))):[]}function O2(n,e){return{documents:[D2(n,e.path)]}}function U2(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=D2(n,s);const o=(function(p){if(p.length!==0)return z2(tn.create(p,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const l=(function(p){if(p.length!==0)return p.map((v=>(function(b){return{field:Vc(b.field),direction:S7(b.dir)}})(v)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const d=y0(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:s}}function F2(n){let e=L2(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){Ze(i===1,65062);const v=t.from[0];v.allDescendants?s=v.collectionId:e=e.child(v.collectionId)}let o=[];t.where&&(o=(function(x){const b=B2(x);return b instanceof tn&&GT(b)?b.getFilters():[b]})(t.where));let l=[];t.orderBy&&(l=(function(x){return x.map((b=>(function(P){return new Qp(Oc(P.field),(function(H){switch(H){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(b)))})(t.orderBy));let d=null;t.limit&&(d=(function(x){let b;return b=typeof x=="object"?x.value:x,jg(b)?null:b})(t.limit));let h=null;t.startAt&&(h=(function(x){const b=!!x.before,A=x.values||[];return new ud(A,b)})(t.startAt));let p=null;return t.endAt&&(p=(function(x){const b=!x.before,A=x.values||[];return new ud(A,b)})(t.endAt)),f2(e,s,l,o,d,"F",h,p)}function w7(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return qe(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function B2(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Oc(t.unaryFilter.field);return Lt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=Oc(t.unaryFilter.field);return Lt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Oc(t.unaryFilter.field);return Lt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Oc(t.unaryFilter.field);return Lt.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return qe(61313);default:return qe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Lt.create(Oc(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return qe(58110);default:return qe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return tn.create(t.compositeFilter.filters.map((i=>B2(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return qe(1026)}})(t.compositeFilter.op))})(n):qe(30097,{filter:n})}function S7(n){return p7[n]}function b7(n){return g7[n]}function C7(n){return _7[n]}function Vc(n){return{fieldPath:n.canonicalString()}}function Oc(n){return An.fromServerFormat(n.fieldPath)}function z2(n){return n instanceof Lt?(function(t){if(t.op==="=="){if(MI(t.value))return{unaryFilter:{field:Vc(t.field),op:"IS_NAN"}};if(RI(t.value))return{unaryFilter:{field:Vc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(MI(t.value))return{unaryFilter:{field:Vc(t.field),op:"IS_NOT_NAN"}};if(RI(t.value))return{unaryFilter:{field:Vc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vc(t.field),op:b7(t.op),value:t.value}}})(n):n instanceof tn?(function(t){const i=t.getFilters().map((s=>z2(s)));return i.length===1?i[0]:{compositeFilter:{op:C7(t.op),filters:i}}})(n):qe(54877,{filter:n})}function I7(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function q2(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,t,i,s,o=Xe.min(),l=Xe.min(),d=Hn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d,this.expectedCount=h}withSequenceNumber(e){return new zo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e){this.yt=e}}function A7(n,e){let t;if(e.document)t=T7(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Ve.fromSegments(e.noDocument.path),s=Nu(e.noDocument.readTime);t=Vn.newNoDocument(i,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return qe(56709);{const i=Ve.fromSegments(e.unknownDocument.path),s=Nu(e.unknownDocument.version);t=Vn.newUnknownDocument(i,s)}}return e.readTime&&t.setReadTime((function(s){const o=new en(s[0],s[1]);return Xe.fromTimestamp(o)})(e.readTime)),t}function YI(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ng(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(o,l){return{name:eg(o,l.key),fields:l.data.value.mapValue.fields,updateTime:fd(o,l.version.toTimestamp()),createTime:fd(o,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Au(e.version)};else{if(!e.isUnknownDocument())return qe(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Au(e.version)}}return i}function ng(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Au(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Nu(n){const e=new en(n.seconds,n.nanoseconds);return Xe.fromTimestamp(e)}function lu(n,e){const t=(e.baseMutations||[]).map((o=>E0(n.yt,o)));for(let o=0;o<e.mutations.length-1;++o){const l=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const d=e.mutations[o+1];l.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const i=e.mutations.map((o=>E0(n.yt,o))),s=en.fromMillis(e.localWriteTimeMs);return new WT(e.batchId,s,t,i)}function Fh(n){const e=Nu(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Nu(n.lastLimboFreeSnapshotVersion):Xe.min();let i;return i=(function(o){return o.documents!==void 0})(n.query)?(function(o){const l=o.documents.length;return Ze(l===1,1966,{count:l}),zs(Qg(L2(o.documents[0])))})(n.query):(function(o){return zs(F2(o))})(n.query),new zo(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Hn.fromBase64String(n.resumeToken))}function H2(n,e){const t=Au(e.snapshotVersion),i=Au(e.lastLimboFreeSnapshotVersion);let s;s=$p(e.target)?O2(n.yt,e.target):U2(n.yt,e.target).ft;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Cu(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:s}}function j2(n){const e=F2({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?_0(e,e.limit,"L"):e}function Ev(n,e){return new JT(e.largestBatchId,E0(n.yt,e.overlayMutation))}function JI(n,e){const t=e.path.lastSegment();return[n,Fi(e.path.popLast()),t]}function ZI(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Au(i.readTime),documentKey:Fi(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N7{getBundleMetadata(e,t){return QI(e).get(t).next((i=>{if(i)return(function(o){return{id:o.bundleId,createTime:Nu(o.createTime),version:o.version}})(i)}))}saveBundleMetadata(e,t){return QI(e).put((function(s){return{bundleId:s.id,createTime:Au(Ji(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return $I(e).get(t).next((i=>{if(i)return(function(o){return{name:o.name,query:j2(o.bundledQuery),readTime:Nu(o.readTime)}})(i)}))}saveNamedQuery(e,t){return $I(e).put((function(s){return{name:s.name,readTime:Au(Ji(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function QI(n){return ri(n,Kg)}function $I(n){return ri(n,Wg)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new n_(e,i)}getOverlay(e,t){return Sh(e).get(JI(this.userId,t)).next((i=>i?Ev(this.serializer,i):null))}getOverlays(e,t){const i=io();return ie.forEach(t,(s=>this.getOverlay(e,s).next((o=>{o!==null&&i.set(s,o)})))).next((()=>i))}saveOverlays(e,t,i){const s=[];return i.forEach(((o,l)=>{const d=new JT(t,l);s.push(this.St(e,d))})),ie.waitFor(s)}removeOverlaysForBatchId(e,t,i){const s=new Set;t.forEach((l=>s.add(Fi(l.getCollectionPath()))));const o=[];return s.forEach((l=>{const d=IDBKeyRange.bound([this.userId,l,i],[this.userId,l,i+1],!1,!0);o.push(Sh(e).Z(l0,d))})),ie.waitFor(o)}getOverlaysForCollection(e,t,i){const s=io(),o=Fi(t),l=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Sh(e).J(l0,l).next((d=>{for(const h of d){const p=Ev(this.serializer,h);s.set(p.getKey(),p)}return s}))}getOverlaysForCollectionGroup(e,t,i,s){const o=io();let l;const d=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Sh(e).ee({index:jR,range:d},((h,p,v)=>{const x=Ev(this.serializer,p);o.size()<s||x.largestBatchId===l?(o.set(x.getKey(),x),l=x.largestBatchId):v.done()})).next((()=>o))}St(e,t){return Sh(e).put((function(s,o,l){const[d,h,p]=JI(o,l.mutation.key);return{userId:o,collectionPath:h,documentId:p,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:tg(s.yt,l.mutation)}})(this.serializer,this.userId,t))}}function Sh(n){return ri(n,Yg)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R7{bt(e){return ri(e,UT)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t==null?void 0:t.value;return i?Hn.fromUint8Array(i):Hn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(bn(e.integerValue));else if("doubleValue"in e){const i=bn(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),hf(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=Jo(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Zo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?i2(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Zg(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):qe(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const s of Object.keys(i))this.Ot(s,t),this.Ct(i[s],t)}kt(e,t){var l,d;const i=e.fields||{};this.Ft(t,53);const s=ad,o=((d=(l=i[s].arrayValue)==null?void 0:l.values)==null?void 0:d.length)||0;this.Ft(t,15),t.Mt(bn(o)),this.Ot(s,t),this.Ct(i[s],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const s of i)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),Ve.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}uu.Kt=new uu;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nc=255;function M7(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function XI(n){const e=64-(function(i){let s=0;for(let o=0;o<8;++o){const l=M7(255&i[o]);if(s+=l,l!==8)break}return s})(n);return Math.ceil(e/8)}class P7{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),i=XI(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),i=XI(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(Nc),this.sn(255)}_n(){this.an(Nc),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(o){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,o,!1),new Uint8Array(l.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let s=1;s<t.length;++s)t[s]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Nc?(this.sn(Nc),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Nc?(this.an(Nc),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const s=new Uint8Array(i);s.set(this.buffer),this.buffer=s}}class k7{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class D7{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class bh{constructor(){this.cn=new P7,this.ln=new k7(this.cn),this.hn=new D7(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,t,i,s){this.Tn=e,this.In=t,this.En=i,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new cu(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:Sp(this.En),directionalValue:Sp(this.dn),orderedDocumentKey:Sp(t),documentKey:i.path.toArray()}}Vn(e,t,i){const s=this.Rn(e,t,i);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Ga(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=eA(n.En,e.En),t!==0?t:(t=eA(n.dn,e.dn),t!==0?t:Ve.comparator(n.In,e.In)))}function eA(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Sp(n){return UN()?(function(t){let i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(t[s]);return i})(n):n}function tA(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(n)}class nA{constructor(e){this.mn=new sn(((t,i)=>An.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Ze(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=r0(e);if(t!==void 0&&!this.wn(t))return!1;const i=su(e);let s=new Set,o=0,l=0;for(;o<i.length&&this.wn(i[o]);++o)s=s.add(i[o].fieldPath.canonicalString());if(o===i.length)return!0;if(this.mn.size>0){const d=this.mn.getIterator().getNext();if(!s.has(d.field.canonicalString())){const h=i[o];if(!this.Sn(d,h)||!this.bn(this.fn[l++],h))return!1}++o}for(;o<i.length;++o){const d=i[o];if(l>=this.fn.length||!this.bn(this.fn[l++],d))return!1}return!0}Dn(){if(this.pn)return null;let e=new sn(An.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new gp(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new gp(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new gp(i.field,i.dir==="asc"?0:1)));return new Kp(Kp.UNKNOWN_ID,this.collectionId,t,df.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K2(n){var t,i;if(Ze(n instanceof Lt||n instanceof tn,20012),n instanceof Lt){if(n instanceof h2){const s=((i=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:i.map((o=>Lt.create(n.field,"==",o))))||[];return tn.create(s,"or")}return n}const e=n.filters.map((s=>K2(s)));return tn.create(e,n.op)}function L7(n){if(n.getFilters().length===0)return[];const e=S0(K2(n));return Ze(W2(e),7391),x0(e)||w0(e)?[e]:e.getFilters()}function x0(n){return n instanceof Lt}function w0(n){return n instanceof tn&&GT(n)}function W2(n){return x0(n)||w0(n)||(function(t){if(t instanceof tn&&f0(t)){for(const i of t.getFilters())if(!x0(i)&&!w0(i))return!1;return!0}return!1})(n)}function S0(n){if(Ze(n instanceof Lt||n instanceof tn,34018),n instanceof Lt)return n;if(n.filters.length===1)return S0(n.filters[0]);const e=n.filters.map((i=>S0(i)));let t=tn.create(e,n.op);return t=ig(t),W2(t)?t:(Ze(t instanceof tn,64498),Ze(cd(t),40251),Ze(t.filters.length>1,57927),t.filters.reduce(((i,s)=>$T(i,s))))}function $T(n,e){let t;return Ze(n instanceof Lt||n instanceof tn,38388),Ze(e instanceof Lt||e instanceof tn,25473),t=n instanceof Lt?e instanceof Lt?(function(s,o){return tn.create([s,o],"and")})(n,e):iA(n,e):e instanceof Lt?iA(e,n):(function(s,o){if(Ze(s.filters.length>0&&o.filters.length>0,48005),cd(s)&&cd(o))return u2(s,o.getFilters());const l=f0(s)?s:o,d=f0(s)?o:s,h=l.filters.map((p=>$T(p,d)));return tn.create(h,"or")})(n,e),ig(t)}function iA(n,e){if(cd(e))return u2(e,n.getFilters());{const t=e.filters.map((i=>$T(n,i)));return tn.create(t,"or")}}function ig(n){if(Ze(n instanceof Lt||n instanceof tn,11850),n instanceof Lt)return n;const e=n.getFilters();if(e.length===1)return ig(e[0]);if(a2(n))return n;const t=e.map((s=>ig(s))),i=[];return t.forEach((s=>{s instanceof Lt?i.push(s):s instanceof tn&&(s.op===n.op?i.push(...s.filters):i.push(s))})),i.length===1?i[0]:tn.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(){this.Cn=new XT}addToCollectionParentIndex(e,t){return this.Cn.add(t),ie.resolve()}getCollectionParents(e,t){return ie.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ie.resolve()}deleteFieldIndex(e,t){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,t){return ie.resolve()}getDocumentsMatchingTarget(e,t){return ie.resolve(null)}getIndexType(e,t){return ie.resolve(0)}getFieldIndexes(e,t){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,t){return ie.resolve(Gs.min())}getMinOffsetFromCollectionGroup(e,t){return ie.resolve(Gs.min())}updateCollectionGroup(e,t,i){return ie.resolve()}updateIndexEntries(e,t){return ie.resolve()}}class XT{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new sn(Kt.comparator),o=!s.has(i);return this.index[t]=s.add(i),o}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new sn(Kt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sA="IndexedDbIndexManager",np=new Uint8Array(0);class O7{constructor(e,t){this.databaseId=t,this.vn=new XT,this.Fn=new ia((i=>Cu(i)),((i,s)=>Df(i,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const o={collectionId:i,parent:Fi(s)};return rA(e).put(o)}return ie.resolve()}getCollectionParents(e,t){const i=[],s=IDBKeyRange.bound([t,""],[MR(t),""],!1,!0);return rA(e).J(s).next((o=>{for(const l of o){if(l.collectionId!==t)break;i.push(no(l.parent))}return i}))}addFieldIndex(e,t){const i=Ch(e),s=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((h=>[h.fieldPath.canonicalString(),h.kind]))}})(t);delete s.indexId;const o=i.add(s);if(t.indexState){const l=Mc(e);return o.next((d=>{l.put(ZI(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const i=Ch(e),s=Mc(e),o=Rc(e);return i.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Ch(e),i=Rc(e),s=Mc(e);return t.Z().next((()=>i.Z())).next((()=>s.Z()))}createTargetIndexes(e,t){return ie.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((s=>{if(s===0||s===1){const o=new nA(i).Dn();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const i=Rc(e);let s=!0;const o=new Map;return ie.forEach(this.Mn(t),(l=>this.xn(e,l).next((d=>{s&&(s=!!d),o.set(l,d)})))).next((()=>{if(s){let l=vt();const d=[];return ie.forEach(o,((h,p)=>{Ae(sA,`Using index ${(function(Q){return`id=${Q.indexId}|cg=${Q.collectionGroup}|f=${Q.fields.map((he=>`${he.fieldPath}:${he.kind}`)).join(",")}`})(h)} to execute ${Cu(t)}`);const v=(function(Q,he){const fe=r0(he);if(fe===void 0)return null;for(const Y of Xp(Q,fe.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null})(p,h),x=(function(Q,he){const fe=new Map;for(const Y of su(he))for(const k of Xp(Q,Y.fieldPath))switch(k.op){case"==":case"in":fe.set(Y.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return fe.set(Y.fieldPath.canonicalString(),k.value),Array.from(fe.values())}return null})(p,h),b=(function(Q,he){const fe=[];let Y=!0;for(const k of su(he)){const B=k.kind===0?VI(Q,k.fieldPath,Q.startAt):OI(Q,k.fieldPath,Q.startAt);fe.push(B.value),Y&&(Y=B.inclusive)}return new ud(fe,Y)})(p,h),A=(function(Q,he){const fe=[];let Y=!0;for(const k of su(he)){const B=k.kind===0?OI(Q,k.fieldPath,Q.endAt):VI(Q,k.fieldPath,Q.endAt);fe.push(B.value),Y&&(Y=B.inclusive)}return new ud(fe,Y)})(p,h),P=this.On(h,p,b),F=this.On(h,p,A),H=this.Nn(h,p,x),X=this.Bn(h.indexId,v,P,b.inclusive,F,A.inclusive,H);return ie.forEach(X,(re=>i.Y(re,t.limit).next((Q=>{Q.forEach((he=>{const fe=Ve.fromSegments(he.documentKey);l.has(fe)||(l=l.add(fe),d.push(fe))}))}))))})).next((()=>d))}return ie.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=L7(tn.create(e.filters,"and")).map((i=>p0(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,s,o,l,d){const h=(t!=null?t.length:1)*Math.max(i.length,o.length),p=h/(t!=null?t.length:1),v=[];for(let x=0;x<h;++x){const b=t?this.Ln(t[x/p]):np,A=this.kn(e,b,i[x%p],s),P=this.qn(e,b,o[x%p],l),F=d.map((H=>this.kn(e,b,H,!0)));v.push(...this.createRange(A,P,F))}return v}kn(e,t,i,s){const o=new cu(e,Ve.empty(),t,i);return s?o:o.An()}qn(e,t,i,s){const o=new cu(e,Ve.empty(),t,i);return s?o.An():o}xn(e,t){const i=new nA(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((o=>{let l=null;for(const d of o)i.yn(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l}))}getIndexType(e,t){let i=2;const s=this.Mn(t);return ie.forEach(s,(o=>this.xn(e,o).next((l=>{l?i!==0&&l.fields.length<(function(h){let p=new sn(An.comparator),v=!1;for(const x of h.filters)for(const b of x.getFlattenedFilters())b.field.isKeyField()||(b.op==="array-contains"||b.op==="array-contains-any"?v=!0:p=p.add(b.field));for(const x of h.orderBy)x.field.isKeyField()||(p=p.add(x.field));return p.size+(v?1:0)})(o)&&(i=1):i=0})))).next((()=>(function(l){return l.limit!==null})(t)&&s.length>1&&i===2?1:i))}Qn(e,t){const i=new bh;for(const s of su(e)){const o=t.data.field(s.fieldPath);if(o==null)return null;const l=i.Pn(s.kind);uu.Kt.Dt(o,l)}return i.un()}Ln(e){const t=new bh;return uu.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new bh;return uu.Kt.Dt(yf(this.databaseId,t),i.Pn((function(o){const l=su(o);return l.length===0?0:l[l.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let s=[];s.push(new bh);let o=0;for(const l of su(e)){const d=i[o++];for(const h of s)if(this.Un(t,l.fieldPath)&&vf(d))s=this.Kn(s,l,d);else{const p=h.Pn(l.kind);uu.Kt.Dt(d,p)}}return this.Wn(s)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const s=[...e],o=[];for(const l of i.arrayValue.values||[])for(const d of s){const h=new bh;h.seed(d.un()),uu.Kt.Dt(l,h.Pn(t.kind)),o.push(h)}return o}Un(e,t){return!!e.filters.find((i=>i instanceof Lt&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Ch(e),s=Mc(e);return(t?i.J(a0,IDBKeyRange.bound(t,t)):i.J()).next((o=>{const l=[];return ie.forEach(o,(d=>s.get([d.indexId,this.uid]).next((h=>{l.push((function(v,x){const b=x?new df(x.sequenceNumber,new Gs(Nu(x.readTime),new Ve(no(x.documentKey)),x.largestBatchId)):df.empty(),A=v.fields.map((([P,F])=>new gp(An.fromServerFormat(P),F)));return new Kp(v.indexId,v.collectionGroup,A,b)})(d,h))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,s)=>{const o=i.indexState.sequenceNumber-s.indexState.sequenceNumber;return o!==0?o:ut(i.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const s=Ch(e),o=Mc(e);return this.Gn(e).next((l=>s.J(a0,IDBKeyRange.bound(t,t)).next((d=>ie.forEach(d,(h=>o.put(ZI(h.indexId,this.uid,l,i))))))))}updateIndexEntries(e,t){const i=new Map;return ie.forEach(t,((s,o)=>{const l=i.get(s.collectionGroup);return(l?ie.resolve(l):this.getFieldIndexes(e,s.collectionGroup)).next((d=>(i.set(s.collectionGroup,d),ie.forEach(d,(h=>this.zn(e,s,h).next((p=>{const v=this.jn(o,h);return p.isEqual(v)?ie.resolve():this.Jn(e,o,h,p,v)})))))))}))}Hn(e,t,i,s){return Rc(e).put(s.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,s){return Rc(e).delete(s.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const s=Rc(e);let o=new sn(Ga);return s.ee({index:HR,range:IDBKeyRange.only([i.indexId,this.uid,Sp(this.$n(i,t))])},((l,d)=>{o=o.add(new cu(i.indexId,t,tA(d.arrayValue),tA(d.directionalValue)))})).next((()=>o))}jn(e,t){let i=new sn(Ga);const s=this.Qn(t,e);if(s==null)return i;const o=r0(t);if(o!=null){const l=e.data.field(o.fieldPath);if(vf(l))for(const d of l.arrayValue.values||[])i=i.add(new cu(t.indexId,e.key,this.Ln(d),s))}else i=i.add(new cu(t.indexId,e.key,np,s));return i}Jn(e,t,i,s,o){Ae(sA,"Updating index entries for document '%s'",t.key);const l=[];return(function(h,p,v,x,b){const A=h.getIterator(),P=p.getIterator();let F=Ac(A),H=Ac(P);for(;F||H;){let X=!1,re=!1;if(F&&H){const Q=v(F,H);Q<0?re=!0:Q>0&&(X=!0)}else F!=null?re=!0:X=!0;X?(x(H),H=Ac(P)):re?(b(F),F=Ac(A)):(F=Ac(A),H=Ac(P))}})(s,o,Ga,(d=>{l.push(this.Hn(e,t,i,d))}),(d=>{l.push(this.Yn(e,t,i,d))})),ie.waitFor(l)}Gn(e){let t=1;return Mc(e).ee({index:GR,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,s,o)=>{o.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((l,d)=>Ga(l,d))).filter(((l,d,h)=>!d||Ga(l,h[d-1])!==0));const s=[];s.push(e);for(const l of i){const d=Ga(l,e),h=Ga(l,t);if(d===0)s[0]=e.An();else if(d>0&&h<0)s.push(l),s.push(l.An());else if(h>0)break}s.push(t);const o=[];for(let l=0;l<s.length;l+=2){if(this.Zn(s[l],s[l+1]))return[];const d=s[l].Vn(this.uid,np,Ve.empty()),h=s[l+1].Vn(this.uid,np,Ve.empty());o.push(IDBKeyRange.bound(d,h))}return o}Zn(e,t){return Ga(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(oA)}getMinOffset(e,t){return ie.mapArray(this.Mn(t),(i=>this.xn(e,i).next((s=>s||qe(44426))))).next(oA)}}function rA(n){return ri(n,pf)}function Rc(n){return ri(n,Yh)}function Ch(n){return ri(n,OT)}function Mc(n){return ri(n,Wh)}function oA(n){Ze(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const s=n[i].indexState.offset;DT(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Gs(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Y2=41943040;class ki{static withCacheSize(e){return new ki(e,ki.DEFAULT_COLLECTION_PERCENTILE,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(n,e,t){const i=n.store(Cr),s=n.store(id),o=[],l=IDBKeyRange.only(t.batchId);let d=0;const h=i.ee({range:l},((v,x,b)=>(d++,b.delete())));o.push(h.next((()=>{Ze(d===1,47070,{batchId:t.batchId})})));const p=[];for(const v of t.mutations){const x=BR(e,v.key.path,t.batchId);o.push(s.delete(x)),p.push(v.key)}return ie.waitFor(o).next((()=>p))}function sg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw qe(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ki.DEFAULT_COLLECTION_PERCENTILE=10,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ki.DEFAULT=new ki(Y2,ki.DEFAULT_COLLECTION_PERCENTILE,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ki.DISABLED=new ki(-1,0,0);class i_{constructor(e,t,i,s){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=s,this.Xn={}}static wt(e,t,i,s){Ze(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new i_(o,t,i,s)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ha(e).ee({index:fu,range:i},((s,o,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,i,s){const o=Uc(e),l=Ha(e);return l.add({}).next((d=>{Ze(typeof d=="number",49019);const h=new WT(d,t,i,s),p=(function(A,P,F){const H=F.baseMutations.map((re=>tg(A.yt,re))),X=F.mutations.map((re=>tg(A.yt,re)));return{userId:P,batchId:F.batchId,localWriteTimeMs:F.localWriteTime.toMillis(),baseMutations:H,mutations:X}})(this.serializer,this.userId,h),v=[];let x=new sn(((b,A)=>ut(b.canonicalString(),A.canonicalString())));for(const b of s){const A=BR(this.userId,b.key.path,d);x=x.add(b.key.path.popLast()),v.push(l.put(p)),v.push(o.put(A,pz))}return x.forEach((b=>{v.push(this.indexManager.addToCollectionParentIndex(e,b))})),e.addOnCommittedListener((()=>{this.Xn[d]=h.keys()})),ie.waitFor(v).next((()=>h))}))}lookupMutationBatch(e,t){return Ha(e).get(t).next((i=>i?(Ze(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),lu(this.serializer,i)):null))}er(e,t){return this.Xn[t]?ie.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const s=i.keys();return this.Xn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=IDBKeyRange.lowerBound([this.userId,i]);let o=null;return Ha(e).ee({index:fu,range:s},((l,d,h)=>{d.userId===this.userId&&(Ze(d.batchId>=i,47524,{tr:i}),o=lu(this.serializer,d)),h.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=gu;return Ha(e).ee({index:fu,range:t,reverse:!0},((s,o,l)=>{i=o.batchId,l.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,gu],[this.userId,Number.POSITIVE_INFINITY]);return Ha(e).J(fu,t).next((i=>i.map((s=>lu(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=_p(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=[];return Uc(e).ee({range:s},((l,d,h)=>{const[p,v,x]=l,b=no(v);if(p===this.userId&&t.path.isEqual(b))return Ha(e).get(x).next((A=>{if(!A)throw qe(61480,{nr:l,batchId:x});Ze(A.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:A.userId,batchId:x}),o.push(lu(this.serializer,A))}));h.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new sn(ut);const s=[];return t.forEach((o=>{const l=_p(this.userId,o.path),d=IDBKeyRange.lowerBound(l),h=Uc(e).ee({range:d},((p,v,x)=>{const[b,A,P]=p,F=no(A);b===this.userId&&o.path.isEqual(F)?i=i.add(P):x.done()}));s.push(h)})),ie.waitFor(s).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1,o=_p(this.userId,i),l=IDBKeyRange.lowerBound(o);let d=new sn(ut);return Uc(e).ee({range:l},((h,p,v)=>{const[x,b,A]=h,P=no(b);x===this.userId&&i.isPrefixOf(P)?P.length===s&&(d=d.add(A)):v.done()})).next((()=>this.rr(e,d)))}rr(e,t){const i=[],s=[];return t.forEach((o=>{s.push(Ha(e).get(o).next((l=>{if(l===null)throw qe(35274,{batchId:o});Ze(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:o}),i.push(lu(this.serializer,l))})))})),ie.waitFor(s).next((()=>i))}removeMutationBatch(e,t){return J2(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),ie.forEach(i,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ie.resolve();const i=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),s=[];return Uc(e).ee({range:i},((o,l,d)=>{if(o[0]===this.userId){const h=no(o[1]);s.push(h)}else d.done()})).next((()=>{Ze(s.length===0,56720,{sr:s.map((o=>o.canonicalString()))})}))}))}containsKey(e,t){return Z2(e,this.userId,t)}_r(e){return Q2(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:gu,lastStreamToken:""}))}}function Z2(n,e,t){const i=_p(e,t.path),s=i[1],o=IDBKeyRange.lowerBound(i);let l=!1;return Uc(n).ee({range:o,X:!0},((d,h,p)=>{const[v,x,b]=d;v===e&&x===s&&(l=!0),p.done()})).next((()=>l))}function Ha(n){return ri(n,Cr)}function Uc(n){return ri(n,id)}function Q2(n){return ri(n,ff)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ru(0)}static cr(){return new Ru(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U7{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Ru(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Xe.fromTimestamp(new en(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((s=>(s.highestListenSequenceNumber=t,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Pc(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Ze(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let s=0;const o=[];return Pc(e).ee(((l,d)=>{const h=Fh(d);h.sequenceNumber<=t&&i.get(h.targetId)===null&&(s++,o.push(this.removeTargetData(e,h)))})).next((()=>ie.waitFor(o))).next((()=>s))}forEachTarget(e,t){return Pc(e).ee(((i,s)=>{const o=Fh(s);t(o)}))}lr(e){return lA(e).get(Jp).next((t=>(Ze(t!==null,2888),t)))}hr(e,t){return lA(e).put(Jp,t)}Pr(e,t){return Pc(e).put(H2(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Cu(t),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let o=null;return Pc(e).ee({range:s,index:qR},((l,d,h)=>{const p=Fh(d);Df(t,p.target)&&(o=p,h.done())})).next((()=>o))}addMatchingKeys(e,t,i){const s=[],o=Ja(e);return t.forEach((l=>{const d=Fi(l.path);s.push(o.put({targetId:i,path:d})),s.push(this.referenceDelegate.addReference(e,i,l))})),ie.waitFor(s)}removeMatchingKeys(e,t,i){const s=Ja(e);return ie.forEach(t,(o=>{const l=Fi(o.path);return ie.waitFor([s.delete([i,l]),this.referenceDelegate.removeReference(e,i,o)])}))}removeMatchingKeysForTargetId(e,t){const i=Ja(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),s=Ja(e);let o=vt();return s.ee({range:i,X:!0},((l,d,h)=>{const p=no(l[1]),v=new Ve(p);o=o.add(v)})).next((()=>o))}containsKey(e,t){const i=Fi(t.path),s=IDBKeyRange.bound([i],[MR(i)],!1,!0);let o=0;return Ja(e).ee({index:VT,X:!0,range:s},(([l,d],h,p)=>{l!==0&&(o++,p.done())})).next((()=>o>0))}At(e,t){return Pc(e).get(t).next((i=>i?Fh(i):null))}}function Pc(n){return ri(n,sd)}function lA(n){return ri(n,_u)}function Ja(n){return ri(n,rd)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA="LruGarbageCollector",F7=1048576;function cA([n,e],[t,i]){const s=ut(n,t);return s===0?ut(e,i):s}class B7{constructor(e){this.Ir=e,this.buffer=new sn(cA),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();cA(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class $2{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ae(uA,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){_l(t)?Ae(uA,"Ignoring IndexedDB error during garbage collection: ",t):await gl(t)}await this.Vr(3e5)}))}}class z7{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return ie.resolve(ms.ce);const i=new B7(t);return this.mr.forEachTarget(e,(s=>i.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>i.Ar(s))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ae("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(aA)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aA):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,s,o,l,d,h,p;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),s=this.params.maximumSequenceNumbersToCollect):s=x,l=Date.now(),this.nthSequenceNumber(e,s)))).next((x=>(i=x,d=Date.now(),this.removeTargets(e,i,t)))).next((x=>(o=x,h=Date.now(),this.removeOrphanedDocuments(e,i)))).next((x=>(p=Date.now(),Dc()<=bt.DEBUG&&Ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-v}ms
	Determined least recently used ${s} in `+(d-l)+`ms
	Removed ${o} targets in `+(h-d)+`ms
	Removed ${x} documents in `+(p-h)+`ms
Total Duration: ${p-v}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:x}))))}}function X2(n,e){return new z7(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q7{constructor(e,t){this.db=e,this.garbageCollector=X2(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,s)=>t(s)))}addReference(e,t,i){return ip(e,i)}removeReference(e,t,i){return ip(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return ip(e,t)}br(e,t){return(function(s,o){let l=!1;return Q2(s).te((d=>Z2(s,d,o).next((h=>(h&&(l=!0),ie.resolve(!h)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.Sr(e,((l,d)=>{if(d<=t){const h=this.br(e,l).next((p=>{if(!p)return o++,i.getEntry(e,l).next((()=>(i.removeEntry(l,Xe.min()),Ja(e).delete((function(x){return[0,Fi(x.path)]})(l)))))}));s.push(h)}})).next((()=>ie.waitFor(s))).next((()=>i.apply(e))).next((()=>o))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return ip(e,t)}Sr(e,t){const i=Ja(e);let s,o=ms.ce;return i.ee({index:VT},(([l,d],{path:h,sequenceNumber:p})=>{l===0?(o!==ms.ce&&t(new Ve(no(s)),o),o=p,s=h):o=ms.ce})).next((()=>{o!==ms.ce&&t(new Ve(no(s)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ip(n,e){return Ja(n).put((function(i,s){return{targetId:0,path:Fi(i.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(){this.changes=new ia((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Vn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?ie.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G7{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return nu(e).put(i)}removeEntry(e,t,i){return nu(e).delete((function(o,l){const d=o.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],ng(l),d[d.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=Vn.newInvalidDocument(t);return nu(e).ee({index:yp,range:IDBKeyRange.only(Ih(t))},((s,o)=>{i=this.Cr(t,o)})).next((()=>i))}vr(e,t){let i={size:0,document:Vn.newInvalidDocument(t)};return nu(e).ee({index:yp,range:IDBKeyRange.only(Ih(t))},((s,o)=>{i={document:this.Cr(t,o),size:sg(o)}})).next((()=>i))}getEntries(e,t){let i=Fs();return this.Fr(e,t,((s,o)=>{const l=this.Cr(s,o);i=i.insert(s,l)})).next((()=>i))}Mr(e,t){let i=Fs(),s=new Nn(Ve.comparator);return this.Fr(e,t,((o,l)=>{const d=this.Cr(o,l);i=i.insert(o,d),s=s.insert(o,sg(l))})).next((()=>({documents:i,Or:s})))}Fr(e,t,i){if(t.isEmpty())return ie.resolve();let s=new sn(fA);t.forEach((h=>s=s.add(h)));const o=IDBKeyRange.bound(Ih(s.first()),Ih(s.last())),l=s.getIterator();let d=l.getNext();return nu(e).ee({index:yp,range:o},((h,p,v)=>{const x=Ve.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;d&&fA(d,x)<0;)i(d,null),d=l.getNext();d&&d.isEqual(x)&&(i(d,p),d=l.hasNext()?l.getNext():null),d?v.j(Ih(d)):v.done()})).next((()=>{for(;d;)i(d,null),d=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,i,s,o){const l=t.path,d=[l.popLast().toArray(),l.lastSegment(),ng(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],h=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return nu(e).J(IDBKeyRange.bound(d,h,!0)).next((p=>{o==null||o.incrementDocumentReadCount(p.length);let v=Fs();for(const x of p){const b=this.Cr(Ve.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);b.isFoundDocument()&&(Vf(t,b)||s.has(b.key))&&(v=v.insert(b.key,b))}return v}))}getAllFromCollectionGroup(e,t,i,s){let o=Fs();const l=hA(t,i),d=hA(t,Gs.max());return nu(e).ee({index:zR,range:IDBKeyRange.bound(l,d,!0)},((h,p,v)=>{const x=this.Cr(Ve.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);o=o.insert(x.key,x),o.size===s&&v.done()})).next((()=>o))}newChangeBuffer(e){return new H7(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return dA(e).get(o0).next((t=>(Ze(!!t,20021),t)))}Dr(e,t){return dA(e).put(o0,t)}Cr(e,t){if(t){const i=A7(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Xe.min())))return i}return Vn.newInvalidDocument(e)}}function tM(n){return new G7(n)}class H7 extends eM{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new ia((i=>i.toString()),((i,s)=>i.isEqual(s)))}applyChanges(e){const t=[];let i=0,s=new sn(((o,l)=>ut(o.canonicalString(),l.canonicalString())));return this.changes.forEach(((o,l)=>{const d=this.Br.get(o);if(t.push(this.Nr.removeEntry(e,o,d.readTime)),l.isValidDocument()){const h=YI(this.Nr.serializer,l);s=s.add(o.path.popLast());const p=sg(h);i+=p-d.size,t.push(this.Nr.addEntry(e,o,h))}else if(i-=d.size,this.trackRemovals){const h=YI(this.Nr.serializer,l.convertToNoDocument(Xe.min()));t.push(this.Nr.addEntry(e,o,h))}})),s.forEach((o=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.Nr.updateMetadata(e,i)),ie.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:s})=>(s.forEach(((o,l)=>{this.Br.set(o,{size:l,readTime:i.get(o).readTime})})),i)))}}function dA(n){return ri(n,mf)}function nu(n){return ri(n,Yp)}function Ih(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function hA(n,e){const t=e.documentKey.path.toArray();return[n,ng(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function fA(n,e){const t=n.path.toArray(),i=e.path.toArray();let s=0;for(let o=0;o<t.length-2&&o<i.length-2;++o)if(s=ut(t[o],i[o]),s)return s;return s=ut(t.length,i.length),s||(s=ut(t[t.length-2],i[i.length-2]),s||ut(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j7{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(i=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(i!==null&&$h(i.mutation,s,ps.empty(),en.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,vt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=vt()){const s=io();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,i).next((o=>{let l=Oh();return o.forEach(((d,h)=>{l=l.insert(d,h.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const i=io();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,vt())))}populateOverlays(e,t,i){const s=[];return i.forEach((o=>{t.has(o)||s.push(o)})),this.documentOverlayCache.getOverlays(e,s).next((o=>{o.forEach(((l,d)=>{t.set(l,d)}))}))}computeViews(e,t,i,s){let o=Fs();const l=Qh(),d=(function(){return Qh()})();return t.forEach(((h,p)=>{const v=i.get(p.key);s.has(p.key)&&(v===void 0||v.mutation instanceof sa)?o=o.insert(p.key,p):v!==void 0?(l.set(p.key,v.mutation.getFieldMask()),$h(v.mutation,p,v.mutation.getFieldMask(),en.now())):l.set(p.key,ps.empty())})),this.recalculateAndSaveOverlays(e,o).next((h=>(h.forEach(((p,v)=>l.set(p,v))),t.forEach(((p,v)=>d.set(p,new j7(v,l.get(p)??null)))),d)))}recalculateAndSaveOverlays(e,t){const i=Qh();let s=new Nn(((l,d)=>l-d)),o=vt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const d of l)d.keys().forEach((h=>{const p=t.get(h);if(p===null)return;let v=i.get(h)||ps.empty();v=d.applyToLocalView(p,v),i.set(h,v);const x=(s.get(d.batchId)||vt()).add(h);s=s.insert(d.batchId,x)}))})).next((()=>{const l=[],d=s.getReverseIterator();for(;d.hasNext();){const h=d.getNext(),p=h.key,v=h.value,x=T2();v.forEach((b=>{if(!o.has(b)){const A=C2(t.get(b),i.get(b));A!==null&&x.set(b,A),o=o.add(b)}})),l.push(this.documentOverlayCache.saveOverlays(e,p,x))}return ie.waitFor(l)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,s){return(function(l){return Ve.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):m2(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next((o=>{const l=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-o.size):ie.resolve(io());let d=nd,h=o;return l.next((p=>ie.forEach(p,((v,x)=>(d<x.largestBatchId&&(d=x.largestBatchId),o.get(v)?ie.resolve():this.remoteDocumentCache.getEntry(e,v).next((b=>{h=h.insert(v,b)}))))).next((()=>this.populateOverlays(e,p,o))).next((()=>this.computeViews(e,h,p,vt()))).next((v=>({batchId:d,changes:v2(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ve(t)).next((i=>{let s=Oh();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const o=t.collectionGroup;let l=Oh();return this.indexManager.getCollectionParents(e,o).next((d=>ie.forEach(d,(h=>{const p=(function(x,b){return new Lf(b,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,i,s).next((v=>{v.forEach(((x,b)=>{l=l.insert(x,b)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,s)))).next((l=>{o.forEach(((h,p)=>{const v=p.getKey();l.get(v)===null&&(l=l.insert(v,Vn.newInvalidDocument(v)))}));let d=Oh();return l.forEach(((h,p)=>{const v=o.get(h);v!==void 0&&$h(v.mutation,p,ps.empty(),en.now()),Vf(t,p)&&(d=d.insert(h,p))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ie.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Ji(s.createTime)}})(t)),ie.resolve()}getNamedQuery(e,t){return ie.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:j2(s.bundledQuery),readTime:Ji(s.readTime)}})(t)),ie.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W7{constructor(){this.overlays=new Nn(Ve.comparator),this.qr=new Map}getOverlay(e,t){return ie.resolve(this.overlays.get(t))}getOverlays(e,t){const i=io();return ie.forEach(t,(s=>this.getOverlay(e,s).next((o=>{o!==null&&i.set(s,o)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((s,o)=>{this.St(e,t,o)})),ie.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.qr.get(i);return s!==void 0&&(s.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(i)),ie.resolve()}getOverlaysForCollection(e,t,i){const s=io(),o=t.length+1,l=new Ve(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const h=d.getNext().value,p=h.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===o&&h.largestBatchId>i&&s.set(h.getKey(),h)}return ie.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let o=new Nn(((p,v)=>p-v));const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let v=o.get(p.largestBatchId);v===null&&(v=io(),o=o.insert(p.largestBatchId,v)),v.set(p.getKey(),p)}}const d=io(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((p,v)=>d.set(p,v))),!(d.size()>=s)););return ie.resolve(d)}St(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const l=this.qr.get(s.largestBatchId).delete(i.key);this.qr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new JT(t,i));let o=this.qr.get(t);o===void 0&&(o=vt(),this.qr.set(t,o)),this.qr.set(t,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y7{constructor(){this.sessionToken=Hn.EMPTY_BYTE_STRING}getSessionToken(e){return ie.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ie.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE{constructor(){this.Qr=new sn(pi.$r),this.Ur=new sn(pi.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new pi(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new pi(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new Ve(new Kt([])),i=new pi(t,e),s=new pi(t,e+1),o=[];return this.Ur.forEachInRange([i,s],(l=>{this.Gr(l),o.push(l.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ve(new Kt([])),i=new pi(t,e),s=new pi(t,e+1);let o=vt();return this.Ur.forEachInRange([i,s],(l=>{o=o.add(l.key)})),o}containsKey(e){const t=new pi(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class pi{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ve.comparator(e.key,t.key)||ut(e.Yr,t.Yr)}static Kr(e,t){return ut(e.Yr,t.Yr)||Ve.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J7{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new sn(pi.$r)}checkEmpty(e){return ie.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new WT(o,t,i,s);this.mutationQueue.push(l);for(const d of s)this.Zr=this.Zr.add(new pi(d.key,o)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return ie.resolve(l)}lookupMutationBatch(e,t){return ie.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.ei(i),o=s<0?0:s;return ie.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(this.mutationQueue.length===0?gu:this.tr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new pi(t,0),s=new pi(t,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([i,s],(l=>{const d=this.Xr(l.Yr);o.push(d)})),ie.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new sn(ut);return t.forEach((s=>{const o=new pi(s,0),l=new pi(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,l],(d=>{i=i.add(d.Yr)}))})),ie.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let o=i;Ve.isDocumentKey(o)||(o=o.child(""));const l=new pi(new Ve(o),0);let d=new sn(ut);return this.Zr.forEachWhile((h=>{const p=h.key.path;return!!i.isPrefixOf(p)&&(p.length===s&&(d=d.add(h.Yr)),!0)}),l),ie.resolve(this.ti(d))}ti(e){const t=[];return e.forEach((i=>{const s=this.Xr(i);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Ze(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return ie.forEach(t.mutations,(s=>{const o=new pi(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new pi(t,0),s=this.Zr.firstAfterOrEqual(i);return ie.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z7{constructor(e){this.ri=e,this.docs=(function(){return new Nn(Ve.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),o=s?s.size:0,l=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return ie.resolve(i?i.document.mutableCopy():Vn.newInvalidDocument(t))}getEntries(e,t){let i=Fs();return t.forEach((s=>{const o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():Vn.newInvalidDocument(s))})),ie.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let o=Fs();const l=t.path,d=new Ve(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(d);for(;h.hasNext();){const{key:p,value:{document:v}}=h.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||DT(LR(v),i)<=0||(s.has(v.key)||Vf(t,v))&&(o=o.insert(v.key,v.mutableCopy()))}return ie.resolve(o)}getAllFromCollectionGroup(e,t,i,s){qe(9500)}ii(e,t){return ie.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new Q7(this)}getSize(e){return ie.resolve(this.size)}}class Q7 extends eM{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(i)})),ie.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $7{constructor(e){this.persistence=e,this.si=new ia((t=>Cu(t)),Df),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.oi=0,this._i=new eE,this.targetCount=0,this.ai=Ru.ur()}forEachTarget(e,t){return this.si.forEach(((i,s)=>t(s))),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),ie.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Ru(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ie.resolve()}updateTargetData(e,t){return this.Pr(t),ie.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,t,i){let s=0;const o=[];return this.si.forEach(((l,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.si.delete(l),o.push(this.removeMatchingKeysForTargetId(e,d.targetId)),s++)})),ie.waitFor(o).next((()=>s))}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return ie.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),ie.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const s=this.persistence.referenceDelegate,o=[];return s&&t.forEach((l=>{o.push(s.markPotentiallyOrphaned(e,l))})),ie.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ie.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return ie.resolve(i)}containsKey(e,t){return ie.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,t){this.ui={},this.overlays={},this.ci=new ms(0),this.li=!1,this.li=!0,this.hi=new Y7,this.referenceDelegate=e(this),this.Pi=new $7(this),this.indexManager=new V7,this.remoteDocumentCache=(function(s){return new Z7(s)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new G2(t),this.Ii=new K7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new W7,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new J7(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){Ae("MemoryPersistence","Starting transaction:",e);const s=new X7(this.ci.next());return this.referenceDelegate.Ei(),i(s).next((o=>this.referenceDelegate.di(s).next((()=>o)))).toPromise().then((o=>(s.raiseOnCommittedEvent(),o)))}Ai(e,t){return ie.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class X7 extends OR{constructor(e){super(),this.currentSequenceNumber=e}}class s_{constructor(e){this.persistence=e,this.Ri=new eE,this.Vi=null}static mi(e){return new s_(e)}get fi(){if(this.Vi)return this.Vi;throw qe(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),ie.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),ie.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ie.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((o=>this.fi.add(o.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.fi,(i=>{const s=Ve.fromPath(i);return this.gi(e,s).next((o=>{o||t.removeEntry(s,Xe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ie.or([()=>ie.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class rg{constructor(e,t){this.persistence=e,this.pi=new ia((i=>Fi(i.path)),((i,s)=>i.isEqual(s))),this.garbageCollector=X2(this,t)}static mi(e,t){return new rg(e,t)}Ei(){}di(e){return ie.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return ie.forEach(this.pi,((i,s)=>this.br(e,i,s).next((o=>o?ie.resolve():t(s)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.ii(e,(l=>this.br(e,l,t).next((d=>{d||(i++,o.removeEntry(l,Xe.min()))})))).next((()=>o.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ie.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),ie.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),ie.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ie.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Tp(e.data.value)),t}br(e,t,i){return ie.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return ie.resolve(s!==void 0&&s>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(e){this.serializer=e}k(e,t,i,s){const o=new Hg("createOrUpgrade",t);i<1&&s>=1&&((function(h){h.createObjectStore(kf)})(e),(function(h){h.createObjectStore(ff,{keyPath:mz}),h.createObjectStore(Cr,{keyPath:SI,autoIncrement:!0}).createIndex(fu,bI,{unique:!0}),h.createObjectStore(id)})(e),mA(e),(function(h){h.createObjectStore(ru)})(e));let l=ie.resolve();return i<3&&s>=3&&(i!==0&&((function(h){h.deleteObjectStore(rd),h.deleteObjectStore(sd),h.deleteObjectStore(_u)})(e),mA(e)),l=l.next((()=>(function(h){const p=h.store(_u),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xe.min().toTimestamp(),targetCount:0};return p.put(Jp,v)})(o)))),i<4&&s>=4&&(i!==0&&(l=l.next((()=>(function(h,p){return p.store(Cr).J().next((x=>{h.deleteObjectStore(Cr),h.createObjectStore(Cr,{keyPath:SI,autoIncrement:!0}).createIndex(fu,bI,{unique:!0});const b=p.store(Cr),A=x.map((P=>b.put(P)));return ie.waitFor(A)}))})(e,o)))),l=l.next((()=>{(function(h){h.createObjectStore(od,{keyPath:wz})})(e)}))),i<5&&s>=5&&(l=l.next((()=>this.yi(o)))),i<6&&s>=6&&(l=l.next((()=>((function(h){h.createObjectStore(mf)})(e),this.wi(o))))),i<7&&s>=7&&(l=l.next((()=>this.Si(o)))),i<8&&s>=8&&(l=l.next((()=>this.bi(e,o)))),i<9&&s>=9&&(l=l.next((()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&s>=10&&(l=l.next((()=>this.Di(o)))),i<11&&s>=11&&(l=l.next((()=>{(function(h){h.createObjectStore(Kg,{keyPath:Sz})})(e),(function(h){h.createObjectStore(Wg,{keyPath:bz})})(e)}))),i<12&&s>=12&&(l=l.next((()=>{(function(h){const p=h.createObjectStore(Yg,{keyPath:Pz});p.createIndex(l0,kz,{unique:!1}),p.createIndex(jR,Dz,{unique:!1})})(e)}))),i<13&&s>=13&&(l=l.next((()=>(function(h){const p=h.createObjectStore(Yp,{keyPath:gz});p.createIndex(yp,_z),p.createIndex(zR,yz)})(e))).next((()=>this.Ci(e,o))).next((()=>e.deleteObjectStore(ru)))),i<14&&s>=14&&(l=l.next((()=>this.Fi(e,o)))),i<15&&s>=15&&(l=l.next((()=>(function(h){h.createObjectStore(OT,{keyPath:Cz,autoIncrement:!0}).createIndex(a0,Iz,{unique:!1}),h.createObjectStore(Wh,{keyPath:Az}).createIndex(GR,Nz,{unique:!1}),h.createObjectStore(Yh,{keyPath:Rz}).createIndex(HR,Mz,{unique:!1})})(e)))),i<16&&s>=16&&(l=l.next((()=>{t.objectStore(Wh).clear()})).next((()=>{t.objectStore(Yh).clear()}))),i<17&&s>=17&&(l=l.next((()=>{(function(h){h.createObjectStore(UT,{keyPath:Lz})})(e)}))),i<18&&s>=18&&UN()&&(l=l.next((()=>{t.objectStore(Wh).clear()})).next((()=>{t.objectStore(Yh).clear()}))),l}wi(e){let t=0;return e.store(ru).ee(((i,s)=>{t+=sg(s)})).next((()=>{const i={byteSize:t};return e.store(mf).put(o0,i)}))}yi(e){const t=e.store(ff),i=e.store(Cr);return t.J().next((s=>ie.forEach(s,(o=>{const l=IDBKeyRange.bound([o.userId,gu],[o.userId,o.lastAcknowledgedBatchId]);return i.J(fu,l).next((d=>ie.forEach(d,(h=>{Ze(h.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});const p=lu(this.serializer,h);return J2(e,o.userId,p).next((()=>{}))}))))}))))}Si(e){const t=e.store(rd),i=e.store(ru);return e.store(_u).get(Jp).next((s=>{const o=[];return i.ee(((l,d)=>{const h=new Kt(l),p=(function(x){return[0,Fi(x)]})(h);o.push(t.get(p).next((v=>v?ie.resolve():(x=>t.put({targetId:0,path:Fi(x),sequenceNumber:s.highestListenSequenceNumber}))(h))))})).next((()=>ie.waitFor(o)))}))}bi(e,t){e.createObjectStore(pf,{keyPath:xz});const i=t.store(pf),s=new XT,o=l=>{if(s.add(l)){const d=l.lastSegment(),h=l.popLast();return i.put({collectionId:d,parent:Fi(h)})}};return t.store(ru).ee({X:!0},((l,d)=>{const h=new Kt(l);return o(h.popLast())})).next((()=>t.store(id).ee({X:!0},(([l,d,h],p)=>{const v=no(d);return o(v.popLast())}))))}Di(e){const t=e.store(sd);return t.ee(((i,s)=>{const o=Fh(s),l=H2(this.serializer,o);return t.put(l)}))}Ci(e,t){const i=t.store(ru),s=[];return i.ee(((o,l)=>{const d=t.store(Yp),h=(function(x){return x.document?new Ve(Kt.fromString(x.document.name).popFirst(5)):x.noDocument?Ve.fromSegments(x.noDocument.path):x.unknownDocument?Ve.fromSegments(x.unknownDocument.path):qe(36783)})(l).path.toArray(),p={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};s.push(d.put(p))})).next((()=>ie.waitFor(s)))}Fi(e,t){const i=t.store(Cr),s=tM(this.serializer),o=new tE(s_.mi,this.serializer.yt);return i.J().next((l=>{const d=new Map;return l.forEach((h=>{let p=d.get(h.userId)??vt();lu(this.serializer,h).keys().forEach((v=>p=p.add(v))),d.set(h.userId,p)})),ie.forEach(d,((h,p)=>{const v=new gi(p),x=n_.wt(this.serializer,v),b=o.getIndexManager(v),A=i_.wt(v,this.serializer,b,o.referenceDelegate);return new nM(s,A,x,b).recalculateAndSaveOverlaysForDocumentKeys(new u0(t,ms.ce),h).next()}))}))}}function mA(n){n.createObjectStore(rd,{keyPath:Tz}).createIndex(VT,Ez,{unique:!0}),n.createObjectStore(sd,{keyPath:"targetId"}).createIndex(qR,vz,{unique:!0}),n.createObjectStore(_u)}const ja="IndexedDbPersistence",xv=18e5,wv=5e3,Sv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",t8="main";class nE{constructor(e,t,i,s,o,l,d,h,p,v,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=o,this.window=l,this.document=d,this.xi=p,this.Oi=v,this.Ni=x,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=b=>Promise.resolve(),!nE.v())throw new ke(ve.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new q7(this,s),this.$i=t+t8,this.serializer=new G2(h),this.Ui=new nl(this.$i,this.Ni,new e8(this.serializer)),this.hi=new R7,this.Pi=new U7(this.referenceDelegate,this.serializer),this.remoteDocumentCache=tM(this.serializer),this.Ii=new N7,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,v===!1&&qn(ja,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ke(ve.FAILED_PRECONDITION,Sv);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new ms(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>sp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(_l(e))return Ae(ja,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ae(ja,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Ah(e).get(Ic).next((t=>ie.resolve(this.es(t))))}ts(e){return sp(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,xv)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=ri(t,od);return i.J().next((s=>{const o=this.ss(s,xv),l=s.filter((d=>o.indexOf(d)===-1));return ie.forEach(l,(d=>i.delete(d.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?ie.resolve(!0):Ah(e).get(Ic).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,wv)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ke(ve.FAILED_PRECONDITION,Sv);return!1}}return!(!this.networkEnabled||!this.inForeground)||sp(e).J().next((i=>this.ss(i,wv).find((s=>{if(this.clientId!==s.clientId){const o=!this.networkEnabled&&s.networkEnabled,l=!this.inForeground&&s.inForeground,d=this.networkEnabled===s.networkEnabled;if(o||l&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ae(ja,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[kf,od],(e=>{const t=new u0(e,ms.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>sp(e).J().next((t=>this.ss(t,xv).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return i_.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new O7(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return n_.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){Ae(ja,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",o=(function(h){return h===18?Uz:h===17?JR:h===16?Oz:h===15?FT:h===14?YR:h===13?WR:h===12?Vz:h===11?KR:void qe(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,s,o,(d=>(l=new u0(d,this.ci?this.ci.next():ms.ce),t==="readwrite-primary"?this.Hi(l).next((h=>!!h||this.Yi(l))).next((h=>{if(!h)throw qn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ke(ve.FAILED_PRECONDITION,VR);return i(l)})).next((h=>this.Xi(l).next((()=>h)))):this.Is(l).next((()=>i(l)))))).then((d=>(l.raiseOnCommittedEvent(),d)))}Is(e){return Ah(e).get(Ic).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,wv)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ke(ve.FAILED_PRECONDITION,Sv)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ah(e).put(Ic,t)}static v(){return nl.v()}Zi(e){const t=Ah(e);return t.get(Ic).next((i=>this.es(i)?(Ae(ja,"Releasing primary lease."),t.delete(Ic)):ie.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(qn(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;ON()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const i=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return Ae(ja,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return qn(ja,"Failed to get zombied client id.",i),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){qn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ah(n){return ri(n,kf)}function sp(n){return ri(n,od)}function iM(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=s}static As(e,t){let i=vt(),s=vt();for(const o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new iE(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return ON()?8:UR(si())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,s){const o={result:null};return this.ys(e,t).next((l=>{o.result=l})).next((()=>{if(!o.result)return this.ws(e,t,s,i).next((l=>{o.result=l}))})).next((()=>{if(o.result)return;const l=new n8;return this.Ss(e,t,l).next((d=>{if(o.result=d,this.Vs)return this.bs(e,t,l,d.size)}))})).next((()=>o.result))}bs(e,t,i,s){return i.documentReadCount<this.fs?(Dc()<=bt.DEBUG&&Ae("QueryEngine","SDK will not create cache indexes for query:",Lc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ie.resolve()):(Dc()<=bt.DEBUG&&Ae("QueryEngine","Query:",Lc(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.gs*s?(Dc()<=bt.DEBUG&&Ae("QueryEngine","The SDK decides to create cache indexes for query:",Lc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zs(t))):ie.resolve())}ys(e,t){if(UI(t))return ie.resolve(null);let i=zs(t);return this.indexManager.getIndexType(e,i).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=_0(t,null,"F"),i=zs(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((o=>{const l=vt(...o);return this.ps.getDocuments(e,l).next((d=>this.indexManager.getMinOffset(e,i).next((h=>{const p=this.Ds(t,d);return this.Cs(t,p,l,h.readTime)?this.ys(e,_0(t,null,"F")):this.vs(e,p,t,h)}))))})))))}ws(e,t,i,s){return UI(t)||s.isEqual(Xe.min())?ie.resolve(null):this.ps.getDocuments(e,i).next((o=>{const l=this.Ds(t,o);return this.Cs(t,l,i,s)?ie.resolve(null):(Dc()<=bt.DEBUG&&Ae("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Lc(t)),this.vs(e,l,t,DR(s,nd)).next((d=>d)))}))}Ds(e,t){let i=new sn(_2(e));return t.forEach(((s,o)=>{Vf(e,o)&&(i=i.add(o))})),i}Cs(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(e,t,i){return Dc()<=bt.DEBUG&&Ae("QueryEngine","Using full collection scan to execute query:",Lc(t)),this.ps.getDocumentsMatchingQuery(e,t,Gs.min(),i)}vs(e,t,i,s){return this.ps.getDocumentsMatchingQuery(e,i,s).next((o=>(t.forEach((l=>{o=o.insert(l.key,l)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sE="LocalStore",i8=3e8;class s8{constructor(e,t,i,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new Nn(ut),this.xs=new ia((o=>Cu(o)),Df),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nM(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function rM(n,e,t,i){return new s8(n,e,t,i)}async function oM(n,e){const t=Ke(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next((o=>(s=o,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((o=>{const l=[],d=[];let h=vt();for(const p of s){l.push(p.batchId);for(const v of p.mutations)h=h.add(v.key)}for(const p of o){d.push(p.batchId);for(const v of p.mutations)h=h.add(v.key)}return t.localDocuments.getDocuments(i,h).next((p=>({Ls:p,removedBatchIds:l,addedBatchIds:d})))}))}))}function r8(n,e){const t=Ke(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=e.batch.keys(),o=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,h,p,v){const x=p.batch,b=x.keys();let A=ie.resolve();return b.forEach((P=>{A=A.next((()=>v.getEntry(h,P))).next((F=>{const H=p.docVersions.get(P);Ze(H!==null,48541),F.version.compareTo(H)<0&&(x.applyToRemoteDocument(F,p),F.isValidDocument()&&(F.setReadTime(p.commitVersion),v.addEntry(F)))}))})),A.next((()=>d.mutationQueue.removeMutationBatch(h,x)))})(t,i,e,o).next((()=>o.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let h=vt();for(let p=0;p<d.mutationResults.length;++p)d.mutationResults[p].transformResults.length>0&&(h=h.add(d.batch.mutations[p].key));return h})(e)))).next((()=>t.localDocuments.getDocuments(i,s)))}))}function aM(n){const e=Ke(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function o8(n,e){const t=Ke(n),i=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const d=[];e.targetChanges.forEach(((v,x)=>{const b=s.get(x);if(!b)return;d.push(t.Pi.removeMatchingKeys(o,v.removedDocuments,x).next((()=>t.Pi.addMatchingKeys(o,v.addedDocuments,x))));let A=b.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(x)!==null?A=A.withResumeToken(Hn.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):v.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(v.resumeToken,i)),s=s.insert(x,A),(function(F,H,X){return F.resumeToken.approximateByteSize()===0||H.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=i8?!0:X.addedDocuments.size+X.modifiedDocuments.size+X.removedDocuments.size>0})(b,A,v)&&d.push(t.Pi.updateTargetData(o,A))}));let h=Fs(),p=vt();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(o,v))})),d.push(a8(o,l,e.documentUpdates).next((v=>{h=v.ks,p=v.qs}))),!i.isEqual(Xe.min())){const v=t.Pi.getLastRemoteSnapshotVersion(o).next((x=>t.Pi.setTargetsMetadata(o,o.currentSequenceNumber,i)));d.push(v)}return ie.waitFor(d).next((()=>l.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,h,p))).next((()=>h))})).then((o=>(t.Ms=s,o)))}function a8(n,e,t){let i=vt(),s=vt();return t.forEach((o=>i=i.add(o))),e.getEntries(n,i).next((o=>{let l=Fs();return t.forEach(((d,h)=>{const p=o.get(d);h.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(d)),h.isNoDocument()&&h.version.isEqual(Xe.min())?(e.removeEntry(d,h.readTime),l=l.insert(d,h)):!p.isValidDocument()||h.version.compareTo(p.version)>0||h.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(h),l=l.insert(d,h)):Ae(sE,"Ignoring outdated watch update for ",d,". Current version:",p.version," Watch version:",h.version)})),{ks:l,qs:s}}))}function l8(n,e){const t=Ke(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=gu),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function og(n,e){const t=Ke(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return t.Pi.getTargetData(i,e).next((o=>o?(s=o,ie.resolve(s)):t.Pi.allocateTargetId(i).next((l=>(s=new zo(e,l,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=t.Ms.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function md(n,e,t){const i=Ke(n),s=i.Ms.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,(l=>i.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!_l(l))throw l;Ae(sE,`Failed to update sequence numbers for target ${e}: ${l}`)}i.Ms=i.Ms.remove(e),i.xs.delete(s.target)}function b0(n,e,t){const i=Ke(n);let s=Xe.min(),o=vt();return i.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,p,v){const x=Ke(h),b=x.xs.get(v);return b!==void 0?ie.resolve(x.Ms.get(b)):x.Pi.getTargetData(p,v)})(i,l,zs(e)).next((d=>{if(d)return s=d.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(l,d.targetId).next((h=>{o=h}))})).next((()=>i.Fs.getDocumentsMatchingQuery(l,e,t?s:Xe.min(),t?o:vt()))).next((d=>(cM(i,g2(e),d),{documents:d,Qs:o})))))}function lM(n,e){const t=Ke(n),i=Ke(t.Pi),s=t.Ms.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(o=>i.At(o,e).next((l=>l?l.target:null))))}function uM(n,e){const t=Ke(n),i=t.Os.get(e)||Xe.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.Ns.getAllFromCollectionGroup(s,e,DR(i,nd),Number.MAX_SAFE_INTEGER))).then((s=>(cM(t,e,s),s)))}function cM(n,e,t){let i=n.Os.get(e)||Xe.min();t.forEach(((s,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)})),n.Os.set(e,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dM="firestore_clients";function pA(n,e){return`${dM}_${n}_${e}`}const hM="firestore_mutations";function gA(n,e,t){let i=`${hM}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const fM="firestore_targets";function bv(n,e){return`${fM}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to="SharedClientState";class ag{constructor(e,t,i,s){this.user=e,this.batchId=t,this.state=i,this.error=s}static Ws(e,t,i){const s=JSON.parse(i);let o,l=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return l&&s.error&&(l=typeof s.error.message=="string"&&typeof s.error.code=="string",l&&(o=new ke(s.error.code,s.error.message))),l?new ag(e,t,s.state,o):(qn(to,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Xh{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Ws(e,t){const i=JSON.parse(t);let s,o=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new ke(i.error.code,i.error.message))),o?new Xh(e,i.state,s):(qn(to,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class lg{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const i=JSON.parse(t);let s=typeof i=="object"&&i.activeTargetIds instanceof Array,o=HT();for(let l=0;s&&l<i.activeTargetIds.length;++l)s=FR(i.activeTargetIds[l]),o=o.add(i.activeTargetIds[l]);return s?new lg(e,o):(qn(to,`Failed to parse client data for instance '${e}': ${t}`),null)}}class rE{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new rE(t.clientId,t.onlineState):(qn(to,`Failed to parse online state: ${e}`),null)}}class C0{constructor(){this.activeTargetIds=HT()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Cv{constructor(e,t,i,s,o){this.window=e,this.Mi=t,this.persistenceKey=i,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new Nn(ut),this.started=!1,this.Xs=[];const l=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.eo=pA(this.persistenceKey,this.Js),this.no=(function(h){return`firestore_sequence_number_${h}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new C0),this.ro=new RegExp(`^${dM}_${l}_([^_]*)$`),this.io=new RegExp(`^${hM}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${fM}_${l}_(\\d+)$`),this.oo=(function(h){return`firestore_online_state_${h}`})(this.persistenceKey),this._o=(function(h){return`firestore_bundle_loaded_v2_${h}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const i of e){if(i===this.Js)continue;const s=this.getItem(pA(this.persistenceKey,i));if(s){const o=lg.Ws(i,s);o&&(this.Zs=this.Zs.insert(o.clientId,o))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const i=this.uo(t);i&&this.co(i)}for(const i of this.Xs)this.Ys(i);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((i,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,i){this.ho(e,t,i),this.Po(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(bv(this.persistenceKey,e));if(s){const o=Xh.Ws(e,s);o&&(i=o.state)}}return t&&this.To.zs(e),this.ao(),i}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(bv(this.persistenceKey,e))}updateQueryState(e,t,i){this.Io(e,t,i)}handleUserChange(e,t,i){t.forEach((s=>{this.Po(s)})),this.currentUser=e,i.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ae(to,"READ",e,t),t}setItem(e,t){Ae(to,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ae(to,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(Ae(to,"EVENT",t.key,t.newValue),t.key===this.eo)return void qn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const i=this.Ro(t.key);return this.Vo(i,null)}{const i=this.mo(t.key,t.newValue);if(i)return this.Vo(i.clientId,i)}}else if(this.io.test(t.key)){if(t.newValue!==null){const i=this.fo(t.key,t.newValue);if(i)return this.po(i)}}else if(this.so.test(t.key)){if(t.newValue!==null){const i=this.yo(t.key,t.newValue);if(i)return this.wo(i)}}else if(t.key===this.oo){if(t.newValue!==null){const i=this.uo(t.newValue);if(i)return this.co(i)}}else if(t.key===this.no){const i=(function(o){let l=ms.ce;if(o!=null)try{const d=JSON.parse(o);Ze(typeof d=="number",30636,{So:o}),l=d}catch(d){qn(to,"Failed to read sequence number from WebStorage",d)}return l})(t.newValue);i!==ms.ce&&this.sequenceNumberHandler(i)}else if(t.key===this._o){const i=this.bo(t.newValue);await Promise.all(i.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,i){const s=new ag(this.currentUser,e,t,i),o=gA(this.persistenceKey,this.currentUser,e);this.setItem(o,s.Gs())}Po(e){const t=gA(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,i){const s=bv(this.persistenceKey,e),o=new Xh(e,t,i);this.setItem(s,o.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const i=this.Ro(e);return lg.Ws(i,t)}fo(e,t){const i=this.io.exec(e),s=Number(i[1]),o=i[2]!==void 0?i[2]:null;return ag.Ws(new gi(o),s,t)}yo(e,t){const i=this.so.exec(e),s=Number(i[1]);return Xh.Ws(s,t)}uo(e){return rE.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Ae(to,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const i=t?this.Zs.insert(e,t):this.Zs.remove(e),s=this.lo(this.Zs),o=this.lo(i),l=[],d=[];return o.forEach((h=>{s.has(h)||l.push(h)})),s.forEach((h=>{o.has(h)||d.push(h)})),this.syncEngine.Fo(l,d).then((()=>{this.Zs=i}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=HT();return e.forEach(((i,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class mM{constructor(){this.Mo=new C0,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new C0,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A="ConnectivityMonitor";class yA{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ae(_A,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ae(_A,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rp=null;function I0(){return rp===null?rp=(function(){return 268435456+Math.round(2147483648*Math.random())})():rp++,"0x"+rp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="RestConnection",c8={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class d8{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${s}`,this.Wo=this.databaseId.database===Zp?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Go(e,t,i,s,o){const l=I0(),d=this.zo(e,t.toUriEncodedString());Ae(Iv,`Sending RPC '${e}' ${l}:`,d,i);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,s,o);const{host:p}=new URL(d),v=pl(p);return this.Jo(e,d,h,i,v).then((x=>(Ae(Iv,`Received RPC '${e}' ${l}: `,x),x)),(x=>{throw Su(Iv,`RPC '${e}' ${l} failed with error: `,x,"url: ",d,"request:",i),x}))}Ho(e,t,i,s,o,l){return this.Go(e,t,i,s,o)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ad})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,o)=>e[o]=s)),i&&i.headers.forEach(((s,o)=>e[o]=s))}zo(e,t){const i=c8[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h8{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi="WebChannelConnection";class f8 extends d8{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,s,o){const l=I0();return new Promise(((d,h)=>{const p=new SR;p.setWithCredentials(!0),p.listenOnce(bR.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case pp.NO_ERROR:const x=p.getResponseJson();Ae(Pi,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(x)),d(x);break;case pp.TIMEOUT:Ae(Pi,`RPC '${e}' ${l} timed out`),h(new ke(ve.DEADLINE_EXCEEDED,"Request time out"));break;case pp.HTTP_ERROR:const b=p.getStatus();if(Ae(Pi,`RPC '${e}' ${l} failed with status:`,b,"response text:",p.getResponseText()),b>0){let A=p.getResponseJson();Array.isArray(A)&&(A=A[0]);const P=A==null?void 0:A.error;if(P&&P.status&&P.message){const F=(function(X){const re=X.toLowerCase().replace(/_/g,"-");return Object.values(ve).indexOf(re)>=0?re:ve.UNKNOWN})(P.status);h(new ke(F,P.message))}else h(new ke(ve.UNKNOWN,"Server responded with status "+p.getStatus()))}else h(new ke(ve.UNAVAILABLE,"Connection failed."));break;default:qe(9055,{l_:e,streamId:l,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Ae(Pi,`RPC '${e}' ${l} completed.`)}}));const v=JSON.stringify(s);Ae(Pi,`RPC '${e}' ${l} sending request:`,s),p.send(t,"POST",v,i,15)}))}T_(e,t,i){const s=I0(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=AR(),d=IR(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(h.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,t,i),h.encodeInitMessageHeaders=!0;const v=o.join("");Ae(Pi,`Creating RPC '${e}' stream ${s}: ${v}`,h);const x=l.createWebChannel(v,h);this.I_(x);let b=!1,A=!1;const P=new h8({Yo:H=>{A?Ae(Pi,`Not sending because RPC '${e}' stream ${s} is closed:`,H):(b||(Ae(Pi,`Opening RPC '${e}' stream ${s} transport.`),x.open(),b=!0),Ae(Pi,`RPC '${e}' stream ${s} sending:`,H),x.send(H))},Zo:()=>x.close()}),F=(H,X,re)=>{H.listen(X,(Q=>{try{re(Q)}catch(he){setTimeout((()=>{throw he}),0)}}))};return F(x,Vh.EventType.OPEN,(()=>{A||(Ae(Pi,`RPC '${e}' stream ${s} transport opened.`),P.o_())})),F(x,Vh.EventType.CLOSE,(()=>{A||(A=!0,Ae(Pi,`RPC '${e}' stream ${s} transport closed`),P.a_(),this.E_(x))})),F(x,Vh.EventType.ERROR,(H=>{A||(A=!0,Su(Pi,`RPC '${e}' stream ${s} transport errored. Name:`,H.name,"Message:",H.message),P.a_(new ke(ve.UNAVAILABLE,"The operation could not be completed")))})),F(x,Vh.EventType.MESSAGE,(H=>{var X;if(!A){const re=H.data[0];Ze(!!re,16349);const Q=re,he=(Q==null?void 0:Q.error)||((X=Q[0])==null?void 0:X.error);if(he){Ae(Pi,`RPC '${e}' stream ${s} received error:`,he);const fe=he.status;let Y=(function(O){const q=$n[O];if(q!==void 0)return N2(q)})(fe),k=he.message;Y===void 0&&(Y=ve.INTERNAL,k="Unknown error status: "+fe+" with message "+he.message),A=!0,P.a_(new ke(Y,k)),x.close()}else Ae(Pi,`RPC '${e}' stream ${s} received:`,re),P.u_(re)}})),F(d,CR.STAT_EVENT,(H=>{H.stat===i0.PROXY?Ae(Pi,`RPC '${e}' stream ${s} detected buffering proxy`):H.stat===i0.NOPROXY&&Ae(Pi,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{P.__()}),0),P}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pM(){return typeof window<"u"?window:null}function bp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(n){return new y7(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gM{constructor(e,t,i=1e3,s=1.5,o=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=s,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-i);s>0&&Ae("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA="PersistentStream";class _M{constructor(e,t,i,s,o,l,d,h){this.Mi=e,this.S_=i,this.b_=s,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new gM(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ve.RESOURCE_EXHAUSTED?(qn(t.toString()),qn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ve.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.D_===t&&this.G_(i,s)}),(i=>{e((()=>{const s=new ke(ve.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(s)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{i((()=>this.z_(s)))})),this.stream.onMessage((s=>{i((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ae(vA,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ae(vA,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class m8 extends _M{constructor(e,t,i,s,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,l),this.serializer=o}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=E7(this.serializer,e),i=(function(o){if(!("targetChange"in o))return Xe.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?Xe.min():l.readTime?Ji(l.readTime):Xe.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=T0(this.serializer),t.addTarget=(function(o,l){let d;const h=l.target;if(d=$p(h)?{documents:O2(o,h)}:{query:U2(o,h).ft},d.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){d.resumeToken=P2(o,l.resumeToken);const p=y0(o,l.expectedCount);p!==null&&(d.expectedCount=p)}else if(l.snapshotVersion.compareTo(Xe.min())>0){d.readTime=fd(o,l.snapshotVersion.toTimestamp());const p=y0(o,l.expectedCount);p!==null&&(d.expectedCount=p)}return d})(this.serializer,e);const i=w7(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=T0(this.serializer),t.removeTarget=e,this.q_(t)}}class p8 extends _M{constructor(e,t,i,s,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,l),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=x7(e.writeResults,e.commitTime),i=Ji(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=T0(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>tg(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g8{}class _8 extends g8{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ke(ve.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Go(e,v0(t,i),s,o,l))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ke(ve.UNKNOWN,o.toString())}))}Ho(e,t,i,s,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Ho(e,v0(t,i),s,l,d,o))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ke(ve.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class y8{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(qn(t),this.aa=!1):Ae("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu="RemoteStore";class v8{constructor(e,t,i,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((l=>{i.enqueueAndForget((async()=>{Fu(this)&&(Ae(Mu,"Restarting streams for network reachability change."),await(async function(h){const p=Ke(h);p.Ea.add(4),await Ff(p),p.Ra.set("Unknown"),p.Ea.delete(4),await o_(p)})(this))}))})),this.Ra=new y8(i,s)}}async function o_(n){if(Fu(n))for(const e of n.da)await e(!0)}async function Ff(n){for(const e of n.da)await e(!1)}function a_(n,e){const t=Ke(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),lE(t)?aE(t):Md(t).O_()&&oE(t,e))}function pd(n,e){const t=Ke(n),i=Md(t);t.Ia.delete(e),i.O_()&&yM(t,e),t.Ia.size===0&&(i.O_()?i.L_():Fu(t)&&t.Ra.set("Unknown"))}function oE(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Md(n).Y_(e)}function yM(n,e){n.Va.Ue(e),Md(n).Z_(e)}function aE(n){n.Va=new m7({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Md(n).start(),n.Ra.ua()}function lE(n){return Fu(n)&&!Md(n).x_()&&n.Ia.size>0}function Fu(n){return Ke(n).Ea.size===0}function vM(n){n.Va=void 0}async function T8(n){n.Ra.set("Online")}async function E8(n){n.Ia.forEach(((e,t)=>{oE(n,e)}))}async function x8(n,e){vM(n),lE(n)?(n.Ra.ha(e),aE(n)):n.Ra.set("Unknown")}async function w8(n,e,t){if(n.Ra.set("Online"),e instanceof M2&&e.state===2&&e.cause)try{await(async function(s,o){const l=o.cause;for(const d of o.targetIds)s.Ia.has(d)&&(await s.remoteSyncer.rejectListen(d,l),s.Ia.delete(d),s.Va.removeTarget(d))})(n,e)}catch(i){Ae(Mu,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await ug(n,i)}else if(e instanceof wp?n.Va.Ze(e):e instanceof R2?n.Va.st(e):n.Va.tt(e),!t.isEqual(Xe.min()))try{const i=await aM(n.localStore);t.compareTo(i)>=0&&await(function(o,l){const d=o.Va.Tt(l);return d.targetChanges.forEach(((h,p)=>{if(h.resumeToken.approximateByteSize()>0){const v=o.Ia.get(p);v&&o.Ia.set(p,v.withResumeToken(h.resumeToken,l))}})),d.targetMismatches.forEach(((h,p)=>{const v=o.Ia.get(h);if(!v)return;o.Ia.set(h,v.withResumeToken(Hn.EMPTY_BYTE_STRING,v.snapshotVersion)),yM(o,h);const x=new zo(v.target,h,p,v.sequenceNumber);oE(o,x)})),o.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(i){Ae(Mu,"Failed to raise snapshot:",i),await ug(n,i)}}async function ug(n,e,t){if(!_l(e))throw e;n.Ea.add(1),await Ff(n),n.Ra.set("Offline"),t||(t=()=>aM(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ae(Mu,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await o_(n)}))}function TM(n,e){return e().catch((t=>ug(n,t,e)))}async function Rd(n){const e=Ke(n),t=cl(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:gu;for(;S8(e);)try{const s=await l8(e.localStore,i);if(s===null){e.Ta.length===0&&t.L_();break}i=s.batchId,b8(e,s)}catch(s){await ug(e,s)}EM(e)&&xM(e)}function S8(n){return Fu(n)&&n.Ta.length<10}function b8(n,e){n.Ta.push(e);const t=cl(n);t.O_()&&t.X_&&t.ea(e.mutations)}function EM(n){return Fu(n)&&!cl(n).x_()&&n.Ta.length>0}function xM(n){cl(n).start()}async function C8(n){cl(n).ra()}async function I8(n){const e=cl(n);for(const t of n.Ta)e.ea(t.mutations)}async function A8(n,e,t){const i=n.Ta.shift(),s=YT.from(i,e,t);await TM(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Rd(n)}async function N8(n,e){e&&cl(n).X_&&await(async function(i,s){if((function(l){return d7(l)&&l!==ve.ABORTED})(s.code)){const o=i.Ta.shift();cl(i).B_(),await TM(i,(()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s))),await Rd(i)}})(n,e),EM(n)&&xM(n)}async function TA(n,e){const t=Ke(n);t.asyncQueue.verifyOperationInProgress(),Ae(Mu,"RemoteStore received new credentials");const i=Fu(t);t.Ea.add(3),await Ff(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await o_(t)}async function A0(n,e){const t=Ke(n);e?(t.Ea.delete(2),await o_(t)):e||(t.Ea.add(2),await Ff(t),t.Ra.set("Unknown"))}function Md(n){return n.ma||(n.ma=(function(t,i,s){const o=Ke(t);return o.sa(),new m8(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Xo:T8.bind(null,n),t_:E8.bind(null,n),r_:x8.bind(null,n),H_:w8.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),lE(n)?aE(n):n.Ra.set("Unknown")):(await n.ma.stop(),vM(n))}))),n.ma}function cl(n){return n.fa||(n.fa=(function(t,i,s){const o=Ke(t);return o.sa(),new p8(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:C8.bind(null,n),r_:N8.bind(null,n),ta:I8.bind(null,n),na:A8.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Rd(n)):(await n.fa.stop(),n.Ta.length>0&&(Ae(Mu,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e,t,i,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new Go,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,o){const l=Date.now()+i,d=new uE(e,t,l,s,o);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ke(ve.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cE(n,e){if(qn("AsyncQueue",`${e}: ${n}`),_l(n))return new ke(ve.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{static emptySet(e){return new Yc(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Ve.comparator(t.key,i.key):(t,i)=>Ve.comparator(t.key,i.key),this.keyedMap=Oh(),this.sortedSet=new Nn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Yc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new Yc;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(){this.ga=new Nn(Ve.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):qe(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class gd{constructor(e,t,i,s,o,l,d,h,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=h,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,s,o){const l=[];return t.forEach((d=>{l.push({type:0,doc:d})})),new gd(e,t,Yc.emptySet(t),l,i,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$g(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R8{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class M8{constructor(){this.queries=xA(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const s=Ke(t),o=s.queries;s.queries=xA(),o.forEach(((l,d)=>{for(const h of d.Sa)h.onError(i)}))})(this,new ke(ve.ABORTED,"Firestore shutting down"))}}function xA(){return new ia((n=>p2(n)),$g)}async function wM(n,e){const t=Ke(n);let i=3;const s=e.query;let o=t.queries.get(s);o?!o.ba()&&e.Da()&&(i=2):(o=new R8,i=e.Da()?0:1);try{switch(i){case 0:o.wa=await t.onListen(s,!0);break;case 1:o.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const d=cE(l,`Initialization of query '${Lc(e.query)}' failed`);return void e.onError(d)}t.queries.set(s,o),o.Sa.push(e),e.va(t.onlineState),o.wa&&e.Fa(o.wa)&&dE(t)}async function SM(n,e){const t=Ke(n),i=e.query;let s=3;const o=t.queries.get(i);if(o){const l=o.Sa.indexOf(e);l>=0&&(o.Sa.splice(l,1),o.Sa.length===0?s=e.Da()?0:1:!o.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function P8(n,e){const t=Ke(n);let i=!1;for(const s of e){const o=s.query,l=t.queries.get(o);if(l){for(const d of l.Sa)d.Fa(s)&&(i=!0);l.wa=s}}i&&dE(t)}function k8(n,e,t){const i=Ke(n),s=i.queries.get(e);if(s)for(const o of s.Sa)o.onError(t);i.queries.delete(e)}function dE(n){n.Ca.forEach((e=>{e.next()}))}var N0,wA;(wA=N0||(N0={})).Ma="default",wA.Cache="cache";class bM{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new gd(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=gd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==N0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CM{constructor(e){this.key=e}}class IM{constructor(e){this.key=e}}class D8{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=vt(),this.mutatedKeys=vt(),this.eu=_2(e),this.tu=new Yc(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new EA,s=t?t.tu:this.tu;let o=t?t.mutatedKeys:this.mutatedKeys,l=s,d=!1;const h=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((v,x)=>{const b=s.get(v),A=Vf(this.query,x)?x:null,P=!!b&&this.mutatedKeys.has(b.key),F=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let H=!1;b&&A?b.data.isEqual(A.data)?P!==F&&(i.track({type:3,doc:A}),H=!0):this.su(b,A)||(i.track({type:2,doc:A}),H=!0,(h&&this.eu(A,h)>0||p&&this.eu(A,p)<0)&&(d=!0)):!b&&A?(i.track({type:0,doc:A}),H=!0):b&&!A&&(i.track({type:1,doc:b}),H=!0,(h||p)&&(d=!0)),H&&(A?(l=l.add(A),o=F?o.add(v):o.delete(v)):(l=l.delete(v),o=o.delete(v)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const v=this.query.limitType==="F"?l.last():l.first();l=l.delete(v.key),o=o.delete(v.key),i.track({type:1,doc:v})}return{tu:l,iu:i,Cs:d,mutatedKeys:o}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((v,x)=>(function(A,P){const F=H=>{switch(H){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return qe(20277,{Rt:H})}};return F(A)-F(P)})(v.type,x.type)||this.eu(v.doc,x.doc))),this.ou(i),s=s??!1;const d=t&&!s?this._u():[],h=this.Xa.size===0&&this.current&&!s?1:0,p=h!==this.Za;return this.Za=h,l.length!==0||p?{snapshot:new gd(this.query,e.tu,o,l,e.mutatedKeys,h===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new EA,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=vt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new IM(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new CM(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=vt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return gd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Pd="SyncEngine";class L8{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class V8{constructor(e){this.key=e,this.hu=!1}}class O8{constructor(e,t,i,s,o,l){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new ia((d=>p2(d)),$g),this.Iu=new Map,this.Eu=new Set,this.du=new Nn(Ve.comparator),this.Au=new Map,this.Ru=new eE,this.Vu={},this.mu=new Map,this.fu=Ru.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function U8(n,e,t=!0){const i=l_(n);let s;const o=i.Tu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.lu()):s=await AM(i,e,t,!0),s}async function F8(n,e){const t=l_(n);await AM(t,e,!0,!1)}async function AM(n,e,t,i){const s=await og(n.localStore,zs(e)),o=s.targetId,l=n.sharedClientState.addLocalQueryTarget(o,t);let d;return i&&(d=await hE(n,e,o,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&a_(n.remoteStore,s),d}async function hE(n,e,t,i,s){n.pu=(x,b,A)=>(async function(F,H,X,re){let Q=H.view.ru(X);Q.Cs&&(Q=await b0(F.localStore,H.query,!1).then((({documents:k})=>H.view.ru(k,Q))));const he=re&&re.targetChanges.get(H.targetId),fe=re&&re.targetMismatches.get(H.targetId)!=null,Y=H.view.applyChanges(Q,F.isPrimaryClient,he,fe);return R0(F,H.targetId,Y.au),Y.snapshot})(n,x,b,A);const o=await b0(n.localStore,e,!0),l=new D8(e,o.Qs),d=l.ru(o.documents),h=Uf.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),p=l.applyChanges(d,n.isPrimaryClient,h);R0(n,t,p.au);const v=new L8(e,t,l);return n.Tu.set(e,v),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function B8(n,e,t){const i=Ke(n),s=i.Tu.get(e),o=i.Iu.get(s.targetId);if(o.length>1)return i.Iu.set(s.targetId,o.filter((l=>!$g(l,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await md(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),t&&pd(i.remoteStore,s.targetId),_d(i,s.targetId)})).catch(gl)):(_d(i,s.targetId),await md(i.localStore,s.targetId,!0))}async function z8(n,e){const t=Ke(n),i=t.Tu.get(e),s=t.Iu.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),pd(t.remoteStore,i.targetId))}async function q8(n,e,t){const i=gE(n);try{const s=await(function(l,d){const h=Ke(l),p=en.now(),v=d.reduce(((A,P)=>A.add(P.key)),vt());let x,b;return h.persistence.runTransaction("Locally write mutations","readwrite",(A=>{let P=Fs(),F=vt();return h.Ns.getEntries(A,v).next((H=>{P=H,P.forEach(((X,re)=>{re.isValidDocument()||(F=F.add(X))}))})).next((()=>h.localDocuments.getOverlayedDocuments(A,P))).next((H=>{x=H;const X=[];for(const re of d){const Q=u7(re,x.get(re.key).overlayedDocument);Q!=null&&X.push(new sa(re.key,Q,r2(Q.value.mapValue),Ui.exists(!0)))}return h.mutationQueue.addMutationBatch(A,p,X,d)})).next((H=>{b=H;const X=H.applyToLocalDocumentSet(x,F);return h.documentOverlayCache.saveOverlays(A,H.batchId,X)}))})).then((()=>({batchId:b.batchId,changes:v2(x)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),(function(l,d,h){let p=l.Vu[l.currentUser.toKey()];p||(p=new Nn(ut)),p=p.insert(d,h),l.Vu[l.currentUser.toKey()]=p})(i,s.batchId,t),await vl(i,s.changes),await Rd(i.remoteStore)}catch(s){const o=cE(s,"Failed to persist write");t.reject(o)}}async function NM(n,e){const t=Ke(n);try{const i=await o8(t.localStore,e);e.targetChanges.forEach(((s,o)=>{const l=t.Au.get(o);l&&(Ze(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?Ze(l.hu,14607):s.removedDocuments.size>0&&(Ze(l.hu,42227),l.hu=!1))})),await vl(t,i,e)}catch(i){await gl(i)}}function SA(n,e,t){const i=Ke(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.Tu.forEach(((o,l)=>{const d=l.view.va(e);d.snapshot&&s.push(d.snapshot)})),(function(l,d){const h=Ke(l);h.onlineState=d;let p=!1;h.queries.forEach(((v,x)=>{for(const b of x.Sa)b.va(d)&&(p=!0)})),p&&dE(h)})(i.eventManager,e),s.length&&i.Pu.H_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function G8(n,e,t){const i=Ke(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Au.get(e),o=s&&s.key;if(o){let l=new Nn(Ve.comparator);l=l.insert(o,Vn.newNoDocument(o,Xe.min()));const d=vt().add(o),h=new Of(Xe.min(),new Map,new Nn(ut),l,d);await NM(i,h),i.du=i.du.remove(o),i.Au.delete(e),pE(i)}else await md(i.localStore,e,!1).then((()=>_d(i,e,t))).catch(gl)}async function H8(n,e){const t=Ke(n),i=e.batch.batchId;try{const s=await r8(t.localStore,e);mE(t,i,null),fE(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await vl(t,s)}catch(s){await gl(s)}}async function j8(n,e,t){const i=Ke(n);try{const s=await(function(l,d){const h=Ke(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let v;return h.mutationQueue.lookupMutationBatch(p,d).next((x=>(Ze(x!==null,37113),v=x.keys(),h.mutationQueue.removeMutationBatch(p,x)))).next((()=>h.mutationQueue.performConsistencyCheck(p))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(p,v,d))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,v))).next((()=>h.localDocuments.getDocuments(p,v)))}))})(i.localStore,e);mE(i,e,t),fE(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await vl(i,s)}catch(s){await gl(s)}}function fE(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function mE(n,e,t){const i=Ke(n);let s=i.Vu[i.currentUser.toKey()];if(s){const o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),i.Vu[i.currentUser.toKey()]=s}}function _d(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||RM(n,i)}))}function RM(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(pd(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),pE(n))}function R0(n,e,t){for(const i of t)i instanceof CM?(n.Ru.addReference(i.key,e),K8(n,i)):i instanceof IM?(Ae(Pd,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||RM(n,i.key)):qe(19791,{wu:i})}function K8(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(Ae(Pd,"New document in limbo: "+t),n.Eu.add(i),pE(n))}function pE(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ve(Kt.fromString(e)),i=n.fu.next();n.Au.set(i,new V8(t)),n.du=n.du.insert(t,i),a_(n.remoteStore,new zo(zs(Qg(t.path)),i,"TargetPurposeLimboResolution",ms.ce))}}async function vl(n,e,t){const i=Ke(n),s=[],o=[],l=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,h)=>{l.push(i.pu(h,e,t).then((p=>{var v;if((p||t)&&i.isPrimaryClient){const x=p?!p.fromCache:(v=t==null?void 0:t.targetChanges.get(h.targetId))==null?void 0:v.current;i.sharedClientState.updateQueryState(h.targetId,x?"current":"not-current")}if(p){s.push(p);const x=iE.As(h.targetId,p);o.push(x)}})))})),await Promise.all(l),i.Pu.H_(s),await(async function(h,p){const v=Ke(h);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>ie.forEach(p,(b=>ie.forEach(b.Es,(A=>v.persistence.referenceDelegate.addReference(x,b.targetId,A))).next((()=>ie.forEach(b.ds,(A=>v.persistence.referenceDelegate.removeReference(x,b.targetId,A)))))))))}catch(x){if(!_l(x))throw x;Ae(sE,"Failed to update sequence numbers: "+x)}for(const x of p){const b=x.targetId;if(!x.fromCache){const A=v.Ms.get(b),P=A.snapshotVersion,F=A.withLastLimboFreeSnapshotVersion(P);v.Ms=v.Ms.insert(b,F)}}})(i.localStore,o))}async function W8(n,e){const t=Ke(n);if(!t.currentUser.isEqual(e)){Ae(Pd,"User change. New user:",e.toKey());const i=await oM(t.localStore,e);t.currentUser=e,(function(o,l){o.mu.forEach((d=>{d.forEach((h=>{h.reject(new ke(ve.CANCELLED,l))}))})),o.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await vl(t,i.Ls)}}function Y8(n,e){const t=Ke(n),i=t.Au.get(e);if(i&&i.hu)return vt().add(i.key);{let s=vt();const o=t.Iu.get(e);if(!o)return s;for(const l of o){const d=t.Tu.get(l);s=s.unionWith(d.view.nu)}return s}}async function J8(n,e){const t=Ke(n),i=await b0(t.localStore,e.query,!0),s=e.view.cu(i);return t.isPrimaryClient&&R0(t,e.targetId,s.au),s}async function Z8(n,e){const t=Ke(n);return uM(t.localStore,e).then((i=>vl(t,i)))}async function Q8(n,e,t,i){const s=Ke(n),o=await(function(d,h){const p=Ke(d),v=Ke(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(x=>v.er(x,h).next((b=>b?p.localDocuments.getDocuments(x,b):ie.resolve(null)))))})(s.localStore,e);o!==null?(t==="pending"?await Rd(s.remoteStore):t==="acknowledged"||t==="rejected"?(mE(s,e,i||null),fE(s,e),(function(d,h){Ke(Ke(d).mutationQueue).ir(h)})(s.localStore,e)):qe(6720,"Unknown batchState",{Su:t}),await vl(s,o)):Ae(Pd,"Cannot apply mutation batch with id: "+e)}async function $8(n,e){const t=Ke(n);if(l_(t),gE(t),e===!0&&t.gu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),s=await bA(t,i.toArray());t.gu=!0,await A0(t.remoteStore,!0);for(const o of s)a_(t.remoteStore,o)}else if(e===!1&&t.gu!==!1){const i=[];let s=Promise.resolve();t.Iu.forEach(((o,l)=>{t.sharedClientState.isLocalQueryTarget(l)?i.push(l):s=s.then((()=>(_d(t,l),md(t.localStore,l,!0)))),pd(t.remoteStore,l)})),await s,await bA(t,i),(function(l){const d=Ke(l);d.Au.forEach(((h,p)=>{pd(d.remoteStore,p)})),d.Ru.Jr(),d.Au=new Map,d.du=new Nn(Ve.comparator)})(t),t.gu=!1,await A0(t.remoteStore,!1)}}async function bA(n,e,t){const i=Ke(n),s=[],o=[];for(const l of e){let d;const h=i.Iu.get(l);if(h&&h.length!==0){d=await og(i.localStore,zs(h[0]));for(const p of h){const v=i.Tu.get(p),x=await J8(i,v);x.snapshot&&o.push(x.snapshot)}}else{const p=await lM(i.localStore,l);d=await og(i.localStore,p),await hE(i,MM(p),l,!1,d.resumeToken)}s.push(d)}return i.Pu.H_(o),s}function MM(n){return f2(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function X8(n){return(function(t){return Ke(Ke(t).persistence).Ts()})(Ke(n).localStore)}async function eq(n,e,t,i){const s=Ke(n);if(s.gu)return void Ae(Pd,"Ignoring unexpected query state notification.");const o=s.Iu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const l=await uM(s.localStore,g2(o[0])),d=Of.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Hn.EMPTY_BYTE_STRING);await vl(s,l,d);break}case"rejected":await md(s.localStore,e,!0),_d(s,e,i);break;default:qe(64155,t)}}async function tq(n,e,t){const i=l_(n);if(i.gu){for(const s of e){if(i.Iu.has(s)&&i.sharedClientState.isActiveQueryTarget(s)){Ae(Pd,"Adding an already active target "+s);continue}const o=await lM(i.localStore,s),l=await og(i.localStore,o);await hE(i,MM(o),l.targetId,!1,l.resumeToken),a_(i.remoteStore,l)}for(const s of t)i.Iu.has(s)&&await md(i.localStore,s,!1).then((()=>{pd(i.remoteStore,s),_d(i,s)})).catch(gl)}}function l_(n){const e=Ke(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=NM.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Y8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=G8.bind(null,e),e.Pu.H_=P8.bind(null,e.eventManager),e.Pu.yu=k8.bind(null,e.eventManager),e}function gE(n){const e=Ke(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=H8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=j8.bind(null,e),e}class Ef{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=r_(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return rM(this.persistence,new sM,e.initialUser,this.serializer)}Cu(e){return new tE(s_.mi,this.serializer)}Du(e){return new mM}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ef.provider={build:()=>new Ef};class nq extends Ef{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ze(this.persistence.referenceDelegate instanceof rg,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new $2(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ki.withCacheSize(this.cacheSizeBytes):ki.DEFAULT;return new tE((i=>rg.mi(i,t)),this.serializer)}}class iq extends Ef{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await gE(this.xu.syncEngine),await Rd(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return rM(this.persistence,new sM,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new $2(i,e.asyncQueue,t)}Mu(e,t){const i=new hz(t,this.persistence);return new dz(e.asyncQueue,i)}Cu(e){const t=iM(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?ki.withCacheSize(this.cacheSizeBytes):ki.DEFAULT;return new nE(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,pM(),bp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new mM}}class sq extends iq{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Cv&&(this.sharedClientState.syncEngine={Co:Q8.bind(null,t),vo:eq.bind(null,t),Fo:tq.bind(null,t),Ts:X8.bind(null,t),Do:Z8.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async i=>{await $8(this.xu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Du(e){const t=pM();if(!Cv.v(t))throw new ke(ve.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=iM(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Cv(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class cg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>SA(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=W8.bind(null,this.syncEngine),await A0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new M8})()}createDatastore(e){const t=r_(e.databaseInfo.databaseId),i=(function(o){return new f8(o)})(e.databaseInfo);return(function(o,l,d,h){return new _8(o,l,d,h)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,s,o,l,d){return new v8(i,s,o,l,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>SA(this.syncEngine,t,0)),(function(){return yA.v()?new yA:new u8})())}createSyncEngine(e,t){return(function(s,o,l,d,h,p,v){const x=new O8(s,o,l,d,h,p);return v&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const o=Ke(s);Ae(Mu,"RemoteStore shutting down."),o.Ea.add(5),await Ff(o),o.Aa.shutdown(),o.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}cg.provider={build:()=>new cg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):qn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dl="FirestoreClient";class rq{constructor(e,t,i,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=gi.UNAUTHENTICATED,this.clientId=kT.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,(async l=>{Ae(dl,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(i,(l=>(Ae(dl,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Go;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=cE(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Av(n,e){n.asyncQueue.verifyOperationInProgress(),Ae(dl,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await oM(e.localStore,s),i=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function CA(n,e){n.asyncQueue.verifyOperationInProgress();const t=await oq(n);Ae(dl,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>TA(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>TA(e.remoteStore,s))),n._onlineComponents=e}async function oq(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ae(dl,"Using user provided OfflineComponentProvider");try{await Av(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===ve.FAILED_PRECONDITION||s.code===ve.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Su("Error using user provided cache. Falling back to memory cache: "+t),await Av(n,new Ef)}}else Ae(dl,"Using default OfflineComponentProvider"),await Av(n,new nq(void 0));return n._offlineComponents}async function kM(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ae(dl,"Using user provided OnlineComponentProvider"),await CA(n,n._uninitializedComponentsProvider._online)):(Ae(dl,"Using default OnlineComponentProvider"),await CA(n,new cg))),n._onlineComponents}function aq(n){return kM(n).then((e=>e.syncEngine))}async function M0(n){const e=await kM(n),t=e.eventManager;return t.onListen=U8.bind(null,e.syncEngine),t.onUnlisten=B8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=F8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=z8.bind(null,e.syncEngine),t}function lq(n,e,t={}){const i=new Go;return n.asyncQueue.enqueueAndForget((async()=>(function(o,l,d,h,p){const v=new PM({next:b=>{v.Nu(),l.enqueueAndForget((()=>SM(o,x))),b.fromCache&&h.source==="server"?p.reject(new ke(ve.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(b)},error:b=>p.reject(b)}),x=new bM(d,v,{includeMetadataChanges:!0,qa:!0});return wM(o,x)})(await M0(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DM(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IA=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LM="firestore.googleapis.com",AA=!0;class NA{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ke(ve.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=LM,this.ssl=AA}else this.host=e.host,this.ssl=e.ssl??AA;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Y2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<F7)throw new ke(ve.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}lz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=DM(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ke(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ke(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ke(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class u_{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new NA({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ke(ve.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ke(ve.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new NA(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new $B;switch(i.type){case"firstParty":return new nz(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ke(ve.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=IA.get(t);i&&(Ae("ComponentProvider","Removing Datastore"),IA.delete(t),i.terminate())})(this),Promise.resolve()}}function uq(n,e,t,i={}){var p;n=Bs(n,u_);const s=pl(e),o=n._getSettings(),l={...o,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;s&&(_T(`https://${d}`),yT("Firestore",!0)),o.host!==LM&&o.host!==d&&Su("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:d,ssl:s,emulatorOptions:i};if(!Ko(h,l)&&(n._setSettings(h),i.mockUserToken)){let v,x;if(typeof i.mockUserToken=="string")v=i.mockUserToken,x=gi.MOCK_USER;else{v=DN(i.mockUserToken,(p=n._app)==null?void 0:p.options.projectId);const b=i.mockUserToken.sub||i.mockUserToken.user_id;if(!b)throw new ke(ve.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new gi(b)}n._authCredentials=new XB(new RR(v,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Bu(this.firestore,e,this._query)}}class Gn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Gn(this.firestore,e,this._key)}toJSON(){return{type:Gn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Pf(t,Gn._jsonSchema))return new Gn(e,i||null,new Ve(Kt.fromString(t.referencePath)))}}Gn._jsonSchemaVersion="firestore/documentReference/1.0",Gn._jsonSchema={type:Xn("string",Gn._jsonSchemaVersion),referencePath:Xn("string")};class sl extends Bu{constructor(e,t,i){super(e,t,Qg(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Gn(this.firestore,null,new Ve(e))}withConverter(e){return new sl(this.firestore,e,this._path)}}function Cp(n,e,...t){if(n=Un(n),PR("collection","path",e),n instanceof u_){const i=Kt.fromString(e,...t);return vI(i),new sl(n,null,i)}{if(!(n instanceof Gn||n instanceof sl))throw new ke(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Kt.fromString(e,...t));return vI(i),new sl(n.firestore,null,i)}}function ef(n,e,...t){if(n=Un(n),arguments.length===1&&(e=kT.newId()),PR("doc","path",e),n instanceof u_){const i=Kt.fromString(e,...t);return yI(i),new Gn(n,null,new Ve(i))}{if(!(n instanceof Gn||n instanceof sl))throw new ke(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Kt.fromString(e,...t));return yI(i),new Gn(n.firestore,n instanceof sl?n.converter:null,new Ve(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA="AsyncQueue";class MA{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new gM(this,"async_queue_retry"),this._c=()=>{const i=bp();i&&Ae(RA,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=bp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=bp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Go;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!_l(e))throw e;Ae(RA,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,qn("INTERNAL UNHANDLED ERROR: ",PA(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=uE.createAndSchedule(this,e,t,i,(o=>this.hc(o)));return this.tc.push(s),s}uc(){this.nc&&qe(47125,{Pc:PA(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function PA(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kA(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const s=t;for(const o of i)if(o in s&&typeof s[o]=="function")return!0;return!1})(n,["next","error","complete"])}class Qo extends u_{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new MA,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new MA(e),this._firestoreClient=void 0,await e}}}function cq(n,e){const t=typeof n=="object"?n:ET(),i=typeof n=="string"?n:Zp,s=Fg(t,"firestore").getImmediate({identifier:i});if(!s._initialized){const o=MN("firestore");o&&uq(s,...o)}return s}function _E(n){if(n._terminated)throw new ke(ve.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||VM(n),n._firestoreClient}function VM(n){var i,s,o;const e=n._freezeSettings(),t=(function(d,h,p,v){return new Bz(d,h,p,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,DM(v.experimentalLongPollingOptions),v.useFetchStreams,v.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new rq(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(d){const h=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(h),_online:h}})(n._componentsProvider))}async function dq(n){Su("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();hq(n,cg.provider,{build:t=>new sq(t,e.cacheSizeBytes)})}function hq(n,e,t){if((n=Bs(n,Qo))._firestoreClient||n._terminated)throw new ke(ve.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ke(ve.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},VM(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new lr(Hn.fromBase64String(e))}catch(t){throw new ke(ve.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new lr(Hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:lr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pf(e,lr._jsonSchema))return lr.fromBase64String(e.bytes)}}lr._jsonSchemaVersion="firestore/bytes/1.0",lr._jsonSchema={type:Xn("string",lr._jsonSchemaVersion),bytes:Xn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ke(ve.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new An(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ke(ve.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ke(ve.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ut(this._lat,e._lat)||ut(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:oo._jsonSchemaVersion}}static fromJSON(e){if(Pf(e,oo._jsonSchema))return new oo(e.latitude,e.longitude)}}oo._jsonSchemaVersion="firestore/geoPoint/1.0",oo._jsonSchema={type:Xn("string",oo._jsonSchemaVersion),latitude:Xn("number"),longitude:Xn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ao._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pf(e,ao._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ao(e.vectorValues);throw new ke(ve.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ao._jsonSchemaVersion="firestore/vectorValue/1.0",ao._jsonSchema={type:Xn("string",ao._jsonSchemaVersion),vectorValues:Xn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fq=/^__.*__$/;class mq{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new sa(e,this.data,this.fieldMask,t,this.fieldTransforms):new Nd(e,this.data,t,this.fieldTransforms)}}class OM{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new sa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function UM(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw qe(40011,{Ac:n})}}class d_{constructor(e,t,i,s,o,l){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new d_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return dg(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(UM(this.Ac)&&fq.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class pq{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||r_(e)}Cc(e,t,i,s=!1){return new d_({Ac:e,methodName:t,Dc:i,path:An.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function h_(n){const e=n._freezeSettings(),t=r_(n._databaseId);return new pq(n._databaseId,!!e.ignoreUndefinedProperties,t)}function FM(n,e,t,i,s,o={}){const l=n.Cc(o.merge||o.mergeFields?2:0,e,t,s);TE("Data must be an object, but it was:",l,i);const d=BM(i,l);let h,p;if(o.merge)h=new ps(l.fieldMask),p=l.fieldTransforms;else if(o.mergeFields){const v=[];for(const x of o.mergeFields){const b=P0(e,x,t);if(!l.contains(b))throw new ke(ve.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);qM(v,b)||v.push(b)}h=new ps(v),p=l.fieldTransforms.filter((x=>h.covers(x.field)))}else h=null,p=l.fieldTransforms;return new mq(new Vi(d),h,p)}class f_ extends Bf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof f_}}function gq(n,e,t){return new d_({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class yE extends Bf{_toFieldTransform(e){return new KT(e.path,new dd)}isEqual(e){return e instanceof yE}}class vE extends Bf{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=gq(this,e,!0),i=this.vc.map((o=>kd(o,t))),s=new Iu(i);return new KT(e.path,s)}isEqual(e){return e instanceof vE&&Ko(this.vc,e.vc)}}function _q(n,e,t,i){const s=n.Cc(1,e,t);TE("Data must be an object, but it was:",s,i);const o=[],l=Vi.empty();yl(i,((h,p)=>{const v=EE(e,h,t);p=Un(p);const x=s.yc(v);if(p instanceof f_)o.push(v);else{const b=kd(p,x);b!=null&&(o.push(v),l.set(v,b))}}));const d=new ps(o);return new OM(l,d,s.fieldTransforms)}function yq(n,e,t,i,s,o){const l=n.Cc(1,e,t),d=[P0(e,i,t)],h=[s];if(o.length%2!=0)throw new ke(ve.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<o.length;b+=2)d.push(P0(e,o[b])),h.push(o[b+1]);const p=[],v=Vi.empty();for(let b=d.length-1;b>=0;--b)if(!qM(p,d[b])){const A=d[b];let P=h[b];P=Un(P);const F=l.yc(A);if(P instanceof f_)p.push(A);else{const H=kd(P,F);H!=null&&(p.push(A),v.set(A,H))}}const x=new ps(p);return new OM(v,x,l.fieldTransforms)}function vq(n,e,t,i=!1){return kd(t,n.Cc(i?4:3,e))}function kd(n,e){if(zM(n=Un(n)))return TE("Unsupported field value:",e,n),BM(n,e);if(n instanceof Bf)return(function(i,s){if(!UM(s.Ac))throw s.Sc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,s){const o=[];let l=0;for(const d of i){let h=kd(d,s.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),l++}return{arrayValue:{values:o}}})(n,e)}return(function(i,s){if((i=Un(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return i7(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=en.fromDate(i);return{timestampValue:fd(s.serializer,o)}}if(i instanceof en){const o=new en(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:fd(s.serializer,o)}}if(i instanceof oo)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof lr)return{bytesValue:P2(s.serializer,i._byteString)};if(i instanceof Gn){const o=s.databaseId,l=i.firestore._databaseId;if(!l.isEqual(o))throw s.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:QT(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof ao)return(function(l,d){return{mapValue:{fields:{[zT]:{stringValue:qT},[ad]:{arrayValue:{values:l.toArray().map((p=>{if(typeof p!="number")throw d.Sc("VectorValues must only contain numeric values.");return jT(d.serializer,p)}))}}}}}})(i,s);throw s.Sc(`Unsupported field value: ${Gg(i)}`)})(n,e)}function BM(n,e){const t={};return ZR(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yl(n,((i,s)=>{const o=kd(s,e.mc(i));o!=null&&(t[i]=o)})),{mapValue:{fields:t}}}function zM(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof en||n instanceof oo||n instanceof lr||n instanceof Gn||n instanceof Bf||n instanceof ao)}function TE(n,e,t){if(!zM(t)||!kR(t)){const i=Gg(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function P0(n,e,t){if((e=Un(e))instanceof c_)return e._internalPath;if(typeof e=="string")return EE(n,e);throw dg("Field path arguments must be of type string or ",n,!1,void 0,t)}const Tq=new RegExp("[~\\*/\\[\\]]");function EE(n,e,t){if(e.search(Tq)>=0)throw dg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new c_(...e.split("."))._internalPath}catch{throw dg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function dg(n,e,t,i,s){const o=i&&!i.isEmpty(),l=s!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let h="";return(o||l)&&(h+=" (found",o&&(h+=` in field ${i}`),l&&(h+=` in document ${s}`),h+=")"),new ke(ve.INVALID_ARGUMENT,d+n+h)}function qM(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(e,t,i,s,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Gn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Eq(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(xE("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Eq extends GM{data(){return super.data()}}function xE(n,e){return typeof e=="string"?EE(n,e):e instanceof c_?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ke(ve.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wE{}class xq extends wE{}function k0(n,e,...t){let i=[];e instanceof wE&&i.push(e),i=i.concat(t),(function(o){const l=o.filter((h=>h instanceof SE)).length,d=o.filter((h=>h instanceof m_)).length;if(l>1||l>0&&d>0)throw new ke(ve.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)n=s._apply(n);return n}class m_ extends xq{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new m_(e,t,i)}_apply(e){const t=this._parse(e);return jM(e._query,t),new Bu(e.firestore,e.converter,g0(e._query,t))}_parse(e){const t=h_(e.firestore);return(function(o,l,d,h,p,v,x){let b;if(p.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new ke(ve.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){LA(x,v);const P=[];for(const F of x)P.push(DA(h,o,F));b={arrayValue:{values:P}}}else b=DA(h,o,x)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||LA(x,v),b=vq(d,l,x,v==="in"||v==="not-in");return Lt.create(p,v,b)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function D0(n,e,t){const i=e,s=xE("where",n);return m_._create(s,i,t)}class SE extends wE{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new SE(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:tn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,o){let l=s;const d=o.getFlattenedFilters();for(const h of d)jM(l,h),l=g0(l,h)})(e._query,t),new Bu(e.firestore,e.converter,g0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function DA(n,e,t){if(typeof(t=Un(t))=="string"){if(t==="")throw new ke(ve.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!m2(e)&&t.indexOf("/")!==-1)throw new ke(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Kt.fromString(t));if(!Ve.isDocumentKey(i))throw new ke(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return yf(n,new Ve(i))}if(t instanceof Gn)return yf(n,t._key);throw new ke(ve.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Gg(t)}.`)}function LA(n,e){if(!Array.isArray(n)||n.length===0)throw new ke(ve.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jM(n,e){const t=(function(s,o){for(const l of s)for(const d of l.getFlattenedFilters())if(o.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ke(ve.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ke(ve.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class wq{convertValue(e,t="none"){switch(ll(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Zo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw qe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return yl(e,((s,o)=>{i[s]=this.convertValue(o,t)})),i}convertVectorValue(e){var i,s,o;const t=(o=(s=(i=e.fields)==null?void 0:i[ad].arrayValue)==null?void 0:s.values)==null?void 0:o.map((l=>bn(l.doubleValue)));return new ao(t)}convertGeoPoint(e){return new oo(bn(e.latitude),bn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Jg(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(gf(e));default:return null}}convertTimestamp(e){const t=Jo(e);return new en(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Kt.fromString(e);Ze(q2(i),9688,{name:e});const s=new bu(i.get(1),i.get(3)),o=new Ve(i.popFirst(5));return s.isEqual(t)||qn(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KM(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Bh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vu extends GM{constructor(e,t,i,s,o,l){super(e,t,i,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ip(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(xE("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ke(ve.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=vu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}vu._jsonSchemaVersion="firestore/documentSnapshot/1.0",vu._jsonSchema={type:Xn("string",vu._jsonSchemaVersion),bundleSource:Xn("string","DocumentSnapshot"),bundleName:Xn("string"),bundle:Xn("string")};class Ip extends vu{data(e={}){return super.data(e)}}class Tu{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Bh(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Ip(this._firestore,this._userDataWriter,i.key,i,new Bh(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ke(ve.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,o){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((d=>{const h=new Ip(s._firestore,s._userDataWriter,d.doc.key,d.doc,new Bh(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);return d.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((d=>o||d.type!==3)).map((d=>{const h=new Ip(s._firestore,s._userDataWriter,d.doc.key,d.doc,new Bh(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,v=-1;return d.type!==0&&(p=l.indexOf(d.doc.key),l=l.delete(d.doc.key)),d.type!==1&&(l=l.add(d.doc),v=l.indexOf(d.doc.key)),{type:Sq(d.type),doc:h,oldIndex:p,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ke(ve.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Tu._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=kT.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],s=[];return this.docs.forEach((o=>{o._document!==null&&(t.push(o._document),i.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),s.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Sq(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return qe(61501,{type:n})}}Tu._jsonSchemaVersion="firestore/querySnapshot/1.0",Tu._jsonSchema={type:Xn("string",Tu._jsonSchemaVersion),bundleSource:Xn("string","QuerySnapshot"),bundleName:Xn("string"),bundle:Xn("string")};class bE extends wq{constructor(e){super(),this.firestore=e}convertBytes(e){return new lr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Gn(this.firestore,null,t)}}function bq(n){n=Bs(n,Bu);const e=Bs(n.firestore,Qo),t=_E(e),i=new bE(e);return HM(n._query),lq(t,n._query).then((s=>new Tu(e,i,n,s)))}function Cq(n,e,t){n=Bs(n,Gn);const i=Bs(n.firestore,Qo),s=KM(n.converter,e,t);return p_(i,[FM(h_(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Ui.none())])}function Ap(n,e,t,...i){n=Bs(n,Gn);const s=Bs(n.firestore,Qo),o=h_(s);let l;return l=typeof(e=Un(e))=="string"||e instanceof c_?yq(o,"updateDoc",n._key,e,t,i):_q(o,"updateDoc",n._key,e),p_(s,[l.toMutation(n._key,Ui.exists(!0))])}function Iq(n){return p_(Bs(n.firestore,Qo),[new t_(n._key,Ui.none())])}function Aq(n,e){const t=Bs(n.firestore,Qo),i=ef(n),s=KM(n.converter,e);return p_(t,[FM(h_(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,Ui.exists(!1))]).then((()=>i))}function Nh(n,...e){var h,p,v;n=Un(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||kA(e[i])||(t=e[i++]);const s={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(kA(e[i])){const x=e[i];e[i]=(h=x.next)==null?void 0:h.bind(x),e[i+1]=(p=x.error)==null?void 0:p.bind(x),e[i+2]=(v=x.complete)==null?void 0:v.bind(x)}let o,l,d;if(n instanceof Gn)l=Bs(n.firestore,Qo),d=Qg(n._key.path),o={next:x=>{e[i]&&e[i](Nq(l,n,x))},error:e[i+1],complete:e[i+2]};else{const x=Bs(n,Bu);l=Bs(x.firestore,Qo),d=x._query;const b=new bE(l);o={next:A=>{e[i]&&e[i](new Tu(l,b,x,A))},error:e[i+1],complete:e[i+2]},HM(n._query)}return(function(b,A,P,F){const H=new PM(F),X=new bM(A,H,P);return b.asyncQueue.enqueueAndForget((async()=>wM(await M0(b),X))),()=>{H.Nu(),b.asyncQueue.enqueueAndForget((async()=>SM(await M0(b),X)))}})(_E(l),d,s,o)}function p_(n,e){return(function(i,s){const o=new Go;return i.asyncQueue.enqueueAndForget((async()=>q8(await aq(i),s,o))),o.promise})(_E(n),e)}function Nq(n,e,t){const i=t.docs.get(e._key),s=new bE(n);return new vu(n,s,e._key,i,new Bh(t.hasPendingWrites,t.fromCache),e.converter)}function VA(){return new yE("serverTimestamp")}function OA(...n){return new vE("arrayUnion",n)}(function(e,t=!0){(function(s){Ad=s})(Uu),Eu(new al("firestore",((i,{instanceIdentifier:s,options:o})=>{const l=i.getProvider("app").getImmediate(),d=new Qo(new ez(i.getProvider("auth-internal")),new iz(l,i.getProvider("app-check-internal")),(function(p,v){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new ke(ve.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bu(p.options.projectId,v)})(l,s),l);return o={useFetchStreams:t,...o},d._setSettings(o),d}),"PUBLIC").setMultipleInstances(!0)),so(mI,pI,e),so(mI,pI,"esm2020")})();var UA={};const FA="@firebase/database",BA="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let WM="";function Rq(n){WM=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mq{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),yi(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:lf(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pq{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return na(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YM=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Mq(e)}}catch{}return new Pq},mu=YM("localStorage"),kq=YM("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc=new Ug("@firebase/database"),Dq=(function(){let n=1;return function(){return n++}})(),JM=function(n){const e=BU(n),t=new VU;t.update(e);const i=t.digest();return pT.encodeByteArray(i)},zf=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=zf.apply(null,i):typeof i=="object"?e+=yi(i):e+=i,e+=" "}return e};let tf=null,zA=!0;const Lq=function(n,e){Me(!0,"Can't turn on custom loggers persistently."),Jc.logLevel=bt.VERBOSE,tf=Jc.log.bind(Jc)},Di=function(...n){if(zA===!0&&(zA=!1,tf===null&&kq.get("logging_enabled")===!0&&Lq()),tf){const e=zf.apply(null,n);tf(e)}},qf=function(n){return function(...e){Di(n,...e)}},L0=function(...n){const e="FIREBASE INTERNAL ERROR: "+zf(...n);Jc.error(e)},$o=function(...n){const e=`FIREBASE FATAL ERROR: ${zf(...n)}`;throw Jc.error(e),new Error(e)},qs=function(...n){const e="FIREBASE WARNING: "+zf(...n);Jc.warn(e)},Vq=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&qs("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ZM=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Oq=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},yd="[MIN_NAME]",Pu="[MAX_NAME]",Dd=function(n,e){if(n===e)return 0;if(n===yd||e===Pu)return-1;if(e===yd||n===Pu)return 1;{const t=qA(n),i=qA(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},Uq=function(n,e){return n===e?0:n<e?-1:1},Rh=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+yi(e))},CE=function(n){if(typeof n!="object"||n===null)return yi(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=yi(e[i]),t+=":",t+=CE(n[e[i]]);return t+="}",t},QM=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function ys(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const $M=function(n){Me(!ZM(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,l,d,h;n===0?(o=0,l=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(d=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=d+i,l=Math.round(n*Math.pow(2,t-d)-Math.pow(2,t))):(o=0,l=Math.round(n/Math.pow(2,1-i-t))));const p=[];for(h=t;h;h-=1)p.push(l%2?1:0),l=Math.floor(l/2);for(h=e;h;h-=1)p.push(o%2?1:0),o=Math.floor(o/2);p.push(s?1:0),p.reverse();const v=p.join("");let x="";for(h=0;h<64;h+=8){let b=parseInt(v.substr(h,8),2).toString(16);b.length===1&&(b="0"+b),x=x+b}return x.toLowerCase()},Fq=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Bq=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function zq(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const qq=new RegExp("^-?(0*)\\d{1,10}$"),Gq=-2147483648,Hq=2147483647,qA=function(n){if(qq.test(n)){const e=Number(n);if(e>=Gq&&e<=Hq)return e}return null},Gf=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw qs("Exception was thrown by user callback.",t),e},Math.floor(0))}},jq=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},nf=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kq{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,ar(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)==null||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){qs(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wq{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Di("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',qs(e)}}class Np{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Np.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE="5",XM="v",eP="s",tP="r",nP="f",iP=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,sP="ls",rP="p",V0="ac",oP="websocket",aP="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e,t,i,s,o=!1,l="",d=!1,h=!1,p=null){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=l,this.includeNamespaceInQueryParams=d,this.isUsingEmulator=h,this.emulatorOptions=p,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=mu.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&mu.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Yq(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function uP(n,e,t){Me(typeof e=="string","typeof type must == string"),Me(typeof t=="object","typeof params must == object");let i;if(e===oP)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===aP)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Yq(n)&&(t.ns=n.namespace);const s=[];return ys(t,(o,l)=>{s.push(o+"="+l)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jq{constructor(){this.counters_={}}incrementCounter(e,t=1){na(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return vU(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nv={},Rv={};function AE(n){const e=n.toString();return Nv[e]||(Nv[e]=new Jq),Nv[e]}function Zq(n,e){const t=n.toString();return Rv[t]||(Rv[t]=e()),Rv[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qq{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Gf(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA="start",$q="close",Xq="pLPCommand",eG="pRTLPCB",cP="id",dP="pw",hP="ser",tG="cb",nG="seg",iG="ts",sG="d",rG="dframe",fP=1870,mP=30,oG=fP-mP,aG=25e3,lG=3e4;class Bc{constructor(e,t,i,s,o,l,d){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=l,this.lastSessionId=d,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=qf(e),this.stats_=AE(t),this.urlFn=h=>(this.appCheckToken&&(h[V0]=this.appCheckToken),uP(t,aP,h))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Qq(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(lG)),Oq(()=>{if(this.isClosed_)return;this.scriptTagHolder=new NE((...o)=>{const[l,d,h,p,v]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,l===GA)this.id=d,this.password=h;else if(l===$q)d?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(d,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+l)},(...o)=>{const[l,d]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(l,d)},()=>{this.onClosed_()},this.urlFn);const i={};i[GA]="t",i[hP]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[tG]=this.scriptTagHolder.uniqueCallbackIdentifier),i[XM]=IE,this.transportSessionId&&(i[eP]=this.transportSessionId),this.lastSessionId&&(i[sP]=this.lastSessionId),this.applicationId&&(i[rP]=this.applicationId),this.appCheckToken&&(i[V0]=this.appCheckToken),typeof location<"u"&&location.hostname&&iP.test(location.hostname)&&(i[tP]=nP);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Bc.forceAllow_=!0}static forceDisallow(){Bc.forceDisallow_=!0}static isAvailable(){return Bc.forceAllow_?!0:!Bc.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Fq()&&!Bq()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=yi(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=IN(t),s=QM(i,oG);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[rG]="t",i[cP]=e,i[dP]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=yi(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class NE{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Dq(),window[Xq+this.uniqueCallbackIdentifier]=e,window[eG+this.uniqueCallbackIdentifier]=t,this.myIFrame=NE.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(d){Di("frame writing exception"),d.stack&&Di(d.stack),Di(d)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Di("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[cP]=this.myID,e[dP]=this.myPW,e[hP]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+mP+i.length<=fP;){const l=this.pendingSegs.shift();i=i+"&"+nG+s+"="+l.seg+"&"+iG+s+"="+l.ts+"&"+sG+s+"="+l.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(aG)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Di("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uG=16384,cG=45e3;let hg=null;typeof MozWebSocket<"u"?hg=MozWebSocket:typeof WebSocket<"u"&&(hg=WebSocket);class Ir{constructor(e,t,i,s,o,l,d){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=qf(this.connId),this.stats_=AE(t),this.connURL=Ir.connectionURL_(t,l,d,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const l={};return l[XM]=IE,typeof location<"u"&&location.hostname&&iP.test(location.hostname)&&(l[tP]=nP),t&&(l[eP]=t),i&&(l[sP]=i),s&&(l[V0]=s),o&&(l[rP]=o),uP(e,oP,l)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,mu.set("previous_websocket_failure",!0);try{let i;NU(),this.mySock=new hg(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Ir.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&hg!==null&&!Ir.forceDisallow_}static previouslyFailed(){return mu.isInMemoryStorage||mu.get("previous_websocket_failure")===!0}markConnectionHealthy(){mu.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=lf(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Me(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=yi(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=QM(t,uG);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(cG))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ir.responsesRequiredToBeHealthy=2;Ir.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{static get ALL_TRANSPORTS(){return[Bc,Ir]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=Ir&&Ir.isAvailable();let i=t&&!Ir.previouslyFailed();if(e.webSocketOnly&&(t||qs("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ir];else{const s=this.transports_=[];for(const o of xf.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);xf.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}xf.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dG=6e4,hG=5e3,fG=10*1024,mG=100*1024,Mv="t",HA="d",pG="s",jA="r",gG="e",KA="o",WA="a",YA="n",JA="p",_G="h";class yG{constructor(e,t,i,s,o,l,d,h,p,v){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=l,this.onReady_=d,this.onDisconnect_=h,this.onKill_=p,this.lastSessionId=v,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=qf("c:"+this.id+":"),this.transportManager_=new xf(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=nf(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>mG?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>fG?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Mv in e){const t=e[Mv];t===WA?this.upgradeIfSecondaryHealthy_():t===jA?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===KA&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Rh("t",e),i=Rh("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:JA,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:WA,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:YA,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Rh("t",e),i=Rh("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Rh(Mv,e);if(HA in e){const i=e[HA];if(t===_G){const s={...i};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===YA){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===pG?this.onConnectionShutdown_(i):t===jA?this.onReset_(i):t===gG?L0("Server Error: "+i):t===KA?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):L0("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),IE!==i&&qs("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),nf(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(dG))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):nf(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(hG))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:JA,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(mu.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(e){this.allowedEvents_=e,this.listeners_={},Me(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){Me(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg extends gP{static getInstance(){return new fg}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!vT()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Me(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA=32,QA=768;class fn{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Wt(){return new fn("")}function Ct(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function hl(n){return n.pieces_.length-n.pieceNum_}function _n(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new fn(n.pieces_,e)}function _P(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function vG(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function yP(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function vP(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new fn(e,0)}function ii(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof fn)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new fn(t,0)}function It(n){return n.pieceNum_>=n.pieces_.length}function gs(n,e){const t=Ct(n),i=Ct(e);if(t===null)return e;if(t===i)return gs(_n(n),_n(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function RE(n,e){if(hl(n)!==hl(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Nr(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(hl(n)>hl(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class TG{constructor(e,t){this.errorPrefix_=t,this.parts_=yP(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Og(this.parts_[i]);TP(this)}}function EG(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Og(e),TP(n)}function xG(n){const e=n.parts_.pop();n.byteLength_-=Og(e),n.parts_.length>0&&(n.byteLength_-=1)}function TP(n){if(n.byteLength_>QA)throw new Error(n.errorPrefix_+"has a key path longer than "+QA+" bytes ("+n.byteLength_+").");if(n.parts_.length>ZA)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ZA+") or object contains a cycle "+ou(n))}function ou(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME extends gP{static getInstance(){return new ME}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(e){return Me(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh=1e3,wG=300*1e3,$A=30*1e3,SG=1.3,bG=3e4,CG="server_kill",XA=3;class Ho extends pP{constructor(e,t,i,s,o,l,d,h){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=l,this.appCheckTokenProvider_=d,this.authOverride_=h,this.id=Ho.nextPersistentConnectionId_++,this.log_=qf("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Mh,this.maxReconnectDelay_=wG,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,h)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ME.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&fg.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(yi(o)),Me(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new gT,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:l=>{const d=l.d;l.s==="ok"?t.resolve(d):t.reject(d)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,l=e._path.toString();this.log_("Listen called for "+l+" "+o),this.listens.has(l)||this.listens.set(l,new Map),Me(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Me(!this.listens.get(l).has(o),"listen() called twice for same path/queryId.");const d={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(l).set(o,d),this.connected_&&this.sendListen_(d)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},l="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(l,o,d=>{const h=d.d,p=d.s;Ho.warnOnListenWarnings_(h,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",d),p!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(p,h))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&na(e,"w")){const i=Xc(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();qs(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||LU(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=$A)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=DU(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,l=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,l))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),Me(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},l="n";s&&(o.q=i,o.t=s),this.sendRequest(l,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,l=>{s&&setTimeout(()=>{s(l.s,l.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const l={p:t,d:i};o!==void 0&&(l.h=o),this.outstandingPuts_.push({action:e,request:l,onComplete:s}),this.outstandingPutCount_++;const d=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(d):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+yi(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):L0("Unrecognized action received from server: "+yi(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Me(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Mh,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Mh,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>bG&&(this.reconnectDelay_=Mh),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*SG)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Ho.nextConnectionId_++,o=this.lastSessionId;let l=!1,d=null;const h=function(){d?d.close():(l=!0,i())},p=function(x){Me(d,"sendRequest call when we're not connected not allowed."),d.sendRequest(x)};this.realtime_={close:h,sendRequest:p};const v=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[x,b]=await Promise.all([this.authTokenProvider_.getToken(v),this.appCheckTokenProvider_.getToken(v)]);l?Di("getToken() completed but was canceled"):(Di("getToken() completed. Creating connection."),this.authToken_=x&&x.accessToken,this.appCheckToken_=b&&b.token,d=new yG(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,A=>{qs(A+" ("+this.repoInfo_.toString()+")"),this.interrupt(CG)},o))}catch(x){this.log_("Failed to get token: "+x),l||(this.repoInfo_.nodeAdmin&&qs(x),h())}}}interrupt(e){Di("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Di("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Yv(this.interruptReasons_)&&(this.reconnectDelay_=Mh,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>CE(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new fn(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){Di("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=XA&&(this.reconnectDelay_=$A,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Di("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=XA&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+WM.replace(/\./g,"-")]=1,vT()?e["framework.cordova"]=1:VN()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=fg.getInstance().currentlyOnline();return Yv(this.interruptReasons_)&&e}}Ho.nextPersistentConnectionId_=0;Ho.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Tt(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new Tt(yd,e),s=new Tt(yd,t);return this.compare(i,s)!==0}minPost(){return Tt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let op;class EP extends g_{static get __EMPTY_NODE(){return op}static set __EMPTY_NODE(e){op=e}compare(e,t){return Dd(e.name,t.name)}isDefinedOn(e){throw bd("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Tt.MIN}maxPost(){return new Tt(Pu,op)}makePost(e,t){return Me(typeof e=="string","KeyIndex indexValue must always be a string."),new Tt(e,op)}toString(){return".key"}}const Zc=new EP;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(e=e,l=t?i(e.key,t):1,s&&(l*=-1),l<0)this.isReverse_?e=e.left:e=e.right;else if(l===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class _i{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??_i.RED,this.left=s??_s.EMPTY_NODE,this.right=o??_s.EMPTY_NODE}copy(e,t,i,s,o){return new _i(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return _s.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return _s.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,_i.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,_i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}_i.RED=!0;_i.BLACK=!1;class IG{copy(e,t,i,s,o){return this}insert(e,t,i){return new _i(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class _s{constructor(e,t=_s.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new _s(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,_i.BLACK,null,null))}remove(e){return new _s(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,_i.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ap(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new ap(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new ap(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new ap(this.root_,null,this.comparator_,!0,e)}}_s.EMPTY_NODE=new IG;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AG(n,e){return Dd(n.name,e.name)}function PE(n,e){return Dd(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let O0;function NG(n){O0=n}const xP=function(n){return typeof n=="number"?"number:"+$M(n):"string:"+n},wP=function(n){if(n.isLeafNode()){const e=n.val();Me(typeof e=="string"||typeof e=="number"||typeof e=="object"&&na(e,".sv"),"Priority must be a string or number.")}else Me(n===O0||n.isEmpty(),"priority of unexpected type.");Me(n===O0||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e1;class mi{static set __childrenNodeConstructor(e){e1=e}static get __childrenNodeConstructor(){return e1}constructor(e,t=mi.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Me(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),wP(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new mi(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:mi.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return It(e)?this:Ct(e)===".priority"?this.priorityNode_:mi.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:mi.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=Ct(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(Me(i!==".priority"||hl(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,mi.__childrenNodeConstructor.EMPTY_NODE.updateChild(_n(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+xP(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=$M(this.value_):e+=this.value_,this.lazyHash_=JM(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===mi.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof mi.__childrenNodeConstructor?-1:(Me(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=mi.VALUE_TYPE_ORDER.indexOf(t),o=mi.VALUE_TYPE_ORDER.indexOf(i);return Me(s>=0,"Unknown leaf type: "+t),Me(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}mi.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SP,bP;function RG(n){SP=n}function MG(n){bP=n}class PG extends g_{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?Dd(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Tt.MIN}maxPost(){return new Tt(Pu,new mi("[PRIORITY-POST]",bP))}makePost(e,t){const i=SP(e);return new Tt(t,new mi("[PRIORITY-POST]",i))}toString(){return".priority"}}const On=new PG;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kG=Math.log(2);class DG{constructor(e){const t=o=>parseInt(Math.log(o)/kG,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const mg=function(n,e,t,i){n.sort(e);const s=function(h,p){const v=p-h;let x,b;if(v===0)return null;if(v===1)return x=n[h],b=t?t(x):x,new _i(b,x.node,_i.BLACK,null,null);{const A=parseInt(v/2,10)+h,P=s(h,A),F=s(A+1,p);return x=n[A],b=t?t(x):x,new _i(b,x.node,_i.BLACK,P,F)}},o=function(h){let p=null,v=null,x=n.length;const b=function(P,F){const H=x-P,X=x;x-=P;const re=s(H+1,X),Q=n[H],he=t?t(Q):Q;A(new _i(he,Q.node,F,null,re))},A=function(P){p?(p.left=P,p=P):(v=P,p=P)};for(let P=0;P<h.count;++P){const F=h.nextBitIsOne(),H=Math.pow(2,h.count-(P+1));F?b(H,_i.BLACK):(b(H,_i.BLACK),b(H,_i.RED))}return v},l=new DG(n.length),d=o(l);return new _s(i||e,d)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pv;const kc={};class qo{static get Default(){return Me(kc&&On,"ChildrenNode.ts has not been loaded"),Pv=Pv||new qo({".priority":kc},{".priority":On}),Pv}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=Xc(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof _s?t:null}hasIndex(e){return na(this.indexSet_,e.toString())}addIndex(e,t){Me(e!==Zc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(Tt.Wrap);let l=o.getNext();for(;l;)s=s||e.isDefinedOn(l.node),i.push(l),l=o.getNext();let d;s?d=mg(i,e.getCompare()):d=kc;const h=e.toString(),p={...this.indexSet_};p[h]=e;const v={...this.indexes_};return v[h]=d,new qo(v,p)}addToIndexes(e,t){const i=Up(this.indexes_,(s,o)=>{const l=Xc(this.indexSet_,o);if(Me(l,"Missing index implementation for "+o),s===kc)if(l.isDefinedOn(e.node)){const d=[],h=t.getIterator(Tt.Wrap);let p=h.getNext();for(;p;)p.name!==e.name&&d.push(p),p=h.getNext();return d.push(e),mg(d,l.getCompare())}else return kc;else{const d=t.get(e.name);let h=s;return d&&(h=h.remove(new Tt(e.name,d))),h.insert(e,e.node)}});return new qo(i,this.indexSet_)}removeFromIndexes(e,t){const i=Up(this.indexes_,s=>{if(s===kc)return s;{const o=t.get(e.name);return o?s.remove(new Tt(e.name,o)):s}});return new qo(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ph;class rt{static get EMPTY_NODE(){return Ph||(Ph=new rt(new _s(PE),null,qo.Default))}constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&wP(this.priorityNode_),this.children_.isEmpty()&&Me(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ph}updatePriority(e){return this.children_.isEmpty()?this:new rt(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Ph:t}}getChild(e){const t=Ct(e);return t===null?this:this.getImmediateChild(t).getChild(_n(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(Me(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new Tt(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const l=s.isEmpty()?Ph:this.priorityNode_;return new rt(s,l,o)}}updateChild(e,t){const i=Ct(e);if(i===null)return t;{Me(Ct(e)!==".priority"||hl(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(_n(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(On,(l,d)=>{t[l]=d.val(e),i++,o&&rt.INTEGER_REGEXP_.test(l)?s=Math.max(s,Number(l)):o=!1}),!e&&o&&s<2*i){const l=[];for(const d in t)l[d]=t[d];return l}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+xP(this.getPriority().val())+":"),this.forEachChild(On,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":JM(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new Tt(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Tt(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Tt(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,Tt.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,Tt.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Hf?-1:0}withIndex(e){if(e===Zc||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new rt(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Zc||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(On),s=t.getIterator(On);let o=i.getNext(),l=s.getNext();for(;o&&l;){if(o.name!==l.name||!o.node.equals(l.node))return!1;o=i.getNext(),l=s.getNext()}return o===null&&l===null}else return!1;else return!1}}resolveIndex_(e){return e===Zc?null:this.indexMap_.get(e.toString())}}rt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class LG extends rt{constructor(){super(new _s(PE),rt.EMPTY_NODE,qo.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return rt.EMPTY_NODE}isEmpty(){return!1}}const Hf=new LG;Object.defineProperties(Tt,{MIN:{value:new Tt(yd,rt.EMPTY_NODE)},MAX:{value:new Tt(Pu,Hf)}});EP.__EMPTY_NODE=rt.EMPTY_NODE;mi.__childrenNodeConstructor=rt;NG(Hf);MG(Hf);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VG=!0;function Li(n,e=null){if(n===null)return rt.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),Me(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new mi(t,Li(e))}if(!(n instanceof Array)&&VG){const t=[];let i=!1;if(ys(n,(l,d)=>{if(l.substring(0,1)!=="."){const h=Li(d);h.isEmpty()||(i=i||!h.getPriority().isEmpty(),t.push(new Tt(l,h)))}}),t.length===0)return rt.EMPTY_NODE;const o=mg(t,AG,l=>l.name,PE);if(i){const l=mg(t,On.getCompare());return new rt(o,Li(e),new qo({".priority":l},{".priority":On}))}else return new rt(o,Li(e),qo.Default)}else{let t=rt.EMPTY_NODE;return ys(n,(i,s)=>{if(na(n,i)&&i.substring(0,1)!=="."){const o=Li(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(Li(e))}}RG(Li);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OG extends g_{constructor(e){super(),this.indexPath_=e,Me(!It(e)&&Ct(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?Dd(e.name,t.name):o}makePost(e,t){const i=Li(e),s=rt.EMPTY_NODE.updateChild(this.indexPath_,i);return new Tt(t,s)}maxPost(){const e=rt.EMPTY_NODE.updateChild(this.indexPath_,Hf);return new Tt(Pu,e)}toString(){return yP(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UG extends g_{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Dd(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Tt.MIN}maxPost(){return Tt.MAX}makePost(e,t){const i=Li(e);return new Tt(t,i)}toString(){return".value"}}const FG=new UG;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CP(n){return{type:"value",snapshotNode:n}}function vd(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function wf(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Sf(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function BG(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kE{constructor(e){this.index_=e}updateChild(e,t,i,s,o,l){Me(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const d=e.getImmediateChild(t);return d.getChild(s).equals(i.getChild(s))&&d.isEmpty()===i.isEmpty()||(l!=null&&(i.isEmpty()?e.hasChild(t)?l.trackChildChange(wf(t,d)):Me(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):d.isEmpty()?l.trackChildChange(vd(t,i)):l.trackChildChange(Sf(t,i,d))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(On,(s,o)=>{t.hasChild(s)||i.trackChildChange(wf(s,o))}),t.isLeafNode()||t.forEachChild(On,(s,o)=>{if(e.hasChild(s)){const l=e.getImmediateChild(s);l.equals(o)||i.trackChildChange(Sf(s,o,l))}else i.trackChildChange(vd(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?rt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e){this.indexedFilter_=new kE(e.getIndex()),this.index_=e.getIndex(),this.startPost_=bf.getStartPost_(e),this.endPost_=bf.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,l){return this.matches(new Tt(t,i))||(i=rt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,l)}updateFullNode(e,t,i){t.isLeafNode()&&(t=rt.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(rt.EMPTY_NODE);const o=this;return t.forEachChild(On,(l,d)=>{o.matches(new Tt(l,d))||(s=s.updateImmediateChild(l,rt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zG{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new bf(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,l){return this.rangedFilter_.matches(new Tt(t,i))||(i=rt.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,l):this.fullLimitUpdateChild_(e,t,i,o,l)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=rt.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=rt.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;o.hasNext()&&l<this.limit_;){const d=o.getNext();if(this.withinDirectionalStart(d))if(this.withinDirectionalEnd(d))s=s.updateImmediateChild(d.name,d.node),l++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(rt.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let l=0;for(;o.hasNext();){const d=o.getNext();l<this.limit_&&this.withinDirectionalStart(d)&&this.withinDirectionalEnd(d)?l++:s=s.updateImmediateChild(d.name,rt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let l;if(this.reverse_){const x=this.index_.getCompare();l=(b,A)=>x(A,b)}else l=this.index_.getCompare();const d=e;Me(d.numChildren()===this.limit_,"");const h=new Tt(t,i),p=this.reverse_?d.getFirstChild(this.index_):d.getLastChild(this.index_),v=this.rangedFilter_.matches(h);if(d.hasChild(t)){const x=d.getImmediateChild(t);let b=s.getChildAfterChild(this.index_,p,this.reverse_);for(;b!=null&&(b.name===t||d.hasChild(b.name));)b=s.getChildAfterChild(this.index_,b,this.reverse_);const A=b==null?1:l(b,h);if(v&&!i.isEmpty()&&A>=0)return o!=null&&o.trackChildChange(Sf(t,i,x)),d.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(wf(t,x));const F=d.updateImmediateChild(t,rt.EMPTY_NODE);return b!=null&&this.rangedFilter_.matches(b)?(o!=null&&o.trackChildChange(vd(b.name,b.node)),F.updateImmediateChild(b.name,b.node)):F}}else return i.isEmpty()?e:v&&l(p,h)>=0?(o!=null&&(o.trackChildChange(wf(p.name,p.node)),o.trackChildChange(vd(t,i))),d.updateImmediateChild(t,i).updateImmediateChild(p.name,rt.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=On}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Me(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Me(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:yd}hasEnd(){return this.endSet_}getIndexEndValue(){return Me(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Me(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Pu}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Me(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===On}copy(){const e=new DE;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function qG(n){return n.loadsAllData()?new kE(n.getIndex()):n.hasLimit()?new zG(n):new bf(n)}function t1(n){const e={};if(n.isDefault())return e;let t;if(n.index_===On?t="$priority":n.index_===FG?t="$value":n.index_===Zc?t="$key":(Me(n.index_ instanceof OG,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=yi(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=yi(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+yi(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=yi(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+yi(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function n1(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==On&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pg extends pP{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(Me(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=qf("p:rest:"),this.listens_={}}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const l=pg.getListenId_(e,i),d={};this.listens_[l]=d;const h=t1(e._queryParams);this.restRequest_(o+".json",h,(p,v)=>{let x=v;if(p===404&&(x=null,p=null),p===null&&this.onDataUpdate_(o,x,!1,i),Xc(this.listens_,l)===d){let b;p?p===401?b="permission_denied":b="rest_error:"+p:b="ok",s(b,null)}})}unlisten(e,t){const i=pg.getListenId_(e,t);delete this.listens_[i]}get(e){const t=t1(e._queryParams),i=e._path.toString(),s=new gT;return this.restRequest_(i+".json",t,(o,l)=>{let d=l;o===404&&(d=null,o=null),o===null?(this.onDataUpdate_(i,d,!1,null),s.resolve(d)):s.reject(new Error(d))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Cd(t);this.log_("Sending REST request for "+l);const d=new XMLHttpRequest;d.onreadystatechange=()=>{if(i&&d.readyState===4){this.log_("REST Response for "+l+" received. status:",d.status,"response:",d.responseText);let h=null;if(d.status>=200&&d.status<300){try{h=lf(d.responseText)}catch{qs("Failed to parse JSON response for "+l+": "+d.responseText)}i(null,h)}else d.status!==401&&d.status!==404&&qs("Got unsuccessful REST response for "+l+" Status: "+d.status),i(d.status);i=null}},d.open("GET",l,!0),d.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GG{constructor(){this.rootNode_=rt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gg(){return{value:null,children:new Map}}function IP(n,e,t){if(It(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=Ct(e);n.children.has(i)||n.children.set(i,gg());const s=n.children.get(i);e=_n(e),IP(s,e,t)}}function U0(n,e,t){n.value!==null?t(e,n.value):HG(n,(i,s)=>{const o=new fn(e.toString()+"/"+i);U0(s,o,t)})}function HG(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jG{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t={...e};return this.last_&&ys(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1=10*1e3,KG=30*1e3,WG=300*1e3;class YG{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new jG(e);const i=i1+(KG-i1)*Math.random();nf(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;ys(e,(s,o)=>{o>0&&na(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),nf(this.reportStats_.bind(this),Math.floor(Math.random()*2*WG))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rr;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Rr||(Rr={}));function AP(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function LE(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function VE(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=Rr.ACK_USER_WRITE,this.source=AP()}operationForChild(e){if(It(this.path)){if(this.affectedTree.value!=null)return Me(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new fn(e));return new _g(Wt(),t,this.revert)}}else return Me(Ct(this.path)===e,"operationForChild called for unrelated child."),new _g(_n(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,t){this.source=e,this.path=t,this.type=Rr.LISTEN_COMPLETE}operationForChild(e){return It(this.path)?new Cf(this.source,Wt()):new Cf(this.source,_n(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=Rr.OVERWRITE}operationForChild(e){return It(this.path)?new ku(this.source,Wt(),this.snap.getImmediateChild(e)):new ku(this.source,_n(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=Rr.MERGE}operationForChild(e){if(It(this.path)){const t=this.children.subtree(new fn(e));return t.isEmpty()?null:t.value?new ku(this.source,Wt(),t.value):new If(this.source,Wt(),t)}else return Me(Ct(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new If(this.source,_n(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(It(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ct(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JG{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function ZG(n,e,t,i){const s=[],o=[];return e.forEach(l=>{l.type==="child_changed"&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&o.push(BG(l.childName,l.snapshotNode))}),kh(n,s,"child_removed",e,i,t),kh(n,s,"child_added",e,i,t),kh(n,s,"child_moved",o,i,t),kh(n,s,"child_changed",e,i,t),kh(n,s,"value",e,i,t),s}function kh(n,e,t,i,s,o){const l=i.filter(d=>d.type===t);l.sort((d,h)=>$G(n,d,h)),l.forEach(d=>{const h=QG(n,d,o);s.forEach(p=>{p.respondsTo(d.type)&&e.push(p.createEvent(h,n.query_))})})}function QG(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function $G(n,e,t){if(e.childName==null||t.childName==null)throw bd("Should only compare child_ events.");const i=new Tt(e.childName,e.snapshotNode),s=new Tt(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __(n,e){return{eventCache:n,serverCache:e}}function sf(n,e,t,i){return __(new Du(e,t,i),n.serverCache)}function NP(n,e,t,i){return __(n.eventCache,new Du(e,t,i))}function F0(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Lu(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kv;const XG=()=>(kv||(kv=new _s(Uq)),kv);class wn{static fromObject(e){let t=new wn(null);return ys(e,(i,s)=>{t=t.set(new fn(i),s)}),t}constructor(e,t=XG()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Wt(),value:this.value};if(It(e))return null;{const i=Ct(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(_n(e),t);return o!=null?{path:ii(new fn(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(It(e))return this;{const t=Ct(e),i=this.children.get(t);return i!==null?i.subtree(_n(e)):new wn(null)}}set(e,t){if(It(e))return new wn(t,this.children);{const i=Ct(e),o=(this.children.get(i)||new wn(null)).set(_n(e),t),l=this.children.insert(i,o);return new wn(this.value,l)}}remove(e){if(It(e))return this.children.isEmpty()?new wn(null):new wn(null,this.children);{const t=Ct(e),i=this.children.get(t);if(i){const s=i.remove(_n(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new wn(null):new wn(this.value,o)}else return this}}get(e){if(It(e))return this.value;{const t=Ct(e),i=this.children.get(t);return i?i.get(_n(e)):null}}setTree(e,t){if(It(e))return t;{const i=Ct(e),o=(this.children.get(i)||new wn(null)).setTree(_n(e),t);let l;return o.isEmpty()?l=this.children.remove(i):l=this.children.insert(i,o),new wn(this.value,l)}}fold(e){return this.fold_(Wt(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(ii(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Wt(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(It(e))return null;{const o=Ct(e),l=this.children.get(o);return l?l.findOnPath_(_n(e),ii(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Wt(),t)}foreachOnPath_(e,t,i){if(It(e))return this;{this.value&&i(t,this.value);const s=Ct(e),o=this.children.get(s);return o?o.foreachOnPath_(_n(e),ii(t,s),i):new wn(null)}}foreach(e){this.foreach_(Wt(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(ii(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.writeTree_=e}static empty(){return new Pr(new wn(null))}}function rf(n,e,t){if(It(e))return new Pr(new wn(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const l=gs(s,e);return o=o.updateChild(l,t),new Pr(n.writeTree_.set(s,o))}else{const s=new wn(t),o=n.writeTree_.setTree(e,s);return new Pr(o)}}}function s1(n,e,t){let i=n;return ys(t,(s,o)=>{i=rf(i,ii(e,s),o)}),i}function r1(n,e){if(It(e))return Pr.empty();{const t=n.writeTree_.setTree(e,new wn(null));return new Pr(t)}}function B0(n,e){return zu(n,e)!=null}function zu(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(gs(t.path,e)):null}function o1(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(On,(i,s)=>{e.push(new Tt(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new Tt(i,s.value))}),e}function rl(n,e){if(It(e))return n;{const t=zu(n,e);return t!=null?new Pr(new wn(t)):new Pr(n.writeTree_.subtree(e))}}function z0(n){return n.writeTree_.isEmpty()}function Td(n,e){return RP(Wt(),n.writeTree_,e)}function RP(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(Me(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=RP(ii(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(ii(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(n,e){return DP(e,n)}function eH(n,e,t,i,s){Me(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=rf(n.visibleWrites,e,t)),n.lastWriteId=i}function tH(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function nH(n,e){const t=n.allWrites.findIndex(d=>d.writeId===e);Me(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,l=n.allWrites.length-1;for(;s&&l>=0;){const d=n.allWrites[l];d.visible&&(l>=t&&iH(d,i.path)?s=!1:Nr(i.path,d.path)&&(o=!0)),l--}if(s){if(o)return sH(n),!0;if(i.snap)n.visibleWrites=r1(n.visibleWrites,i.path);else{const d=i.children;ys(d,h=>{n.visibleWrites=r1(n.visibleWrites,ii(i.path,h))})}return!0}else return!1}function iH(n,e){if(n.snap)return Nr(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Nr(ii(n.path,t),e))return!0;return!1}function sH(n){n.visibleWrites=MP(n.allWrites,rH,Wt()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function rH(n){return n.visible}function MP(n,e,t){let i=Pr.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const l=o.path;let d;if(o.snap)Nr(t,l)?(d=gs(t,l),i=rf(i,d,o.snap)):Nr(l,t)&&(d=gs(l,t),i=rf(i,Wt(),o.snap.getChild(d)));else if(o.children){if(Nr(t,l))d=gs(t,l),i=s1(i,d,o.children);else if(Nr(l,t))if(d=gs(l,t),It(d))i=s1(i,Wt(),o.children);else{const h=Xc(o.children,Ct(d));if(h){const p=h.getChild(_n(d));i=rf(i,Wt(),p)}}}else throw bd("WriteRecord should have .snap or .children")}}return i}function PP(n,e,t,i,s){if(!i&&!s){const o=zu(n.visibleWrites,e);if(o!=null)return o;{const l=rl(n.visibleWrites,e);if(z0(l))return t;if(t==null&&!B0(l,Wt()))return null;{const d=t||rt.EMPTY_NODE;return Td(l,d)}}}else{const o=rl(n.visibleWrites,e);if(!s&&z0(o))return t;if(!s&&t==null&&!B0(o,Wt()))return null;{const l=function(p){return(p.visible||s)&&(!i||!~i.indexOf(p.writeId))&&(Nr(p.path,e)||Nr(e,p.path))},d=MP(n.allWrites,l,e),h=t||rt.EMPTY_NODE;return Td(d,h)}}}function oH(n,e,t){let i=rt.EMPTY_NODE;const s=zu(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(On,(o,l)=>{i=i.updateImmediateChild(o,l)}),i;if(t){const o=rl(n.visibleWrites,e);return t.forEachChild(On,(l,d)=>{const h=Td(rl(o,new fn(l)),d);i=i.updateImmediateChild(l,h)}),o1(o).forEach(l=>{i=i.updateImmediateChild(l.name,l.node)}),i}else{const o=rl(n.visibleWrites,e);return o1(o).forEach(l=>{i=i.updateImmediateChild(l.name,l.node)}),i}}function aH(n,e,t,i,s){Me(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=ii(e,t);if(B0(n.visibleWrites,o))return null;{const l=rl(n.visibleWrites,o);return z0(l)?s.getChild(t):Td(l,s.getChild(t))}}function lH(n,e,t,i){const s=ii(e,t),o=zu(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const l=rl(n.visibleWrites,s);return Td(l,i.getNode().getImmediateChild(t))}else return null}function uH(n,e){return zu(n.visibleWrites,e)}function cH(n,e,t,i,s,o,l){let d;const h=rl(n.visibleWrites,e),p=zu(h,Wt());if(p!=null)d=p;else if(t!=null)d=Td(h,t);else return[];if(d=d.withIndex(l),!d.isEmpty()&&!d.isLeafNode()){const v=[],x=l.getCompare(),b=o?d.getReverseIteratorFrom(i,l):d.getIteratorFrom(i,l);let A=b.getNext();for(;A&&v.length<s;)x(A,i)!==0&&v.push(A),A=b.getNext();return v}else return[]}function dH(){return{visibleWrites:Pr.empty(),allWrites:[],lastWriteId:-1}}function yg(n,e,t,i){return PP(n.writeTree,n.treePath,e,t,i)}function UE(n,e){return oH(n.writeTree,n.treePath,e)}function a1(n,e,t,i){return aH(n.writeTree,n.treePath,e,t,i)}function vg(n,e){return uH(n.writeTree,ii(n.treePath,e))}function hH(n,e,t,i,s,o){return cH(n.writeTree,n.treePath,e,t,i,s,o)}function FE(n,e,t){return lH(n.writeTree,n.treePath,e,t)}function kP(n,e){return DP(ii(n.treePath,e),n.writeTree)}function DP(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fH{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;Me(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),Me(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,Sf(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,wf(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,vd(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,Sf(i,e.snapshotNode,s.oldSnap));else throw bd("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mH{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const LP=new mH;class BE{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new Du(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return FE(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Lu(this.viewCache_),o=hH(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pH(n){return{filter:n}}function gH(n,e){Me(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),Me(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function _H(n,e,t,i,s){const o=new fH;let l,d;if(t.type===Rr.OVERWRITE){const p=t;p.source.fromUser?l=q0(n,e,p.path,p.snap,i,s,o):(Me(p.source.fromServer,"Unknown source."),d=p.source.tagged||e.serverCache.isFiltered()&&!It(p.path),l=Tg(n,e,p.path,p.snap,i,s,d,o))}else if(t.type===Rr.MERGE){const p=t;p.source.fromUser?l=vH(n,e,p.path,p.children,i,s,o):(Me(p.source.fromServer,"Unknown source."),d=p.source.tagged||e.serverCache.isFiltered(),l=G0(n,e,p.path,p.children,i,s,d,o))}else if(t.type===Rr.ACK_USER_WRITE){const p=t;p.revert?l=xH(n,e,p.path,i,s,o):l=TH(n,e,p.path,p.affectedTree,i,s,o)}else if(t.type===Rr.LISTEN_COMPLETE)l=EH(n,e,t.path,i,o);else throw bd("Unknown operation type: "+t.type);const h=o.getChanges();return yH(e,l,h),{viewCache:l,changes:h}}function yH(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=F0(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(CP(F0(e)))}}function VP(n,e,t,i,s,o){const l=e.eventCache;if(vg(i,t)!=null)return e;{let d,h;if(It(t))if(Me(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const p=Lu(e),v=p instanceof rt?p:rt.EMPTY_NODE,x=UE(i,v);d=n.filter.updateFullNode(e.eventCache.getNode(),x,o)}else{const p=yg(i,Lu(e));d=n.filter.updateFullNode(e.eventCache.getNode(),p,o)}else{const p=Ct(t);if(p===".priority"){Me(hl(t)===1,"Can't have a priority with additional path components");const v=l.getNode();h=e.serverCache.getNode();const x=a1(i,t,v,h);x!=null?d=n.filter.updatePriority(v,x):d=l.getNode()}else{const v=_n(t);let x;if(l.isCompleteForChild(p)){h=e.serverCache.getNode();const b=a1(i,t,l.getNode(),h);b!=null?x=l.getNode().getImmediateChild(p).updateChild(v,b):x=l.getNode().getImmediateChild(p)}else x=FE(i,p,e.serverCache);x!=null?d=n.filter.updateChild(l.getNode(),p,x,v,s,o):d=l.getNode()}}return sf(e,d,l.isFullyInitialized()||It(t),n.filter.filtersNodes())}}function Tg(n,e,t,i,s,o,l,d){const h=e.serverCache;let p;const v=l?n.filter:n.filter.getIndexedFilter();if(It(t))p=v.updateFullNode(h.getNode(),i,null);else if(v.filtersNodes()&&!h.isFiltered()){const A=h.getNode().updateChild(t,i);p=v.updateFullNode(h.getNode(),A,null)}else{const A=Ct(t);if(!h.isCompleteForPath(t)&&hl(t)>1)return e;const P=_n(t),H=h.getNode().getImmediateChild(A).updateChild(P,i);A===".priority"?p=v.updatePriority(h.getNode(),H):p=v.updateChild(h.getNode(),A,H,P,LP,null)}const x=NP(e,p,h.isFullyInitialized()||It(t),v.filtersNodes()),b=new BE(s,x,o);return VP(n,x,t,s,b,d)}function q0(n,e,t,i,s,o,l){const d=e.eventCache;let h,p;const v=new BE(s,e,o);if(It(t))p=n.filter.updateFullNode(e.eventCache.getNode(),i,l),h=sf(e,p,!0,n.filter.filtersNodes());else{const x=Ct(t);if(x===".priority")p=n.filter.updatePriority(e.eventCache.getNode(),i),h=sf(e,p,d.isFullyInitialized(),d.isFiltered());else{const b=_n(t),A=d.getNode().getImmediateChild(x);let P;if(It(b))P=i;else{const F=v.getCompleteChild(x);F!=null?_P(b)===".priority"&&F.getChild(vP(b)).isEmpty()?P=F:P=F.updateChild(b,i):P=rt.EMPTY_NODE}if(A.equals(P))h=e;else{const F=n.filter.updateChild(d.getNode(),x,P,b,v,l);h=sf(e,F,d.isFullyInitialized(),n.filter.filtersNodes())}}}return h}function l1(n,e){return n.eventCache.isCompleteForChild(e)}function vH(n,e,t,i,s,o,l){let d=e;return i.foreach((h,p)=>{const v=ii(t,h);l1(e,Ct(v))&&(d=q0(n,d,v,p,s,o,l))}),i.foreach((h,p)=>{const v=ii(t,h);l1(e,Ct(v))||(d=q0(n,d,v,p,s,o,l))}),d}function u1(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function G0(n,e,t,i,s,o,l,d){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let h=e,p;It(t)?p=i:p=new wn(null).setTree(t,i);const v=e.serverCache.getNode();return p.children.inorderTraversal((x,b)=>{if(v.hasChild(x)){const A=e.serverCache.getNode().getImmediateChild(x),P=u1(n,A,b);h=Tg(n,h,new fn(x),P,s,o,l,d)}}),p.children.inorderTraversal((x,b)=>{const A=!e.serverCache.isCompleteForChild(x)&&b.value===null;if(!v.hasChild(x)&&!A){const P=e.serverCache.getNode().getImmediateChild(x),F=u1(n,P,b);h=Tg(n,h,new fn(x),F,s,o,l,d)}}),h}function TH(n,e,t,i,s,o,l){if(vg(s,t)!=null)return e;const d=e.serverCache.isFiltered(),h=e.serverCache;if(i.value!=null){if(It(t)&&h.isFullyInitialized()||h.isCompleteForPath(t))return Tg(n,e,t,h.getNode().getChild(t),s,o,d,l);if(It(t)){let p=new wn(null);return h.getNode().forEachChild(Zc,(v,x)=>{p=p.set(new fn(v),x)}),G0(n,e,t,p,s,o,d,l)}else return e}else{let p=new wn(null);return i.foreach((v,x)=>{const b=ii(t,v);h.isCompleteForPath(b)&&(p=p.set(v,h.getNode().getChild(b)))}),G0(n,e,t,p,s,o,d,l)}}function EH(n,e,t,i,s){const o=e.serverCache,l=NP(e,o.getNode(),o.isFullyInitialized()||It(t),o.isFiltered());return VP(n,l,t,i,LP,s)}function xH(n,e,t,i,s,o){let l;if(vg(i,t)!=null)return e;{const d=new BE(i,e,s),h=e.eventCache.getNode();let p;if(It(t)||Ct(t)===".priority"){let v;if(e.serverCache.isFullyInitialized())v=yg(i,Lu(e));else{const x=e.serverCache.getNode();Me(x instanceof rt,"serverChildren would be complete if leaf node"),v=UE(i,x)}v=v,p=n.filter.updateFullNode(h,v,o)}else{const v=Ct(t);let x=FE(i,v,e.serverCache);x==null&&e.serverCache.isCompleteForChild(v)&&(x=h.getImmediateChild(v)),x!=null?p=n.filter.updateChild(h,v,x,_n(t),d,o):e.eventCache.getNode().hasChild(v)?p=n.filter.updateChild(h,v,rt.EMPTY_NODE,_n(t),d,o):p=h,p.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=yg(i,Lu(e)),l.isLeafNode()&&(p=n.filter.updateFullNode(p,l,o)))}return l=e.serverCache.isFullyInitialized()||vg(i,Wt())!=null,sf(e,p,l,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wH{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new kE(i.getIndex()),o=qG(i);this.processor_=pH(o);const l=t.serverCache,d=t.eventCache,h=s.updateFullNode(rt.EMPTY_NODE,l.getNode(),null),p=o.updateFullNode(rt.EMPTY_NODE,d.getNode(),null),v=new Du(h,l.isFullyInitialized(),s.filtersNodes()),x=new Du(p,d.isFullyInitialized(),o.filtersNodes());this.viewCache_=__(x,v),this.eventGenerator_=new JG(this.query_)}get query(){return this.query_}}function SH(n){return n.viewCache_.serverCache.getNode()}function bH(n,e){const t=Lu(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!It(e)&&!t.getImmediateChild(Ct(e)).isEmpty())?t.getChild(e):null}function c1(n){return n.eventRegistrations_.length===0}function CH(n,e){n.eventRegistrations_.push(e)}function d1(n,e,t){const i=[];if(t){Me(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const l=o.createCancelEvent(t,s);l&&i.push(l)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const l=n.eventRegistrations_[o];if(!l.matches(e))s.push(l);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function h1(n,e,t,i){e.type===Rr.MERGE&&e.source.queryId!==null&&(Me(Lu(n.viewCache_),"We should always have a full cache before handling merges"),Me(F0(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=_H(n.processor_,s,e,t,i);return gH(n.processor_,o.viewCache),Me(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,OP(n,o.changes,o.viewCache.eventCache.getNode(),null)}function IH(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(On,(o,l)=>{i.push(vd(o,l))}),t.isFullyInitialized()&&i.push(CP(t.getNode())),OP(n,i,t.getNode(),e)}function OP(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return ZG(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Eg;class AH{constructor(){this.views=new Map}}function NH(n){Me(!Eg,"__referenceConstructor has already been defined"),Eg=n}function RH(){return Me(Eg,"Reference.ts has not been loaded"),Eg}function MH(n){return n.views.size===0}function zE(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return Me(o!=null,"SyncTree gave us an op for an invalid query."),h1(o,e,t,i)}else{let o=[];for(const l of n.views.values())o=o.concat(h1(l,e,t,i));return o}}function PH(n,e,t,i,s){const o=e._queryIdentifier,l=n.views.get(o);if(!l){let d=yg(t,s?i:null),h=!1;d?h=!0:i instanceof rt?(d=UE(t,i),h=!1):(d=rt.EMPTY_NODE,h=!1);const p=__(new Du(d,h,!1),new Du(i,s,!1));return new wH(e,p)}return l}function kH(n,e,t,i,s,o){const l=PH(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,l),CH(l,t),IH(l,t)}function DH(n,e,t,i){const s=e._queryIdentifier,o=[];let l=[];const d=fl(n);if(s==="default")for(const[h,p]of n.views.entries())l=l.concat(d1(p,t,i)),c1(p)&&(n.views.delete(h),p.query._queryParams.loadsAllData()||o.push(p.query));else{const h=n.views.get(s);h&&(l=l.concat(d1(h,t,i)),c1(h)&&(n.views.delete(s),h.query._queryParams.loadsAllData()||o.push(h.query)))}return d&&!fl(n)&&o.push(new(RH())(e._repo,e._path)),{removed:o,events:l}}function UP(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Qc(n,e){let t=null;for(const i of n.views.values())t=t||bH(i,e);return t}function FP(n,e){if(e._queryParams.loadsAllData())return y_(n);{const i=e._queryIdentifier;return n.views.get(i)}}function BP(n,e){return FP(n,e)!=null}function fl(n){return y_(n)!=null}function y_(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xg;function LH(n){Me(!xg,"__referenceConstructor has already been defined"),xg=n}function VH(){return Me(xg,"Reference.ts has not been loaded"),xg}let OH=1;class f1{constructor(e){this.listenProvider_=e,this.syncPointTree_=new wn(null),this.pendingWriteTree_=dH(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function UH(n,e,t,i,s){return eH(n.pendingWriteTree_,e,t,i,s),s?jf(n,new ku(AP(),e,t)):[]}function zc(n,e,t=!1){const i=tH(n.pendingWriteTree_,e);if(nH(n.pendingWriteTree_,e)){let o=new wn(null);return i.snap!=null?o=o.set(Wt(),!0):ys(i.children,l=>{o=o.set(new fn(l),!0)}),jf(n,new _g(i.path,o,t))}else return[]}function v_(n,e,t){return jf(n,new ku(LE(),e,t))}function FH(n,e,t){const i=wn.fromObject(t);return jf(n,new If(LE(),e,i))}function BH(n,e){return jf(n,new Cf(LE(),e))}function zH(n,e,t){const i=qE(n,t);if(i){const s=GE(i),o=s.path,l=s.queryId,d=gs(o,e),h=new Cf(VE(l),d);return HE(n,o,h)}else return[]}function H0(n,e,t,i,s=!1){const o=e._path,l=n.syncPointTree_.get(o);let d=[];if(l&&(e._queryIdentifier==="default"||BP(l,e))){const h=DH(l,e,t,i);MH(l)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const p=h.removed;if(d=h.events,!s){const v=p.findIndex(b=>b._queryParams.loadsAllData())!==-1,x=n.syncPointTree_.findOnPath(o,(b,A)=>fl(A));if(v&&!x){const b=n.syncPointTree_.subtree(o);if(!b.isEmpty()){const A=HH(b);for(let P=0;P<A.length;++P){const F=A[P],H=F.query,X=HP(n,F);n.listenProvider_.startListening(of(H),wg(n,H),X.hashFn,X.onComplete)}}}!x&&p.length>0&&!i&&(v?n.listenProvider_.stopListening(of(e),null):p.forEach(b=>{const A=n.queryToTagMap.get(T_(b));n.listenProvider_.stopListening(of(b),A)}))}jH(n,p)}return d}function qH(n,e,t,i){const s=qE(n,i);if(s!=null){const o=GE(s),l=o.path,d=o.queryId,h=gs(l,e),p=new ku(VE(d),h,t);return HE(n,l,p)}else return[]}function GH(n,e,t,i){const s=qE(n,i);if(s){const o=GE(s),l=o.path,d=o.queryId,h=gs(l,e),p=wn.fromObject(t),v=new If(VE(d),h,p);return HE(n,l,v)}else return[]}function m1(n,e,t,i=!1){const s=e._path;let o=null,l=!1;n.syncPointTree_.foreachOnPath(s,(b,A)=>{const P=gs(b,s);o=o||Qc(A,P),l=l||fl(A)});let d=n.syncPointTree_.get(s);d?(l=l||fl(d),o=o||Qc(d,Wt())):(d=new AH,n.syncPointTree_=n.syncPointTree_.set(s,d));let h;o!=null?h=!0:(h=!1,o=rt.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((A,P)=>{const F=Qc(P,Wt());F&&(o=o.updateImmediateChild(A,F))}));const p=BP(d,e);if(!p&&!e._queryParams.loadsAllData()){const b=T_(e);Me(!n.queryToTagMap.has(b),"View does not exist, but we have a tag");const A=KH();n.queryToTagMap.set(b,A),n.tagToQueryMap.set(A,b)}const v=OE(n.pendingWriteTree_,s);let x=kH(d,e,t,v,o,h);if(!p&&!l&&!i){const b=FP(d,e);x=x.concat(WH(n,e,b))}return x}function zP(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(l,d)=>{const h=gs(l,e),p=Qc(d,h);if(p)return p});return PP(s,e,o,t,!0)}function jf(n,e){return qP(e,n.syncPointTree_,null,OE(n.pendingWriteTree_,Wt()))}function qP(n,e,t,i){if(It(n.path))return GP(n,e,t,i);{const s=e.get(Wt());t==null&&s!=null&&(t=Qc(s,Wt()));let o=[];const l=Ct(n.path),d=n.operationForChild(l),h=e.children.get(l);if(h&&d){const p=t?t.getImmediateChild(l):null,v=kP(i,l);o=o.concat(qP(d,h,p,v))}return s&&(o=o.concat(zE(s,n,i,t))),o}}function GP(n,e,t,i){const s=e.get(Wt());t==null&&s!=null&&(t=Qc(s,Wt()));let o=[];return e.children.inorderTraversal((l,d)=>{const h=t?t.getImmediateChild(l):null,p=kP(i,l),v=n.operationForChild(l);v&&(o=o.concat(GP(v,d,h,p)))}),s&&(o=o.concat(zE(s,n,i,t))),o}function HP(n,e){const t=e.query,i=wg(n,t);return{hashFn:()=>(SH(e)||rt.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?zH(n,t._path,i):BH(n,t._path);{const o=zq(s,t);return H0(n,t,null,o)}}}}function wg(n,e){const t=T_(e);return n.queryToTagMap.get(t)}function T_(n){return n._path.toString()+"$"+n._queryIdentifier}function qE(n,e){return n.tagToQueryMap.get(e)}function GE(n){const e=n.indexOf("$");return Me(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new fn(n.substr(0,e))}}function HE(n,e,t){const i=n.syncPointTree_.get(e);Me(i,"Missing sync point for query tag that we're tracking");const s=OE(n.pendingWriteTree_,e);return zE(i,t,s,null)}function HH(n){return n.fold((e,t,i)=>{if(t&&fl(t))return[y_(t)];{let s=[];return t&&(s=UP(t)),ys(i,(o,l)=>{s=s.concat(l)}),s}})}function of(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(VH())(n._repo,n._path):n}function jH(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=T_(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function KH(){return OH++}function WH(n,e,t){const i=e._path,s=wg(n,e),o=HP(n,t),l=n.listenProvider_.startListening(of(e),s,o.hashFn,o.onComplete),d=n.syncPointTree_.subtree(i);if(s)Me(!fl(d.value),"If we're adding a query, it shouldn't be shadowed");else{const h=d.fold((p,v,x)=>{if(!It(p)&&v&&fl(v))return[y_(v).query];{let b=[];return v&&(b=b.concat(UP(v).map(A=>A.query))),ys(x,(A,P)=>{b=b.concat(P)}),b}});for(let p=0;p<h.length;++p){const v=h[p];n.listenProvider_.stopListening(of(v),wg(n,v))}}return l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new jE(t)}node(){return this.node_}}class KE{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=ii(this.path_,e);return new KE(this.syncTree_,t)}node(){return zP(this.syncTree_,this.path_)}}const YH=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},p1=function(n,e,t){if(!n||typeof n!="object")return n;if(Me(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return JH(n[".sv"],e,t);if(typeof n[".sv"]=="object")return ZH(n[".sv"],e);Me(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},JH=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:Me(!1,"Unexpected server value: "+n)}},ZH=function(n,e,t){n.hasOwnProperty("increment")||Me(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&Me(!1,"Unexpected increment value: "+i);const s=e.node();if(Me(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const l=s.getValue();return typeof l!="number"?i:l+i},QH=function(n,e,t,i){return WE(e,new KE(t,n),i)},$H=function(n,e,t){return WE(n,new jE(e),t)};function WE(n,e,t){const i=n.getPriority().val(),s=p1(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const l=n,d=p1(l.getValue(),e,t);return d!==l.getValue()||s!==l.getPriority().val()?new mi(d,Li(s)):n}else{const l=n;return o=l,s!==l.getPriority().val()&&(o=o.updatePriority(new mi(s))),l.forEachChild(On,(d,h)=>{const p=WE(h,e.getImmediateChild(d),t);p!==h&&(o=o.updateImmediateChild(d,p))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function JE(n,e){let t=e instanceof fn?e:new fn(e),i=n,s=Ct(t);for(;s!==null;){const o=Xc(i.node.children,s)||{children:{},childCount:0};i=new YE(s,i,o),t=_n(t),s=Ct(t)}return i}function Ld(n){return n.node.value}function jP(n,e){n.node.value=e,j0(n)}function KP(n){return n.node.childCount>0}function XH(n){return Ld(n)===void 0&&!KP(n)}function E_(n,e){ys(n.node.children,(t,i)=>{e(new YE(t,n,i))})}function WP(n,e,t,i){t&&e(n),E_(n,s=>{WP(s,e,!0)})}function ej(n,e,t){let i=n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Kf(n){return new fn(n.parent===null?n.name:Kf(n.parent)+"/"+n.name)}function j0(n){n.parent!==null&&tj(n.parent,n.name,n)}function tj(n,e,t){const i=XH(t),s=na(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,j0(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,j0(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nj=/[\[\].#$\/\u0000-\u001F\u007F]/,ij=/[\[\].#$\u0000-\u001F\u007F]/,Dv=10*1024*1024,YP=function(n){return typeof n=="string"&&n.length!==0&&!nj.test(n)},JP=function(n){return typeof n=="string"&&n.length!==0&&!ij.test(n)},sj=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),JP(n)},ZP=function(n,e,t){const i=t instanceof fn?new TG(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+ou(i));if(typeof e=="function")throw new Error(n+"contains a function "+ou(i)+" with contents = "+e.toString());if(ZM(e))throw new Error(n+"contains "+e.toString()+" "+ou(i));if(typeof e=="string"&&e.length>Dv/3&&Og(e)>Dv)throw new Error(n+"contains a string greater than "+Dv+" utf8 bytes "+ou(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(ys(e,(l,d)=>{if(l===".value")s=!0;else if(l!==".priority"&&l!==".sv"&&(o=!0,!YP(l)))throw new Error(n+" contains an invalid key ("+l+") "+ou(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);EG(i,l),ZP(n,d,i),xG(i)}),s&&o)throw new Error(n+' contains ".value" child '+ou(i)+" in addition to actual children.")}},QP=function(n,e,t,i){if(!JP(t))throw new Error(zN(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},rj=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),QP(n,e,t)},oj=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!YP(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!sj(t))throw new Error(zN(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function $P(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!RE(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function XP(n,e,t){$P(n,t),ek(n,i=>RE(i,e))}function qu(n,e,t){$P(n,t),ek(n,i=>Nr(i,e)||Nr(e,i))}function ek(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(lj(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function lj(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();tf&&Di("event: "+t.toString()),Gf(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj="repo_interrupt",cj=25;class dj{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new aj,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=gg(),this.transactionQueueTree_=new YE,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function hj(n,e,t){if(n.stats_=AE(n.repoInfo_),n.forceRestClient_||jq())n.server_=new pg(n.repoInfo_,(i,s,o,l)=>{g1(n,i,s,o,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>_1(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{yi(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Ho(n.repoInfo_,e,(i,s,o,l)=>{g1(n,i,s,o,l)},i=>{_1(n,i)},i=>{mj(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=Zq(n.repoInfo_,()=>new YG(n.stats_,n.server_)),n.infoData_=new GG,n.infoSyncTree_=new f1({startListening:(i,s,o,l)=>{let d=[];const h=n.infoData_.getNode(i._path);return h.isEmpty()||(d=v_(n.infoSyncTree_,i._path,h),setTimeout(()=>{l("ok")},0)),d},stopListening:()=>{}}),ZE(n,"connected",!1),n.serverSyncTree_=new f1({startListening:(i,s,o,l)=>(n.server_.listen(i,o,s,(d,h)=>{const p=l(d,h);qu(n.eventQueue_,i._path,p)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function fj(n){const t=n.infoData_.getNode(new fn(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function tk(n){return YH({timestamp:fj(n)})}function g1(n,e,t,i,s){n.dataUpdateCount++;const o=new fn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(s)if(i){const h=Up(t,p=>Li(p));l=GH(n.serverSyncTree_,o,h,s)}else{const h=Li(t);l=qH(n.serverSyncTree_,o,h,s)}else if(i){const h=Up(t,p=>Li(p));l=FH(n.serverSyncTree_,o,h)}else{const h=Li(t);l=v_(n.serverSyncTree_,o,h)}let d=o;l.length>0&&(d=$E(n,o)),qu(n.eventQueue_,d,l)}function _1(n,e){ZE(n,"connected",e),e===!1&&gj(n)}function mj(n,e){ys(e,(t,i)=>{ZE(n,t,i)})}function ZE(n,e,t){const i=new fn("/.info/"+e),s=Li(t);n.infoData_.updateSnapshot(i,s);const o=v_(n.infoSyncTree_,i,s);qu(n.eventQueue_,i,o)}function pj(n){return n.nextWriteId_++}function gj(n){nk(n,"onDisconnectEvents");const e=tk(n),t=gg();U0(n.onDisconnect_,Wt(),(s,o)=>{const l=QH(s,o,n.serverSyncTree_,e);IP(t,s,l)});let i=[];U0(t,Wt(),(s,o)=>{i=i.concat(v_(n.serverSyncTree_,s,o));const l=xj(n,s);$E(n,l)}),n.onDisconnect_=gg(),qu(n.eventQueue_,Wt(),i)}function _j(n,e,t){let i;Ct(e._path)===".info"?i=m1(n.infoSyncTree_,e,t):i=m1(n.serverSyncTree_,e,t),XP(n.eventQueue_,e._path,i)}function yj(n,e,t){let i;Ct(e._path)===".info"?i=H0(n.infoSyncTree_,e,t):i=H0(n.serverSyncTree_,e,t),XP(n.eventQueue_,e._path,i)}function vj(n){n.persistentConnection_&&n.persistentConnection_.interrupt(uj)}function nk(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Di(t,...e)}function ik(n,e,t){return zP(n.serverSyncTree_,e,t)||rt.EMPTY_NODE}function QE(n,e=n.transactionQueueTree_){if(e||x_(n,e),Ld(e)){const t=rk(n,e);Me(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&Tj(n,Kf(e),t)}else KP(e)&&E_(e,t=>{QE(n,t)})}function Tj(n,e,t){const i=t.map(p=>p.currentWriteId),s=ik(n,e,i);let o=s;const l=s.hash();for(let p=0;p<t.length;p++){const v=t[p];Me(v.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),v.status=1,v.retryCount++;const x=gs(e,v.path);o=o.updateChild(x,v.currentOutputSnapshotRaw)}const d=o.val(!0),h=e;n.server_.put(h.toString(),d,p=>{nk(n,"transaction put response",{path:h.toString(),status:p});let v=[];if(p==="ok"){const x=[];for(let b=0;b<t.length;b++)t[b].status=2,v=v.concat(zc(n.serverSyncTree_,t[b].currentWriteId)),t[b].onComplete&&x.push(()=>t[b].onComplete(null,!0,t[b].currentOutputSnapshotResolved)),t[b].unwatcher();x_(n,JE(n.transactionQueueTree_,e)),QE(n,n.transactionQueueTree_),qu(n.eventQueue_,e,v);for(let b=0;b<x.length;b++)Gf(x[b])}else{if(p==="datastale")for(let x=0;x<t.length;x++)t[x].status===3?t[x].status=4:t[x].status=0;else{qs("transaction at "+h.toString()+" failed: "+p);for(let x=0;x<t.length;x++)t[x].status=4,t[x].abortReason=p}$E(n,e)}},l)}function $E(n,e){const t=sk(n,e),i=Kf(t),s=rk(n,t);return Ej(n,s,i),i}function Ej(n,e,t){if(e.length===0)return;const i=[];let s=[];const l=e.filter(d=>d.status===0).map(d=>d.currentWriteId);for(let d=0;d<e.length;d++){const h=e[d],p=gs(t,h.path);let v=!1,x;if(Me(p!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),h.status===4)v=!0,x=h.abortReason,s=s.concat(zc(n.serverSyncTree_,h.currentWriteId,!0));else if(h.status===0)if(h.retryCount>=cj)v=!0,x="maxretry",s=s.concat(zc(n.serverSyncTree_,h.currentWriteId,!0));else{const b=ik(n,h.path,l);h.currentInputSnapshot=b;const A=e[d].update(b.val());if(A!==void 0){ZP("transaction failed: Data returned ",A,h.path);let P=Li(A);typeof A=="object"&&A!=null&&na(A,".priority")||(P=P.updatePriority(b.getPriority()));const H=h.currentWriteId,X=tk(n),re=$H(P,b,X);h.currentOutputSnapshotRaw=P,h.currentOutputSnapshotResolved=re,h.currentWriteId=pj(n),l.splice(l.indexOf(H),1),s=s.concat(UH(n.serverSyncTree_,h.path,re,h.currentWriteId,h.applyLocally)),s=s.concat(zc(n.serverSyncTree_,H,!0))}else v=!0,x="nodata",s=s.concat(zc(n.serverSyncTree_,h.currentWriteId,!0))}qu(n.eventQueue_,t,s),s=[],v&&(e[d].status=2,(function(b){setTimeout(b,Math.floor(0))})(e[d].unwatcher),e[d].onComplete&&(x==="nodata"?i.push(()=>e[d].onComplete(null,!1,e[d].currentInputSnapshot)):i.push(()=>e[d].onComplete(new Error(x),!1,null))))}x_(n,n.transactionQueueTree_);for(let d=0;d<i.length;d++)Gf(i[d]);QE(n,n.transactionQueueTree_)}function sk(n,e){let t,i=n.transactionQueueTree_;for(t=Ct(e);t!==null&&Ld(i)===void 0;)i=JE(i,t),e=_n(e),t=Ct(e);return i}function rk(n,e){const t=[];return ok(n,e,t),t.sort((i,s)=>i.order-s.order),t}function ok(n,e,t){const i=Ld(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);E_(e,s=>{ok(n,s,t)})}function x_(n,e){const t=Ld(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,jP(e,t.length>0?t:void 0)}E_(e,i=>{x_(n,i)})}function xj(n,e){const t=Kf(sk(n,e)),i=JE(n.transactionQueueTree_,e);return ej(i,s=>{Lv(n,s)}),Lv(n,i),WP(i,s=>{Lv(n,s)}),t}function Lv(n,e){const t=Ld(e);if(t){const i=[];let s=[],o=-1;for(let l=0;l<t.length;l++)t[l].status===3||(t[l].status===1?(Me(o===l-1,"All SENT items should be at beginning of queue."),o=l,t[l].status=3,t[l].abortReason="set"):(Me(t[l].status===0,"Unexpected transaction status in abort"),t[l].unwatcher(),s=s.concat(zc(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&i.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));o===-1?jP(e,void 0):t.length=o+1,qu(n.eventQueue_,Kf(e),s);for(let l=0;l<i.length;l++)Gf(i[l])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wj(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function Sj(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):qs(`Invalid query segment '${t}' in query '${n}'`)}return e}const y1=function(n,e){const t=bj(n),i=t.namespace;t.domain==="firebase.com"&&$o(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&$o("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Vq();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new lP(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new fn(t.pathString)}},bj=function(n){let e="",t="",i="",s="",o="",l=!0,d="https",h=443;if(typeof n=="string"){let p=n.indexOf("//");p>=0&&(d=n.substring(0,p-1),n=n.substring(p+2));let v=n.indexOf("/");v===-1&&(v=n.length);let x=n.indexOf("?");x===-1&&(x=n.length),e=n.substring(0,Math.min(v,x)),v<x&&(s=wj(n.substring(v,x)));const b=Sj(n.substring(Math.min(n.length,x)));p=e.indexOf(":"),p>=0?(l=d==="https"||d==="wss",h=parseInt(e.substring(p+1),10)):p=e.length;const A=e.slice(0,p);if(A.toLowerCase()==="localhost")t="localhost";else if(A.split(".").length<=2)t=A;else{const P=e.indexOf(".");i=e.substring(0,P).toLowerCase(),t=e.substring(P+1),o=i}"ns"in b&&(o=b.ns)}return{host:e,port:h,domain:t,subdomain:i,secure:l,scheme:d,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+yi(this.snapshot.exportVal())}}class Ij{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Me(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return It(this._path)?null:_P(this._path)}get ref(){return new Tl(this._repo,this._path)}get _queryIdentifier(){const e=n1(this._queryParams),t=CE(e);return t==="{}"?"default":t}get _queryObject(){return n1(this._queryParams)}isEqual(e){if(e=Un(e),!(e instanceof XE))return!1;const t=this._repo===e._repo,i=RE(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+vG(this._path)}}class Tl extends XE{constructor(e,t){super(e,t,new DE,!1)}get parent(){const e=vP(this._path);return e===null?null:new Tl(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Sg{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new fn(e),i=K0(this.ref,e);return new Sg(this._node.getChild(t),i,On)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new Sg(s,K0(this.ref,i),On)))}hasChild(e){const t=new fn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Nj(n,e){return n=Un(n),n._checkNotDeleted("ref"),K0(n._root,e)}function K0(n,e){return n=Un(n),Ct(n._path)===null?rj("child","path",e):QP("child","path",e),new Tl(n._repo,ii(n._path,e))}class ex{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new Cj("value",this,new Sg(e.snapshotNode,new Tl(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ij(this,e,t):null}matches(e){return e instanceof ex?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Rj(n,e,t,i,s){const o=new Aj(t,void 0),l=new ex(o);return _j(n._repo,n,l),()=>yj(n._repo,n,l)}function Mj(n,e,t,i){return Rj(n,"value",e)}NH(Tl);LH(Tl);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pj="FIREBASE_DATABASE_EMULATOR_HOST",W0={};let kj=!1;function Dj(n,e,t,i){const s=e.lastIndexOf(":"),o=e.substring(0,s),l=pl(o);n.repoInfo_=new lP(e,l,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),i&&(n.authTokenProvider_=i)}function Lj(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||$o("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Di("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let l=y1(o,s),d=l.repoInfo,h;typeof process<"u"&&UA&&(h=UA[Pj]),h?(o=`http://${h}?ns=${d.namespace}`,l=y1(o,s),d=l.repoInfo):l.repoInfo.secure;const p=new Wq(n.name,n.options,e);oj("Invalid Firebase Database URL",l),It(l.path)||$o("Database URL must point to the root of a Firebase Database (not including a child path).");const v=Oj(d,n,p,new Kq(n,t));return new Uj(v,n)}function Vj(n,e){const t=W0[e];(!t||t[n.key]!==n)&&$o(`Database ${e}(${n.repoInfo_}) has already been deleted.`),vj(n),delete t[n.key]}function Oj(n,e,t,i){let s=W0[e.name];s||(s={},W0[e.name]=s);let o=s[n.toURLString()];return o&&$o("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new dj(n,kj,t,i),s[n.toURLString()]=o,o}class Uj{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(hj(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Tl(this._repo,Wt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Vj(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&$o("Cannot call "+e+" on a deleted database.")}}function Fj(n=ET(),e){const t=Fg(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=MN("database");i&&Bj(t,...i)}return t}function Bj(n,e,t,i={}){n=Un(n),n._checkNotDeleted("useEmulator");const s=`${e}:${t}`,o=n._repoInternal;if(n._instanceStarted){if(s===n._repoInternal.repoInfo_.host&&Ko(i,o.repoInfo_.emulatorOptions))return;$o("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let l;if(o.repoInfo_.nodeAdmin)i.mockUserToken&&$o('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),l=new Np(Np.OWNER);else if(i.mockUserToken){const d=typeof i.mockUserToken=="string"?i.mockUserToken:DN(i.mockUserToken,n.app.options.projectId);l=new Np(d)}pl(e)&&(_T(e),yT("Database",!0)),Dj(o,s,i,l)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(n){Rq(Uu),Eu(new al("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return Lj(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),so(FA,BA,n),so(FA,BA,"esm2020")}Ho.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Ho.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};zj();const qj={apiKey:"AIzaSyBCnLlCaVWh9iKhclzPWJcEPDuyH0OHPUM",authDomain:"ques-trip.firebaseapp.com",projectId:"ques-trip",storageBucket:"ques-trip.firebasestorage.app",messagingSenderId:"765263595886",appId:"1:765263595886:web:3e501d362abe47bfb8597f",measurementId:"G-R1NF9EVRHY"},w_=HN(qj);console.log("Firebase App Initialized:",w_.name);const Y0=ZB(w_),Gj=new Uo,Oo=cq(w_);dq(Oo).catch(n=>{n.code=="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open"):n.code=="unimplemented"&&console.warn("Firestore persistence not supported by browser")});const Hj=Fj(w_),jj=n=>{const e=Nj(Hj,".info/connected");return Mj(e,t=>{t.val()})},Kj=({trip:n,currentUser:e,onClose:t,settings:i})=>{const s=nn[i.language]||nn["zh-TW"],[o,l]=Z.useState(""),[d,h]=Z.useState(!1),[p,v]=Z.useState(null),[x,b]=Z.useState(""),[A,P]=Z.useState(""),[F,H]=Z.useState(!1),X=async()=>{if(o){h(!0),b(""),v(null);try{const he=k0(Cp(Oo,"users"),D0("email","==",o)),fe=await bq(he);if(fe.empty)b(i.language==="zh-TW"?"":"User not found");else{const Y=fe.docs[0];v({id:Y.id,...Y.data()})}}catch(he){console.error(he),b(i.language==="zh-TW"?"":"Search failed")}finally{h(!1)}}},re=async()=>{if(!(!p||!n.id))try{const he=ef(Oo,"itineraries",n.id);await Ap(he,{collaborators:OA(p.id),userIds:OA(p.id)}),P(i.language==="zh-TW"?` ${p.username}`:`Invited ${p.username}`),v(null),l(""),setTimeout(()=>P(""),3e3)}catch(he){console.error(he),b(i.language==="zh-TW"?"":"Invite failed")}},Q=()=>{const he=window.location.origin+`?trip=${n.id}`;navigator.clipboard.writeText(he),H(!0),setTimeout(()=>H(!1),2e3)};return Lp.createPortal(_.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in",children:_.jsxs("div",{className:"bg-white rounded-3xl w-full max-w-sm overflow-hidden shadow-2xl",children:[_.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center",children:[_.jsx("h3",{className:"text-lg font-bold text-ink",children:s.share_trip||"Share Trip"}),_.jsx("button",{onClick:t,className:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",children:_.jsx(VD,{className:"w-5 h-5 text-gray-500"})})]}),_.jsxs("div",{className:"p-6 space-y-6",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:i.language==="zh-TW"?" ( Email)":"Invite Companion (Enter Email)"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("input",{type:"email",value:o,onChange:he=>l(he.target.value),placeholder:"friend@example.com",className:"flex-1 p-3 bg-gray-50 rounded-xl border border-gray-200 focus:border-coral outline-none text-sm"}),_.jsx("button",{onClick:X,disabled:d||!o,className:"bg-coral text-white p-3 rounded-xl font-bold disabled:opacity-50",children:d?"...":i.language==="zh-TW"?"":"Find"})]}),x&&_.jsx("p",{className:"text-red-500 text-xs font-bold ml-1",children:x}),p&&_.jsxs("div",{className:"flex items-center justify-between bg-green-50 p-3 rounded-xl border border-green-100 animate-slide-up",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("div",{className:"w-8 h-8 bg-green-200 rounded-full flex items-center justify-center text-green-700 font-bold text-xs",children:p.username[0]}),_.jsx("span",{className:"text-sm font-bold text-green-800",children:p.username})]}),_.jsx("button",{onClick:re,className:"bg-green-600 text-white px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-green-700",children:i.language==="zh-TW"?"":"Add"})]}),A&&_.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm font-bold ml-1 animate-fade-in",children:[_.jsx(ob,{className:"w-4 h-4"})," ",A]})]}),_.jsx("div",{className:"w-full h-px bg-gray-100"}),_.jsxs("div",{className:"space-y-3",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:i.language==="zh-TW"?" ()":"Share Link (View Only)"}),_.jsxs("button",{onClick:Q,className:"w-full p-4 bg-gray-50 rounded-2xl border border-gray-200 hover:border-coral transition-colors flex items-center justify-between group",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center text-gray-400 group-hover:text-coral shadow-sm",children:_.jsx(t5,{className:"w-5 h-5"})}),_.jsxs("div",{className:"text-left",children:[_.jsx("div",{className:"text-sm font-bold text-ink",children:i.language==="zh-TW"?"":"Copy Trip Link"}),_.jsx("div",{className:"text-xs text-gray-400",children:F?i.language==="zh-TW"?"":"Copied!":"nomadai.app/trip/..."})]})]}),F?_.jsx(ob,{className:"w-5 h-5 text-green-500"}):null]})]})]})]})}),document.body)},Wj=({trip:n,user:e,onBack:t,onDelete:i,onUpdateTrip:s,onOpenAI:o,settings:l})=>{var Lr,Vr,co,Ti;const d=nn[l.language]||nn["zh-TW"],[h,p]=Z.useState("ITINERARY"),[v,x]=Z.useState(!1),[b,A]=Z.useState(!1),[P,F]=Z.useState(""),[H,X]=Z.useState(null),[re,Q]=Z.useState(!1),he=async Ne=>{const ht=Ne||P;if(ht.trim()){Ne&&F(Ne),Q(!0);try{const dt=await qh(ht,l.apiKey);dt?X(dt):(Ne||alert("Location not found"),console.log(`Location not found for: ${ht}`))}catch(dt){console.error("Map search failed:",dt)}finally{Q(!1)}}},[fe,Y]=Z.useState(null),[k,B]=Z.useState(""),[O,q]=Z.useState(""),[G,W]=Z.useState(""),[z,He]=Z.useState([{name:"",price:""}]),[Qe,se]=Z.useState(((Lr=n.budget)==null?void 0:Lr.currency)||"TWD"),[Se,be]=Z.useState(""),[it,Pe]=Z.useState(0),[K,me]=Z.useState(!1),[Ie,le]=Z.useState(null),[_e,Ce]=Z.useState(!1),[Fe,Be]=Z.useState(!1);Z.useEffect(()=>{var Ne;_e&&(se(((Ne=n.budget)==null?void 0:Ne.currency)||"TWD"),be(""))},[_e,(Vr=n.budget)==null?void 0:Vr.currency]),Z.useEffect(()=>{(async()=>{var dt;const ht=((dt=n.budget)==null?void 0:dt.currency)||"TWD";if(le(null),Qe!==ht&&l.apiKey){me(!0);try{const on=await uT(Qe,ht);on?be(on):le(" (API Key )")}catch(on){console.error("Failed to fetch rate:",on),le("")}me(!1)}})()},[Qe,(co=n.budget)==null?void 0:co.currency,l.apiKey]),Z.useEffect(()=>{const Ne=parseFloat(O)||0,ht=parseFloat(Se)||1;Pe(Math.round(Ne*ht))},[O,Se]);const[Ye,At]=Z.useState(!1),[Jt,ct]=Z.useState(!1),[mn,Rn]=Z.useState(n.title),[Yt,Nt]=Z.useState(!1),[Rt,Mt]=Z.useState(""),[we,pe]=Z.useState(!1),De=()=>{i==null||i(n.id)},je=()=>{mn.trim()&&mn!==n.title&&(s==null||s({...n,title:mn})),ct(!1)},nt=async Ne=>{if(Ne==="upload"){const ht=document.createElement("input");ht.type="file",ht.accept="image/*",ht.onchange=dt=>{var Si,Es;const on=(Es=(Si=dt.target)==null?void 0:Si.files)==null?void 0:Es[0];if(on){const Fn=new FileReader;Fn.onload=()=>{const Zi=Fn.result;s==null||s({...n,coverImage:Zi}),Nt(!1)},Fn.readAsDataURL(on)}},ht.click()}else if(Ne==="url")Rt.trim()&&(s==null||s({...n,coverImage:Rt}),Mt(""),Nt(!1));else if(Ne==="ai"){pe(!0);try{const{generateCoverImage:ht}=await Rg(async()=>{const{generateCoverImage:on}=await Promise.resolve().then(()=>P6);return{generateCoverImage:on}},void 0),dt=await ht(n.title);s==null||s({...n,coverImage:dt}),Nt(!1)}catch(ht){console.error("Failed to generate cover:",ht),alert("AI ")}finally{pe(!1)}}},lt=Ne=>{Y(Ne),q(""),W(""),He([{name:"",price:""}]),Ce(!0)},rn=()=>{var gn,zi,qi;if(!fe||!O)return;const Ne=parseFloat(O);if(Ne<=0){alert("Amount must be greater than 0");return}const ht=parseFloat(Se)||1,dt=Math.round(Ne*ht),on=z.filter(ei=>ei.name&&ei.price).map(ei=>`${ei.name}: ${du(Qe)}${ei.price}`).join(", "),Si=G?on?`${G} (${on})`:G:on,Es={id:Date.now().toString(),title:fe.activity,amount:dt,category:"Shopping",date:n.startDate?new Date(n.startDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],payer:"ME",paymentMethod:"Cash",note:Si,originalCurrency:Qe,originalAmount:Ne,exchangeRate:ht},Fn=((gn=n.budget)==null?void 0:gn.expenses)||[],Zi={...n,budget:{...n.budget,total:((zi=n.budget)==null?void 0:zi.total)||0,currency:((qi=n.budget)==null?void 0:qi.currency)||"TWD",expenses:[Es,...Fn]}};s==null||s(Zi),Ce(!1)},jn=(Ne,ht,dt)=>{const on=[...z];if(on[Ne][ht]=dt,He(on),ht==="price"){const Si=on.reduce((Es,Fn)=>Es+(parseInt(Fn.price)||0),0);Si>0&&q(Si.toString())}},vi=()=>{He([...z,{name:"",price:""}])},pn=((Ti=n.budget)==null?void 0:Ti.currency)||"TWD",Ts=du(pn);return _.jsxs("div",{className:"flex flex-col h-full bg-paper animate-fade-in relative",children:[_.jsxs("div",{className:"relative h-64 shrink-0 group",children:[_.jsxs("div",{className:"absolute inset-0 bg-gray-200",children:[n.coverImage?_.jsx("img",{src:n.coverImage,alt:n.title,className:`w-full h-full object-cover transition-opacity duration-700 ${b?"opacity-100":"opacity-0"}`,onLoad:()=>A(!0)}):_.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-coral/20 to-sand/30",children:_.jsx(ab,{className:"w-16 h-16 text-coral/40"})}),_.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"})]}),_.jsxs("div",{className:"absolute top-[15px] left-0 right-0 p-4 pt-safe pt-4 flex justify-between items-start z-10",children:[_.jsx("button",{onClick:t,className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-black/50 transition-colors",children:_.jsx(vs,{className:"w-6 h-6"})}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("button",{onClick:()=>Nt(!0),className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-black/50 transition-colors opacity-0 group-hover:opacity-100",children:_.jsx($a,{className:"w-5 h-5"})}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("button",{onClick:()=>Be(!0),className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors",children:_.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),_.jsx("button",{onClick:()=>o(n.id),"data-testid":"btn-ai-planner",className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors",children:_.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),_.jsx("button",{onClick:()=>i(n.id),className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-red-500/50 transition-colors",children:_.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]}),_.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-5 text-white z-10",children:[Jt?_.jsx("div",{className:"flex items-center gap-2 mb-2",children:_.jsx("input",{value:mn,onChange:Ne=>Rn(Ne.target.value),className:"bg-white/20 backdrop-blur-md text-white text-3xl font-black px-2 py-1 rounded-lg outline-none w-full",autoFocus:!0,onBlur:je,onKeyDown:Ne=>Ne.key==="Enter"&&je()})}):_.jsxs("h1",{className:"text-3xl font-black mb-2 leading-tight drop-shadow-md cursor-pointer hover:text-coral/90 transition-colors flex items-center gap-2",onClick:()=>{ct(!0),Rn(n.title)},children:[n.title,_.jsx(N1,{className:"w-5 h-5 opacity-50"})]}),_.jsxs("div",{className:"flex items-center gap-3 text-sm font-bold text-gray-200",children:[_.jsxs("span",{className:"bg-white/20 backdrop-blur-md px-2 py-0.5 rounded text-xs",children:[n.days," Days"]}),_.jsxs("span",{children:[n.startDate," - ",n.endDate]})]})]})]}),_.jsx("div",{className:"flex-1 overflow-y-auto bg-paper relative rounded-t-3xl -mt-6 z-20 shadow-[0_-4px_20px_rgba(0,0,0,0.1)]",children:_.jsxs("div",{className:"p-5 min-h-full",children:[h==="ITINERARY"&&_.jsx(U6,{trip:n,settings:l,onUpdateTrip:s,onOpenQuickExpense:lt}),h==="MAP"&&_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"mb-4 flex gap-2",children:[_.jsxs("div",{className:"flex-1 relative",children:[_.jsx("input",{type:"text",value:P,onChange:Ne=>F(Ne.target.value),onKeyDown:Ne=>Ne.key==="Enter"&&he(),placeholder:d.search_placeholder,className:"w-full pl-10 pr-4 py-2 rounded-full border border-sand focus:border-coral focus:ring-1 focus:ring-coral outline-none text-sm"}),_.jsx(e5,{className:"w-4 h-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2"})]}),_.jsx("button",{onClick:()=>he(),disabled:re||!P.trim(),className:"bg-ink text-white px-4 py-2 rounded-full text-sm font-bold disabled:opacity-50 flex items-center gap-1",children:re?_.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):d.search_location})]}),_.jsx(pU,{trip:n,settings:l,searchedLocation:H,onItemClick:Ne=>he(Ne),mapSearchQuery:P})]}),h==="BUDGET"&&_.jsx(z6,{trip:n,settings:l,onUpdateTrip:s,currentUserId:e.id}),h==="BOOKINGS"&&_.jsx(q6,{trip:n,settings:l,onUpdateTrip:s}),h==="SHOPPING"&&_.jsx(O6,{items:n.shoppingList||[],onUpdateItems:Ne=>s==null?void 0:s({...n,shoppingList:Ne}),settings:l})]})}),_.jsx("div",{className:"absolute bottom-6 left-6 right-6 bg-white/90 backdrop-blur-xl rounded-full shadow-2xl border border-white/50 p-1.5 flex justify-between items-center z-30",children:[{id:"ITINERARY",icon:A1,label:d.itinerary},{id:"MAP",icon:ab,label:d.map},{id:"BUDGET",icon:S1,label:d.budget},{id:"BOOKINGS",icon:b1,label:d.bookings},{id:"SHOPPING",icon:R1,label:d.shopping}].map(Ne=>_.jsxs("button",{onClick:()=>p(Ne.id),className:`flex-1 flex flex-col items-center justify-center py-2 rounded-full transition-all duration-300 ${h===Ne.id?"bg-ink text-white shadow-lg scale-105":"text-gray-400 hover:text-ink hover:bg-gray-100"}`,children:[_.jsx(Ne.icon,{className:`w-5 h-5 ${h===Ne.id?"stroke-2":"stroke-[1.5]"}`}),h===Ne.id&&_.jsx("span",{className:"text-[10px] font-bold mt-0.5",children:Ne.label})]},Ne.id))}),Fe&&_.jsx(Kj,{trip:n,currentUser:e,onClose:()=>Be(!1),settings:l}),v&&_.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",children:_.jsxs("div",{className:"bg-white rounded-3xl p-6 w-full max-w-xs shadow-2xl animate-scale-in text-center",children:[_.jsx("div",{className:"w-16 h-16 bg-red-100 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:_.jsx(ol,{className:"w-8 h-8"})}),_.jsx("h3",{className:"text-xl font-bold text-ink mb-2",children:d.delete_trip}),_.jsx("p",{className:"text-gray-500 mb-6",children:d.delete_trip_confirm.replace("{title}",n.title)}),_.jsxs("div",{className:"flex gap-3",children:[_.jsx("button",{onClick:()=>x(!1),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:d.cancel}),_.jsx("button",{onClick:De,className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 shadow-lg shadow-red-500/30 transition-colors",children:d.delete})]})]})}),Yt&&_.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>Nt(!1),children:_.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:Ne=>Ne.stopPropagation(),children:[_.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:""}),_.jsxs("div",{className:"space-y-3",children:[_.jsxs("button",{onClick:()=>nt("upload"),className:"w-full py-4 bg-white border border-sand rounded-xl font-bold text-ink hover:bg-gray-50 flex items-center justify-center gap-2",children:[_.jsx("span",{children:""})," "]}),_.jsx("button",{onClick:()=>nt("ai"),disabled:we,className:"w-full py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:we?_.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):_.jsxs(_.Fragment,{children:[_.jsx("span",{children:""})," AI "]})}),_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute inset-0 flex items-center",children:_.jsx("div",{className:"w-full border-t border-sand"})}),_.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:_.jsx("span",{className:"bg-paper px-2 text-gray-400",children:"OR"})})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("input",{value:Rt,onChange:Ne=>Mt(Ne.target.value),placeholder:"...",className:"flex-1 bg-white p-3 rounded-xl border border-sand outline-none"}),_.jsx("button",{onClick:()=>nt("url"),disabled:!Rt,className:"bg-ink text-white px-4 rounded-xl font-bold disabled:opacity-50",children:"OK"})]})]})]})}),_e&&_.jsx("div",{className:"fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>Ce(!1),children:_.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:Ne=>Ne.stopPropagation(),children:[_.jsx("h3",{className:"text-xl font-bold text-ink mb-2 text-center",children:""}),_.jsx("p",{className:"text-center text-gray-400 text-sm mb-6",children:fe==null?void 0:fe.activity}),_.jsxs("div",{className:"space-y-4",children:[z.map((Ne,ht)=>_.jsxs("div",{className:"flex gap-2",children:[_.jsx("input",{value:Ne.name,onChange:dt=>jn(ht,"name",dt.target.value),placeholder:" (: )",className:"flex-1 bg-white p-3 rounded-xl font-bold border-none shadow-sm outline-none",autoFocus:ht===0}),_.jsx("input",{type:"number",value:Ne.price,onChange:dt=>jn(ht,"price",dt.target.value),placeholder:du(Qe),className:"w-24 bg-white p-3 rounded-xl font-bold border-none shadow-sm outline-none text-center",onFocus:dt=>dt.target.select()})]},ht)),_.jsx("button",{onClick:vi,className:"text-xs font-bold text-coral flex items-center gap-1 mx-auto hover:bg-coral/10 px-3 py-1 rounded-lg transition-colors",children:"+ "}),_.jsxs("div",{className:"pt-4 border-t border-sand",children:[_.jsxs("div",{className:"flex justify-between items-center mb-4",children:[_.jsx("div",{className:"flex items-center gap-2",children:_.jsx("select",{value:Qe,onChange:Ne=>se(Ne.target.value),className:"bg-transparent font-bold text-gray-400 outline-none text-sm",children:cT.map(Ne=>_.jsx("option",{value:Ne.code,children:Ne.code},Ne.code))})}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"font-bold text-ink text-2xl",children:du(Qe)}),_.jsx("input",{type:"number",value:O,onChange:Ne=>q(Ne.target.value),className:"w-32 bg-transparent text-right text-3xl font-black border-none outline-none p-0",placeholder:"0",onFocus:Ne=>Ne.target.select()})]})]}),Qe!==pn&&_.jsxs("div",{className:"mb-4 bg-sand/30 p-3 rounded-xl",children:[_.jsxs("div",{className:"flex justify-between items-center mb-2",children:[_.jsxs("label",{className:"text-xs font-bold text-gray-500",children:[" (",Qe,"  ",pn,")"]}),_.jsxs("span",{className:"text-xs font-bold text-coral",children:[" ",Ts,it.toLocaleString()]})]}),_.jsxs("div",{className:"relative",children:[_.jsx("input",{value:Se,onChange:Ne=>be(Ne.target.value),type:"number",step:"0.01",placeholder:K?"...":"Exchange Rate",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none",onFocus:Ne=>Ne.target.select(),disabled:K}),K&&_.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:_.jsx("div",{className:"w-4 h-4 border-2 border-coral border-t-transparent rounded-full animate-spin"})})]}),!l.apiKey&&_.jsx("p",{className:"text-[10px] text-red-400 mt-1",children:"*  API Key "}),Ie&&_.jsxs("p",{className:"text-[10px] text-red-400 mt-1",children:["* ",Ie]})]}),_.jsx("textarea",{value:G,onChange:Ne=>W(Ne.target.value),placeholder:"...",className:"w-full bg-white p-3 rounded-xl text-sm font-medium border-none shadow-sm outline-none min-h-[60px]"})]}),_.jsx("button",{onClick:rn,disabled:!O,className:"w-full bg-ink text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-ink/30 mt-2 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:""})]})]})})]})},Yj=({onStartGeneration:n,onCancel:e,settings:t,sessions:i,currentSessionId:s,onCreateSession:o,onUpdateSession:l,onDeleteSession:d,onSelectSession:h})=>{const p=nn[t.language]||nn["zh-TW"],[v,x]=Z.useState(""),[b,A]=Z.useState(!1),[P,F]=Z.useState(!1),H=Z.useRef(null),X=i.find(Y=>Y.id===s),re=(X==null?void 0:X.messages)||[],Q=()=>{var Y;(Y=H.current)==null||Y.scrollIntoView({behavior:"smooth"})};Z.useEffect(Q,[re]),Z.useEffect(()=>{s&&re.length===0?l(s,[{role:"ai",content:p.ai_planner_intro,timestamp:Date.now()}]):!s&&i.length===0?o():!s&&i.length>0&&h(i[0].id)},[s,i.length]);const he=()=>{o(),F(!1)},fe=async()=>{if(!v.trim()||!s)return;const Y={role:"user",content:v,timestamp:Date.now()},k=[...re,Y];l(s,k),x(""),A(!0);const B={role:"ai",content:p.ai_planning,timestamp:Date.now()};l(s,[...k,B]),n(v,X==null?void 0:X.tripId).then(O=>{const q={role:"ai",content:p.ai_done,timestamp:Date.now()};O?l(s,[...k,q],O.title,O.tripId):l(s,[...k,q]),A(!1)})};return _.jsxs("div",{className:"flex h-full bg-paper pt-safe relative overflow-hidden",children:[P&&_.jsx("div",{className:"absolute inset-0 bg-black/20 z-20 backdrop-blur-sm",onClick:()=>F(!1)}),_.jsxs("div",{className:`absolute top-0 left-0 bottom-0 w-64 bg-white shadow-2xl z-30 transform transition-transform duration-300 ease-in-out ${P?"translate-x-0":"-translate-x-full"}`,children:[_.jsxs("div",{className:"p-4 border-b border-sand flex justify-between items-center pt-12",children:[_.jsx("h3",{className:"font-bold text-lg text-ink",children:t.language==="zh-TW"?"":"Chat History"}),_.jsx("button",{onClick:he,className:"p-2 bg-coral/10 rounded-full text-coral hover:bg-coral/20",children:_.jsx(Q0,{className:"w-5 h-5"})})]}),_.jsxs("div",{className:"overflow-y-auto h-full pb-20",children:[i.map(Y=>_.jsxs("div",{onClick:()=>{h(Y.id),F(!1)},className:`p-4 border-b border-sand/50 cursor-pointer hover:bg-sand/30 transition-colors ${s===Y.id?"bg-sand/50 border-l-4 border-l-coral":""}`,children:[_.jsx("div",{className:"font-medium text-ink truncate",children:Y.title}),_.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(Y.updatedAt).toLocaleDateString()})]},Y.id)),i.length===0&&_.jsx("div",{className:"p-8 text-center text-gray-400 text-sm",children:t.language==="zh-TW"?"":"No chat history"})]})]}),_.jsxs("div",{className:"flex-1 flex flex-col h-full w-full",children:[_.jsxs("div",{className:"px-4 py-3 border-b border-sand/50 flex items-center justify-between bg-paper sticky top-0 z-10 pt-safe pt-4",children:[_.jsxs("div",{className:"flex items-center",children:[_.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-white text-gray-500 transition-colors",children:_.jsx(vs,{className:"w-6 h-6"})}),_.jsx("button",{onClick:()=>F(!0),className:"ml-2 p-2 rounded-full hover:bg-white text-gray-500 transition-colors",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})}),_.jsxs("h2",{className:"text-lg font-bold text-ink ml-2 flex items-center gap-2 truncate max-w-[150px]",children:[_.jsx(C1,{className:"w-5 h-5 text-coral"}),(X==null?void 0:X.title)||p.ai_planner_title]})]}),_.jsx("button",{onClick:he,className:"text-xs font-bold text-coral border border-coral/30 px-3 py-1.5 rounded-full hover:bg-coral/10 transition-colors",children:t.language==="zh-TW"?"":"New Chat"})]}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24",children:[re.map((Y,k)=>_.jsx("div",{className:`flex ${Y.role==="user"?"justify-end":"justify-start"} animate-slide-up`,children:_.jsx("div",{className:`max-w-[85%] p-4 rounded-2xl text-sm font-medium leading-relaxed shadow-sm whitespace-pre-line ${Y.role==="user"?"bg-coral text-white rounded-tr-none":"bg-white text-ink border border-sand rounded-tl-none"}`,children:Y.content})},k)),b&&_.jsx("div",{className:"flex justify-start",children:_.jsxs("div",{className:"bg-white p-4 rounded-2xl rounded-tl-none border border-sand flex items-center gap-2",children:[_.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce"}),_.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce delay-100"}),_.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce delay-200"}),_.jsx("span",{className:"text-xs text-gray-400 font-bold ml-1",children:p.planning_process})]})}),_.jsx("div",{ref:H})]}),_.jsxs("div",{className:"p-4 bg-white/90 backdrop-blur border-t border-sand pb-32",children:[_.jsxs("div",{className:"flex gap-2",children:[_.jsx("textarea",{value:v,onChange:Y=>x(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&!Y.shiftKey&&(Y.preventDefault(),fe())},placeholder:p.input_placeholder,"data-testid":"input-ai-chat",className:"flex-1 bg-paper rounded-2xl px-5 py-3.5 outline-none focus:ring-2 focus:ring-coral/50 transition-all font-medium text-ink placeholder:text-gray-400 border border-sand resize-none min-h-[50px] max-h-[120px]",disabled:b,rows:1}),_.jsx("button",{onClick:fe,"data-testid":"btn-ai-send",disabled:!v.trim()||b,className:"bg-coral text-white p-3.5 rounded-2xl disabled:opacity-50 active:scale-95 transition-transform shadow-lg shadow-coral/20",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:_.jsx("path",{d:"M3.105 2.289a.75.75 0 0 0-.826.95l1.414 4.925A1.5 1.5 0 0 0 5.135 9.25h6.115a.75.75 0 0 1 0 1.5H5.135a1.5 1.5 0 0 0-1.442 1.086l-1.414 4.926a.75.75 0 0 0 .826.95 28.896 28.896 0 0 0 15.293-7.154.75.75 0 0 0 0-1.115A28.897 28.897 0 0 0 3.105 2.289Z"})})})]}),_.jsx("div",{className:"flex gap-2 mt-3 overflow-x-auto no-scrollbar pb-2",children:[p.prompt_tokyo,p.prompt_bangkok,p.prompt_paris].map(Y=>_.jsx("button",{onClick:()=>x(Y),className:"whitespace-nowrap px-4 py-2 bg-white text-gray-500 text-xs font-bold rounded-xl border border-sand hover:text-coral hover:border-coral transition-colors",disabled:b,children:Y},Y))})]})]})]})},Jj="https://api.exchangerate-api.com/v4/latest/TWD";let Dh=null,v1=0;const Zj=1440*60*1e3,Qj=async()=>{const n=Date.now();if(Dh&&n-v1<Zj)return Dh;try{const t=await(await fetch(Jj)).json();return Dh=t,v1=n,t}catch(e){return console.error("Failed to fetch exchange rates:",e),Dh||{base:"TWD",rates:{TWD:1,JPY:.22,KRW:.043,USD:31.5,EUR:34.2}}}},$j=async(n,e)=>{if(e==="TWD")return n;const i=(await Qj()).rates[e];return i?n/i:(console.warn(`Unknown currency: ${e}`),n)},Xj=(n,e="TWD")=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:e==="TWD"?"TWD":e,minimumFractionDigits:0,maximumFractionDigits:0}).format(n),ak=()=>"webkitSpeechRecognition"in window||"SpeechRecognition"in window,tx=()=>"speechSynthesis"in window,eK=(n="zh-TW",e,t)=>{if(!ak())return t==null||t(""),null;const i=window.webkitSpeechRecognition||window.SpeechRecognition,s=new i;return s.continuous=!1,s.interimResults=!1,s.lang=n,s.onresult=o=>{const l=o.results[0][0].transcript;e(l)},s.onerror=o=>{t==null||t(o.error)},s.start(),s},lk=(n,e="zh-TW",t)=>{if(!tx()){console.error("");return}window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(n);i.lang=e,i.rate=1,i.pitch=1,i.volume=1,t&&(i.onend=t),window.speechSynthesis.speak(i)},tK=()=>{tx()&&window.speechSynthesis.cancel()},nK=async(n,e,t,i,s)=>new Promise((o,l)=>{eK(n,async h=>{t==null||t(h);try{const p=await mN(h,e,n);p?(i==null||i(p),lk(p,e,()=>{o()})):(s==null||s(""),l("Translation failed"))}catch(p){s==null||s(p),l(p)}},h=>{s==null||s(h),l(h)})||l("Speech recognition not supported")}),lp={recognition:ak(),synthesis:tx()};function iK({title:n,titleId:e,...t},i){return Z.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?Z.createElement("title",{id:e},n):null,Z.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"}))}const sK=Z.forwardRef(iK);function rK({title:n,titleId:e,...t},i){return Z.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?Z.createElement("title",{id:e},n):null,Z.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"}))}const oK=Z.forwardRef(rK);function aK({title:n,titleId:e,...t},i){return Z.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?Z.createElement("title",{id:e},n):null,Z.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const T1=Z.forwardRef(aK);function lK({title:n,titleId:e,...t},i){return Z.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?Z.createElement("title",{id:e},n):null,Z.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),Z.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"}))}const uK=Z.forwardRef(lK),cK=({defaultSourceLang:n="zh-TW",defaultTargetLang:e="en-US"})=>{const[t,i]=Z.useState(n),[s,o]=Z.useState(e),[l,d]=Z.useState(""),[h,p]=Z.useState(""),[v,x]=Z.useState(!1),[b,A]=Z.useState(!1),[P,F]=Z.useState(""),H=[{code:"zh-TW",name:""},{code:"en-US",name:"English"},{code:"ja-JP",name:""},{code:"ko-KR",name:""},{code:"th-TH",name:""}],X=async()=>{if(!lp.recognition){F("");return}F(""),x(!0),d(""),p("");try{await nK(t,s,fe=>{d(fe)},fe=>{p(fe),A(!0)},fe=>{F(`${fe}`)})}catch(fe){console.error(fe)}finally{x(!1),A(!1)}},re=()=>{i(s),o(t),d(""),p("")},Q=(fe,Y)=>{if(!lp.synthesis){F("");return}lk(fe,Y)},he=()=>{tK(),A(!1)};return _.jsxs("div",{className:"max-w-4xl mx-auto p-6 pt-12 bg-paper rounded-3xl shadow-float",children:[_.jsx("h2",{className:"text-2xl font-bold text-ink mb-6 text-center",children:" "}),_.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[_.jsx("select",{value:t,onChange:fe=>i(fe.target.value),className:"flex-1 p-3 rounded-xl border-2 border-sand bg-white text-ink font-medium focus:border-coral outline-none",children:H.map(fe=>_.jsx("option",{value:fe.code,children:fe.name},fe.code))}),_.jsx("button",{onClick:re,className:"p-3 rounded-full bg-coral text-white hover:bg-coralDark active:scale-95 transition-all",children:_.jsx(sK,{className:"w-5 h-5"})}),_.jsx("select",{value:s,onChange:fe=>o(fe.target.value),className:"flex-1 p-3 rounded-xl border-2 border-sand bg-white text-ink font-medium focus:border-coral outline-none",children:H.map(fe=>_.jsx("option",{value:fe.code,children:fe.name},fe.code))})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[_.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-sand min-h-[120px] flex flex-col",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:" ()"}),l&&_.jsx("button",{onClick:()=>Q(l,t),className:"p-1 text-coral hover:text-coralDark",children:_.jsx(T1,{className:"w-4 h-4"})})]}),_.jsx("textarea",{value:l,onChange:fe=>d(fe.target.value),placeholder:"...",className:"w-full flex-1 resize-none outline-none text-ink bg-transparent placeholder:text-gray-300"})]}),_.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-sand min-h-[120px]",children:[_.jsxs("div",{className:"flex items-center justify-between mb-2",children:[_.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),h&&_.jsx("button",{onClick:()=>Q(h,s),className:"p-1 text-coral hover:text-coralDark",children:_.jsx(T1,{className:"w-4 h-4"})})]}),_.jsx("p",{className:"text-ink whitespace-pre-wrap",children:h||"..."})]})]}),P&&_.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm",children:P}),_.jsxs("div",{className:"flex gap-3",children:[_.jsxs("button",{onClick:X,disabled:v||b,className:`flex-1 py-4 rounded-2xl font-bold text-lg flex items-center justify-center gap-2 transition-all ${v?"bg-red-500 text-white animate-pulse":"bg-coral text-white hover:bg-coralDark active:scale-95"}`,children:[_.jsx(oK,{className:"w-6 h-6"}),v?"...":""]}),(v||b)&&_.jsxs("button",{onClick:he,className:"px-6 py-4 rounded-2xl font-bold bg-gray-500 text-white hover:bg-gray-600 active:scale-95 transition-all flex items-center gap-2",children:[_.jsx(uK,{className:"w-6 h-6"}),""]})]}),(!lp.recognition||!lp.synthesis)&&_.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-xl text-yellow-800 text-sm",children:"  ChromeEdge  Safari "})]})},dK=({onBack:n})=>_.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[_.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[_.jsx("button",{onClick:n,children:_.jsx(vs,{className:"w-6 h-6 text-gray-500"})}),_.jsx("h3",{className:"font-bold text-lg text-ink",children:""})]}),_.jsx("div",{className:"p-5 flex items-center justify-center h-full text-gray-400 text-center font-medium",children:_.jsx("p",{children:""})})]}),hK=({onBack:n,t:e,language:t,onOpenSettings:i})=>{var A,P,F,H,X,re;const[s,o]=Z.useState("Taiwan (ROC)"),[l,d]=Z.useState(""),[h,p]=Z.useState(null),[v,x]=Z.useState(!1),b=async()=>{if(l){x(!0),p(null);try{const Q=await lN(s,l,t);p(Q)}catch(Q){console.error(Q),p(null)}finally{x(!1)}}};return _.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[_.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[_.jsx("button",{onClick:n,children:_.jsx(vs,{className:"w-6 h-6 text-gray-500"})}),_.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_visa})]}),_.jsxs("div",{className:"p-5 space-y-4 overflow-y-auto flex-1 pb-32",children:[_.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card space-y-5 border border-sand",children:[_.jsxs("div",{children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),_.jsxs("select",{value:s,onChange:Q=>o(Q.target.value),className:"w-full mt-2 p-3 bg-paper rounded-xl text-ink font-medium border-none outline-none",children:[_.jsx("option",{value:"Taiwan (ROC)",children:" (Taiwan)"}),_.jsx("option",{value:"Japan",children:" (Japan)"}),_.jsx("option",{value:"USA",children:" (USA)"}),_.jsx("option",{value:"Hong Kong",children:" (Hong Kong)"})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),_.jsx("input",{value:l,onChange:Q=>d(Q.target.value),placeholder:"...",className:"w-full mt-2 p-3 bg-paper rounded-xl text-ink font-medium border-none outline-none"})]}),_.jsx("button",{onClick:b,disabled:v||!l,className:"w-full bg-coral text-white py-3.5 rounded-xl font-bold shadow-lg shadow-coral/30 disabled:opacity-50",children:v?e.loading:e.confirm})]}),h&&_.jsxs("div",{className:"space-y-4 animate-slide-up",children:[_.jsxs("div",{className:"bg-white p-4 rounded-3xl shadow-sm border border-sand flex justify-between items-center",children:[_.jsx("span",{className:"font-bold text-gray-500 text-sm uppercase",children:""}),_.jsx("span",{className:`px-4 py-1.5 rounded-full font-bold text-sm ${(A=h.difficulty)!=null&&A.includes("Easy")||(P=h.difficulty)!=null&&P.includes("")||(F=h.difficulty)!=null&&F.includes("")?"bg-green-100 text-green-600":(H=h.difficulty)!=null&&H.includes("Hard")||(X=h.difficulty)!=null&&X.includes("")?"bg-red-100 text-red-600":"bg-yellow-100 text-yellow-600"}`,children:h.difficulty})]}),_.jsx("div",{className:"bg-ink text-white p-6 rounded-3xl shadow-lg",children:_.jsx("p",{className:"font-medium leading-relaxed",children:h.summary})}),_.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand",children:[_.jsxs("h4",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[_.jsx("span",{className:"w-2 h-6 bg-coral rounded-full"}),""]}),_.jsx("ul",{className:"space-y-3",children:(re=h.requirements)==null?void 0:re.map((Q,he)=>_.jsxs("li",{className:"flex gap-3 text-sm text-gray-600",children:[_.jsx("span",{className:"text-coral mt-0.5",children:""}),_.jsx("span",{className:"flex-1",children:Q})]},he))})]})]})]})]})},fK=({onBack:n,t:e,language:t,onOpenSettings:i})=>{var x,b;const[s,o]=Z.useState(""),[l,d]=Z.useState(null),[h,p]=Z.useState(!1),v=async()=>{p(!0),d(null);try{const P=await uN(s||"Kyoto, Japan",t);d(P)}catch(A){console.error(A)}finally{p(!1)}};return _.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[_.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[_.jsx("button",{onClick:n,children:_.jsx(vs,{className:"w-6 h-6 text-gray-500"})}),_.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_culture})]}),_.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[_.jsx("div",{className:"mb-4",children:_.jsx("input",{value:s,onChange:A=>o(A.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl shadow-sm border border-sand font-medium text-ink outline-none"})}),_.jsx("button",{onClick:v,disabled:h,className:"w-full bg-orange-400 text-white px-4 py-3.5 rounded-2xl font-bold text-sm shadow-md mb-6",children:h?e.loading:e.confirm}),l&&_.jsxs("div",{className:"space-y-4 animate-slide-up",children:[_.jsxs("div",{className:"bg-white p-5 rounded-3xl shadow-sm border border-sand",children:[_.jsx("h4",{className:"font-bold text-orange-500 text-sm uppercase mb-2",children:" "}),_.jsx("p",{className:"text-ink text-sm leading-relaxed",children:l.tipping})]}),_.jsxs("div",{className:"bg-green-50 p-5 rounded-3xl border border-green-100",children:[_.jsx("h4",{className:"font-bold text-green-600 text-sm uppercase mb-3",children:" Do's ()"}),_.jsx("ul",{className:"space-y-2",children:(x=l.dos)==null?void 0:x.map((A,P)=>_.jsxs("li",{className:"flex gap-2 text-sm text-green-800",children:[_.jsx("span",{children:""}),_.jsx("span",{children:A})]},P))})]}),_.jsxs("div",{className:"bg-red-50 p-5 rounded-3xl border border-red-100",children:[_.jsx("h4",{className:"font-bold text-red-600 text-sm uppercase mb-3",children:" Don'ts ()"}),_.jsx("ul",{className:"space-y-2",children:(b=l.donts)==null?void 0:b.map((A,P)=>_.jsxs("li",{className:"flex gap-2 text-sm text-red-800",children:[_.jsx("span",{children:""}),_.jsx("span",{children:A})]},P))})]}),_.jsxs("div",{className:"bg-white p-5 rounded-3xl shadow-sm border border-sand",children:[_.jsx("h4",{className:"font-bold text-gray-400 text-sm uppercase mb-2",children:" "}),_.jsx("p",{className:"text-ink text-sm leading-relaxed",children:l.dressCode})]})]})]})]})},mK=({onBack:n,t:e})=>_.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[_.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[_.jsx("button",{onClick:n,children:_.jsx(vs,{className:"w-6 h-6 text-gray-500"})}),_.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_restroom})]}),_.jsx("div",{className:"flex-1 relative rounded-t-3xl overflow-hidden shadow-inner border-t border-sand",children:_.jsx("iframe",{width:"100%",height:"100%",style:{border:0},loading:"lazy",allowFullScreen:!0,src:"https://maps.google.com/maps?q=public+restroom&output=embed"})})]}),pK=({onBack:n,t:e,language:t,onOpenSettings:i})=>{var A;const[s,o]=Z.useState(""),[l,d]=Z.useState(null),[h,p]=Z.useState(null),[v,x]=Z.useState(!1),b=async()=>{if(s){x(!0),d(null),p(null);try{const P=await dN(s,t);P?d(P):p(" API Key ")}catch{p("")}finally{x(!1)}}};return _.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[_.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[_.jsx("button",{onClick:n,children:_.jsx(vs,{className:"w-6 h-6 text-gray-500"})}),_.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_emergency})]}),_.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[_.jsxs("div",{className:"bg-red-500 text-white p-6 rounded-3xl shadow-lg shadow-red-500/20 mb-6",children:[_.jsx("h2",{className:"text-xl font-bold mb-2",children:"SOS?"}),_.jsxs("p",{className:"opacity-90 text-sm",children:[": ",_.jsx("span",{className:"font-black text-2xl ml-1",children:"112"})]})]}),_.jsxs("div",{className:"space-y-3 mb-6",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:""}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("input",{value:s,onChange:P=>o(P.target.value),onKeyDown:P=>P.key==="Enter"&&b(),placeholder:" ()...",className:"flex-1 p-4 bg-white rounded-2xl border border-sand shadow-sm outline-none font-bold text-ink"}),_.jsx("button",{onClick:b,disabled:v||!s,className:"px-6 bg-ink text-white rounded-2xl font-bold shadow-lg disabled:opacity-50",children:v?_.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Go"})]})]}),h&&_.jsxs("div",{className:"p-6 bg-red-50 border border-red-200 rounded-3xl text-red-600 text-center font-medium animate-fade-in",children:[h,h.includes("API")&&_.jsx("button",{onClick:i,className:"mt-3 text-sm underline hover:text-red-800",children:""})]}),l&&_.jsxs("div",{className:"space-y-6 animate-slide-up",children:[_.jsxs("div",{className:"bg-white rounded-3xl shadow-card border border-sand overflow-hidden",children:[_.jsx("div",{className:"p-4 bg-gray-50 border-b border-sand",children:_.jsx("h4",{className:"font-bold text-gray-500 text-sm uppercase",children:""})}),_.jsx("div",{className:"divide-y divide-sand",children:(A=l.numbers)==null?void 0:A.map((P,F)=>_.jsxs("div",{className:"flex justify-between items-center p-4 hover:bg-gray-50 transition-colors",children:[_.jsx("span",{className:"font-bold text-ink",children:P.label}),_.jsx("a",{href:`tel:${P.number}`,className:"font-black text-xl text-coral bg-coral/10 px-3 py-1 rounded-lg hover:bg-coral hover:text-white transition-colors",children:P.number})]},F))})]}),l.hospital&&_.jsxs("div",{className:"bg-white rounded-3xl shadow-card border border-sand overflow-hidden",children:[_.jsx("div",{className:"p-4 bg-gray-50 border-b border-sand",children:_.jsx("h4",{className:"font-bold text-gray-500 text-sm uppercase",children:""})}),_.jsxs("div",{className:"p-5 space-y-3",children:[_.jsx("h3",{className:"text-lg font-black text-ink",children:l.hospital.name}),_.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-600",children:[_.jsx("span",{className:"shrink-0 text-xl",children:""}),_.jsx("span",{className:"font-medium leading-relaxed",children:l.hospital.address})]}),_.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[_.jsx("span",{className:"text-xl",children:""}),_.jsx("a",{href:`tel:${l.hospital.phone}`,className:"font-bold text-coral underline decoration-2 underline-offset-2",children:l.hospital.phone})]})]})]})]})]})]})},gK=({onBack:n,t:e,language:t,onOpenSettings:i})=>{var x,b;const[s,o]=Z.useState(""),[l,d]=Z.useState(null),[h,p]=Z.useState(!1),v=async()=>{if(s){p(!0),d(null);try{const A=await hN(s,t);d(A)}catch(A){console.error(A)}finally{p(!1)}}};return _.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[_.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[_.jsx("button",{onClick:n,children:_.jsx(vs,{className:"w-6 h-6 text-gray-500"})}),_.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_card})]}),_.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:""}),_.jsx("input",{value:s,onChange:A=>o(A.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl border border-sand shadow-sm outline-none"}),_.jsx("button",{onClick:v,disabled:h||!s,className:"w-full py-3.5 bg-indigo-500 text-white rounded-2xl font-bold shadow-lg shadow-indigo-200",children:h?e.loading:e.confirm})]}),l&&_.jsxs("div",{className:"space-y-4 mt-6 animate-slide-up",children:[_.jsxs("div",{className:"bg-indigo-50 p-5 rounded-3xl border border-indigo-100",children:[_.jsx("h4",{className:"font-bold text-indigo-600 text-sm uppercase mb-3",children:" "}),_.jsx("div",{className:"flex flex-wrap gap-2",children:(x=l.bestCards)==null?void 0:x.map((A,P)=>_.jsx("span",{className:"bg-white text-indigo-600 px-3 py-1 rounded-lg text-sm font-bold shadow-sm",children:A},P))})]}),_.jsxs("div",{className:"bg-white p-5 rounded-3xl shadow-sm border border-sand",children:[_.jsx("h4",{className:"font-bold text-gray-400 text-sm uppercase mb-2",children:" "}),_.jsx("p",{className:"text-ink text-sm leading-relaxed",children:l.cashInfo})]}),_.jsxs("div",{className:"bg-white p-5 rounded-3xl shadow-sm border border-sand",children:[_.jsx("h4",{className:"font-bold text-gray-400 text-sm uppercase mb-2",children:" "}),_.jsx("ul",{className:"space-y-2",children:(b=l.tips)==null?void 0:b.map((A,P)=>_.jsxs("li",{className:"flex gap-2 text-sm text-gray-600",children:[_.jsx("span",{className:"text-coral mt-0.5",children:""}),_.jsx("span",{children:A})]},P))})]})]})]})]})};let _K=Ou.icon({iconUrl:wN,shadowUrl:SN,iconSize:[25,41],iconAnchor:[12,41]});Ou.Marker.prototype.options.icon=_K;const E1={Japan:[36.2048,138.2529],Taiwan:[23.6978,120.9605],Thailand:[15.87,100.9925],USA:[37.0902,-95.7129],France:[46.2276,2.2137],"South Korea":[35.9078,127.7669],Vietnam:[14.0583,108.2772],China:[35.8617,104.1954],Germany:[51.1657,10.4515],Italy:[41.8719,12.5674],UK:[55.3781,-3.436],Spain:[40.4637,-3.7492],Australia:[-25.2744,133.7751],Canada:[56.1304,-106.3468],Singapore:[1.3521,103.8198],Malaysia:[4.2105,101.9758],Philippines:[12.8797,121.774],Indonesia:[-.7893,113.9213],India:[20.5937,78.9629],Russia:[61.524,105.3188],Brazil:[-14.235,-51.9253],Mexico:[23.6345,-102.5528],Egypt:[26.8206,30.8025],Turkey:[38.9637,35.2433],Netherlands:[52.1326,5.2913],Switzerland:[46.8182,8.2275],Austria:[47.5162,14.5501],Belgium:[50.5039,4.4699],Sweden:[60.1282,18.6435],Norway:[60.472,8.4689],Denmark:[56.2639,9.5018],Finland:[61.9241,25.7482],"New Zealand":[-40.9006,174.886],"Hong Kong":[22.3193,114.1694],Macau:[22.1987,113.5439]},yK=({onReady:n})=>{const e=Lg();return Z.useEffect(()=>{const t=setTimeout(()=>{e.invalidateSize(),n()},250);return()=>clearTimeout(t)},[e,n]),null},vK=({onBack:n,trips:e,t})=>{const[i,s]=Z.useState(new Set(["Japan","Thailand","Taiwan"])),[o,l]=Z.useState(""),[d,h]=Z.useState(!1);Z.useEffect(()=>{if(e){const x=new Set(i);e.forEach(b=>{(b.title.includes("")||b.title.includes("Japan")||b.title.includes("")||b.title.includes("")||b.title.includes("Tokyo"))&&x.add("Japan"),(b.title.includes("")||b.title.includes("Thailand")||b.title.includes(""))&&x.add("Thailand"),(b.title.includes("")||b.title.includes("Taiwan")||b.title.includes(""))&&x.add("Taiwan"),(b.title.includes("")||b.title.includes("USA"))&&x.add("USA"),(b.title.includes("")||b.title.includes("France")||b.title.includes("Paris"))&&x.add("France"),(b.title.includes("")||b.title.includes("Korea")||b.title.includes(""))&&x.add("South Korea"),(b.title.includes("")||b.title.includes("Vietnam"))&&x.add("Vietnam"),(b.title.includes("")||b.title.includes("China")||b.title.includes("")||b.title.includes(""))&&x.add("China"),(b.title.includes("")||b.title.includes("Hong Kong"))&&x.add("Hong Kong")}),s(x)}},[e]);const p=()=>{if(o.trim()){const x=o.trim(),b=Object.keys(E1).find(A=>A.toLowerCase()===x.toLowerCase());s(b?A=>new Set(A).add(b):A=>new Set(A).add(x)),l("")}},v=x=>{const b=new Set(i);b.delete(x),s(b)};return _.jsxs("div",{className:"flex flex-col h-full bg-[#111827] text-white",children:[_.jsx("div",{className:"bg-[#111827] p-4 pt-9 flex items-center justify-between sticky top-0 z-10 border-b border-gray-800",children:_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("button",{onClick:n,children:_.jsx(vs,{className:"w-6 h-6 text-gray-300"})}),_.jsx("h3",{className:"font-bold text-lg",children:t.tool_map})]})}),_.jsxs("div",{className:"p-6 flex-1 overflow-y-auto pb-32",children:[_.jsxs("div",{className:"relative w-full aspect-[1.6] bg-[#1F2937] rounded-3xl overflow-hidden mb-8 shadow-2xl border border-gray-700",children:[_.jsxs(EN,{center:[20,0],zoom:2,style:{height:"100%",width:"100%",background:"#1F2937"},zoomControl:!1,attributionControl:!1,children:[_.jsx(xN,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),_.jsx(yK,{onReady:()=>h(!0)}),Array.from(i).map(x=>{const b=E1[x];return b?_.jsx(fT,{position:b,icon:Ou.divIcon({className:"custom-div-icon",html:'<div style="background-color: #FF6B6B; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 10px #FF6B6B;"></div>',iconSize:[12,12],iconAnchor:[6,6]}),children:_.jsx(mT,{children:_.jsx("div",{className:"text-ink font-bold",children:x})})},x):null})]}),_.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center pointer-events-none",children:_.jsx("div",{className:"inline-block bg-black/50 backdrop-blur-sm px-3 py-1 rounded-full text-xs text-gray-400 font-mono tracking-widest border border-white/10",children:"[  ]"})})]}),_.jsxs("div",{className:"bg-[#1F2937] rounded-3xl p-6 shadow-lg border border-gray-700 mb-6",children:[_.jsxs("div",{className:"flex justify-between items-center mb-5",children:[_.jsxs("h4",{className:"font-bold text-gray-200",children:[" (",i.size,")"]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("input",{value:o,onChange:x=>l(x.target.value),placeholder:" ()...",className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-1.5 text-sm text-white focus:outline-none focus:border-coral w-36 placeholder-gray-500"}),_.jsx("button",{onClick:p,className:"bg-coral p-1.5 rounded-lg text-white hover:bg-coralDark",children:_.jsx(bg,{className:"w-4 h-4"})})]})]}),_.jsx("div",{className:"flex flex-wrap gap-3",children:Array.from(i).map(x=>_.jsxs("div",{className:"group relative px-4 py-2 bg-coral/10 text-coral rounded-xl text-sm font-bold border border-coral/20 flex items-center gap-2",children:[x," ",_.jsx("button",{onClick:()=>v(x),className:"opacity-0 group-hover:opacity-100 absolute -top-2 -right-2 bg-white text-coral rounded-full p-0.5 transition-opacity",children:_.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},x))})]})]})]})},TK=({onBack:n,t:e})=>{const[t,i]=Z.useState(""),[s,o]=Z.useState("USD"),[l,d]=Z.useState(null),[h,p]=Z.useState(!1),v=[{code:"USD",name:" (USD)"},{code:"JPY",name:" (JPY)"},{code:"KRW",name:" (KRW)"},{code:"EUR",name:" (EUR)"},{code:"CNY",name:" (CNY)"},{code:"THB",name:" (THB)"},{code:"VND",name:" (VND)"}],x=async()=>{if(t){p(!0);try{const b=parseFloat(t),A=await $j(b,s);d(Xj(A))}catch{d("")}finally{p(!1)}}};return _.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[_.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[_.jsx("button",{onClick:n,children:_.jsx(vs,{className:"w-6 h-6 text-gray-500"})}),_.jsx("h3",{className:"font-bold text-lg text-ink",children:""})]}),_.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[_.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand space-y-5",children:[_.jsxs("div",{children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),_.jsx("input",{type:"number",value:t,onChange:b=>i(b.target.value),placeholder:"...",className:"w-full mt-2 p-4 bg-paper rounded-2xl text-xl font-bold text-ink border-none outline-none"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),_.jsx("select",{value:s,onChange:b=>o(b.target.value),className:"w-full mt-2 p-4 bg-paper rounded-2xl text-ink font-medium border-none outline-none",children:v.map(b=>_.jsx("option",{value:b.code,children:b.name},b.code))})]}),_.jsx("button",{onClick:x,disabled:h||!t,className:"w-full bg-green-500 text-white py-4 rounded-2xl font-bold shadow-lg shadow-green-500/30 disabled:opacity-50 active:scale-95 transition-all",children:h?"...":" (TWD)"})]}),l&&_.jsxs("div",{className:"mt-6 bg-white p-6 rounded-3xl shadow-card border border-sand text-center animate-fade-in",children:[_.jsx("p",{className:"text-gray-400 text-sm font-medium mb-1",children:""}),_.jsx("p",{className:"text-3xl font-black text-ink",children:l})]})]})]})},EK=({onBack:n,t:e,language:t})=>_.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[_.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[_.jsx("button",{onClick:n,children:_.jsx(vs,{className:"w-6 h-6 text-gray-500"})}),_.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_translation||"Translation"})]}),_.jsx("div",{className:"flex-1 overflow-y-auto pb-32",children:_.jsx(cK,{defaultSourceLang:t})})]}),xK=({onBack:n,trips:e,settings:t,onMagicEditor:i,onOpenSettings:s})=>{const[o,l]=Z.useState("MENU"),d=nn[t.language]||nn["zh-TW"];if(o==="EXPENSE")return _.jsx(dK,{onBack:()=>l("MENU")});if(o==="VISA")return _.jsx(hK,{onBack:()=>l("MENU"),t:d,language:t.language,onOpenSettings:s});if(o==="CULTURE")return _.jsx(fK,{onBack:()=>l("MENU"),t:d,language:t.language,onOpenSettings:s});if(o==="RESTROOM")return _.jsx(mK,{onBack:()=>l("MENU"),t:d});if(o==="SCRATCH_MAP")return _.jsx(vK,{onBack:()=>l("MENU"),trips:e,t:d});if(o==="EMERGENCY")return _.jsx(pK,{onBack:()=>l("MENU"),t:d,language:t.language,onOpenSettings:s});if(o==="CARD_ADVICE")return _.jsx(gK,{onBack:()=>l("MENU"),t:d,language:t.language,onOpenSettings:s});if(o==="TIME_CAPSULE")return _.jsx("div",{onClick:()=>l("MENU"),children:"Coming Soon"});if(o==="TRANSLATION")return _.jsx(EK,{onBack:()=>l("MENU"),t:d,language:t.language});if(o==="CURRENCY")return _.jsx(TK,{onBack:()=>l("MENU"),t:d});const h=[{id:"MAGIC_EDITOR",name:"",icon:$a,color:"text-pink-500",bg:"bg-pink-50",desc:"AI ",action:i},{id:"CURRENCY",name:"",icon:I1,color:"text-green-500",bg:"bg-green-50",desc:""},{id:"TRANSLATION",name:d.tool_translation,icon:YD,color:"text-purple-500",bg:"bg-purple-50",desc:d.desc_translator},{id:"EMERGENCY",name:d.tool_emergency,icon:KD,color:"text-red-500",bg:"bg-red-50",desc:d.desc_emergency},{id:"CARD_ADVICE",name:d.tool_card,icon:WD,color:"text-indigo-500",bg:"bg-indigo-50",desc:d.desc_card},{id:"SCRATCH_MAP",name:d.tool_map,icon:HD,color:"text-teal-500",bg:"bg-teal-50",desc:d.desc_map},{id:"RESTROOM",name:d.tool_restroom,icon:GD,color:"text-cyan-500",bg:"bg-cyan-50",desc:d.desc_restroom},{id:"VISA",name:d.tool_visa,icon:qD,color:"text-blue-500",bg:"bg-blue-50",desc:d.desc_visa},{id:"CULTURE",name:d.tool_culture,icon:Uv,color:"text-orange-500",bg:"bg-orange-50",desc:d.desc_culture}];return _.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[_.jsx("div",{className:"px-5 py-4 pt-9 bg-paper sticky top-0 z-10 flex items-center justify-between border-b border-sand/50",children:_.jsxs("h2",{className:"text-xl font-extrabold text-ink flex items-center gap-2",children:[_.jsx(Q0,{className:"w-6 h-6 text-coral"}),d.tools_title]})}),_.jsx("div",{className:"p-5 grid grid-cols-2 gap-4 pb-32 overflow-y-auto",children:h.map(p=>_.jsxs("div",{onClick:()=>p.action?p.action():l(p.id),className:"bg-white p-5 rounded-3xl shadow-card border border-sand active:scale-95 transition-all cursor-pointer hover:shadow-soft hover:border-coral group",children:[_.jsx("div",{className:`w-12 h-12 ${p.bg} ${p.color} rounded-2xl flex items-center justify-center mb-4 transition-transform group-hover:scale-110`,children:_.jsx(p.icon,{className:"w-6 h-6 stroke-2"})}),_.jsx("h3",{className:"font-bold text-ink mb-1",children:p.name}),_.jsx("p",{className:"text-xs text-gray-400 font-medium",children:p.desc})]},p.id))})]})},wK=({onBack:n,settings:e,onUpdateSettings:t,onResetApp:i,user:s,onLogout:o})=>{const[l,d]=Z.useState(!1),[h,p]=Z.useState(!1),v=nn[e.language]||nn["zh-TW"];Z.useEffect(()=>{const A=localStorage.getItem("nomad_user_api_key")||localStorage.getItem("geminiApiKey");A&&!e.apiKey&&(t({apiKey:A}),localStorage.getItem("nomad_user_api_key")||localStorage.setItem("nomad_user_api_key",A),localStorage.removeItem("geminiApiKey"))},[]);const x=A=>{const P=A.replace(/\s/g,"");t({apiKey:P}),localStorage.setItem("nomad_user_api_key",P),A&&(p(!0),setTimeout(()=>p(!1),2e3))},b=[{name:"",value:"#FF6B6B"},{name:"",value:"#4ECDC4"},{name:"",value:"#FFE66D"},{name:"",value:"#A06CD5"},{name:"",value:"#6BCB77"}];return _.jsxs("div",{className:"h-full flex flex-col bg-paper animate-slide-in",children:[_.jsxs("div",{className:"px-6 py-6 flex items-center justify-between bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-sand",children:[_.jsx("button",{onClick:n,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 transition-colors",children:_.jsx(vs,{className:"w-6 h-6 text-ink"})}),_.jsx("h1",{className:"text-xl font-bold text-ink",children:""}),_.jsx("div",{className:"w-10"})]}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[s&&_.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[_.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("p",{className:"text-lg font-bold text-ink",children:s.username}),_.jsxs("p",{className:"text-xs text-gray-400",children:["ID: ",s.id]})]}),_.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-xl transition-colors text-sm font-medium",children:[_.jsx($D,{className:"w-4 h-4"}),""]})]})]}),_.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[_.jsxs("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider flex items-center gap-2",children:[_.jsx(XD,{className:"w-4 h-4"}),v.api_settings||"API "]}),_.jsxs("div",{className:"space-y-3",children:[_.jsx("label",{className:"text-sm font-bold text-ink",children:v.api_key_label||"Gemini API Key"}),_.jsxs("div",{className:"relative",children:[_.jsx("input",{type:"password",value:e.apiKey||"",onChange:A=>x(A.target.value),placeholder:v.api_key_placeholder||" API Key",className:"w-full p-4 pr-20 bg-gray-50 rounded-xl border border-gray-200 focus:border-coral focus:ring-2 focus:ring-coral/20 outline-none transition-all font-mono text-sm"}),h&&_.jsx("div",{className:"text-right mt-1",children:_.jsx("span",{className:"text-green-500 text-xs font-bold animate-fade-in",children:v.api_key_saved||""})})]}),_.jsxs("p",{className:"text-xs text-gray-400 leading-relaxed",children:[v.api_key_help||" Key ",_.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-coral hover:underline ml-1",children:" Key"})]})]}),_.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[_.jsx("button",{onClick:async()=>{const A=document.getElementById("test-ai-btn"),P=document.getElementById("test-ai-result");A&&(A.textContent=v.test_ai_testing||"Testing..."),P&&(P.innerHTML="");const F=await sN();A&&(A.textContent=v.test_ai_connection||"Test AI Connection"),P&&(P.className=`text-xs p-3 rounded-lg mt-2 ${F.success?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,P.innerHTML=`
                                        <strong>${F.success?v.test_ai_success||"Success":v.test_ai_failed||"Failed"}</strong><br/>
                                        Source: ${F.source}<br/>
                                        Message: ${F.message}
                                    `)},id:"test-ai-btn",className:"text-xs bg-gray-100 hover:bg-gray-200 text-gray-600 px-3 py-2 rounded-lg transition-colors font-medium",children:v.test_ai_connection||" AI "}),_.jsx("div",{id:"test-ai-result"})]})]}),_.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[_.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),_.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:[b.map(A=>_.jsx("button",{onClick:()=>t({themeColor:A.value}),className:`w-10 h-10 rounded-full flex-shrink-0 transition-transform ${e.themeColor===A.value?"scale-110 ring-2 ring-offset-2 ring-gray-300":"hover:scale-105"}`,style:{backgroundColor:A.value},"aria-label":A.name},A.value)),_.jsx("button",{onClick:()=>t({themeColor:void 0}),className:`w-10 h-10 rounded-full flex-shrink-0 bg-coral flex items-center justify-center text-white text-xs font-bold transition-transform ${e.themeColor?"hover:scale-105":"scale-110 ring-2 ring-offset-2 ring-gray-300"}`,children:""})]})]}),_.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[_.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),_.jsx("div",{className:"space-y-2",children:[{code:"zh-TW",label:""},{code:"en-US",label:"English"},{code:"ja-JP",label:""}].map(A=>_.jsxs("button",{onClick:()=>t({language:A.code}),className:`w-full flex items-center justify-between p-3 rounded-xl transition-colors ${e.language===A.code?"bg-coral/10 text-coral font-bold":"hover:bg-gray-50 text-ink"}`,children:[_.jsx("span",{children:A.label}),e.language===A.code&&_.jsx("div",{className:"w-2 h-2 rounded-full bg-coral"})]},A.code))})]}),_.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[_.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),l?_.jsxs("div",{className:"space-y-3 animate-fade-in",children:[_.jsx("p",{className:"text-center text-sm text-red-500 font-medium",children:""}),_.jsxs("div",{className:"flex gap-3",children:[_.jsx("button",{onClick:()=>d(!1),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold",children:""}),_.jsx("button",{onClick:()=>{i(),d(!1)},className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg shadow-red-500/30",children:""})]})]}):_.jsxs("button",{onClick:()=>d(!0),className:"w-full flex items-center justify-center gap-2 p-4 border-2 border-red-100 text-red-500 rounded-xl hover:bg-red-50 transition-colors font-bold",children:[_.jsx(ol,{className:"w-5 h-5"}),""]})]}),_.jsxs("div",{className:"text-center text-xs text-gray-400 py-4",children:[_.jsx("p",{children:"NomadAI Travel Journal v1.0.0"}),_.jsx("p",{className:"mt-1",children:"Made with  by NomadAI Team"})]})]})]})},SK=({onLogin:n})=>{const[e,t]=Z.useState(""),[i,s]=Z.useState(!1),o=async()=>{console.log("Attempting Google Login..."),s(!0),t("");try{const l=await rB(Y0,Gj);console.log("Google Login Success:",l.user.uid)}catch(l){console.error("Login failed",l),t(l.message||"")}finally{s(!1)}};return _.jsx("div",{className:"h-full flex flex-col items-center justify-center p-6 bg-paper",children:_.jsxs("div",{className:"w-full max-w-sm bg-white rounded-3xl shadow-card p-8 border border-sand text-center",children:[_.jsxs("div",{className:"flex flex-col items-center mb-8",children:[_.jsx("div",{className:"w-16 h-16 bg-coral rounded-2xl flex items-center justify-center mb-4 shadow-lg shadow-coral/30",children:_.jsx($a,{className:"w-8 h-8 text-white"})}),_.jsx("h1",{className:"text-2xl font-bold text-ink",children:"Ques-trip"}),_.jsx("p",{className:"text-gray-400 text-sm mt-2",children:""})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("button",{id:"google-login-btn",onClick:o,disabled:i,className:"w-full bg-white border border-gray-300 text-gray-700 py-3.5 rounded-xl font-bold shadow-sm hover:bg-gray-50 active:scale-95 transition-all flex items-center justify-center gap-3",children:[i?_.jsx("div",{className:"w-5 h-5 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}):_.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[_.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),_.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),_.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.84z",fill:"#FBBC05"}),_.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]})," Google "]}),e&&_.jsx("div",{className:"text-red-500 text-sm font-medium bg-red-50 p-2 rounded-lg",children:e})]})]})})},bK=({memories:n,onAddMemory:e,onDeleteMemory:t,settings:i})=>{const[s,o]=Z.useState(""),[l,d]=Z.useState(null),h=Z.useRef(null),p=async x=>{var A;const b=(A=x.target.files)==null?void 0:A[0];if(b)try{const{compressImage:P}=await Rg(async()=>{const{compressImage:H}=await import("./image-CYcWJ_KT.js");return{compressImage:H}},[]),F=await P(b);d(F)}catch(P){console.error("Image compression failed",P),alert("")}},v=x=>{if(x.preventDefault(),!l)return;const b={id:Date.now().toString(),userId:"",imageUrl:l,caption:s,date:new Date().toISOString()};e(b),o(""),d(null),h.current&&(h.current.value="")};return _.jsxs("div",{className:"h-full flex flex-col bg-paper animate-slide-in pb-24",children:[_.jsxs("div",{className:"px-6 py-6 bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-sand pt-safe pt-12",children:[_.jsxs("h1",{className:"text-2xl font-bold text-ink flex items-center gap-2",children:[_.jsx($c,{className:"w-8 h-8 text-coral"}),""]}),_.jsx("p",{className:"text-sm text-gray-400 mt-1",children:""})]}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[_.jsx("div",{className:"bg-white rounded-3xl p-6 shadow-card border border-sand",children:_.jsxs("form",{onSubmit:v,className:"space-y-4",children:[_.jsxs("div",{onClick:()=>{var x;return(x=h.current)==null?void 0:x.click()},className:`relative w-full aspect-video rounded-2xl border-2 border-dashed border-sand flex flex-col items-center justify-center cursor-pointer transition-all hover:bg-gray-50 ${l?"border-none p-0 overflow-hidden":""}`,children:[l?_.jsx("img",{src:l,alt:"Preview",className:"w-full h-full object-cover"}):_.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[_.jsx($c,{className:"w-12 h-12 mb-2"}),_.jsx("span",{className:"font-medium",children:""})]}),_.jsx("input",{type:"file",ref:h,onChange:p,accept:"image/*",className:"hidden"})]}),_.jsx("textarea",{value:s,onChange:x=>o(x.target.value),placeholder:"...",className:"w-full bg-paper rounded-xl p-4 text-ink font-medium outline-none focus:ring-2 focus:ring-coral/50 transition-all border border-sand resize-none h-24"}),_.jsxs("button",{type:"submit",disabled:!l,className:`w-full py-3.5 rounded-xl font-bold shadow-lg transition-all flex items-center justify-center gap-2 ${l?"bg-coral text-white shadow-coral/30 active:scale-95":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[_.jsx(bg,{className:"w-5 h-5"}),""]})]})}),_.jsx("div",{className:"grid grid-cols-1 gap-6",children:n.length===0?_.jsxs("div",{className:"text-center py-12 text-gray-400",children:[_.jsx("p",{children:""}),_.jsx("p",{className:"text-sm mt-2",children:""})]}):n.map(x=>_.jsxs("div",{className:"bg-white rounded-3xl overflow-hidden shadow-card border border-sand group",children:[_.jsxs("div",{className:"relative aspect-video",children:[_.jsx("img",{src:x.imageUrl,alt:x.caption,className:"w-full h-full object-cover"}),_.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-end p-4",children:_.jsx("button",{onClick:()=>t(x.id),className:"p-2 bg-white/20 backdrop-blur-md text-white rounded-full hover:bg-red-500 transition-colors",children:_.jsx(ol,{className:"w-5 h-5"})})})]}),_.jsxs("div",{className:"p-5",children:[_.jsx("p",{className:"text-ink font-medium whitespace-pre-wrap",children:x.caption}),_.jsx("p",{className:"text-xs text-gray-400 mt-3",children:new Date(x.date).toLocaleDateString()})]})]},x.id))})]})]})};function CK(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:i,onRegistered:s,onRegisteredSW:o,onRegisterError:l}=n;let d,h;const p=async(x=!0)=>{await h};async function v(){if("serviceWorker"in navigator){if(d=await Rg(async()=>{const{Workbox:x}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:x}},[]).then(({Workbox:x})=>new x("/sw.js",{scope:"/",type:"classic"})).catch(x=>{l==null||l(x)}),!d)return;d.addEventListener("activated",x=>{(x.isUpdate||x.isExternal)&&window.location.reload()}),d.addEventListener("installed",x=>{x.isUpdate||i==null||i()}),d.register({immediate:e}).then(x=>{o?o("/sw.js",x):s==null||s(x)}).catch(x=>{l==null||l(x)})}}return h=v(),p}function IK(n={}){const{immediate:e=!0,onNeedRefresh:t,onOfflineReady:i,onRegistered:s,onRegisteredSW:o,onRegisterError:l}=n,[d,h]=Z.useState(!1),[p,v]=Z.useState(!1),[x]=Z.useState(()=>CK({immediate:e,onOfflineReady(){v(!0),i==null||i()},onNeedRefresh(){h(!0),t==null||t()},onRegistered:s,onRegisteredSW:o,onRegisterError:l}));return{needRefresh:[d,h],offlineReady:[p,v],updateServiceWorker:x}}const AK=({settings:n})=>{n&&nn[n.language]||nn["zh-TW"];const{offlineReady:[e,t],needRefresh:[i,s],updateServiceWorker:o}=IK({onRegistered(d){console.log("SW Registered: "+d)},onRegisterError(d){console.log("SW registration error",d)}}),l=()=>{t(!1),s(!1)};return!e&&!i?null:_.jsxs("div",{className:"fixed bottom-6 right-6 z-[1000] p-4 bg-ink text-white rounded-xl shadow-2xl animate-slide-up max-w-xs border border-white/10",children:[_.jsx("div",{className:"mb-3 font-bold",children:e?_.jsx("span",{children:"App ready to work offline"}):_.jsx("span",{children:"New content available, click on reload button to update."})}),_.jsxs("div",{className:"flex gap-2",children:[i&&_.jsx("button",{className:"flex-1 px-3 py-2 bg-coral text-white rounded-lg font-bold text-sm hover:bg-coralDark transition-colors",onClick:()=>o(!0),children:"Reload"}),_.jsx("button",{className:"flex-1 px-3 py-2 bg-white/10 text-white rounded-lg font-bold text-sm hover:bg-white/20 transition-colors",onClick:l,children:"Close"})]})]})},NK=()=>{const[n,e]=Z.useState(!1);return Z.useEffect(()=>{const t=()=>e(!1),i=()=>e(!0);window.addEventListener("online",t),window.addEventListener("offline",i);const s=jj();return e(!navigator.onLine),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",i),s()}},[]),n?_.jsx("div",{className:"fixed bottom-24 left-1/2 -translate-x-1/2 z-50 animate-fade-in",children:_.jsxs("div",{className:"bg-gray-800/90 backdrop-blur text-white px-4 py-2 rounded-full shadow-lg flex items-center gap-2 text-sm font-bold",children:[_.jsx(zD,{className:"w-4 h-4 text-gray-400"}),_.jsx("span",{children:""})]})}):null},RK={USERS:"nomad_app_users_v1",CURRENT_USER:"nomad_app_current_user_v1",getTripsKey:n=>`nomad_app_trips_${n} `,getSettingsKey:n=>`nomad_app_settings_${n} `,getMemoriesKey:n=>`nomad_app_memories_${n} `,getChatSessionsKey:n=>`nomad_app_chat_sessions_${n} `},MK=()=>{console.log("App Component Rendering...");const[n,e]=Z.useState({id:"test-user-id",username:"Test User",password:"",createdAt:new Date().toISOString()}),[t,i]=Z.useState([]),[s,o]=Z.useState([]),[l,d]=Z.useState([]),[h,p]=Z.useState(null),[v,x]=Z.useState({language:"zh-TW",minimalistMode:!1}),[b,A]=Z.useState(!0),[P,F]=Z.useState(null),[H,X]=Z.useState(ot.HOME),[re,Q]=Z.useState(null),[he,fe]=Z.useState([]);Z.useEffect(()=>{console.log("Setting up Auth Listener...");const le=U9(Y0,_e=>{if(console.log("Auth State Changed:",_e?"User Logged In":"User Logged Out",_e==null?void 0:_e.uid),_e){const Ce={id:_e.uid,username:_e.displayName||"Traveler",email:_e.email||"",password:"",createdAt:_e.metadata.creationTime||new Date().toISOString()};e(Ce),(async()=>{try{const Yt=ef(Oo,"users",_e.uid);await Cq(Yt,{uid:_e.uid,email:_e.email,username:_e.displayName||"Traveler",lastSeen:VA()},{merge:!0})}catch(Yt){console.error("Error syncing user:",Yt)}})(),console.log("Listening to trips for user:",_e.uid);const Be=k0(Cp(Oo,"itineraries"),D0("userIds","array-contains",_e.uid)),Ye=k0(Cp(Oo,"itineraries"),D0("uid","==",_e.uid));Nh(Be,Yt=>{}),Nh(Be,Yt=>{const Nt=[];Yt.forEach(Mt=>{Nt.push({id:Mt.id,...Mt.data()})});const Rt=Nh(Ye,Mt=>{const we=new Map;Nt.forEach(De=>we.set(De.id,De)),Mt.forEach(De=>{const je=De.data(),nt={id:De.id,...je};nt.userIds||(console.log("Migrating legacy trip:",nt.id),Ap(De.ref,{userIds:[_e.uid],collaborators:[]}).catch(lt=>console.error("Migration failed",lt))),we.set(nt.id,nt)});const pe=Array.from(we.values());pe.sort((De,je)=>{const nt=De.createdAt?typeof De.createdAt=="string"?new Date(De.createdAt).getTime():De.createdAt.toMillis?De.createdAt.toMillis():0:0;return(je.createdAt?typeof je.createdAt=="string"?new Date(je.createdAt).getTime():je.createdAt.toMillis?je.createdAt.toMillis():0:0)-nt}),i(pe),A(!0),F(null)});return()=>Rt()});let At=[],Jt=[];const ct=()=>{const Yt=new Map;At.forEach(Rt=>Yt.set(Rt.id,Rt)),Jt.forEach(Rt=>Yt.set(Rt.id,Rt));const Nt=Array.from(Yt.values());Nt.sort((Rt,Mt)=>{const we=Rt.createdAt?typeof Rt.createdAt=="string"?new Date(Rt.createdAt).getTime():Rt.createdAt.toMillis?Rt.createdAt.toMillis():0:0;return(Mt.createdAt?typeof Mt.createdAt=="string"?new Date(Mt.createdAt).getTime():Mt.createdAt.toMillis?Mt.createdAt.toMillis():0:0)-we}),i(Nt),A(!0)},mn=Nh(Be,Yt=>{At=[],Yt.forEach(Nt=>{At.push({id:Nt.id,...Nt.data()})}),ct()}),Rn=Nh(Ye,Yt=>{Jt=[],Yt.forEach(Nt=>{const Rt=Nt.data();Rt.userIds||(console.log("Migrating legacy trip:",Nt.id),Ap(Nt.ref,{userIds:[_e.uid],collaborators:[]}),Jt.push({id:Nt.id,...Rt}))}),ct()});return()=>{mn(),Rn()}}else e(null),i([]),A(!0)});return()=>le()},[]);const Y=async le=>{if(n)try{const{id:_e,...Ce}=le;await Aq(Cp(Oo,"itineraries"),{...Ce,...Ce,uid:n.id,userIds:[n.id],collaborators:[],createdAt:VA()}),H===ot.AI_PLANNER&&X(ot.HOME)}catch(_e){console.error("Error adding trip",_e),F(`Add Trip Error: ${_e.message}`),alert(": "+_e.message)}},k=async le=>{if(!(!n||!le.id))try{const _e=ef(Oo,"itineraries",le.id),{id:Ce,...Fe}=le;await Ap(_e,Fe),(re==null?void 0:re.id)===le.id&&Q(le)}catch(_e){console.error("Error updating trip",_e),alert("")}},B=async le=>{try{await Iq(ef(Oo,"itineraries",le)),(re==null?void 0:re.id)===le&&(Q(null),X(ot.HOME))}catch(_e){console.error("Error deleting trip",_e),alert("")}},O=Z.useCallback(async(le,_e)=>{var Fe;console.log("Starting background generation...",{userPrompt:le,tripId:_e});const Ce=Date.now().toString();fe(Be=>[...Be,Ce]);try{let Be,Ye=null;_e&&(Ye=t.find(ct=>ct.id===_e)),Ye?(console.log("Updating existing trip:",Ye.title),Be=await aN(Ye,le,v.language),console.log("Updated Trip Plan:",Be)):(console.log("Generating new trip..."),Be=await oN(le,v.language),console.log("New Trip Plan:",Be));let At=Be.coverImage||(Ye==null?void 0:Ye.coverImage);if(!At)try{const ct=Be.title||le;At=await lT(ct)}catch(ct){console.error("Failed to generate cover image:",ct),At=`https://placehold.co/800x600/e2e8f0/475569?text=${encodeURIComponent(((Fe=Be.title)==null?void 0:Fe.split(" ")[0])||"Travel")}`}!Be.itinerary||Be.itinerary.length===0?console.warn("AI returned empty itinerary:",Be):Be.itinerary=Be.itinerary.map(ct=>({...ct,day:Number(ct.day)||1,id:ct.id||Math.random().toString(36).substr(2,9),time:ct.time||"09:00",activity:ct.activity||"New Activity",location:ct.location||"",notes:ct.notes||""}));let Jt;return Ye?(Jt={...Ye,...Be,id:Ye.id,coverImage:At},k(Jt)):(Jt={...Be,id:Ce,coverImage:At,bookings:[],budget:Be.budget||{total:0,currency:"TWD",expenses:[]},weather:Be.weather||[]},Y(Jt)),fe(ct=>ct.filter(mn=>mn!==Ce)),{title:Jt.title,tripId:Jt.id}}catch(Be){return console.error("Background generation failed",Be),fe(Ye=>Ye.filter(At=>At!==Ce)),null}},[t,v.language]),q=le=>{x(_e=>({..._e,...le}))},G=()=>{n&&W()},W=async()=>{try{await F9(Y0),X(ot.HOME),Q(null)}catch(le){console.error("Logout failed",le)}},z=()=>{},He=()=>{},Qe=le=>{o([le,...s])},se=le=>{o(s.filter(_e=>_e.id!==le))},Se=()=>{const le={id:Date.now().toString(),title:v.language==="zh-TW"?"":"New Chat",messages:[],createdAt:Date.now(),updatedAt:Date.now()};return d(_e=>[le,..._e]),p(le.id),le.id},be=(le,_e,Ce,Fe)=>{d(Be=>Be.map(Ye=>{if(Ye.id===le){let At=Ye.title;if(Ce)At=Ce;else if(!Ye.messages.some(ct=>ct.role==="user")){const ct=_e.find(mn=>mn.role==="user");ct&&(At=ct.content.slice(0,20)+(ct.content.length>20?"...":""))}return{...Ye,messages:_e,title:At,tripId:Fe||Ye.tripId,updatedAt:Date.now()}}return Ye}))},it=le=>{d(_e=>_e.filter(Ce=>Ce.id!==le)),h===le&&p(null)},Pe=le=>{p(le)};if(Z.useEffect(()=>{const le=document.getElementById("loading-screen");le?(console.log("Removing loading screen..."),le.style.opacity="0",setTimeout(()=>le.remove(),500)):console.log("Loading screen not found (already removed?)")},[]),Z.useEffect(()=>{if(n&&b)try{localStorage.setItem(RK.getSettingsKey(n.id),JSON.stringify(v))}catch(le){console.error("Failed to save settings",le)}v.themeColor?document.documentElement.style.setProperty("--color-coral",v.themeColor):document.documentElement.style.removeProperty("--color-coral")},[v,n,b]),!n)return _.jsx(SK,{onLogin:z,onRegister:He});const K=le=>{const _e=l.find(Ce=>Ce.tripId===le);if(_e)p(_e.id);else{const Ce=Se();d(Fe=>Fe.map(Be=>{var Ye;return Be.id===Ce?{...Be,tripId:le,title:`${((Ye=t.find(At=>At.id===le))==null?void 0:Ye.title)||"Trip"} Planning`}:Be}))}X(ot.AI_PLANNER)},me=()=>{switch(H){case ot.HOME:return _.jsx(n5,{trips:t,onSelectTrip:le=>{Q(le),X(ot.TRIP_DETAILS)},onAddTrip:()=>X(ot.ADD_TRIP),onOpenSettings:()=>X(ot.SETTINGS),settings:v});case ot.ADD_TRIP:return _.jsx(k6,{onSave:le=>{Y(le),X(ot.HOME)},onCancel:()=>X(ot.HOME),settings:v,currentUser:n});case ot.MAGIC_EDITOR:return _.jsx(D6,{settings:v,onBack:()=>X(ot.TOOLS)});case ot.TRIP_MEMORY:return _.jsx(bK,{memories:s,onAddMemory:Qe,onDeleteMemory:se,settings:v});case ot.AI_PLANNER:return _.jsx(Yj,{onStartGeneration:O,onCancel:()=>X(ot.HOME),settings:v,sessions:l,currentSessionId:h,onCreateSession:Se,onUpdateSession:be,onDeleteSession:it,onSelectSession:Pe});case ot.TOOLS:return _.jsx(xK,{onBack:()=>X(ot.HOME),trips:t,settings:v,onMagicEditor:()=>X(ot.MAGIC_EDITOR),onOpenSettings:()=>X(ot.SETTINGS)});case ot.TRIP_DETAILS:return re?_.jsx(Wj,{trip:re,onBack:()=>X(ot.HOME),onDelete:B,onUpdateTrip:k,onOpenAI:K,settings:v,user:n}):null;case ot.SETTINGS:return _.jsx(wK,{onBack:()=>X(ot.HOME),settings:v,onUpdateSettings:q,onResetApp:G,user:n,onLogout:W});default:return null}},Ie=[ot.HOME,ot.TRIP_MEMORY,ot.TOOLS,ot.AI_PLANNER].includes(H);return _.jsxs("div",{className:"h-full w-full max-w-md mx-auto bg-paper shadow-2xl relative overflow-hidden flex flex-col font-sans text-ink",children:[P&&_.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 relative",role:"alert",children:[_.jsx("strong",{className:"font-bold",children:"Error: "}),_.jsx("span",{className:"block sm:inline",children:P}),_.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>F(null),children:_.jsxs("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[_.jsx("title",{children:"Close"}),_.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]}),_.jsx("div",{className:"flex-1 overflow-hidden relative bg-paper",children:me()}),Ie&&_.jsx("div",{className:"absolute bottom-6 left-4 right-4 z-40",children:_.jsxs("div",{className:"bg-white/90 backdrop-blur-xl border border-white/50 shadow-float rounded-3xl px-2 py-3 flex justify-around items-center",children:[_.jsxs("button",{onClick:()=>X(ot.HOME),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${H===ot.HOME?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[_.jsx(OD,{className:`w-6 h-6 ${H===ot.HOME?"stroke-2":"stroke-[1.5]"}`}),H===ot.HOME&&_.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),_.jsxs("button",{onClick:()=>X(ot.AI_PLANNER),className:`relative flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${H===ot.AI_PLANNER?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[_.jsxs("div",{className:"relative",children:[_.jsx(C1,{className:`w-6 h-6 ${H===ot.AI_PLANNER?"stroke-2":"stroke-[1.5]"}`}),(he==null?void 0:he.length)>0&&_.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-coral rounded-full animate-ping"}),(he==null?void 0:he.length)>0&&_.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-coral rounded-full border-2 border-white"})]}),H===ot.AI_PLANNER&&_.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),_.jsxs("button",{onClick:()=>X(ot.TRIP_MEMORY),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${H===ot.TRIP_MEMORY?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[_.jsx($c,{className:`w-6 h-6 ${H===ot.TRIP_MEMORY?"stroke-2":"stroke-[1.5]"}`}),H===ot.TRIP_MEMORY&&_.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),_.jsxs("button",{onClick:()=>X(ot.TOOLS),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${H===ot.TOOLS?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[_.jsx(Q0,{className:`w-6 h-6 ${H===ot.TOOLS?"stroke-2":"stroke-[1.5]"}`}),H===ot.TOOLS&&_.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]})]})}),_.jsx(AK,{settings:v}),_.jsx(NK,{})]})};console.log("NomadAI App Starting...");const uk=document.getElementById("root");if(!uk)throw new Error("Could not find root element to mount to");const PK=LD.createRoot(uk);try{PK.render(_.jsx(af.StrictMode,{children:_.jsx(MK,{})})),setTimeout(()=>{const n=document.getElementById("loading-screen");n&&(console.warn("Force removing loader after timeout"),n.style.opacity="0",setTimeout(()=>n.remove(),500))},3e3)}catch(n){console.error("React Render Error:",n)}
