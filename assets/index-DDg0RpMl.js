(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();function Cy(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var a_={exports:{}},Td={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yx;function b2(){if(Yx)return Td;Yx=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,a){var u=null;if(a!==void 0&&(u=""+a),r.key!==void 0&&(u=""+r.key),"key"in r){a={};for(var f in r)f!=="key"&&(a[f]=r[f])}else a=r;return r=a.ref,{$$typeof:n,type:i,key:u,ref:r!==void 0?r:null,props:a}}return Td.Fragment=e,Td.jsx=t,Td.jsxs=t,Td}var Wx;function A2(){return Wx||(Wx=1,a_.exports=b2()),a_.exports}var v=A2(),l_={exports:{}},ut={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qx;function I2(){if(Qx)return ut;Qx=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),A=Symbol.iterator;function R(j){return j===null||typeof j!="object"?null:(j=A&&j[A]||j["@@iterator"],typeof j=="function"?j:null)}var V={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,Z={};function X(j,fe,Ie){this.props=j,this.context=fe,this.refs=Z,this.updater=Ie||V}X.prototype.isReactComponent={},X.prototype.setState=function(j,fe){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,fe,"setState")},X.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function ne(){}ne.prototype=X.prototype;function Q(j,fe,Ie){this.props=j,this.context=fe,this.refs=Z,this.updater=Ie||V}var pe=Q.prototype=new ne;pe.constructor=Q,z(pe,X.prototype),pe.isPureReactComponent=!0;var he=Array.isArray;function Y(){}var D={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function O(j,fe,Ie){var le=Ie.ref;return{$$typeof:n,type:j,key:fe,ref:le!==void 0?le:null,props:Ie}}function G(j,fe){return O(j.type,fe,j.props)}function q(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function K(j){var fe={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(Ie){return fe[Ie]})}var F=/\/+/g;function qe(j,fe){return typeof j=="object"&&j!==null&&j.key!=null?K(""+j.key):fe.toString(36)}function Je(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(Y,Y):(j.status="pending",j.then(function(fe){j.status==="pending"&&(j.status="fulfilled",j.value=fe)},function(fe){j.status==="pending"&&(j.status="rejected",j.reason=fe)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function ie(j,fe,Ie,le,ge){var Ae=typeof j;(Ae==="undefined"||Ae==="boolean")&&(j=null);var He=!1;if(j===null)He=!0;else switch(Ae){case"bigint":case"string":case"number":He=!0;break;case"object":switch(j.$$typeof){case n:case e:He=!0;break;case E:return He=j._init,ie(He(j._payload),fe,Ie,le,ge)}}if(He)return ge=ge(j),He=le===""?"."+qe(j,0):le,he(ge)?(Ie="",He!=null&&(Ie=He.replace(F,"$&/")+"/"),ie(ge,fe,Ie,"",function(et){return et})):ge!=null&&(q(ge)&&(ge=G(ge,Ie+(ge.key==null||j&&j.key===ge.key?"":(""+ge.key).replace(F,"$&/")+"/")+He)),fe.push(ge)),1;He=0;var Ue=le===""?".":le+":";if(he(j))for(var we=0;we<j.length;we++)le=j[we],Ae=Ue+qe(le,we),He+=ie(le,fe,Ie,Ae,ge);else if(we=R(j),typeof we=="function")for(j=we.call(j),we=0;!(le=j.next()).done;)le=le.value,Ae=Ue+qe(le,we++),He+=ie(le,fe,Ie,Ae,ge);else if(Ae==="object"){if(typeof j.then=="function")return ie(Je(j),fe,Ie,le,ge);throw fe=String(j),Error("Objects are not valid as a React child (found: "+(fe==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":fe)+"). If you meant to render a collection of children, use an array instead.")}return He}function be(j,fe,Ie){if(j==null)return j;var le=[],ge=0;return ie(j,le,"","",function(Ae){return fe.call(Ie,Ae,ge++)}),le}function Se(j){if(j._status===-1){var fe=j._result;fe=fe(),fe.then(function(Ie){(j._status===0||j._status===-1)&&(j._status=1,j._result=Ie)},function(Ie){(j._status===0||j._status===-1)&&(j._status=2,j._result=Ie)}),j._status===-1&&(j._status=0,j._result=fe)}if(j._status===1)return j._result.default;throw j._result}var $e=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var fe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(fe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)},Me={map:be,forEach:function(j,fe,Ie){be(j,function(){fe.apply(this,arguments)},Ie)},count:function(j){var fe=0;return be(j,function(){fe++}),fe},toArray:function(j){return be(j,function(fe){return fe})||[]},only:function(j){if(!q(j))throw Error("React.Children.only expected to receive a single React element child.");return j}};return ut.Activity=S,ut.Children=Me,ut.Component=X,ut.Fragment=t,ut.Profiler=r,ut.PureComponent=Q,ut.StrictMode=i,ut.Suspense=m,ut.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,ut.__COMPILER_RUNTIME={__proto__:null,c:function(j){return D.H.useMemoCache(j)}},ut.cache=function(j){return function(){return j.apply(null,arguments)}},ut.cacheSignal=function(){return null},ut.cloneElement=function(j,fe,Ie){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var le=z({},j.props),ge=j.key;if(fe!=null)for(Ae in fe.key!==void 0&&(ge=""+fe.key),fe)!B.call(fe,Ae)||Ae==="key"||Ae==="__self"||Ae==="__source"||Ae==="ref"&&fe.ref===void 0||(le[Ae]=fe[Ae]);var Ae=arguments.length-2;if(Ae===1)le.children=Ie;else if(1<Ae){for(var He=Array(Ae),Ue=0;Ue<Ae;Ue++)He[Ue]=arguments[Ue+2];le.children=He}return O(j.type,ge,le)},ut.createContext=function(j){return j={$$typeof:u,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:a,_context:j},j},ut.createElement=function(j,fe,Ie){var le,ge={},Ae=null;if(fe!=null)for(le in fe.key!==void 0&&(Ae=""+fe.key),fe)B.call(fe,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(ge[le]=fe[le]);var He=arguments.length-2;if(He===1)ge.children=Ie;else if(1<He){for(var Ue=Array(He),we=0;we<He;we++)Ue[we]=arguments[we+2];ge.children=Ue}if(j&&j.defaultProps)for(le in He=j.defaultProps,He)ge[le]===void 0&&(ge[le]=He[le]);return O(j,Ae,ge)},ut.createRef=function(){return{current:null}},ut.forwardRef=function(j){return{$$typeof:f,render:j}},ut.isValidElement=q,ut.lazy=function(j){return{$$typeof:E,_payload:{_status:-1,_result:j},_init:Se}},ut.memo=function(j,fe){return{$$typeof:p,type:j,compare:fe===void 0?null:fe}},ut.startTransition=function(j){var fe=D.T,Ie={};D.T=Ie;try{var le=j(),ge=D.S;ge!==null&&ge(Ie,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(Y,$e)}catch(Ae){$e(Ae)}finally{fe!==null&&Ie.types!==null&&(fe.types=Ie.types),D.T=fe}},ut.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},ut.use=function(j){return D.H.use(j)},ut.useActionState=function(j,fe,Ie){return D.H.useActionState(j,fe,Ie)},ut.useCallback=function(j,fe){return D.H.useCallback(j,fe)},ut.useContext=function(j){return D.H.useContext(j)},ut.useDebugValue=function(){},ut.useDeferredValue=function(j,fe){return D.H.useDeferredValue(j,fe)},ut.useEffect=function(j,fe){return D.H.useEffect(j,fe)},ut.useEffectEvent=function(j){return D.H.useEffectEvent(j)},ut.useId=function(){return D.H.useId()},ut.useImperativeHandle=function(j,fe,Ie){return D.H.useImperativeHandle(j,fe,Ie)},ut.useInsertionEffect=function(j,fe){return D.H.useInsertionEffect(j,fe)},ut.useLayoutEffect=function(j,fe){return D.H.useLayoutEffect(j,fe)},ut.useMemo=function(j,fe){return D.H.useMemo(j,fe)},ut.useOptimistic=function(j,fe){return D.H.useOptimistic(j,fe)},ut.useReducer=function(j,fe,Ie){return D.H.useReducer(j,fe,Ie)},ut.useRef=function(j){return D.H.useRef(j)},ut.useState=function(j){return D.H.useState(j)},ut.useSyncExternalStore=function(j,fe,Ie){return D.H.useSyncExternalStore(j,fe,Ie)},ut.useTransition=function(){return D.H.useTransition()},ut.version="19.2.0",ut}var $x;function Ny(){return $x||($x=1,l_.exports=I2()),l_.exports}var W=Ny();const Wd=Cy(W);var u_={exports:{}},xd={},c_={exports:{}},d_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xx;function C2(){return Xx||(Xx=1,(function(n){function e(ie,be){var Se=ie.length;ie.push(be);e:for(;0<Se;){var $e=Se-1>>>1,Me=ie[$e];if(0<r(Me,be))ie[$e]=be,ie[Se]=Me,Se=$e;else break e}}function t(ie){return ie.length===0?null:ie[0]}function i(ie){if(ie.length===0)return null;var be=ie[0],Se=ie.pop();if(Se!==be){ie[0]=Se;e:for(var $e=0,Me=ie.length,j=Me>>>1;$e<j;){var fe=2*($e+1)-1,Ie=ie[fe],le=fe+1,ge=ie[le];if(0>r(Ie,Se))le<Me&&0>r(ge,Ie)?(ie[$e]=ge,ie[le]=Se,$e=le):(ie[$e]=Ie,ie[fe]=Se,$e=fe);else if(le<Me&&0>r(ge,Se))ie[$e]=ge,ie[le]=Se,$e=le;else break e}}return be}function r(ie,be){var Se=ie.sortIndex-be.sortIndex;return Se!==0?Se:ie.id-be.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var u=Date,f=u.now();n.unstable_now=function(){return u.now()-f}}var m=[],p=[],E=1,S=null,A=3,R=!1,V=!1,z=!1,Z=!1,X=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;function pe(ie){for(var be=t(p);be!==null;){if(be.callback===null)i(p);else if(be.startTime<=ie)i(p),be.sortIndex=be.expirationTime,e(m,be);else break;be=t(p)}}function he(ie){if(z=!1,pe(ie),!V)if(t(m)!==null)V=!0,Y||(Y=!0,K());else{var be=t(p);be!==null&&Je(he,be.startTime-ie)}}var Y=!1,D=-1,B=5,O=-1;function G(){return Z?!0:!(n.unstable_now()-O<B)}function q(){if(Z=!1,Y){var ie=n.unstable_now();O=ie;var be=!0;try{e:{V=!1,z&&(z=!1,ne(D),D=-1),R=!0;var Se=A;try{t:{for(pe(ie),S=t(m);S!==null&&!(S.expirationTime>ie&&G());){var $e=S.callback;if(typeof $e=="function"){S.callback=null,A=S.priorityLevel;var Me=$e(S.expirationTime<=ie);if(ie=n.unstable_now(),typeof Me=="function"){S.callback=Me,pe(ie),be=!0;break t}S===t(m)&&i(m),pe(ie)}else i(m);S=t(m)}if(S!==null)be=!0;else{var j=t(p);j!==null&&Je(he,j.startTime-ie),be=!1}}break e}finally{S=null,A=Se,R=!1}be=void 0}}finally{be?K():Y=!1}}}var K;if(typeof Q=="function")K=function(){Q(q)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,qe=F.port2;F.port1.onmessage=q,K=function(){qe.postMessage(null)}}else K=function(){X(q,0)};function Je(ie,be){D=X(function(){ie(n.unstable_now())},be)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ie){ie.callback=null},n.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<ie?Math.floor(1e3/ie):5},n.unstable_getCurrentPriorityLevel=function(){return A},n.unstable_next=function(ie){switch(A){case 1:case 2:case 3:var be=3;break;default:be=A}var Se=A;A=be;try{return ie()}finally{A=Se}},n.unstable_requestPaint=function(){Z=!0},n.unstable_runWithPriority=function(ie,be){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var Se=A;A=ie;try{return be()}finally{A=Se}},n.unstable_scheduleCallback=function(ie,be,Se){var $e=n.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?$e+Se:$e):Se=$e,ie){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=Se+Me,ie={id:E++,callback:be,priorityLevel:ie,startTime:Se,expirationTime:Me,sortIndex:-1},Se>$e?(ie.sortIndex=Se,e(p,ie),t(m)===null&&ie===t(p)&&(z?(ne(D),D=-1):z=!0,Je(he,Se-$e))):(ie.sortIndex=Me,e(m,ie),V||R||(V=!0,Y||(Y=!0,K()))),ie},n.unstable_shouldYield=G,n.unstable_wrapCallback=function(ie){var be=A;return function(){var Se=A;A=be;try{return ie.apply(this,arguments)}finally{A=Se}}}})(d_)),d_}var eE;function N2(){return eE||(eE=1,c_.exports=C2()),c_.exports}var h_={exports:{}},gi={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tE;function R2(){if(tE)return gi;tE=1;var n=Ny();function e(m){var p="https://react.dev/errors/"+m;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var E=2;E<arguments.length;E++)p+="&args[]="+encodeURIComponent(arguments[E])}return"Minified React error #"+m+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(m,p,E){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:S==null?null:""+S,children:m,containerInfo:p,implementation:E}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(m,p){if(m==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return gi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,gi.createPortal=function(m,p){var E=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return a(m,p,null,E)},gi.flushSync=function(m){var p=u.T,E=i.p;try{if(u.T=null,i.p=2,m)return m()}finally{u.T=p,i.p=E,i.d.f()}},gi.preconnect=function(m,p){typeof m=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(m,p))},gi.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},gi.preinit=function(m,p){if(typeof m=="string"&&p&&typeof p.as=="string"){var E=p.as,S=f(E,p.crossOrigin),A=typeof p.integrity=="string"?p.integrity:void 0,R=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;E==="style"?i.d.S(m,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:S,integrity:A,fetchPriority:R}):E==="script"&&i.d.X(m,{crossOrigin:S,integrity:A,fetchPriority:R,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},gi.preinitModule=function(m,p){if(typeof m=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var E=f(p.as,p.crossOrigin);i.d.M(m,{crossOrigin:E,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(m)},gi.preload=function(m,p){if(typeof m=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var E=p.as,S=f(E,p.crossOrigin);i.d.L(m,E,{crossOrigin:S,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},gi.preloadModule=function(m,p){if(typeof m=="string")if(p){var E=f(p.as,p.crossOrigin);i.d.m(m,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:E,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(m)},gi.requestFormReset=function(m){i.d.r(m)},gi.unstable_batchedUpdates=function(m,p){return m(p)},gi.useFormState=function(m,p,E){return u.H.useFormState(m,p,E)},gi.useFormStatus=function(){return u.H.useHostTransitionStatus()},gi.version="19.2.0",gi}var nE;function Bb(){if(nE)return h_.exports;nE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),h_.exports=R2(),h_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iE;function M2(){if(iE)return xd;iE=1;var n=N2(),e=Ny(),t=Bb();function i(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var o=s,c=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(c=o.return),s=o.return;while(s)}return o.tag===3?c:null}function u(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function f(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function m(s){if(a(s)!==s)throw Error(i(188))}function p(s){var o=s.alternate;if(!o){if(o=a(s),o===null)throw Error(i(188));return o!==s?null:s}for(var c=s,h=o;;){var x=c.return;if(x===null)break;var w=x.alternate;if(w===null){if(h=x.return,h!==null){c=h;continue}break}if(x.child===w.child){for(w=x.child;w;){if(w===c)return m(x),s;if(w===h)return m(x),o;w=w.sibling}throw Error(i(188))}if(c.return!==h.return)c=x,h=w;else{for(var N=!1,k=x.child;k;){if(k===c){N=!0,c=x,h=w;break}if(k===h){N=!0,h=x,c=w;break}k=k.sibling}if(!N){for(k=w.child;k;){if(k===c){N=!0,c=w,h=x;break}if(k===h){N=!0,h=w,c=x;break}k=k.sibling}if(!N)throw Error(i(189))}}if(c.alternate!==h)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?s:o}function E(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=E(s),o!==null)return o;s=s.sibling}return null}var S=Object.assign,A=Symbol.for("react.element"),R=Symbol.for("react.transitional.element"),V=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),Z=Symbol.for("react.strict_mode"),X=Symbol.for("react.profiler"),ne=Symbol.for("react.consumer"),Q=Symbol.for("react.context"),pe=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function K(s){return s===null||typeof s!="object"?null:(s=q&&s[q]||s["@@iterator"],typeof s=="function"?s:null)}var F=Symbol.for("react.client.reference");function qe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===F?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case z:return"Fragment";case X:return"Profiler";case Z:return"StrictMode";case he:return"Suspense";case Y:return"SuspenseList";case O:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case V:return"Portal";case Q:return s.displayName||"Context";case ne:return(s._context.displayName||"Context")+".Consumer";case pe:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case D:return o=s.displayName||null,o!==null?o:qe(s.type)||"Memo";case B:o=s._payload,s=s._init;try{return qe(s(o))}catch{}}return null}var Je=Array.isArray,ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,be=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Se={pending:!1,data:null,method:null,action:null},$e=[],Me=-1;function j(s){return{current:s}}function fe(s){0>Me||(s.current=$e[Me],$e[Me]=null,Me--)}function Ie(s,o){Me++,$e[Me]=s.current,s.current=o}var le=j(null),ge=j(null),Ae=j(null),He=j(null);function Ue(s,o){switch(Ie(Ae,o),Ie(ge,s),Ie(le,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?yx(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=yx(o),s=vx(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}fe(le),Ie(le,s)}function we(){fe(le),fe(ge),fe(Ae)}function et(s){s.memoizedState!==null&&Ie(He,s);var o=le.current,c=vx(o,s.type);o!==c&&(Ie(ge,s),Ie(le,c))}function vt(s){ge.current===s&&(fe(le),fe(ge)),He.current===s&&(fe(He),gd._currentValue=Se)}var nt,qt;function _n(s){if(nt===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);nt=o&&o[1]||"",qt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+nt+s+qt}var Vt=!1;function yt(s,o){if(!s||Vt)return"";Vt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(me){var ce=me}Reflect.construct(s,[],Ee)}else{try{Ee.call()}catch(me){ce=me}s.call(Ee.prototype)}}else{try{throw Error()}catch(me){ce=me}(Ee=s())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(me){if(me&&ce&&typeof me.stack=="string")return[me.stack,ce.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=h.DetermineComponentFrameRoot(),N=w[0],k=w[1];if(N&&k){var J=N.split(`
`),ae=k.split(`
`);for(x=h=0;h<J.length&&!J[h].includes("DetermineComponentFrameRoot");)h++;for(;x<ae.length&&!ae[x].includes("DetermineComponentFrameRoot");)x++;if(h===J.length||x===ae.length)for(h=J.length-1,x=ae.length-1;1<=h&&0<=x&&J[h]!==ae[x];)x--;for(;1<=h&&0<=x;h--,x--)if(J[h]!==ae[x]){if(h!==1||x!==1)do if(h--,x--,0>x||J[h]!==ae[x]){var _e=`
`+J[h].replace(" at new "," at ");return s.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",s.displayName)),_e}while(1<=h&&0<=x);break}}}finally{Vt=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?_n(c):""}function St(s,o){switch(s.tag){case 26:case 27:case 5:return _n(s.type);case 16:return _n("Lazy");case 13:return s.child!==o&&o!==null?_n("Suspense Fallback"):_n("Suspense");case 19:return _n("SuspenseList");case 0:case 15:return yt(s.type,!1);case 11:return yt(s.type.render,!1);case 1:return yt(s.type,!0);case 31:return _n("Activity");default:return""}}function kt(s){try{var o="",c=null;do o+=St(s,c),c=s,s=s.return;while(s);return o}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Rt=Object.prototype.hasOwnProperty,ve=n.unstable_scheduleCallback,Ve=n.unstable_cancelCallback,Ye=n.unstable_shouldYield,pt=n.unstable_requestPaint,dt=n.unstable_now,xn=n.unstable_getCurrentPriorityLevel,Si=n.unstable_ImmediatePriority,ki=n.unstable_UserBlockingPriority,an=n.unstable_NormalPriority,ns=n.unstable_LowPriority,fr=n.unstable_IdlePriority,mr=n.log,Fr=n.unstable_setDisableYieldValue,si=null,Ne=null;function lt(s){if(typeof mr=="function"&&Fr(s),Ne&&typeof Ne.setStrictMode=="function")try{Ne.setStrictMode(si,s)}catch{}}var at=Math.clz32?Math.clz32:is,$t=Math.log,ui=Math.LN2;function is(s){return s>>>=0,s===0?32:31-($t(s)/ui|0)|0}var Cn=256,Li=262144,ln=4194304;function bi(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ai(s,o,c){var h=s.pendingLanes;if(h===0)return 0;var x=0,w=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var k=h&134217727;return k!==0?(h=k&~w,h!==0?x=bi(h):(N&=k,N!==0?x=bi(N):c||(c=k&~s,c!==0&&(x=bi(c))))):(k=h&~w,k!==0?x=bi(k):N!==0?x=bi(N):c||(c=h&~s,c!==0&&(x=bi(c)))),x===0?0:o!==0&&o!==x&&(o&w)===0&&(w=x&-x,c=o&-o,w>=c||w===32&&(c&4194048)!==0)?o:x}function qn(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Vc(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eu(){var s=ln;return ln<<=1,(ln&62914560)===0&&(ln=4194304),s}function bs(s){for(var o=[],c=0;31>c;c++)o.push(s);return o}function Hs(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Oc(s,o,c,h,x,w){var N=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var k=s.entanglements,J=s.expirationTimes,ae=s.hiddenUpdates;for(c=N&~c;0<c;){var _e=31-at(c),Ee=1<<_e;k[_e]=0,J[_e]=-1;var ce=ae[_e];if(ce!==null)for(ae[_e]=null,_e=0;_e<ce.length;_e++){var me=ce[_e];me!==null&&(me.lane&=-536870913)}c&=~Ee}h!==0&&qr(s,h,0),w!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=w&~(N&~o))}function qr(s,o,c){s.pendingLanes|=o,s.suspendedLanes&=~o;var h=31-at(o);s.entangledLanes|=o,s.entanglements[h]=s.entanglements[h]|1073741824|c&261930}function Fa(s,o){var c=s.entangledLanes|=o;for(s=s.entanglements;c;){var h=31-at(c),x=1<<h;x&o|s[h]&o&&(s[h]|=o),c&=~x}}function qa(s,o){var c=o&-o;return c=(c&42)!==0?1:Zn(c),(c&(s.suspendedLanes|o))!==0?0:c}function Zn(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Be(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ga(){var s=be.p;return s!==0?s:(s=window.event,s===void 0?32:qx(s.type))}function Vi(s,o){var c=be.p;try{return be.p=s,o()}finally{be.p=c}}var Oi=Math.random().toString(36).slice(2),yn="__reactFiber$"+Oi,En="__reactProps$"+Oi,ss="__reactContainer$"+Oi,rs="__reactEvents$"+Oi,tu="__reactListeners$"+Oi,nu="__reactHandles$"+Oi,iu="__reactResources$"+Oi,As="__reactMarker$"+Oi;function Ro(s){delete s[yn],delete s[En],delete s[rs],delete s[tu],delete s[nu]}function os(s){var o=s[yn];if(o)return o;for(var c=s.parentNode;c;){if(o=c[ss]||c[yn]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(s=Ax(s);s!==null;){if(c=s[yn])return c;s=Ax(s)}return o}s=c,c=s.parentNode}return null}function Ui(s){if(s=s[yn]||s[ss]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function Jn(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(i(33))}function Is(s){var o=s[iu];return o||(o=s[iu]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function wn(s){s[As]=!0}var Ha=new Set,ja={};function Cs(s,o){Bi(s,o),Bi(s+"Capture",o)}function Bi(s,o){for(ja[s]=o,s=0;s<o.length;s++)Ha.add(o[s])}var js=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Mo={},Po={};function pr(s){return Rt.call(Po,s)?!0:Rt.call(Mo,s)?!1:js.test(s)?Po[s]=!0:(Mo[s]=!0,!1)}function gt(s,o,c){if(pr(o))if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+c)}}function Tt(s,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+c)}}function cn(s,o,c,h){if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(o,c,""+h)}}function dn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ii(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Gr(s,o,c){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var x=h.get,w=h.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return x.call(this)},set:function(N){c=""+N,w.call(this,N)}}),Object.defineProperty(s,o,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(N){c=""+N},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Oe(s){if(!s._valueTracker){var o=Ii(s)?"checked":"value";s._valueTracker=Gr(s,o,""+s[o])}}function jt(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var c=o.getValue(),h="";return s&&(h=Ii(s)?s.checked?"true":"false":s.value),s=h,s!==c?(o.setValue(s),!0):!1}function zi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Ns=/[\n"\\]/g;function nn(s){return s.replace(Ns,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Do(s,o,c,h,x,w,N,k){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),o!=null?N==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+dn(o)):s.value!==""+dn(o)&&(s.value=""+dn(o)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),o!=null?as(s,N,dn(o)):c!=null?as(s,N,dn(c)):h!=null&&s.removeAttribute("value"),x==null&&w!=null&&(s.defaultChecked=!!w),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.name=""+dn(k):s.removeAttribute("name")}function Hr(s,o,c,h,x,w,N,k){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.type=w),o!=null||c!=null){if(!(w!=="submit"&&w!=="reset"||o!=null)){Oe(s);return}c=c!=null?""+dn(c):"",o=o!=null?""+dn(o):c,k||o===s.value||(s.value=o),s.defaultValue=o}h=h??x,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=k?s.checked:!!h,s.defaultChecked=!!h,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),Oe(s)}function as(s,o,c){o==="number"&&zi(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Kt(s,o,c,h){if(s=s.options,o){o={};for(var x=0;x<c.length;x++)o["$"+c[x]]=!0;for(c=0;c<s.length;c++)x=o.hasOwnProperty("$"+s[c].value),s[c].selected!==x&&(s[c].selected=x),x&&h&&(s[c].defaultSelected=!0)}else{for(c=""+dn(c),o=null,x=0;x<s.length;x++){if(s[x].value===c){s[x].selected=!0,h&&(s[x].defaultSelected=!0);return}o!==null||s[x].disabled||(o=s[x])}o!==null&&(o.selected=!0)}}function Rs(s,o,c){if(o!=null&&(o=""+dn(o),o!==s.value&&(s.value=o),c==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=c!=null?""+dn(c):""}function Fi(s,o,c,h){if(o==null){if(h!=null){if(c!=null)throw Error(i(92));if(Je(h)){if(1<h.length)throw Error(i(93));h=h[0]}c=h}c==null&&(c=""),o=c}c=dn(o),s.defaultValue=c,h=s.textContent,h===c&&h!==""&&h!==null&&(s.value=h),Oe(s)}function kn(s,o){if(o){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=o;return}}s.textContent=o}var ko=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ks(s,o,c){var h=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":h?s.setProperty(o,c):typeof c!="number"||c===0||ko.has(o)?o==="float"?s.cssFloat=c:s[o]=(""+c).trim():s[o]=c+"px"}function jr(s,o,c){if(o!=null&&typeof o!="object")throw Error(i(62));if(s=s.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var x in o)h=o[x],o.hasOwnProperty(x)&&c[x]!==h&&Ks(s,x,h)}else for(var w in o)o.hasOwnProperty(w)&&Ks(s,w,o[w])}function gr(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ms=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _r(s){return Ms.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ci(){}var Lo=null;function di(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var yr=null,Xe=null;function Yn(s){var o=Ui(s);if(o&&(s=o.stateNode)){var c=s[En]||null;e:switch(s=o.stateNode,o.type){case"input":if(Do(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+nn(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var h=c[o];if(h!==s&&h.form===s.form){var x=h[En]||null;if(!x)throw Error(i(90));Do(h,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(o=0;o<c.length;o++)h=c[o],h.form===s.form&&jt(h)}break e;case"textarea":Rs(s,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&Kt(s,!!c.multiple,o,!1)}}}var Lt=!1;function Zs(s,o,c){if(Lt)return s(o,c);Lt=!0;try{var h=s(o);return h}finally{if(Lt=!1,(yr!==null||Xe!==null)&&(lf(),yr&&(o=yr,s=Xe,Xe=yr=null,Yn(o),s)))for(o=0;o<s.length;o++)Yn(s[o])}}function Ci(s,o){var c=s.stateNode;if(c===null)return null;var h=c[En]||null;if(h===null)return null;c=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(i(231,o,typeof c));return c}var hi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Js=!1;if(hi)try{var bt={};Object.defineProperty(bt,"passive",{get:function(){Js=!0}}),window.addEventListener("test",bt,bt),window.removeEventListener("test",bt,bt)}catch{Js=!1}var qi=null,Ys=null,hn=null;function ls(){if(hn)return hn;var s,o=Ys,c=o.length,h,x="value"in qi?qi.value:qi.textContent,w=x.length;for(s=0;s<c&&o[s]===x[s];s++);var N=c-s;for(h=1;h<=N&&o[c-h]===x[w-h];h++);return hn=x.slice(s,1<h?1-h:void 0)}function vr(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Ps(){return!0}function us(){return!1}function Ln(s){function o(c,h,x,w,N){this._reactName=c,this._targetInst=x,this.type=h,this.nativeEvent=w,this.target=N,this.currentTarget=null;for(var k in s)s.hasOwnProperty(k)&&(c=s[k],this[k]=c?c(w):w[k]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Ps:us,this.isPropagationStopped=us,this}return S(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ps)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ps)},persist:function(){},isPersistent:Ps}),o}var cs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ds=Ln(cs),Ws=S({},cs,{view:0,detail:0}),mt=Ln(Ws),Tr,Wn,fi,Zr=S({},Ws,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==fi&&(fi&&s.type==="mousemove"?(Tr=s.screenX-fi.screenX,Wn=s.screenY-fi.screenY):Wn=Tr=0,fi=s),Tr)},movementY:function(s){return"movementY"in s?s.movementY:Wn}}),Ka=Ln(Zr),Qs=S({},Zr,{dataTransfer:0}),su=Ln(Qs),Za=S({},Ws,{relatedTarget:0}),Jr=Ln(Za),Ja=S({},cs,{animationName:0,elapsedTime:0,pseudoElement:0}),Vo=Ln(Ja),Oo=S({},cs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ni=Ln(Oo),ru=S({},cs,{data:0}),ds=Ln(ru),hs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ya={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Uo(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=Wa[s])?!!o[s]:!1}function xr(){return Uo}var Qn=S({},Ws,{key:function(s){if(s.key){var o=hs[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=vr(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ya[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xr,charCode:function(s){return s.type==="keypress"?vr(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?vr(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Qa=Ln(Qn),ou=S({},Zr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$s=Ln(ou),y=S({},Ws,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xr}),I=Ln(y),M=S({},cs,{propertyName:0,elapsedTime:0,pseudoElement:0}),U=Ln(M),se=S({},Zr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),de=Ln(se),Re=S({},cs,{newState:0,oldState:0}),it=Ln(Re),Mt=[9,13,27,32],Pt=hi&&"CompositionEvent"in window,sn=null;hi&&"documentMode"in document&&(sn=document.documentMode);var Gi=hi&&"TextEvent"in window&&!sn,Hi=hi&&(!Pt||sn&&8<sn&&11>=sn),Ri=" ",fs=!1;function Yr(s,o){switch(s){case"keyup":return Mt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wr(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Bo=!1;function ms(s,o){switch(s){case"compositionend":return Wr(o);case"keypress":return o.which!==32?null:(fs=!0,Ri);case"textInput":return s=o.data,s===Ri&&fs?null:s;default:return null}}function zo(s,o){if(Bo)return s==="compositionend"||!Pt&&Yr(s,o)?(s=ls(),hn=Ys=qi=null,Bo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Hi&&o.locale!=="ko"?null:o.data;default:return null}}var bp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ks(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!bp[s.type]:o==="textarea"}function Sh(s,o,c,h){yr?Xe?Xe.push(h):Xe=[h]:yr=h,o=pf(o,"onChange"),0<o.length&&(c=new Ds("onChange","change",null,c,h),s.push({event:c,listeners:o}))}var Ls=null,$a=null;function Xa(s){hx(s,0)}function el(s){var o=Jn(s);if(jt(o))return s}function tl(s,o){if(s==="change")return o}var bh=!1;if(hi){var Vs;if(hi){var Fo="oninput"in document;if(!Fo){var Ah=document.createElement("div");Ah.setAttribute("oninput","return;"),Fo=typeof Ah.oninput=="function"}Vs=Fo}else Vs=!1;bh=Vs&&(!document.documentMode||9<document.documentMode)}function au(){Ls&&(Ls.detachEvent("onpropertychange",Ih),$a=Ls=null)}function Ih(s){if(s.propertyName==="value"&&el($a)){var o=[];Sh(o,$a,s,di(s)),Zs(Xa,o)}}function Xs(s,o,c){s==="focusin"?(au(),Ls=o,$a=c,Ls.attachEvent("onpropertychange",Ih)):s==="focusout"&&au()}function Ap(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return el($a)}function qo(s,o){if(s==="click")return el(o)}function Ip(s,o){if(s==="input"||s==="change")return el(o)}function er(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var $n=typeof Object.is=="function"?Object.is:er;function Go(s,o){if($n(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var c=Object.keys(s),h=Object.keys(o);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var x=c[h];if(!Rt.call(o,x)||!$n(s[x],o[x]))return!1}return!0}function lu(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function nl(s,o){var c=lu(s);s=0;for(var h;c;){if(c.nodeType===3){if(h=s+c.textContent.length,s<=o&&h>=o)return{node:c,offset:o-s};s=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=lu(c)}}function uu(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?uu(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function il(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=zi(s.document);o instanceof s.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)s=o.contentWindow;else break;o=zi(s.document)}return o}function Er(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var cu=hi&&"documentMode"in document&&11>=document.documentMode,wr=null,du=null,sl=null,Ho=!1;function Ch(s,o,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Ho||wr==null||wr!==zi(h)||(h=wr,"selectionStart"in h&&Er(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),sl&&Go(sl,h)||(sl=h,h=pf(du,"onSelect"),0<h.length&&(o=new Ds("onSelect","select",null,o,c),s.push({event:o,listeners:h}),o.target=wr)))}function Sr(s,o){var c={};return c[s.toLowerCase()]=o.toLowerCase(),c["Webkit"+s]="webkit"+o,c["Moz"+s]="moz"+o,c}var jo={animationend:Sr("Animation","AnimationEnd"),animationiteration:Sr("Animation","AnimationIteration"),animationstart:Sr("Animation","AnimationStart"),transitionrun:Sr("Transition","TransitionRun"),transitionstart:Sr("Transition","TransitionStart"),transitioncancel:Sr("Transition","TransitionCancel"),transitionend:Sr("Transition","TransitionEnd")},hu={},Nh={};hi&&(Nh=document.createElement("div").style,"AnimationEvent"in window||(delete jo.animationend.animation,delete jo.animationiteration.animation,delete jo.animationstart.animation),"TransitionEvent"in window||delete jo.transitionend.transition);function Xn(s){if(hu[s])return hu[s];if(!jo[s])return s;var o=jo[s],c;for(c in o)if(o.hasOwnProperty(c)&&c in Nh)return hu[s]=o[c];return s}var rl=Xn("animationend"),Rh=Xn("animationiteration"),ol=Xn("animationstart"),Cp=Xn("transitionrun"),Mh=Xn("transitionstart"),Np=Xn("transitioncancel"),Ko=Xn("transitionend"),Ph=new Map,br="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");br.push("scrollEnd");function ji(s,o){Ph.set(s,o),Cs(o,[s])}var al=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ki=[],mi=0,fu=0;function ll(){for(var s=mi,o=fu=mi=0;o<s;){var c=Ki[o];Ki[o++]=null;var h=Ki[o];Ki[o++]=null;var x=Ki[o];Ki[o++]=null;var w=Ki[o];if(Ki[o++]=null,h!==null&&x!==null){var N=h.pending;N===null?x.next=x:(x.next=N.next,N.next=x),h.pending=x}w!==0&&Zo(c,x,w)}}function Ar(s,o,c,h){Ki[mi++]=s,Ki[mi++]=o,Ki[mi++]=c,Ki[mi++]=h,fu|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Uc(s,o,c,h){return Ar(s,o,c,h),ul(s)}function Os(s,o){return Ar(s,null,null,o),ul(s)}function Zo(s,o,c){s.lanes|=c;var h=s.alternate;h!==null&&(h.lanes|=c);for(var x=!1,w=s.return;w!==null;)w.childLanes|=c,h=w.alternate,h!==null&&(h.childLanes|=c),w.tag===22&&(s=w.stateNode,s===null||s._visibility&1||(x=!0)),s=w,w=w.return;return s.tag===3?(w=s.stateNode,x&&o!==null&&(x=31-at(c),s=w.hiddenUpdates,h=s[x],h===null?s[x]=[o]:h.push(o),o.lane=c|536870912),w):null}function ul(s){if(50<ud)throw ud=0,Mg=null,Error(i(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var Qr={};function Rp(s,o,c,h){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pi(s,o,c,h){return new Rp(s,o,c,h)}function mu(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Us(s,o){var c=s.alternate;return c===null?(c=pi(s.tag,o,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=o,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,o=s.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function Bc(s,o){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,o=c.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function cl(s,o,c,h,x,w){var N=0;if(h=s,typeof s=="function")mu(s)&&(N=1);else if(typeof s=="string")N=f2(s,c,le.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case O:return s=pi(31,c,o,x),s.elementType=O,s.lanes=w,s;case z:return $r(c.children,x,w,o);case Z:N=8,x|=24;break;case X:return s=pi(12,c,o,x|2),s.elementType=X,s.lanes=w,s;case he:return s=pi(13,c,o,x),s.elementType=he,s.lanes=w,s;case Y:return s=pi(19,c,o,x),s.elementType=Y,s.lanes=w,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Q:N=10;break e;case ne:N=9;break e;case pe:N=11;break e;case D:N=14;break e;case B:N=16,h=null;break e}N=29,c=Error(i(130,s===null?"null":typeof s,"")),h=null}return o=pi(N,c,o,x),o.elementType=s,o.type=h,o.lanes=w,o}function $r(s,o,c,h){return s=pi(7,s,h,o),s.lanes=c,s}function pu(s,o,c){return s=pi(6,s,null,o),s.lanes=c,s}function zc(s){var o=pi(18,null,null,0);return o.stateNode=s,o}function Fc(s,o,c){return o=pi(4,s.children!==null?s.children:[],s.key,o),o.lanes=c,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var l=new WeakMap;function d(s,o){if(typeof s=="object"&&s!==null){var c=l.get(s);return c!==void 0?c:(o={value:s,source:o,stack:kt(o)},l.set(s,o),o)}return{value:s,source:o,stack:kt(o)}}var T=[],b=0,C=null,P=0,H=[],te=0,ue=null,xe=1,De="";function Ke(s,o){T[b++]=P,T[b++]=C,C=s,P=o}function ht(s,o,c){H[te++]=xe,H[te++]=De,H[te++]=ue,ue=s;var h=xe;s=De;var x=32-at(h)-1;h&=~(1<<x),c+=1;var w=32-at(o)+x;if(30<w){var N=x-x%5;w=(h&(1<<N)-1).toString(32),h>>=N,x-=N,xe=1<<32-at(o)+x|c<<x|h,De=w+s}else xe=1<<w|c<<x|h,De=s}function Gn(s){s.return!==null&&(Ke(s,1),ht(s,1,0))}function Sn(s){for(;s===C;)C=T[--b],T[b]=null,P=T[--b],T[b]=null;for(;s===ue;)ue=H[--te],H[te]=null,De=H[--te],H[te]=null,xe=H[--te],H[te]=null}function Mi(s,o){H[te++]=xe,H[te++]=De,H[te++]=ue,xe=o.id,De=o.overflow,ue=s}var Ot=null,Ut=null,xt=!1,Ir=null,Zi=!1,gu=Error(i(519));function Cr(s){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw dl(d(o,s)),gu}function qc(s){var o=s.stateNode,c=s.type,h=s.memoizedProps;switch(o[yn]=s,o[En]=h,c){case"dialog":wt("cancel",o),wt("close",o);break;case"iframe":case"object":case"embed":wt("load",o);break;case"video":case"audio":for(c=0;c<dd.length;c++)wt(dd[c],o);break;case"source":wt("error",o);break;case"img":case"image":case"link":wt("error",o),wt("load",o);break;case"details":wt("toggle",o);break;case"input":wt("invalid",o),Hr(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":wt("invalid",o);break;case"textarea":wt("invalid",o),Fi(o,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||h.suppressHydrationWarning===!0||gx(o.textContent,c)?(h.popover!=null&&(wt("beforetoggle",o),wt("toggle",o)),h.onScroll!=null&&wt("scroll",o),h.onScrollEnd!=null&&wt("scrollend",o),h.onClick!=null&&(o.onclick=ci),o=!0):o=!1,o||Cr(s,!0)}function vn(s){for(Ot=s.return;Ot;)switch(Ot.tag){case 5:case 31:case 13:Zi=!1;return;case 27:case 3:Zi=!0;return;default:Ot=Ot.return}}function tr(s){if(s!==Ot)return!1;if(!xt)return vn(s),xt=!0,!1;var o=s.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||Kg(s.type,s.memoizedProps)),c=!c),c&&Ut&&Cr(s),vn(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Ut=bx(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Ut=bx(s)}else o===27?(o=Ut,aa(s.type)?(s=Qg,Qg=null,Ut=s):Ut=o):Ut=Ot?zs(s.stateNode.nextSibling):null;return!0}function Xr(){Ut=Ot=null,xt=!1}function Gc(){var s=Ir;return s!==null&&(Qi===null?Qi=s:Qi.push.apply(Qi,s),Ir=null),s}function dl(s){Ir===null?Ir=[s]:Ir.push(s)}var hl=j(null),Nr=null,nr=null;function Jo(s,o,c){Ie(hl,o._currentValue),o._currentValue=c}function eo(s){s._currentValue=hl.current,fe(hl)}function Mp(s,o,c){for(;s!==null;){var h=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),s===c)break;s=s.return}}function Pp(s,o,c,h){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var w=x.dependencies;if(w!==null){var N=x.child;w=w.firstContext;e:for(;w!==null;){var k=w;w=x;for(var J=0;J<o.length;J++)if(k.context===o[J]){w.lanes|=c,k=w.alternate,k!==null&&(k.lanes|=c),Mp(w.return,c,s),h||(N=null);break e}w=k.next}}else if(x.tag===18){if(N=x.return,N===null)throw Error(i(341));N.lanes|=c,w=N.alternate,w!==null&&(w.lanes|=c),Mp(N,c,s),N=null}else N=x.child;if(N!==null)N.return=x;else for(N=x;N!==null;){if(N===s){N=null;break}if(x=N.sibling,x!==null){x.return=N.return,N=x;break}N=N.return}x=N}}function _u(s,o,c,h){s=null;for(var x=o,w=!1;x!==null;){if(!w){if((x.flags&524288)!==0)w=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var N=x.alternate;if(N===null)throw Error(i(387));if(N=N.memoizedProps,N!==null){var k=x.type;$n(x.pendingProps.value,N.value)||(s!==null?s.push(k):s=[k])}}else if(x===He.current){if(N=x.alternate,N===null)throw Error(i(387));N.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(gd):s=[gd])}x=x.return}s!==null&&Pp(o,s,c,h),o.flags|=262144}function Dh(s){for(s=s.firstContext;s!==null;){if(!$n(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function fl(s){Nr=s,nr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ri(s){return t0(Nr,s)}function kh(s,o){return Nr===null&&fl(s),t0(s,o)}function t0(s,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},nr===null){if(s===null)throw Error(i(308));nr=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else nr=nr.next=o;return c}var uN=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(c,h){s.push(h)}};this.abort=function(){o.aborted=!0,s.forEach(function(c){return c()})}},cN=n.unstable_scheduleCallback,dN=n.unstable_NormalPriority,Vn={$$typeof:Q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Dp(){return{controller:new uN,data:new Map,refCount:0}}function Hc(s){s.refCount--,s.refCount===0&&cN(dN,function(){s.controller.abort()})}var jc=null,kp=0,yu=0,vu=null;function hN(s,o){if(jc===null){var c=jc=[];kp=0,yu=Og(),vu={status:"pending",value:void 0,then:function(h){c.push(h)}}}return kp++,o.then(n0,n0),o}function n0(){if(--kp===0&&jc!==null){vu!==null&&(vu.status="fulfilled");var s=jc;jc=null,yu=0,vu=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function fN(s,o){var c=[],h={status:"pending",value:null,reason:null,then:function(x){c.push(x)}};return s.then(function(){h.status="fulfilled",h.value=o;for(var x=0;x<c.length;x++)(0,c[x])(o)},function(x){for(h.status="rejected",h.reason=x,x=0;x<c.length;x++)(0,c[x])(void 0)}),h}var i0=ie.S;ie.S=function(s,o){zT=dt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&hN(s,o),i0!==null&&i0(s,o)};var ml=j(null);function Lp(){var s=ml.current;return s!==null?s:rn.pooledCache}function Lh(s,o){o===null?Ie(ml,ml.current):Ie(ml,o.pool)}function s0(){var s=Lp();return s===null?null:{parent:Vn._currentValue,pool:s}}var Tu=Error(i(460)),Vp=Error(i(474)),Vh=Error(i(542)),Oh={then:function(){}};function r0(s){return s=s.status,s==="fulfilled"||s==="rejected"}function o0(s,o,c){switch(c=s[c],c===void 0?s.push(o):c!==o&&(o.then(ci,ci),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,l0(s),s;default:if(typeof o.status=="string")o.then(ci,ci);else{if(s=rn,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=o,s.status="pending",s.then(function(h){if(o.status==="pending"){var x=o;x.status="fulfilled",x.value=h}},function(h){if(o.status==="pending"){var x=o;x.status="rejected",x.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,l0(s),s}throw gl=o,Tu}}function pl(s){try{var o=s._init;return o(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(gl=c,Tu):c}}var gl=null;function a0(){if(gl===null)throw Error(i(459));var s=gl;return gl=null,s}function l0(s){if(s===Tu||s===Vh)throw Error(i(483))}var xu=null,Kc=0;function Uh(s){var o=Kc;return Kc+=1,xu===null&&(xu=[]),o0(xu,s,o)}function Zc(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function Bh(s,o){throw o.$$typeof===A?Error(i(525)):(s=Object.prototype.toString.call(o),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function u0(s){function o(ee,$){if(s){var oe=ee.deletions;oe===null?(ee.deletions=[$],ee.flags|=16):oe.push($)}}function c(ee,$){if(!s)return null;for(;$!==null;)o(ee,$),$=$.sibling;return null}function h(ee){for(var $=new Map;ee!==null;)ee.key!==null?$.set(ee.key,ee):$.set(ee.index,ee),ee=ee.sibling;return $}function x(ee,$){return ee=Us(ee,$),ee.index=0,ee.sibling=null,ee}function w(ee,$,oe){return ee.index=oe,s?(oe=ee.alternate,oe!==null?(oe=oe.index,oe<$?(ee.flags|=67108866,$):oe):(ee.flags|=67108866,$)):(ee.flags|=1048576,$)}function N(ee){return s&&ee.alternate===null&&(ee.flags|=67108866),ee}function k(ee,$,oe,Te){return $===null||$.tag!==6?($=pu(oe,ee.mode,Te),$.return=ee,$):($=x($,oe),$.return=ee,$)}function J(ee,$,oe,Te){var We=oe.type;return We===z?_e(ee,$,oe.props.children,Te,oe.key):$!==null&&($.elementType===We||typeof We=="object"&&We!==null&&We.$$typeof===B&&pl(We)===$.type)?($=x($,oe.props),Zc($,oe),$.return=ee,$):($=cl(oe.type,oe.key,oe.props,null,ee.mode,Te),Zc($,oe),$.return=ee,$)}function ae(ee,$,oe,Te){return $===null||$.tag!==4||$.stateNode.containerInfo!==oe.containerInfo||$.stateNode.implementation!==oe.implementation?($=Fc(oe,ee.mode,Te),$.return=ee,$):($=x($,oe.children||[]),$.return=ee,$)}function _e(ee,$,oe,Te,We){return $===null||$.tag!==7?($=$r(oe,ee.mode,Te,We),$.return=ee,$):($=x($,oe),$.return=ee,$)}function Ee(ee,$,oe){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=pu(""+$,ee.mode,oe),$.return=ee,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case R:return oe=cl($.type,$.key,$.props,null,ee.mode,oe),Zc(oe,$),oe.return=ee,oe;case V:return $=Fc($,ee.mode,oe),$.return=ee,$;case B:return $=pl($),Ee(ee,$,oe)}if(Je($)||K($))return $=$r($,ee.mode,oe,null),$.return=ee,$;if(typeof $.then=="function")return Ee(ee,Uh($),oe);if($.$$typeof===Q)return Ee(ee,kh(ee,$),oe);Bh(ee,$)}return null}function ce(ee,$,oe,Te){var We=$!==null?$.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return We!==null?null:k(ee,$,""+oe,Te);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case R:return oe.key===We?J(ee,$,oe,Te):null;case V:return oe.key===We?ae(ee,$,oe,Te):null;case B:return oe=pl(oe),ce(ee,$,oe,Te)}if(Je(oe)||K(oe))return We!==null?null:_e(ee,$,oe,Te,null);if(typeof oe.then=="function")return ce(ee,$,Uh(oe),Te);if(oe.$$typeof===Q)return ce(ee,$,kh(ee,oe),Te);Bh(ee,oe)}return null}function me(ee,$,oe,Te,We){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return ee=ee.get(oe)||null,k($,ee,""+Te,We);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case R:return ee=ee.get(Te.key===null?oe:Te.key)||null,J($,ee,Te,We);case V:return ee=ee.get(Te.key===null?oe:Te.key)||null,ae($,ee,Te,We);case B:return Te=pl(Te),me(ee,$,oe,Te,We)}if(Je(Te)||K(Te))return ee=ee.get(oe)||null,_e($,ee,Te,We,null);if(typeof Te.then=="function")return me(ee,$,oe,Uh(Te),We);if(Te.$$typeof===Q)return me(ee,$,oe,kh($,Te),We);Bh($,Te)}return null}function Fe(ee,$,oe,Te){for(var We=null,Bt=null,je=$,ft=$=0,It=null;je!==null&&ft<oe.length;ft++){je.index>ft?(It=je,je=null):It=je.sibling;var zt=ce(ee,je,oe[ft],Te);if(zt===null){je===null&&(je=It);break}s&&je&&zt.alternate===null&&o(ee,je),$=w(zt,$,ft),Bt===null?We=zt:Bt.sibling=zt,Bt=zt,je=It}if(ft===oe.length)return c(ee,je),xt&&Ke(ee,ft),We;if(je===null){for(;ft<oe.length;ft++)je=Ee(ee,oe[ft],Te),je!==null&&($=w(je,$,ft),Bt===null?We=je:Bt.sibling=je,Bt=je);return xt&&Ke(ee,ft),We}for(je=h(je);ft<oe.length;ft++)It=me(je,ee,ft,oe[ft],Te),It!==null&&(s&&It.alternate!==null&&je.delete(It.key===null?ft:It.key),$=w(It,$,ft),Bt===null?We=It:Bt.sibling=It,Bt=It);return s&&je.forEach(function(ha){return o(ee,ha)}),xt&&Ke(ee,ft),We}function tt(ee,$,oe,Te){if(oe==null)throw Error(i(151));for(var We=null,Bt=null,je=$,ft=$=0,It=null,zt=oe.next();je!==null&&!zt.done;ft++,zt=oe.next()){je.index>ft?(It=je,je=null):It=je.sibling;var ha=ce(ee,je,zt.value,Te);if(ha===null){je===null&&(je=It);break}s&&je&&ha.alternate===null&&o(ee,je),$=w(ha,$,ft),Bt===null?We=ha:Bt.sibling=ha,Bt=ha,je=It}if(zt.done)return c(ee,je),xt&&Ke(ee,ft),We;if(je===null){for(;!zt.done;ft++,zt=oe.next())zt=Ee(ee,zt.value,Te),zt!==null&&($=w(zt,$,ft),Bt===null?We=zt:Bt.sibling=zt,Bt=zt);return xt&&Ke(ee,ft),We}for(je=h(je);!zt.done;ft++,zt=oe.next())zt=me(je,ee,ft,zt.value,Te),zt!==null&&(s&&zt.alternate!==null&&je.delete(zt.key===null?ft:zt.key),$=w(zt,$,ft),Bt===null?We=zt:Bt.sibling=zt,Bt=zt);return s&&je.forEach(function(S2){return o(ee,S2)}),xt&&Ke(ee,ft),We}function tn(ee,$,oe,Te){if(typeof oe=="object"&&oe!==null&&oe.type===z&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case R:e:{for(var We=oe.key;$!==null;){if($.key===We){if(We=oe.type,We===z){if($.tag===7){c(ee,$.sibling),Te=x($,oe.props.children),Te.return=ee,ee=Te;break e}}else if($.elementType===We||typeof We=="object"&&We!==null&&We.$$typeof===B&&pl(We)===$.type){c(ee,$.sibling),Te=x($,oe.props),Zc(Te,oe),Te.return=ee,ee=Te;break e}c(ee,$);break}else o(ee,$);$=$.sibling}oe.type===z?(Te=$r(oe.props.children,ee.mode,Te,oe.key),Te.return=ee,ee=Te):(Te=cl(oe.type,oe.key,oe.props,null,ee.mode,Te),Zc(Te,oe),Te.return=ee,ee=Te)}return N(ee);case V:e:{for(We=oe.key;$!==null;){if($.key===We)if($.tag===4&&$.stateNode.containerInfo===oe.containerInfo&&$.stateNode.implementation===oe.implementation){c(ee,$.sibling),Te=x($,oe.children||[]),Te.return=ee,ee=Te;break e}else{c(ee,$);break}else o(ee,$);$=$.sibling}Te=Fc(oe,ee.mode,Te),Te.return=ee,ee=Te}return N(ee);case B:return oe=pl(oe),tn(ee,$,oe,Te)}if(Je(oe))return Fe(ee,$,oe,Te);if(K(oe)){if(We=K(oe),typeof We!="function")throw Error(i(150));return oe=We.call(oe),tt(ee,$,oe,Te)}if(typeof oe.then=="function")return tn(ee,$,Uh(oe),Te);if(oe.$$typeof===Q)return tn(ee,$,kh(ee,oe),Te);Bh(ee,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,$!==null&&$.tag===6?(c(ee,$.sibling),Te=x($,oe),Te.return=ee,ee=Te):(c(ee,$),Te=pu(oe,ee.mode,Te),Te.return=ee,ee=Te),N(ee)):c(ee,$)}return function(ee,$,oe,Te){try{Kc=0;var We=tn(ee,$,oe,Te);return xu=null,We}catch(je){if(je===Tu||je===Vh)throw je;var Bt=pi(29,je,null,ee.mode);return Bt.lanes=Te,Bt.return=ee,Bt}finally{}}}var _l=u0(!0),c0=u0(!1),Yo=!1;function Op(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Up(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Wo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Qo(s,o,c){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Gt&2)!==0){var x=h.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),h.pending=o,o=ul(s),Zo(s,null,c),o}return Ar(s,h,o,c),ul(s)}function Jc(s,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var h=o.lanes;h&=s.pendingLanes,c|=h,o.lanes=c,Fa(s,c)}}function Bp(s,o){var c=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var x=null,w=null;if(c=c.firstBaseUpdate,c!==null){do{var N={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};w===null?x=w=N:w=w.next=N,c=c.next}while(c!==null);w===null?x=w=o:w=w.next=o}else x=w=o;c={baseState:h.baseState,firstBaseUpdate:x,lastBaseUpdate:w,shared:h.shared,callbacks:h.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=o:s.next=o,c.lastBaseUpdate=o}var zp=!1;function Yc(){if(zp){var s=vu;if(s!==null)throw s}}function Wc(s,o,c,h){zp=!1;var x=s.updateQueue;Yo=!1;var w=x.firstBaseUpdate,N=x.lastBaseUpdate,k=x.shared.pending;if(k!==null){x.shared.pending=null;var J=k,ae=J.next;J.next=null,N===null?w=ae:N.next=ae,N=J;var _e=s.alternate;_e!==null&&(_e=_e.updateQueue,k=_e.lastBaseUpdate,k!==N&&(k===null?_e.firstBaseUpdate=ae:k.next=ae,_e.lastBaseUpdate=J))}if(w!==null){var Ee=x.baseState;N=0,_e=ae=J=null,k=w;do{var ce=k.lane&-536870913,me=ce!==k.lane;if(me?(At&ce)===ce:(h&ce)===ce){ce!==0&&ce===yu&&(zp=!0),_e!==null&&(_e=_e.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Fe=s,tt=k;ce=o;var tn=c;switch(tt.tag){case 1:if(Fe=tt.payload,typeof Fe=="function"){Ee=Fe.call(tn,Ee,ce);break e}Ee=Fe;break e;case 3:Fe.flags=Fe.flags&-65537|128;case 0:if(Fe=tt.payload,ce=typeof Fe=="function"?Fe.call(tn,Ee,ce):Fe,ce==null)break e;Ee=S({},Ee,ce);break e;case 2:Yo=!0}}ce=k.callback,ce!==null&&(s.flags|=64,me&&(s.flags|=8192),me=x.callbacks,me===null?x.callbacks=[ce]:me.push(ce))}else me={lane:ce,tag:k.tag,payload:k.payload,callback:k.callback,next:null},_e===null?(ae=_e=me,J=Ee):_e=_e.next=me,N|=ce;if(k=k.next,k===null){if(k=x.shared.pending,k===null)break;me=k,k=me.next,me.next=null,x.lastBaseUpdate=me,x.shared.pending=null}}while(!0);_e===null&&(J=Ee),x.baseState=J,x.firstBaseUpdate=ae,x.lastBaseUpdate=_e,w===null&&(x.shared.lanes=0),na|=N,s.lanes=N,s.memoizedState=Ee}}function d0(s,o){if(typeof s!="function")throw Error(i(191,s));s.call(o)}function h0(s,o){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)d0(c[s],o)}var Eu=j(null),zh=j(0);function f0(s,o){s=uo,Ie(zh,s),Ie(Eu,o),uo=s|o.baseLanes}function Fp(){Ie(zh,uo),Ie(Eu,Eu.current)}function qp(){uo=zh.current,fe(Eu),fe(zh)}var ps=j(null),Bs=null;function $o(s){var o=s.alternate;Ie(Nn,Nn.current&1),Ie(ps,s),Bs===null&&(o===null||Eu.current!==null||o.memoizedState!==null)&&(Bs=s)}function Gp(s){Ie(Nn,Nn.current),Ie(ps,s),Bs===null&&(Bs=s)}function m0(s){s.tag===22?(Ie(Nn,Nn.current),Ie(ps,s),Bs===null&&(Bs=s)):Xo()}function Xo(){Ie(Nn,Nn.current),Ie(ps,ps.current)}function gs(s){fe(ps),Bs===s&&(Bs=null),fe(Nn)}var Nn=j(0);function Fh(s){for(var o=s;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Yg(c)||Wg(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var to=0,ct=null,Xt=null,On=null,qh=!1,wu=!1,yl=!1,Gh=0,Qc=0,Su=null,mN=0;function bn(){throw Error(i(321))}function Hp(s,o){if(o===null)return!1;for(var c=0;c<o.length&&c<s.length;c++)if(!$n(s[c],o[c]))return!1;return!0}function jp(s,o,c,h,x,w){return to=w,ct=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ie.H=s===null||s.memoizedState===null?Q0:og,yl=!1,w=c(h,x),yl=!1,wu&&(w=g0(o,c,h,x)),p0(s),w}function p0(s){ie.H=ed;var o=Xt!==null&&Xt.next!==null;if(to=0,On=Xt=ct=null,qh=!1,Qc=0,Su=null,o)throw Error(i(300));s===null||Un||(s=s.dependencies,s!==null&&Dh(s)&&(Un=!0))}function g0(s,o,c,h){ct=s;var x=0;do{if(wu&&(Su=null),Qc=0,wu=!1,25<=x)throw Error(i(301));if(x+=1,On=Xt=null,s.updateQueue!=null){var w=s.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}ie.H=$0,w=o(c,h)}while(wu);return w}function pN(){var s=ie.H,o=s.useState()[0];return o=typeof o.then=="function"?$c(o):o,s=s.useState()[0],(Xt!==null?Xt.memoizedState:null)!==s&&(ct.flags|=1024),o}function Kp(){var s=Gh!==0;return Gh=0,s}function Zp(s,o,c){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~c}function Jp(s){if(qh){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}qh=!1}to=0,On=Xt=ct=null,wu=!1,Qc=Gh=0,Su=null}function Pi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return On===null?ct.memoizedState=On=s:On=On.next=s,On}function Rn(){if(Xt===null){var s=ct.alternate;s=s!==null?s.memoizedState:null}else s=Xt.next;var o=On===null?ct.memoizedState:On.next;if(o!==null)On=o,Xt=s;else{if(s===null)throw ct.alternate===null?Error(i(467)):Error(i(310));Xt=s,s={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},On===null?ct.memoizedState=On=s:On=On.next=s}return On}function Hh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $c(s){var o=Qc;return Qc+=1,Su===null&&(Su=[]),s=o0(Su,s,o),o=ct,(On===null?o.memoizedState:On.next)===null&&(o=o.alternate,ie.H=o===null||o.memoizedState===null?Q0:og),s}function jh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return $c(s);if(s.$$typeof===Q)return ri(s)}throw Error(i(438,String(s)))}function Yp(s){var o=null,c=ct.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var h=ct.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(x){return x.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=Hh(),ct.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(s),h=0;h<s;h++)c[h]=G;return o.index++,c}function no(s,o){return typeof o=="function"?o(s):o}function Kh(s){var o=Rn();return Wp(o,Xt,s)}function Wp(s,o,c){var h=s.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=c;var x=s.baseQueue,w=h.pending;if(w!==null){if(x!==null){var N=x.next;x.next=w.next,w.next=N}o.baseQueue=x=w,h.pending=null}if(w=s.baseState,x===null)s.memoizedState=w;else{o=x.next;var k=N=null,J=null,ae=o,_e=!1;do{var Ee=ae.lane&-536870913;if(Ee!==ae.lane?(At&Ee)===Ee:(to&Ee)===Ee){var ce=ae.revertLane;if(ce===0)J!==null&&(J=J.next={lane:0,revertLane:0,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),Ee===yu&&(_e=!0);else if((to&ce)===ce){ae=ae.next,ce===yu&&(_e=!0);continue}else Ee={lane:0,revertLane:ae.revertLane,gesture:null,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},J===null?(k=J=Ee,N=w):J=J.next=Ee,ct.lanes|=ce,na|=ce;Ee=ae.action,yl&&c(w,Ee),w=ae.hasEagerState?ae.eagerState:c(w,Ee)}else ce={lane:Ee,revertLane:ae.revertLane,gesture:ae.gesture,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null},J===null?(k=J=ce,N=w):J=J.next=ce,ct.lanes|=Ee,na|=Ee;ae=ae.next}while(ae!==null&&ae!==o);if(J===null?N=w:J.next=k,!$n(w,s.memoizedState)&&(Un=!0,_e&&(c=vu,c!==null)))throw c;s.memoizedState=w,s.baseState=N,s.baseQueue=J,h.lastRenderedState=w}return x===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function Qp(s){var o=Rn(),c=o.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=s;var h=c.dispatch,x=c.pending,w=o.memoizedState;if(x!==null){c.pending=null;var N=x=x.next;do w=s(w,N.action),N=N.next;while(N!==x);$n(w,o.memoizedState)||(Un=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),c.lastRenderedState=w}return[w,h]}function _0(s,o,c){var h=ct,x=Rn(),w=xt;if(w){if(c===void 0)throw Error(i(407));c=c()}else c=o();var N=!$n((Xt||x).memoizedState,c);if(N&&(x.memoizedState=c,Un=!0),x=x.queue,eg(T0.bind(null,h,x,s),[s]),x.getSnapshot!==o||N||On!==null&&On.memoizedState.tag&1){if(h.flags|=2048,bu(9,{destroy:void 0},v0.bind(null,h,x,c,o),null),rn===null)throw Error(i(349));w||(to&127)!==0||y0(h,o,c)}return c}function y0(s,o,c){s.flags|=16384,s={getSnapshot:o,value:c},o=ct.updateQueue,o===null?(o=Hh(),ct.updateQueue=o,o.stores=[s]):(c=o.stores,c===null?o.stores=[s]:c.push(s))}function v0(s,o,c,h){o.value=c,o.getSnapshot=h,x0(o)&&E0(s)}function T0(s,o,c){return c(function(){x0(o)&&E0(s)})}function x0(s){var o=s.getSnapshot;s=s.value;try{var c=o();return!$n(s,c)}catch{return!0}}function E0(s){var o=Os(s,2);o!==null&&$i(o,s,2)}function $p(s){var o=Pi();if(typeof s=="function"){var c=s;if(s=c(),yl){lt(!0);try{c()}finally{lt(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:no,lastRenderedState:s},o}function w0(s,o,c,h){return s.baseState=c,Wp(s,Xt,typeof h=="function"?h:no)}function gN(s,o,c,h,x){if(Yh(s))throw Error(i(485));if(s=o.action,s!==null){var w={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){w.listeners.push(N)}};ie.T!==null?c(!0):w.isTransition=!1,h(w),c=o.pending,c===null?(w.next=o.pending=w,S0(o,w)):(w.next=c.next,o.pending=c.next=w)}}function S0(s,o){var c=o.action,h=o.payload,x=s.state;if(o.isTransition){var w=ie.T,N={};ie.T=N;try{var k=c(x,h),J=ie.S;J!==null&&J(N,k),b0(s,o,k)}catch(ae){Xp(s,o,ae)}finally{w!==null&&N.types!==null&&(w.types=N.types),ie.T=w}}else try{w=c(x,h),b0(s,o,w)}catch(ae){Xp(s,o,ae)}}function b0(s,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){A0(s,o,h)},function(h){return Xp(s,o,h)}):A0(s,o,c)}function A0(s,o,c){o.status="fulfilled",o.value=c,I0(o),s.state=c,o=s.pending,o!==null&&(c=o.next,c===o?s.pending=null:(c=c.next,o.next=c,S0(s,c)))}function Xp(s,o,c){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=c,I0(o),o=o.next;while(o!==h)}s.action=null}function I0(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function C0(s,o){return o}function N0(s,o){if(xt){var c=rn.formState;if(c!==null){e:{var h=ct;if(xt){if(Ut){t:{for(var x=Ut,w=Zi;x.nodeType!==8;){if(!w){x=null;break t}if(x=zs(x.nextSibling),x===null){x=null;break t}}w=x.data,x=w==="F!"||w==="F"?x:null}if(x){Ut=zs(x.nextSibling),h=x.data==="F!";break e}}Cr(h)}h=!1}h&&(o=c[0])}}return c=Pi(),c.memoizedState=c.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:C0,lastRenderedState:o},c.queue=h,c=J0.bind(null,ct,h),h.dispatch=c,h=$p(!1),w=rg.bind(null,ct,!1,h.queue),h=Pi(),x={state:o,dispatch:null,action:s,pending:null},h.queue=x,c=gN.bind(null,ct,x,w,c),x.dispatch=c,h.memoizedState=s,[o,c,!1]}function R0(s){var o=Rn();return M0(o,Xt,s)}function M0(s,o,c){if(o=Wp(s,o,C0)[0],s=Kh(no)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=$c(o)}catch(N){throw N===Tu?Vh:N}else h=o;o=Rn();var x=o.queue,w=x.dispatch;return c!==o.memoizedState&&(ct.flags|=2048,bu(9,{destroy:void 0},_N.bind(null,x,c),null)),[h,w,s]}function _N(s,o){s.action=o}function P0(s){var o=Rn(),c=Xt;if(c!==null)return M0(o,c,s);Rn(),o=o.memoizedState,c=Rn();var h=c.queue.dispatch;return c.memoizedState=s,[o,h,!1]}function bu(s,o,c,h){return s={tag:s,create:c,deps:h,inst:o,next:null},o=ct.updateQueue,o===null&&(o=Hh(),ct.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=s.next=s:(h=c.next,c.next=s,s.next=h,o.lastEffect=s),s}function D0(){return Rn().memoizedState}function Zh(s,o,c,h){var x=Pi();ct.flags|=s,x.memoizedState=bu(1|o,{destroy:void 0},c,h===void 0?null:h)}function Jh(s,o,c,h){var x=Rn();h=h===void 0?null:h;var w=x.memoizedState.inst;Xt!==null&&h!==null&&Hp(h,Xt.memoizedState.deps)?x.memoizedState=bu(o,w,c,h):(ct.flags|=s,x.memoizedState=bu(1|o,w,c,h))}function k0(s,o){Zh(8390656,8,s,o)}function eg(s,o){Jh(2048,8,s,o)}function yN(s){ct.flags|=4;var o=ct.updateQueue;if(o===null)o=Hh(),ct.updateQueue=o,o.events=[s];else{var c=o.events;c===null?o.events=[s]:c.push(s)}}function L0(s){var o=Rn().memoizedState;return yN({ref:o,nextImpl:s}),function(){if((Gt&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function V0(s,o){return Jh(4,2,s,o)}function O0(s,o){return Jh(4,4,s,o)}function U0(s,o){if(typeof o=="function"){s=s();var c=o(s);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function B0(s,o,c){c=c!=null?c.concat([s]):null,Jh(4,4,U0.bind(null,o,s),c)}function tg(){}function z0(s,o){var c=Rn();o=o===void 0?null:o;var h=c.memoizedState;return o!==null&&Hp(o,h[1])?h[0]:(c.memoizedState=[s,o],s)}function F0(s,o){var c=Rn();o=o===void 0?null:o;var h=c.memoizedState;if(o!==null&&Hp(o,h[1]))return h[0];if(h=s(),yl){lt(!0);try{s()}finally{lt(!1)}}return c.memoizedState=[h,o],h}function ng(s,o,c){return c===void 0||(to&1073741824)!==0&&(At&261930)===0?s.memoizedState=o:(s.memoizedState=c,s=qT(),ct.lanes|=s,na|=s,c)}function q0(s,o,c,h){return $n(c,o)?c:Eu.current!==null?(s=ng(s,c,h),$n(s,o)||(Un=!0),s):(to&42)===0||(to&1073741824)!==0&&(At&261930)===0?(Un=!0,s.memoizedState=c):(s=qT(),ct.lanes|=s,na|=s,o)}function G0(s,o,c,h,x){var w=be.p;be.p=w!==0&&8>w?w:8;var N=ie.T,k={};ie.T=k,rg(s,!1,o,c);try{var J=x(),ae=ie.S;if(ae!==null&&ae(k,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var _e=fN(J,h);Xc(s,o,_e,vs(s))}else Xc(s,o,h,vs(s))}catch(Ee){Xc(s,o,{then:function(){},status:"rejected",reason:Ee},vs())}finally{be.p=w,N!==null&&k.types!==null&&(N.types=k.types),ie.T=N}}function vN(){}function ig(s,o,c,h){if(s.tag!==5)throw Error(i(476));var x=H0(s).queue;G0(s,x,o,Se,c===null?vN:function(){return j0(s),c(h)})}function H0(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:Se,baseState:Se,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:no,lastRenderedState:Se},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:no,lastRenderedState:c},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function j0(s){var o=H0(s);o.next===null&&(o=s.alternate.memoizedState),Xc(s,o.next.queue,{},vs())}function sg(){return ri(gd)}function K0(){return Rn().memoizedState}function Z0(){return Rn().memoizedState}function TN(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var c=vs();s=Wo(c);var h=Qo(o,s,c);h!==null&&($i(h,o,c),Jc(h,o,c)),o={cache:Dp()},s.payload=o;return}o=o.return}}function xN(s,o,c){var h=vs();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Yh(s)?Y0(o,c):(c=Uc(s,o,c,h),c!==null&&($i(c,s,h),W0(c,o,h)))}function J0(s,o,c){var h=vs();Xc(s,o,c,h)}function Xc(s,o,c,h){var x={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Yh(s))Y0(o,x);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var N=o.lastRenderedState,k=w(N,c);if(x.hasEagerState=!0,x.eagerState=k,$n(k,N))return Ar(s,o,x,0),rn===null&&ll(),!1}catch{}finally{}if(c=Uc(s,o,x,h),c!==null)return $i(c,s,h),W0(c,o,h),!0}return!1}function rg(s,o,c,h){if(h={lane:2,revertLane:Og(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Yh(s)){if(o)throw Error(i(479))}else o=Uc(s,c,h,2),o!==null&&$i(o,s,2)}function Yh(s){var o=s.alternate;return s===ct||o!==null&&o===ct}function Y0(s,o){wu=qh=!0;var c=s.pending;c===null?o.next=o:(o.next=c.next,c.next=o),s.pending=o}function W0(s,o,c){if((c&4194048)!==0){var h=o.lanes;h&=s.pendingLanes,c|=h,o.lanes=c,Fa(s,c)}}var ed={readContext:ri,use:jh,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useLayoutEffect:bn,useInsertionEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useSyncExternalStore:bn,useId:bn,useHostTransitionStatus:bn,useFormState:bn,useActionState:bn,useOptimistic:bn,useMemoCache:bn,useCacheRefresh:bn};ed.useEffectEvent=bn;var Q0={readContext:ri,use:jh,useCallback:function(s,o){return Pi().memoizedState=[s,o===void 0?null:o],s},useContext:ri,useEffect:k0,useImperativeHandle:function(s,o,c){c=c!=null?c.concat([s]):null,Zh(4194308,4,U0.bind(null,o,s),c)},useLayoutEffect:function(s,o){return Zh(4194308,4,s,o)},useInsertionEffect:function(s,o){Zh(4,2,s,o)},useMemo:function(s,o){var c=Pi();o=o===void 0?null:o;var h=s();if(yl){lt(!0);try{s()}finally{lt(!1)}}return c.memoizedState=[h,o],h},useReducer:function(s,o,c){var h=Pi();if(c!==void 0){var x=c(o);if(yl){lt(!0);try{c(o)}finally{lt(!1)}}}else x=o;return h.memoizedState=h.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},h.queue=s,s=s.dispatch=xN.bind(null,ct,s),[h.memoizedState,s]},useRef:function(s){var o=Pi();return s={current:s},o.memoizedState=s},useState:function(s){s=$p(s);var o=s.queue,c=J0.bind(null,ct,o);return o.dispatch=c,[s.memoizedState,c]},useDebugValue:tg,useDeferredValue:function(s,o){var c=Pi();return ng(c,s,o)},useTransition:function(){var s=$p(!1);return s=G0.bind(null,ct,s.queue,!0,!1),Pi().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,c){var h=ct,x=Pi();if(xt){if(c===void 0)throw Error(i(407));c=c()}else{if(c=o(),rn===null)throw Error(i(349));(At&127)!==0||y0(h,o,c)}x.memoizedState=c;var w={value:c,getSnapshot:o};return x.queue=w,k0(T0.bind(null,h,w,s),[s]),h.flags|=2048,bu(9,{destroy:void 0},v0.bind(null,h,w,c,o),null),c},useId:function(){var s=Pi(),o=rn.identifierPrefix;if(xt){var c=De,h=xe;c=(h&~(1<<32-at(h)-1)).toString(32)+c,o="_"+o+"R_"+c,c=Gh++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=mN++,o="_"+o+"r_"+c.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:sg,useFormState:N0,useActionState:N0,useOptimistic:function(s){var o=Pi();o.memoizedState=o.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=rg.bind(null,ct,!0,c),c.dispatch=o,[s,o]},useMemoCache:Yp,useCacheRefresh:function(){return Pi().memoizedState=TN.bind(null,ct)},useEffectEvent:function(s){var o=Pi(),c={impl:s};return o.memoizedState=c,function(){if((Gt&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},og={readContext:ri,use:jh,useCallback:z0,useContext:ri,useEffect:eg,useImperativeHandle:B0,useInsertionEffect:V0,useLayoutEffect:O0,useMemo:F0,useReducer:Kh,useRef:D0,useState:function(){return Kh(no)},useDebugValue:tg,useDeferredValue:function(s,o){var c=Rn();return q0(c,Xt.memoizedState,s,o)},useTransition:function(){var s=Kh(no)[0],o=Rn().memoizedState;return[typeof s=="boolean"?s:$c(s),o]},useSyncExternalStore:_0,useId:K0,useHostTransitionStatus:sg,useFormState:R0,useActionState:R0,useOptimistic:function(s,o){var c=Rn();return w0(c,Xt,s,o)},useMemoCache:Yp,useCacheRefresh:Z0};og.useEffectEvent=L0;var $0={readContext:ri,use:jh,useCallback:z0,useContext:ri,useEffect:eg,useImperativeHandle:B0,useInsertionEffect:V0,useLayoutEffect:O0,useMemo:F0,useReducer:Qp,useRef:D0,useState:function(){return Qp(no)},useDebugValue:tg,useDeferredValue:function(s,o){var c=Rn();return Xt===null?ng(c,s,o):q0(c,Xt.memoizedState,s,o)},useTransition:function(){var s=Qp(no)[0],o=Rn().memoizedState;return[typeof s=="boolean"?s:$c(s),o]},useSyncExternalStore:_0,useId:K0,useHostTransitionStatus:sg,useFormState:P0,useActionState:P0,useOptimistic:function(s,o){var c=Rn();return Xt!==null?w0(c,Xt,s,o):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:Yp,useCacheRefresh:Z0};$0.useEffectEvent=L0;function ag(s,o,c,h){o=s.memoizedState,c=c(h,o),c=c==null?o:S({},o,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var lg={enqueueSetState:function(s,o,c){s=s._reactInternals;var h=vs(),x=Wo(h);x.payload=o,c!=null&&(x.callback=c),o=Qo(s,x,h),o!==null&&($i(o,s,h),Jc(o,s,h))},enqueueReplaceState:function(s,o,c){s=s._reactInternals;var h=vs(),x=Wo(h);x.tag=1,x.payload=o,c!=null&&(x.callback=c),o=Qo(s,x,h),o!==null&&($i(o,s,h),Jc(o,s,h))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var c=vs(),h=Wo(c);h.tag=2,o!=null&&(h.callback=o),o=Qo(s,h,c),o!==null&&($i(o,s,c),Jc(o,s,c))}};function X0(s,o,c,h,x,w,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,w,N):o.prototype&&o.prototype.isPureReactComponent?!Go(c,h)||!Go(x,w):!0}function eT(s,o,c,h){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,h),o.state!==s&&lg.enqueueReplaceState(o,o.state,null)}function vl(s,o){var c=o;if("ref"in o){c={};for(var h in o)h!=="ref"&&(c[h]=o[h])}if(s=s.defaultProps){c===o&&(c=S({},c));for(var x in s)c[x]===void 0&&(c[x]=s[x])}return c}function tT(s){al(s)}function nT(s){console.error(s)}function iT(s){al(s)}function Wh(s,o){try{var c=s.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function sT(s,o,c){try{var h=s.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function ug(s,o,c){return c=Wo(c),c.tag=3,c.payload={element:null},c.callback=function(){Wh(s,o)},c}function rT(s){return s=Wo(s),s.tag=3,s}function oT(s,o,c,h){var x=c.type.getDerivedStateFromError;if(typeof x=="function"){var w=h.value;s.payload=function(){return x(w)},s.callback=function(){sT(o,c,h)}}var N=c.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){sT(o,c,h),typeof x!="function"&&(ia===null?ia=new Set([this]):ia.add(this));var k=h.stack;this.componentDidCatch(h.value,{componentStack:k!==null?k:""})})}function EN(s,o,c,h,x){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=c.alternate,o!==null&&_u(o,c,x,!0),c=ps.current,c!==null){switch(c.tag){case 31:case 13:return Bs===null?uf():c.alternate===null&&An===0&&(An=3),c.flags&=-257,c.flags|=65536,c.lanes=x,h===Oh?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([h]):o.add(h),kg(s,h,x)),!1;case 22:return c.flags|=65536,h===Oh?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([h]):c.add(h)),kg(s,h,x)),!1}throw Error(i(435,c.tag))}return kg(s,h,x),uf(),!1}if(xt)return o=ps.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=x,h!==gu&&(s=Error(i(422),{cause:h}),dl(d(s,c)))):(h!==gu&&(o=Error(i(423),{cause:h}),dl(d(o,c))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,h=d(h,c),x=ug(s.stateNode,h,x),Bp(s,x),An!==4&&(An=2)),!1;var w=Error(i(520),{cause:h});if(w=d(w,c),ld===null?ld=[w]:ld.push(w),An!==4&&(An=2),o===null)return!0;h=d(h,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,s=x&-x,c.lanes|=s,s=ug(c.stateNode,h,s),Bp(c,s),!1;case 1:if(o=c.type,w=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ia===null||!ia.has(w))))return c.flags|=65536,x&=-x,c.lanes|=x,x=rT(x),oT(x,s,c,h),Bp(c,x),!1}c=c.return}while(c!==null);return!1}var cg=Error(i(461)),Un=!1;function oi(s,o,c,h){o.child=s===null?c0(o,null,c,h):_l(o,s.child,c,h)}function aT(s,o,c,h,x){c=c.render;var w=o.ref;if("ref"in h){var N={};for(var k in h)k!=="ref"&&(N[k]=h[k])}else N=h;return fl(o),h=jp(s,o,c,N,w,x),k=Kp(),s!==null&&!Un?(Zp(s,o,x),io(s,o,x)):(xt&&k&&Gn(o),o.flags|=1,oi(s,o,h,x),o.child)}function lT(s,o,c,h,x){if(s===null){var w=c.type;return typeof w=="function"&&!mu(w)&&w.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=w,uT(s,o,w,h,x)):(s=cl(c.type,null,h,o,o.mode,x),s.ref=o.ref,s.return=o,o.child=s)}if(w=s.child,!yg(s,x)){var N=w.memoizedProps;if(c=c.compare,c=c!==null?c:Go,c(N,h)&&s.ref===o.ref)return io(s,o,x)}return o.flags|=1,s=Us(w,h),s.ref=o.ref,s.return=o,o.child=s}function uT(s,o,c,h,x){if(s!==null){var w=s.memoizedProps;if(Go(w,h)&&s.ref===o.ref)if(Un=!1,o.pendingProps=h=w,yg(s,x))(s.flags&131072)!==0&&(Un=!0);else return o.lanes=s.lanes,io(s,o,x)}return dg(s,o,c,h,x)}function cT(s,o,c,h){var x=h.children,w=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((o.flags&128)!==0){if(w=w!==null?w.baseLanes|c:c,s!==null){for(h=o.child=s.child,x=0;h!==null;)x=x|h.lanes|h.childLanes,h=h.sibling;h=x&~w}else h=0,o.child=null;return dT(s,o,w,c,h)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Lh(o,w!==null?w.cachePool:null),w!==null?f0(o,w):Fp(),m0(o);else return h=o.lanes=536870912,dT(s,o,w!==null?w.baseLanes|c:c,c,h)}else w!==null?(Lh(o,w.cachePool),f0(o,w),Xo(),o.memoizedState=null):(s!==null&&Lh(o,null),Fp(),Xo());return oi(s,o,x,c),o.child}function td(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function dT(s,o,c,h,x){var w=Lp();return w=w===null?null:{parent:Vn._currentValue,pool:w},o.memoizedState={baseLanes:c,cachePool:w},s!==null&&Lh(o,null),Fp(),m0(o),s!==null&&_u(s,o,h,!0),o.childLanes=x,null}function Qh(s,o){return o=Xh({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function hT(s,o,c){return _l(o,s.child,null,c),s=Qh(o,o.pendingProps),s.flags|=2,gs(o),o.memoizedState=null,s}function wN(s,o,c){var h=o.pendingProps,x=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(xt){if(h.mode==="hidden")return s=Qh(o,h),o.lanes=536870912,td(null,s);if(Gp(o),(s=Ut)?(s=Sx(s,Zi),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:ue!==null?{id:xe,overflow:De}:null,retryLane:536870912,hydrationErrors:null},c=zc(s),c.return=o,o.child=c,Ot=o,Ut=null)):s=null,s===null)throw Cr(o);return o.lanes=536870912,null}return Qh(o,h)}var w=s.memoizedState;if(w!==null){var N=w.dehydrated;if(Gp(o),x)if(o.flags&256)o.flags&=-257,o=hT(s,o,c);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(i(558));else if(Un||_u(s,o,c,!1),x=(c&s.childLanes)!==0,Un||x){if(h=rn,h!==null&&(N=qa(h,c),N!==0&&N!==w.retryLane))throw w.retryLane=N,Os(s,N),$i(h,s,N),cg;uf(),o=hT(s,o,c)}else s=w.treeContext,Ut=zs(N.nextSibling),Ot=o,xt=!0,Ir=null,Zi=!1,s!==null&&Mi(o,s),o=Qh(o,h),o.flags|=4096;return o}return s=Us(s.child,{mode:h.mode,children:h.children}),s.ref=o.ref,o.child=s,s.return=o,s}function $h(s,o){var c=o.ref;if(c===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(s===null||s.ref!==c)&&(o.flags|=4194816)}}function dg(s,o,c,h,x){return fl(o),c=jp(s,o,c,h,void 0,x),h=Kp(),s!==null&&!Un?(Zp(s,o,x),io(s,o,x)):(xt&&h&&Gn(o),o.flags|=1,oi(s,o,c,x),o.child)}function fT(s,o,c,h,x,w){return fl(o),o.updateQueue=null,c=g0(o,h,c,x),p0(s),h=Kp(),s!==null&&!Un?(Zp(s,o,w),io(s,o,w)):(xt&&h&&Gn(o),o.flags|=1,oi(s,o,c,w),o.child)}function mT(s,o,c,h,x){if(fl(o),o.stateNode===null){var w=Qr,N=c.contextType;typeof N=="object"&&N!==null&&(w=ri(N)),w=new c(h,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=lg,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=h,w.state=o.memoizedState,w.refs={},Op(o),N=c.contextType,w.context=typeof N=="object"&&N!==null?ri(N):Qr,w.state=o.memoizedState,N=c.getDerivedStateFromProps,typeof N=="function"&&(ag(o,c,N,h),w.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(N=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),N!==w.state&&lg.enqueueReplaceState(w,w.state,null),Wc(o,h,w,x),Yc(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(s===null){w=o.stateNode;var k=o.memoizedProps,J=vl(c,k);w.props=J;var ae=w.context,_e=c.contextType;N=Qr,typeof _e=="object"&&_e!==null&&(N=ri(_e));var Ee=c.getDerivedStateFromProps;_e=typeof Ee=="function"||typeof w.getSnapshotBeforeUpdate=="function",k=o.pendingProps!==k,_e||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(k||ae!==N)&&eT(o,w,h,N),Yo=!1;var ce=o.memoizedState;w.state=ce,Wc(o,h,w,x),Yc(),ae=o.memoizedState,k||ce!==ae||Yo?(typeof Ee=="function"&&(ag(o,c,Ee,h),ae=o.memoizedState),(J=Yo||X0(o,c,J,h,ce,ae,N))?(_e||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=ae),w.props=h,w.state=ae,w.context=N,h=J):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{w=o.stateNode,Up(s,o),N=o.memoizedProps,_e=vl(c,N),w.props=_e,Ee=o.pendingProps,ce=w.context,ae=c.contextType,J=Qr,typeof ae=="object"&&ae!==null&&(J=ri(ae)),k=c.getDerivedStateFromProps,(ae=typeof k=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(N!==Ee||ce!==J)&&eT(o,w,h,J),Yo=!1,ce=o.memoizedState,w.state=ce,Wc(o,h,w,x),Yc();var me=o.memoizedState;N!==Ee||ce!==me||Yo||s!==null&&s.dependencies!==null&&Dh(s.dependencies)?(typeof k=="function"&&(ag(o,c,k,h),me=o.memoizedState),(_e=Yo||X0(o,c,_e,h,ce,me,J)||s!==null&&s.dependencies!==null&&Dh(s.dependencies))?(ae||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,me,J),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,me,J)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&ce===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ce===s.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=me),w.props=h,w.state=me,w.context=J,h=_e):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&ce===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ce===s.memoizedState||(o.flags|=1024),h=!1)}return w=h,$h(s,o),h=(o.flags&128)!==0,w||h?(w=o.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,s!==null&&h?(o.child=_l(o,s.child,null,x),o.child=_l(o,null,c,x)):oi(s,o,c,x),o.memoizedState=w.state,s=o.child):s=io(s,o,x),s}function pT(s,o,c,h){return Xr(),o.flags|=256,oi(s,o,c,h),o.child}var hg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function fg(s){return{baseLanes:s,cachePool:s0()}}function mg(s,o,c){return s=s!==null?s.childLanes&~c:0,o&&(s|=ys),s}function gT(s,o,c){var h=o.pendingProps,x=!1,w=(o.flags&128)!==0,N;if((N=w)||(N=s!==null&&s.memoizedState===null?!1:(Nn.current&2)!==0),N&&(x=!0,o.flags&=-129),N=(o.flags&32)!==0,o.flags&=-33,s===null){if(xt){if(x?$o(o):Xo(),(s=Ut)?(s=Sx(s,Zi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:ue!==null?{id:xe,overflow:De}:null,retryLane:536870912,hydrationErrors:null},c=zc(s),c.return=o,o.child=c,Ot=o,Ut=null)):s=null,s===null)throw Cr(o);return Wg(s)?o.lanes=32:o.lanes=536870912,null}var k=h.children;return h=h.fallback,x?(Xo(),x=o.mode,k=Xh({mode:"hidden",children:k},x),h=$r(h,x,c,null),k.return=o,h.return=o,k.sibling=h,o.child=k,h=o.child,h.memoizedState=fg(c),h.childLanes=mg(s,N,c),o.memoizedState=hg,td(null,h)):($o(o),pg(o,k))}var J=s.memoizedState;if(J!==null&&(k=J.dehydrated,k!==null)){if(w)o.flags&256?($o(o),o.flags&=-257,o=gg(s,o,c)):o.memoizedState!==null?(Xo(),o.child=s.child,o.flags|=128,o=null):(Xo(),k=h.fallback,x=o.mode,h=Xh({mode:"visible",children:h.children},x),k=$r(k,x,c,null),k.flags|=2,h.return=o,k.return=o,h.sibling=k,o.child=h,_l(o,s.child,null,c),h=o.child,h.memoizedState=fg(c),h.childLanes=mg(s,N,c),o.memoizedState=hg,o=td(null,h));else if($o(o),Wg(k)){if(N=k.nextSibling&&k.nextSibling.dataset,N)var ae=N.dgst;N=ae,h=Error(i(419)),h.stack="",h.digest=N,dl({value:h,source:null,stack:null}),o=gg(s,o,c)}else if(Un||_u(s,o,c,!1),N=(c&s.childLanes)!==0,Un||N){if(N=rn,N!==null&&(h=qa(N,c),h!==0&&h!==J.retryLane))throw J.retryLane=h,Os(s,h),$i(N,s,h),cg;Yg(k)||uf(),o=gg(s,o,c)}else Yg(k)?(o.flags|=192,o.child=s.child,o=null):(s=J.treeContext,Ut=zs(k.nextSibling),Ot=o,xt=!0,Ir=null,Zi=!1,s!==null&&Mi(o,s),o=pg(o,h.children),o.flags|=4096);return o}return x?(Xo(),k=h.fallback,x=o.mode,J=s.child,ae=J.sibling,h=Us(J,{mode:"hidden",children:h.children}),h.subtreeFlags=J.subtreeFlags&65011712,ae!==null?k=Us(ae,k):(k=$r(k,x,c,null),k.flags|=2),k.return=o,h.return=o,h.sibling=k,o.child=h,td(null,h),h=o.child,k=s.child.memoizedState,k===null?k=fg(c):(x=k.cachePool,x!==null?(J=Vn._currentValue,x=x.parent!==J?{parent:J,pool:J}:x):x=s0(),k={baseLanes:k.baseLanes|c,cachePool:x}),h.memoizedState=k,h.childLanes=mg(s,N,c),o.memoizedState=hg,td(s.child,h)):($o(o),c=s.child,s=c.sibling,c=Us(c,{mode:"visible",children:h.children}),c.return=o,c.sibling=null,s!==null&&(N=o.deletions,N===null?(o.deletions=[s],o.flags|=16):N.push(s)),o.child=c,o.memoizedState=null,c)}function pg(s,o){return o=Xh({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Xh(s,o){return s=pi(22,s,null,o),s.lanes=0,s}function gg(s,o,c){return _l(o,s.child,null,c),s=pg(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function _T(s,o,c){s.lanes|=o;var h=s.alternate;h!==null&&(h.lanes|=o),Mp(s.return,o,c)}function _g(s,o,c,h,x,w){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:x,treeForkCount:w}:(N.isBackwards=o,N.rendering=null,N.renderingStartTime=0,N.last=h,N.tail=c,N.tailMode=x,N.treeForkCount=w)}function yT(s,o,c){var h=o.pendingProps,x=h.revealOrder,w=h.tail;h=h.children;var N=Nn.current,k=(N&2)!==0;if(k?(N=N&1|2,o.flags|=128):N&=1,Ie(Nn,N),oi(s,o,h,c),h=xt?P:0,!k&&s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&_T(s,c,o);else if(s.tag===19)_T(s,c,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(c=o.child,x=null;c!==null;)s=c.alternate,s!==null&&Fh(s)===null&&(x=c),c=c.sibling;c=x,c===null?(x=o.child,o.child=null):(x=c.sibling,c.sibling=null),_g(o,!1,x,c,w,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,x=o.child,o.child=null;x!==null;){if(s=x.alternate,s!==null&&Fh(s)===null){o.child=x;break}s=x.sibling,x.sibling=c,c=x,x=s}_g(o,!0,c,null,w,h);break;case"together":_g(o,!1,null,null,void 0,h);break;default:o.memoizedState=null}return o.child}function io(s,o,c){if(s!==null&&(o.dependencies=s.dependencies),na|=o.lanes,(c&o.childLanes)===0)if(s!==null){if(_u(s,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(i(153));if(o.child!==null){for(s=o.child,c=Us(s,s.pendingProps),o.child=c,c.return=o;s.sibling!==null;)s=s.sibling,c=c.sibling=Us(s,s.pendingProps),c.return=o;c.sibling=null}return o.child}function yg(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Dh(s)))}function SN(s,o,c){switch(o.tag){case 3:Ue(o,o.stateNode.containerInfo),Jo(o,Vn,s.memoizedState.cache),Xr();break;case 27:case 5:et(o);break;case 4:Ue(o,o.stateNode.containerInfo);break;case 10:Jo(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Gp(o),null;break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?($o(o),o.flags|=128,null):(c&o.child.childLanes)!==0?gT(s,o,c):($o(o),s=io(s,o,c),s!==null?s.sibling:null);$o(o);break;case 19:var x=(s.flags&128)!==0;if(h=(c&o.childLanes)!==0,h||(_u(s,o,c,!1),h=(c&o.childLanes)!==0),x){if(h)return yT(s,o,c);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Ie(Nn,Nn.current),h)break;return null;case 22:return o.lanes=0,cT(s,o,c,o.pendingProps);case 24:Jo(o,Vn,s.memoizedState.cache)}return io(s,o,c)}function vT(s,o,c){if(s!==null)if(s.memoizedProps!==o.pendingProps)Un=!0;else{if(!yg(s,c)&&(o.flags&128)===0)return Un=!1,SN(s,o,c);Un=(s.flags&131072)!==0}else Un=!1,xt&&(o.flags&1048576)!==0&&ht(o,P,o.index);switch(o.lanes=0,o.tag){case 16:e:{var h=o.pendingProps;if(s=pl(o.elementType),o.type=s,typeof s=="function")mu(s)?(h=vl(s,h),o.tag=1,o=mT(null,o,s,h,c)):(o.tag=0,o=dg(null,o,s,h,c));else{if(s!=null){var x=s.$$typeof;if(x===pe){o.tag=11,o=aT(null,o,s,h,c);break e}else if(x===D){o.tag=14,o=lT(null,o,s,h,c);break e}}throw o=qe(s)||s,Error(i(306,o,""))}}return o;case 0:return dg(s,o,o.type,o.pendingProps,c);case 1:return h=o.type,x=vl(h,o.pendingProps),mT(s,o,h,x,c);case 3:e:{if(Ue(o,o.stateNode.containerInfo),s===null)throw Error(i(387));h=o.pendingProps;var w=o.memoizedState;x=w.element,Up(s,o),Wc(o,h,null,c);var N=o.memoizedState;if(h=N.cache,Jo(o,Vn,h),h!==w.cache&&Pp(o,[Vn],c,!0),Yc(),h=N.element,w.isDehydrated)if(w={element:h,isDehydrated:!1,cache:N.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=pT(s,o,h,c);break e}else if(h!==x){x=d(Error(i(424)),o),dl(x),o=pT(s,o,h,c);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Ut=zs(s.firstChild),Ot=o,xt=!0,Ir=null,Zi=!0,c=c0(o,null,h,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Xr(),h===x){o=io(s,o,c);break e}oi(s,o,h,c)}o=o.child}return o;case 26:return $h(s,o),s===null?(c=Rx(o.type,null,o.pendingProps,null))?o.memoizedState=c:xt||(c=o.type,s=o.pendingProps,h=gf(Ae.current).createElement(c),h[yn]=o,h[En]=s,ai(h,c,s),wn(h),o.stateNode=h):o.memoizedState=Rx(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return et(o),s===null&&xt&&(h=o.stateNode=Ix(o.type,o.pendingProps,Ae.current),Ot=o,Zi=!0,x=Ut,aa(o.type)?(Qg=x,Ut=zs(h.firstChild)):Ut=x),oi(s,o,o.pendingProps.children,c),$h(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&xt&&((x=h=Ut)&&(h=e2(h,o.type,o.pendingProps,Zi),h!==null?(o.stateNode=h,Ot=o,Ut=zs(h.firstChild),Zi=!1,x=!0):x=!1),x||Cr(o)),et(o),x=o.type,w=o.pendingProps,N=s!==null?s.memoizedProps:null,h=w.children,Kg(x,w)?h=null:N!==null&&Kg(x,N)&&(o.flags|=32),o.memoizedState!==null&&(x=jp(s,o,pN,null,null,c),gd._currentValue=x),$h(s,o),oi(s,o,h,c),o.child;case 6:return s===null&&xt&&((s=c=Ut)&&(c=t2(c,o.pendingProps,Zi),c!==null?(o.stateNode=c,Ot=o,Ut=null,s=!0):s=!1),s||Cr(o)),null;case 13:return gT(s,o,c);case 4:return Ue(o,o.stateNode.containerInfo),h=o.pendingProps,s===null?o.child=_l(o,null,h,c):oi(s,o,h,c),o.child;case 11:return aT(s,o,o.type,o.pendingProps,c);case 7:return oi(s,o,o.pendingProps,c),o.child;case 8:return oi(s,o,o.pendingProps.children,c),o.child;case 12:return oi(s,o,o.pendingProps.children,c),o.child;case 10:return h=o.pendingProps,Jo(o,o.type,h.value),oi(s,o,h.children,c),o.child;case 9:return x=o.type._context,h=o.pendingProps.children,fl(o),x=ri(x),h=h(x),o.flags|=1,oi(s,o,h,c),o.child;case 14:return lT(s,o,o.type,o.pendingProps,c);case 15:return uT(s,o,o.type,o.pendingProps,c);case 19:return yT(s,o,c);case 31:return wN(s,o,c);case 22:return cT(s,o,c,o.pendingProps);case 24:return fl(o),h=ri(Vn),s===null?(x=Lp(),x===null&&(x=rn,w=Dp(),x.pooledCache=w,w.refCount++,w!==null&&(x.pooledCacheLanes|=c),x=w),o.memoizedState={parent:h,cache:x},Op(o),Jo(o,Vn,x)):((s.lanes&c)!==0&&(Up(s,o),Wc(o,null,null,c),Yc()),x=s.memoizedState,w=o.memoizedState,x.parent!==h?(x={parent:h,cache:h},o.memoizedState=x,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=x),Jo(o,Vn,h)):(h=w.cache,Jo(o,Vn,h),h!==x.cache&&Pp(o,[Vn],c,!0))),oi(s,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function so(s){s.flags|=4}function vg(s,o,c,h,x){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(KT())s.flags|=8192;else throw gl=Oh,Vp}else s.flags&=-16777217}function TT(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Lx(o))if(KT())s.flags|=8192;else throw gl=Oh,Vp}function ef(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?eu():536870912,s.lanes|=o,Nu|=o)}function nd(s,o){if(!xt)switch(s.tailMode){case"hidden":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function fn(s){var o=s.alternate!==null&&s.alternate.child===s.child,c=0,h=0;if(o)for(var x=s.child;x!==null;)c|=x.lanes|x.childLanes,h|=x.subtreeFlags&65011712,h|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)c|=x.lanes|x.childLanes,h|=x.subtreeFlags,h|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=h,s.childLanes=c,o}function bN(s,o,c){var h=o.pendingProps;switch(Sn(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fn(o),null;case 1:return fn(o),null;case 3:return c=o.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),eo(Vn),we(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(tr(o)?so(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Gc())),fn(o),null;case 26:var x=o.type,w=o.memoizedState;return s===null?(so(o),w!==null?(fn(o),TT(o,w)):(fn(o),vg(o,x,null,h,c))):w?w!==s.memoizedState?(so(o),fn(o),TT(o,w)):(fn(o),o.flags&=-16777217):(s=s.memoizedProps,s!==h&&so(o),fn(o),vg(o,x,s,h,c)),null;case 27:if(vt(o),c=Ae.current,x=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==h&&so(o);else{if(!h){if(o.stateNode===null)throw Error(i(166));return fn(o),null}s=le.current,tr(o)?qc(o):(s=Ix(x,h,c),o.stateNode=s,so(o))}return fn(o),null;case 5:if(vt(o),x=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==h&&so(o);else{if(!h){if(o.stateNode===null)throw Error(i(166));return fn(o),null}if(w=le.current,tr(o))qc(o);else{var N=gf(Ae.current);switch(w){case 1:w=N.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:w=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":w=N.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":w=N.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":w=N.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof h.is=="string"?N.createElement("select",{is:h.is}):N.createElement("select"),h.multiple?w.multiple=!0:h.size&&(w.size=h.size);break;default:w=typeof h.is=="string"?N.createElement(x,{is:h.is}):N.createElement(x)}}w[yn]=o,w[En]=h;e:for(N=o.child;N!==null;){if(N.tag===5||N.tag===6)w.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===o)break e;for(;N.sibling===null;){if(N.return===null||N.return===o)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}o.stateNode=w;e:switch(ai(w,x,h),x){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&so(o)}}return fn(o),vg(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,c),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==h&&so(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(i(166));if(s=Ae.current,tr(o)){if(s=o.stateNode,c=o.memoizedProps,h=null,x=Ot,x!==null)switch(x.tag){case 27:case 5:h=x.memoizedProps}s[yn]=o,s=!!(s.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||gx(s.nodeValue,c)),s||Cr(o,!0)}else s=gf(s).createTextNode(h),s[yn]=o,o.stateNode=s}return fn(o),null;case 31:if(c=o.memoizedState,s===null||s.memoizedState!==null){if(h=tr(o),c!==null){if(s===null){if(!h)throw Error(i(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[yn]=o}else Xr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;fn(o),s=!1}else c=Gc(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return o.flags&256?(gs(o),o):(gs(o),null);if((o.flags&128)!==0)throw Error(i(558))}return fn(o),null;case 13:if(h=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=tr(o),h!==null&&h.dehydrated!==null){if(s===null){if(!x)throw Error(i(318));if(x=o.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(i(317));x[yn]=o}else Xr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;fn(o),x=!1}else x=Gc(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return o.flags&256?(gs(o),o):(gs(o),null)}return gs(o),(o.flags&128)!==0?(o.lanes=c,o):(c=h!==null,s=s!==null&&s.memoizedState!==null,c&&(h=o.child,x=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(x=h.alternate.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==x&&(h.flags|=2048)),c!==s&&c&&(o.child.flags|=8192),ef(o,o.updateQueue),fn(o),null);case 4:return we(),s===null&&Fg(o.stateNode.containerInfo),fn(o),null;case 10:return eo(o.type),fn(o),null;case 19:if(fe(Nn),h=o.memoizedState,h===null)return fn(o),null;if(x=(o.flags&128)!==0,w=h.rendering,w===null)if(x)nd(h,!1);else{if(An!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(w=Fh(s),w!==null){for(o.flags|=128,nd(h,!1),s=w.updateQueue,o.updateQueue=s,ef(o,s),o.subtreeFlags=0,s=c,c=o.child;c!==null;)Bc(c,s),c=c.sibling;return Ie(Nn,Nn.current&1|2),xt&&Ke(o,h.treeForkCount),o.child}s=s.sibling}h.tail!==null&&dt()>of&&(o.flags|=128,x=!0,nd(h,!1),o.lanes=4194304)}else{if(!x)if(s=Fh(w),s!==null){if(o.flags|=128,x=!0,s=s.updateQueue,o.updateQueue=s,ef(o,s),nd(h,!0),h.tail===null&&h.tailMode==="hidden"&&!w.alternate&&!xt)return fn(o),null}else 2*dt()-h.renderingStartTime>of&&c!==536870912&&(o.flags|=128,x=!0,nd(h,!1),o.lanes=4194304);h.isBackwards?(w.sibling=o.child,o.child=w):(s=h.last,s!==null?s.sibling=w:o.child=w,h.last=w)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=dt(),s.sibling=null,c=Nn.current,Ie(Nn,x?c&1|2:c&1),xt&&Ke(o,h.treeForkCount),s):(fn(o),null);case 22:case 23:return gs(o),qp(),h=o.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(c&536870912)!==0&&(o.flags&128)===0&&(fn(o),o.subtreeFlags&6&&(o.flags|=8192)):fn(o),c=o.updateQueue,c!==null&&ef(o,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==c&&(o.flags|=2048),s!==null&&fe(ml),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),eo(Vn),fn(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function AN(s,o){switch(Sn(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return eo(Vn),we(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return vt(o),null;case 31:if(o.memoizedState!==null){if(gs(o),o.alternate===null)throw Error(i(340));Xr()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(gs(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(i(340));Xr()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return fe(Nn),null;case 4:return we(),null;case 10:return eo(o.type),null;case 22:case 23:return gs(o),qp(),s!==null&&fe(ml),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return eo(Vn),null;case 25:return null;default:return null}}function xT(s,o){switch(Sn(o),o.tag){case 3:eo(Vn),we();break;case 26:case 27:case 5:vt(o);break;case 4:we();break;case 31:o.memoizedState!==null&&gs(o);break;case 13:gs(o);break;case 19:fe(Nn);break;case 10:eo(o.type);break;case 22:case 23:gs(o),qp(),s!==null&&fe(ml);break;case 24:eo(Vn)}}function id(s,o){try{var c=o.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var x=h.next;c=x;do{if((c.tag&s)===s){h=void 0;var w=c.create,N=c.inst;h=w(),N.destroy=h}c=c.next}while(c!==x)}}catch(k){Jt(o,o.return,k)}}function ea(s,o,c){try{var h=o.updateQueue,x=h!==null?h.lastEffect:null;if(x!==null){var w=x.next;h=w;do{if((h.tag&s)===s){var N=h.inst,k=N.destroy;if(k!==void 0){N.destroy=void 0,x=o;var J=c,ae=k;try{ae()}catch(_e){Jt(x,J,_e)}}}h=h.next}while(h!==w)}}catch(_e){Jt(o,o.return,_e)}}function ET(s){var o=s.updateQueue;if(o!==null){var c=s.stateNode;try{h0(o,c)}catch(h){Jt(s,s.return,h)}}}function wT(s,o,c){c.props=vl(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(h){Jt(s,o,h)}}function sd(s,o){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof c=="function"?s.refCleanup=c(h):c.current=h}}catch(x){Jt(s,o,x)}}function Rr(s,o){var c=s.ref,h=s.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(x){Jt(s,o,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(x){Jt(s,o,x)}else c.current=null}function ST(s){var o=s.type,c=s.memoizedProps,h=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(x){Jt(s,s.return,x)}}function Tg(s,o,c){try{var h=s.stateNode;JN(h,s.type,c,o),h[En]=o}catch(x){Jt(s,s.return,x)}}function bT(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&aa(s.type)||s.tag===4}function xg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||bT(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&aa(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Eg(s,o,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(s),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=ci));else if(h!==4&&(h===27&&aa(s.type)&&(c=s.stateNode,o=null),s=s.child,s!==null))for(Eg(s,o,c),s=s.sibling;s!==null;)Eg(s,o,c),s=s.sibling}function tf(s,o,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?c.insertBefore(s,o):c.appendChild(s);else if(h!==4&&(h===27&&aa(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(tf(s,o,c),s=s.sibling;s!==null;)tf(s,o,c),s=s.sibling}function AT(s){var o=s.stateNode,c=s.memoizedProps;try{for(var h=s.type,x=o.attributes;x.length;)o.removeAttributeNode(x[0]);ai(o,h,c),o[yn]=s,o[En]=c}catch(w){Jt(s,s.return,w)}}var ro=!1,Bn=!1,wg=!1,IT=typeof WeakSet=="function"?WeakSet:Set,ei=null;function IN(s,o){if(s=s.containerInfo,Hg=wf,s=il(s),Er(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var x=h.anchorOffset,w=h.focusNode;h=h.focusOffset;try{c.nodeType,w.nodeType}catch{c=null;break e}var N=0,k=-1,J=-1,ae=0,_e=0,Ee=s,ce=null;t:for(;;){for(var me;Ee!==c||x!==0&&Ee.nodeType!==3||(k=N+x),Ee!==w||h!==0&&Ee.nodeType!==3||(J=N+h),Ee.nodeType===3&&(N+=Ee.nodeValue.length),(me=Ee.firstChild)!==null;)ce=Ee,Ee=me;for(;;){if(Ee===s)break t;if(ce===c&&++ae===x&&(k=N),ce===w&&++_e===h&&(J=N),(me=Ee.nextSibling)!==null)break;Ee=ce,ce=Ee.parentNode}Ee=me}c=k===-1||J===-1?null:{start:k,end:J}}else c=null}c=c||{start:0,end:0}}else c=null;for(jg={focusedElem:s,selectionRange:c},wf=!1,ei=o;ei!==null;)if(o=ei,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,ei=s;else for(;ei!==null;){switch(o=ei,w=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)x=s[c],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&w!==null){s=void 0,c=o,x=w.memoizedProps,w=w.memoizedState,h=c.stateNode;try{var Fe=vl(c.type,x);s=h.getSnapshotBeforeUpdate(Fe,w),h.__reactInternalSnapshotBeforeUpdate=s}catch(tt){Jt(c,c.return,tt)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,c=s.nodeType,c===9)Jg(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Jg(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=o.sibling,s!==null){s.return=o.return,ei=s;break}ei=o.return}}function CT(s,o,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:ao(s,c),h&4&&id(5,c);break;case 1:if(ao(s,c),h&4)if(s=c.stateNode,o===null)try{s.componentDidMount()}catch(N){Jt(c,c.return,N)}else{var x=vl(c.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(x,o,s.__reactInternalSnapshotBeforeUpdate)}catch(N){Jt(c,c.return,N)}}h&64&&ET(c),h&512&&sd(c,c.return);break;case 3:if(ao(s,c),h&64&&(s=c.updateQueue,s!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{h0(s,o)}catch(N){Jt(c,c.return,N)}}break;case 27:o===null&&h&4&&AT(c);case 26:case 5:ao(s,c),o===null&&h&4&&ST(c),h&512&&sd(c,c.return);break;case 12:ao(s,c);break;case 31:ao(s,c),h&4&&MT(s,c);break;case 13:ao(s,c),h&4&&PT(s,c),h&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=VN.bind(null,c),n2(s,c))));break;case 22:if(h=c.memoizedState!==null||ro,!h){o=o!==null&&o.memoizedState!==null||Bn,x=ro;var w=Bn;ro=h,(Bn=o)&&!w?lo(s,c,(c.subtreeFlags&8772)!==0):ao(s,c),ro=x,Bn=w}break;case 30:break;default:ao(s,c)}}function NT(s){var o=s.alternate;o!==null&&(s.alternate=null,NT(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&Ro(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var pn=null,Ji=!1;function oo(s,o,c){for(c=c.child;c!==null;)RT(s,o,c),c=c.sibling}function RT(s,o,c){if(Ne&&typeof Ne.onCommitFiberUnmount=="function")try{Ne.onCommitFiberUnmount(si,c)}catch{}switch(c.tag){case 26:Bn||Rr(c,o),oo(s,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Bn||Rr(c,o);var h=pn,x=Ji;aa(c.type)&&(pn=c.stateNode,Ji=!1),oo(s,o,c),fd(c.stateNode),pn=h,Ji=x;break;case 5:Bn||Rr(c,o);case 6:if(h=pn,x=Ji,pn=null,oo(s,o,c),pn=h,Ji=x,pn!==null)if(Ji)try{(pn.nodeType===9?pn.body:pn.nodeName==="HTML"?pn.ownerDocument.body:pn).removeChild(c.stateNode)}catch(w){Jt(c,o,w)}else try{pn.removeChild(c.stateNode)}catch(w){Jt(c,o,w)}break;case 18:pn!==null&&(Ji?(s=pn,Ex(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Ou(s)):Ex(pn,c.stateNode));break;case 4:h=pn,x=Ji,pn=c.stateNode.containerInfo,Ji=!0,oo(s,o,c),pn=h,Ji=x;break;case 0:case 11:case 14:case 15:ea(2,c,o),Bn||ea(4,c,o),oo(s,o,c);break;case 1:Bn||(Rr(c,o),h=c.stateNode,typeof h.componentWillUnmount=="function"&&wT(c,o,h)),oo(s,o,c);break;case 21:oo(s,o,c);break;case 22:Bn=(h=Bn)||c.memoizedState!==null,oo(s,o,c),Bn=h;break;default:oo(s,o,c)}}function MT(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ou(s)}catch(c){Jt(o,o.return,c)}}}function PT(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ou(s)}catch(c){Jt(o,o.return,c)}}function CN(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new IT),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new IT),o;default:throw Error(i(435,s.tag))}}function nf(s,o){var c=CN(s);o.forEach(function(h){if(!c.has(h)){c.add(h);var x=ON.bind(null,s,h);h.then(x,x)}})}function Yi(s,o){var c=o.deletions;if(c!==null)for(var h=0;h<c.length;h++){var x=c[h],w=s,N=o,k=N;e:for(;k!==null;){switch(k.tag){case 27:if(aa(k.type)){pn=k.stateNode,Ji=!1;break e}break;case 5:pn=k.stateNode,Ji=!1;break e;case 3:case 4:pn=k.stateNode.containerInfo,Ji=!0;break e}k=k.return}if(pn===null)throw Error(i(160));RT(w,N,x),pn=null,Ji=!1,w=x.alternate,w!==null&&(w.return=null),x.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)DT(o,s),o=o.sibling}var ir=null;function DT(s,o){var c=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Yi(o,s),Wi(s),h&4&&(ea(3,s,s.return),id(3,s),ea(5,s,s.return));break;case 1:Yi(o,s),Wi(s),h&512&&(Bn||c===null||Rr(c,c.return)),h&64&&ro&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var x=ir;if(Yi(o,s),Wi(s),h&512&&(Bn||c===null||Rr(c,c.return)),h&4){var w=c!==null?c.memoizedState:null;if(h=s.memoizedState,c===null)if(h===null)if(s.stateNode===null){e:{h=s.type,c=s.memoizedProps,x=x.ownerDocument||x;t:switch(h){case"title":w=x.getElementsByTagName("title")[0],(!w||w[As]||w[yn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=x.createElement(h),x.head.insertBefore(w,x.querySelector("head > title"))),ai(w,h,c),w[yn]=s,wn(w),h=w;break e;case"link":var N=Dx("link","href",x).get(h+(c.href||""));if(N){for(var k=0;k<N.length;k++)if(w=N[k],w.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&w.getAttribute("rel")===(c.rel==null?null:c.rel)&&w.getAttribute("title")===(c.title==null?null:c.title)&&w.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){N.splice(k,1);break t}}w=x.createElement(h),ai(w,h,c),x.head.appendChild(w);break;case"meta":if(N=Dx("meta","content",x).get(h+(c.content||""))){for(k=0;k<N.length;k++)if(w=N[k],w.getAttribute("content")===(c.content==null?null:""+c.content)&&w.getAttribute("name")===(c.name==null?null:c.name)&&w.getAttribute("property")===(c.property==null?null:c.property)&&w.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&w.getAttribute("charset")===(c.charSet==null?null:c.charSet)){N.splice(k,1);break t}}w=x.createElement(h),ai(w,h,c),x.head.appendChild(w);break;default:throw Error(i(468,h))}w[yn]=s,wn(w),h=w}s.stateNode=h}else kx(x,s.type,s.stateNode);else s.stateNode=Px(x,h,s.memoizedProps);else w!==h?(w===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):w.count--,h===null?kx(x,s.type,s.stateNode):Px(x,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Tg(s,s.memoizedProps,c.memoizedProps)}break;case 27:Yi(o,s),Wi(s),h&512&&(Bn||c===null||Rr(c,c.return)),c!==null&&h&4&&Tg(s,s.memoizedProps,c.memoizedProps);break;case 5:if(Yi(o,s),Wi(s),h&512&&(Bn||c===null||Rr(c,c.return)),s.flags&32){x=s.stateNode;try{kn(x,"")}catch(Fe){Jt(s,s.return,Fe)}}h&4&&s.stateNode!=null&&(x=s.memoizedProps,Tg(s,x,c!==null?c.memoizedProps:x)),h&1024&&(wg=!0);break;case 6:if(Yi(o,s),Wi(s),h&4){if(s.stateNode===null)throw Error(i(162));h=s.memoizedProps,c=s.stateNode;try{c.nodeValue=h}catch(Fe){Jt(s,s.return,Fe)}}break;case 3:if(vf=null,x=ir,ir=_f(o.containerInfo),Yi(o,s),ir=x,Wi(s),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Ou(o.containerInfo)}catch(Fe){Jt(s,s.return,Fe)}wg&&(wg=!1,kT(s));break;case 4:h=ir,ir=_f(s.stateNode.containerInfo),Yi(o,s),Wi(s),ir=h;break;case 12:Yi(o,s),Wi(s);break;case 31:Yi(o,s),Wi(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,nf(s,h)));break;case 13:Yi(o,s),Wi(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(rf=dt()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,nf(s,h)));break;case 22:x=s.memoizedState!==null;var J=c!==null&&c.memoizedState!==null,ae=ro,_e=Bn;if(ro=ae||x,Bn=_e||J,Yi(o,s),Bn=_e,ro=ae,Wi(s),h&8192)e:for(o=s.stateNode,o._visibility=x?o._visibility&-2:o._visibility|1,x&&(c===null||J||ro||Bn||Tl(s)),c=null,o=s;;){if(o.tag===5||o.tag===26){if(c===null){J=c=o;try{if(w=J.stateNode,x)N=w.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{k=J.stateNode;var Ee=J.memoizedProps.style,ce=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;k.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(Fe){Jt(J,J.return,Fe)}}}else if(o.tag===6){if(c===null){J=o;try{J.stateNode.nodeValue=x?"":J.memoizedProps}catch(Fe){Jt(J,J.return,Fe)}}}else if(o.tag===18){if(c===null){J=o;try{var me=J.stateNode;x?wx(me,!0):wx(J.stateNode,!1)}catch(Fe){Jt(J,J.return,Fe)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=s.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,nf(s,c))));break;case 19:Yi(o,s),Wi(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,nf(s,h)));break;case 30:break;case 21:break;default:Yi(o,s),Wi(s)}}function Wi(s){var o=s.flags;if(o&2){try{for(var c,h=s.return;h!==null;){if(bT(h)){c=h;break}h=h.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var x=c.stateNode,w=xg(s);tf(s,w,x);break;case 5:var N=c.stateNode;c.flags&32&&(kn(N,""),c.flags&=-33);var k=xg(s);tf(s,k,N);break;case 3:case 4:var J=c.stateNode.containerInfo,ae=xg(s);Eg(s,ae,J);break;default:throw Error(i(161))}}catch(_e){Jt(s,s.return,_e)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function kT(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;kT(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function ao(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)CT(s,o.alternate,o),o=o.sibling}function Tl(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:ea(4,o,o.return),Tl(o);break;case 1:Rr(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&wT(o,o.return,c),Tl(o);break;case 27:fd(o.stateNode);case 26:case 5:Rr(o,o.return),Tl(o);break;case 22:o.memoizedState===null&&Tl(o);break;case 30:Tl(o);break;default:Tl(o)}s=s.sibling}}function lo(s,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,x=s,w=o,N=w.flags;switch(w.tag){case 0:case 11:case 15:lo(x,w,c),id(4,w);break;case 1:if(lo(x,w,c),h=w,x=h.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ae){Jt(h,h.return,ae)}if(h=w,x=h.updateQueue,x!==null){var k=h.stateNode;try{var J=x.shared.hiddenCallbacks;if(J!==null)for(x.shared.hiddenCallbacks=null,x=0;x<J.length;x++)d0(J[x],k)}catch(ae){Jt(h,h.return,ae)}}c&&N&64&&ET(w),sd(w,w.return);break;case 27:AT(w);case 26:case 5:lo(x,w,c),c&&h===null&&N&4&&ST(w),sd(w,w.return);break;case 12:lo(x,w,c);break;case 31:lo(x,w,c),c&&N&4&&MT(x,w);break;case 13:lo(x,w,c),c&&N&4&&PT(x,w);break;case 22:w.memoizedState===null&&lo(x,w,c),sd(w,w.return);break;case 30:break;default:lo(x,w,c)}o=o.sibling}}function Sg(s,o){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&Hc(c))}function bg(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Hc(s))}function sr(s,o,c,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)LT(s,o,c,h),o=o.sibling}function LT(s,o,c,h){var x=o.flags;switch(o.tag){case 0:case 11:case 15:sr(s,o,c,h),x&2048&&id(9,o);break;case 1:sr(s,o,c,h);break;case 3:sr(s,o,c,h),x&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Hc(s)));break;case 12:if(x&2048){sr(s,o,c,h),s=o.stateNode;try{var w=o.memoizedProps,N=w.id,k=w.onPostCommit;typeof k=="function"&&k(N,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(J){Jt(o,o.return,J)}}else sr(s,o,c,h);break;case 31:sr(s,o,c,h);break;case 13:sr(s,o,c,h);break;case 23:break;case 22:w=o.stateNode,N=o.alternate,o.memoizedState!==null?w._visibility&2?sr(s,o,c,h):rd(s,o):w._visibility&2?sr(s,o,c,h):(w._visibility|=2,Au(s,o,c,h,(o.subtreeFlags&10256)!==0||!1)),x&2048&&Sg(N,o);break;case 24:sr(s,o,c,h),x&2048&&bg(o.alternate,o);break;default:sr(s,o,c,h)}}function Au(s,o,c,h,x){for(x=x&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var w=s,N=o,k=c,J=h,ae=N.flags;switch(N.tag){case 0:case 11:case 15:Au(w,N,k,J,x),id(8,N);break;case 23:break;case 22:var _e=N.stateNode;N.memoizedState!==null?_e._visibility&2?Au(w,N,k,J,x):rd(w,N):(_e._visibility|=2,Au(w,N,k,J,x)),x&&ae&2048&&Sg(N.alternate,N);break;case 24:Au(w,N,k,J,x),x&&ae&2048&&bg(N.alternate,N);break;default:Au(w,N,k,J,x)}o=o.sibling}}function rd(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=s,h=o,x=h.flags;switch(h.tag){case 22:rd(c,h),x&2048&&Sg(h.alternate,h);break;case 24:rd(c,h),x&2048&&bg(h.alternate,h);break;default:rd(c,h)}o=o.sibling}}var od=8192;function Iu(s,o,c){if(s.subtreeFlags&od)for(s=s.child;s!==null;)VT(s,o,c),s=s.sibling}function VT(s,o,c){switch(s.tag){case 26:Iu(s,o,c),s.flags&od&&s.memoizedState!==null&&m2(c,ir,s.memoizedState,s.memoizedProps);break;case 5:Iu(s,o,c);break;case 3:case 4:var h=ir;ir=_f(s.stateNode.containerInfo),Iu(s,o,c),ir=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=od,od=16777216,Iu(s,o,c),od=h):Iu(s,o,c));break;default:Iu(s,o,c)}}function OT(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function ad(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];ei=h,BT(h,s)}OT(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)UT(s),s=s.sibling}function UT(s){switch(s.tag){case 0:case 11:case 15:ad(s),s.flags&2048&&ea(9,s,s.return);break;case 3:ad(s);break;case 12:ad(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,sf(s)):ad(s);break;default:ad(s)}}function sf(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var h=o[c];ei=h,BT(h,s)}OT(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:ea(8,o,o.return),sf(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,sf(o));break;default:sf(o)}s=s.sibling}}function BT(s,o){for(;ei!==null;){var c=ei;switch(c.tag){case 0:case 11:case 15:ea(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Hc(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,ei=h;else e:for(c=s;ei!==null;){h=ei;var x=h.sibling,w=h.return;if(NT(h),h===c){ei=null;break e}if(x!==null){x.return=w,ei=x;break e}ei=w}}}var NN={getCacheForType:function(s){var o=ri(Vn),c=o.data.get(s);return c===void 0&&(c=s(),o.data.set(s,c)),c},cacheSignal:function(){return ri(Vn).controller.signal}},RN=typeof WeakMap=="function"?WeakMap:Map,Gt=0,rn=null,Et=null,At=0,Zt=0,_s=null,ta=!1,Cu=!1,Ag=!1,uo=0,An=0,na=0,xl=0,Ig=0,ys=0,Nu=0,ld=null,Qi=null,Cg=!1,rf=0,zT=0,of=1/0,af=null,ia=null,Hn=0,sa=null,Ru=null,co=0,Ng=0,Rg=null,FT=null,ud=0,Mg=null;function vs(){return(Gt&2)!==0&&At!==0?At&-At:ie.T!==null?Og():Ga()}function qT(){if(ys===0)if((At&536870912)===0||xt){var s=Li;Li<<=1,(Li&3932160)===0&&(Li=262144),ys=s}else ys=536870912;return s=ps.current,s!==null&&(s.flags|=32),ys}function $i(s,o,c){(s===rn&&(Zt===2||Zt===9)||s.cancelPendingCommit!==null)&&(Mu(s,0),ra(s,At,ys,!1)),Hs(s,c),((Gt&2)===0||s!==rn)&&(s===rn&&((Gt&2)===0&&(xl|=c),An===4&&ra(s,At,ys,!1)),Mr(s))}function GT(s,o,c){if((Gt&6)!==0)throw Error(i(327));var h=!c&&(o&127)===0&&(o&s.expiredLanes)===0||qn(s,o),x=h?DN(s,o):Dg(s,o,!0),w=h;do{if(x===0){Cu&&!h&&ra(s,o,0,!1);break}else{if(c=s.current.alternate,w&&!MN(c)){x=Dg(s,o,!1),w=!1;continue}if(x===2){if(w=o,s.errorRecoveryDisabledLanes&w)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){o=N;e:{var k=s;x=ld;var J=k.current.memoizedState.isDehydrated;if(J&&(Mu(k,N).flags|=256),N=Dg(k,N,!1),N!==2){if(Ag&&!J){k.errorRecoveryDisabledLanes|=w,xl|=w,x=4;break e}w=Qi,Qi=x,w!==null&&(Qi===null?Qi=w:Qi.push.apply(Qi,w))}x=N}if(w=!1,x!==2)continue}}if(x===1){Mu(s,0),ra(s,o,0,!0);break}e:{switch(h=s,w=x,w){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:ra(h,o,ys,!ta);break e;case 2:Qi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(x=rf+300-dt(),10<x)){if(ra(h,o,ys,!ta),Ai(h,0,!0)!==0)break e;co=o,h.timeoutHandle=Tx(HT.bind(null,h,c,Qi,af,Cg,o,ys,xl,Nu,ta,w,"Throttled",-0,0),x);break e}HT(h,c,Qi,af,Cg,o,ys,xl,Nu,ta,w,null,-0,0)}}break}while(!0);Mr(s)}function HT(s,o,c,h,x,w,N,k,J,ae,_e,Ee,ce,me){if(s.timeoutHandle=-1,Ee=o.subtreeFlags,Ee&8192||(Ee&16785408)===16785408){Ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ci},VT(o,w,Ee);var Fe=(w&62914560)===w?rf-dt():(w&4194048)===w?zT-dt():0;if(Fe=p2(Ee,Fe),Fe!==null){co=w,s.cancelPendingCommit=Fe($T.bind(null,s,o,w,c,h,x,N,k,J,_e,Ee,null,ce,me)),ra(s,w,N,!ae);return}}$T(s,o,w,c,h,x,N,k,J)}function MN(s){for(var o=s;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var x=c[h],w=x.getSnapshot;x=x.value;try{if(!$n(w(),x))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ra(s,o,c,h){o&=~Ig,o&=~xl,s.suspendedLanes|=o,s.pingedLanes&=~o,h&&(s.warmLanes|=o),h=s.expirationTimes;for(var x=o;0<x;){var w=31-at(x),N=1<<w;h[w]=-1,x&=~N}c!==0&&qr(s,c,o)}function lf(){return(Gt&6)===0?(cd(0),!1):!0}function Pg(){if(Et!==null){if(Zt===0)var s=Et.return;else s=Et,nr=Nr=null,Jp(s),xu=null,Kc=0,s=Et;for(;s!==null;)xT(s.alternate,s),s=s.return;Et=null}}function Mu(s,o){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,QN(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),co=0,Pg(),rn=s,Et=c=Us(s.current,null),At=o,Zt=0,_s=null,ta=!1,Cu=qn(s,o),Ag=!1,Nu=ys=Ig=xl=na=An=0,Qi=ld=null,Cg=!1,(o&8)!==0&&(o|=o&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=o;0<h;){var x=31-at(h),w=1<<x;o|=s[x],h&=~w}return uo=o,ll(),c}function jT(s,o){ct=null,ie.H=ed,o===Tu||o===Vh?(o=a0(),Zt=3):o===Vp?(o=a0(),Zt=4):Zt=o===cg?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,_s=o,Et===null&&(An=1,Wh(s,d(o,s.current)))}function KT(){var s=ps.current;return s===null?!0:(At&4194048)===At?Bs===null:(At&62914560)===At||(At&536870912)!==0?s===Bs:!1}function ZT(){var s=ie.H;return ie.H=ed,s===null?ed:s}function JT(){var s=ie.A;return ie.A=NN,s}function uf(){An=4,ta||(At&4194048)!==At&&ps.current!==null||(Cu=!0),(na&134217727)===0&&(xl&134217727)===0||rn===null||ra(rn,At,ys,!1)}function Dg(s,o,c){var h=Gt;Gt|=2;var x=ZT(),w=JT();(rn!==s||At!==o)&&(af=null,Mu(s,o)),o=!1;var N=An;e:do try{if(Zt!==0&&Et!==null){var k=Et,J=_s;switch(Zt){case 8:Pg(),N=6;break e;case 3:case 2:case 9:case 6:ps.current===null&&(o=!0);var ae=Zt;if(Zt=0,_s=null,Pu(s,k,J,ae),c&&Cu){N=0;break e}break;default:ae=Zt,Zt=0,_s=null,Pu(s,k,J,ae)}}PN(),N=An;break}catch(_e){jT(s,_e)}while(!0);return o&&s.shellSuspendCounter++,nr=Nr=null,Gt=h,ie.H=x,ie.A=w,Et===null&&(rn=null,At=0,ll()),N}function PN(){for(;Et!==null;)YT(Et)}function DN(s,o){var c=Gt;Gt|=2;var h=ZT(),x=JT();rn!==s||At!==o?(af=null,of=dt()+500,Mu(s,o)):Cu=qn(s,o);e:do try{if(Zt!==0&&Et!==null){o=Et;var w=_s;t:switch(Zt){case 1:Zt=0,_s=null,Pu(s,o,w,1);break;case 2:case 9:if(r0(w)){Zt=0,_s=null,WT(o);break}o=function(){Zt!==2&&Zt!==9||rn!==s||(Zt=7),Mr(s)},w.then(o,o);break e;case 3:Zt=7;break e;case 4:Zt=5;break e;case 7:r0(w)?(Zt=0,_s=null,WT(o)):(Zt=0,_s=null,Pu(s,o,w,7));break;case 5:var N=null;switch(Et.tag){case 26:N=Et.memoizedState;case 5:case 27:var k=Et;if(N?Lx(N):k.stateNode.complete){Zt=0,_s=null;var J=k.sibling;if(J!==null)Et=J;else{var ae=k.return;ae!==null?(Et=ae,cf(ae)):Et=null}break t}}Zt=0,_s=null,Pu(s,o,w,5);break;case 6:Zt=0,_s=null,Pu(s,o,w,6);break;case 8:Pg(),An=6;break e;default:throw Error(i(462))}}kN();break}catch(_e){jT(s,_e)}while(!0);return nr=Nr=null,ie.H=h,ie.A=x,Gt=c,Et!==null?0:(rn=null,At=0,ll(),An)}function kN(){for(;Et!==null&&!Ye();)YT(Et)}function YT(s){var o=vT(s.alternate,s,uo);s.memoizedProps=s.pendingProps,o===null?cf(s):Et=o}function WT(s){var o=s,c=o.alternate;switch(o.tag){case 15:case 0:o=fT(c,o,o.pendingProps,o.type,void 0,At);break;case 11:o=fT(c,o,o.pendingProps,o.type.render,o.ref,At);break;case 5:Jp(o);default:xT(c,o),o=Et=Bc(o,uo),o=vT(c,o,uo)}s.memoizedProps=s.pendingProps,o===null?cf(s):Et=o}function Pu(s,o,c,h){nr=Nr=null,Jp(o),xu=null,Kc=0;var x=o.return;try{if(EN(s,x,o,c,At)){An=1,Wh(s,d(c,s.current)),Et=null;return}}catch(w){if(x!==null)throw Et=x,w;An=1,Wh(s,d(c,s.current)),Et=null;return}o.flags&32768?(xt||h===1?s=!0:Cu||(At&536870912)!==0?s=!1:(ta=s=!0,(h===2||h===9||h===3||h===6)&&(h=ps.current,h!==null&&h.tag===13&&(h.flags|=16384))),QT(o,s)):cf(o)}function cf(s){var o=s;do{if((o.flags&32768)!==0){QT(o,ta);return}s=o.return;var c=bN(o.alternate,o,uo);if(c!==null){Et=c;return}if(o=o.sibling,o!==null){Et=o;return}Et=o=s}while(o!==null);An===0&&(An=5)}function QT(s,o){do{var c=AN(s.alternate,s);if(c!==null){c.flags&=32767,Et=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(s=s.sibling,s!==null)){Et=s;return}Et=s=c}while(s!==null);An=6,Et=null}function $T(s,o,c,h,x,w,N,k,J){s.cancelPendingCommit=null;do df();while(Hn!==0);if((Gt&6)!==0)throw Error(i(327));if(o!==null){if(o===s.current)throw Error(i(177));if(w=o.lanes|o.childLanes,w|=fu,Oc(s,c,w,N,k,J),s===rn&&(Et=rn=null,At=0),Ru=o,sa=s,co=c,Ng=w,Rg=x,FT=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,UN(an,function(){return ix(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=ie.T,ie.T=null,x=be.p,be.p=2,N=Gt,Gt|=4;try{IN(s,o,c)}finally{Gt=N,be.p=x,ie.T=h}}Hn=1,XT(),ex(),tx()}}function XT(){if(Hn===1){Hn=0;var s=sa,o=Ru,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=ie.T,ie.T=null;var h=be.p;be.p=2;var x=Gt;Gt|=4;try{DT(o,s);var w=jg,N=il(s.containerInfo),k=w.focusedElem,J=w.selectionRange;if(N!==k&&k&&k.ownerDocument&&uu(k.ownerDocument.documentElement,k)){if(J!==null&&Er(k)){var ae=J.start,_e=J.end;if(_e===void 0&&(_e=ae),"selectionStart"in k)k.selectionStart=ae,k.selectionEnd=Math.min(_e,k.value.length);else{var Ee=k.ownerDocument||document,ce=Ee&&Ee.defaultView||window;if(ce.getSelection){var me=ce.getSelection(),Fe=k.textContent.length,tt=Math.min(J.start,Fe),tn=J.end===void 0?tt:Math.min(J.end,Fe);!me.extend&&tt>tn&&(N=tn,tn=tt,tt=N);var ee=nl(k,tt),$=nl(k,tn);if(ee&&$&&(me.rangeCount!==1||me.anchorNode!==ee.node||me.anchorOffset!==ee.offset||me.focusNode!==$.node||me.focusOffset!==$.offset)){var oe=Ee.createRange();oe.setStart(ee.node,ee.offset),me.removeAllRanges(),tt>tn?(me.addRange(oe),me.extend($.node,$.offset)):(oe.setEnd($.node,$.offset),me.addRange(oe))}}}}for(Ee=[],me=k;me=me.parentNode;)me.nodeType===1&&Ee.push({element:me,left:me.scrollLeft,top:me.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<Ee.length;k++){var Te=Ee[k];Te.element.scrollLeft=Te.left,Te.element.scrollTop=Te.top}}wf=!!Hg,jg=Hg=null}finally{Gt=x,be.p=h,ie.T=c}}s.current=o,Hn=2}}function ex(){if(Hn===2){Hn=0;var s=sa,o=Ru,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=ie.T,ie.T=null;var h=be.p;be.p=2;var x=Gt;Gt|=4;try{CT(s,o.alternate,o)}finally{Gt=x,be.p=h,ie.T=c}}Hn=3}}function tx(){if(Hn===4||Hn===3){Hn=0,pt();var s=sa,o=Ru,c=co,h=FT;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Hn=5:(Hn=0,Ru=sa=null,nx(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(ia=null),Be(c),o=o.stateNode,Ne&&typeof Ne.onCommitFiberRoot=="function")try{Ne.onCommitFiberRoot(si,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=ie.T,x=be.p,be.p=2,ie.T=null;try{for(var w=s.onRecoverableError,N=0;N<h.length;N++){var k=h[N];w(k.value,{componentStack:k.stack})}}finally{ie.T=o,be.p=x}}(co&3)!==0&&df(),Mr(s),x=s.pendingLanes,(c&261930)!==0&&(x&42)!==0?s===Mg?ud++:(ud=0,Mg=s):ud=0,cd(0)}}function nx(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Hc(o)))}function df(){return XT(),ex(),tx(),ix()}function ix(){if(Hn!==5)return!1;var s=sa,o=Ng;Ng=0;var c=Be(co),h=ie.T,x=be.p;try{be.p=32>c?32:c,ie.T=null,c=Rg,Rg=null;var w=sa,N=co;if(Hn=0,Ru=sa=null,co=0,(Gt&6)!==0)throw Error(i(331));var k=Gt;if(Gt|=4,UT(w.current),LT(w,w.current,N,c),Gt=k,cd(0,!1),Ne&&typeof Ne.onPostCommitFiberRoot=="function")try{Ne.onPostCommitFiberRoot(si,w)}catch{}return!0}finally{be.p=x,ie.T=h,nx(s,o)}}function sx(s,o,c){o=d(c,o),o=ug(s.stateNode,o,2),s=Qo(s,o,2),s!==null&&(Hs(s,2),Mr(s))}function Jt(s,o,c){if(s.tag===3)sx(s,s,c);else for(;o!==null;){if(o.tag===3){sx(o,s,c);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ia===null||!ia.has(h))){s=d(c,s),c=rT(2),h=Qo(o,c,2),h!==null&&(oT(c,h,o,s),Hs(h,2),Mr(h));break}}o=o.return}}function kg(s,o,c){var h=s.pingCache;if(h===null){h=s.pingCache=new RN;var x=new Set;h.set(o,x)}else x=h.get(o),x===void 0&&(x=new Set,h.set(o,x));x.has(c)||(Ag=!0,x.add(c),s=LN.bind(null,s,o,c),o.then(s,s))}function LN(s,o,c){var h=s.pingCache;h!==null&&h.delete(o),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,rn===s&&(At&c)===c&&(An===4||An===3&&(At&62914560)===At&&300>dt()-rf?(Gt&2)===0&&Mu(s,0):Ig|=c,Nu===At&&(Nu=0)),Mr(s)}function rx(s,o){o===0&&(o=eu()),s=Os(s,o),s!==null&&(Hs(s,o),Mr(s))}function VN(s){var o=s.memoizedState,c=0;o!==null&&(c=o.retryLane),rx(s,c)}function ON(s,o){var c=0;switch(s.tag){case 31:case 13:var h=s.stateNode,x=s.memoizedState;x!==null&&(c=x.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(o),rx(s,c)}function UN(s,o){return ve(s,o)}var hf=null,Du=null,Lg=!1,ff=!1,Vg=!1,oa=0;function Mr(s){s!==Du&&s.next===null&&(Du===null?hf=Du=s:Du=Du.next=s),ff=!0,Lg||(Lg=!0,zN())}function cd(s,o){if(!Vg&&ff){Vg=!0;do for(var c=!1,h=hf;h!==null;){if(s!==0){var x=h.pendingLanes;if(x===0)var w=0;else{var N=h.suspendedLanes,k=h.pingedLanes;w=(1<<31-at(42|s)+1)-1,w&=x&~(N&~k),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(c=!0,ux(h,w))}else w=At,w=Ai(h,h===rn?w:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(w&3)===0||qn(h,w)||(c=!0,ux(h,w));h=h.next}while(c);Vg=!1}}function BN(){ox()}function ox(){ff=Lg=!1;var s=0;oa!==0&&WN()&&(s=oa);for(var o=dt(),c=null,h=hf;h!==null;){var x=h.next,w=ax(h,o);w===0?(h.next=null,c===null?hf=x:c.next=x,x===null&&(Du=c)):(c=h,(s!==0||(w&3)!==0)&&(ff=!0)),h=x}Hn!==0&&Hn!==5||cd(s),oa!==0&&(oa=0)}function ax(s,o){for(var c=s.suspendedLanes,h=s.pingedLanes,x=s.expirationTimes,w=s.pendingLanes&-62914561;0<w;){var N=31-at(w),k=1<<N,J=x[N];J===-1?((k&c)===0||(k&h)!==0)&&(x[N]=Vc(k,o)):J<=o&&(s.expiredLanes|=k),w&=~k}if(o=rn,c=At,c=Ai(s,s===o?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,c===0||s===o&&(Zt===2||Zt===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&Ve(h),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||qn(s,c)){if(o=c&-c,o===s.callbackPriority)return o;switch(h!==null&&Ve(h),Be(c)){case 2:case 8:c=ki;break;case 32:c=an;break;case 268435456:c=fr;break;default:c=an}return h=lx.bind(null,s),c=ve(c,h),s.callbackPriority=o,s.callbackNode=c,o}return h!==null&&h!==null&&Ve(h),s.callbackPriority=2,s.callbackNode=null,2}function lx(s,o){if(Hn!==0&&Hn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(df()&&s.callbackNode!==c)return null;var h=At;return h=Ai(s,s===rn?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(GT(s,h,o),ax(s,dt()),s.callbackNode!=null&&s.callbackNode===c?lx.bind(null,s):null)}function ux(s,o){if(df())return null;GT(s,o,!0)}function zN(){$N(function(){(Gt&6)!==0?ve(Si,BN):ox()})}function Og(){if(oa===0){var s=yu;s===0&&(s=Cn,Cn<<=1,(Cn&261888)===0&&(Cn=256)),oa=s}return oa}function cx(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:_r(""+s)}function dx(s,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,s.id&&c.setAttribute("form",s.id),o.parentNode.insertBefore(c,o),s=new FormData(s),c.parentNode.removeChild(c),s}function FN(s,o,c,h,x){if(o==="submit"&&c&&c.stateNode===x){var w=cx((x[En]||null).action),N=h.submitter;N&&(o=(o=N[En]||null)?cx(o.formAction):N.getAttribute("formAction"),o!==null&&(w=o,N=null));var k=new Ds("action","action",null,h,x);s.push({event:k,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(oa!==0){var J=N?dx(x,N):new FormData(x);ig(c,{pending:!0,data:J,method:x.method,action:w},null,J)}}else typeof w=="function"&&(k.preventDefault(),J=N?dx(x,N):new FormData(x),ig(c,{pending:!0,data:J,method:x.method,action:w},w,J))},currentTarget:x}]})}}for(var Ug=0;Ug<br.length;Ug++){var Bg=br[Ug],qN=Bg.toLowerCase(),GN=Bg[0].toUpperCase()+Bg.slice(1);ji(qN,"on"+GN)}ji(rl,"onAnimationEnd"),ji(Rh,"onAnimationIteration"),ji(ol,"onAnimationStart"),ji("dblclick","onDoubleClick"),ji("focusin","onFocus"),ji("focusout","onBlur"),ji(Cp,"onTransitionRun"),ji(Mh,"onTransitionStart"),ji(Np,"onTransitionCancel"),ji(Ko,"onTransitionEnd"),Bi("onMouseEnter",["mouseout","mouseover"]),Bi("onMouseLeave",["mouseout","mouseover"]),Bi("onPointerEnter",["pointerout","pointerover"]),Bi("onPointerLeave",["pointerout","pointerover"]),Cs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Cs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Cs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Cs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Cs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Cs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HN=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(dd));function hx(s,o){o=(o&4)!==0;for(var c=0;c<s.length;c++){var h=s[c],x=h.event;h=h.listeners;e:{var w=void 0;if(o)for(var N=h.length-1;0<=N;N--){var k=h[N],J=k.instance,ae=k.currentTarget;if(k=k.listener,J!==w&&x.isPropagationStopped())break e;w=k,x.currentTarget=ae;try{w(x)}catch(_e){al(_e)}x.currentTarget=null,w=J}else for(N=0;N<h.length;N++){if(k=h[N],J=k.instance,ae=k.currentTarget,k=k.listener,J!==w&&x.isPropagationStopped())break e;w=k,x.currentTarget=ae;try{w(x)}catch(_e){al(_e)}x.currentTarget=null,w=J}}}}function wt(s,o){var c=o[rs];c===void 0&&(c=o[rs]=new Set);var h=s+"__bubble";c.has(h)||(fx(o,s,2,!1),c.add(h))}function zg(s,o,c){var h=0;o&&(h|=4),fx(c,s,h,o)}var mf="_reactListening"+Math.random().toString(36).slice(2);function Fg(s){if(!s[mf]){s[mf]=!0,Ha.forEach(function(c){c!=="selectionchange"&&(HN.has(c)||zg(c,!1,s),zg(c,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[mf]||(o[mf]=!0,zg("selectionchange",!1,o))}}function fx(s,o,c,h){switch(qx(o)){case 2:var x=y2;break;case 8:x=v2;break;default:x=n_}c=x.bind(null,o,c,s),x=void 0,!Js||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),h?x!==void 0?s.addEventListener(o,c,{capture:!0,passive:x}):s.addEventListener(o,c,!0):x!==void 0?s.addEventListener(o,c,{passive:x}):s.addEventListener(o,c,!1)}function qg(s,o,c,h,x){var w=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var N=h.tag;if(N===3||N===4){var k=h.stateNode.containerInfo;if(k===x)break;if(N===4)for(N=h.return;N!==null;){var J=N.tag;if((J===3||J===4)&&N.stateNode.containerInfo===x)return;N=N.return}for(;k!==null;){if(N=os(k),N===null)return;if(J=N.tag,J===5||J===6||J===26||J===27){h=w=N;continue e}k=k.parentNode}}h=h.return}Zs(function(){var ae=w,_e=di(c),Ee=[];e:{var ce=Ph.get(s);if(ce!==void 0){var me=Ds,Fe=s;switch(s){case"keypress":if(vr(c)===0)break e;case"keydown":case"keyup":me=Qa;break;case"focusin":Fe="focus",me=Jr;break;case"focusout":Fe="blur",me=Jr;break;case"beforeblur":case"afterblur":me=Jr;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=Ka;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=su;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=I;break;case rl:case Rh:case ol:me=Vo;break;case Ko:me=U;break;case"scroll":case"scrollend":me=mt;break;case"wheel":me=de;break;case"copy":case"cut":case"paste":me=Ni;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=$s;break;case"toggle":case"beforetoggle":me=it}var tt=(o&4)!==0,tn=!tt&&(s==="scroll"||s==="scrollend"),ee=tt?ce!==null?ce+"Capture":null:ce;tt=[];for(var $=ae,oe;$!==null;){var Te=$;if(oe=Te.stateNode,Te=Te.tag,Te!==5&&Te!==26&&Te!==27||oe===null||ee===null||(Te=Ci($,ee),Te!=null&&tt.push(hd($,Te,oe))),tn)break;$=$.return}0<tt.length&&(ce=new me(ce,Fe,null,c,_e),Ee.push({event:ce,listeners:tt}))}}if((o&7)===0){e:{if(ce=s==="mouseover"||s==="pointerover",me=s==="mouseout"||s==="pointerout",ce&&c!==Lo&&(Fe=c.relatedTarget||c.fromElement)&&(os(Fe)||Fe[ss]))break e;if((me||ce)&&(ce=_e.window===_e?_e:(ce=_e.ownerDocument)?ce.defaultView||ce.parentWindow:window,me?(Fe=c.relatedTarget||c.toElement,me=ae,Fe=Fe?os(Fe):null,Fe!==null&&(tn=a(Fe),tt=Fe.tag,Fe!==tn||tt!==5&&tt!==27&&tt!==6)&&(Fe=null)):(me=null,Fe=ae),me!==Fe)){if(tt=Ka,Te="onMouseLeave",ee="onMouseEnter",$="mouse",(s==="pointerout"||s==="pointerover")&&(tt=$s,Te="onPointerLeave",ee="onPointerEnter",$="pointer"),tn=me==null?ce:Jn(me),oe=Fe==null?ce:Jn(Fe),ce=new tt(Te,$+"leave",me,c,_e),ce.target=tn,ce.relatedTarget=oe,Te=null,os(_e)===ae&&(tt=new tt(ee,$+"enter",Fe,c,_e),tt.target=oe,tt.relatedTarget=tn,Te=tt),tn=Te,me&&Fe)t:{for(tt=jN,ee=me,$=Fe,oe=0,Te=ee;Te;Te=tt(Te))oe++;Te=0;for(var We=$;We;We=tt(We))Te++;for(;0<oe-Te;)ee=tt(ee),oe--;for(;0<Te-oe;)$=tt($),Te--;for(;oe--;){if(ee===$||$!==null&&ee===$.alternate){tt=ee;break t}ee=tt(ee),$=tt($)}tt=null}else tt=null;me!==null&&mx(Ee,ce,me,tt,!1),Fe!==null&&tn!==null&&mx(Ee,tn,Fe,tt,!0)}}e:{if(ce=ae?Jn(ae):window,me=ce.nodeName&&ce.nodeName.toLowerCase(),me==="select"||me==="input"&&ce.type==="file")var Bt=tl;else if(ks(ce))if(bh)Bt=Ip;else{Bt=Ap;var je=Xs}else me=ce.nodeName,!me||me.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?ae&&gr(ae.elementType)&&(Bt=tl):Bt=qo;if(Bt&&(Bt=Bt(s,ae))){Sh(Ee,Bt,c,_e);break e}je&&je(s,ce,ae),s==="focusout"&&ae&&ce.type==="number"&&ae.memoizedProps.value!=null&&as(ce,"number",ce.value)}switch(je=ae?Jn(ae):window,s){case"focusin":(ks(je)||je.contentEditable==="true")&&(wr=je,du=ae,sl=null);break;case"focusout":sl=du=wr=null;break;case"mousedown":Ho=!0;break;case"contextmenu":case"mouseup":case"dragend":Ho=!1,Ch(Ee,c,_e);break;case"selectionchange":if(cu)break;case"keydown":case"keyup":Ch(Ee,c,_e)}var ft;if(Pt)e:{switch(s){case"compositionstart":var It="onCompositionStart";break e;case"compositionend":It="onCompositionEnd";break e;case"compositionupdate":It="onCompositionUpdate";break e}It=void 0}else Bo?Yr(s,c)&&(It="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(It="onCompositionStart");It&&(Hi&&c.locale!=="ko"&&(Bo||It!=="onCompositionStart"?It==="onCompositionEnd"&&Bo&&(ft=ls()):(qi=_e,Ys="value"in qi?qi.value:qi.textContent,Bo=!0)),je=pf(ae,It),0<je.length&&(It=new ds(It,s,null,c,_e),Ee.push({event:It,listeners:je}),ft?It.data=ft:(ft=Wr(c),ft!==null&&(It.data=ft)))),(ft=Gi?ms(s,c):zo(s,c))&&(It=pf(ae,"onBeforeInput"),0<It.length&&(je=new ds("onBeforeInput","beforeinput",null,c,_e),Ee.push({event:je,listeners:It}),je.data=ft)),FN(Ee,s,ae,c,_e)}hx(Ee,o)})}function hd(s,o,c){return{instance:s,listener:o,currentTarget:c}}function pf(s,o){for(var c=o+"Capture",h=[];s!==null;){var x=s,w=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||w===null||(x=Ci(s,c),x!=null&&h.unshift(hd(s,x,w)),x=Ci(s,o),x!=null&&h.push(hd(s,x,w))),s.tag===3)return h;s=s.return}return[]}function jN(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function mx(s,o,c,h,x){for(var w=o._reactName,N=[];c!==null&&c!==h;){var k=c,J=k.alternate,ae=k.stateNode;if(k=k.tag,J!==null&&J===h)break;k!==5&&k!==26&&k!==27||ae===null||(J=ae,x?(ae=Ci(c,w),ae!=null&&N.unshift(hd(c,ae,J))):x||(ae=Ci(c,w),ae!=null&&N.push(hd(c,ae,J)))),c=c.return}N.length!==0&&s.push({event:o,listeners:N})}var KN=/\r\n?/g,ZN=/\u0000|\uFFFD/g;function px(s){return(typeof s=="string"?s:""+s).replace(KN,`
`).replace(ZN,"")}function gx(s,o){return o=px(o),px(s)===o}function en(s,o,c,h,x,w){switch(c){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||kn(s,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&kn(s,""+h);break;case"className":Tt(s,"class",h);break;case"tabIndex":Tt(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Tt(s,c,h);break;case"style":jr(s,h,w);break;case"data":if(o!=="object"){Tt(s,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||c!=="href")){s.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=_r(""+h),s.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(c==="formAction"?(o!=="input"&&en(s,o,"name",x.name,x,null),en(s,o,"formEncType",x.formEncType,x,null),en(s,o,"formMethod",x.formMethod,x,null),en(s,o,"formTarget",x.formTarget,x,null)):(en(s,o,"encType",x.encType,x,null),en(s,o,"method",x.method,x,null),en(s,o,"target",x.target,x,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=_r(""+h),s.setAttribute(c,h);break;case"onClick":h!=null&&(s.onclick=ci);break;case"onScroll":h!=null&&wt("scroll",s);break;case"onScrollEnd":h!=null&&wt("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(x.children!=null)throw Error(i(60));s.innerHTML=c}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}c=_r(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""+h):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":h===!0?s.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,h):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(c,h):s.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(c):s.setAttribute(c,h);break;case"popover":wt("beforetoggle",s),wt("toggle",s),gt(s,"popover",h);break;case"xlinkActuate":cn(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":cn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":cn(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":cn(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":cn(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":cn(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":cn(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":cn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":cn(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":gt(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Kr.get(c)||c,gt(s,c,h))}}function Gg(s,o,c,h,x,w){switch(c){case"style":jr(s,h,w);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(c=h.__html,c!=null){if(x.children!=null)throw Error(i(60));s.innerHTML=c}}break;case"children":typeof h=="string"?kn(s,h):(typeof h=="number"||typeof h=="bigint")&&kn(s,""+h);break;case"onScroll":h!=null&&wt("scroll",s);break;case"onScrollEnd":h!=null&&wt("scrollend",s);break;case"onClick":h!=null&&(s.onclick=ci);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ja.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(x=c.endsWith("Capture"),o=c.slice(2,x?c.length-7:void 0),w=s[En]||null,w=w!=null?w[c]:null,typeof w=="function"&&s.removeEventListener(o,w,x),typeof h=="function")){typeof w!="function"&&w!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(o,h,x);break e}c in s?s[c]=h:h===!0?s.setAttribute(c,""):gt(s,c,h)}}}function ai(s,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wt("error",s),wt("load",s);var h=!1,x=!1,w;for(w in c)if(c.hasOwnProperty(w)){var N=c[w];if(N!=null)switch(w){case"src":h=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:en(s,o,w,N,c,null)}}x&&en(s,o,"srcSet",c.srcSet,c,null),h&&en(s,o,"src",c.src,c,null);return;case"input":wt("invalid",s);var k=w=N=x=null,J=null,ae=null;for(h in c)if(c.hasOwnProperty(h)){var _e=c[h];if(_e!=null)switch(h){case"name":x=_e;break;case"type":N=_e;break;case"checked":J=_e;break;case"defaultChecked":ae=_e;break;case"value":w=_e;break;case"defaultValue":k=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(i(137,o));break;default:en(s,o,h,_e,c,null)}}Hr(s,w,k,J,ae,N,x,!1);return;case"select":wt("invalid",s),h=N=w=null;for(x in c)if(c.hasOwnProperty(x)&&(k=c[x],k!=null))switch(x){case"value":w=k;break;case"defaultValue":N=k;break;case"multiple":h=k;default:en(s,o,x,k,c,null)}o=w,c=N,s.multiple=!!h,o!=null?Kt(s,!!h,o,!1):c!=null&&Kt(s,!!h,c,!0);return;case"textarea":wt("invalid",s),w=x=h=null;for(N in c)if(c.hasOwnProperty(N)&&(k=c[N],k!=null))switch(N){case"value":h=k;break;case"defaultValue":x=k;break;case"children":w=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(i(91));break;default:en(s,o,N,k,c,null)}Fi(s,h,x,w);return;case"option":for(J in c)if(c.hasOwnProperty(J)&&(h=c[J],h!=null))switch(J){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:en(s,o,J,h,c,null)}return;case"dialog":wt("beforetoggle",s),wt("toggle",s),wt("cancel",s),wt("close",s);break;case"iframe":case"object":wt("load",s);break;case"video":case"audio":for(h=0;h<dd.length;h++)wt(dd[h],s);break;case"image":wt("error",s),wt("load",s);break;case"details":wt("toggle",s);break;case"embed":case"source":case"link":wt("error",s),wt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ae in c)if(c.hasOwnProperty(ae)&&(h=c[ae],h!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:en(s,o,ae,h,c,null)}return;default:if(gr(o)){for(_e in c)c.hasOwnProperty(_e)&&(h=c[_e],h!==void 0&&Gg(s,o,_e,h,c,void 0));return}}for(k in c)c.hasOwnProperty(k)&&(h=c[k],h!=null&&en(s,o,k,h,c,null))}function JN(s,o,c,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,w=null,N=null,k=null,J=null,ae=null,_e=null;for(me in c){var Ee=c[me];if(c.hasOwnProperty(me)&&Ee!=null)switch(me){case"checked":break;case"value":break;case"defaultValue":J=Ee;default:h.hasOwnProperty(me)||en(s,o,me,null,h,Ee)}}for(var ce in h){var me=h[ce];if(Ee=c[ce],h.hasOwnProperty(ce)&&(me!=null||Ee!=null))switch(ce){case"type":w=me;break;case"name":x=me;break;case"checked":ae=me;break;case"defaultChecked":_e=me;break;case"value":N=me;break;case"defaultValue":k=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,o));break;default:me!==Ee&&en(s,o,ce,me,h,Ee)}}Do(s,N,k,J,ae,_e,w,x);return;case"select":me=N=k=ce=null;for(w in c)if(J=c[w],c.hasOwnProperty(w)&&J!=null)switch(w){case"value":break;case"multiple":me=J;default:h.hasOwnProperty(w)||en(s,o,w,null,h,J)}for(x in h)if(w=h[x],J=c[x],h.hasOwnProperty(x)&&(w!=null||J!=null))switch(x){case"value":ce=w;break;case"defaultValue":k=w;break;case"multiple":N=w;default:w!==J&&en(s,o,x,w,h,J)}o=k,c=N,h=me,ce!=null?Kt(s,!!c,ce,!1):!!h!=!!c&&(o!=null?Kt(s,!!c,o,!0):Kt(s,!!c,c?[]:"",!1));return;case"textarea":me=ce=null;for(k in c)if(x=c[k],c.hasOwnProperty(k)&&x!=null&&!h.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:en(s,o,k,null,h,x)}for(N in h)if(x=h[N],w=c[N],h.hasOwnProperty(N)&&(x!=null||w!=null))switch(N){case"value":ce=x;break;case"defaultValue":me=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(i(91));break;default:x!==w&&en(s,o,N,x,h,w)}Rs(s,ce,me);return;case"option":for(var Fe in c)if(ce=c[Fe],c.hasOwnProperty(Fe)&&ce!=null&&!h.hasOwnProperty(Fe))switch(Fe){case"selected":s.selected=!1;break;default:en(s,o,Fe,null,h,ce)}for(J in h)if(ce=h[J],me=c[J],h.hasOwnProperty(J)&&ce!==me&&(ce!=null||me!=null))switch(J){case"selected":s.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:en(s,o,J,ce,h,me)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var tt in c)ce=c[tt],c.hasOwnProperty(tt)&&ce!=null&&!h.hasOwnProperty(tt)&&en(s,o,tt,null,h,ce);for(ae in h)if(ce=h[ae],me=c[ae],h.hasOwnProperty(ae)&&ce!==me&&(ce!=null||me!=null))switch(ae){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,o));break;default:en(s,o,ae,ce,h,me)}return;default:if(gr(o)){for(var tn in c)ce=c[tn],c.hasOwnProperty(tn)&&ce!==void 0&&!h.hasOwnProperty(tn)&&Gg(s,o,tn,void 0,h,ce);for(_e in h)ce=h[_e],me=c[_e],!h.hasOwnProperty(_e)||ce===me||ce===void 0&&me===void 0||Gg(s,o,_e,ce,h,me);return}}for(var ee in c)ce=c[ee],c.hasOwnProperty(ee)&&ce!=null&&!h.hasOwnProperty(ee)&&en(s,o,ee,null,h,ce);for(Ee in h)ce=h[Ee],me=c[Ee],!h.hasOwnProperty(Ee)||ce===me||ce==null&&me==null||en(s,o,Ee,ce,h,me)}function _x(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function YN(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var x=c[h],w=x.transferSize,N=x.initiatorType,k=x.duration;if(w&&k&&_x(N)){for(N=0,k=x.responseEnd,h+=1;h<c.length;h++){var J=c[h],ae=J.startTime;if(ae>k)break;var _e=J.transferSize,Ee=J.initiatorType;_e&&_x(Ee)&&(J=J.responseEnd,N+=_e*(J<k?1:(k-ae)/(J-ae)))}if(--h,o+=8*(w+N)/(x.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Hg=null,jg=null;function gf(s){return s.nodeType===9?s:s.ownerDocument}function yx(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vx(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Kg(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Zg=null;function WN(){var s=window.event;return s&&s.type==="popstate"?s===Zg?!1:(Zg=s,!0):(Zg=null,!1)}var Tx=typeof setTimeout=="function"?setTimeout:void 0,QN=typeof clearTimeout=="function"?clearTimeout:void 0,xx=typeof Promise=="function"?Promise:void 0,$N=typeof queueMicrotask=="function"?queueMicrotask:typeof xx<"u"?function(s){return xx.resolve(null).then(s).catch(XN)}:Tx;function XN(s){setTimeout(function(){throw s})}function aa(s){return s==="head"}function Ex(s,o){var c=o,h=0;do{var x=c.nextSibling;if(s.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"||c==="/&"){if(h===0){s.removeChild(x),Ou(o);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")fd(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,fd(c);for(var w=c.firstChild;w;){var N=w.nextSibling,k=w.nodeName;w[As]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&w.rel.toLowerCase()==="stylesheet"||c.removeChild(w),w=N}}else c==="body"&&fd(s.ownerDocument.body);c=x}while(c);Ou(o)}function wx(s,o){var c=s;s=0;do{var h=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=h}while(c)}function Jg(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Jg(c),Ro(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function e2(s,o,c,h){for(;s.nodeType===1;){var x=c;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[As])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(w=s.getAttribute("rel"),w==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(w!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(w=s.getAttribute("src"),(w!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&w&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var w=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===w)return s}else return s;if(s=zs(s.nextSibling),s===null)break}return null}function t2(s,o,c){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=zs(s.nextSibling),s===null))return null;return s}function Sx(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=zs(s.nextSibling),s===null))return null;return s}function Yg(s){return s.data==="$?"||s.data==="$~"}function Wg(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function n2(s,o){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||c.readyState!=="loading")o();else{var h=function(){o(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function zs(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var Qg=null;function bx(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(o===0)return zs(s.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}s=s.nextSibling}return null}function Ax(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return s;o--}else c!=="/$"&&c!=="/&"||o++}s=s.previousSibling}return null}function Ix(s,o,c){switch(o=gf(c),s){case"html":if(s=o.documentElement,!s)throw Error(i(452));return s;case"head":if(s=o.head,!s)throw Error(i(453));return s;case"body":if(s=o.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function fd(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);Ro(s)}var Fs=new Map,Cx=new Set;function _f(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ho=be.d;be.d={f:i2,r:s2,D:r2,C:o2,L:a2,m:l2,X:c2,S:u2,M:d2};function i2(){var s=ho.f(),o=lf();return s||o}function s2(s){var o=Ui(s);o!==null&&o.tag===5&&o.type==="form"?j0(o):ho.r(s)}var ku=typeof document>"u"?null:document;function Nx(s,o,c){var h=ku;if(h&&typeof o=="string"&&o){var x=nn(o);x='link[rel="'+s+'"][href="'+x+'"]',typeof c=="string"&&(x+='[crossorigin="'+c+'"]'),Cx.has(x)||(Cx.add(x),s={rel:s,crossOrigin:c,href:o},h.querySelector(x)===null&&(o=h.createElement("link"),ai(o,"link",s),wn(o),h.head.appendChild(o)))}}function r2(s){ho.D(s),Nx("dns-prefetch",s,null)}function o2(s,o){ho.C(s,o),Nx("preconnect",s,o)}function a2(s,o,c){ho.L(s,o,c);var h=ku;if(h&&s&&o){var x='link[rel="preload"][as="'+nn(o)+'"]';o==="image"&&c&&c.imageSrcSet?(x+='[imagesrcset="'+nn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(x+='[imagesizes="'+nn(c.imageSizes)+'"]')):x+='[href="'+nn(s)+'"]';var w=x;switch(o){case"style":w=Lu(s);break;case"script":w=Vu(s)}Fs.has(w)||(s=S({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:s,as:o},c),Fs.set(w,s),h.querySelector(x)!==null||o==="style"&&h.querySelector(md(w))||o==="script"&&h.querySelector(pd(w))||(o=h.createElement("link"),ai(o,"link",s),wn(o),h.head.appendChild(o)))}}function l2(s,o){ho.m(s,o);var c=ku;if(c&&s){var h=o&&typeof o.as=="string"?o.as:"script",x='link[rel="modulepreload"][as="'+nn(h)+'"][href="'+nn(s)+'"]',w=x;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Vu(s)}if(!Fs.has(w)&&(s=S({rel:"modulepreload",href:s},o),Fs.set(w,s),c.querySelector(x)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(pd(w)))return}h=c.createElement("link"),ai(h,"link",s),wn(h),c.head.appendChild(h)}}}function u2(s,o,c){ho.S(s,o,c);var h=ku;if(h&&s){var x=Is(h).hoistableStyles,w=Lu(s);o=o||"default";var N=x.get(w);if(!N){var k={loading:0,preload:null};if(N=h.querySelector(md(w)))k.loading=5;else{s=S({rel:"stylesheet",href:s,"data-precedence":o},c),(c=Fs.get(w))&&$g(s,c);var J=N=h.createElement("link");wn(J),ai(J,"link",s),J._p=new Promise(function(ae,_e){J.onload=ae,J.onerror=_e}),J.addEventListener("load",function(){k.loading|=1}),J.addEventListener("error",function(){k.loading|=2}),k.loading|=4,yf(N,o,h)}N={type:"stylesheet",instance:N,count:1,state:k},x.set(w,N)}}}function c2(s,o){ho.X(s,o);var c=ku;if(c&&s){var h=Is(c).hoistableScripts,x=Vu(s),w=h.get(x);w||(w=c.querySelector(pd(x)),w||(s=S({src:s,async:!0},o),(o=Fs.get(x))&&Xg(s,o),w=c.createElement("script"),wn(w),ai(w,"link",s),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(x,w))}}function d2(s,o){ho.M(s,o);var c=ku;if(c&&s){var h=Is(c).hoistableScripts,x=Vu(s),w=h.get(x);w||(w=c.querySelector(pd(x)),w||(s=S({src:s,async:!0,type:"module"},o),(o=Fs.get(x))&&Xg(s,o),w=c.createElement("script"),wn(w),ai(w,"link",s),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(x,w))}}function Rx(s,o,c,h){var x=(x=Ae.current)?_f(x):null;if(!x)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=Lu(c.href),c=Is(x).hoistableStyles,h=c.get(o),h||(h={type:"style",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=Lu(c.href);var w=Is(x).hoistableStyles,N=w.get(s);if(N||(x=x.ownerDocument||x,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(s,N),(w=x.querySelector(md(s)))&&!w._p&&(N.instance=w,N.state.loading=5),Fs.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Fs.set(s,c),w||h2(x,s,c,N.state))),o&&h===null)throw Error(i(528,""));return N}if(o&&h!==null)throw Error(i(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Vu(c),c=Is(x).hoistableScripts,h=c.get(o),h||(h={type:"script",instance:null,count:0,state:null},c.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Lu(s){return'href="'+nn(s)+'"'}function md(s){return'link[rel="stylesheet"]['+s+"]"}function Mx(s){return S({},s,{"data-precedence":s.precedence,precedence:null})}function h2(s,o,c,h){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=s.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),ai(o,"link",c),wn(o),s.head.appendChild(o))}function Vu(s){return'[src="'+nn(s)+'"]'}function pd(s){return"script[async]"+s}function Px(s,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var h=s.querySelector('style[data-href~="'+nn(c.href)+'"]');if(h)return o.instance=h,wn(h),h;var x=S({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),wn(h),ai(h,"style",x),yf(h,c.precedence,s),o.instance=h;case"stylesheet":x=Lu(c.href);var w=s.querySelector(md(x));if(w)return o.state.loading|=4,o.instance=w,wn(w),w;h=Mx(c),(x=Fs.get(x))&&$g(h,x),w=(s.ownerDocument||s).createElement("link"),wn(w);var N=w;return N._p=new Promise(function(k,J){N.onload=k,N.onerror=J}),ai(w,"link",h),o.state.loading|=4,yf(w,c.precedence,s),o.instance=w;case"script":return w=Vu(c.src),(x=s.querySelector(pd(w)))?(o.instance=x,wn(x),x):(h=c,(x=Fs.get(w))&&(h=S({},c),Xg(h,x)),s=s.ownerDocument||s,x=s.createElement("script"),wn(x),ai(x,"link",h),s.head.appendChild(x),o.instance=x);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,yf(h,c.precedence,s));return o.instance}function yf(s,o,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=h.length?h[h.length-1]:null,w=x,N=0;N<h.length;N++){var k=h[N];if(k.dataset.precedence===o)w=k;else if(w!==x)break}w?w.parentNode.insertBefore(s,w.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(s,o.firstChild))}function $g(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function Xg(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var vf=null;function Dx(s,o,c){if(vf===null){var h=new Map,x=vf=new Map;x.set(c,h)}else x=vf,h=x.get(c),h||(h=new Map,x.set(c,h));if(h.has(s))return h;for(h.set(s,null),c=c.getElementsByTagName(s),x=0;x<c.length;x++){var w=c[x];if(!(w[As]||w[yn]||s==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var N=w.getAttribute(o)||"";N=s+N;var k=h.get(N);k?k.push(w):h.set(N,[w])}}return h}function kx(s,o,c){s=s.ownerDocument||s,s.head.insertBefore(c,o==="title"?s.querySelector("head > title"):null)}function f2(s,o,c){if(c===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Lx(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function m2(s,o,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var x=Lu(h.href),w=o.querySelector(md(x));if(w){o=w._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=Tf.bind(s),o.then(s,s)),c.state.loading|=4,c.instance=w,wn(w);return}w=o.ownerDocument||o,h=Mx(h),(x=Fs.get(x))&&$g(h,x),w=w.createElement("link"),wn(w);var N=w;N._p=new Promise(function(k,J){N.onload=k,N.onerror=J}),ai(w,"link",h),c.instance=w}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=Tf.bind(s),o.addEventListener("load",c),o.addEventListener("error",c))}}var e_=0;function p2(s,o){return s.stylesheets&&s.count===0&&Ef(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var h=setTimeout(function(){if(s.stylesheets&&Ef(s,s.stylesheets),s.unsuspend){var w=s.unsuspend;s.unsuspend=null,w()}},6e4+o);0<s.imgBytes&&e_===0&&(e_=62500*YN());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Ef(s,s.stylesheets),s.unsuspend)){var w=s.unsuspend;s.unsuspend=null,w()}},(s.imgBytes>e_?50:800)+o);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(x)}}:null}function Tf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ef(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var xf=null;function Ef(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,xf=new Map,o.forEach(g2,s),xf=null,Tf.call(s))}function g2(s,o){if(!(o.state.loading&4)){var c=xf.get(s);if(c)var h=c.get(null);else{c=new Map,xf.set(s,c);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<x.length;w++){var N=x[w];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(c.set(N.dataset.precedence,N),h=N)}h&&c.set(null,h)}x=o.instance,N=x.getAttribute("data-precedence"),w=c.get(N)||h,w===h&&c.set(null,x),c.set(N,x),this.count++,h=Tf.bind(this),x.addEventListener("load",h),x.addEventListener("error",h),w?w.parentNode.insertBefore(x,w.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),o.state.loading|=4}}var gd={$$typeof:Q,Provider:null,Consumer:null,_currentValue:Se,_currentValue2:Se,_threadCount:0};function _2(s,o,c,h,x,w,N,k,J){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=bs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bs(0),this.hiddenUpdates=bs(null),this.identifierPrefix=h,this.onUncaughtError=x,this.onCaughtError=w,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=J,this.incompleteTransitions=new Map}function Vx(s,o,c,h,x,w,N,k,J,ae,_e,Ee){return s=new _2(s,o,c,N,J,ae,_e,Ee,k),o=1,w===!0&&(o|=24),w=pi(3,null,null,o),s.current=w,w.stateNode=s,o=Dp(),o.refCount++,s.pooledCache=o,o.refCount++,w.memoizedState={element:h,isDehydrated:c,cache:o},Op(w),s}function Ox(s){return s?(s=Qr,s):Qr}function Ux(s,o,c,h,x,w){x=Ox(x),h.context===null?h.context=x:h.pendingContext=x,h=Wo(o),h.payload={element:c},w=w===void 0?null:w,w!==null&&(h.callback=w),c=Qo(s,h,o),c!==null&&($i(c,s,o),Jc(c,s,o))}function Bx(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<o?c:o}}function t_(s,o){Bx(s,o),(s=s.alternate)&&Bx(s,o)}function zx(s){if(s.tag===13||s.tag===31){var o=Os(s,67108864);o!==null&&$i(o,s,67108864),t_(s,67108864)}}function Fx(s){if(s.tag===13||s.tag===31){var o=vs();o=Zn(o);var c=Os(s,o);c!==null&&$i(c,s,o),t_(s,o)}}var wf=!0;function y2(s,o,c,h){var x=ie.T;ie.T=null;var w=be.p;try{be.p=2,n_(s,o,c,h)}finally{be.p=w,ie.T=x}}function v2(s,o,c,h){var x=ie.T;ie.T=null;var w=be.p;try{be.p=8,n_(s,o,c,h)}finally{be.p=w,ie.T=x}}function n_(s,o,c,h){if(wf){var x=i_(h);if(x===null)qg(s,o,h,Sf,c),Gx(s,h);else if(x2(x,s,o,c,h))h.stopPropagation();else if(Gx(s,h),o&4&&-1<T2.indexOf(s)){for(;x!==null;){var w=Ui(x);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var N=bi(w.pendingLanes);if(N!==0){var k=w;for(k.pendingLanes|=2,k.entangledLanes|=2;N;){var J=1<<31-at(N);k.entanglements[1]|=J,N&=~J}Mr(w),(Gt&6)===0&&(of=dt()+500,cd(0))}}break;case 31:case 13:k=Os(w,2),k!==null&&$i(k,w,2),lf(),t_(w,2)}if(w=i_(h),w===null&&qg(s,o,h,Sf,c),w===x)break;x=w}x!==null&&h.stopPropagation()}else qg(s,o,h,null,c)}}function i_(s){return s=di(s),s_(s)}var Sf=null;function s_(s){if(Sf=null,s=os(s),s!==null){var o=a(s);if(o===null)s=null;else{var c=o.tag;if(c===13){if(s=u(o),s!==null)return s;s=null}else if(c===31){if(s=f(o),s!==null)return s;s=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Sf=s,null}function qx(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xn()){case Si:return 2;case ki:return 8;case an:case ns:return 32;case fr:return 268435456;default:return 32}default:return 32}}var r_=!1,la=null,ua=null,ca=null,_d=new Map,yd=new Map,da=[],T2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Gx(s,o){switch(s){case"focusin":case"focusout":la=null;break;case"dragenter":case"dragleave":ua=null;break;case"mouseover":case"mouseout":ca=null;break;case"pointerover":case"pointerout":_d.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":yd.delete(o.pointerId)}}function vd(s,o,c,h,x,w){return s===null||s.nativeEvent!==w?(s={blockedOn:o,domEventName:c,eventSystemFlags:h,nativeEvent:w,targetContainers:[x]},o!==null&&(o=Ui(o),o!==null&&zx(o)),s):(s.eventSystemFlags|=h,o=s.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),s)}function x2(s,o,c,h,x){switch(o){case"focusin":return la=vd(la,s,o,c,h,x),!0;case"dragenter":return ua=vd(ua,s,o,c,h,x),!0;case"mouseover":return ca=vd(ca,s,o,c,h,x),!0;case"pointerover":var w=x.pointerId;return _d.set(w,vd(_d.get(w)||null,s,o,c,h,x)),!0;case"gotpointercapture":return w=x.pointerId,yd.set(w,vd(yd.get(w)||null,s,o,c,h,x)),!0}return!1}function Hx(s){var o=os(s.target);if(o!==null){var c=a(o);if(c!==null){if(o=c.tag,o===13){if(o=u(c),o!==null){s.blockedOn=o,Vi(s.priority,function(){Fx(c)});return}}else if(o===31){if(o=f(c),o!==null){s.blockedOn=o,Vi(s.priority,function(){Fx(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function bf(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var c=i_(s.nativeEvent);if(c===null){c=s.nativeEvent;var h=new c.constructor(c.type,c);Lo=h,c.target.dispatchEvent(h),Lo=null}else return o=Ui(c),o!==null&&zx(o),s.blockedOn=c,!1;o.shift()}return!0}function jx(s,o,c){bf(s)&&c.delete(o)}function E2(){r_=!1,la!==null&&bf(la)&&(la=null),ua!==null&&bf(ua)&&(ua=null),ca!==null&&bf(ca)&&(ca=null),_d.forEach(jx),yd.forEach(jx)}function Af(s,o){s.blockedOn===o&&(s.blockedOn=null,r_||(r_=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,E2)))}var If=null;function Kx(s){If!==s&&(If=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){If===s&&(If=null);for(var o=0;o<s.length;o+=3){var c=s[o],h=s[o+1],x=s[o+2];if(typeof h!="function"){if(s_(h||c)===null)continue;break}var w=Ui(c);w!==null&&(s.splice(o,3),o-=3,ig(w,{pending:!0,data:x,method:c.method,action:h},h,x))}}))}function Ou(s){function o(J){return Af(J,s)}la!==null&&Af(la,s),ua!==null&&Af(ua,s),ca!==null&&Af(ca,s),_d.forEach(o),yd.forEach(o);for(var c=0;c<da.length;c++){var h=da[c];h.blockedOn===s&&(h.blockedOn=null)}for(;0<da.length&&(c=da[0],c.blockedOn===null);)Hx(c),c.blockedOn===null&&da.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var x=c[h],w=c[h+1],N=x[En]||null;if(typeof w=="function")N||Kx(c);else if(N){var k=null;if(w&&w.hasAttribute("formAction")){if(x=w,N=w[En]||null)k=N.formAction;else if(s_(x)!==null)continue}else k=N.action;typeof k=="function"?c[h+1]=k:(c.splice(h,3),h-=3),Kx(c)}}}function Zx(){function s(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(N){return x=N})},focusReset:"manual",scroll:"manual"})}function o(){x!==null&&(x(),x=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),x!==null&&(x(),x=null)}}}function o_(s){this._internalRoot=s}Cf.prototype.render=o_.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(i(409));var c=o.current,h=vs();Ux(c,h,s,o,null,null)},Cf.prototype.unmount=o_.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;Ux(s.current,2,null,s,null,null),lf(),o[ss]=null}};function Cf(s){this._internalRoot=s}Cf.prototype.unstable_scheduleHydration=function(s){if(s){var o=Ga();s={blockedOn:null,target:s,priority:o};for(var c=0;c<da.length&&o!==0&&o<da[c].priority;c++);da.splice(c,0,s),c===0&&Hx(s)}};var Jx=e.version;if(Jx!=="19.2.0")throw Error(i(527,Jx,"19.2.0"));be.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=p(o),s=s!==null?E(s):null,s=s===null?null:s.stateNode,s};var w2={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nf.isDisabled&&Nf.supportsFiber)try{si=Nf.inject(w2),Ne=Nf}catch{}}return xd.createRoot=function(s,o){if(!r(s))throw Error(i(299));var c=!1,h="",x=tT,w=nT,N=iT;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError)),o=Vx(s,1,!1,null,null,c,h,null,x,w,N,Zx),s[ss]=o.current,Fg(s),new o_(o)},xd.hydrateRoot=function(s,o,c){if(!r(s))throw Error(i(299));var h=!1,x="",w=tT,N=nT,k=iT,J=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(w=c.onUncaughtError),c.onCaughtError!==void 0&&(N=c.onCaughtError),c.onRecoverableError!==void 0&&(k=c.onRecoverableError),c.formState!==void 0&&(J=c.formState)),o=Vx(s,1,!0,o,c??null,h,x,J,w,N,k,Zx),o.context=Ox(null),c=o.current,h=vs(),h=Zn(h),x=Wo(h),x.callback=null,Qo(c,x,h),c=h,o.current.lanes=c,Hs(o,c),Mr(o),s[ss]=o.current,Fg(s),new Cf(o)},xd.version="19.2.0",xd}var sE;function P2(){if(sE)return u_.exports;sE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),u_.exports=M2(),u_.exports}var D2=P2();const k2=Cy(D2);var st=(n=>(n.HOME="HOME",n.ADD_TRIP="ADD_TRIP",n.TRIP_DETAILS="TRIP_DETAILS",n.SETTINGS="SETTINGS",n.MAGIC_EDITOR="MAGIC_EDITOR",n.AI_PLANNER="AI_PLANNER",n.TOOLS="TOOLS",n.TRIP_MEMORY="TRIP_MEMORY",n))(st||{});const L2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),Om=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),wa=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"})}),ic=({className:n})=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})]}),R_=({className:n})=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})]}),ts=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})}),M_=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})}),V2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),zb=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:v.jsx("path",{d:"M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5Z"})}),Fb=({className:n})=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"})]}),qb=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"})}),Gb=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 9.75a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 0 1 .778-.332 48.294 48.294 0 0 0 5.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})}),O2=({className:n})=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:[v.jsx("path",{d:"M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.85 7h10.29l1.08 3.11H5.77L6.85 7zM19 17H5v-5h14v5z"}),v.jsx("circle",{cx:"7.5",cy:"14.5",r:"1.5"}),v.jsx("circle",{cx:"16.5",cy:"14.5",r:"1.5"})]}),rE=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"})}),Ry=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z"})}),Ra=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),U2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"})}),B2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),z2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 0 1-2.25 2.25M16.5 7.5V18a2.25 2.25 0 0 0 2.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 0 0 2.25 2.25h13.5M6 7.5h3v3H6v-3Z"})}),P_=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-1.94c.955-.13 1.93-.32 2.795-.591 3.615-1.133 4.705-4.884 2.636-7.962-1.373-2.042-3.738-3.257-6.236-3.257-4.14 0-7.5 3.36-7.5 7.5 0 2.053.84 3.942 2.22 5.297.808.796 1.83 1.344 2.923 1.564V18m2.25 0h-4.5m4.5 0a2.25 2.25 0 0 1-2.25 2.25h-1.5A2.25 2.25 0 0 1 7.5 18m9-9h.008v.008H16.5V9Zm-4.5 0h.008v.008H12V9Zm-4.5 0h.008v.008H7.5V9Z"})}),F2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h3.375c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125h-3.375c-.621 0-1.125-.504-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125Zm-3 7.5h10.5a.75.75 0 0 1 .75.75v3.375a3 3 0 0 1-3 3h-6a3 3 0 0 1-3-3V10.5a.75.75 0 0 1 .75-.75Zm9.375 12a1.125 1.125 0 1 0 0-2.25 1.125 1.125 0 0 0 0 2.25Z"})}),q2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"})}),Hb=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 17.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),G2=({className:n})=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 0 1 1.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.559.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.894.149c-.424.07-.764.383-.929.78-.165.398-.143.854.107 1.204l-.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 0 1-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 0 1-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 0 1 .12-1.45l.773-.773a1.125 1.125 0 0 1 1.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894Z"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),H2=({className:n})=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}),v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),j2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"})}),jb=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),Kb=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 01-1.12-1.243l1.264-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.119 1.007zM8.625 10.5a.375.375 0 11-.75 0 .375.375 0 01.75 0zm7.5 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})}),K2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 016-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 01-3.827-5.802"})}),Z2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})}),oE=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0 1 18 16.5h-2.25m-7.5 0h7.5m-7.5 0-1 3m8.5-3 1 3m0 0 .5 1.5m-.5-1.5h-9.5m0 0-.5 1.5M9 11.25v1.5M12 9v3m3-3v3M9 3.75V5.25m3-1.5h3m-3 0v1.5m0-1.5h-3m3 0v1.5M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})}),J2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:v.jsx("path",{d:"M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4S4 2.5 4 6v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z"})}),Y2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:v.jsx("path",{d:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"})}),W2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),Q2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})}),$2=({className:n})=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})}),on={"zh-TW":{back:"",cancel:"",confirm:"",save:"",delete:"",edit:"",loading:"...",day:"Day",my_trips:"",start_adventure:"",click_to_add:"",trips_count:"",new_trip:"",trip_destination_title:" / ",cover_photo:"",upload_photo:"",ai_generate_cover:"AI ",start_date:"",end_date:"",create_trip:"",add_trip_hint:"",itinerary:"",map:"",budget:"",bookings:"",shopping_list:"",shopping:"",origin:"",label_destination:"",status_confirmed:"",status_pending:"",status_cancelled:"",ai_guide:"AI ",add_activity:"",edit_activity:"",add_expense:"",add_booking:"",weather:"",nav_quick_jump:"",no_itinerary:"",click_add:"",delete_trip_title:"",delete_trip_confirm:"{title}",confirm_delete:"",activity_name:"",time:"",location:"",notes:" ()",duration:"",details:"",placeholder_duration:"15 ",placeholder_details:"JR ",ai_route:"AI ",optimize_route:"AI ",expense_item:"",amount:"",payer:"",payment_method:"",booking_type:"",provider:" / ",booking_ref:" ()",ai_planner_title:"AI ",ai_planner_intro:" AI ",ai_planning:" 10-20 ",ai_done:"",input_placeholder:"...",planning_process:"...",magic_editor_title:"",upload_hint:"",magic_prompt_placeholder:"...",start_magic:"",generating:"...",settings_title:"",general:"",language:"",appearance:"",minimalist_mode:"",minimalist_desc:"",data_mgmt:"",reset_all:"",reset_confirm:"",tools_title:"",tool_emergency:"",tool_card:"",tool_map:"",tool_restroom:"",tool_visa:"",tool_translation:"",tool_culture:"",api_settings:"API ",api_key_label:"Gemini API Key",api_key_placeholder:" API Key",api_key_help:" Key ",api_key_saved:"API Key ",theme_color:"",payer_me:"",payer_other:"",payment_cash:"",payment_card:"",split_individual:"",split_shared:"",translate_to:"",enter_text:"...",translate_result:"",desc_translator:"AI ",desc_emergency:" / ",desc_card:"",desc_map:"",desc_restroom:"",desc_visa:"",desc_culture:"",prompt_tokyo:"",prompt_bangkok:"",prompt_paris:"",placeholder_item:"",placeholder_payer:"",lang_ja:"",lang_en:"",lang_zh:"",lang_ko:"",lang_th:"",lang_fr:"",lang_es:"",share_trip:"",share_success:"",travel_time:"",travel_mode:"",travel_details:" ( JR )",mode_walk:"",mode_train:"/",mode_bus:"/",mode_car:"/",mode_flight:"",minutes:"",search_placeholder:" (: )",search_location:""},"en-US":{back:"Back",cancel:"Cancel",confirm:"Confirm",save:"Save",delete:"Delete",edit:"Edit",loading:"Loading...",day:"Day",my_trips:"My Trips",start_adventure:"Start New Adventure",click_to_add:"Click button below to add trip",trips_count:"items",new_trip:"New Trip",trip_destination_title:"Destination / Title",cover_photo:"Cover Photo",upload_photo:"Upload",ai_generate_cover:"AI Generate",start_date:"Start Date",end_date:"End Date",create_trip:"Create Trip",add_trip_hint:"You can add detailed itinerary later",itinerary:"Itinerary",map:"Map",budget:"Budget",shopping_list:"Shopping List",shopping:"Shopping",bookings:"Bookings",origin:"Origin",label_destination:"Destination",status_confirmed:"Confirmed",status_pending:"Pending",status_cancelled:"Cancelled",ai_guide:"AI Guide",add_activity:"Add Activity",edit_activity:"Edit Activity",add_expense:"Add Expense",add_booking:"Add Booking",weather:"Weather",nav_quick_jump:"Jump to",no_itinerary:"No itinerary yet",click_add:"Click button to add",delete_trip_title:"Delete Trip?",delete_trip_confirm:'Are you sure you want to delete "{title}"? This cannot be undone.',confirm_delete:"Delete",activity_name:"Activity Name",time:"Time",location:"Location",notes:"Notes (Optional)",duration:"Duration",details:"Details",placeholder_duration:"e.g. 15 min",placeholder_details:"e.g. JR Line",ai_route:"AI Route",optimize_route:"AI Route Optimization",expense_item:"Item Name",amount:"Amount",payer:"Payer",payment_method:"Method",booking_type:"Type",provider:"Provider / Name",booking_ref:"Ref Number (Optional)",ai_planner_title:"AI Planner",ai_planner_intro:"Hi! I am your AI travel assistant. Where do you want to go?",ai_planning:"Sure! I am planning your trip. This takes about 10-20 seconds.",ai_done:"Planning complete! Check your trip list. ",input_placeholder:"Enter your travel ideas...",planning_process:"Processing...",magic_editor_title:"Magic Editor",upload_hint:"Upload Photo",magic_prompt_placeholder:"Make it sunny, add balloons...",start_magic:"Generate",generating:"Processing...",settings_title:"Settings",api_settings:"API Settings",api_key_label:"Gemini API Key",api_key_placeholder:"Paste your API Key here",api_key_help:"Your key is stored locally in your browser.",api_key_saved:"API Key Saved",general:"General",language:"Language",appearance:"Appearance",minimalist_mode:"Minimalist Mode",minimalist_desc:"Hide images, focus on text",data_mgmt:"Data Management",reset_all:"Reset All Data",reset_confirm:"Are you sure? This will delete all trips and settings. This cannot be undone.",tools_title:"Tools",tool_emergency:"Emergency",tool_card:"Card Tips",tool_map:"Scratch Map",tool_restroom:"Restroom",tool_visa:"Visa Check",tool_culture:"Culture",share_trip:"Share Trip",share_success:"Copied to clipboard!",travel_time:"Travel Time",travel_mode:"Travel Mode",travel_details:"Details (e.g. JR Line)",mode_walk:"Walk",mode_train:"Train/Subway",mode_bus:"Bus",mode_car:"Car/Taxi",mode_flight:"Flight",minutes:"min",search_placeholder:"Search location (e.g. Tokyo Tower)",search_location:"Search"},"ja-JP":{back:"",cancel:"",confirm:"",save:"",delete:"",edit:"",loading:"...",day:"Day",my_trips:"",start_adventure:"",click_to_add:"",trips_count:"",new_trip:"",trip_destination_title:" / ",cover_photo:"",upload_photo:"",ai_generate_cover:"AI",start_date:"",end_date:"",create_trip:"",add_trip_hint:"",itinerary:"",map:"",budget:"",shopping_list:"",shopping:"",bookings:"",origin:"",label_destination:"",status_confirmed:"",status_pending:"",status_cancelled:"",ai_guide:"AI",add_activity:"",edit_activity:"",add_expense:"",add_booking:"",weather:"",nav_quick_jump:"",no_itinerary:"",click_add:"",delete_trip_title:"",delete_trip_confirm:"{title}",confirm_delete:"",activity_name:"",time:"",location:"",notes:" ()",duration:"",details:"",placeholder_duration:"15",placeholder_details:"JR",ai_route:"AI",optimize_route:"AI",expense_item:"",amount:"",payer:"",payment_method:"",booking_type:"",provider:" / ",booking_ref:" ()",ai_planner_title:"AI",ai_planner_intro:"AI",ai_planning:"1020",ai_done:"",input_placeholder:"...",planning_process:"...",magic_editor_title:"",upload_hint:"",magic_prompt_placeholder:"...",start_magic:"",generating:"...",settings_title:"",general:"",language:"",appearance:"",minimalist_mode:"",minimalist_desc:"",data_mgmt:"",reset_all:"",reset_confirm:"",tools_title:"",tool_emergency:"",tool_card:"",tool_map:"",tool_restroom:"",tool_visa:"",tool_culture:"",share_trip:"",share_success:"",travel_time:"",travel_mode:"",travel_details:" (: JR)",mode_walk:"",mode_train:"/",mode_bus:"",mode_car:"/",mode_flight:"",minutes:"",search_placeholder:" (: )",search_location:""}},X2=({trips:n,onSelectTrip:e,onAddTrip:t,onOpenSettings:i,settings:r})=>{const[a,u]=W.useState(new Set),[f,m]=W.useState(new Set),p=on[r.language]||on["zh-TW"],E=S=>{u(A=>{const R=new Set(A);return R.add(S),R})};return v.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[v.jsxs("div",{className:"px-6 py-5 sticky top-0 z-10 flex justify-between items-center bg-paper/90 backdrop-blur-sm",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-14 h-14 flex items-center justify-center overflow-hidden",children:v.jsx("img",{src:"/nomadai-travel-journal_app_icon.png",alt:"Icon",className:"w-full h-full object-cover"})}),v.jsx("h1",{className:"text-3xl font-extrabold text-ink tracking-tight",children:p.my_trips})]}),v.jsx("button",{onClick:i,className:"p-2.5 bg-white shadow-card rounded-full text-gray-400 hover:text-coral transition-colors active:scale-95",children:v.jsx(G2,{className:"w-6 h-6"})})]}),v.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-2 space-y-6 pb-32 no-scrollbar",children:n.length===0?v.jsxs("div",{className:"flex flex-col items-center justify-center h-80 text-center animate-fade-in border-2 border-dashed border-sand rounded-3xl m-4",children:[v.jsx("div",{className:"w-16 h-16 bg-white shadow-soft rounded-full flex items-center justify-center mb-4 text-coral",children:v.jsx(R_,{className:"w-8 h-8"})}),v.jsx("h3",{className:"text-xl font-bold text-ink mb-1",children:p.start_adventure}),v.jsx("p",{className:"text-gray-400 text-sm",children:p.click_to_add})]}):n==null?void 0:n.map(S=>{var A;return v.jsxs("div",{onClick:()=>e(S),className:`group cursor-pointer active:scale-[0.98] transition-all transform bg-white rounded-3xl shadow-card hover:shadow-soft overflow-hidden ${r.minimalistMode?"p-5 border border-sand":"p-3"}`,children:[!r.minimalistMode&&v.jsxs("div",{className:"aspect-[2/1] w-full relative overflow-hidden rounded-2xl bg-gray-100 mb-4 shadow-inner group",children:[S.coverImage&&!a.has(S.id)?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:`absolute inset-0 bg-gray-200 transition-opacity duration-500 ${f.has(S.id)?"opacity-0 pointer-events-none":"opacity-100"}`}),v.jsx("img",{src:S.coverImage,alt:S.title,onLoad:()=>m(R=>new Set(R).add(S.id)),onError:()=>E(S.id),className:`w-full h-full object-cover transition-all duration-700 ${f.has(S.id)?"opacity-100 group-hover:scale-105":"opacity-0"}`})]}):v.jsx("div",{className:"w-full h-full bg-sand/30 flex items-center justify-center",children:v.jsx(R_,{className:"w-12 h-12 text-gray-300"})}),v.jsxs("div",{className:"absolute top-3 right-3 bg-white/90 backdrop-blur text-ink text-xs font-bold px-3 py-1.5 rounded-full shadow-sm z-10",children:[((A=S.itinerary)==null?void 0:A.length)||0," ",p.trips_count]})]}),v.jsxs("div",{className:`${r.minimalistMode?"flex justify-between items-center":"px-2 pb-2"}`,children:[v.jsxs("div",{children:[v.jsx("h3",{className:`font-bold text-ink leading-tight ${r.minimalistMode?"text-lg":"text-xl mb-1"}`,children:S.title}),v.jsxs("div",{className:"flex items-center text-sm text-gray-400 font-medium",children:[v.jsx(M_,{className:"w-4 h-4 mr-1.5 text-coral"}),v.jsxs("span",{children:[S.startDate," - ",S.endDate]})]})]}),r.minimalistMode&&v.jsx("div",{className:"w-8 h-8 bg-paper rounded-full flex items-center justify-center text-coral",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-4 h-4",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})})})]})]},S.id)})}),v.jsx("button",{onClick:t,className:"fixed bottom-28 right-6 w-16 h-16 bg-coral text-white rounded-full shadow-float flex items-center justify-center transition-all active:scale-90 hover:bg-coralDark z-50 ring-4 ring-white",children:v.jsx(Om,{className:"w-8 h-8 stroke-[2]"})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let eR,tR;function nR(){return{geminiUrl:eR,vertexUrl:tR}}function iR(n,e,t,i){var r,a;if(!(n!=null&&n.baseUrl)){const u=nR();return e?(r=u.vertexUrl)!==null&&r!==void 0?r:t:(a=u.geminiUrl)!==null&&a!==void 0?a:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bo{}function Le(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const a=e[r];return a!=null?String(a):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function _(n,e,t){for(let a=0;a<e.length-1;a++){const u=e[a];if(u.endsWith("[]")){const f=u.slice(0,-2);if(!(f in n))if(Array.isArray(t))n[f]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(n[f])){const m=n[f];if(Array.isArray(t))for(let p=0;p<m.length;p++){const E=m[p];_(E,e.slice(a+1),t[p])}else for(const p of m)_(p,e.slice(a+1),t)}return}else if(u.endsWith("[0]")){const f=u.slice(0,-3);f in n||(n[f]=[{}]);const m=n[f];_(m[0],e.slice(a+1),t);return}(!n[u]||typeof n[u]!="object")&&(n[u]={}),n=n[u]}const i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function g(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const r=e[i];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in n){const u=n[a];return Array.isArray(u)?u.map(f=>g(f,e.slice(i+1),t)):t}else return t}else n=n[r]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function sR(n,e){for(const[t,i]of Object.entries(e)){const r=t.split("."),a=i.split("."),u=new Set;let f=-1;for(let m=0;m<r.length;m++)if(r[m]==="*"){f=m;break}if(f!==-1&&a.length>f)for(let m=f;m<a.length;m++){const p=a[m];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&u.add(p)}D_(n,r,a,0,u)}}function D_(n,e,t,i,r){if(i>=e.length||typeof n!="object"||n===null)return;const a=e[i];if(a.endsWith("[]")){const u=a.slice(0,-2),f=n;if(u in f&&Array.isArray(f[u]))for(const m of f[u])D_(m,e,t,i+1,r)}else if(a==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const u=n,f=Object.keys(u).filter(p=>!p.startsWith("_")&&!r.has(p)),m={};for(const p of f)m[p]=u[p];for(const[p,E]of Object.entries(m)){const S=[];for(const A of t.slice(i))A==="*"?S.push(p):S.push(A);_(u,S,E)}for(const p of f)delete u[p]}}else{const u=n;a in u&&D_(u[a],e,t,i+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function My(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rR(n){const e={},t=g(n,["operationName"]);t!=null&&_(e,["operationName"],t);const i=g(n,["resourceName"]);return i!=null&&_(e,["_url","resourceName"],i),e}function oR(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=g(n,["done"]);r!=null&&_(e,["done"],r);const a=g(n,["error"]);a!=null&&_(e,["error"],a);const u=g(n,["response","generateVideoResponse"]);return u!=null&&_(e,["response"],lR(u)),e}function aR(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=g(n,["done"]);r!=null&&_(e,["done"],r);const a=g(n,["error"]);a!=null&&_(e,["error"],a);const u=g(n,["response"]);return u!=null&&_(e,["response"],uR(u)),e}function lR(n){const e={},t=g(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>cR(u))),_(e,["generatedVideos"],a)}const i=g(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=g(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function uR(n){const e={},t=g(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>dR(u))),_(e,["generatedVideos"],a)}const i=g(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=g(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function cR(n){const e={},t=g(n,["video"]);return t!=null&&_(e,["video"],_R(t)),e}function dR(n){const e={},t=g(n,["_self"]);return t!=null&&_(e,["video"],yR(t)),e}function hR(n){const e={},t=g(n,["operationName"]);return t!=null&&_(e,["_url","operationName"],t),e}function fR(n){const e={},t=g(n,["operationName"]);return t!=null&&_(e,["_url","operationName"],t),e}function mR(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=g(n,["done"]);r!=null&&_(e,["done"],r);const a=g(n,["error"]);a!=null&&_(e,["error"],a);const u=g(n,["response"]);return u!=null&&_(e,["response"],pR(u)),e}function pR(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["parent"]);i!=null&&_(e,["parent"],i);const r=g(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function Zb(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=g(n,["done"]);r!=null&&_(e,["done"],r);const a=g(n,["error"]);a!=null&&_(e,["error"],a);const u=g(n,["response"]);return u!=null&&_(e,["response"],gR(u)),e}function gR(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["parent"]);i!=null&&_(e,["parent"],i);const r=g(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function _R(n){const e={},t=g(n,["uri"]);t!=null&&_(e,["uri"],t);const i=g(n,["encodedVideo"]);i!=null&&_(e,["videoBytes"],My(i));const r=g(n,["encoding"]);return r!=null&&_(e,["mimeType"],r),e}function yR(n){const e={},t=g(n,["gcsUri"]);t!=null&&_(e,["uri"],t);const i=g(n,["bytesBase64Encoded"]);i!=null&&_(e,["videoBytes"],My(i));const r=g(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var aE;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(aE||(aE={}));var lE;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(lE||(lE={}));var uE;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(uE||(uE={}));var xa;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(xa||(xa={}));var cE;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(cE||(cE={}));var dE;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(dE||(dE={}));var hE;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(hE||(hE={}));var fE;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(fE||(fE={}));var mE;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(mE||(mE={}));var pE;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(pE||(pE={}));var gE;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(gE||(gE={}));var _E;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(_E||(_E={}));var yE;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(yE||(yE={}));var vE;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(vE||(vE={}));var TE;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(TE||(TE={}));var xE;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(xE||(xE={}));var EE;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(EE||(EE={}));var wE;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(wE||(wE={}));var SE;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(SE||(SE={}));var rm;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(rm||(rm={}));var bE;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(bE||(bE={}));var AE;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(AE||(AE={}));var IE;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(IE||(IE={}));var k_;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(k_||(k_={}));var CE;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(CE||(CE={}));var NE;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(NE||(NE={}));var RE;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(RE||(RE={}));var ME;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(ME||(ME={}));var PE;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(PE||(PE={}));var DE;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(DE||(DE={}));var kE;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(kE||(kE={}));var LE;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(LE||(LE={}));var VE;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(VE||(VE={}));var OE;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(OE||(OE={}));var UE;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(UE||(UE={}));var BE;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(BE||(BE={}));var zE;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(zE||(zE={}));var FE;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(FE||(FE={}));var qE;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(qE||(qE={}));var GE;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(GE||(GE={}));var HE;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(HE||(HE={}));var jE;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(jE||(jE={}));var KE;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(KE||(KE={}));var ZE;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(ZE||(ZE={}));var JE;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(JE||(JE={}));var YE;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(YE||(YE={}));var WE;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(WE||(WE={}));var QE;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(QE||(QE={}));var $E;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})($E||($E={}));var XE;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(XE||(XE={}));var ew;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(ew||(ew={}));var tw;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(tw||(tw={}));var nw;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(nw||(nw={}));var iw;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(iw||(iw={}));var Yu;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Yu||(Yu={}));class L_{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Ed{get text(){var e,t,i,r,a,u,f,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",E=!1;const S=[];for(const A of(m=(f=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)!==null&&m!==void 0?m:[]){for(const[R,V]of Object.entries(A))R!=="text"&&R!=="thought"&&R!=="thoughtSignature"&&(V!==null||V!==void 0)&&S.push(R);if(typeof A.text=="string"){if(typeof A.thought=="boolean"&&A.thought)continue;E=!0,p+=A.text}}return S.length>0&&console.warn(`there are non-text parts ${S} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),E?p:void 0}get data(){var e,t,i,r,a,u,f,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const E=[];for(const S of(m=(f=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)!==null&&m!==void 0?m:[]){for(const[A,R]of Object.entries(S))A!=="inlineData"&&(R!==null||R!==void 0)&&E.push(A);S.inlineData&&typeof S.inlineData.data=="string"&&(p+=atob(S.inlineData.data))}return E.length>0&&console.warn(`there are non-data parts ${E} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,r,a,u,f,m;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(m=(f=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||m===void 0?void 0:m.filter(E=>E.functionCall).map(E=>E.functionCall).filter(E=>E!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,r,a,u,f,m,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const E=(m=(f=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||m===void 0?void 0:m.filter(S=>S.executableCode).map(S=>S.executableCode).filter(S=>S!==void 0);if((E==null?void 0:E.length)!==0)return(p=E==null?void 0:E[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,r,a,u,f,m,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const E=(m=(f=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||f===void 0?void 0:f.parts)===null||m===void 0?void 0:m.filter(S=>S.codeExecutionResult).map(S=>S.codeExecutionResult).filter(S=>S!==void 0);if((E==null?void 0:E.length)!==0)return(p=E==null?void 0:E[0])===null||p===void 0?void 0:p.output}}class sw{}class rw{}class vR{}class TR{}class xR{}class ER{}class ow{}class aw{}class lw{}class wR{}class om{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new om;let r;const a=e;return t?r=aR(a):r=oR(a),Object.assign(i,r),i}}class uw{}class cw{}class dw{}class SR{}class bR{}class AR{}class Py{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Py,a=mR(e);return Object.assign(i,a),i}}class IR{}class CR{}class NR{}class hw{}class RR{get text(){var e,t,i;let r="",a=!1;const u=[];for(const f of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[m,p]of Object.entries(f))m!=="text"&&m!=="thought"&&p!==null&&u.push(m);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;a=!0,r+=f.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?r:void 0}get data(){var e,t,i;let r="";const a=[];for(const u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,m]of Object.entries(u))f!=="inlineData"&&m!==null&&a.push(f);u.inlineData&&typeof u.inlineData.data=="string"&&(r+=atob(u.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class MR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Dy{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Dy,a=Zb(e);return Object.assign(i,a),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ft(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Jb(n,e){const t=Ft(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function Yb(n){return Array.isArray(n)?n.map(e=>am(e)):[am(n)]}function am(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function Wb(n){const e=am(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Qb(n){const e=am(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function fw(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function $b(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>fw(e)):[fw(n)]}function V_(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function mw(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function pw(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Ti(n){if(n==null)throw new Error("ContentUnion is required");return V_(n)?n:{role:"user",parts:$b(n)}}function ky(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=Ti(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=Ti(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Ti(t)):[Ti(e)]}function Gs(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(mw(n)||pw(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ti(n)]}const e=[],t=[],i=V_(n[0]);for(const r of n){const a=V_(r);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(r);else{if(mw(r)||pw(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:$b(t)}),e}function PR(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(xa).includes(t[0].toUpperCase())?t[0].toUpperCase():xa.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(xa).includes(i.toUpperCase())?i.toUpperCase():xa.TYPE_UNSPECIFIED})}}function Wu(n){const e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&PR(n.type,e);for(const[u,f]of Object.entries(n))if(f!=null)if(u=="type"){if(f==="null")throw new Error("type: null can not be the only possible type for the field.");if(f instanceof Array)continue;e.type=Object.values(xa).includes(f.toUpperCase())?f.toUpperCase():xa.TYPE_UNSPECIFIED}else if(t.includes(u))e[u]=Wu(f);else if(i.includes(u)){const m=[];for(const p of f){if(p.type=="null"){e.nullable=!0;continue}m.push(Wu(p))}e[u]=m}else if(r.includes(u)){const m={};for(const[p,E]of Object.entries(f))m[p]=Wu(E);e[u]=m}else{if(u==="additionalProperties")continue;e[u]=f}return e}function Ly(n){return Wu(n)}function Vy(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Oy(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function wc(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Wu(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Wu(e.response));return n}function Sc(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function DR(n,e,t,i=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function Ao(n,e){if(typeof e!="string")throw new Error("name must be a string");return DR(n,e,"cachedContents")}function Xb(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Va(n){return My(n)}function kR(n){return n!=null&&typeof n=="object"&&"name"in n}function LR(n){return n!=null&&typeof n=="object"&&"video"in n}function VR(n){return n!=null&&typeof n=="object"&&"uri"in n}function e1(n){var e;let t;if(kR(n)&&(t=n.name),!(VR(n)&&(t=n.uri,t===void 0))&&!(LR(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function t1(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function n1(n){for(const e of["models","tunedModels","publisherModels"])if(OR(n,e))return n[e];return[]}function OR(n,e){return n!==null&&typeof n=="object"&&e in n}function UR(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function BR(n,e={}){const t=[],i=new Set;for(const r of n){const a=r.name;if(i.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);i.add(a);const u=UR(r,e);u.functionDeclarations&&t.push(...u.functionDeclarations)}return{functionDeclarations:t}}function i1(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function zR(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function s1(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let a=!1;for(const u of r){if(typeof u!="object"||u===null)continue;const m=u.response;if(typeof m!="object"||m===null)continue;if(m.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function bc(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function r1(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FR(n){const e={},t=g(n,["responsesFile"]);t!=null&&_(e,["fileName"],t);const i=g(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>xM(u))),_(e,["inlinedResponses"],a)}const r=g(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>u)),_(e,["inlinedEmbedContentResponses"],a)}return e}function qR(n){const e={},t=g(n,["predictionsFormat"]);t!=null&&_(e,["format"],t);const i=g(n,["gcsDestination","outputUriPrefix"]);i!=null&&_(e,["gcsUri"],i);const r=g(n,["bigqueryDestination","outputUri"]);return r!=null&&_(e,["bigqueryUri"],r),e}function GR(n){const e={},t=g(n,["format"]);t!=null&&_(e,["predictionsFormat"],t);const i=g(n,["gcsUri"]);i!=null&&_(e,["gcsDestination","outputUriPrefix"],i);const r=g(n,["bigqueryUri"]);if(r!=null&&_(e,["bigqueryDestination","outputUri"],r),g(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(g(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Bf(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["metadata","displayName"]);i!=null&&_(e,["displayName"],i);const r=g(n,["metadata","state"]);r!=null&&_(e,["state"],r1(r));const a=g(n,["metadata","createTime"]);a!=null&&_(e,["createTime"],a);const u=g(n,["metadata","endTime"]);u!=null&&_(e,["endTime"],u);const f=g(n,["metadata","updateTime"]);f!=null&&_(e,["updateTime"],f);const m=g(n,["metadata","model"]);m!=null&&_(e,["model"],m);const p=g(n,["metadata","output"]);return p!=null&&_(e,["dest"],FR(s1(p))),e}function O_(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=g(n,["state"]);r!=null&&_(e,["state"],r1(r));const a=g(n,["error"]);a!=null&&_(e,["error"],a);const u=g(n,["createTime"]);u!=null&&_(e,["createTime"],u);const f=g(n,["startTime"]);f!=null&&_(e,["startTime"],f);const m=g(n,["endTime"]);m!=null&&_(e,["endTime"],m);const p=g(n,["updateTime"]);p!=null&&_(e,["updateTime"],p);const E=g(n,["model"]);E!=null&&_(e,["model"],E);const S=g(n,["inputConfig"]);S!=null&&_(e,["src"],HR(S));const A=g(n,["outputConfig"]);A!=null&&_(e,["dest"],qR(s1(A)));const R=g(n,["completionStats"]);return R!=null&&_(e,["completionStats"],R),e}function HR(n){const e={},t=g(n,["instancesFormat"]);t!=null&&_(e,["format"],t);const i=g(n,["gcsSource","uris"]);i!=null&&_(e,["gcsUri"],i);const r=g(n,["bigquerySource","inputUri"]);return r!=null&&_(e,["bigqueryUri"],r),e}function jR(n,e){const t={};if(g(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(g(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=g(e,["fileName"]);i!=null&&_(t,["fileName"],i);const r=g(e,["inlinedRequests"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>TM(n,u))),_(t,["requests","requests"],a)}return t}function KR(n){const e={},t=g(n,["format"]);t!=null&&_(e,["instancesFormat"],t);const i=g(n,["gcsUri"]);i!=null&&_(e,["gcsSource","uris"],i);const r=g(n,["bigqueryUri"]);if(r!=null&&_(e,["bigquerySource","inputUri"],r),g(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(g(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function ZR(n){const e={},t=g(n,["data"]);if(t!=null&&_(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function JR(n,e){const t={},i=g(e,["name"]);return i!=null&&_(t,["_url","name"],bc(n,i)),t}function YR(n,e){const t={},i=g(e,["name"]);return i!=null&&_(t,["_url","name"],bc(n,i)),t}function WR(n){const e={},t=g(n,["content"]);t!=null&&_(e,["content"],t);const i=g(n,["citationMetadata"]);i!=null&&_(e,["citationMetadata"],QR(i));const r=g(n,["tokenCount"]);r!=null&&_(e,["tokenCount"],r);const a=g(n,["finishReason"]);a!=null&&_(e,["finishReason"],a);const u=g(n,["avgLogprobs"]);u!=null&&_(e,["avgLogprobs"],u);const f=g(n,["groundingMetadata"]);f!=null&&_(e,["groundingMetadata"],f);const m=g(n,["index"]);m!=null&&_(e,["index"],m);const p=g(n,["logprobsResult"]);p!=null&&_(e,["logprobsResult"],p);const E=g(n,["safetyRatings"]);if(E!=null){let A=E;Array.isArray(A)&&(A=A.map(R=>R)),_(e,["safetyRatings"],A)}const S=g(n,["urlContextMetadata"]);return S!=null&&_(e,["urlContextMetadata"],S),e}function QR(n){const e={},t=g(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["citations"],i)}return e}function o1(n){const e={},t=g(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>CM(a))),_(e,["parts"],r)}const i=g(n,["role"]);return i!=null&&_(e,["role"],i),e}function $R(n,e){const t={},i=g(n,["displayName"]);if(e!==void 0&&i!=null&&_(e,["batch","displayName"],i),g(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function XR(n,e){const t={},i=g(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=g(n,["dest"]);return e!==void 0&&r!=null&&_(e,["outputConfig"],GR(zR(r))),t}function gw(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["src"]);r!=null&&_(t,["batch","inputConfig"],jR(n,i1(n,r)));const a=g(e,["config"]);return a!=null&&$R(a,t),t}function eM(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["model"],Ft(n,i));const r=g(e,["src"]);r!=null&&_(t,["inputConfig"],KR(i1(n,r)));const a=g(e,["config"]);return a!=null&&XR(a,t),t}function tM(n,e){const t={},i=g(n,["displayName"]);return e!==void 0&&i!=null&&_(e,["batch","displayName"],i),t}function nM(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["src"]);r!=null&&_(t,["batch","inputConfig"],uM(n,r));const a=g(e,["config"]);return a!=null&&tM(a,t),t}function iM(n,e){const t={},i=g(e,["name"]);return i!=null&&_(t,["_url","name"],bc(n,i)),t}function sM(n,e){const t={},i=g(e,["name"]);return i!=null&&_(t,["_url","name"],bc(n,i)),t}function rM(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["name"]);i!=null&&_(e,["name"],i);const r=g(n,["done"]);r!=null&&_(e,["done"],r);const a=g(n,["error"]);return a!=null&&_(e,["error"],a),e}function oM(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["name"]);i!=null&&_(e,["name"],i);const r=g(n,["done"]);r!=null&&_(e,["done"],r);const a=g(n,["error"]);return a!=null&&_(e,["error"],a),e}function aM(n,e){const t={},i=g(e,["contents"]);if(i!=null){let a=ky(n,i);Array.isArray(a)&&(a=a.map(u=>u)),_(t,["requests[]","request","content"],a)}const r=g(e,["config"]);return r!=null&&(_(t,["_self"],lM(r,t)),sR(t,{"requests[].*":"requests[].request.*"})),t}function lM(n,e){const t={},i=g(n,["taskType"]);e!==void 0&&i!=null&&_(e,["requests[]","taskType"],i);const r=g(n,["title"]);e!==void 0&&r!=null&&_(e,["requests[]","title"],r);const a=g(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&_(e,["requests[]","outputDimensionality"],a),g(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function uM(n,e){const t={},i=g(e,["fileName"]);i!=null&&_(t,["file_name"],i);const r=g(e,["inlinedRequests"]);return r!=null&&_(t,["requests"],aM(n,r)),t}function cM(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function dM(n){const e={},t=g(n,["id"]);t!=null&&_(e,["id"],t);const i=g(n,["args"]);i!=null&&_(e,["args"],i);const r=g(n,["name"]);if(r!=null&&_(e,["name"],r),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function hM(n){const e={},t=g(n,["mode"]);t!=null&&_(e,["mode"],t);const i=g(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),g(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function fM(n,e,t){const i={},r=g(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],o1(Ti(r)));const a=g(e,["temperature"]);a!=null&&_(i,["temperature"],a);const u=g(e,["topP"]);u!=null&&_(i,["topP"],u);const f=g(e,["topK"]);f!=null&&_(i,["topK"],f);const m=g(e,["candidateCount"]);m!=null&&_(i,["candidateCount"],m);const p=g(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const E=g(e,["stopSequences"]);E!=null&&_(i,["stopSequences"],E);const S=g(e,["responseLogprobs"]);S!=null&&_(i,["responseLogprobs"],S);const A=g(e,["logprobs"]);A!=null&&_(i,["logprobs"],A);const R=g(e,["presencePenalty"]);R!=null&&_(i,["presencePenalty"],R);const V=g(e,["frequencyPenalty"]);V!=null&&_(i,["frequencyPenalty"],V);const z=g(e,["seed"]);z!=null&&_(i,["seed"],z);const Z=g(e,["responseMimeType"]);Z!=null&&_(i,["responseMimeType"],Z);const X=g(e,["responseSchema"]);X!=null&&_(i,["responseSchema"],Ly(X));const ne=g(e,["responseJsonSchema"]);if(ne!=null&&_(i,["responseJsonSchema"],ne),g(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const Q=g(e,["safetySettings"]);if(t!==void 0&&Q!=null){let K=Q;Array.isArray(K)&&(K=K.map(F=>NM(F))),_(t,["safetySettings"],K)}const pe=g(e,["tools"]);if(t!==void 0&&pe!=null){let K=Sc(pe);Array.isArray(K)&&(K=K.map(F=>MM(wc(F)))),_(t,["tools"],K)}const he=g(e,["toolConfig"]);if(t!==void 0&&he!=null&&_(t,["toolConfig"],RM(he)),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const Y=g(e,["cachedContent"]);t!==void 0&&Y!=null&&_(t,["cachedContent"],Ao(n,Y));const D=g(e,["responseModalities"]);D!=null&&_(i,["responseModalities"],D);const B=g(e,["mediaResolution"]);B!=null&&_(i,["mediaResolution"],B);const O=g(e,["speechConfig"]);if(O!=null&&_(i,["speechConfig"],Vy(O)),g(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const G=g(e,["thinkingConfig"]);G!=null&&_(i,["thinkingConfig"],G);const q=g(e,["imageConfig"]);return q!=null&&_(i,["imageConfig"],vM(q)),i}function mM(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(p=>WR(p))),_(e,["candidates"],m)}const r=g(n,["modelVersion"]);r!=null&&_(e,["modelVersion"],r);const a=g(n,["promptFeedback"]);a!=null&&_(e,["promptFeedback"],a);const u=g(n,["responseId"]);u!=null&&_(e,["responseId"],u);const f=g(n,["usageMetadata"]);return f!=null&&_(e,["usageMetadata"],f),e}function pM(n,e){const t={},i=g(e,["name"]);return i!=null&&_(t,["_url","name"],bc(n,i)),t}function gM(n,e){const t={},i=g(e,["name"]);return i!=null&&_(t,["_url","name"],bc(n,i)),t}function _M(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function yM(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function vM(n){const e={},t=g(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=g(n,["imageSize"]);if(i!=null&&_(e,["imageSize"],i),g(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function TM(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["request","model"],Ft(n,i));const r=g(e,["contents"]);if(r!=null){let f=Gs(r);Array.isArray(f)&&(f=f.map(m=>o1(m))),_(t,["request","contents"],f)}const a=g(e,["metadata"]);a!=null&&_(t,["metadata"],a);const u=g(e,["config"]);return u!=null&&_(t,["request","generationConfig"],fM(n,u,g(t,["request"],{}))),t}function xM(n){const e={},t=g(n,["response"]);t!=null&&_(e,["response"],mM(t));const i=g(n,["error"]);return i!=null&&_(e,["error"],i),e}function EM(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=g(n,["pageToken"]);if(e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),g(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function wM(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=g(n,["pageToken"]);e!==void 0&&r!=null&&_(e,["_query","pageToken"],r);const a=g(n,["filter"]);return e!==void 0&&a!=null&&_(e,["_query","filter"],a),t}function SM(n){const e={},t=g(n,["config"]);return t!=null&&EM(t,e),e}function bM(n){const e={},t=g(n,["config"]);return t!=null&&wM(t,e),e}function AM(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=g(n,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>Bf(u))),_(e,["batchJobs"],a)}return e}function IM(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=g(n,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>O_(u))),_(e,["batchJobs"],a)}return e}function CM(n){const e={},t=g(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=g(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=g(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const a=g(n,["fileData"]);a!=null&&_(e,["fileData"],cM(a));const u=g(n,["functionCall"]);u!=null&&_(e,["functionCall"],dM(u));const f=g(n,["functionResponse"]);f!=null&&_(e,["functionResponse"],f);const m=g(n,["inlineData"]);m!=null&&_(e,["inlineData"],ZR(m));const p=g(n,["text"]);p!=null&&_(e,["text"],p);const E=g(n,["thought"]);E!=null&&_(e,["thought"],E);const S=g(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const A=g(n,["videoMetadata"]);return A!=null&&_(e,["videoMetadata"],A),e}function NM(n){const e={},t=g(n,["category"]);if(t!=null&&_(e,["category"],t),g(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=g(n,["threshold"]);return i!=null&&_(e,["threshold"],i),e}function RM(n){const e={},t=g(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],hM(t));const i=g(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function MM(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>S)),_(e,["functionDeclarations"],E)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=g(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=g(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const a=g(n,["fileSearch"]);a!=null&&_(e,["fileSearch"],a);const u=g(n,["codeExecution"]);if(u!=null&&_(e,["codeExecution"],u),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const f=g(n,["googleMaps"]);f!=null&&_(e,["googleMaps"],_M(f));const m=g(n,["googleSearch"]);m!=null&&_(e,["googleSearch"],yM(m));const p=g(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var vo;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(vo||(vo={}));class Wl{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let u={config:{}};!i||Object.keys(i).length===0?u={config:{}}:typeof i=="object"?u=Object.assign({},i):u=i,u.config&&(u.config.pageToken=t.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(a=(r=u.config)===null||r===void 0?void 0:r.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class PM extends bo{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new Wl(vo.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=gw(this.apiClient,e),i=t._url,r=Le("{model}:batchGenerateContent",i),f=t.batch.inputConfig.requests,m=f.requests,p=[];for(const E of m){const S=Object.assign({},E);if(S.systemInstruction){const A=S.systemInstruction;delete S.systemInstruction;const R=S.request;R.systemInstruction=A,S.request=R}p.push(S)}return f.requests=p,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const a=this.getGcsUri(e),u=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?i.dest=`${a.slice(0,-6)}/dest`:i.dest=`${a}_dest_${r}`;else if(u)i.dest=`${u}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=eM(this.apiClient,e);return f=Le("batchPredictionJobs",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),u.then(E=>O_(E))}else{const p=gw(this.apiClient,e);return f=Le("{model}:batchGenerateContent",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json()),u.then(E=>Bf(E))}}async createEmbeddingsInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=nM(this.apiClient,e);return a=Le("{model}:asyncBatchEmbedContent",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>Bf(m))}}async get(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=gM(this.apiClient,e);return f=Le("batchPredictionJobs/{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),u.then(E=>O_(E))}else{const p=pM(this.apiClient,e);return f=Le("batches/{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json()),u.then(E=>Bf(E))}}async cancel(e){var t,i,r,a;let u="",f={};if(this.apiClient.isVertexAI()){const m=YR(this.apiClient,e);u=Le("batchPredictionJobs/{name}:cancel",m._url),f=m._query,delete m._url,delete m._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const m=JR(this.apiClient,e);u=Le("batches/{name}:cancel",m._url),f=m._query,delete m._url,delete m._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=bM(e);return f=Le("batchPredictionJobs",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=IM(E),A=new hw;return Object.assign(A,S),A})}else{const p=SM(e);return f=Le("batches",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=AM(E),A=new hw;return Object.assign(A,S),A})}}async delete(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=sM(this.apiClient,e);return f=Le("batchPredictionJobs/{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>oM(E))}else{const p=iM(this.apiClient,e);return f=Le("batches/{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>rM(E))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DM(n){const e={},t=g(n,["data"]);if(t!=null&&_(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function _w(n){const e={},t=g(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>nP(a))),_(e,["parts"],r)}const i=g(n,["role"]);return i!=null&&_(e,["role"],i),e}function kM(n,e){const t={},i=g(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=g(n,["expireTime"]);e!==void 0&&r!=null&&_(e,["expireTime"],r);const a=g(n,["displayName"]);e!==void 0&&a!=null&&_(e,["displayName"],a);const u=g(n,["contents"]);if(e!==void 0&&u!=null){let E=Gs(u);Array.isArray(E)&&(E=E.map(S=>_w(S))),_(e,["contents"],E)}const f=g(n,["systemInstruction"]);e!==void 0&&f!=null&&_(e,["systemInstruction"],_w(Ti(f)));const m=g(n,["tools"]);if(e!==void 0&&m!=null){let E=m;Array.isArray(E)&&(E=E.map(S=>sP(S))),_(e,["tools"],E)}const p=g(n,["toolConfig"]);if(e!==void 0&&p!=null&&_(e,["toolConfig"],iP(p)),g(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function LM(n,e){const t={},i=g(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=g(n,["expireTime"]);e!==void 0&&r!=null&&_(e,["expireTime"],r);const a=g(n,["displayName"]);e!==void 0&&a!=null&&_(e,["displayName"],a);const u=g(n,["contents"]);if(e!==void 0&&u!=null){let S=Gs(u);Array.isArray(S)&&(S=S.map(A=>A)),_(e,["contents"],S)}const f=g(n,["systemInstruction"]);e!==void 0&&f!=null&&_(e,["systemInstruction"],Ti(f));const m=g(n,["tools"]);if(e!==void 0&&m!=null){let S=m;Array.isArray(S)&&(S=S.map(A=>rP(A))),_(e,["tools"],S)}const p=g(n,["toolConfig"]);e!==void 0&&p!=null&&_(e,["toolConfig"],p);const E=g(n,["kmsKeyName"]);return e!==void 0&&E!=null&&_(e,["encryption_spec","kmsKeyName"],E),t}function VM(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["model"],Jb(n,i));const r=g(e,["config"]);return r!=null&&kM(r,t),t}function OM(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["model"],Jb(n,i));const r=g(e,["config"]);return r!=null&&LM(r,t),t}function UM(n,e){const t={},i=g(e,["name"]);return i!=null&&_(t,["_url","name"],Ao(n,i)),t}function BM(n,e){const t={},i=g(e,["name"]);return i!=null&&_(t,["_url","name"],Ao(n,i)),t}function zM(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function FM(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function qM(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function GM(n){const e={},t=g(n,["id"]);t!=null&&_(e,["id"],t);const i=g(n,["args"]);i!=null&&_(e,["args"],i);const r=g(n,["name"]);if(r!=null&&_(e,["name"],r),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function HM(n){const e={},t=g(n,["mode"]);t!=null&&_(e,["mode"],t);const i=g(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),g(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function jM(n){const e={};if(g(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=g(n,["description"]);t!=null&&_(e,["description"],t);const i=g(n,["name"]);i!=null&&_(e,["name"],i);const r=g(n,["parameters"]);r!=null&&_(e,["parameters"],r);const a=g(n,["parametersJsonSchema"]);a!=null&&_(e,["parametersJsonSchema"],a);const u=g(n,["response"]);u!=null&&_(e,["response"],u);const f=g(n,["responseJsonSchema"]);return f!=null&&_(e,["responseJsonSchema"],f),e}function KM(n,e){const t={},i=g(e,["name"]);return i!=null&&_(t,["_url","name"],Ao(n,i)),t}function ZM(n,e){const t={},i=g(e,["name"]);return i!=null&&_(t,["_url","name"],Ao(n,i)),t}function JM(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function YM(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function WM(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=g(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function QM(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=g(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function $M(n){const e={},t=g(n,["config"]);return t!=null&&WM(t,e),e}function XM(n){const e={},t=g(n,["config"]);return t!=null&&QM(t,e),e}function eP(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=g(n,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>u)),_(e,["cachedContents"],a)}return e}function tP(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=g(n,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>u)),_(e,["cachedContents"],a)}return e}function nP(n){const e={},t=g(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=g(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=g(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const a=g(n,["fileData"]);a!=null&&_(e,["fileData"],qM(a));const u=g(n,["functionCall"]);u!=null&&_(e,["functionCall"],GM(u));const f=g(n,["functionResponse"]);f!=null&&_(e,["functionResponse"],f);const m=g(n,["inlineData"]);m!=null&&_(e,["inlineData"],DM(m));const p=g(n,["text"]);p!=null&&_(e,["text"],p);const E=g(n,["thought"]);E!=null&&_(e,["thought"],E);const S=g(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const A=g(n,["videoMetadata"]);return A!=null&&_(e,["videoMetadata"],A),e}function iP(n){const e={},t=g(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],HM(t));const i=g(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function sP(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>S)),_(e,["functionDeclarations"],E)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=g(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=g(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const a=g(n,["fileSearch"]);a!=null&&_(e,["fileSearch"],a);const u=g(n,["codeExecution"]);if(u!=null&&_(e,["codeExecution"],u),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const f=g(n,["googleMaps"]);f!=null&&_(e,["googleMaps"],JM(f));const m=g(n,["googleSearch"]);m!=null&&_(e,["googleSearch"],YM(m));const p=g(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function rP(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let S=t;Array.isArray(S)&&(S=S.map(A=>jM(A))),_(e,["functionDeclarations"],S)}const i=g(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=g(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const a=g(n,["computerUse"]);if(a!=null&&_(e,["computerUse"],a),g(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const u=g(n,["codeExecution"]);u!=null&&_(e,["codeExecution"],u);const f=g(n,["enterpriseWebSearch"]);f!=null&&_(e,["enterpriseWebSearch"],f);const m=g(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],m);const p=g(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const E=g(n,["urlContext"]);return E!=null&&_(e,["urlContext"],E),e}function oP(n,e){const t={},i=g(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=g(n,["expireTime"]);return e!==void 0&&r!=null&&_(e,["expireTime"],r),t}function aP(n,e){const t={},i=g(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=g(n,["expireTime"]);return e!==void 0&&r!=null&&_(e,["expireTime"],r),t}function lP(n,e){const t={},i=g(e,["name"]);i!=null&&_(t,["_url","name"],Ao(n,i));const r=g(e,["config"]);return r!=null&&oP(r,t),t}function uP(n,e){const t={},i=g(e,["name"]);i!=null&&_(t,["_url","name"],Ao(n,i));const r=g(e,["config"]);return r!=null&&aP(r,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cP extends bo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Wl(vo.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=OM(this.apiClient,e);return f=Le("cachedContents",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),u.then(E=>E)}else{const p=VM(this.apiClient,e);return f=Le("cachedContents",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json()),u.then(E=>E)}}async get(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=ZM(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),u.then(E=>E)}else{const p=KM(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json()),u.then(E=>E)}}async delete(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=BM(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=FM(E),A=new cw;return Object.assign(A,S),A})}else{const p=UM(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=zM(E),A=new cw;return Object.assign(A,S),A})}}async update(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=uP(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),u.then(E=>E)}else{const p=lP(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json()),u.then(E=>E)}}async listInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=XM(e);return f=Le("cachedContents",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=tP(E),A=new dw;return Object.assign(A,S),A})}else{const p=$M(e);return f=Le("cachedContents",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=eP(E),A=new dw;return Object.assign(A,S),A})}}}function yw(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function mn(n){return this instanceof mn?(this.v=n,this):new mn(n)}function Qu(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,a=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",u),r[Symbol.asyncIterator]=function(){return this},r;function u(R){return function(V){return Promise.resolve(V).then(R,S)}}function f(R,V){i[R]&&(r[R]=function(z){return new Promise(function(Z,X){a.push([R,z,Z,X])>1||m(R,z)})},V&&(r[R]=V(r[R])))}function m(R,V){try{p(i[R](V))}catch(z){A(a[0][3],z)}}function p(R){R.value instanceof mn?Promise.resolve(R.value.v).then(E,S):A(a[0][2],R)}function E(R){m("next",R)}function S(R){m("throw",R)}function A(R,V){R(V),a.shift(),a.length&&m(a[0][0],a[0][1])}}function Vd(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof yw=="function"?yw(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=n[a]&&function(u){return new Promise(function(f,m){u=n[a](u),r(f,m,u.done,u.value)})}}function r(a,u,f,m){Promise.resolve(m).then(function(p){a({value:p,done:f})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dP(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:a1(t)}function a1(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function hP(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function vw(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const r=[];let a=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),a&&!a1(n[i])&&(a=!1),i++;a?e.push(...r):e.pop()}return e}class fP{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new mP(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class mP{constructor(e,t,i,r={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=a,this.sendPromise=Promise.resolve(),hP(a)}async sendMessage(e){var t;await this.sendPromise;const i=Ti(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,u,f;const m=await r,p=(u=(a=m.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content,E=m.automaticFunctionCallingHistory,S=this.getHistory(!0).length;let A=[];E!=null&&(A=(f=E.slice(S))!==null&&f!==void 0?f:[]);const R=p?[p]:[];this.recordHistory(i,R,A)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const i=Ti(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const a=await r;return this.processStreamResponse(a,i)}getHistory(e=!1){const t=e?vw(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,r;return Qu(this,arguments,function*(){var u,f,m,p;const E=[];try{for(var S=!0,A=Vd(e),R;R=yield mn(A.next()),u=R.done,!u;S=!0){p=R.value,S=!1;const V=p;if(dP(V)){const z=(r=(i=V.candidates)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.content;z!==void 0&&E.push(z)}yield yield mn(V)}}catch(V){f={error:V}}finally{try{!S&&!u&&(m=A.return)&&(yield mn(m.call(A)))}finally{if(f)throw f.error}}this.recordHistory(t,E)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(a=>a.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...vw(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Um extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Um.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pP(n){const e={},t=g(n,["file"]);return t!=null&&_(e,["file"],t),e}function gP(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function _P(n){const e={},t=g(n,["name"]);return t!=null&&_(e,["_url","file"],e1(t)),e}function yP(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function vP(n){const e={},t=g(n,["name"]);return t!=null&&_(e,["_url","file"],e1(t)),e}function TP(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=g(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function xP(n){const e={},t=g(n,["config"]);return t!=null&&TP(t,e),e}function EP(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=g(n,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>u)),_(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wP extends bo{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Wl(vo.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=xP(e);return a=Le("files",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:m.headers},E})),r.then(m=>{const p=EP(m),E=new IR;return Object.assign(E,p),E})}}async createInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=pP(e);return a=Le("upload/v1beta/files",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=gP(m),E=new CR;return Object.assign(E,p),E})}}async get(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=vP(e);return a=Le("files/{file}",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>m)}}async delete(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=_P(e);return a=Le("files/{file}",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:m.headers},E})),r.then(m=>{const p=yP(m),E=new NR;return Object.assign(E,p),E})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zf(n){const e={},t=g(n,["data"]);if(t!=null&&_(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function SP(n){const e={},t=g(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>zP(a))),_(e,["parts"],r)}const i=g(n,["role"]);return i!=null&&_(e,["role"],i),e}function bP(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function AP(n){const e={},t=g(n,["id"]);t!=null&&_(e,["id"],t);const i=g(n,["args"]);i!=null&&_(e,["args"],i);const r=g(n,["name"]);if(r!=null&&_(e,["name"],r),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function IP(n){const e={};if(g(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=g(n,["description"]);t!=null&&_(e,["description"],t);const i=g(n,["name"]);i!=null&&_(e,["name"],i);const r=g(n,["parameters"]);r!=null&&_(e,["parameters"],r);const a=g(n,["parametersJsonSchema"]);a!=null&&_(e,["parametersJsonSchema"],a);const u=g(n,["response"]);u!=null&&_(e,["response"],u);const f=g(n,["responseJsonSchema"]);return f!=null&&_(e,["responseJsonSchema"],f),e}function CP(n){const e={},t=g(n,["modelSelectionConfig"]);t!=null&&_(e,["modelConfig"],t);const i=g(n,["responseJsonSchema"]);i!=null&&_(e,["responseJsonSchema"],i);const r=g(n,["audioTimestamp"]);r!=null&&_(e,["audioTimestamp"],r);const a=g(n,["candidateCount"]);a!=null&&_(e,["candidateCount"],a);const u=g(n,["enableAffectiveDialog"]);u!=null&&_(e,["enableAffectiveDialog"],u);const f=g(n,["frequencyPenalty"]);f!=null&&_(e,["frequencyPenalty"],f);const m=g(n,["logprobs"]);m!=null&&_(e,["logprobs"],m);const p=g(n,["maxOutputTokens"]);p!=null&&_(e,["maxOutputTokens"],p);const E=g(n,["mediaResolution"]);E!=null&&_(e,["mediaResolution"],E);const S=g(n,["presencePenalty"]);S!=null&&_(e,["presencePenalty"],S);const A=g(n,["responseLogprobs"]);A!=null&&_(e,["responseLogprobs"],A);const R=g(n,["responseMimeType"]);R!=null&&_(e,["responseMimeType"],R);const V=g(n,["responseModalities"]);V!=null&&_(e,["responseModalities"],V);const z=g(n,["responseSchema"]);z!=null&&_(e,["responseSchema"],z);const Z=g(n,["routingConfig"]);Z!=null&&_(e,["routingConfig"],Z);const X=g(n,["seed"]);X!=null&&_(e,["seed"],X);const ne=g(n,["speechConfig"]);ne!=null&&_(e,["speechConfig"],l1(ne));const Q=g(n,["stopSequences"]);Q!=null&&_(e,["stopSequences"],Q);const pe=g(n,["temperature"]);pe!=null&&_(e,["temperature"],pe);const he=g(n,["thinkingConfig"]);he!=null&&_(e,["thinkingConfig"],he);const Y=g(n,["topK"]);Y!=null&&_(e,["topK"],Y);const D=g(n,["topP"]);if(D!=null&&_(e,["topP"],D),g(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function NP(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function RP(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function MP(n,e){const t={},i=g(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],i);const r=g(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const a=g(n,["temperature"]);e!==void 0&&a!=null&&_(e,["setup","generationConfig","temperature"],a);const u=g(n,["topP"]);e!==void 0&&u!=null&&_(e,["setup","generationConfig","topP"],u);const f=g(n,["topK"]);e!==void 0&&f!=null&&_(e,["setup","generationConfig","topK"],f);const m=g(n,["maxOutputTokens"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","maxOutputTokens"],m);const p=g(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const E=g(n,["seed"]);e!==void 0&&E!=null&&_(e,["setup","generationConfig","seed"],E);const S=g(n,["speechConfig"]);e!==void 0&&S!=null&&_(e,["setup","generationConfig","speechConfig"],Oy(S));const A=g(n,["thinkingConfig"]);e!==void 0&&A!=null&&_(e,["setup","generationConfig","thinkingConfig"],A);const R=g(n,["enableAffectiveDialog"]);e!==void 0&&R!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],R);const V=g(n,["systemInstruction"]);e!==void 0&&V!=null&&_(e,["setup","systemInstruction"],SP(Ti(V)));const z=g(n,["tools"]);if(e!==void 0&&z!=null){let Y=Sc(z);Array.isArray(Y)&&(Y=Y.map(D=>qP(wc(D)))),_(e,["setup","tools"],Y)}const Z=g(n,["sessionResumption"]);e!==void 0&&Z!=null&&_(e,["setup","sessionResumption"],FP(Z));const X=g(n,["inputAudioTranscription"]);e!==void 0&&X!=null&&_(e,["setup","inputAudioTranscription"],X);const ne=g(n,["outputAudioTranscription"]);e!==void 0&&ne!=null&&_(e,["setup","outputAudioTranscription"],ne);const Q=g(n,["realtimeInputConfig"]);e!==void 0&&Q!=null&&_(e,["setup","realtimeInputConfig"],Q);const pe=g(n,["contextWindowCompression"]);e!==void 0&&pe!=null&&_(e,["setup","contextWindowCompression"],pe);const he=g(n,["proactivity"]);return e!==void 0&&he!=null&&_(e,["setup","proactivity"],he),t}function PP(n,e){const t={},i=g(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],CP(i));const r=g(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const a=g(n,["temperature"]);e!==void 0&&a!=null&&_(e,["setup","generationConfig","temperature"],a);const u=g(n,["topP"]);e!==void 0&&u!=null&&_(e,["setup","generationConfig","topP"],u);const f=g(n,["topK"]);e!==void 0&&f!=null&&_(e,["setup","generationConfig","topK"],f);const m=g(n,["maxOutputTokens"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","maxOutputTokens"],m);const p=g(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const E=g(n,["seed"]);e!==void 0&&E!=null&&_(e,["setup","generationConfig","seed"],E);const S=g(n,["speechConfig"]);e!==void 0&&S!=null&&_(e,["setup","generationConfig","speechConfig"],l1(Oy(S)));const A=g(n,["thinkingConfig"]);e!==void 0&&A!=null&&_(e,["setup","generationConfig","thinkingConfig"],A);const R=g(n,["enableAffectiveDialog"]);e!==void 0&&R!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],R);const V=g(n,["systemInstruction"]);e!==void 0&&V!=null&&_(e,["setup","systemInstruction"],Ti(V));const z=g(n,["tools"]);if(e!==void 0&&z!=null){let Y=Sc(z);Array.isArray(Y)&&(Y=Y.map(D=>GP(wc(D)))),_(e,["setup","tools"],Y)}const Z=g(n,["sessionResumption"]);e!==void 0&&Z!=null&&_(e,["setup","sessionResumption"],Z);const X=g(n,["inputAudioTranscription"]);e!==void 0&&X!=null&&_(e,["setup","inputAudioTranscription"],X);const ne=g(n,["outputAudioTranscription"]);e!==void 0&&ne!=null&&_(e,["setup","outputAudioTranscription"],ne);const Q=g(n,["realtimeInputConfig"]);e!==void 0&&Q!=null&&_(e,["setup","realtimeInputConfig"],Q);const pe=g(n,["contextWindowCompression"]);e!==void 0&&pe!=null&&_(e,["setup","contextWindowCompression"],pe);const he=g(n,["proactivity"]);return e!==void 0&&he!=null&&_(e,["setup","proactivity"],he),t}function DP(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["setup","model"],Ft(n,i));const r=g(e,["config"]);return r!=null&&_(t,["config"],MP(r,t)),t}function kP(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["setup","model"],Ft(n,i));const r=g(e,["config"]);return r!=null&&_(t,["config"],PP(r,t)),t}function LP(n){const e={},t=g(n,["musicGenerationConfig"]);return t!=null&&_(e,["musicGenerationConfig"],t),e}function VP(n){const e={},t=g(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["weightedPrompts"],i)}return e}function OP(n){const e={},t=g(n,["media"]);if(t!=null){let p=Yb(t);Array.isArray(p)&&(p=p.map(E=>zf(E))),_(e,["mediaChunks"],p)}const i=g(n,["audio"]);i!=null&&_(e,["audio"],zf(Qb(i)));const r=g(n,["audioStreamEnd"]);r!=null&&_(e,["audioStreamEnd"],r);const a=g(n,["video"]);a!=null&&_(e,["video"],zf(Wb(a)));const u=g(n,["text"]);u!=null&&_(e,["text"],u);const f=g(n,["activityStart"]);f!=null&&_(e,["activityStart"],f);const m=g(n,["activityEnd"]);return m!=null&&_(e,["activityEnd"],m),e}function UP(n){const e={},t=g(n,["media"]);if(t!=null){let p=Yb(t);Array.isArray(p)&&(p=p.map(E=>E)),_(e,["mediaChunks"],p)}const i=g(n,["audio"]);i!=null&&_(e,["audio"],Qb(i));const r=g(n,["audioStreamEnd"]);r!=null&&_(e,["audioStreamEnd"],r);const a=g(n,["video"]);a!=null&&_(e,["video"],Wb(a));const u=g(n,["text"]);u!=null&&_(e,["text"],u);const f=g(n,["activityStart"]);f!=null&&_(e,["activityStart"],f);const m=g(n,["activityEnd"]);return m!=null&&_(e,["activityEnd"],m),e}function BP(n){const e={},t=g(n,["setupComplete"]);t!=null&&_(e,["setupComplete"],t);const i=g(n,["serverContent"]);i!=null&&_(e,["serverContent"],i);const r=g(n,["toolCall"]);r!=null&&_(e,["toolCall"],r);const a=g(n,["toolCallCancellation"]);a!=null&&_(e,["toolCallCancellation"],a);const u=g(n,["usageMetadata"]);u!=null&&_(e,["usageMetadata"],HP(u));const f=g(n,["goAway"]);f!=null&&_(e,["goAway"],f);const m=g(n,["sessionResumptionUpdate"]);return m!=null&&_(e,["sessionResumptionUpdate"],m),e}function zP(n){const e={},t=g(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=g(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=g(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const a=g(n,["fileData"]);a!=null&&_(e,["fileData"],bP(a));const u=g(n,["functionCall"]);u!=null&&_(e,["functionCall"],AP(u));const f=g(n,["functionResponse"]);f!=null&&_(e,["functionResponse"],f);const m=g(n,["inlineData"]);m!=null&&_(e,["inlineData"],zf(m));const p=g(n,["text"]);p!=null&&_(e,["text"],p);const E=g(n,["thought"]);E!=null&&_(e,["thought"],E);const S=g(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const A=g(n,["videoMetadata"]);return A!=null&&_(e,["videoMetadata"],A),e}function FP(n){const e={},t=g(n,["handle"]);if(t!=null&&_(e,["handle"],t),g(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function l1(n){const e={},t=g(n,["languageCode"]);t!=null&&_(e,["languageCode"],t);const i=g(n,["voiceConfig"]);if(i!=null&&_(e,["voiceConfig"],i),g(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function qP(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>S)),_(e,["functionDeclarations"],E)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=g(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=g(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const a=g(n,["fileSearch"]);a!=null&&_(e,["fileSearch"],a);const u=g(n,["codeExecution"]);if(u!=null&&_(e,["codeExecution"],u),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const f=g(n,["googleMaps"]);f!=null&&_(e,["googleMaps"],NP(f));const m=g(n,["googleSearch"]);m!=null&&_(e,["googleSearch"],RP(m));const p=g(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function GP(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let S=t;Array.isArray(S)&&(S=S.map(A=>IP(A))),_(e,["functionDeclarations"],S)}const i=g(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=g(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const a=g(n,["computerUse"]);if(a!=null&&_(e,["computerUse"],a),g(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const u=g(n,["codeExecution"]);u!=null&&_(e,["codeExecution"],u);const f=g(n,["enterpriseWebSearch"]);f!=null&&_(e,["enterpriseWebSearch"],f);const m=g(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],m);const p=g(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const E=g(n,["urlContext"]);return E!=null&&_(e,["urlContext"],E),e}function HP(n){const e={},t=g(n,["promptTokenCount"]);t!=null&&_(e,["promptTokenCount"],t);const i=g(n,["cachedContentTokenCount"]);i!=null&&_(e,["cachedContentTokenCount"],i);const r=g(n,["candidatesTokenCount"]);r!=null&&_(e,["responseTokenCount"],r);const a=g(n,["toolUsePromptTokenCount"]);a!=null&&_(e,["toolUsePromptTokenCount"],a);const u=g(n,["thoughtsTokenCount"]);u!=null&&_(e,["thoughtsTokenCount"],u);const f=g(n,["totalTokenCount"]);f!=null&&_(e,["totalTokenCount"],f);const m=g(n,["promptTokensDetails"]);if(m!=null){let R=m;Array.isArray(R)&&(R=R.map(V=>V)),_(e,["promptTokensDetails"],R)}const p=g(n,["cacheTokensDetails"]);if(p!=null){let R=p;Array.isArray(R)&&(R=R.map(V=>V)),_(e,["cacheTokensDetails"],R)}const E=g(n,["candidatesTokensDetails"]);if(E!=null){let R=E;Array.isArray(R)&&(R=R.map(V=>V)),_(e,["responseTokensDetails"],R)}const S=g(n,["toolUsePromptTokensDetails"]);if(S!=null){let R=S;Array.isArray(R)&&(R=R.map(V=>V)),_(e,["toolUsePromptTokensDetails"],R)}const A=g(n,["trafficType"]);return A!=null&&_(e,["trafficType"],A),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jP(n){const e={},t=g(n,["data"]);if(t!=null&&_(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function KP(n){const e={},t=g(n,["content"]);t!=null&&_(e,["content"],t);const i=g(n,["citationMetadata"]);i!=null&&_(e,["citationMetadata"],ZP(i));const r=g(n,["tokenCount"]);r!=null&&_(e,["tokenCount"],r);const a=g(n,["finishReason"]);a!=null&&_(e,["finishReason"],a);const u=g(n,["avgLogprobs"]);u!=null&&_(e,["avgLogprobs"],u);const f=g(n,["groundingMetadata"]);f!=null&&_(e,["groundingMetadata"],f);const m=g(n,["index"]);m!=null&&_(e,["index"],m);const p=g(n,["logprobsResult"]);p!=null&&_(e,["logprobsResult"],p);const E=g(n,["safetyRatings"]);if(E!=null){let A=E;Array.isArray(A)&&(A=A.map(R=>R)),_(e,["safetyRatings"],A)}const S=g(n,["urlContextMetadata"]);return S!=null&&_(e,["urlContextMetadata"],S),e}function ZP(n){const e={},t=g(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["citations"],i)}return e}function JP(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["contents"]);if(r!=null){let a=Gs(r);Array.isArray(a)&&(a=a.map(u=>u)),_(t,["contents"],a)}return t}function YP(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["tokensInfo"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),_(e,["tokensInfo"],r)}return e}function WP(n){const e={},t=g(n,["values"]);t!=null&&_(e,["values"],t);const i=g(n,["statistics"]);return i!=null&&_(e,["statistics"],QP(i)),e}function QP(n){const e={},t=g(n,["truncated"]);t!=null&&_(e,["truncated"],t);const i=g(n,["token_count"]);return i!=null&&_(e,["tokenCount"],i),e}function Bm(n){const e={},t=g(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>o5(a))),_(e,["parts"],r)}const i=g(n,["role"]);return i!=null&&_(e,["role"],i),e}function $P(n){const e={},t=g(n,["controlType"]);t!=null&&_(e,["controlType"],t);const i=g(n,["enableControlImageComputation"]);return i!=null&&_(e,["computeControl"],i),e}function XP(n){const e={};if(g(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(g(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(g(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function eD(n,e){const t={},i=g(n,["systemInstruction"]);e!==void 0&&i!=null&&_(e,["systemInstruction"],Ti(i));const r=g(n,["tools"]);if(e!==void 0&&r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>f1(f))),_(e,["tools"],u)}const a=g(n,["generationConfig"]);return e!==void 0&&a!=null&&_(e,["generationConfig"],jD(a)),t}function tD(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["contents"]);if(r!=null){let u=Gs(r);Array.isArray(u)&&(u=u.map(f=>Bm(f))),_(t,["contents"],u)}const a=g(e,["config"]);return a!=null&&XP(a),t}function nD(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["contents"]);if(r!=null){let u=Gs(r);Array.isArray(u)&&(u=u.map(f=>f)),_(t,["contents"],u)}const a=g(e,["config"]);return a!=null&&eD(a,t),t}function iD(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["totalTokens"]);i!=null&&_(e,["totalTokens"],i);const r=g(n,["cachedContentTokenCount"]);return r!=null&&_(e,["cachedContentTokenCount"],r),e}function sD(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["totalTokens"]);return i!=null&&_(e,["totalTokens"],i),e}function rD(n,e){const t={},i=g(e,["model"]);return i!=null&&_(t,["_url","name"],Ft(n,i)),t}function oD(n,e){const t={},i=g(e,["model"]);return i!=null&&_(t,["_url","name"],Ft(n,i)),t}function aD(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function lD(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function uD(n,e){const t={},i=g(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=g(n,["negativePrompt"]);e!==void 0&&r!=null&&_(e,["parameters","negativePrompt"],r);const a=g(n,["numberOfImages"]);e!==void 0&&a!=null&&_(e,["parameters","sampleCount"],a);const u=g(n,["aspectRatio"]);e!==void 0&&u!=null&&_(e,["parameters","aspectRatio"],u);const f=g(n,["guidanceScale"]);e!==void 0&&f!=null&&_(e,["parameters","guidanceScale"],f);const m=g(n,["seed"]);e!==void 0&&m!=null&&_(e,["parameters","seed"],m);const p=g(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&_(e,["parameters","safetySetting"],p);const E=g(n,["personGeneration"]);e!==void 0&&E!=null&&_(e,["parameters","personGeneration"],E);const S=g(n,["includeSafetyAttributes"]);e!==void 0&&S!=null&&_(e,["parameters","includeSafetyAttributes"],S);const A=g(n,["includeRaiReason"]);e!==void 0&&A!=null&&_(e,["parameters","includeRaiReason"],A);const R=g(n,["language"]);e!==void 0&&R!=null&&_(e,["parameters","language"],R);const V=g(n,["outputMimeType"]);e!==void 0&&V!=null&&_(e,["parameters","outputOptions","mimeType"],V);const z=g(n,["outputCompressionQuality"]);e!==void 0&&z!=null&&_(e,["parameters","outputOptions","compressionQuality"],z);const Z=g(n,["addWatermark"]);e!==void 0&&Z!=null&&_(e,["parameters","addWatermark"],Z);const X=g(n,["labels"]);e!==void 0&&X!=null&&_(e,["labels"],X);const ne=g(n,["editMode"]);e!==void 0&&ne!=null&&_(e,["parameters","editMode"],ne);const Q=g(n,["baseSteps"]);return e!==void 0&&Q!=null&&_(e,["parameters","editConfig","baseSteps"],Q),t}function cD(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const a=g(e,["referenceImages"]);if(a!=null){let f=a;Array.isArray(f)&&(f=f.map(m=>h5(m))),_(t,["instances[0]","referenceImages"],f)}const u=g(e,["config"]);return u!=null&&uD(u,t),t}function dD(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>zm(a))),_(e,["generatedImages"],r)}return e}function hD(n,e){const t={},i=g(n,["taskType"]);e!==void 0&&i!=null&&_(e,["requests[]","taskType"],i);const r=g(n,["title"]);e!==void 0&&r!=null&&_(e,["requests[]","title"],r);const a=g(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&_(e,["requests[]","outputDimensionality"],a),g(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(g(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function fD(n,e){const t={},i=g(n,["taskType"]);e!==void 0&&i!=null&&_(e,["instances[]","task_type"],i);const r=g(n,["title"]);e!==void 0&&r!=null&&_(e,["instances[]","title"],r);const a=g(n,["outputDimensionality"]);e!==void 0&&a!=null&&_(e,["parameters","outputDimensionality"],a);const u=g(n,["mimeType"]);e!==void 0&&u!=null&&_(e,["instances[]","mimeType"],u);const f=g(n,["autoTruncate"]);return e!==void 0&&f!=null&&_(e,["parameters","autoTruncate"],f),t}function mD(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["contents"]);if(r!=null){let f=ky(n,r);Array.isArray(f)&&(f=f.map(m=>m)),_(t,["requests[]","content"],f)}const a=g(e,["config"]);a!=null&&hD(a,t);const u=g(e,["model"]);return u!==void 0&&_(t,["requests[]","model"],Ft(n,u)),t}function pD(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["contents"]);if(r!=null){let u=ky(n,r);Array.isArray(u)&&(u=u.map(f=>f)),_(t,["instances[]","content"],u)}const a=g(e,["config"]);return a!=null&&fD(a,t),t}function gD(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>u)),_(e,["embeddings"],a)}const r=g(n,["metadata"]);return r!=null&&_(e,["metadata"],r),e}function _D(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["predictions[]","embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>WP(u))),_(e,["embeddings"],a)}const r=g(n,["metadata"]);return r!=null&&_(e,["metadata"],r),e}function yD(n){const e={},t=g(n,["endpoint"]);t!=null&&_(e,["name"],t);const i=g(n,["deployedModelId"]);return i!=null&&_(e,["deployedModelId"],i),e}function vD(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function TD(n){const e={},t=g(n,["id"]);t!=null&&_(e,["id"],t);const i=g(n,["args"]);i!=null&&_(e,["args"],i);const r=g(n,["name"]);if(r!=null&&_(e,["name"],r),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function xD(n){const e={},t=g(n,["mode"]);t!=null&&_(e,["mode"],t);const i=g(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),g(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ED(n){const e={};if(g(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=g(n,["description"]);t!=null&&_(e,["description"],t);const i=g(n,["name"]);i!=null&&_(e,["name"],i);const r=g(n,["parameters"]);r!=null&&_(e,["parameters"],r);const a=g(n,["parametersJsonSchema"]);a!=null&&_(e,["parametersJsonSchema"],a);const u=g(n,["response"]);u!=null&&_(e,["response"],u);const f=g(n,["responseJsonSchema"]);return f!=null&&_(e,["responseJsonSchema"],f),e}function wD(n,e,t){const i={},r=g(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],Bm(Ti(r)));const a=g(e,["temperature"]);a!=null&&_(i,["temperature"],a);const u=g(e,["topP"]);u!=null&&_(i,["topP"],u);const f=g(e,["topK"]);f!=null&&_(i,["topK"],f);const m=g(e,["candidateCount"]);m!=null&&_(i,["candidateCount"],m);const p=g(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const E=g(e,["stopSequences"]);E!=null&&_(i,["stopSequences"],E);const S=g(e,["responseLogprobs"]);S!=null&&_(i,["responseLogprobs"],S);const A=g(e,["logprobs"]);A!=null&&_(i,["logprobs"],A);const R=g(e,["presencePenalty"]);R!=null&&_(i,["presencePenalty"],R);const V=g(e,["frequencyPenalty"]);V!=null&&_(i,["frequencyPenalty"],V);const z=g(e,["seed"]);z!=null&&_(i,["seed"],z);const Z=g(e,["responseMimeType"]);Z!=null&&_(i,["responseMimeType"],Z);const X=g(e,["responseSchema"]);X!=null&&_(i,["responseSchema"],Ly(X));const ne=g(e,["responseJsonSchema"]);if(ne!=null&&_(i,["responseJsonSchema"],ne),g(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(g(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const Q=g(e,["safetySettings"]);if(t!==void 0&&Q!=null){let K=Q;Array.isArray(K)&&(K=K.map(F=>f5(F))),_(t,["safetySettings"],K)}const pe=g(e,["tools"]);if(t!==void 0&&pe!=null){let K=Sc(pe);Array.isArray(K)&&(K=K.map(F=>T5(wc(F)))),_(t,["tools"],K)}const he=g(e,["toolConfig"]);if(t!==void 0&&he!=null&&_(t,["toolConfig"],v5(he)),g(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const Y=g(e,["cachedContent"]);t!==void 0&&Y!=null&&_(t,["cachedContent"],Ao(n,Y));const D=g(e,["responseModalities"]);D!=null&&_(i,["responseModalities"],D);const B=g(e,["mediaResolution"]);B!=null&&_(i,["mediaResolution"],B);const O=g(e,["speechConfig"]);if(O!=null&&_(i,["speechConfig"],Vy(O)),g(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const G=g(e,["thinkingConfig"]);G!=null&&_(i,["thinkingConfig"],G);const q=g(e,["imageConfig"]);return q!=null&&_(i,["imageConfig"],WD(q)),i}function SD(n,e,t){const i={},r=g(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],Ti(r));const a=g(e,["temperature"]);a!=null&&_(i,["temperature"],a);const u=g(e,["topP"]);u!=null&&_(i,["topP"],u);const f=g(e,["topK"]);f!=null&&_(i,["topK"],f);const m=g(e,["candidateCount"]);m!=null&&_(i,["candidateCount"],m);const p=g(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const E=g(e,["stopSequences"]);E!=null&&_(i,["stopSequences"],E);const S=g(e,["responseLogprobs"]);S!=null&&_(i,["responseLogprobs"],S);const A=g(e,["logprobs"]);A!=null&&_(i,["logprobs"],A);const R=g(e,["presencePenalty"]);R!=null&&_(i,["presencePenalty"],R);const V=g(e,["frequencyPenalty"]);V!=null&&_(i,["frequencyPenalty"],V);const z=g(e,["seed"]);z!=null&&_(i,["seed"],z);const Z=g(e,["responseMimeType"]);Z!=null&&_(i,["responseMimeType"],Z);const X=g(e,["responseSchema"]);X!=null&&_(i,["responseSchema"],Ly(X));const ne=g(e,["responseJsonSchema"]);ne!=null&&_(i,["responseJsonSchema"],ne);const Q=g(e,["routingConfig"]);Q!=null&&_(i,["routingConfig"],Q);const pe=g(e,["modelSelectionConfig"]);pe!=null&&_(i,["modelConfig"],pe);const he=g(e,["safetySettings"]);if(t!==void 0&&he!=null){let ie=he;Array.isArray(ie)&&(ie=ie.map(be=>be)),_(t,["safetySettings"],ie)}const Y=g(e,["tools"]);if(t!==void 0&&Y!=null){let ie=Sc(Y);Array.isArray(ie)&&(ie=ie.map(be=>f1(wc(be)))),_(t,["tools"],ie)}const D=g(e,["toolConfig"]);t!==void 0&&D!=null&&_(t,["toolConfig"],D);const B=g(e,["labels"]);t!==void 0&&B!=null&&_(t,["labels"],B);const O=g(e,["cachedContent"]);t!==void 0&&O!=null&&_(t,["cachedContent"],Ao(n,O));const G=g(e,["responseModalities"]);G!=null&&_(i,["responseModalities"],G);const q=g(e,["mediaResolution"]);q!=null&&_(i,["mediaResolution"],q);const K=g(e,["speechConfig"]);K!=null&&_(i,["speechConfig"],h1(Vy(K)));const F=g(e,["audioTimestamp"]);F!=null&&_(i,["audioTimestamp"],F);const qe=g(e,["thinkingConfig"]);qe!=null&&_(i,["thinkingConfig"],qe);const Je=g(e,["imageConfig"]);return Je!=null&&_(i,["imageConfig"],QD(Je)),i}function Tw(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["contents"]);if(r!=null){let u=Gs(r);Array.isArray(u)&&(u=u.map(f=>Bm(f))),_(t,["contents"],u)}const a=g(e,["config"]);return a!=null&&_(t,["generationConfig"],wD(n,a,t)),t}function xw(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["contents"]);if(r!=null){let u=Gs(r);Array.isArray(u)&&(u=u.map(f=>f)),_(t,["contents"],u)}const a=g(e,["config"]);return a!=null&&_(t,["generationConfig"],SD(n,a,t)),t}function Ew(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["candidates"]);if(i!=null){let m=i;Array.isArray(m)&&(m=m.map(p=>KP(p))),_(e,["candidates"],m)}const r=g(n,["modelVersion"]);r!=null&&_(e,["modelVersion"],r);const a=g(n,["promptFeedback"]);a!=null&&_(e,["promptFeedback"],a);const u=g(n,["responseId"]);u!=null&&_(e,["responseId"],u);const f=g(n,["usageMetadata"]);return f!=null&&_(e,["usageMetadata"],f),e}function ww(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(E=>E)),_(e,["candidates"],p)}const r=g(n,["createTime"]);r!=null&&_(e,["createTime"],r);const a=g(n,["modelVersion"]);a!=null&&_(e,["modelVersion"],a);const u=g(n,["promptFeedback"]);u!=null&&_(e,["promptFeedback"],u);const f=g(n,["responseId"]);f!=null&&_(e,["responseId"],f);const m=g(n,["usageMetadata"]);return m!=null&&_(e,["usageMetadata"],m),e}function bD(n,e){const t={};if(g(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=g(n,["numberOfImages"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=g(n,["aspectRatio"]);e!==void 0&&r!=null&&_(e,["parameters","aspectRatio"],r);const a=g(n,["guidanceScale"]);if(e!==void 0&&a!=null&&_(e,["parameters","guidanceScale"],a),g(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=g(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&_(e,["parameters","safetySetting"],u);const f=g(n,["personGeneration"]);e!==void 0&&f!=null&&_(e,["parameters","personGeneration"],f);const m=g(n,["includeSafetyAttributes"]);e!==void 0&&m!=null&&_(e,["parameters","includeSafetyAttributes"],m);const p=g(n,["includeRaiReason"]);e!==void 0&&p!=null&&_(e,["parameters","includeRaiReason"],p);const E=g(n,["language"]);e!==void 0&&E!=null&&_(e,["parameters","language"],E);const S=g(n,["outputMimeType"]);e!==void 0&&S!=null&&_(e,["parameters","outputOptions","mimeType"],S);const A=g(n,["outputCompressionQuality"]);if(e!==void 0&&A!=null&&_(e,["parameters","outputOptions","compressionQuality"],A),g(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(g(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=g(n,["imageSize"]);if(e!==void 0&&R!=null&&_(e,["parameters","sampleImageSize"],R),g(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function AD(n,e){const t={},i=g(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=g(n,["negativePrompt"]);e!==void 0&&r!=null&&_(e,["parameters","negativePrompt"],r);const a=g(n,["numberOfImages"]);e!==void 0&&a!=null&&_(e,["parameters","sampleCount"],a);const u=g(n,["aspectRatio"]);e!==void 0&&u!=null&&_(e,["parameters","aspectRatio"],u);const f=g(n,["guidanceScale"]);e!==void 0&&f!=null&&_(e,["parameters","guidanceScale"],f);const m=g(n,["seed"]);e!==void 0&&m!=null&&_(e,["parameters","seed"],m);const p=g(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&_(e,["parameters","safetySetting"],p);const E=g(n,["personGeneration"]);e!==void 0&&E!=null&&_(e,["parameters","personGeneration"],E);const S=g(n,["includeSafetyAttributes"]);e!==void 0&&S!=null&&_(e,["parameters","includeSafetyAttributes"],S);const A=g(n,["includeRaiReason"]);e!==void 0&&A!=null&&_(e,["parameters","includeRaiReason"],A);const R=g(n,["language"]);e!==void 0&&R!=null&&_(e,["parameters","language"],R);const V=g(n,["outputMimeType"]);e!==void 0&&V!=null&&_(e,["parameters","outputOptions","mimeType"],V);const z=g(n,["outputCompressionQuality"]);e!==void 0&&z!=null&&_(e,["parameters","outputOptions","compressionQuality"],z);const Z=g(n,["addWatermark"]);e!==void 0&&Z!=null&&_(e,["parameters","addWatermark"],Z);const X=g(n,["labels"]);e!==void 0&&X!=null&&_(e,["labels"],X);const ne=g(n,["imageSize"]);e!==void 0&&ne!=null&&_(e,["parameters","sampleImageSize"],ne);const Q=g(n,["enhancePrompt"]);return e!==void 0&&Q!=null&&_(e,["parameters","enhancePrompt"],Q),t}function ID(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const a=g(e,["config"]);return a!=null&&bD(a,t),t}function CD(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const a=g(e,["config"]);return a!=null&&AD(a,t),t}function ND(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>FD(u))),_(e,["generatedImages"],a)}const r=g(n,["positivePromptSafetyAttributes"]);return r!=null&&_(e,["positivePromptSafetyAttributes"],c1(r)),e}function RD(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>zm(u))),_(e,["generatedImages"],a)}const r=g(n,["positivePromptSafetyAttributes"]);return r!=null&&_(e,["positivePromptSafetyAttributes"],d1(r)),e}function MD(n,e){const t={},i=g(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i),g(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(g(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=g(n,["durationSeconds"]);if(e!==void 0&&r!=null&&_(e,["parameters","durationSeconds"],r),g(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=g(n,["aspectRatio"]);e!==void 0&&a!=null&&_(e,["parameters","aspectRatio"],a);const u=g(n,["resolution"]);e!==void 0&&u!=null&&_(e,["parameters","resolution"],u);const f=g(n,["personGeneration"]);if(e!==void 0&&f!=null&&_(e,["parameters","personGeneration"],f),g(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const m=g(n,["negativePrompt"]);e!==void 0&&m!=null&&_(e,["parameters","negativePrompt"],m);const p=g(n,["enhancePrompt"]);if(e!==void 0&&p!=null&&_(e,["parameters","enhancePrompt"],p),g(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const E=g(n,["lastFrame"]);e!==void 0&&E!=null&&_(e,["instances[0]","lastFrame"],Fm(E));const S=g(n,["referenceImages"]);if(e!==void 0&&S!=null){let A=S;Array.isArray(A)&&(A=A.map(R=>D5(R))),_(e,["instances[0]","referenceImages"],A)}if(g(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(g(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function PD(n,e){const t={},i=g(n,["numberOfVideos"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=g(n,["outputGcsUri"]);e!==void 0&&r!=null&&_(e,["parameters","storageUri"],r);const a=g(n,["fps"]);e!==void 0&&a!=null&&_(e,["parameters","fps"],a);const u=g(n,["durationSeconds"]);e!==void 0&&u!=null&&_(e,["parameters","durationSeconds"],u);const f=g(n,["seed"]);e!==void 0&&f!=null&&_(e,["parameters","seed"],f);const m=g(n,["aspectRatio"]);e!==void 0&&m!=null&&_(e,["parameters","aspectRatio"],m);const p=g(n,["resolution"]);e!==void 0&&p!=null&&_(e,["parameters","resolution"],p);const E=g(n,["personGeneration"]);e!==void 0&&E!=null&&_(e,["parameters","personGeneration"],E);const S=g(n,["pubsubTopic"]);e!==void 0&&S!=null&&_(e,["parameters","pubsubTopic"],S);const A=g(n,["negativePrompt"]);e!==void 0&&A!=null&&_(e,["parameters","negativePrompt"],A);const R=g(n,["enhancePrompt"]);e!==void 0&&R!=null&&_(e,["parameters","enhancePrompt"],R);const V=g(n,["generateAudio"]);e!==void 0&&V!=null&&_(e,["parameters","generateAudio"],V);const z=g(n,["lastFrame"]);e!==void 0&&z!=null&&_(e,["instances[0]","lastFrame"],ur(z));const Z=g(n,["referenceImages"]);if(e!==void 0&&Z!=null){let Q=Z;Array.isArray(Q)&&(Q=Q.map(pe=>k5(pe))),_(e,["instances[0]","referenceImages"],Q)}const X=g(n,["mask"]);e!==void 0&&X!=null&&_(e,["instances[0]","mask"],P5(X));const ne=g(n,["compressionQuality"]);return e!==void 0&&ne!=null&&_(e,["parameters","compressionQuality"],ne),t}function DD(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=g(n,["done"]);r!=null&&_(e,["done"],r);const a=g(n,["error"]);a!=null&&_(e,["error"],a);const u=g(n,["response","generateVideoResponse"]);return u!=null&&_(e,["response"],OD(u)),e}function kD(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=g(n,["done"]);r!=null&&_(e,["done"],r);const a=g(n,["error"]);a!=null&&_(e,["error"],a);const u=g(n,["response"]);return u!=null&&_(e,["response"],UD(u)),e}function LD(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const a=g(e,["image"]);a!=null&&_(t,["instances[0]","image"],Fm(a));const u=g(e,["video"]);u!=null&&_(t,["instances[0]","video"],m1(u));const f=g(e,["source"]);f!=null&&BD(f,t);const m=g(e,["config"]);return m!=null&&MD(m,t),t}function VD(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const a=g(e,["image"]);a!=null&&_(t,["instances[0]","image"],ur(a));const u=g(e,["video"]);u!=null&&_(t,["instances[0]","video"],p1(u));const f=g(e,["source"]);f!=null&&zD(f,t);const m=g(e,["config"]);return m!=null&&PD(m,t),t}function OD(n){const e={},t=g(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>GD(u))),_(e,["generatedVideos"],a)}const i=g(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=g(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function UD(n){const e={},t=g(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>HD(u))),_(e,["generatedVideos"],a)}const i=g(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=g(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function BD(n,e){const t={},i=g(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=g(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],Fm(r));const a=g(n,["video"]);return e!==void 0&&a!=null&&_(e,["instances[0]","video"],m1(a)),t}function zD(n,e){const t={},i=g(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=g(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],ur(r));const a=g(n,["video"]);return e!==void 0&&a!=null&&_(e,["instances[0]","video"],p1(a)),t}function FD(n){const e={},t=g(n,["_self"]);t!=null&&_(e,["image"],$D(t));const i=g(n,["raiFilteredReason"]);i!=null&&_(e,["raiFilteredReason"],i);const r=g(n,["_self"]);return r!=null&&_(e,["safetyAttributes"],c1(r)),e}function zm(n){const e={},t=g(n,["_self"]);t!=null&&_(e,["image"],u1(t));const i=g(n,["raiFilteredReason"]);i!=null&&_(e,["raiFilteredReason"],i);const r=g(n,["_self"]);r!=null&&_(e,["safetyAttributes"],d1(r));const a=g(n,["prompt"]);return a!=null&&_(e,["enhancedPrompt"],a),e}function qD(n){const e={},t=g(n,["_self"]);t!=null&&_(e,["mask"],u1(t));const i=g(n,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),_(e,["labels"],r)}return e}function GD(n){const e={},t=g(n,["video"]);return t!=null&&_(e,["video"],R5(t)),e}function HD(n){const e={},t=g(n,["_self"]);return t!=null&&_(e,["video"],M5(t)),e}function jD(n){const e={},t=g(n,["modelSelectionConfig"]);t!=null&&_(e,["modelConfig"],t);const i=g(n,["responseJsonSchema"]);i!=null&&_(e,["responseJsonSchema"],i);const r=g(n,["audioTimestamp"]);r!=null&&_(e,["audioTimestamp"],r);const a=g(n,["candidateCount"]);a!=null&&_(e,["candidateCount"],a);const u=g(n,["enableAffectiveDialog"]);u!=null&&_(e,["enableAffectiveDialog"],u);const f=g(n,["frequencyPenalty"]);f!=null&&_(e,["frequencyPenalty"],f);const m=g(n,["logprobs"]);m!=null&&_(e,["logprobs"],m);const p=g(n,["maxOutputTokens"]);p!=null&&_(e,["maxOutputTokens"],p);const E=g(n,["mediaResolution"]);E!=null&&_(e,["mediaResolution"],E);const S=g(n,["presencePenalty"]);S!=null&&_(e,["presencePenalty"],S);const A=g(n,["responseLogprobs"]);A!=null&&_(e,["responseLogprobs"],A);const R=g(n,["responseMimeType"]);R!=null&&_(e,["responseMimeType"],R);const V=g(n,["responseModalities"]);V!=null&&_(e,["responseModalities"],V);const z=g(n,["responseSchema"]);z!=null&&_(e,["responseSchema"],z);const Z=g(n,["routingConfig"]);Z!=null&&_(e,["routingConfig"],Z);const X=g(n,["seed"]);X!=null&&_(e,["seed"],X);const ne=g(n,["speechConfig"]);ne!=null&&_(e,["speechConfig"],h1(ne));const Q=g(n,["stopSequences"]);Q!=null&&_(e,["stopSequences"],Q);const pe=g(n,["temperature"]);pe!=null&&_(e,["temperature"],pe);const he=g(n,["thinkingConfig"]);he!=null&&_(e,["thinkingConfig"],he);const Y=g(n,["topK"]);Y!=null&&_(e,["topK"],Y);const D=g(n,["topP"]);if(D!=null&&_(e,["topP"],D),g(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function KD(n,e){const t={},i=g(e,["model"]);return i!=null&&_(t,["_url","name"],Ft(n,i)),t}function ZD(n,e){const t={},i=g(e,["model"]);return i!=null&&_(t,["_url","name"],Ft(n,i)),t}function JD(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function YD(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function WD(n){const e={},t=g(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=g(n,["imageSize"]);if(i!=null&&_(e,["imageSize"],i),g(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(g(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function QD(n){const e={},t=g(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=g(n,["imageSize"]);i!=null&&_(e,["imageSize"],i);const r=g(n,["outputMimeType"]);r!=null&&_(e,["imageOutputOptions","mimeType"],r);const a=g(n,["outputCompressionQuality"]);return a!=null&&_(e,["imageOutputOptions","compressionQuality"],a),e}function $D(n){const e={},t=g(n,["bytesBase64Encoded"]);t!=null&&_(e,["imageBytes"],Va(t));const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function u1(n){const e={},t=g(n,["gcsUri"]);t!=null&&_(e,["gcsUri"],t);const i=g(n,["bytesBase64Encoded"]);i!=null&&_(e,["imageBytes"],Va(i));const r=g(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function Fm(n){const e={};if(g(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=g(n,["imageBytes"]);t!=null&&_(e,["bytesBase64Encoded"],Va(t));const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function ur(n){const e={},t=g(n,["gcsUri"]);t!=null&&_(e,["gcsUri"],t);const i=g(n,["imageBytes"]);i!=null&&_(e,["bytesBase64Encoded"],Va(i));const r=g(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function XD(n,e,t){const i={},r=g(e,["pageSize"]);t!==void 0&&r!=null&&_(t,["_query","pageSize"],r);const a=g(e,["pageToken"]);t!==void 0&&a!=null&&_(t,["_query","pageToken"],a);const u=g(e,["filter"]);t!==void 0&&u!=null&&_(t,["_query","filter"],u);const f=g(e,["queryBase"]);return t!==void 0&&f!=null&&_(t,["_url","models_url"],t1(n,f)),i}function e5(n,e,t){const i={},r=g(e,["pageSize"]);t!==void 0&&r!=null&&_(t,["_query","pageSize"],r);const a=g(e,["pageToken"]);t!==void 0&&a!=null&&_(t,["_query","pageToken"],a);const u=g(e,["filter"]);t!==void 0&&u!=null&&_(t,["_query","filter"],u);const f=g(e,["queryBase"]);return t!==void 0&&f!=null&&_(t,["_url","models_url"],t1(n,f)),i}function t5(n,e){const t={},i=g(e,["config"]);return i!=null&&XD(n,i,t),t}function n5(n,e){const t={},i=g(e,["config"]);return i!=null&&e5(n,i,t),t}function i5(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=g(n,["_self"]);if(r!=null){let a=n1(r);Array.isArray(a)&&(a=a.map(u=>U_(u))),_(e,["models"],a)}return e}function s5(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=g(n,["_self"]);if(r!=null){let a=n1(r);Array.isArray(a)&&(a=a.map(u=>B_(u))),_(e,["models"],a)}return e}function r5(n){const e={},t=g(n,["maskMode"]);t!=null&&_(e,["maskMode"],t);const i=g(n,["segmentationClasses"]);i!=null&&_(e,["maskClasses"],i);const r=g(n,["maskDilation"]);return r!=null&&_(e,["dilation"],r),e}function U_(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=g(n,["description"]);r!=null&&_(e,["description"],r);const a=g(n,["version"]);a!=null&&_(e,["version"],a);const u=g(n,["_self"]);u!=null&&_(e,["tunedModelInfo"],x5(u));const f=g(n,["inputTokenLimit"]);f!=null&&_(e,["inputTokenLimit"],f);const m=g(n,["outputTokenLimit"]);m!=null&&_(e,["outputTokenLimit"],m);const p=g(n,["supportedGenerationMethods"]);p!=null&&_(e,["supportedActions"],p);const E=g(n,["temperature"]);E!=null&&_(e,["temperature"],E);const S=g(n,["maxTemperature"]);S!=null&&_(e,["maxTemperature"],S);const A=g(n,["topP"]);A!=null&&_(e,["topP"],A);const R=g(n,["topK"]);R!=null&&_(e,["topK"],R);const V=g(n,["thinking"]);return V!=null&&_(e,["thinking"],V),e}function B_(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=g(n,["description"]);r!=null&&_(e,["description"],r);const a=g(n,["versionId"]);a!=null&&_(e,["version"],a);const u=g(n,["deployedModels"]);if(u!=null){let S=u;Array.isArray(S)&&(S=S.map(A=>yD(A))),_(e,["endpoints"],S)}const f=g(n,["labels"]);f!=null&&_(e,["labels"],f);const m=g(n,["_self"]);m!=null&&_(e,["tunedModelInfo"],E5(m));const p=g(n,["defaultCheckpointId"]);p!=null&&_(e,["defaultCheckpointId"],p);const E=g(n,["checkpoints"]);if(E!=null){let S=E;Array.isArray(S)&&(S=S.map(A=>A)),_(e,["checkpoints"],S)}return e}function o5(n){const e={},t=g(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=g(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=g(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const a=g(n,["fileData"]);a!=null&&_(e,["fileData"],vD(a));const u=g(n,["functionCall"]);u!=null&&_(e,["functionCall"],TD(u));const f=g(n,["functionResponse"]);f!=null&&_(e,["functionResponse"],f);const m=g(n,["inlineData"]);m!=null&&_(e,["inlineData"],jP(m));const p=g(n,["text"]);p!=null&&_(e,["text"],p);const E=g(n,["thought"]);E!=null&&_(e,["thought"],E);const S=g(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const A=g(n,["videoMetadata"]);return A!=null&&_(e,["videoMetadata"],A),e}function a5(n){const e={},t=g(n,["productImage"]);return t!=null&&_(e,["image"],ur(t)),e}function l5(n,e){const t={},i=g(n,["numberOfImages"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=g(n,["baseSteps"]);e!==void 0&&r!=null&&_(e,["parameters","baseSteps"],r);const a=g(n,["outputGcsUri"]);e!==void 0&&a!=null&&_(e,["parameters","storageUri"],a);const u=g(n,["seed"]);e!==void 0&&u!=null&&_(e,["parameters","seed"],u);const f=g(n,["safetyFilterLevel"]);e!==void 0&&f!=null&&_(e,["parameters","safetySetting"],f);const m=g(n,["personGeneration"]);e!==void 0&&m!=null&&_(e,["parameters","personGeneration"],m);const p=g(n,["addWatermark"]);e!==void 0&&p!=null&&_(e,["parameters","addWatermark"],p);const E=g(n,["outputMimeType"]);e!==void 0&&E!=null&&_(e,["parameters","outputOptions","mimeType"],E);const S=g(n,["outputCompressionQuality"]);e!==void 0&&S!=null&&_(e,["parameters","outputOptions","compressionQuality"],S);const A=g(n,["enhancePrompt"]);e!==void 0&&A!=null&&_(e,["parameters","enhancePrompt"],A);const R=g(n,["labels"]);return e!==void 0&&R!=null&&_(e,["labels"],R),t}function u5(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["source"]);r!=null&&d5(r,t);const a=g(e,["config"]);return a!=null&&l5(a,t),t}function c5(n){const e={},t=g(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>zm(r))),_(e,["generatedImages"],i)}return e}function d5(n,e){const t={},i=g(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=g(n,["personImage"]);e!==void 0&&r!=null&&_(e,["instances[0]","personImage","image"],ur(r));const a=g(n,["productImages"]);if(e!==void 0&&a!=null){let u=a;Array.isArray(u)&&(u=u.map(f=>a5(f))),_(e,["instances[0]","productImages"],u)}return t}function h5(n){const e={},t=g(n,["referenceImage"]);t!=null&&_(e,["referenceImage"],ur(t));const i=g(n,["referenceId"]);i!=null&&_(e,["referenceId"],i);const r=g(n,["referenceType"]);r!=null&&_(e,["referenceType"],r);const a=g(n,["maskImageConfig"]);a!=null&&_(e,["maskImageConfig"],r5(a));const u=g(n,["controlImageConfig"]);u!=null&&_(e,["controlImageConfig"],$P(u));const f=g(n,["styleImageConfig"]);f!=null&&_(e,["styleImageConfig"],f);const m=g(n,["subjectImageConfig"]);return m!=null&&_(e,["subjectImageConfig"],m),e}function c1(n){const e={},t=g(n,["safetyAttributes","categories"]);t!=null&&_(e,["categories"],t);const i=g(n,["safetyAttributes","scores"]);i!=null&&_(e,["scores"],i);const r=g(n,["contentType"]);return r!=null&&_(e,["contentType"],r),e}function d1(n){const e={},t=g(n,["safetyAttributes","categories"]);t!=null&&_(e,["categories"],t);const i=g(n,["safetyAttributes","scores"]);i!=null&&_(e,["scores"],i);const r=g(n,["contentType"]);return r!=null&&_(e,["contentType"],r),e}function f5(n){const e={},t=g(n,["category"]);if(t!=null&&_(e,["category"],t),g(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=g(n,["threshold"]);return i!=null&&_(e,["threshold"],i),e}function m5(n){const e={},t=g(n,["image"]);return t!=null&&_(e,["image"],ur(t)),e}function p5(n,e){const t={},i=g(n,["mode"]);e!==void 0&&i!=null&&_(e,["parameters","mode"],i);const r=g(n,["maxPredictions"]);e!==void 0&&r!=null&&_(e,["parameters","maxPredictions"],r);const a=g(n,["confidenceThreshold"]);e!==void 0&&a!=null&&_(e,["parameters","confidenceThreshold"],a);const u=g(n,["maskDilation"]);e!==void 0&&u!=null&&_(e,["parameters","maskDilation"],u);const f=g(n,["binaryColorThreshold"]);e!==void 0&&f!=null&&_(e,["parameters","binaryColorThreshold"],f);const m=g(n,["labels"]);return e!==void 0&&m!=null&&_(e,["labels"],m),t}function g5(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["source"]);r!=null&&y5(r,t);const a=g(e,["config"]);return a!=null&&p5(a,t),t}function _5(n){const e={},t=g(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>qD(r))),_(e,["generatedMasks"],i)}return e}function y5(n,e){const t={},i=g(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=g(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],ur(r));const a=g(n,["scribbleImage"]);return e!==void 0&&a!=null&&_(e,["instances[0]","scribble"],m5(a)),t}function h1(n){const e={},t=g(n,["languageCode"]);t!=null&&_(e,["languageCode"],t);const i=g(n,["voiceConfig"]);if(i!=null&&_(e,["voiceConfig"],i),g(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function v5(n){const e={},t=g(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],xD(t));const i=g(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function T5(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>S)),_(e,["functionDeclarations"],E)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=g(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=g(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const a=g(n,["fileSearch"]);a!=null&&_(e,["fileSearch"],a);const u=g(n,["codeExecution"]);if(u!=null&&_(e,["codeExecution"],u),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const f=g(n,["googleMaps"]);f!=null&&_(e,["googleMaps"],JD(f));const m=g(n,["googleSearch"]);m!=null&&_(e,["googleSearch"],YD(m));const p=g(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function f1(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let S=t;Array.isArray(S)&&(S=S.map(A=>ED(A))),_(e,["functionDeclarations"],S)}const i=g(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=g(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const a=g(n,["computerUse"]);if(a!=null&&_(e,["computerUse"],a),g(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const u=g(n,["codeExecution"]);u!=null&&_(e,["codeExecution"],u);const f=g(n,["enterpriseWebSearch"]);f!=null&&_(e,["enterpriseWebSearch"],f);const m=g(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],m);const p=g(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const E=g(n,["urlContext"]);return E!=null&&_(e,["urlContext"],E),e}function x5(n){const e={},t=g(n,["baseModel"]);t!=null&&_(e,["baseModel"],t);const i=g(n,["createTime"]);i!=null&&_(e,["createTime"],i);const r=g(n,["updateTime"]);return r!=null&&_(e,["updateTime"],r),e}function E5(n){const e={},t=g(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&_(e,["baseModel"],t);const i=g(n,["createTime"]);i!=null&&_(e,["createTime"],i);const r=g(n,["updateTime"]);return r!=null&&_(e,["updateTime"],r),e}function w5(n,e){const t={},i=g(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=g(n,["description"]);e!==void 0&&r!=null&&_(e,["description"],r);const a=g(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&_(e,["defaultCheckpointId"],a),t}function S5(n,e){const t={},i=g(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=g(n,["description"]);e!==void 0&&r!=null&&_(e,["description"],r);const a=g(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&_(e,["defaultCheckpointId"],a),t}function b5(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","name"],Ft(n,i));const r=g(e,["config"]);return r!=null&&w5(r,t),t}function A5(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["config"]);return r!=null&&S5(r,t),t}function I5(n,e){const t={},i=g(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=g(n,["safetyFilterLevel"]);e!==void 0&&r!=null&&_(e,["parameters","safetySetting"],r);const a=g(n,["personGeneration"]);e!==void 0&&a!=null&&_(e,["parameters","personGeneration"],a);const u=g(n,["includeRaiReason"]);e!==void 0&&u!=null&&_(e,["parameters","includeRaiReason"],u);const f=g(n,["outputMimeType"]);e!==void 0&&f!=null&&_(e,["parameters","outputOptions","mimeType"],f);const m=g(n,["outputCompressionQuality"]);e!==void 0&&m!=null&&_(e,["parameters","outputOptions","compressionQuality"],m);const p=g(n,["enhanceInputImage"]);e!==void 0&&p!=null&&_(e,["parameters","upscaleConfig","enhanceInputImage"],p);const E=g(n,["imagePreservationFactor"]);e!==void 0&&E!=null&&_(e,["parameters","upscaleConfig","imagePreservationFactor"],E);const S=g(n,["labels"]);e!==void 0&&S!=null&&_(e,["labels"],S);const A=g(n,["numberOfImages"]);e!==void 0&&A!=null&&_(e,["parameters","sampleCount"],A);const R=g(n,["mode"]);return e!==void 0&&R!=null&&_(e,["parameters","mode"],R),t}function C5(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["_url","model"],Ft(n,i));const r=g(e,["image"]);r!=null&&_(t,["instances[0]","image"],ur(r));const a=g(e,["upscaleFactor"]);a!=null&&_(t,["parameters","upscaleConfig","upscaleFactor"],a);const u=g(e,["config"]);return u!=null&&I5(u,t),t}function N5(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>zm(a))),_(e,["generatedImages"],r)}return e}function R5(n){const e={},t=g(n,["uri"]);t!=null&&_(e,["uri"],t);const i=g(n,["encodedVideo"]);i!=null&&_(e,["videoBytes"],Va(i));const r=g(n,["encoding"]);return r!=null&&_(e,["mimeType"],r),e}function M5(n){const e={},t=g(n,["gcsUri"]);t!=null&&_(e,["uri"],t);const i=g(n,["bytesBase64Encoded"]);i!=null&&_(e,["videoBytes"],Va(i));const r=g(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function P5(n){const e={},t=g(n,["image"]);t!=null&&_(e,["_self"],ur(t));const i=g(n,["maskMode"]);return i!=null&&_(e,["maskMode"],i),e}function D5(n){const e={},t=g(n,["image"]);t!=null&&_(e,["image"],Fm(t));const i=g(n,["referenceType"]);return i!=null&&_(e,["referenceType"],i),e}function k5(n){const e={},t=g(n,["image"]);t!=null&&_(e,["image"],ur(t));const i=g(n,["referenceType"]);return i!=null&&_(e,["referenceType"],i),e}function m1(n){const e={},t=g(n,["uri"]);t!=null&&_(e,["uri"],t);const i=g(n,["videoBytes"]);i!=null&&_(e,["encodedVideo"],Va(i));const r=g(n,["mimeType"]);return r!=null&&_(e,["encoding"],r),e}function p1(n){const e={},t=g(n,["uri"]);t!=null&&_(e,["gcsUri"],t);const i=g(n,["videoBytes"]);i!=null&&_(e,["bytesBase64Encoded"],Va(i));const r=g(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const L5="Content-Type",V5="X-Server-Timeout",O5="User-Agent",z_="x-goog-api-client",U5="1.30.0",B5=`google-genai-sdk/${U5}`,z5="v1beta1",F5="v1beta",Sw=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class q5{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:z5,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:F5,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[u,f]of Object.entries(e.queryParams))r.searchParams.append(u,String(f));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,r.toString(),e.abortSignal),this.unaryApiCall(r,a,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[r,a]of Object.entries(t))typeof a=="object"?i[r]=Object.assign(Object.assign({},i[r]),a):a!==void 0&&(i[r]=a);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,r.toString(),e.abortSignal),this.streamApiCall(r,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,r){if(t&&t.timeout||r){const a=new AbortController,u=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const f=setTimeout(()=>a.abort(),t.timeout);f&&typeof f.unref=="function"&&f.unref()}r&&r.addEventListener("abort",()=>{a.abort()}),e.signal=u}return t&&t.extraBody!==null&&G5(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await bw(r),new L_(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await bw(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return Qu(this,arguments,function*(){const r=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let u="";for(;;){const{done:f,value:m}=yield mn(r.read());if(f){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=a.decode(m,{stream:!0});try{const S=JSON.parse(p);if("error"in S){const A=JSON.parse(JSON.stringify(S.error)),R=A.status,V=A.code,z=`got status: ${R}. ${JSON.stringify(S)}`;if(V>=400&&V<600)throw new Um({message:z,status:V})}}catch(S){if(S.name==="ApiError")throw S}u+=p;let E=u.match(Sw);for(;E;){const S=E[1];try{const A=new Response(S,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield mn(new L_(A)),u=u.slice(E[0].length),E=u.match(Sw)}catch(A){throw new Error(`exception parsing stream chunk ${S}. ${A}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=B5+" "+this.clientOptions.userAgentExtra;return e[O5]=t,e[z_]=t,e[L5]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[r,a]of Object.entries(e.headers))i.append(r,a);e.timeout&&e.timeout>0&&i.append(V5,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const a=this.clientOptions.uploader,u=await a.stat(e);r.sizeBytes=String(u.size);const f=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:u.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=f;const m={file:r},p=this.getFileName(e),E=Le("upload/v1beta/files",m._url),S=await this.fetchUploadUrl(E,r.sizeBytes,r.mimeType,p,m,t==null?void 0:t.httpOptions);return a.upload(e,S,this)}async uploadFileToFileSearchStore(e,t,i){var r;const a=this.clientOptions.uploader,u=await a.stat(t),f=String(u.size),m=(r=i==null?void 0:i.mimeType)!==null&&r!==void 0?r:u.type;if(m===void 0||m==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,E=this.getFileName(t),S={};i!=null&&i.customMetadata&&(S.customMetadata=i.customMetadata),i!=null&&i.chunkingConfig&&(S.chunkingConfig=i.chunkingConfig);const A=await this.fetchUploadUrl(p,f,m,E,S,i==null?void 0:i.httpOptions);return a.uploadToFileSearchStore(t,A,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,r,a,u){var f;let m={};u?m=u:m={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};const p=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:m});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const E=(f=p==null?void 0:p.headers)===null||f===void 0?void 0:f["x-goog-upload-url"];if(E===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return E}}async function bw(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(i);throw t>=400&&t<600?new Um({message:r,status:t}):new Error(r)}}function G5(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(a,u){const f=Object.assign({},a);for(const m in u)if(Object.prototype.hasOwnProperty.call(u,m)){const p=u[m],E=f[m];p&&typeof p=="object"&&!Array.isArray(p)&&E&&typeof E=="object"&&!Array.isArray(E)?f[m]=i(E,p):(E&&p&&typeof E!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${m}". Original type: ${typeof E}, New type: ${typeof p}. Overwriting.`),f[m]=p)}return f}const r=i(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const H5="mcp_used/unknown";let j5=!1;function g1(n){for(const e of n)if(K5(e)||typeof e=="object"&&"inputSchema"in e)return!0;return j5}function _1(n){var e;const t=(e=n[z_])!==null&&e!==void 0?e:"";n[z_]=(t+` ${H5}`).trimStart()}function K5(n){return n!==null&&typeof n=="object"&&n instanceof Uy}function Z5(n,e=100){return Qu(this,arguments,function*(){let i,r=0;for(;r<e;){const a=yield mn(n.listTools({cursor:i}));for(const u of a.tools)yield yield mn(u),r++;if(!a.nextCursor)break;i=a.nextCursor}})}class Uy{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Uy(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;const a={},u=[];for(const E of this.mcpClients)try{for(var f=!0,m=(t=void 0,Vd(Z5(E))),p;p=await m.next(),e=p.done,!e;f=!0){r=p.value,f=!1;const S=r;u.push(S);const A=S.name;if(a[A])throw new Error(`Duplicate function name ${A} found in MCP tools. Please ensure function names are unique.`);a[A]=E}}catch(S){t={error:S}}finally{try{!f&&!e&&(i=m.return)&&await i.call(m)}finally{if(t)throw t.error}}this.mcpTools=u,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),BR(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const u=await r.callTool({name:i.name,arguments:i.args},void 0,a);t.push({functionResponse:{name:i.name,response:u.isError?{error:u}:u}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function J5(n,e,t){const i=new MR;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(i,r),e(i)}class Y5{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),u=$5(this.apiClient.getDefaultHeaders()),f=this.apiClient.getApiKey(),m=`${r}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${f}`;let p=()=>{};const E=new Promise(Q=>{p=Q}),S=e.callbacks,A=function(){p({})},R=this.apiClient,V={onopen:A,onmessage:Q=>{J5(R,S.onmessage,Q)},onerror:(t=S==null?void 0:S.onerror)!==null&&t!==void 0?t:function(Q){},onclose:(i=S==null?void 0:S.onclose)!==null&&i!==void 0?i:function(Q){}},z=this.webSocketFactory.create(m,Q5(u),V);z.connect(),await E;const ne={setup:{model:Ft(this.apiClient,e.model)}};return z.send(JSON.stringify(ne)),new W5(z,this.apiClient)}}class W5{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=VP(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=LP(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Yu.PLAY)}pause(){this.sendPlaybackControl(Yu.PAUSE)}stop(){this.sendPlaybackControl(Yu.STOP)}resetContext(){this.sendPlaybackControl(Yu.RESET_CONTEXT)}close(){this.conn.close()}}function Q5(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function $5(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const X5="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function ek(n,e,t){const i=new RR;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const a=JSON.parse(r);if(n.isVertexAI()){const u=BP(a);Object.assign(i,u)}else Object.assign(i,a);e(i)}class tk{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new Y5(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,a,u,f;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const m=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let E;const S=this.apiClient.getHeaders();e.config&&e.config.tools&&g1(e.config.tools)&&_1(S);const A=rk(S);if(this.apiClient.isVertexAI())E=`${m}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(A,E);else{const O=this.apiClient.getApiKey();let G="BidiGenerateContent",q="key";O!=null&&O.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),G="BidiGenerateContentConstrained",q="access_token"),E=`${m}/ws/google.ai.generativelanguage.${p}.GenerativeService.${G}?${q}=${O}`}let R=()=>{};const V=new Promise(O=>{R=O}),z=e.callbacks,Z=function(){var O;(O=z==null?void 0:z.onopen)===null||O===void 0||O.call(z),R({})},X=this.apiClient,ne={onopen:Z,onmessage:O=>{ek(X,z.onmessage,O)},onerror:(t=z==null?void 0:z.onerror)!==null&&t!==void 0?t:function(O){},onclose:(i=z==null?void 0:z.onclose)!==null&&i!==void 0?i:function(O){}},Q=this.webSocketFactory.create(E,sk(A),ne);Q.connect(),await V;let pe=Ft(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&pe.startsWith("publishers/")){const O=this.apiClient.getProject(),G=this.apiClient.getLocation();pe=`projects/${O}/locations/${G}/`+pe}let he={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[rm.AUDIO]}:e.config.responseModalities=[rm.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const Y=(f=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&f!==void 0?f:[],D=[];for(const O of Y)if(this.isCallableTool(O)){const G=O;D.push(await G.tool())}else D.push(O);D.length>0&&(e.config.tools=D);const B={model:pe,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?he=kP(this.apiClient,B):he=DP(this.apiClient,B),delete he.config,Q.send(JSON.stringify(he)),new ik(Q,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const nk={turnComplete:!0};class ik{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Gs(t.turns),e.isVertexAI()||(i=i.map(r=>Bm(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const a of i){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(X5)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},nk),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:UP(e)}:t={realtimeInput:OP(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function sk(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function rk(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Aw=10;function Iw(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const u of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if($u(u)){r=!0;break}if(!r)return!0;const a=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function $u(n){return"callTool"in n&&typeof n.callTool=="function"}function ok(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>$u(r)))!==null&&i!==void 0?i:!1}function Cw(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,r)=>{if($u(i))return;const a=i;a.functionDeclarations&&a.functionDeclarations.length>0&&t.push(r)}),t}function Nw(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ak extends bo{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,a,u,f;const m=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!ok(t)||Iw(t.config))return await this.generateContentInternal(m);const p=Cw(t);if(p.length>0){const z=p.map(Z=>`tools[${Z}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${z}.`)}let E,S;const A=Gs(m.contents),R=(a=(r=(i=m.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:Aw;let V=0;for(;V<R&&(E=await this.generateContentInternal(m),!(!E.functionCalls||E.functionCalls.length===0));){const z=E.candidates[0].content,Z=[];for(const X of(f=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&f!==void 0?f:[])if($u(X)){const Q=await X.callTool(E.functionCalls);Z.push(...Q)}V++,S={role:"user",parts:Z},m.contents=Gs(m.contents),m.contents.push(z),m.contents.push(S),Nw(m.config)&&(A.push(z),A.push(S))}return Nw(m.config)&&(E.automaticFunctionCallingHistory=A),E},this.generateContentStream=async t=>{var i,r,a,u,f;if(this.maybeMoveToResponseJsonSchem(t),Iw(t.config)){const S=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(S)}const m=Cw(t);if(m.length>0){const S=m.map(A=>`tools[${A}]`).join(", ");throw new Error(`Incompatible tools found at ${S}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(a=(r=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,E=(f=(u=t==null?void 0:t.config)===null||u===void 0?void 0:u.automaticFunctionCalling)===null||f===void 0?void 0:f.disable;if(p&&!E)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let a;const u=[];if(i!=null&&i.generatedImages)for(const m of i.generatedImages)m&&(m!=null&&m.safetyAttributes)&&((r=m==null?void 0:m.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?a=m==null?void 0:m.safetyAttributes:u.push(m);let f;return a?f={generatedImages:u,positivePromptSafetyAttributes:a,sdkHttpResponse:i.sdkHttpResponse}:f={generatedImages:u,sdkHttpResponse:i.sdkHttpResponse},f}),this.list=async t=>{var i;const u={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((i=u.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new Wl(vo.PAGED_ITEM_MODELS,f=>this.listInternal(f),await this.listInternal(u),u)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var i,r,a,u,f,m;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((u=(a=t.source)===null||a===void 0?void 0:a.video)===null||u===void 0)&&u.uri&&(!((m=(f=t.source)===null||f===void 0?void 0:f.video)===null||m===void 0)&&m.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const u=await Promise.all(a.map(async m=>$u(m)?await m.tool():m)),f={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(f.config.tools=u,e.config&&e.config.tools&&g1(e.config.tools)){const m=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let p=Object.assign({},m);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),_1(p),f.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return f}async initAfcToolsMap(e){var t,i,r;const a=new Map;for(const u of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if($u(u)){const f=u,m=await f.tool();for(const p of(r=m.functionDeclarations)!==null&&r!==void 0?r:[]){if(!p.name)throw new Error("Function declaration name is required.");if(a.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);a.set(p.name,f)}}return a}async processAfcStream(e){var t,i,r;const a=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:Aw;let u=!1,f=0;const m=await this.initAfcToolsMap(e);return(function(p,E,S){var A,R;return Qu(this,arguments,function*(){for(var V,z,Z,X;f<a;){u&&(f++,u=!1);const he=yield mn(p.processParamsMaybeAddMcpUsage(S)),Y=yield mn(p.generateContentStreamInternal(he)),D=[],B=[];try{for(var ne=!0,Q=(z=void 0,Vd(Y)),pe;pe=yield mn(Q.next()),V=pe.done,!V;ne=!0){X=pe.value,ne=!1;const O=X;if(yield yield mn(O),O.candidates&&(!((A=O.candidates[0])===null||A===void 0)&&A.content)){B.push(O.candidates[0].content);for(const G of(R=O.candidates[0].content.parts)!==null&&R!==void 0?R:[])if(f<a&&G.functionCall){if(!G.functionCall.name)throw new Error("Function call name was not returned by the model.");if(E.has(G.functionCall.name)){const q=yield mn(E.get(G.functionCall.name).callTool([G.functionCall]));D.push(...q)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${E.keys()}, mising tool: ${G.functionCall.name}`)}}}}catch(O){z={error:O}}finally{try{!ne&&!V&&(Z=Q.return)&&(yield mn(Z.call(Q)))}finally{if(z)throw z.error}}if(D.length>0){u=!0;const O=new Ed;O.candidates=[{content:{role:"user",parts:D}}],yield yield mn(O);const G=[];G.push(...B),G.push({role:"user",parts:D});const q=Gs(S.contents).concat(G);S.contents=q}else break}})})(this,m,e)}async generateContentInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=xw(this.apiClient,e);return f=Le("{model}:generateContent",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=ww(E),A=new Ed;return Object.assign(A,S),A})}else{const p=Tw(this.apiClient,e);return f=Le("{model}:generateContent",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=Ew(E),A=new Ed;return Object.assign(A,S),A})}}async generateContentStreamInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=xw(this.apiClient,e);return f=Le("{model}:streamGenerateContent?alt=sse",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.requestStream({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),u.then(function(S){return Qu(this,arguments,function*(){var A,R,V,z;try{for(var Z=!0,X=Vd(S),ne;ne=yield mn(X.next()),A=ne.done,!A;Z=!0){z=ne.value,Z=!1;const Q=z,pe=ww(yield mn(Q.json()));pe.sdkHttpResponse={headers:Q.headers};const he=new Ed;Object.assign(he,pe),yield yield mn(he)}}catch(Q){R={error:Q}}finally{try{!Z&&!A&&(V=X.return)&&(yield mn(V.call(X)))}finally{if(R)throw R.error}}})})}else{const p=Tw(this.apiClient,e);return f=Le("{model}:streamGenerateContent?alt=sse",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.requestStream({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),u.then(function(S){return Qu(this,arguments,function*(){var A,R,V,z;try{for(var Z=!0,X=Vd(S),ne;ne=yield mn(X.next()),A=ne.done,!A;Z=!0){z=ne.value,Z=!1;const Q=z,pe=Ew(yield mn(Q.json()));pe.sdkHttpResponse={headers:Q.headers};const he=new Ed;Object.assign(he,pe),yield yield mn(he)}}catch(Q){R={error:Q}}finally{try{!Z&&!A&&(V=X.return)&&(yield mn(V.call(X)))}finally{if(R)throw R.error}}})})}}async embedContent(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=pD(this.apiClient,e);return f=Le("{model}:predict",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=_D(E),A=new sw;return Object.assign(A,S),A})}else{const p=mD(this.apiClient,e);return f=Le("{model}:batchEmbedContents",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=gD(E),A=new sw;return Object.assign(A,S),A})}}async generateImagesInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=CD(this.apiClient,e);return f=Le("{model}:predict",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=RD(E),A=new rw;return Object.assign(A,S),A})}else{const p=ID(this.apiClient,e);return f=Le("{model}:predict",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=ND(E),A=new rw;return Object.assign(A,S),A})}}async editImageInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const f=cD(this.apiClient,e);return a=Le("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:m.headers},E})),r.then(m=>{const p=dD(m),E=new vR;return Object.assign(E,p),E})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const f=C5(this.apiClient,e);return a=Le("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:m.headers},E})),r.then(m=>{const p=N5(m),E=new TR;return Object.assign(E,p),E})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const f=u5(this.apiClient,e);return a=Le("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=c5(m),E=new xR;return Object.assign(E,p),E})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const f=g5(this.apiClient,e);return a=Le("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=_5(m),E=new ER;return Object.assign(E,p),E})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=ZD(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),u.then(E=>B_(E))}else{const p=KD(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json()),u.then(E=>U_(E))}}async listInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=n5(this.apiClient,e);return f=Le("{models_url}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=s5(E),A=new ow;return Object.assign(A,S),A})}else{const p=t5(this.apiClient,e);return f=Le("{models_url}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=i5(E),A=new ow;return Object.assign(A,S),A})}}async update(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=A5(this.apiClient,e);return f=Le("{model}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),u.then(E=>B_(E))}else{const p=b5(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json()),u.then(E=>U_(E))}}async delete(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=oD(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=lD(E),A=new aw;return Object.assign(A,S),A})}else{const p=rD(this.apiClient,e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=aD(E),A=new aw;return Object.assign(A,S),A})}}async countTokens(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=nD(this.apiClient,e);return f=Le("{model}:countTokens",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=sD(E),A=new lw;return Object.assign(A,S),A})}else{const p=tD(this.apiClient,e);return f=Le("{model}:countTokens",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=iD(E),A=new lw;return Object.assign(A,S),A})}}async computeTokens(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const f=JP(this.apiClient,e);return a=Le("{model}:computeTokens",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:m.headers},E})),r.then(m=>{const p=YP(m),E=new wR;return Object.assign(E,p),E})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=VD(this.apiClient,e);return f=Le("{model}:predictLongRunning",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),u.then(E=>{const S=kD(E),A=new om;return Object.assign(A,S),A})}else{const p=LD(this.apiClient,e);return f=Le("{model}:predictLongRunning",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json()),u.then(E=>{const S=DD(E),A=new om;return Object.assign(A,S),A})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lk extends bo{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:u,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:u,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=fR(e);return f=Le("{operationName}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json()),u}else{const p=hR(e);return f=Le("{operationName}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json()),u}}async fetchPredictVideosOperationInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const f=rR(e);return a=Le("{resourceName}:fetchPredictOperation",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uk(n){const e={},t=g(n,["data"]);if(t!=null&&_(e,["data"],t),g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function ck(n){const e={},t=g(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(a=>vk(a))),_(e,["parts"],r)}const i=g(n,["role"]);return i!=null&&_(e,["role"],i),e}function dk(n,e,t){const i={},r=g(e,["expireTime"]);t!==void 0&&r!=null&&_(t,["expireTime"],r);const a=g(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&_(t,["newSessionExpireTime"],a);const u=g(e,["uses"]);t!==void 0&&u!=null&&_(t,["uses"],u);const f=g(e,["liveConnectConstraints"]);t!==void 0&&f!=null&&_(t,["bidiGenerateContentSetup"],yk(n,f));const m=g(e,["lockAdditionalFields"]);return t!==void 0&&m!=null&&_(t,["fieldMask"],m),i}function hk(n,e){const t={},i=g(e,["config"]);return i!=null&&_(t,["config"],dk(n,i,t)),t}function fk(n){const e={};if(g(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=g(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=g(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function mk(n){const e={},t=g(n,["id"]);t!=null&&_(e,["id"],t);const i=g(n,["args"]);i!=null&&_(e,["args"],i);const r=g(n,["name"]);if(r!=null&&_(e,["name"],r),g(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(g(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function pk(n){const e={};if(g(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=g(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function gk(n){const e={};if(g(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(g(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=g(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function _k(n,e){const t={},i=g(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],i);const r=g(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const a=g(n,["temperature"]);e!==void 0&&a!=null&&_(e,["setup","generationConfig","temperature"],a);const u=g(n,["topP"]);e!==void 0&&u!=null&&_(e,["setup","generationConfig","topP"],u);const f=g(n,["topK"]);e!==void 0&&f!=null&&_(e,["setup","generationConfig","topK"],f);const m=g(n,["maxOutputTokens"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","maxOutputTokens"],m);const p=g(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const E=g(n,["seed"]);e!==void 0&&E!=null&&_(e,["setup","generationConfig","seed"],E);const S=g(n,["speechConfig"]);e!==void 0&&S!=null&&_(e,["setup","generationConfig","speechConfig"],Oy(S));const A=g(n,["thinkingConfig"]);e!==void 0&&A!=null&&_(e,["setup","generationConfig","thinkingConfig"],A);const R=g(n,["enableAffectiveDialog"]);e!==void 0&&R!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],R);const V=g(n,["systemInstruction"]);e!==void 0&&V!=null&&_(e,["setup","systemInstruction"],ck(Ti(V)));const z=g(n,["tools"]);if(e!==void 0&&z!=null){let Y=Sc(z);Array.isArray(Y)&&(Y=Y.map(D=>xk(wc(D)))),_(e,["setup","tools"],Y)}const Z=g(n,["sessionResumption"]);e!==void 0&&Z!=null&&_(e,["setup","sessionResumption"],Tk(Z));const X=g(n,["inputAudioTranscription"]);e!==void 0&&X!=null&&_(e,["setup","inputAudioTranscription"],X);const ne=g(n,["outputAudioTranscription"]);e!==void 0&&ne!=null&&_(e,["setup","outputAudioTranscription"],ne);const Q=g(n,["realtimeInputConfig"]);e!==void 0&&Q!=null&&_(e,["setup","realtimeInputConfig"],Q);const pe=g(n,["contextWindowCompression"]);e!==void 0&&pe!=null&&_(e,["setup","contextWindowCompression"],pe);const he=g(n,["proactivity"]);return e!==void 0&&he!=null&&_(e,["setup","proactivity"],he),t}function yk(n,e){const t={},i=g(e,["model"]);i!=null&&_(t,["setup","model"],Ft(n,i));const r=g(e,["config"]);return r!=null&&_(t,["config"],_k(r,t)),t}function vk(n){const e={},t=g(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=g(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=g(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const a=g(n,["fileData"]);a!=null&&_(e,["fileData"],fk(a));const u=g(n,["functionCall"]);u!=null&&_(e,["functionCall"],mk(u));const f=g(n,["functionResponse"]);f!=null&&_(e,["functionResponse"],f);const m=g(n,["inlineData"]);m!=null&&_(e,["inlineData"],uk(m));const p=g(n,["text"]);p!=null&&_(e,["text"],p);const E=g(n,["thought"]);E!=null&&_(e,["thought"],E);const S=g(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const A=g(n,["videoMetadata"]);return A!=null&&_(e,["videoMetadata"],A),e}function Tk(n){const e={},t=g(n,["handle"]);if(t!=null&&_(e,["handle"],t),g(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function xk(n){const e={},t=g(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>S)),_(e,["functionDeclarations"],E)}if(g(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=g(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=g(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const a=g(n,["fileSearch"]);a!=null&&_(e,["fileSearch"],a);const u=g(n,["codeExecution"]);if(u!=null&&_(e,["codeExecution"],u),g(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const f=g(n,["googleMaps"]);f!=null&&_(e,["googleMaps"],pk(f));const m=g(n,["googleSearch"]);m!=null&&_(e,["googleSearch"],gk(m));const p=g(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ek(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(a=>`${t}.${a}`);e.push(...r)}else e.push(t)}return e.join(",")}function wk(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const a=i.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const a=Ek(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?n.fieldMask=a:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let f=[];r.length>0&&(f=r.map(p=>u.includes(p)?`generationConfig.${p}`:p));const m=[];a&&m.push(a),f.length>0&&m.push(...f),m.length>0?n.fieldMask=m.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class Sk extends bo{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const f=hk(this.apiClient,e);a=Le("auth_tokens",f._url),u=f._query,delete f.config,delete f._url,delete f._query;const m=wk(f,e.config);return r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bk(n,e){const t={},i=g(n,["displayName"]);return e!==void 0&&i!=null&&_(e,["displayName"],i),t}function Ak(n){const e={},t=g(n,["config"]);return t!=null&&bk(t,e),e}function Ik(n,e){const t={},i=g(n,["force"]);return e!==void 0&&i!=null&&_(e,["_query","force"],i),t}function Ck(n){const e={},t=g(n,["name"]);t!=null&&_(e,["_url","name"],t);const i=g(n,["config"]);return i!=null&&Ik(i,e),e}function Nk(n){const e={},t=g(n,["name"]);return t!=null&&_(e,["_url","name"],t),e}function Rk(n,e){const t={},i=g(n,["customMetadata"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>u)),_(e,["customMetadata"],a)}const r=g(n,["chunkingConfig"]);return e!==void 0&&r!=null&&_(e,["chunkingConfig"],r),t}function Mk(n){const e={},t=g(n,["name"]);t!=null&&_(e,["name"],t);const i=g(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=g(n,["done"]);r!=null&&_(e,["done"],r);const a=g(n,["error"]);a!=null&&_(e,["error"],a);const u=g(n,["response"]);return u!=null&&_(e,["response"],Dk(u)),e}function Pk(n){const e={},t=g(n,["fileSearchStoreName"]);t!=null&&_(e,["_url","file_search_store_name"],t);const i=g(n,["fileName"]);i!=null&&_(e,["fileName"],i);const r=g(n,["config"]);return r!=null&&Rk(r,e),e}function Dk(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["parent"]);i!=null&&_(e,["parent"],i);const r=g(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function kk(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=g(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function Lk(n){const e={},t=g(n,["config"]);return t!=null&&kk(t,e),e}function Vk(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=g(n,["fileSearchStores"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>u)),_(e,["fileSearchStores"],a)}return e}function Ok(n,e){const t={},i=g(n,["mimeType"]);e!==void 0&&i!=null&&_(e,["mimeType"],i);const r=g(n,["displayName"]);e!==void 0&&r!=null&&_(e,["displayName"],r);const a=g(n,["customMetadata"]);if(e!==void 0&&a!=null){let f=a;Array.isArray(f)&&(f=f.map(m=>m)),_(e,["customMetadata"],f)}const u=g(n,["chunkingConfig"]);return e!==void 0&&u!=null&&_(e,["chunkingConfig"],u),t}function Uk(n){const e={},t=g(n,["fileSearchStoreName"]);t!=null&&_(e,["_url","file_search_store_name"],t);const i=g(n,["config"]);return i!=null&&Ok(i,e),e}function Bk(n){const e={},t=g(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zk(n,e){const t={},i=g(n,["force"]);return e!==void 0&&i!=null&&_(e,["_query","force"],i),t}function Fk(n){const e={},t=g(n,["name"]);t!=null&&_(e,["_url","name"],t);const i=g(n,["config"]);return i!=null&&zk(i,e),e}function qk(n){const e={},t=g(n,["name"]);return t!=null&&_(e,["_url","name"],t),e}function Gk(n,e){const t={},i=g(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=g(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function Hk(n){const e={},t=g(n,["parent"]);t!=null&&_(e,["_url","parent"],t);const i=g(n,["config"]);return i!=null&&Gk(i,e),e}function jk(n){const e={},t=g(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=g(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=g(n,["documents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>u)),_(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Kk extends bo{constructor(e){super(),this.apiClient=e,this.list=async t=>new Wl(vo.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=qk(e);return a=Le("{name}",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>m)}}async delete(e){var t,i;let r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Fk(e);r=Le("{name}",u._url),a=u._query,delete u._url,delete u._query,await this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=Hk(e);return a=Le("{parent}/documents",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=jk(m),E=new SR;return Object.assign(E,p),E})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zk extends bo{constructor(e,t=new Kk(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new Wl(vo.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=Ak(e);return a=Le("fileSearchStores",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>m)}}async get(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=Nk(e);return a=Le("{name}",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>m)}}async delete(e){var t,i;let r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ck(e);r=Le("{name}",u._url),a=u._query,delete u._url,delete u._query,await this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=Lk(e);return a=Le("fileSearchStores",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=Vk(m),E=new bR;return Object.assign(E,p),E})}}async uploadToFileSearchStoreInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=Uk(e);return a=Le("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=Bk(m),E=new AR;return Object.assign(E,p),E})}}async importFile(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=Pk(e);return a=Le("{file_search_store_name}:importFile",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()),r.then(m=>{const p=Mk(m),E=new Py;return Object.assign(E,p),E})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jk(n,e){const t={},i=g(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function Yk(n,e){const t={},i=g(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function Wk(n,e,t){const i={};if(g(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=g(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&_(e,["displayName"],r),g(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=g(n,["epochCount"]);e!==void 0&&a!=null&&_(e,["tuningTask","hyperparameters","epochCount"],a);const u=g(n,["learningRateMultiplier"]);if(u!=null&&_(i,["tuningTask","hyperparameters","learningRateMultiplier"],u),g(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(g(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(g(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const f=g(n,["batchSize"]);e!==void 0&&f!=null&&_(e,["tuningTask","hyperparameters","batchSize"],f);const m=g(n,["learningRate"]);if(e!==void 0&&m!=null&&_(e,["tuningTask","hyperparameters","learningRate"],m),g(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(g(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function Qk(n,e,t){const i={};let r=g(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const R=g(n,["validationDataset"]);e!==void 0&&R!=null&&_(e,["supervisedTuningSpec"],Rw(R))}else if(r==="PREFERENCE_TUNING"){const R=g(n,["validationDataset"]);e!==void 0&&R!=null&&_(e,["preferenceOptimizationSpec"],Rw(R))}const a=g(n,["tunedModelDisplayName"]);e!==void 0&&a!=null&&_(e,["tunedModelDisplayName"],a);const u=g(n,["description"]);e!==void 0&&u!=null&&_(e,["description"],u);let f=g(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const R=g(n,["epochCount"]);e!==void 0&&R!=null&&_(e,["supervisedTuningSpec","hyperParameters","epochCount"],R)}else if(f==="PREFERENCE_TUNING"){const R=g(n,["epochCount"]);e!==void 0&&R!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],R)}let m=g(t,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const R=g(n,["learningRateMultiplier"]);e!==void 0&&R!=null&&_(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],R)}else if(m==="PREFERENCE_TUNING"){const R=g(n,["learningRateMultiplier"]);e!==void 0&&R!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],R)}let p=g(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const R=g(n,["exportLastCheckpointOnly"]);e!==void 0&&R!=null&&_(e,["supervisedTuningSpec","exportLastCheckpointOnly"],R)}else if(p==="PREFERENCE_TUNING"){const R=g(n,["exportLastCheckpointOnly"]);e!==void 0&&R!=null&&_(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],R)}let E=g(t,["config","method"]);if(E===void 0&&(E="SUPERVISED_FINE_TUNING"),E==="SUPERVISED_FINE_TUNING"){const R=g(n,["adapterSize"]);e!==void 0&&R!=null&&_(e,["supervisedTuningSpec","hyperParameters","adapterSize"],R)}else if(E==="PREFERENCE_TUNING"){const R=g(n,["adapterSize"]);e!==void 0&&R!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],R)}if(g(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(g(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const S=g(n,["labels"]);e!==void 0&&S!=null&&_(e,["labels"],S);const A=g(n,["beta"]);return e!==void 0&&A!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","beta"],A),i}function $k(n,e){const t={},i=g(n,["baseModel"]);i!=null&&_(t,["baseModel"],i);const r=g(n,["preTunedModel"]);r!=null&&_(t,["preTunedModel"],r);const a=g(n,["trainingDataset"]);a!=null&&uL(a);const u=g(n,["config"]);return u!=null&&Wk(u,t),t}function Xk(n,e){const t={},i=g(n,["baseModel"]);i!=null&&_(t,["baseModel"],i);const r=g(n,["preTunedModel"]);r!=null&&_(t,["preTunedModel"],r);const a=g(n,["trainingDataset"]);a!=null&&cL(a,t,e);const u=g(n,["config"]);return u!=null&&Qk(u,t,e),t}function eL(n,e){const t={},i=g(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function tL(n,e){const t={},i=g(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function nL(n,e,t){const i={},r=g(n,["pageSize"]);e!==void 0&&r!=null&&_(e,["_query","pageSize"],r);const a=g(n,["pageToken"]);e!==void 0&&a!=null&&_(e,["_query","pageToken"],a);const u=g(n,["filter"]);return e!==void 0&&u!=null&&_(e,["_query","filter"],u),i}function iL(n,e,t){const i={},r=g(n,["pageSize"]);e!==void 0&&r!=null&&_(e,["_query","pageSize"],r);const a=g(n,["pageToken"]);e!==void 0&&a!=null&&_(e,["_query","pageToken"],a);const u=g(n,["filter"]);return e!==void 0&&u!=null&&_(e,["_query","filter"],u),i}function sL(n,e){const t={},i=g(n,["config"]);return i!=null&&nL(i,t),t}function rL(n,e){const t={},i=g(n,["config"]);return i!=null&&iL(i,t),t}function oL(n,e){const t={},i=g(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=g(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=g(n,["tunedModels"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(f=>y1(f))),_(t,["tuningJobs"],u)}return t}function aL(n,e){const t={},i=g(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=g(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const a=g(n,["tuningJobs"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(f=>F_(f))),_(t,["tuningJobs"],u)}return t}function lL(n,e){const t={},i=g(n,["name"]);i!=null&&_(t,["model"],i);const r=g(n,["name"]);return r!=null&&_(t,["endpoint"],r),t}function uL(n,e){const t={};if(g(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(g(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=g(n,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(a=>a)),_(t,["examples","examples"],r)}return t}function cL(n,e,t){const i={};let r=g(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const u=g(n,["gcsUri"]);e!==void 0&&u!=null&&_(e,["supervisedTuningSpec","trainingDatasetUri"],u)}else if(r==="PREFERENCE_TUNING"){const u=g(n,["gcsUri"]);e!==void 0&&u!=null&&_(e,["preferenceOptimizationSpec","trainingDatasetUri"],u)}let a=g(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const u=g(n,["vertexDatasetResource"]);e!==void 0&&u!=null&&_(e,["supervisedTuningSpec","trainingDatasetUri"],u)}else if(a==="PREFERENCE_TUNING"){const u=g(n,["vertexDatasetResource"]);e!==void 0&&u!=null&&_(e,["preferenceOptimizationSpec","trainingDatasetUri"],u)}if(g(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function y1(n,e){const t={},i=g(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=g(n,["name"]);r!=null&&_(t,["name"],r);const a=g(n,["state"]);a!=null&&_(t,["state"],Xb(a));const u=g(n,["createTime"]);u!=null&&_(t,["createTime"],u);const f=g(n,["tuningTask","startTime"]);f!=null&&_(t,["startTime"],f);const m=g(n,["tuningTask","completeTime"]);m!=null&&_(t,["endTime"],m);const p=g(n,["updateTime"]);p!=null&&_(t,["updateTime"],p);const E=g(n,["description"]);E!=null&&_(t,["description"],E);const S=g(n,["baseModel"]);S!=null&&_(t,["baseModel"],S);const A=g(n,["_self"]);return A!=null&&_(t,["tunedModel"],lL(A)),t}function F_(n,e){const t={},i=g(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=g(n,["name"]);r!=null&&_(t,["name"],r);const a=g(n,["state"]);a!=null&&_(t,["state"],Xb(a));const u=g(n,["createTime"]);u!=null&&_(t,["createTime"],u);const f=g(n,["startTime"]);f!=null&&_(t,["startTime"],f);const m=g(n,["endTime"]);m!=null&&_(t,["endTime"],m);const p=g(n,["updateTime"]);p!=null&&_(t,["updateTime"],p);const E=g(n,["error"]);E!=null&&_(t,["error"],E);const S=g(n,["description"]);S!=null&&_(t,["description"],S);const A=g(n,["baseModel"]);A!=null&&_(t,["baseModel"],A);const R=g(n,["tunedModel"]);R!=null&&_(t,["tunedModel"],R);const V=g(n,["preTunedModel"]);V!=null&&_(t,["preTunedModel"],V);const z=g(n,["supervisedTuningSpec"]);z!=null&&_(t,["supervisedTuningSpec"],z);const Z=g(n,["preferenceOptimizationSpec"]);Z!=null&&_(t,["preferenceOptimizationSpec"],Z);const X=g(n,["tuningDataStats"]);X!=null&&_(t,["tuningDataStats"],X);const ne=g(n,["encryptionSpec"]);ne!=null&&_(t,["encryptionSpec"],ne);const Q=g(n,["partnerModelTuningSpec"]);Q!=null&&_(t,["partnerModelTuningSpec"],Q);const pe=g(n,["customBaseModel"]);pe!=null&&_(t,["customBaseModel"],pe);const he=g(n,["experiment"]);he!=null&&_(t,["experiment"],he);const Y=g(n,["labels"]);Y!=null&&_(t,["labels"],Y);const D=g(n,["outputUri"]);D!=null&&_(t,["outputUri"],D);const B=g(n,["pipelineJob"]);B!=null&&_(t,["pipelineJob"],B);const O=g(n,["serviceAccount"]);O!=null&&_(t,["serviceAccount"],O);const G=g(n,["tunedModelDisplayName"]);G!=null&&_(t,["tunedModelDisplayName"],G);const q=g(n,["veoTuningSpec"]);return q!=null&&_(t,["veoTuningSpec"],q),t}function dL(n,e){const t={},i=g(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=g(n,["name"]);r!=null&&_(t,["name"],r);const a=g(n,["metadata"]);a!=null&&_(t,["metadata"],a);const u=g(n,["done"]);u!=null&&_(t,["done"],u);const f=g(n,["error"]);return f!=null&&_(t,["error"],f),t}function Rw(n,e){const t={},i=g(n,["gcsUri"]);i!=null&&_(t,["validationDatasetUri"],i);const r=g(n,["vertexDatasetResource"]);return r!=null&&_(t,["validationDatasetUri"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hL extends bo{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Wl(vo.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const r={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},t),{preTunedModel:r});return a.baseModel=void 0,await this.tuneInternal(a)}else{const r=Object.assign({},t);return await this.tuneInternal(r)}else{const r=Object.assign({},t),a=await this.tuneMldevInternal(r);let u="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?u=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(u=a.name.split("/operations/")[0]),{name:u,state:k_.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=tL(e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>F_(E))}else{const p=eL(e);return f=Le("{name}",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>y1(E))}}async listInternal(e){var t,i,r,a;let u,f="",m={};if(this.apiClient.isVertexAI()){const p=rL(e);return f=Le("tuningJobs",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=aL(E),A=new uw;return Object.assign(A,S),A})}else{const p=sL(e);return f=Le("tunedModels",p._url),m=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:f,queryParams:m,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(E=>E.json().then(S=>{const A=S;return A.sdkHttpResponse={headers:E.headers},A})),u.then(E=>{const S=oL(E),A=new uw;return Object.assign(A,S),A})}}async cancel(e){var t,i,r,a;let u="",f={};if(this.apiClient.isVertexAI()){const m=Yk(e);u=Le("{name}:cancel",m._url),f=m._query,delete m._url,delete m._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const m=Jk(e);u=Le("{name}:cancel",m._url),f=m._query,delete m._url,delete m._query,await this.apiClient.request({path:u,queryParams:f,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async tuneInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI()){const f=Xk(e,e);return a=Le("tuningJobs",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:m.headers},E})),r.then(m=>F_(m))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const f=$k(e);return a=Le("tunedModels",f._url),u=f._query,delete f._url,delete f._query,r=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json().then(p=>{const E=p;return E.sdkHttpResponse={headers:m.headers},E})),r.then(m=>dL(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class fL{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const mL=1024*1024*8,pL=3,gL=1e3,_L=2,lm="x-goog-upload-status";async function yL(n,e,t){var i;const r=await v1(n,e,t),a=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[lm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function vL(n,e,t){var i;const r=await v1(n,e,t),a=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[lm])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const u=Zb(a),f=new Dy;return Object.assign(f,u),f}async function v1(n,e,t){var i,r;let a=0,u=0,f=new L_(new Response),m="upload";for(a=n.size;u<a;){const p=Math.min(mL,a-u),E=n.slice(u,u+p);u+p>=a&&(m+=", finalize");let S=0,A=gL;for(;S<pL&&(f=await t.request({path:"",body:E,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((i=f==null?void 0:f.headers)===null||i===void 0)&&i[lm]));)S++,await xL(A),A=A*_L;if(u+=p,((r=f==null?void 0:f.headers)===null||r===void 0?void 0:r[lm])!=="active")break;if(a<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return f}async function TL(n){return{size:n.size,type:n.type}}function xL(n){return new Promise(e=>setTimeout(e,n))}class EL{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await yL(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await vL(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await TL(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wL{create(e,t,i){return new SL(e,t,i)}}class SL{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Mw="x-goog-api-key";class bL{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(Mw)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Mw,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const AL="gl-node/";class T1{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=iR(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const r=new bL(this.apiKey);this.apiClient=new q5({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:AL+"web",uploader:new EL,downloader:new fL}),this.models=new ak(this.apiClient),this.live=new tk(this.apiClient,r,new wL),this.batches=new PM(this.apiClient),this.chats=new fP(this.models,this.apiClient),this.caches=new cP(this.apiClient),this.files=new wP(this.apiClient),this.operations=new lk(this.apiClient),this.authTokens=new Sk(this.apiClient),this.tunings=new hL(this.apiClient),this.fileSearchStores=new Zk(this.apiClient)}}const IL={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var Pw={};const CL=()=>{try{if(typeof window<"u"&&window.localStorage){const n=localStorage.getItem("nomad_user_api_key");if(n)return n}if(typeof import.meta<"u"&&IL)return"";if(typeof process<"u"&&Pw)return Pw.VITE_API_KEY||""}catch(n){console.warn("Failed to access API key",n)}return""},cr=async n=>{var i;const e=CL();let t=null;if(e)try{const r=new T1({apiKey:e});return await n(r)}catch(r){if(console.warn("Primary API Key failed",r),t=r,(i=r.message)!=null&&i.includes("403")||r.toString().includes("403"))throw new Error("Invalid API Key (403). Please check your key in Settings.")}else throw new Error("API key is missing. Please provide a valid API key in Settings.");throw new Error(`AI Service Failed. ${(t==null?void 0:t.message)||t||"Unknown error"}`)},wi={"zh-TW":"Traditional Chinese (Taiwan) ()","en-US":"English","ja-JP":"Japanese"},dr=n=>{if(typeof n.text=="string")return n.text;if(typeof n.text=="function")return n.text();if(n.candidates&&n.candidates[0]&&n.candidates[0].content&&n.candidates[0].content.parts&&n.candidates[0].content.parts[0].text)return n.candidates[0].content.parts[0].text;throw new Error("No text found in AI response")},hr="gemini-2.5-flash-lite",x1=async(n,e)=>(console.warn("Image editing is not supported. Returning original image."),n),By=async n=>{try{const e=`Cinematic travel photography of ${n}, 4k, high quality, sunny day, vibrant colors, wide angle`,t=encodeURIComponent(e),i=Math.floor(Math.random()*1e6);return`https://image.pollinations.ai/prompt/${t}?width=1600&height=900&nologo=true&seed=${i}&model=flux`}catch(e){return console.error("Failed to generate cover image:",e),`https://via.placeholder.com/1600x900/D4A574/FFFFFF?text=${encodeURIComponent(n)}`}},E1=async(n,e="zh-TW")=>{const t=wi[e]||wi["zh-TW"];return cr(async i=>{const r=await i.models.generateContent({model:hr,contents:`Help me plan a trip. ${n}`,config:{systemInstruction:`You are a professional travel agent AI. 
                Create a detailed itinerary based on the user's request. 
                
                CRITICAL PLANNING RULES:
                1. **Distance & Logic**: Group attractions that are geographically close to each other on the same day.
                2. **Feasibility**: Ensure the schedule is realistic.
                3. **Language**: All content MUST be in ${t}.
                4. **Travel Info**: You MUST estimate the travel mode and duration to the NEXT activity. This is mandatory for all items except the last one of the day.
                5. **Completeness**: You MUST generate a FULL itinerary with at least 3 activities per day. Do not leave the itinerary empty.
                
                FORMAT REQUIREMENTS:
                Return response in valid JSON format. Do not use Markdown code blocks.
                The JSON must strictly follow this structure:
                {
                    "title": "Trip Title",
                    "startDate": "YYYY-MM-DD",
                    "endDate": "YYYY-MM-DD",
                    "itinerary": [
                        {
                            "id": "unique_id",
                            "day": 1,
                            "time": "09:00",
                            "activity": "Activity Name",
                            "location": "Location Address",
                            "notes": "Tips",
                            "travelToNext": {
                                "mode": "WALK/TRAIN/BUS/CAR",
                                "duration": "15 min",
                                "details": "Route details"
                            }
                        }
                    ],
                    "budget": {
                        "total": 10000,
                        "currency": "TWD",
                        "expenses": []
                    },
                    "packingList": [],
                    "weather": [
                        {
                            "date": "YYYY-MM-DD",
                            "condition": "Sunny",
                            "tempLow": 20,
                            "tempHigh": 30,
                            "icon": ""
                        }
                    ]
                }
                `,responseMimeType:"application/json"}}),a=dr(r);if(a){const u=a.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(u)}throw new Error("Empty response from AI")})},w1=async(n,e,t="zh-TW")=>{const i=wi[t]||wi["zh-TW"];return cr(async r=>{const a=await r.models.generateContent({model:hr,contents:`Help me modify an existing trip plan.
            
            Current Trip JSON:
            ${JSON.stringify(n)}
            
            User Request: "${e}"
            
            INSTRUCTIONS:
            1. Modify the "Current Trip JSON" based on the "User Request".
            2. Keep the same structure and fields.
            3. Update the "itinerary", "bookings", "budget", etc. as needed.
            4. Ensure the response is valid JSON matching the Trip structure.
            5. All content MUST be in ${i}.
            6. Return ONLY the updated JSON.
            `,config:{responseMimeType:"application/json"}}),u=dr(a);if(u){const f=u.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(f)}throw new Error("Empty response from AI")})},S1=async(n,e,t="zh-TW")=>{const i=wi[t]||wi["zh-TW"];return cr(async r=>{try{const a=await r.models.generateContent({model:hr,contents:`I hold a ${n} passport and want to travel to ${e}. 
                Provide visa requirements in STRICT JSON format.
                
                Required JSON Structure:
                {
                  "difficulty": "Easy / Moderate / Hard",
                  "summary": "One sentence summary",
                  "requirements": ["Requirement 1", "Requirement 2"]
                }
                
                Translate all content to ${i}.
                Return ONLY valid JSON.`,config:{responseMimeType:"application/json"}}),u=dr(a);return JSON.parse(u)}catch(a){return console.error(a),null}})},b1=async(n,e="zh-TW")=>{const t=wi[e]||wi["zh-TW"];return cr(async i=>{try{const r=await i.models.generateContent({model:hr,contents:`I am currently in (or planning to go to) ${n}. 
                Provide cultural etiquette guide in STRICT JSON format.
                
                Required JSON Structure:
                {
                  "tipping": "Tipping advice",
                  "dos": ["Do 1", "Do 2"],
                  "donts": ["Don't 1", "Don't 2"],
                  "dressCode": "Dress code advice"
                }
                
                Translate all content to ${t}.
                Return ONLY valid JSON.`,config:{responseMimeType:"application/json"}}),a=dr(r);return JSON.parse(a)}catch(r){return console.error(r),null}})},A1=async(n,e,t="zh-TW")=>{const i=wi[t]||wi["zh-TW"];return cr(async r=>{try{const a=await r.models.generateContent({model:hr,contents:`Tell me about "${e}" at "${n}". 
                Provide a very short fun fact, the best photo spot, and one "pro tip" for visiting.
                Format as simple Markdown (bold keys). Keep it under 100 words.
                Response MUST be in ${i}.`});return dr(a)}catch(a){return console.error("Error fetching attraction guide:",a),""}})},I1=async(n,e="zh-TW")=>{const t=wi[e]||wi["zh-TW"];return cr(async i=>{try{const r=await i.models.generateContent({model:hr,contents:`I am travelling in ${n}. 
                Provide emergency contact info in STRICT JSON format.
                
                Required JSON Structure:
                {
                  "numbers": [
                    {"label": "Title (e.g. Police)", "number": "110"}
                  ],
                  "hospital": {
                    "name": "Name of nearest major hospital in capital",
                    "address": "Address",
                    "phone": "Phone number"
                  }
                }
                
                Translate all labels and values to ${t}.
                Return ONLY valid JSON. Do not include markdown formatting.`}),a=dr(r);if(!a)throw new Error("Empty response");const u=a.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(u)}catch(r){return console.error("Emergency Info Error:",r),null}})},C1=async(n,e="zh-TW")=>{const t=wi[e]||wi["zh-TW"];return cr(async i=>{try{const r=await i.models.generateContent({model:hr,contents:`I am travelling to ${n}. 
                Provide credit card advice in STRICT JSON format.
                
                Required JSON Structure:
                {
                  "bestCards": ["Visa", "Mastercard"],
                  "cashInfo": "Advice on cash usage",
                  "tips": ["Tip 1", "Tip 2"]
                }
                
                Translate all content to ${t}.
                Return ONLY valid JSON.`,config:{responseMimeType:"application/json"}}),a=dr(r);return JSON.parse(a)}catch(r){return console.error(r),null}})},N1=async(n,e="zh-TW")=>cr(async t=>{const i=n.map(u=>({id:u.id,activity:u.activity,location:u.location,time:u.time})),r=await t.models.generateContent({model:hr,contents:`I have a list of activities for one day. Reorder them to create the most efficient geographical route.
            
            Current Items: ${JSON.stringify(i)}
            
            Return ONLY a JSON array of strings, where each string is the 'id' of the activity in the new order.
            Do not change the time, just the order of visiting.
            Example response: ["id1", "id3", "id2"]`,config:{responseMimeType:"application/json"}}),a=dr(r);if(a)return JSON.parse(a);throw new Error("Empty response")}),R1=async(n,e,t="zh-TW")=>cr(async i=>{try{const r=await i.models.generateContent({model:hr,contents:`Translate the following text to ${e}.
                Text: "${n}"
                
                Only provide the translated text.`});return dr(r)}catch(r){return console.error("Translation Error:",r),null}}),M1=async(n,e,t="zh-TW")=>{const i=wi[t]||wi["zh-TW"];return cr(async r=>{try{const a=n.map(f=>`${f.date}: ${f.condition}, ${f.tempLow}C - ${f.tempHigh}C`).join(`
`),u=await r.models.generateContent({model:hr,contents:`I am travelling to ${e}. Here is the weather forecast:
                ${a}
                
                Based on this weather, give me a VERY SHORT, ONE-LINE clothing advice summary.
                Example: "It's rainy and cold, so bring a heavy coat and umbrella."
                Keep it under 20 words.
                Response MUST be in ${i}.`});return dr(u)}catch(a){return console.error("Clothing Advice Error:",a),""}})},zy=async(n,e)=>{try{return await cr(async t=>{try{const i=await t.models.generateContent({model:hr,contents:`What is the current exchange rate from ${n} to ${e}?
                    Return ONLY the number. Example: 0.23
                    If you are unsure, return "null".`}),r=dr(i),a=parseFloat(r);return isNaN(a)?null:a.toString()}catch(i){return console.error("Exchange Rate Error:",i),null}})}catch(t){return console.warn("Call AI failed for exchange rate:",t),null}},NL=Object.freeze(Object.defineProperty({__proto__:null,editTravelPhoto:x1,generateCoverImage:By,generateTripPlan:E1,getAttractionGuide:A1,getClothingAdvice:M1,getCreditCardAdvice:C1,getCulturalEtiquette:b1,getEmergencyInfo:I1,getExchangeRate:zy,getTranslation:R1,getVisaRequirements:S1,optimizeRoute:N1,updateTripPlan:w1},Symbol.toStringTag,{value:"Module"})),RL=({onSave:n,onCancel:e,settings:t})=>{const i=on[t.language]||on["zh-TW"],[r,a]=W.useState(""),[u,f]=W.useState(""),[m,p]=W.useState(""),[E,S]=W.useState(null),[A,R]=W.useState(!1),V=W.useRef(null),z=ne=>{var pe;const Q=(pe=ne.target.files)==null?void 0:pe[0];if(Q){const he=new FileReader;he.onloadend=()=>{S(he.result)},he.readAsDataURL(Q)}},Z=async()=>{if(!r){alert("Please enter title");return}R(!0);try{const ne=await By(r);S(ne)}catch(ne){console.error(ne),alert("Error")}finally{R(!1)}},X=async ne=>{if(ne.preventDefault(),!r||!u)return;let Q=E;if(!Q)try{const he=`Cinematic travel photography of ${r}, 4k, high quality, sunny day`,Y=encodeURIComponent(he),D=Math.floor(Math.random()*1e6);Q=`https://image.pollinations.ai/prompt/${Y}?width=1600&height=900&nologo=true&seed=${D}&model=flux`}catch(he){console.error("Failed to generate default cover",he),Q=`https://via.placeholder.com/1600x900/D4A574/FFFFFF?text=${encodeURIComponent(r)}`}const pe={id:Date.now().toString(),title:r,startDate:u,endDate:m,itinerary:[],coverImage:Q};n(pe)};return v.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe pt-12",children:[v.jsxs("div",{className:"px-4 py-3 flex items-center gap-2 bg-paper sticky top-0 z-10 border-b border-sand/50",children:[v.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-white text-gray-500 active:scale-90 transition-transform",children:v.jsx(ts,{className:"w-6 h-6"})}),v.jsx("h2",{className:"text-lg font-bold text-ink",children:i.new_trip})]}),v.jsxs("form",{onSubmit:X,className:"p-6 space-y-8 flex-1 overflow-y-auto no-scrollbar pb-32",children:[v.jsxs("div",{className:"space-y-3",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase",children:i.trip_destination_title}),v.jsx("div",{className:"relative",children:v.jsx("input",{type:"text",required:!0,value:r,onChange:ne=>a(ne.target.value),placeholder:"...",className:"w-full p-5 bg-white rounded-3xl border border-sand focus:border-coral focus:ring-1 focus:ring-coral/50 transition-all text-lg font-bold text-ink outline-none placeholder:text-gray-300 shadow-sm"})})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase",children:i.cover_photo}),v.jsxs("div",{className:"w-full aspect-video rounded-3xl overflow-hidden bg-white border-2 border-dashed border-sand relative shadow-inner",children:[E?v.jsx("img",{src:E,alt:"Cover",className:"w-full h-full object-cover"}):v.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-300",children:[v.jsx(ic,{className:"w-10 h-10 mb-2 opacity-50"}),v.jsx("span",{className:"text-xs font-bold",children:"Preview"})]}),E&&v.jsx("button",{type:"button",onClick:()=>S(null),className:"absolute top-2 right-2 bg-black/50 text-white p-1.5 rounded-full backdrop-blur-sm",children:v.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),v.jsxs("div",{className:"flex gap-3 mt-2",children:[v.jsxs("button",{type:"button",onClick:()=>{var ne;return(ne=V.current)==null?void 0:ne.click()},className:"flex-1 py-3 bg-white text-gray-600 rounded-2xl font-bold text-sm border border-sand hover:border-coral hover:text-coral transition-colors flex items-center justify-center gap-1.5 shadow-sm",children:[v.jsx(ic,{className:"w-4 h-4"})," ",i.upload_photo]}),v.jsx("input",{type:"file",ref:V,className:"hidden",accept:"image/*",onChange:z}),v.jsx("button",{type:"button",onClick:Z,disabled:A||!r,className:"flex-1 py-3 bg-purple-50 text-purple-600 rounded-2xl font-bold text-sm hover:bg-purple-100 transition-colors flex items-center justify-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed border border-purple-100",children:A?v.jsx("span",{className:"animate-pulse",children:"..."}):v.jsxs(v.Fragment,{children:[v.jsx(wa,{className:"w-4 h-4"})," ",i.ai_generate_cover]})})]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsxs("div",{className:"space-y-3",children:[v.jsxs("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase flex items-center gap-1",children:[v.jsx(M_,{className:"w-3 h-3 text-coral"})," ",i.start_date]}),v.jsx("input",{type:"date",required:!0,value:u,onChange:ne=>f(ne.target.value),className:"w-full p-4 bg-white rounded-2xl border border-sand focus:border-coral outline-none text-sm font-bold text-ink shadow-sm"})]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase flex items-center gap-1",children:[v.jsx(M_,{className:"w-3 h-3 text-gray-400"})," ",i.end_date]}),v.jsx("input",{type:"date",value:m,onChange:ne=>p(ne.target.value),className:"w-full p-4 bg-white rounded-2xl border border-sand focus:border-coral outline-none text-sm font-bold text-ink shadow-sm"})]})]}),v.jsxs("div",{className:"pt-4",children:[v.jsxs("button",{type:"submit",className:"w-full py-4 bg-coral text-white rounded-2xl font-bold text-lg shadow-float active:scale-[0.98] transition-all flex items-center justify-center gap-2 hover:bg-coralDark ring-4 ring-white",children:[v.jsx("span",{children:i.create_trip}),v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 text-white/70",children:v.jsx("path",{fillRule:"evenodd",d:"M3 10a.75.75 0 01.75-.75h10.638L10.23 5.29a.75.75 0 111.04-1.08l5.5 5.25a.75.75 0 010 1.08l-5.5 5.25a.75.75 0 11-1.04-1.08l4.158-3.96H3.75A.75.75 0 013 10z",clipRule:"evenodd"})})]}),v.jsx("p",{className:"text-center text-xs text-gray-400 mt-6 font-medium",children:i.add_trip_hint})]})]})]})},ML=({settings:n,onBack:e})=>{const t=(n==null?void 0:n.language)||"zh-TW",i=on[t]||on["zh-TW"],[r,a]=W.useState(null),[u,f]=W.useState(null),[m,p]=W.useState(""),[E,S]=W.useState(!1),[A,R]=W.useState(null),V=W.useRef(null),z=X=>{var Q;const ne=(Q=X.target.files)==null?void 0:Q[0];if(ne){const pe=new FileReader;pe.onloadend=()=>{const he=pe.result;a(he),f(null),R(null)},pe.readAsDataURL(ne)}},Z=async()=>{if(!(!r||!m)){S(!0),R(null);try{const X=await x1(r,m);f(X)}catch(X){R("Error"),console.error(X)}finally{S(!1)}}};return v.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[v.jsxs("div",{className:"px-5 py-4 pt-9 bg-paper sticky top-0 z-10 flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{onClick:e,children:v.jsx(ts,{className:"w-6 h-6 text-gray-500"})}),v.jsxs("h2",{className:"text-xl font-extrabold text-ink flex items-center gap-2",children:[v.jsx(wa,{className:"w-6 h-6 text-coral"}),i.magic_editor_title]})]}),v.jsx("span",{className:"text-[10px] font-bold bg-white text-coral border border-coral/20 px-2 py-1 rounded-lg uppercase tracking-wider shadow-sm",children:"Beta"})]}),v.jsx("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 pb-32 no-scrollbar",children:r?v.jsxs("div",{className:"space-y-6 animate-fade-in",children:[v.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-6 snap-x no-scrollbar px-2",children:[v.jsxs("div",{className:"snap-center shrink-0 w-full bg-white p-3 pb-12 rounded-sm shadow-polaroid rotate-1 relative transition-transform hover:rotate-0 duration-300",children:[v.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden mb-2",children:v.jsx("img",{src:r,alt:"Original",className:"w-full h-full object-cover"})}),v.jsx("div",{className:"absolute bottom-4 left-4 font-handwriting text-gray-500 text-sm font-bold",children:"#Original"}),v.jsx("button",{onClick:()=>{a(null),f(null),p("")},className:"absolute -top-2 -right-2 bg-white text-ink p-2 rounded-full shadow-lg border border-sand hover:text-coral",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:v.jsx("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"})})})]}),u&&v.jsxs("div",{className:"snap-center shrink-0 w-full bg-white p-3 pb-12 rounded-sm shadow-polaroid -rotate-1 relative transition-transform hover:rotate-0 duration-300 ring-2 ring-coral/20",children:[v.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden mb-2",children:v.jsx("img",{src:u,alt:"Magic Result",className:"w-full h-full object-cover"})}),v.jsxs("div",{className:"absolute bottom-4 left-4 font-handwriting text-coral font-bold flex items-center gap-1",children:[v.jsx(wa,{className:"w-4 h-4"})," #MagicEdit"]})]})]}),v.jsxs("div",{className:"bg-white p-2 rounded-3xl shadow-card border border-sand",children:[v.jsxs("div",{className:"p-4",children:[v.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2 uppercase tracking-wider",children:"Prompt"}),v.jsx("textarea",{value:m,onChange:X=>p(X.target.value),placeholder:i.magic_prompt_placeholder,className:"w-full p-4 rounded-2xl bg-paper border-0 focus:ring-2 focus:ring-coral/50 outline-none text-base resize-none h-24 placeholder:text-gray-300 font-medium text-ink"})]}),A&&v.jsxs("div",{className:"mx-4 mb-2 text-red-500 text-xs bg-red-50 p-3 rounded-xl flex items-center gap-2 font-bold",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),A]}),v.jsx("div",{className:"p-2",children:v.jsx("button",{onClick:Z,disabled:E||!m.trim(),className:`w-full py-4 rounded-2xl font-bold text-white shadow-lg flex items-center justify-center gap-2 transition-all ${E||!m.trim()?"bg-gray-300 cursor-not-allowed text-gray-500 shadow-none":"bg-coral hover:bg-coralDark hover:shadow-coral/30 active:scale-[0.98]"}`,children:E?v.jsxs(v.Fragment,{children:[v.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[v.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),v.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i.generating]}):v.jsxs(v.Fragment,{children:[v.jsx(wa,{className:"w-5 h-5 stroke-[2]"}),i.start_magic]})})})]})]}):v.jsxs("div",{onClick:()=>{var X;return(X=V.current)==null?void 0:X.click()},className:"border-2 border-dashed border-sand rounded-3xl h-80 flex flex-col items-center justify-center bg-white cursor-pointer active:scale-[0.98] transition-all hover:border-coral hover:bg-white/80 group shadow-card",children:[v.jsx("div",{className:"w-20 h-20 bg-paper rounded-full shadow-inner flex items-center justify-center mb-5 group-hover:scale-110 transition-transform",children:v.jsx(ic,{className:"w-10 h-10 text-coral"})}),v.jsx("span",{className:"text-ink font-bold text-lg",children:i.upload_hint}),v.jsx("input",{type:"file",ref:V,onChange:z,className:"hidden",accept:"image/*"})]})})]})},PL="modulepreload",DL=function(n){return"/"+n},Dw={},qm=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let u=function(p){return Promise.all(p.map(E=>Promise.resolve(E).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));r=u(t.map(p=>{if(p=DL(p),p in Dw)return;Dw[p]=!0;const E=p.endsWith(".css"),S=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${S}`))return;const A=document.createElement("link");if(A.rel=E?"stylesheet":PL,E||(A.as="script"),A.crossOrigin="",A.href=p,m&&A.setAttribute("nonce",m),document.head.appendChild(A),E)return new Promise((R,V)=>{A.addEventListener("load",R),A.addEventListener("error",()=>V(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return r.then(u=>{for(const f of u||[])f.status==="rejected"&&a(f.reason);return e().catch(a)})},kL=({items:n,onUpdateItems:e,settings:t})=>{const i=on[t.language]||on["zh-TW"],[r,a]=W.useState(""),[u,f]=W.useState(""),[m,p]=W.useState(!1),E=()=>{if(!r.trim())return;const R={id:Date.now().toString(),item:r,bought:!1,notes:u},V=[...n,R];e(V),a(""),f(""),p(!1)},S=R=>{const V=n.map(z=>z.id===R?{...z,bought:!z.bought}:z);e(V)},A=R=>{if(confirm(i.delete_trip_confirm.replace("{title}",i.shopping_list))){const V=n.filter(z=>z.id!==R);e(V)}};return v.jsxs("div",{className:"pb-40",children:[v.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-soft text-center mt-2 border border-sand relative overflow-hidden mb-6",children:[v.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-coral"}),v.jsx("h3",{className:"text-gray-400 text-sm font-bold uppercase tracking-widest mb-2",children:i.shopping_list}),v.jsxs("div",{className:"text-5xl font-black text-ink mb-2 tracking-tight",children:[(n==null?void 0:n.filter(R=>R.bought).length)||0,v.jsx("span",{className:"text-2xl text-gray-300 mx-2",children:"/"}),v.jsx("span",{className:"text-3xl text-gray-400",children:(n==null?void 0:n.length)||0})]})]}),(n==null?void 0:n.length)>0?v.jsx("div",{className:"space-y-3",children:n==null?void 0:n.map(R=>v.jsxs("div",{className:`bg-white p-4 rounded-2xl border ${R.bought?"border-green-200 bg-green-50/30":"border-sand"} shadow-card flex items-center justify-between group transition-all`,children:[v.jsxs("div",{className:"flex items-center gap-4 flex-1",onClick:()=>S(R.id),children:[v.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center cursor-pointer transition-colors ${R.bought?"bg-green-500 border-green-500":"border-gray-300 hover:border-coral"}`,children:R.bought&&v.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),v.jsxs("div",{children:[v.jsx("div",{className:`font-bold text-lg ${R.bought?"text-gray-400 line-through":"text-ink"}`,children:R.item}),R.notes&&v.jsx("div",{className:"text-xs text-gray-400 font-medium mt-0.5",children:R.notes})]})]}),v.jsx("button",{onClick:()=>A(R.id),className:"p-2 text-gray-300 hover:text-red-500 transition-colors",children:v.jsx(Ra,{className:"w-5 h-5"})})]},R.id))}):v.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[v.jsx("div",{className:"w-16 h-16 bg-sand/30 rounded-full flex items-center justify-center text-gray-400",children:v.jsx(Kb,{className:"w-8 h-8"})}),v.jsxs("p",{className:"text-gray-400 font-medium",children:[i.no_itinerary,v.jsx("br",{}),v.jsx("span",{className:"text-xs",children:i.click_add})]})]}),m&&v.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>p(!1),children:v.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:R=>R.stopPropagation(),children:[v.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_activity}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.activity_name}),v.jsx("input",{value:r,onChange:R=>a(R.target.value),placeholder:i.shopping_list,className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal",autoFocus:!0})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.notes}),v.jsx("input",{value:u,onChange:R=>f(R.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-medium border-none shadow-sm outline-none placeholder:font-normal"})]}),v.jsx("button",{onClick:E,disabled:!r.trim(),className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 mt-4 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:i.confirm})]})]})}),v.jsx("button",{onClick:()=>p(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-coral text-white rounded-full shadow-xl shadow-coral/40 flex items-center justify-center z-30 hover:bg-coralDark active:scale-90 transition-all",children:v.jsx(Om,{className:"w-8 h-8 stroke-[2]"})})]})},LL=({trip:n,settings:e,onUpdateTrip:t,onOpenQuickExpense:i})=>{var Rt;const r=on[e.language]||on["zh-TW"],[a,u]=W.useState(null),[f,m]=W.useState(""),[p,E]=W.useState(!1),[S,A]=W.useState(!1),R=W.useRef(null),[V,z]=W.useState(!1),[Z,X]=W.useState(null),[ne,Q]=W.useState(1),[pe,he]=W.useState("09:00"),[Y,D]=W.useState(""),[B,O]=W.useState(""),[G,q]=W.useState(""),[K,F]=W.useState(null),[qe,Je]=W.useState("TRAIN"),[ie,be]=W.useState(""),[Se,$e]=W.useState(""),[Me,j]=W.useState(null),[fe,Ie]=W.useState(!1),le=W.useMemo(()=>{const ve=n.itinerary||[],Ve={};return[...ve].sort((pt,dt)=>pt.time.localeCompare(dt.time)).forEach(pt=>{const dt=pt.day||1;Ve[dt]||(Ve[dt]=[]),Ve[dt].push(pt)}),Ve},[n.itinerary]),ge=W.useMemo(()=>Object.keys(le).map(Number).sort((ve,Ve)=>ve-Ve),[le]);W.useEffect(()=>{a||et()},[a]),W.useEffect(()=>()=>{window.speechSynthesis.cancel()},[]);const Ae=async()=>{const ve=[`${n.title} (${n.startDate} - ${n.endDate})`];ge.forEach(Ye=>{ve.push(`
Day ${Ye}:`),le[Ye].forEach(pt=>{ve.push(`${pt.time} ${pt.activity}`),pt.travelToNext&&ve.push(`   ${pt.travelToNext.mode} (${pt.travelToNext.duration})`)})});const Ve=ve.join(`
`);try{navigator.share?await navigator.share({title:n.title,text:Ve}):(await navigator.clipboard.writeText(Ve),alert(r.share_success))}catch(Ye){console.error("Error sharing:",Ye)}},He=async()=>{if(!(!n.weather||n.weather.length===0)){Ie(!0);try{const ve=await M1(n.weather,n.title,e.language);j(ve)}catch{j("")}finally{Ie(!1)}}},Ue=async(ve,Ve)=>{u({name:ve,location:Ve}),m(""),E(!0);try{const Ye=await A1(Ve,ve);m(Ye||"")}catch{m("")}finally{E(!1)}},we=()=>{if(S){et();return}if(!f)return;const ve=new SpeechSynthesisUtterance(f);ve.lang=e.language==="en-US"?"en-US":"zh-TW",ve.rate=1,ve.onend=()=>A(!1),R.current=ve,window.speechSynthesis.speak(ve),A(!0)},et=()=>{window.speechSynthesis.cancel(),A(!1)},vt=async ve=>{const Ve=le[ve];if(!Ve||(Ve==null?void 0:Ve.length)<3){alert(r.optimize_route_min_items||"Need at least 3 items to optimize.");return}F(ve);try{const pt=(await N1(Ve,e.language)).map(an=>Ve.find(ns=>ns.id===an)).filter(Boolean),dt=Ve.map(an=>an.time).sort(),xn=pt.map((an,ns)=>({...an,time:dt[ns]})),ki=[...(n.itinerary||[]).filter(an=>an.day!==ve),...xn];t==null||t({...n,itinerary:ki})}catch(Ye){console.error("Optimization failed",Ye),alert("Route optimization failed.")}finally{F(null)}},nt=ve=>{X(ve.id),Q(ve.day),he(ve.time),D(ve.activity),O(ve.location),q(ve.notes||""),ve.travelToNext?(Je(ve.travelToNext.mode),be(ve.travelToNext.duration),$e(ve.travelToNext.details||"")):(be(""),$e("")),z(!0)},qt=async()=>{var dt;if(!Y)return;let ve=null;if(B)try{const{geocodeAddress:xn}=await qm(async()=>{const{geocodeAddress:an}=await Promise.resolve().then(()=>o4);return{geocodeAddress:an}},void 0),Si=xn(B),ki=new Promise((an,ns)=>setTimeout(()=>ns(new Error("Geocoding timeout")),5e3));ve=await Promise.race([Si,ki])}catch(xn){console.error("Auto-geocoding failed or timed out",xn)}const Ve=Z?(dt=n.itinerary)==null?void 0:dt.find(xn=>xn.id===Z):null,Ye={id:Z||Date.now().toString(),day:Number(ne),time:pe,activity:Y,location:B,notes:G,coordinates:ve||(Ve==null?void 0:Ve.coordinates)||null,lat:(ve==null?void 0:ve.lat)??(Ve==null?void 0:Ve.lat)??null,lng:(ve==null?void 0:ve.lng)??(Ve==null?void 0:Ve.lng)??null,attachments:(Ve==null?void 0:Ve.attachments)||[],...ie?{travelToNext:{mode:qe,duration:ie,details:Se}}:{}};let pt;Z?pt=(n.itinerary||[]).map(xn=>xn.id===Z?Ye:xn):pt=[...n.itinerary||[],Ye],t==null||t({...n,itinerary:pt}),X(null),D(""),O(""),q(""),be(""),$e(""),z(!1)},_n=ve=>{if(confirm(r.delete_trip_confirm.replace("{title}",r.itinerary))){const Ve=(n.itinerary||[]).filter(Ye=>Ye.id!==ve);t==null||t({...n,itinerary:Ve})}},Vt=ve=>{ve&&window.open(ve,"_blank")},yt=ve=>{switch(ve){case"WALK":return v.jsx(Y2,{className:"w-4 h-4"});case"TRAIN":return v.jsx(oE,{className:"w-4 h-4"});case"BUS":return v.jsx(J2,{className:"w-4 h-4"});case"CAR":return v.jsx(O2,{className:"w-4 h-4"});case"FLIGHT":return v.jsx(zb,{className:"w-4 h-4"});default:return v.jsx(oE,{className:"w-4 h-4"})}},St=()=>{var ve,Ve;return!n.weather||((ve=n.weather)==null?void 0:ve.length)===0?null:v.jsxs("div",{className:"mb-6",children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1",children:r.weather}),v.jsxs("button",{onClick:He,disabled:fe,className:"text-xs font-bold text-coral flex items-center gap-1 hover:bg-coral/10 px-2 py-1 rounded-lg transition-colors",children:[v.jsx(P_,{className:"w-3 h-3"}),fe?"...":""]})]}),v.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar pb-2",children:(Ve=n.weather)==null?void 0:Ve.map((Ye,pt)=>v.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center justify-center gap-1 bg-white border border-sand p-3 rounded-2xl min-w-[70px] shadow-sm",children:[v.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:Ye.date}),v.jsx("span",{className:"text-2xl drop-shadow-sm",children:Ye.icon}),v.jsxs("span",{className:"text-xs font-bold text-ink",children:[Ye.tempHigh,""]})]},pt))}),Me&&v.jsxs("div",{className:"mt-4 bg-white p-5 rounded-3xl shadow-card border border-sand animate-fade-in relative",children:[v.jsx("button",{onClick:()=>j(null),className:"absolute top-3 right-3 text-gray-300 hover:text-gray-500",children:v.jsx(Ra,{className:"w-4 h-4"})}),v.jsxs("div",{className:"flex items-start gap-3",children:[v.jsx("div",{className:"bg-orange-100 p-2 rounded-full text-orange-500 shrink-0",children:v.jsx(P_,{className:"w-5 h-5"})}),v.jsxs("div",{children:[v.jsx("h5",{className:"font-bold text-ink mb-2",children:"AI "}),v.jsx("div",{className:"prose prose-sm text-gray-600 leading-relaxed whitespace-pre-line",children:Me})]})]})]})]})},kt=e==null?void 0:e.minimalistMode;return v.jsxs("div",{className:"pb-40 relative min-h-full",children:[v.jsxs("div",{className:"sticky top-0 z-20 bg-paper/95 backdrop-blur-md border-b border-sand/50 py-3 mb-6 -mx-5 px-5 flex items-center justify-between shadow-sm",children:[v.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar flex-1 mr-2",children:[v.jsx("span",{className:"text-xs font-bold text-gray-400 shrink-0 mr-1",children:r.nav_quick_jump}),ge.map(ve=>v.jsxs("button",{onClick:()=>{const Ve=document.getElementById(`day-header-${ve}`);Ve&&Ve.scrollIntoView({behavior:"smooth",block:"start"})},className:"flex-shrink-0 px-4 py-1.5 bg-white border border-sand rounded-full font-bold text-ink text-xs hover:border-coral hover:text-coral hover:shadow-md active:bg-coral active:text-white transition-all whitespace-nowrap",children:[r.day," ",ve]},`nav-${ve}`))]}),v.jsx("button",{onClick:Ae,className:"p-2 bg-white rounded-full border border-sand text-coral hover:bg-coral hover:text-white transition-colors shadow-sm shrink-0",children:v.jsx(Z2,{className:"w-5 h-5"})})]}),!kt&&St(),((Rt=n.itinerary)==null?void 0:Rt.length)>0?v.jsxs("div",{children:[!kt&&v.jsx("h4",{className:"text-xs font-bold text-gray-400 mb-4 uppercase tracking-wider ml-1",children:r.itinerary}),ge.map(ve=>{var Ve;return v.jsxs("div",{className:"mb-8 scroll-mt-48",id:`day-header-${ve}`,children:[v.jsxs("div",{className:"flex items-center gap-3 mb-4 sticky top-[60px] bg-paper py-2 z-10 border-b border-sand/50 shadow-sm",children:[v.jsxs("div",{className:"bg-coral text-white px-3 py-1 rounded-lg text-sm font-bold shadow-sm",children:[r.day," ",ve]}),v.jsx("div",{className:"h-px bg-sand flex-1"}),v.jsxs("button",{onClick:()=>vt(ve),disabled:K===ve,className:"flex items-center gap-1 text-xs font-bold text-coral bg-white border border-coral px-2 py-1 rounded-lg hover:bg-coral hover:text-white transition-colors disabled:opacity-50",children:[K===ve?v.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"}):v.jsx(wa,{className:"w-3 h-3"}),r.optimize_route||"AI Route"]})]}),v.jsx("div",{className:`space-y-0 relative ${kt?"":"border-l-2 border-sand ml-4"}`,children:(Ve=le[ve])==null?void 0:Ve.map((Ye,pt)=>v.jsxs("div",{className:"relative group",children:[v.jsxs("div",{className:`relative ${kt?"mb-4 border-b border-sand pb-4":"pl-8 pb-10 last:pb-0"}`,children:[!kt&&v.jsx("div",{className:"absolute -left-[7px] top-1.5 w-3.5 h-3.5 rounded-full border-2 border-paper shadow-sm bg-gray-300 group-hover:bg-coral transition-colors"}),v.jsxs("div",{className:"transition-all opacity-90 group-hover:opacity-100",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("div",{className:"flex items-center gap-2",children:v.jsx("span",{className:"text-xs font-bold font-mono text-coral bg-coral/10 px-2 py-1 rounded-lg",children:Ye.time})}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:dt=>{dt.stopPropagation(),i(Ye)},className:"p-1.5 bg-white text-gray-400 rounded-full border border-sand hover:text-green-600 hover:border-green-600 shadow-sm",title:"",children:v.jsx(Fb,{className:"w-3 h-3"})}),v.jsx("button",{onClick:dt=>{dt.stopPropagation(),nt(Ye)},className:"p-1.5 bg-white text-gray-400 rounded-full border border-sand hover:text-coral hover:border-coral shadow-sm",title:"",children:v.jsx(jb,{className:"w-3 h-3"})}),v.jsx("button",{onClick:dt=>{dt.stopPropagation(),_n(Ye.id)},className:"p-1.5 bg-white text-red-400 rounded-full border border-red-200 hover:bg-red-50 hover:text-red-600 hover:border-red-500 shadow-sm transition-colors",title:"",children:v.jsx(Ra,{className:"w-3 h-3"})})]})]}),v.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-card border border-transparent hover:border-sand transition-all relative",children:[v.jsx("button",{onClick:dt=>{dt.stopPropagation(),Ue(Ye.activity,Ye.location)},className:"absolute top-4 right-4 text-gray-300 hover:text-coral transition-colors",children:v.jsx(U2,{className:"w-5 h-5"})}),v.jsx("h4",{className:`font-bold text-ink ${kt?"text-base":"text-lg"} mb-1 pr-6`,children:Ye.activity}),v.jsxs("div",{onClick:()=>Vt(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(Ye.location)}`),className:"flex items-center gap-1.5 text-sm text-gray-500 cursor-pointer hover:text-coral truncate mt-1",children:[v.jsx(R_,{className:"w-3.5 h-3.5 shrink-0 text-coral"}),Ye.location]}),Ye.notes&&!kt&&v.jsx("p",{className:"text-sm text-gray-600 mt-3 pt-3 border-t border-gray-50 leading-relaxed",children:Ye.notes})]})]})]}),Ye.travelToNext&&!kt&&v.jsxs("div",{className:"pl-8 pb-10 relative",children:[v.jsx("div",{className:"absolute left-[0px] top-0 bottom-0 w-0.5 border-l-2 border-dotted border-gray-300 -ml-[1px]"}),v.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-sand rounded-xl p-3 w-fit max-w-[80%]",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-sand flex items-center justify-center text-gray-500 shadow-sm shrink-0",children:yt(Ye.travelToNext.mode)}),v.jsx("div",{children:v.jsxs("div",{className:"text-xs font-bold text-gray-500 flex items-center gap-1",children:[Ye.travelToNext.duration,Ye.travelToNext.details&&v.jsxs("span",{className:"font-normal text-gray-400",children:[" ",Ye.travelToNext.details]})]})})]})]})]},Ye.id||pt))})]},ve)})]}):v.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[v.jsx("div",{className:"w-16 h-16 bg-sand/30 rounded-full flex items-center justify-center text-gray-400",children:v.jsx(Hb,{className:"w-8 h-8"})}),v.jsxs("p",{className:"text-gray-400 font-medium",children:[r.no_itinerary,v.jsx("br",{}),v.jsx("span",{className:"text-xs",children:r.click_add})]})]}),a&&v.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>u(null),children:v.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[80vh] overflow-y-auto",onClick:ve=>ve.stopPropagation(),children:[v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsx("h3",{className:"text-xl font-bold text-ink",children:a.name}),v.jsx("button",{onClick:we,className:`p-2 rounded-full ${S?"bg-coral text-white":"bg-gray-100 text-gray-500"}`,children:v.jsx(VL,{className:"w-5 h-5"})})]}),p?v.jsx("div",{className:"flex justify-center py-10",children:v.jsx("div",{className:"w-8 h-8 border-4 border-coral border-t-transparent rounded-full animate-spin"})}):v.jsx("div",{className:"prose prose-sm text-gray-600 leading-relaxed whitespace-pre-line",children:f})]})}),V&&v.jsx("div",{className:"fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>z(!1),children:v.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",onClick:ve=>ve.stopPropagation(),children:[v.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:Z?r.edit_activity:r.add_activity}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.day}),v.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-sand px-3",children:[v.jsx("span",{className:"text-sm font-bold text-gray-400 mr-2",children:r.day}),v.jsx("input",{type:"number",min:"1",value:ne,onChange:ve=>Q(parseInt(ve.target.value)||1),className:"w-full bg-transparent p-3 text-lg font-bold border-none outline-none text-ink"})]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.time}),v.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-sand px-3",children:[v.jsx(V2,{className:"w-5 h-5 text-gray-400 mr-2"}),v.jsx("input",{type:"time",value:pe,onChange:ve=>he(ve.target.value),className:"w-full bg-transparent p-3 text-lg font-bold border-none outline-none text-ink"})]})]})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.activity_name}),v.jsx("input",{value:Y,onChange:ve=>D(ve.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300",autoFocus:!0})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.location}),v.jsx("input",{value:B,onChange:ve=>O(ve.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300"})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.notes}),v.jsx("textarea",{value:G,onChange:ve=>q(ve.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-medium border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300 min-h-[80px]"})]}),v.jsxs("div",{className:"pt-4 border-t border-sand",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 mb-2 block",children:r.travel_to_next}),v.jsx("div",{className:"flex gap-2 mb-3 overflow-x-auto no-scrollbar",children:["WALK","TRAIN","BUS","CAR","FLIGHT"].map(ve=>v.jsx("button",{onClick:()=>Je(ve),className:`p-2 rounded-lg border ${qe===ve?"bg-ink text-white border-ink":"bg-white text-gray-400 border-sand"}`,children:yt(ve)},ve))}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsx("input",{value:ie,onChange:ve=>be(ve.target.value),placeholder:"1h 30m",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"}),v.jsx("input",{value:Se,onChange:ve=>$e(ve.target.value),placeholder:"Details...",className:"w-full bg-white p-3 rounded-xl text-sm font-medium border-none shadow-sm outline-none"})]})]}),v.jsx("div",{className:"sticky bottom-0 bg-paper pt-4 mt-4 border-t border-sand z-10 pb-20",children:v.jsx("button",{onClick:qt,disabled:!Y,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:Z?r.confirm:r.add_activity})})]})]})}),v.jsx("button",{onClick:()=>{X(null),Q(1),he("09:00"),D(""),O(""),q(""),be(""),$e(""),z(!0)},className:"fixed bottom-24 right-6 w-14 h-14 bg-coral text-white rounded-full shadow-xl shadow-coral/40 flex items-center justify-center z-30 hover:bg-coralDark active:scale-90 transition-all",children:v.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})},VL=({className:n})=>v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:n,children:[v.jsx("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 001.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06zM18.584 5.106a.75.75 0 011.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 11-1.06-1.06 8.25 8.25 0 000-11.668.75.75 0 010-1.06z"}),v.jsx("path",{d:"M15.932 7.757a.75.75 0 011.061 0 6 6 0 010 8.486.75.75 0 01-1.06-1.061 4.5 4.5 0 000-6.364.75.75 0 010-1.06z"})]}),Fy=[{code:"TWD",symbol:"NT$",name:""},{code:"JPY",symbol:"",name:""},{code:"USD",symbol:"$",name:""},{code:"EUR",symbol:"",name:""},{code:"KRW",symbol:"",name:""},{code:"CNY",symbol:"",name:""},{code:"HKD",symbol:"HK$",name:""},{code:"GBP",symbol:"",name:""},{code:"THB",symbol:"",name:""},{code:"SGD",symbol:"S$",name:""}],Rl=n=>{const e=Fy.find(t=>t.code===n);return e?e.symbol:n},OL=({trip:n,settings:e,onUpdateTrip:t})=>{var Me,j,fe,Ie,le,ge,Ae,He,Ue;const i=on[e.language]||on["zh-TW"],[r,a]=W.useState(!1),[u,f]=W.useState(""),[m,p]=W.useState(""),[E,S]=W.useState(""),[A,R]=W.useState("Cash"),[V,z]=W.useState(((Me=n.budget)==null?void 0:Me.currency)||"TWD"),[Z,X]=W.useState(""),[ne,Q]=W.useState(0),[pe,he]=W.useState(!1),[Y,D]=W.useState(null),[B,O]=W.useState(!1),[G,q]=W.useState(""),K=()=>{var et,vt;const we=parseInt(G);if(!isNaN(we)&&we>=0){const nt={...n,budget:{...n.budget,total:we,currency:((et=n.budget)==null?void 0:et.currency)||"TWD",expenses:((vt=n.budget)==null?void 0:vt.expenses)||[]}};t==null||t(nt)}O(!1)};W.useEffect(()=>{var we;r&&(z(((we=n.budget)==null?void 0:we.currency)||"TWD"),X(""))},[r,(j=n.budget)==null?void 0:j.currency]),W.useEffect(()=>{(async()=>{var vt;const et=((vt=n.budget)==null?void 0:vt.currency)||"TWD";if(D(null),V!==et&&(e.apiKey||void 0||typeof window<"u"&&localStorage.getItem("nomad_user_api_key"))){he(!0);try{const qt=await zy(V,et);qt?X(qt):D(" (API Key )")}catch(qt){console.error(qt),D("")}he(!1)}})()},[V,(fe=n.budget)==null?void 0:fe.currency,e.apiKey]),W.useEffect(()=>{const we=parseFloat(m)||0,et=parseFloat(Z)||1;Q(Math.round(we*et))},[m,Z]);const F=()=>{var Vt,yt,St;if(!u||!m)return;const we=parseFloat(m);if(we<=0){alert(i.amount_invalid||"Amount must be greater than 0");return}const et=parseFloat(Z)||1,vt=Math.round(we*et),nt={id:Date.now().toString(),title:u,amount:vt,category:"Other",date:new Date().toISOString().split("T")[0],payer:E||"ME",paymentMethod:A,originalCurrency:V,originalAmount:we,exchangeRate:et},qt=((Vt=n.budget)==null?void 0:Vt.expenses)||[],_n={...n,budget:{...n.budget,total:((yt=n.budget)==null?void 0:yt.total)||0,currency:((St=n.budget)==null?void 0:St.currency)||"TWD",expenses:[nt,...qt]}};t==null||t(_n),a(!1),f(""),p("")},qe=we=>{var et,vt,nt;if(confirm(i.delete_trip_confirm.replace("{title}",i.expense_item))){const _n=(((et=n.budget)==null?void 0:et.expenses)||[]).filter(yt=>yt.id!==we),Vt={...n,budget:{...n.budget,total:((vt=n.budget)==null?void 0:vt.total)||0,currency:((nt=n.budget)==null?void 0:nt.currency)||"TWD",expenses:_n}};t==null||t(Vt)}},Je=(((Ie=n.budget)==null?void 0:Ie.expenses)||[]).reduce((we,et)=>we+et.amount,0),ie=((le=n.budget)==null?void 0:le.total)||0,be=ie>0?Math.min(Je/ie*100,100):0,Se=((ge=n.budget)==null?void 0:ge.currency)||"TWD",$e=Rl(Se);return v.jsxs("div",{className:"pb-32",children:[v.jsxs("div",{className:"bg-ink text-white p-6 rounded-3xl shadow-xl mb-8 relative overflow-hidden",children:[v.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -mr-10 -mt-10 blur-2xl"}),v.jsxs("div",{className:"relative z-10",children:[v.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-1",children:i.budget_total}),v.jsx("div",{className:"flex items-center gap-2 mb-6 group",children:B?v.jsxs("div",{className:"flex items-center",children:[v.jsx("span",{className:"text-2xl mr-1 font-black",children:$e}),v.jsx("input",{type:"number",value:G,onChange:we=>q(we.target.value),onBlur:K,onKeyDown:we=>we.key==="Enter"&&K(),className:"bg-transparent text-4xl font-black text-white border-b-2 border-white/20 outline-none w-48",autoFocus:!0})]}):v.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1",children:[v.jsxs("h2",{className:"text-4xl font-black cursor-pointer hover:opacity-80 transition-opacity flex items-center",onClick:()=>{q(ie.toString()),O(!0)},children:[v.jsx("span",{className:"text-2xl mr-1",children:$e}),ie.toLocaleString()]}),v.jsx("button",{onClick:()=>{q(ie.toString()),O(!0)},className:"p-2 bg-white/10 rounded-full hover:bg-white/20 transition-colors flex-shrink-0",title:i.edit_budget||"",children:v.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]})}),v.jsxs("div",{className:"mb-2 flex justify-between text-sm font-bold",children:[v.jsx("span",{className:"text-gray-300",children:i.budget_spent}),v.jsxs("span",{children:[$e,Je.toLocaleString()]})]}),v.jsx("div",{className:"h-3 bg-gray-700 rounded-full overflow-hidden mb-4",children:v.jsx("div",{className:`h-full rounded-full ${be>90?"bg-red-500":"bg-coral"}`,style:{width:`${be}%`}})}),v.jsxs("div",{className:"flex justify-between text-xs text-gray-400 font-medium",children:[v.jsxs("span",{children:[be.toFixed(1),"%"]}),v.jsxs("span",{children:[": ",$e,Je.toLocaleString()]})]})]})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1 mb-2",children:i.expense_list}),(He=(Ae=n.budget)==null?void 0:Ae.expenses)==null?void 0:He.map(we=>{var et;return v.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-sand flex items-center justify-between group",children:[v.jsxs("div",{className:"flex items-center gap-4",children:[v.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold ${we.payer==="ME"?"bg-coral/10 text-coral":"bg-gray-100 text-gray-500"}`,children:we.payer==="ME"?"":""}),v.jsxs("div",{children:[v.jsx("h4",{className:"font-bold text-ink",children:we.title}),v.jsxs("p",{className:"text-xs text-gray-400",children:[we.date,"  ",we.paymentMethod]}),we.originalCurrency&&we.originalCurrency!==Se&&v.jsxs("p",{className:"text-xs text-coral font-medium mt-0.5",children:[Rl(we.originalCurrency),(et=we.originalAmount)==null?void 0:et.toLocaleString(),v.jsx("span",{className:"text-gray-400 mx-1",children:""}),we.exchangeRate]}),we.note&&v.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:we.note})]})]}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsxs("span",{className:"font-bold text-ink text-lg",children:[$e,we.amount.toLocaleString()]}),v.jsx("button",{onClick:()=>qe(we.id),className:"text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all",children:v.jsx(Ra,{className:"w-5 h-5"})})]})]},we.id)}),(!((Ue=n.budget)!=null&&Ue.expenses)||n.budget.expenses.length===0)&&v.jsx("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:i.no_expenses})]}),r&&v.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>a(!1),children:v.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up relative",onClick:we=>we.stopPropagation(),children:[v.jsx("button",{onClick:()=>a(!1),className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:v.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),v.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_expense}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.expense_item}),v.jsx("input",{value:u,onChange:we=>f(we.target.value),placeholder:": ",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal",autoFocus:!0,onFocus:we=>we.target.select()})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.amount}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("select",{value:V,onChange:we=>z(we.target.value),className:"bg-white rounded-xl border-none shadow-sm px-3 font-bold text-ink outline-none",children:Fy.map(we=>v.jsx("option",{value:we.code,children:we.code},we.code))}),v.jsxs("div",{className:"flex-1 flex items-center bg-white rounded-xl border-none shadow-sm px-4",children:[v.jsx("span",{className:"text-gray-400 font-bold mr-2",children:Rl(V)}),v.jsx("input",{value:m,onChange:we=>p(we.target.value),type:"number",placeholder:"0",className:"w-full bg-transparent py-4 text-xl font-bold border-none outline-none placeholder:font-normal",onFocus:we=>we.target.select()})]})]})]}),V!==Se&&v.jsxs("div",{className:"space-y-1 bg-sand/30 p-3 rounded-xl",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsxs("label",{className:"text-xs font-bold text-gray-500",children:[" (",V,"  ",Se,")"]}),v.jsxs("span",{className:"text-xs font-bold text-coral",children:[" ",$e,ne.toLocaleString()]})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{value:Z,onChange:we=>X(we.target.value),type:"number",step:"0.01",placeholder:pe?"...":"Exchange Rate",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none",onFocus:we=>we.target.select(),disabled:pe}),pe&&v.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:v.jsx("div",{className:"w-4 h-4 border-2 border-coral border-t-transparent rounded-full animate-spin"})})]}),!e.apiKey&&!0&&v.jsx("p",{className:"text-[10px] text-red-400 mt-1",children:"*  API Key "}),Y&&v.jsxs("p",{className:"text-[10px] text-red-400 mt-1",children:["* ",Y]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{className:"flex bg-white rounded-xl p-1 shadow-sm",children:[v.jsx("button",{onClick:()=>S("ME"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${E==="ME"||E===""?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payer_me}),v.jsx("button",{onClick:()=>S("OTHER"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${E==="OTHER"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payer_other})]}),v.jsxs("div",{className:"flex bg-white rounded-xl p-1 shadow-sm",children:[v.jsx("button",{onClick:()=>R("Cash"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${A==="Cash"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payment_cash}),v.jsx("button",{onClick:()=>R("Card"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${A==="Card"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payment_card})]})]}),v.jsx("div",{className:"space-y-1",children:v.jsxs("select",{className:"w-full bg-white p-3 rounded-xl font-bold text-ink border-none shadow-sm outline-none h-[48px] text-center",children:[v.jsx("option",{value:"Individual",children:i.split_individual}),v.jsx("option",{value:"Shared",children:i.split_shared})]})}),v.jsxs("div",{className:"space-y-3 pt-2",children:[v.jsx("button",{onClick:F,disabled:!u||!m,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:"+ "}),v.jsx("button",{onClick:()=>a(!1),className:"w-full py-3 bg-transparent text-gray-400 font-bold hover:text-gray-600 transition-colors",children:""})]})]})]})}),v.jsx("button",{onClick:()=>a(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-ink text-white rounded-full shadow-xl shadow-ink/40 flex items-center justify-center z-30 hover:scale-105 active:scale-95 transition-all",children:v.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})},UL=({trip:n,settings:e,onUpdateTrip:t})=>{var Y;const i=on[e.language]||on["zh-TW"],[r,a]=W.useState(!1),[u,f]=W.useState("FLIGHT"),[m,p]=W.useState(""),[E,S]=W.useState(""),[A,R]=W.useState(""),[V,z]=W.useState(""),[Z,X]=W.useState(""),[ne,Q]=W.useState(""),pe=()=>{if(!m)return;const B=[{id:Date.now().toString(),type:u,airline:m,number:E||"N/A",origin:A||"-",destination:V||"-",departureTime:Z?`${Z} ${ne}`:ne||"00:00",arrivalTime:"-",status:"Confirmed",bookingUrl:""},...n.bookings||[]];t==null||t({...n,bookings:B}),p(""),S(""),R(""),z(""),X(""),Q(""),a(!1)},he=D=>{if(confirm(i.delete_trip_confirm.replace("{title}",i.bookings))){const O=(n.bookings||[]).filter(G=>G.id!==D);t==null||t({...n,bookings:O})}};return v.jsxs("div",{className:"pb-32",children:[v.jsxs("div",{className:"space-y-4",children:[(Y=n.bookings)==null?void 0:Y.map(D=>v.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-sand relative group",children:[v.jsxs("div",{className:"flex justify-between items-start mb-4",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("div",{className:"w-10 h-10 bg-blue-50 text-blue-500 rounded-xl flex items-center justify-center",children:D.type==="FLIGHT"?v.jsx(zb,{className:"w-5 h-5"}):v.jsx(qb,{className:"w-5 h-5"})}),v.jsxs("div",{children:[v.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:D.type}),v.jsx("h4",{className:"font-bold text-ink text-lg",children:D.airline})]})]}),v.jsx("div",{className:"text-right",children:v.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-bold ${D.status==="Confirmed"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-500"}`,children:D.status})})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[v.jsxs("div",{children:[v.jsx("p",{className:"text-xs text-gray-400 font-bold mb-1",children:"DEPARTURE"}),v.jsx("p",{className:"text-ink font-bold text-lg",children:D.origin}),v.jsx("p",{className:"text-sm text-gray-500",children:D.departureTime})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("p",{className:"text-xs text-gray-400 font-bold mb-1",children:"ARRIVAL"}),v.jsx("p",{className:"text-ink font-bold text-lg",children:D.destination}),v.jsx("p",{className:"text-sm text-gray-500",children:D.arrivalTime})]})]}),v.jsxs("div",{className:"pt-4 border-t border-sand flex justify-between items-center",children:[v.jsxs("div",{className:"text-xs text-gray-400 font-mono",children:["REF: ",v.jsx("span",{className:"text-ink font-bold",children:D.number})]}),v.jsx("button",{onClick:()=>he(D.id),className:"text-gray-300 hover:text-red-500 transition-colors",children:v.jsx(Ra,{className:"w-4 h-4"})})]})]},D.id)),(!n.bookings||n.bookings.length===0)&&v.jsx("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:i.no_bookings})]}),r&&v.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>a(!1),children:v.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",onClick:D=>D.stopPropagation(),children:[v.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_booking}),v.jsxs("div",{className:"space-y-4",children:[v.jsx("div",{className:"flex bg-white rounded-xl p-1 shadow-sm mb-4",children:["FLIGHT","HOTEL","TRAIN"].map(D=>v.jsx("button",{onClick:()=>f(D),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${u===D?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:D},D))}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.provider}),v.jsx("input",{value:m,onChange:D=>p(D.target.value),placeholder:"Airline / Hotel Name...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none",autoFocus:!0})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.ref_number}),v.jsx("input",{value:E,onChange:D=>S(D.target.value),placeholder:"PNR...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.date}),v.jsx("input",{type:"date",value:Z,onChange:D=>X(D.target.value),className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.origin}),v.jsx("input",{value:A,onChange:D=>R(D.target.value),placeholder:"TPE...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.label_destination}),v.jsx("input",{value:V,onChange:D=>z(D.target.value),placeholder:"NRT...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]})]}),v.jsx("button",{onClick:pe,disabled:!m,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 mt-4 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:i.confirm})]})]})}),v.jsx("button",{onClick:()=>a(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-blue-500 text-white rounded-full shadow-xl shadow-blue-500/40 flex items-center justify-center z-30 hover:scale-105 active:scale-95 transition-all",children:v.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})};function P1(n,e){const t=W.useRef(e);W.useEffect(function(){e!==t.current&&n.attributionControl!=null&&(t.current!=null&&n.attributionControl.removeAttribution(t.current),e!=null&&n.attributionControl.addAttribution(e)),t.current=e},[n,e])}var BL=Bb();const zL=1;function FL(n){return Object.freeze({__version:zL,map:n})}function D1(n,e){return Object.freeze({...n,...e})}const qy=W.createContext(null);function Gm(){const n=W.use(qy);if(n==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}function k1(n){function e(t,i){const{instance:r,context:a}=n(t).current;W.useImperativeHandle(i,()=>r);const{children:u}=t;return u==null?null:Wd.createElement(qy,{value:a},u)}return W.forwardRef(e)}function qL(n){function e(t,i){const[r,a]=W.useState(!1),{instance:u}=n(t,a).current;W.useImperativeHandle(i,()=>u),W.useEffect(function(){r&&u.update()},[u,r,t.children]);const f=u._contentNode;return f?BL.createPortal(t.children,f):null}return W.forwardRef(e)}function GL(n){function e(t,i){const{instance:r}=n(t).current;return W.useImperativeHandle(i,()=>r),null}return W.forwardRef(e)}function Gy(n,e){const t=W.useRef(void 0);W.useEffect(function(){return e!=null&&n.instance.on(e),t.current=e,function(){t.current!=null&&n.instance.off(t.current),t.current=null}},[n,e])}function Hm(n,e){const t=n.pane??e.pane;return t?{...n,pane:t}:n}function HL(n,e){return function(i,r){const a=Gm(),u=n(Hm(i,a),a);return P1(a.map,i.attribution),Gy(u.current,i.eventHandlers),e(u.current,a,i,r),u}}var Rd={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var jL=Rd.exports,kw;function KL(){return kw||(kw=1,(function(n,e){(function(t,i){i(e)})(jL,(function(t){var i="1.9.4";function r(l){var d,T,b,C;for(T=1,b=arguments.length;T<b;T++){C=arguments[T];for(d in C)l[d]=C[d]}return l}var a=Object.create||(function(){function l(){}return function(d){return l.prototype=d,new l}})();function u(l,d){var T=Array.prototype.slice;if(l.bind)return l.bind.apply(l,T.call(arguments,1));var b=T.call(arguments,2);return function(){return l.apply(d,b.length?b.concat(T.call(arguments)):arguments)}}var f=0;function m(l){return"_leaflet_id"in l||(l._leaflet_id=++f),l._leaflet_id}function p(l,d,T){var b,C,P,H;return H=function(){b=!1,C&&(P.apply(T,C),C=!1)},P=function(){b?C=arguments:(l.apply(T,arguments),setTimeout(H,d),b=!0)},P}function E(l,d,T){var b=d[1],C=d[0],P=b-C;return l===b&&T?l:((l-C)%P+P)%P+C}function S(){return!1}function A(l,d){if(d===!1)return l;var T=Math.pow(10,d===void 0?6:d);return Math.round(l*T)/T}function R(l){return l.trim?l.trim():l.replace(/^\s+|\s+$/g,"")}function V(l){return R(l).split(/\s+/)}function z(l,d){Object.prototype.hasOwnProperty.call(l,"options")||(l.options=l.options?a(l.options):{});for(var T in d)l.options[T]=d[T];return l.options}function Z(l,d,T){var b=[];for(var C in l)b.push(encodeURIComponent(T?C.toUpperCase():C)+"="+encodeURIComponent(l[C]));return(!d||d.indexOf("?")===-1?"?":"&")+b.join("&")}var X=/\{ *([\w_ -]+) *\}/g;function ne(l,d){return l.replace(X,function(T,b){var C=d[b];if(C===void 0)throw new Error("No value provided for variable "+T);return typeof C=="function"&&(C=C(d)),C})}var Q=Array.isArray||function(l){return Object.prototype.toString.call(l)==="[object Array]"};function pe(l,d){for(var T=0;T<l.length;T++)if(l[T]===d)return T;return-1}var he="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Y(l){return window["webkit"+l]||window["moz"+l]||window["ms"+l]}var D=0;function B(l){var d=+new Date,T=Math.max(0,16-(d-D));return D=d+T,window.setTimeout(l,T)}var O=window.requestAnimationFrame||Y("RequestAnimationFrame")||B,G=window.cancelAnimationFrame||Y("CancelAnimationFrame")||Y("CancelRequestAnimationFrame")||function(l){window.clearTimeout(l)};function q(l,d,T){if(T&&O===B)l.call(d);else return O.call(window,u(l,d))}function K(l){l&&G.call(window,l)}var F={__proto__:null,extend:r,create:a,bind:u,get lastId(){return f},stamp:m,throttle:p,wrapNum:E,falseFn:S,formatNum:A,trim:R,splitWords:V,setOptions:z,getParamString:Z,template:ne,isArray:Q,indexOf:pe,emptyImageUrl:he,requestFn:O,cancelFn:G,requestAnimFrame:q,cancelAnimFrame:K};function qe(){}qe.extend=function(l){var d=function(){z(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},T=d.__super__=this.prototype,b=a(T);b.constructor=d,d.prototype=b;for(var C in this)Object.prototype.hasOwnProperty.call(this,C)&&C!=="prototype"&&C!=="__super__"&&(d[C]=this[C]);return l.statics&&r(d,l.statics),l.includes&&(Je(l.includes),r.apply(null,[b].concat(l.includes))),r(b,l),delete b.statics,delete b.includes,b.options&&(b.options=T.options?a(T.options):{},r(b.options,l.options)),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){T.callInitHooks&&T.callInitHooks.call(this),this._initHooksCalled=!0;for(var P=0,H=b._initHooks.length;P<H;P++)b._initHooks[P].call(this)}},d},qe.include=function(l){var d=this.prototype.options;return r(this.prototype,l),l.options&&(this.prototype.options=d,this.mergeOptions(l.options)),this},qe.mergeOptions=function(l){return r(this.prototype.options,l),this},qe.addInitHook=function(l){var d=Array.prototype.slice.call(arguments,1),T=typeof l=="function"?l:function(){this[l].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(T),this};function Je(l){if(!(typeof L>"u"||!L||!L.Mixin)){l=Q(l)?l:[l];for(var d=0;d<l.length;d++)l[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ie={on:function(l,d,T){if(typeof l=="object")for(var b in l)this._on(b,l[b],d);else{l=V(l);for(var C=0,P=l.length;C<P;C++)this._on(l[C],d,T)}return this},off:function(l,d,T){if(!arguments.length)delete this._events;else if(typeof l=="object")for(var b in l)this._off(b,l[b],d);else{l=V(l);for(var C=arguments.length===1,P=0,H=l.length;P<H;P++)C?this._off(l[P]):this._off(l[P],d,T)}return this},_on:function(l,d,T,b){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(l,d,T)===!1){T===this&&(T=void 0);var C={fn:d,ctx:T};b&&(C.once=!0),this._events=this._events||{},this._events[l]=this._events[l]||[],this._events[l].push(C)}},_off:function(l,d,T){var b,C,P;if(this._events&&(b=this._events[l],!!b)){if(arguments.length===1){if(this._firingCount)for(C=0,P=b.length;C<P;C++)b[C].fn=S;delete this._events[l];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var H=this._listens(l,d,T);if(H!==!1){var te=b[H];this._firingCount&&(te.fn=S,this._events[l]=b=b.slice()),b.splice(H,1)}}},fire:function(l,d,T){if(!this.listens(l,T))return this;var b=r({},d,{type:l,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var C=this._events[l];if(C){this._firingCount=this._firingCount+1||1;for(var P=0,H=C.length;P<H;P++){var te=C[P],ue=te.fn;te.once&&this.off(l,ue,te.ctx),ue.call(te.ctx||this,b)}this._firingCount--}}return T&&this._propagateEvent(b),this},listens:function(l,d,T,b){typeof l!="string"&&console.warn('"string" type argument expected');var C=d;typeof d!="function"&&(b=!!d,C=void 0,T=void 0);var P=this._events&&this._events[l];if(P&&P.length&&this._listens(l,C,T)!==!1)return!0;if(b){for(var H in this._eventParents)if(this._eventParents[H].listens(l,d,T,b))return!0}return!1},_listens:function(l,d,T){if(!this._events)return!1;var b=this._events[l]||[];if(!d)return!!b.length;T===this&&(T=void 0);for(var C=0,P=b.length;C<P;C++)if(b[C].fn===d&&b[C].ctx===T)return C;return!1},once:function(l,d,T){if(typeof l=="object")for(var b in l)this._on(b,l[b],d,!0);else{l=V(l);for(var C=0,P=l.length;C<P;C++)this._on(l[C],d,T,!0)}return this},addEventParent:function(l){return this._eventParents=this._eventParents||{},this._eventParents[m(l)]=l,this},removeEventParent:function(l){return this._eventParents&&delete this._eventParents[m(l)],this},_propagateEvent:function(l){for(var d in this._eventParents)this._eventParents[d].fire(l.type,r({layer:l.target,propagatedFrom:l.target},l),!0)}};ie.addEventListener=ie.on,ie.removeEventListener=ie.clearAllEventListeners=ie.off,ie.addOneTimeEventListener=ie.once,ie.fireEvent=ie.fire,ie.hasEventListeners=ie.listens;var be=qe.extend(ie);function Se(l,d,T){this.x=T?Math.round(l):l,this.y=T?Math.round(d):d}var $e=Math.trunc||function(l){return l>0?Math.floor(l):Math.ceil(l)};Se.prototype={clone:function(){return new Se(this.x,this.y)},add:function(l){return this.clone()._add(Me(l))},_add:function(l){return this.x+=l.x,this.y+=l.y,this},subtract:function(l){return this.clone()._subtract(Me(l))},_subtract:function(l){return this.x-=l.x,this.y-=l.y,this},divideBy:function(l){return this.clone()._divideBy(l)},_divideBy:function(l){return this.x/=l,this.y/=l,this},multiplyBy:function(l){return this.clone()._multiplyBy(l)},_multiplyBy:function(l){return this.x*=l,this.y*=l,this},scaleBy:function(l){return new Se(this.x*l.x,this.y*l.y)},unscaleBy:function(l){return new Se(this.x/l.x,this.y/l.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=$e(this.x),this.y=$e(this.y),this},distanceTo:function(l){l=Me(l);var d=l.x-this.x,T=l.y-this.y;return Math.sqrt(d*d+T*T)},equals:function(l){return l=Me(l),l.x===this.x&&l.y===this.y},contains:function(l){return l=Me(l),Math.abs(l.x)<=Math.abs(this.x)&&Math.abs(l.y)<=Math.abs(this.y)},toString:function(){return"Point("+A(this.x)+", "+A(this.y)+")"}};function Me(l,d,T){return l instanceof Se?l:Q(l)?new Se(l[0],l[1]):l==null?l:typeof l=="object"&&"x"in l&&"y"in l?new Se(l.x,l.y):new Se(l,d,T)}function j(l,d){if(l)for(var T=d?[l,d]:l,b=0,C=T.length;b<C;b++)this.extend(T[b])}j.prototype={extend:function(l){var d,T;if(!l)return this;if(l instanceof Se||typeof l[0]=="number"||"x"in l)d=T=Me(l);else if(l=fe(l),d=l.min,T=l.max,!d||!T)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=T.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(T.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(T.y,this.max.y)),this},getCenter:function(l){return Me((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,l)},getBottomLeft:function(){return Me(this.min.x,this.max.y)},getTopRight:function(){return Me(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(l){var d,T;return typeof l[0]=="number"||l instanceof Se?l=Me(l):l=fe(l),l instanceof j?(d=l.min,T=l.max):d=T=l,d.x>=this.min.x&&T.x<=this.max.x&&d.y>=this.min.y&&T.y<=this.max.y},intersects:function(l){l=fe(l);var d=this.min,T=this.max,b=l.min,C=l.max,P=C.x>=d.x&&b.x<=T.x,H=C.y>=d.y&&b.y<=T.y;return P&&H},overlaps:function(l){l=fe(l);var d=this.min,T=this.max,b=l.min,C=l.max,P=C.x>d.x&&b.x<T.x,H=C.y>d.y&&b.y<T.y;return P&&H},isValid:function(){return!!(this.min&&this.max)},pad:function(l){var d=this.min,T=this.max,b=Math.abs(d.x-T.x)*l,C=Math.abs(d.y-T.y)*l;return fe(Me(d.x-b,d.y-C),Me(T.x+b,T.y+C))},equals:function(l){return l?(l=fe(l),this.min.equals(l.getTopLeft())&&this.max.equals(l.getBottomRight())):!1}};function fe(l,d){return!l||l instanceof j?l:new j(l,d)}function Ie(l,d){if(l)for(var T=d?[l,d]:l,b=0,C=T.length;b<C;b++)this.extend(T[b])}Ie.prototype={extend:function(l){var d=this._southWest,T=this._northEast,b,C;if(l instanceof ge)b=l,C=l;else if(l instanceof Ie){if(b=l._southWest,C=l._northEast,!b||!C)return this}else return l?this.extend(Ae(l)||le(l)):this;return!d&&!T?(this._southWest=new ge(b.lat,b.lng),this._northEast=new ge(C.lat,C.lng)):(d.lat=Math.min(b.lat,d.lat),d.lng=Math.min(b.lng,d.lng),T.lat=Math.max(C.lat,T.lat),T.lng=Math.max(C.lng,T.lng)),this},pad:function(l){var d=this._southWest,T=this._northEast,b=Math.abs(d.lat-T.lat)*l,C=Math.abs(d.lng-T.lng)*l;return new Ie(new ge(d.lat-b,d.lng-C),new ge(T.lat+b,T.lng+C))},getCenter:function(){return new ge((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ge(this.getNorth(),this.getWest())},getSouthEast:function(){return new ge(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(l){typeof l[0]=="number"||l instanceof ge||"lat"in l?l=Ae(l):l=le(l);var d=this._southWest,T=this._northEast,b,C;return l instanceof Ie?(b=l.getSouthWest(),C=l.getNorthEast()):b=C=l,b.lat>=d.lat&&C.lat<=T.lat&&b.lng>=d.lng&&C.lng<=T.lng},intersects:function(l){l=le(l);var d=this._southWest,T=this._northEast,b=l.getSouthWest(),C=l.getNorthEast(),P=C.lat>=d.lat&&b.lat<=T.lat,H=C.lng>=d.lng&&b.lng<=T.lng;return P&&H},overlaps:function(l){l=le(l);var d=this._southWest,T=this._northEast,b=l.getSouthWest(),C=l.getNorthEast(),P=C.lat>d.lat&&b.lat<T.lat,H=C.lng>d.lng&&b.lng<T.lng;return P&&H},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(l,d){return l?(l=le(l),this._southWest.equals(l.getSouthWest(),d)&&this._northEast.equals(l.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function le(l,d){return l instanceof Ie?l:new Ie(l,d)}function ge(l,d,T){if(isNaN(l)||isNaN(d))throw new Error("Invalid LatLng object: ("+l+", "+d+")");this.lat=+l,this.lng=+d,T!==void 0&&(this.alt=+T)}ge.prototype={equals:function(l,d){if(!l)return!1;l=Ae(l);var T=Math.max(Math.abs(this.lat-l.lat),Math.abs(this.lng-l.lng));return T<=(d===void 0?1e-9:d)},toString:function(l){return"LatLng("+A(this.lat,l)+", "+A(this.lng,l)+")"},distanceTo:function(l){return Ue.distance(this,Ae(l))},wrap:function(){return Ue.wrapLatLng(this)},toBounds:function(l){var d=180*l/40075017,T=d/Math.cos(Math.PI/180*this.lat);return le([this.lat-d,this.lng-T],[this.lat+d,this.lng+T])},clone:function(){return new ge(this.lat,this.lng,this.alt)}};function Ae(l,d,T){return l instanceof ge?l:Q(l)&&typeof l[0]!="object"?l.length===3?new ge(l[0],l[1],l[2]):l.length===2?new ge(l[0],l[1]):null:l==null?l:typeof l=="object"&&"lat"in l?new ge(l.lat,"lng"in l?l.lng:l.lon,l.alt):d===void 0?null:new ge(l,d,T)}var He={latLngToPoint:function(l,d){var T=this.projection.project(l),b=this.scale(d);return this.transformation._transform(T,b)},pointToLatLng:function(l,d){var T=this.scale(d),b=this.transformation.untransform(l,T);return this.projection.unproject(b)},project:function(l){return this.projection.project(l)},unproject:function(l){return this.projection.unproject(l)},scale:function(l){return 256*Math.pow(2,l)},zoom:function(l){return Math.log(l/256)/Math.LN2},getProjectedBounds:function(l){if(this.infinite)return null;var d=this.projection.bounds,T=this.scale(l),b=this.transformation.transform(d.min,T),C=this.transformation.transform(d.max,T);return new j(b,C)},infinite:!1,wrapLatLng:function(l){var d=this.wrapLng?E(l.lng,this.wrapLng,!0):l.lng,T=this.wrapLat?E(l.lat,this.wrapLat,!0):l.lat,b=l.alt;return new ge(T,d,b)},wrapLatLngBounds:function(l){var d=l.getCenter(),T=this.wrapLatLng(d),b=d.lat-T.lat,C=d.lng-T.lng;if(b===0&&C===0)return l;var P=l.getSouthWest(),H=l.getNorthEast(),te=new ge(P.lat-b,P.lng-C),ue=new ge(H.lat-b,H.lng-C);return new Ie(te,ue)}},Ue=r({},He,{wrapLng:[-180,180],R:6371e3,distance:function(l,d){var T=Math.PI/180,b=l.lat*T,C=d.lat*T,P=Math.sin((d.lat-l.lat)*T/2),H=Math.sin((d.lng-l.lng)*T/2),te=P*P+Math.cos(b)*Math.cos(C)*H*H,ue=2*Math.atan2(Math.sqrt(te),Math.sqrt(1-te));return this.R*ue}}),we=6378137,et={R:we,MAX_LATITUDE:85.0511287798,project:function(l){var d=Math.PI/180,T=this.MAX_LATITUDE,b=Math.max(Math.min(T,l.lat),-T),C=Math.sin(b*d);return new Se(this.R*l.lng*d,this.R*Math.log((1+C)/(1-C))/2)},unproject:function(l){var d=180/Math.PI;return new ge((2*Math.atan(Math.exp(l.y/this.R))-Math.PI/2)*d,l.x*d/this.R)},bounds:(function(){var l=we*Math.PI;return new j([-l,-l],[l,l])})()};function vt(l,d,T,b){if(Q(l)){this._a=l[0],this._b=l[1],this._c=l[2],this._d=l[3];return}this._a=l,this._b=d,this._c=T,this._d=b}vt.prototype={transform:function(l,d){return this._transform(l.clone(),d)},_transform:function(l,d){return d=d||1,l.x=d*(this._a*l.x+this._b),l.y=d*(this._c*l.y+this._d),l},untransform:function(l,d){return d=d||1,new Se((l.x/d-this._b)/this._a,(l.y/d-this._d)/this._c)}};function nt(l,d,T,b){return new vt(l,d,T,b)}var qt=r({},Ue,{code:"EPSG:3857",projection:et,transformation:(function(){var l=.5/(Math.PI*et.R);return nt(l,.5,-l,.5)})()}),_n=r({},qt,{code:"EPSG:900913"});function Vt(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function yt(l,d){var T="",b,C,P,H,te,ue;for(b=0,P=l.length;b<P;b++){for(te=l[b],C=0,H=te.length;C<H;C++)ue=te[C],T+=(C?"L":"M")+ue.x+" "+ue.y;T+=d?Be.svg?"z":"x":""}return T||"M0 0"}var St=document.documentElement.style,kt="ActiveXObject"in window,Rt=kt&&!document.addEventListener,ve="msLaunchUri"in navigator&&!("documentMode"in document),Ve=Zn("webkit"),Ye=Zn("android"),pt=Zn("android 2")||Zn("android 3"),dt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),xn=Ye&&Zn("Google")&&dt<537&&!("AudioNode"in window),Si=!!window.opera,ki=!ve&&Zn("chrome"),an=Zn("gecko")&&!Ve&&!Si&&!kt,ns=!ki&&Zn("safari"),fr=Zn("phantom"),mr="OTransition"in St,Fr=navigator.platform.indexOf("Win")===0,si=kt&&"transition"in St,Ne="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!pt,lt="MozPerspective"in St,at=!window.L_DISABLE_3D&&(si||Ne||lt)&&!mr&&!fr,$t=typeof orientation<"u"||Zn("mobile"),ui=$t&&Ve,is=$t&&Ne,Cn=!window.PointerEvent&&window.MSPointerEvent,Li=!!(window.PointerEvent||Cn),ln="ontouchstart"in window||!!window.TouchEvent,bi=!window.L_NO_TOUCH&&(ln||Li),Ai=$t&&Si,qn=$t&&an,Vc=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,eu=(function(){var l=!1;try{var d=Object.defineProperty({},"passive",{get:function(){l=!0}});window.addEventListener("testPassiveEventSupport",S,d),window.removeEventListener("testPassiveEventSupport",S,d)}catch{}return l})(),bs=(function(){return!!document.createElement("canvas").getContext})(),Hs=!!(document.createElementNS&&Vt("svg").createSVGRect),Oc=!!Hs&&(function(){var l=document.createElement("div");return l.innerHTML="<svg/>",(l.firstChild&&l.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),qr=!Hs&&(function(){try{var l=document.createElement("div");l.innerHTML='<v:shape adj="1"/>';var d=l.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch{return!1}})(),Fa=navigator.platform.indexOf("Mac")===0,qa=navigator.platform.indexOf("Linux")===0;function Zn(l){return navigator.userAgent.toLowerCase().indexOf(l)>=0}var Be={ie:kt,ielt9:Rt,edge:ve,webkit:Ve,android:Ye,android23:pt,androidStock:xn,opera:Si,chrome:ki,gecko:an,safari:ns,phantom:fr,opera12:mr,win:Fr,ie3d:si,webkit3d:Ne,gecko3d:lt,any3d:at,mobile:$t,mobileWebkit:ui,mobileWebkit3d:is,msPointer:Cn,pointer:Li,touch:bi,touchNative:ln,mobileOpera:Ai,mobileGecko:qn,retina:Vc,passiveEvents:eu,canvas:bs,svg:Hs,vml:qr,inlineSvg:Oc,mac:Fa,linux:qa},Ga=Be.msPointer?"MSPointerDown":"pointerdown",Vi=Be.msPointer?"MSPointerMove":"pointermove",Oi=Be.msPointer?"MSPointerUp":"pointerup",yn=Be.msPointer?"MSPointerCancel":"pointercancel",En={touchstart:Ga,touchmove:Vi,touchend:Oi,touchcancel:yn},ss={touchstart:Is,touchmove:Jn,touchend:Jn,touchcancel:Jn},rs={},tu=!1;function nu(l,d,T){return d==="touchstart"&&Ui(),ss[d]?(T=ss[d].bind(this,T),l.addEventListener(En[d],T,!1),T):(console.warn("wrong event specified:",d),S)}function iu(l,d,T){if(!En[d]){console.warn("wrong event specified:",d);return}l.removeEventListener(En[d],T,!1)}function As(l){rs[l.pointerId]=l}function Ro(l){rs[l.pointerId]&&(rs[l.pointerId]=l)}function os(l){delete rs[l.pointerId]}function Ui(){tu||(document.addEventListener(Ga,As,!0),document.addEventListener(Vi,Ro,!0),document.addEventListener(Oi,os,!0),document.addEventListener(yn,os,!0),tu=!0)}function Jn(l,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var T in rs)d.touches.push(rs[T]);d.changedTouches=[d],l(d)}}function Is(l,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&hn(d),Jn(l,d)}function wn(l){var d={},T,b;for(b in l)T=l[b],d[b]=T&&T.bind?T.bind(l):T;return l=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var Ha=200;function ja(l,d){l.addEventListener("dblclick",d);var T=0,b;function C(P){if(P.detail!==1){b=P.detail;return}if(!(P.pointerType==="mouse"||P.sourceCapabilities&&!P.sourceCapabilities.firesTouchEvents)){var H=vr(P);if(!(H.some(function(ue){return ue instanceof HTMLLabelElement&&ue.attributes.for})&&!H.some(function(ue){return ue instanceof HTMLInputElement||ue instanceof HTMLSelectElement}))){var te=Date.now();te-T<=Ha?(b++,b===2&&d(wn(P))):b=1,T=te}}}return l.addEventListener("click",C),{dblclick:d,simDblclick:C}}function Cs(l,d){l.removeEventListener("dblclick",d.dblclick),l.removeEventListener("click",d.simDblclick)}var Bi=Hr(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),js=Hr(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Mo=js==="webkitTransition"||js==="OTransition"?js+"End":"transitionend";function Po(l){return typeof l=="string"?document.getElementById(l):l}function pr(l,d){var T=l.style[d]||l.currentStyle&&l.currentStyle[d];if((!T||T==="auto")&&document.defaultView){var b=document.defaultView.getComputedStyle(l,null);T=b?b[d]:null}return T==="auto"?null:T}function gt(l,d,T){var b=document.createElement(l);return b.className=d||"",T&&T.appendChild(b),b}function Tt(l){var d=l.parentNode;d&&d.removeChild(l)}function cn(l){for(;l.firstChild;)l.removeChild(l.firstChild)}function dn(l){var d=l.parentNode;d&&d.lastChild!==l&&d.appendChild(l)}function Ii(l){var d=l.parentNode;d&&d.firstChild!==l&&d.insertBefore(l,d.firstChild)}function Gr(l,d){if(l.classList!==void 0)return l.classList.contains(d);var T=Ns(l);return T.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(T)}function Oe(l,d){if(l.classList!==void 0)for(var T=V(d),b=0,C=T.length;b<C;b++)l.classList.add(T[b]);else if(!Gr(l,d)){var P=Ns(l);zi(l,(P?P+" ":"")+d)}}function jt(l,d){l.classList!==void 0?l.classList.remove(d):zi(l,R((" "+Ns(l)+" ").replace(" "+d+" "," ")))}function zi(l,d){l.className.baseVal===void 0?l.className=d:l.className.baseVal=d}function Ns(l){return l.correspondingElement&&(l=l.correspondingElement),l.className.baseVal===void 0?l.className:l.className.baseVal}function nn(l,d){"opacity"in l.style?l.style.opacity=d:"filter"in l.style&&Do(l,d)}function Do(l,d){var T=!1,b="DXImageTransform.Microsoft.Alpha";try{T=l.filters.item(b)}catch{if(d===1)return}d=Math.round(d*100),T?(T.Enabled=d!==100,T.Opacity=d):l.style.filter+=" progid:"+b+"(opacity="+d+")"}function Hr(l){for(var d=document.documentElement.style,T=0;T<l.length;T++)if(l[T]in d)return l[T];return!1}function as(l,d,T){var b=d||new Se(0,0);l.style[Bi]=(Be.ie3d?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(T?" scale("+T+")":"")}function Kt(l,d){l._leaflet_pos=d,Be.any3d?as(l,d):(l.style.left=d.x+"px",l.style.top=d.y+"px")}function Rs(l){return l._leaflet_pos||new Se(0,0)}var Fi,kn,ko;if("onselectstart"in document)Fi=function(){Xe(window,"selectstart",hn)},kn=function(){Lt(window,"selectstart",hn)};else{var Ks=Hr(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Fi=function(){if(Ks){var l=document.documentElement.style;ko=l[Ks],l[Ks]="none"}},kn=function(){Ks&&(document.documentElement.style[Ks]=ko,ko=void 0)}}function jr(){Xe(window,"dragstart",hn)}function gr(){Lt(window,"dragstart",hn)}var Kr,Ms;function _r(l){for(;l.tabIndex===-1;)l=l.parentNode;l.style&&(ci(),Kr=l,Ms=l.style.outlineStyle,l.style.outlineStyle="none",Xe(window,"keydown",ci))}function ci(){Kr&&(Kr.style.outlineStyle=Ms,Kr=void 0,Ms=void 0,Lt(window,"keydown",ci))}function Lo(l){do l=l.parentNode;while((!l.offsetWidth||!l.offsetHeight)&&l!==document.body);return l}function di(l){var d=l.getBoundingClientRect();return{x:d.width/l.offsetWidth||1,y:d.height/l.offsetHeight||1,boundingClientRect:d}}var yr={__proto__:null,TRANSFORM:Bi,TRANSITION:js,TRANSITION_END:Mo,get:Po,getStyle:pr,create:gt,remove:Tt,empty:cn,toFront:dn,toBack:Ii,hasClass:Gr,addClass:Oe,removeClass:jt,setClass:zi,getClass:Ns,setOpacity:nn,testProp:Hr,setTransform:as,setPosition:Kt,getPosition:Rs,get disableTextSelection(){return Fi},get enableTextSelection(){return kn},disableImageDrag:jr,enableImageDrag:gr,preventOutline:_r,restoreOutline:ci,getSizedParentNode:Lo,getScale:di};function Xe(l,d,T,b){if(d&&typeof d=="object")for(var C in d)hi(l,C,d[C],T);else{d=V(d);for(var P=0,H=d.length;P<H;P++)hi(l,d[P],T,b)}return this}var Yn="_leaflet_events";function Lt(l,d,T,b){if(arguments.length===1)Zs(l),delete l[Yn];else if(d&&typeof d=="object")for(var C in d)Js(l,C,d[C],T);else if(d=V(d),arguments.length===2)Zs(l,function(te){return pe(d,te)!==-1});else for(var P=0,H=d.length;P<H;P++)Js(l,d[P],T,b);return this}function Zs(l,d){for(var T in l[Yn]){var b=T.split(/\d/)[0];(!d||d(b))&&Js(l,b,null,null,T)}}var Ci={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function hi(l,d,T,b){var C=d+m(T)+(b?"_"+m(b):"");if(l[Yn]&&l[Yn][C])return this;var P=function(te){return T.call(b||l,te||window.event)},H=P;!Be.touchNative&&Be.pointer&&d.indexOf("touch")===0?P=nu(l,d,P):Be.touch&&d==="dblclick"?P=ja(l,P):"addEventListener"in l?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?l.addEventListener(Ci[d]||d,P,Be.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(P=function(te){te=te||window.event,cs(l,te)&&H(te)},l.addEventListener(Ci[d],P,!1)):l.addEventListener(d,H,!1):l.attachEvent("on"+d,P),l[Yn]=l[Yn]||{},l[Yn][C]=P}function Js(l,d,T,b,C){C=C||d+m(T)+(b?"_"+m(b):"");var P=l[Yn]&&l[Yn][C];if(!P)return this;!Be.touchNative&&Be.pointer&&d.indexOf("touch")===0?iu(l,d,P):Be.touch&&d==="dblclick"?Cs(l,P):"removeEventListener"in l?l.removeEventListener(Ci[d]||d,P,!1):l.detachEvent("on"+d,P),l[Yn][C]=null}function bt(l){return l.stopPropagation?l.stopPropagation():l.originalEvent?l.originalEvent._stopped=!0:l.cancelBubble=!0,this}function qi(l){return hi(l,"wheel",bt),this}function Ys(l){return Xe(l,"mousedown touchstart dblclick contextmenu",bt),l._leaflet_disable_click=!0,this}function hn(l){return l.preventDefault?l.preventDefault():l.returnValue=!1,this}function ls(l){return hn(l),bt(l),this}function vr(l){if(l.composedPath)return l.composedPath();for(var d=[],T=l.target;T;)d.push(T),T=T.parentNode;return d}function Ps(l,d){if(!d)return new Se(l.clientX,l.clientY);var T=di(d),b=T.boundingClientRect;return new Se((l.clientX-b.left)/T.x-d.clientLeft,(l.clientY-b.top)/T.y-d.clientTop)}var us=Be.linux&&Be.chrome?window.devicePixelRatio:Be.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ln(l){return Be.edge?l.wheelDeltaY/2:l.deltaY&&l.deltaMode===0?-l.deltaY/us:l.deltaY&&l.deltaMode===1?-l.deltaY*20:l.deltaY&&l.deltaMode===2?-l.deltaY*60:l.deltaX||l.deltaZ?0:l.wheelDelta?(l.wheelDeltaY||l.wheelDelta)/2:l.detail&&Math.abs(l.detail)<32765?-l.detail*20:l.detail?l.detail/-32765*60:0}function cs(l,d){var T=d.relatedTarget;if(!T)return!0;try{for(;T&&T!==l;)T=T.parentNode}catch{return!1}return T!==l}var Ds={__proto__:null,on:Xe,off:Lt,stopPropagation:bt,disableScrollPropagation:qi,disableClickPropagation:Ys,preventDefault:hn,stop:ls,getPropagationPath:vr,getMousePosition:Ps,getWheelDelta:Ln,isExternalTarget:cs,addListener:Xe,removeListener:Lt},Ws=be.extend({run:function(l,d,T,b){this.stop(),this._el=l,this._inProgress=!0,this._duration=T||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=Rs(l),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=q(this._animate,this),this._step()},_step:function(l){var d=+new Date-this._startTime,T=this._duration*1e3;d<T?this._runFrame(this._easeOut(d/T),l):(this._runFrame(1),this._complete())},_runFrame:function(l,d){var T=this._startPos.add(this._offset.multiplyBy(l));d&&T._round(),Kt(this._el,T),this.fire("step")},_complete:function(){K(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(l){return 1-Math.pow(1-l,this._easeOutPower)}}),mt=be.extend({options:{crs:qt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(l,d){d=z(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(l),this._initLayout(),this._onResize=u(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(Ae(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=js&&Be.any3d&&!Be.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Xe(this._proxy,Mo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(l,d,T){if(d=d===void 0?this._zoom:this._limitZoom(d),l=this._limitCenter(Ae(l),d,this.options.maxBounds),T=T||{},this._stop(),this._loaded&&!T.reset&&T!==!0){T.animate!==void 0&&(T.zoom=r({animate:T.animate},T.zoom),T.pan=r({animate:T.animate,duration:T.duration},T.pan));var b=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(l,d,T.zoom):this._tryAnimatedPan(l,T.pan);if(b)return clearTimeout(this._sizeTimer),this}return this._resetView(l,d,T.pan&&T.pan.noMoveStart),this},setZoom:function(l,d){return this._loaded?this.setView(this.getCenter(),l,{zoom:d}):(this._zoom=l,this)},zoomIn:function(l,d){return l=l||(Be.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+l,d)},zoomOut:function(l,d){return l=l||(Be.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-l,d)},setZoomAround:function(l,d,T){var b=this.getZoomScale(d),C=this.getSize().divideBy(2),P=l instanceof Se?l:this.latLngToContainerPoint(l),H=P.subtract(C).multiplyBy(1-1/b),te=this.containerPointToLatLng(C.add(H));return this.setView(te,d,{zoom:T})},_getBoundsCenterZoom:function(l,d){d=d||{},l=l.getBounds?l.getBounds():le(l);var T=Me(d.paddingTopLeft||d.padding||[0,0]),b=Me(d.paddingBottomRight||d.padding||[0,0]),C=this.getBoundsZoom(l,!1,T.add(b));if(C=typeof d.maxZoom=="number"?Math.min(d.maxZoom,C):C,C===1/0)return{center:l.getCenter(),zoom:C};var P=b.subtract(T).divideBy(2),H=this.project(l.getSouthWest(),C),te=this.project(l.getNorthEast(),C),ue=this.unproject(H.add(te).divideBy(2).add(P),C);return{center:ue,zoom:C}},fitBounds:function(l,d){if(l=le(l),!l.isValid())throw new Error("Bounds are not valid.");var T=this._getBoundsCenterZoom(l,d);return this.setView(T.center,T.zoom,d)},fitWorld:function(l){return this.fitBounds([[-90,-180],[90,180]],l)},panTo:function(l,d){return this.setView(l,this._zoom,{pan:d})},panBy:function(l,d){if(l=Me(l).round(),d=d||{},!l.x&&!l.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(l))return this._resetView(this.unproject(this.project(this.getCenter()).add(l)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ws,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){Oe(this._mapPane,"leaflet-pan-anim");var T=this._getMapPanePos().subtract(l).round();this._panAnim.run(this._mapPane,T,d.duration||.25,d.easeLinearity)}else this._rawPanBy(l),this.fire("move").fire("moveend");return this},flyTo:function(l,d,T){if(T=T||{},T.animate===!1||!Be.any3d)return this.setView(l,d,T);this._stop();var b=this.project(this.getCenter()),C=this.project(l),P=this.getSize(),H=this._zoom;l=Ae(l),d=d===void 0?H:d;var te=Math.max(P.x,P.y),ue=te*this.getZoomScale(H,d),xe=C.distanceTo(b)||1,De=1.42,Ke=De*De;function ht(vn){var tr=vn?-1:1,Xr=vn?ue:te,Gc=ue*ue-te*te+tr*Ke*Ke*xe*xe,dl=2*Xr*Ke*xe,hl=Gc/dl,Nr=Math.sqrt(hl*hl+1)-hl,nr=Nr<1e-9?-18:Math.log(Nr);return nr}function Gn(vn){return(Math.exp(vn)-Math.exp(-vn))/2}function Sn(vn){return(Math.exp(vn)+Math.exp(-vn))/2}function Mi(vn){return Gn(vn)/Sn(vn)}var Ot=ht(0);function Ut(vn){return te*(Sn(Ot)/Sn(Ot+De*vn))}function xt(vn){return te*(Sn(Ot)*Mi(Ot+De*vn)-Gn(Ot))/Ke}function Ir(vn){return 1-Math.pow(1-vn,1.5)}var Zi=Date.now(),gu=(ht(1)-Ot)/De,Cr=T.duration?1e3*T.duration:1e3*gu*.8;function qc(){var vn=(Date.now()-Zi)/Cr,tr=Ir(vn)*gu;vn<=1?(this._flyToFrame=q(qc,this),this._move(this.unproject(b.add(C.subtract(b).multiplyBy(xt(tr)/xe)),H),this.getScaleZoom(te/Ut(tr),H),{flyTo:!0})):this._move(l,d)._moveEnd(!0)}return this._moveStart(!0,T.noMoveStart),qc.call(this),this},flyToBounds:function(l,d){var T=this._getBoundsCenterZoom(l,d);return this.flyTo(T.center,T.zoom,d)},setMaxBounds:function(l){return l=le(l),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),l.isValid()?(this.options.maxBounds=l,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(l){var d=this.options.minZoom;return this.options.minZoom=l,this._loaded&&d!==l&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(l):this},setMaxZoom:function(l){var d=this.options.maxZoom;return this.options.maxZoom=l,this._loaded&&d!==l&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(l):this},panInsideBounds:function(l,d){this._enforcingBounds=!0;var T=this.getCenter(),b=this._limitCenter(T,this._zoom,le(l));return T.equals(b)||this.panTo(b,d),this._enforcingBounds=!1,this},panInside:function(l,d){d=d||{};var T=Me(d.paddingTopLeft||d.padding||[0,0]),b=Me(d.paddingBottomRight||d.padding||[0,0]),C=this.project(this.getCenter()),P=this.project(l),H=this.getPixelBounds(),te=fe([H.min.add(T),H.max.subtract(b)]),ue=te.getSize();if(!te.contains(P)){this._enforcingBounds=!0;var xe=P.subtract(te.getCenter()),De=te.extend(P).getSize().subtract(ue);C.x+=xe.x<0?-De.x:De.x,C.y+=xe.y<0?-De.y:De.y,this.panTo(this.unproject(C),d),this._enforcingBounds=!1}return this},invalidateSize:function(l){if(!this._loaded)return this;l=r({animate:!1,pan:!0},l===!0?{animate:!0}:l);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var T=this.getSize(),b=d.divideBy(2).round(),C=T.divideBy(2).round(),P=b.subtract(C);return!P.x&&!P.y?this:(l.animate&&l.pan?this.panBy(P):(l.pan&&this._rawPanBy(P),this.fire("move"),l.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(u(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:T}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(l){if(l=this._locateOptions=r({timeout:1e4,watch:!1},l),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=u(this._handleGeolocationResponse,this),T=u(this._handleGeolocationError,this);return l.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,T,l):navigator.geolocation.getCurrentPosition(d,T,l),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(l){if(this._container._leaflet_id){var d=l.code,T=l.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+T+"."})}},_handleGeolocationResponse:function(l){if(this._container._leaflet_id){var d=l.coords.latitude,T=l.coords.longitude,b=new ge(d,T),C=b.toBounds(l.coords.accuracy*2),P=this._locateOptions;if(P.setView){var H=this.getBoundsZoom(C);this.setView(b,P.maxZoom?Math.min(H,P.maxZoom):H)}var te={latlng:b,bounds:C,timestamp:l.timestamp};for(var ue in l.coords)typeof l.coords[ue]=="number"&&(te[ue]=l.coords[ue]);this.fire("locationfound",te)}},addHandler:function(l,d){if(!d)return this;var T=this[l]=new d(this);return this._handlers.push(T),this.options[l]&&T.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Tt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(K(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var l;for(l in this._layers)this._layers[l].remove();for(l in this._panes)Tt(this._panes[l]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(l,d){var T="leaflet-pane"+(l?" leaflet-"+l.replace("Pane","")+"-pane":""),b=gt("div",T,d||this._mapPane);return l&&(this._panes[l]=b),b},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var l=this.getPixelBounds(),d=this.unproject(l.getBottomLeft()),T=this.unproject(l.getTopRight());return new Ie(d,T)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(l,d,T){l=le(l),T=Me(T||[0,0]);var b=this.getZoom()||0,C=this.getMinZoom(),P=this.getMaxZoom(),H=l.getNorthWest(),te=l.getSouthEast(),ue=this.getSize().subtract(T),xe=fe(this.project(te,b),this.project(H,b)).getSize(),De=Be.any3d?this.options.zoomSnap:1,Ke=ue.x/xe.x,ht=ue.y/xe.y,Gn=d?Math.max(Ke,ht):Math.min(Ke,ht);return b=this.getScaleZoom(Gn,b),De&&(b=Math.round(b/(De/100))*(De/100),b=d?Math.ceil(b/De)*De:Math.floor(b/De)*De),Math.max(C,Math.min(P,b))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Se(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(l,d){var T=this._getTopLeftPoint(l,d);return new j(T,T.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(l){return this.options.crs.getProjectedBounds(l===void 0?this.getZoom():l)},getPane:function(l){return typeof l=="string"?this._panes[l]:l},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(l,d){var T=this.options.crs;return d=d===void 0?this._zoom:d,T.scale(l)/T.scale(d)},getScaleZoom:function(l,d){var T=this.options.crs;d=d===void 0?this._zoom:d;var b=T.zoom(l*T.scale(d));return isNaN(b)?1/0:b},project:function(l,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(Ae(l),d)},unproject:function(l,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(Me(l),d)},layerPointToLatLng:function(l){var d=Me(l).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(l){var d=this.project(Ae(l))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(l){return this.options.crs.wrapLatLng(Ae(l))},wrapLatLngBounds:function(l){return this.options.crs.wrapLatLngBounds(le(l))},distance:function(l,d){return this.options.crs.distance(Ae(l),Ae(d))},containerPointToLayerPoint:function(l){return Me(l).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(l){return Me(l).add(this._getMapPanePos())},containerPointToLatLng:function(l){var d=this.containerPointToLayerPoint(Me(l));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(l){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ae(l)))},mouseEventToContainerPoint:function(l){return Ps(l,this._container)},mouseEventToLayerPoint:function(l){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(l))},mouseEventToLatLng:function(l){return this.layerPointToLatLng(this.mouseEventToLayerPoint(l))},_initContainer:function(l){var d=this._container=Po(l);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Xe(d,"scroll",this._onScroll,this),this._containerId=m(d)},_initLayout:function(){var l=this._container;this._fadeAnimated=this.options.fadeAnimation&&Be.any3d,Oe(l,"leaflet-container"+(Be.touch?" leaflet-touch":"")+(Be.retina?" leaflet-retina":"")+(Be.ielt9?" leaflet-oldie":"")+(Be.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=pr(l,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(l.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var l=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Kt(this._mapPane,new Se(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Oe(l.markerPane,"leaflet-zoom-hide"),Oe(l.shadowPane,"leaflet-zoom-hide"))},_resetView:function(l,d,T){Kt(this._mapPane,new Se(0,0));var b=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var C=this._zoom!==d;this._moveStart(C,T)._move(l,d)._moveEnd(C),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(l,d){return l&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(l,d,T,b){d===void 0&&(d=this._zoom);var C=this._zoom!==d;return this._zoom=d,this._lastCenter=l,this._pixelOrigin=this._getNewPixelOrigin(l),b?T&&T.pinch&&this.fire("zoom",T):((C||T&&T.pinch)&&this.fire("zoom",T),this.fire("move",T)),this},_moveEnd:function(l){return l&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return K(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(l){Kt(this._mapPane,this._getMapPanePos().subtract(l))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(l){this._targets={},this._targets[m(this._container)]=this;var d=l?Lt:Xe;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),Be.any3d&&this.options.transform3DLimit&&(l?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){K(this._resizeRequest),this._resizeRequest=q(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var l=this._getMapPanePos();Math.max(Math.abs(l.x),Math.abs(l.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(l,d){for(var T=[],b,C=d==="mouseout"||d==="mouseover",P=l.target||l.srcElement,H=!1;P;){if(b=this._targets[m(P)],b&&(d==="click"||d==="preclick")&&this._draggableMoved(b)){H=!0;break}if(b&&b.listens(d,!0)&&(C&&!cs(P,l)||(T.push(b),C))||P===this._container)break;P=P.parentNode}return!T.length&&!H&&!C&&this.listens(d,!0)&&(T=[this]),T},_isClickDisabled:function(l){for(;l&&l!==this._container;){if(l._leaflet_disable_click)return!0;l=l.parentNode}},_handleDOMEvent:function(l){var d=l.target||l.srcElement;if(!(!this._loaded||d._leaflet_disable_events||l.type==="click"&&this._isClickDisabled(d))){var T=l.type;T==="mousedown"&&_r(d),this._fireDOMEvent(l,T)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(l,d,T){if(l.type==="click"){var b=r({},l);b.type="preclick",this._fireDOMEvent(b,b.type,T)}var C=this._findEventTargets(l,d);if(T){for(var P=[],H=0;H<T.length;H++)T[H].listens(d,!0)&&P.push(T[H]);C=P.concat(C)}if(C.length){d==="contextmenu"&&hn(l);var te=C[0],ue={originalEvent:l};if(l.type!=="keypress"&&l.type!=="keydown"&&l.type!=="keyup"){var xe=te.getLatLng&&(!te._radius||te._radius<=10);ue.containerPoint=xe?this.latLngToContainerPoint(te.getLatLng()):this.mouseEventToContainerPoint(l),ue.layerPoint=this.containerPointToLayerPoint(ue.containerPoint),ue.latlng=xe?te.getLatLng():this.layerPointToLatLng(ue.layerPoint)}for(H=0;H<C.length;H++)if(C[H].fire(d,ue,!0),ue.originalEvent._stopped||C[H].options.bubblingMouseEvents===!1&&pe(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(l){return l=l.dragging&&l.dragging.enabled()?l:this,l.dragging&&l.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var l=0,d=this._handlers.length;l<d;l++)this._handlers[l].disable()},whenReady:function(l,d){return this._loaded?l.call(d||this,{target:this}):this.on("load",l,d),this},_getMapPanePos:function(){return Rs(this._mapPane)||new Se(0,0)},_moved:function(){var l=this._getMapPanePos();return l&&!l.equals([0,0])},_getTopLeftPoint:function(l,d){var T=l&&d!==void 0?this._getNewPixelOrigin(l,d):this.getPixelOrigin();return T.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(l,d){var T=this.getSize()._divideBy(2);return this.project(l,d)._subtract(T)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(l,d,T){var b=this._getNewPixelOrigin(T,d);return this.project(l,d)._subtract(b)},_latLngBoundsToNewLayerBounds:function(l,d,T){var b=this._getNewPixelOrigin(T,d);return fe([this.project(l.getSouthWest(),d)._subtract(b),this.project(l.getNorthWest(),d)._subtract(b),this.project(l.getSouthEast(),d)._subtract(b),this.project(l.getNorthEast(),d)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(l){return this.latLngToLayerPoint(l).subtract(this._getCenterLayerPoint())},_limitCenter:function(l,d,T){if(!T)return l;var b=this.project(l,d),C=this.getSize().divideBy(2),P=new j(b.subtract(C),b.add(C)),H=this._getBoundsOffset(P,T,d);return Math.abs(H.x)<=1&&Math.abs(H.y)<=1?l:this.unproject(b.add(H),d)},_limitOffset:function(l,d){if(!d)return l;var T=this.getPixelBounds(),b=new j(T.min.add(l),T.max.add(l));return l.add(this._getBoundsOffset(b,d))},_getBoundsOffset:function(l,d,T){var b=fe(this.project(d.getNorthEast(),T),this.project(d.getSouthWest(),T)),C=b.min.subtract(l.min),P=b.max.subtract(l.max),H=this._rebound(C.x,-P.x),te=this._rebound(C.y,-P.y);return new Se(H,te)},_rebound:function(l,d){return l+d>0?Math.round(l-d)/2:Math.max(0,Math.ceil(l))-Math.max(0,Math.floor(d))},_limitZoom:function(l){var d=this.getMinZoom(),T=this.getMaxZoom(),b=Be.any3d?this.options.zoomSnap:1;return b&&(l=Math.round(l/b)*b),Math.max(d,Math.min(T,l))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){jt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(l,d){var T=this._getCenterOffset(l)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(T)?!1:(this.panBy(T,d),!0)},_createAnimProxy:function(){var l=this._proxy=gt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(l),this.on("zoomanim",function(d){var T=Bi,b=this._proxy.style[T];as(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),b===this._proxy.style[T]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Tt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var l=this.getCenter(),d=this.getZoom();as(this._proxy,this.project(l,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(l){this._animatingZoom&&l.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(l,d,T){if(this._animatingZoom)return!0;if(T=T||{},!this._zoomAnimated||T.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(d),C=this._getCenterOffset(l)._divideBy(1-1/b);return T.animate!==!0&&!this.getSize().contains(C)?!1:(q(function(){this._moveStart(!0,T.noMoveStart||!1)._animateZoom(l,d,!0)},this),!0)},_animateZoom:function(l,d,T,b){this._mapPane&&(T&&(this._animatingZoom=!0,this._animateToCenter=l,this._animateToZoom=d,Oe(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:l,zoom:d,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(u(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&jt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Tr(l,d){return new mt(l,d)}var Wn=qe.extend({options:{position:"topright"},initialize:function(l){z(this,l)},getPosition:function(){return this.options.position},setPosition:function(l){var d=this._map;return d&&d.removeControl(this),this.options.position=l,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(l){this.remove(),this._map=l;var d=this._container=this.onAdd(l),T=this.getPosition(),b=l._controlCorners[T];return Oe(d,"leaflet-control"),T.indexOf("bottom")!==-1?b.insertBefore(d,b.firstChild):b.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Tt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(l){this._map&&l&&l.screenX>0&&l.screenY>0&&this._map.getContainer().focus()}}),fi=function(l){return new Wn(l)};mt.include({addControl:function(l){return l.addTo(this),this},removeControl:function(l){return l.remove(),this},_initControlPos:function(){var l=this._controlCorners={},d="leaflet-",T=this._controlContainer=gt("div",d+"control-container",this._container);function b(C,P){var H=d+C+" "+d+P;l[C+P]=gt("div",H,T)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var l in this._controlCorners)Tt(this._controlCorners[l]);Tt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Zr=Wn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(l,d,T,b){return T<b?-1:b<T?1:0}},initialize:function(l,d,T){z(this,T),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var b in l)this._addLayer(l[b],b);for(b in d)this._addLayer(d[b],b,!0)},onAdd:function(l){this._initLayout(),this._update(),this._map=l,l.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(l){return Wn.prototype.addTo.call(this,l),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(l,d){return this._addLayer(l,d),this._map?this._update():this},addOverlay:function(l,d){return this._addLayer(l,d,!0),this._map?this._update():this},removeLayer:function(l){l.off("add remove",this._onLayerChange,this);var d=this._getLayer(m(l));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){Oe(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var l=this._map.getSize().y-(this._container.offsetTop+50);return l<this._section.clientHeight?(Oe(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=l+"px"):jt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return jt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var l="leaflet-control-layers",d=this._container=gt("div",l),T=this.options.collapsed;d.setAttribute("aria-haspopup",!0),Ys(d),qi(d);var b=this._section=gt("section",l+"-list");T&&(this._map.on("click",this.collapse,this),Xe(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var C=this._layersLink=gt("a",l+"-toggle",d);C.href="#",C.title="Layers",C.setAttribute("role","button"),Xe(C,{keydown:function(P){P.keyCode===13&&this._expandSafely()},click:function(P){hn(P),this._expandSafely()}},this),T||this.expand(),this._baseLayersList=gt("div",l+"-base",b),this._separator=gt("div",l+"-separator",b),this._overlaysList=gt("div",l+"-overlays",b),d.appendChild(b)},_getLayer:function(l){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&m(this._layers[d].layer)===l)return this._layers[d]},_addLayer:function(l,d,T){this._map&&l.on("add remove",this._onLayerChange,this),this._layers.push({layer:l,name:d,overlay:T}),this.options.sortLayers&&this._layers.sort(u(function(b,C){return this.options.sortFunction(b.layer,C.layer,b.name,C.name)},this)),this.options.autoZIndex&&l.setZIndex&&(this._lastZIndex++,l.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;cn(this._baseLayersList),cn(this._overlaysList),this._layerControlInputs=[];var l,d,T,b,C=0;for(T=0;T<this._layers.length;T++)b=this._layers[T],this._addItem(b),d=d||b.overlay,l=l||!b.overlay,C+=b.overlay?0:1;return this.options.hideSingleBase&&(l=l&&C>1,this._baseLayersList.style.display=l?"":"none"),this._separator.style.display=d&&l?"":"none",this},_onLayerChange:function(l){this._handlingClick||this._update();var d=this._getLayer(m(l.target)),T=d.overlay?l.type==="add"?"overlayadd":"overlayremove":l.type==="add"?"baselayerchange":null;T&&this._map.fire(T,d)},_createRadioElement:function(l,d){var T='<input type="radio" class="leaflet-control-layers-selector" name="'+l+'"'+(d?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=T,b.firstChild},_addItem:function(l){var d=document.createElement("label"),T=this._map.hasLayer(l.layer),b;l.overlay?(b=document.createElement("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=T):b=this._createRadioElement("leaflet-base-layers_"+m(this),T),this._layerControlInputs.push(b),b.layerId=m(l.layer),Xe(b,"click",this._onInputClick,this);var C=document.createElement("span");C.innerHTML=" "+l.name;var P=document.createElement("span");d.appendChild(P),P.appendChild(b),P.appendChild(C);var H=l.overlay?this._overlaysList:this._baseLayersList;return H.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var l=this._layerControlInputs,d,T,b=[],C=[];this._handlingClick=!0;for(var P=l.length-1;P>=0;P--)d=l[P],T=this._getLayer(d.layerId).layer,d.checked?b.push(T):d.checked||C.push(T);for(P=0;P<C.length;P++)this._map.hasLayer(C[P])&&this._map.removeLayer(C[P]);for(P=0;P<b.length;P++)this._map.hasLayer(b[P])||this._map.addLayer(b[P]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var l=this._layerControlInputs,d,T,b=this._map.getZoom(),C=l.length-1;C>=0;C--)d=l[C],T=this._getLayer(d.layerId).layer,d.disabled=T.options.minZoom!==void 0&&b<T.options.minZoom||T.options.maxZoom!==void 0&&b>T.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var l=this._section;this._preventClick=!0,Xe(l,"click",hn),this.expand();var d=this;setTimeout(function(){Lt(l,"click",hn),d._preventClick=!1})}}),Ka=function(l,d,T){return new Zr(l,d,T)},Qs=Wn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(l){var d="leaflet-control-zoom",T=gt("div",d+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,d+"-in",T,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,d+"-out",T,this._zoomOut),this._updateDisabled(),l.on("zoomend zoomlevelschange",this._updateDisabled,this),T},onRemove:function(l){l.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(l){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(l.shiftKey?3:1))},_zoomOut:function(l){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(l.shiftKey?3:1))},_createButton:function(l,d,T,b,C){var P=gt("a",T,b);return P.innerHTML=l,P.href="#",P.title=d,P.setAttribute("role","button"),P.setAttribute("aria-label",d),Ys(P),Xe(P,"click",ls),Xe(P,"click",C,this),Xe(P,"click",this._refocusOnMap,this),P},_updateDisabled:function(){var l=this._map,d="leaflet-disabled";jt(this._zoomInButton,d),jt(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||l._zoom===l.getMinZoom())&&(Oe(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||l._zoom===l.getMaxZoom())&&(Oe(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});mt.mergeOptions({zoomControl:!0}),mt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Qs,this.addControl(this.zoomControl))});var su=function(l){return new Qs(l)},Za=Wn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(l){var d="leaflet-control-scale",T=gt("div",d),b=this.options;return this._addScales(b,d+"-line",T),l.on(b.updateWhenIdle?"moveend":"move",this._update,this),l.whenReady(this._update,this),T},onRemove:function(l){l.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(l,d,T){l.metric&&(this._mScale=gt("div",d,T)),l.imperial&&(this._iScale=gt("div",d,T))},_update:function(){var l=this._map,d=l.getSize().y/2,T=l.distance(l.containerPointToLatLng([0,d]),l.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(T)},_updateScales:function(l){this.options.metric&&l&&this._updateMetric(l),this.options.imperial&&l&&this._updateImperial(l)},_updateMetric:function(l){var d=this._getRoundNum(l),T=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,T,d/l)},_updateImperial:function(l){var d=l*3.2808399,T,b,C;d>5280?(T=d/5280,b=this._getRoundNum(T),this._updateScale(this._iScale,b+" mi",b/T)):(C=this._getRoundNum(d),this._updateScale(this._iScale,C+" ft",C/d))},_updateScale:function(l,d,T){l.style.width=Math.round(this.options.maxWidth*T)+"px",l.innerHTML=d},_getRoundNum:function(l){var d=Math.pow(10,(Math.floor(l)+"").length-1),T=l/d;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:1,d*T}}),Jr=function(l){return new Za(l)},Ja='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Vo=Wn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Be.inlineSvg?Ja+" ":"")+"Leaflet</a>"},initialize:function(l){z(this,l),this._attributions={}},onAdd:function(l){l.attributionControl=this,this._container=gt("div","leaflet-control-attribution"),Ys(this._container);for(var d in l._layers)l._layers[d].getAttribution&&this.addAttribution(l._layers[d].getAttribution());return this._update(),l.on("layeradd",this._addAttribution,this),this._container},onRemove:function(l){l.off("layeradd",this._addAttribution,this)},_addAttribution:function(l){l.layer.getAttribution&&(this.addAttribution(l.layer.getAttribution()),l.layer.once("remove",function(){this.removeAttribution(l.layer.getAttribution())},this))},setPrefix:function(l){return this.options.prefix=l,this._update(),this},addAttribution:function(l){return l?(this._attributions[l]||(this._attributions[l]=0),this._attributions[l]++,this._update(),this):this},removeAttribution:function(l){return l?(this._attributions[l]&&(this._attributions[l]--,this._update()),this):this},_update:function(){if(this._map){var l=[];for(var d in this._attributions)this._attributions[d]&&l.push(d);var T=[];this.options.prefix&&T.push(this.options.prefix),l.length&&T.push(l.join(", ")),this._container.innerHTML=T.join(' <span aria-hidden="true">|</span> ')}}});mt.mergeOptions({attributionControl:!0}),mt.addInitHook(function(){this.options.attributionControl&&new Vo().addTo(this)});var Oo=function(l){return new Vo(l)};Wn.Layers=Zr,Wn.Zoom=Qs,Wn.Scale=Za,Wn.Attribution=Vo,fi.layers=Ka,fi.zoom=su,fi.scale=Jr,fi.attribution=Oo;var Ni=qe.extend({initialize:function(l){this._map=l},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ni.addTo=function(l,d){return l.addHandler(d,this),this};var ru={Events:ie},ds=Be.touch?"touchstart mousedown":"mousedown",hs=be.extend({options:{clickTolerance:3},initialize:function(l,d,T,b){z(this,b),this._element=l,this._dragStartTarget=d||l,this._preventOutline=T},enable:function(){this._enabled||(Xe(this._dragStartTarget,ds,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(hs._dragging===this&&this.finishDrag(!0),Lt(this._dragStartTarget,ds,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(l){if(this._enabled&&(this._moved=!1,!Gr(this._element,"leaflet-zoom-anim"))){if(l.touches&&l.touches.length!==1){hs._dragging===this&&this.finishDrag();return}if(!(hs._dragging||l.shiftKey||l.which!==1&&l.button!==1&&!l.touches)&&(hs._dragging=this,this._preventOutline&&_r(this._element),jr(),Fi(),!this._moving)){this.fire("down");var d=l.touches?l.touches[0]:l,T=Lo(this._element);this._startPoint=new Se(d.clientX,d.clientY),this._startPos=Rs(this._element),this._parentScale=di(T);var b=l.type==="mousedown";Xe(document,b?"mousemove":"touchmove",this._onMove,this),Xe(document,b?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(l){if(this._enabled){if(l.touches&&l.touches.length>1){this._moved=!0;return}var d=l.touches&&l.touches.length===1?l.touches[0]:l,T=new Se(d.clientX,d.clientY)._subtract(this._startPoint);!T.x&&!T.y||Math.abs(T.x)+Math.abs(T.y)<this.options.clickTolerance||(T.x/=this._parentScale.x,T.y/=this._parentScale.y,hn(l),this._moved||(this.fire("dragstart"),this._moved=!0,Oe(document.body,"leaflet-dragging"),this._lastTarget=l.target||l.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Oe(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(T),this._moving=!0,this._lastEvent=l,this._updatePosition())}},_updatePosition:function(){var l={originalEvent:this._lastEvent};this.fire("predrag",l),Kt(this._element,this._newPos),this.fire("drag",l)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(l){jt(document.body,"leaflet-dragging"),this._lastTarget&&(jt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Lt(document,"mousemove touchmove",this._onMove,this),Lt(document,"mouseup touchend touchcancel",this._onUp,this),gr(),kn();var d=this._moved&&this._moving;this._moving=!1,hs._dragging=!1,d&&this.fire("dragend",{noInertia:l,distance:this._newPos.distanceTo(this._startPos)})}});function Ya(l,d,T){var b,C=[1,4,2,8],P,H,te,ue,xe,De,Ke,ht;for(P=0,De=l.length;P<De;P++)l[P]._code=de(l[P],d);for(te=0;te<4;te++){for(Ke=C[te],b=[],P=0,De=l.length,H=De-1;P<De;H=P++)ue=l[P],xe=l[H],ue._code&Ke?xe._code&Ke||(ht=se(xe,ue,Ke,d,T),ht._code=de(ht,d),b.push(ht)):(xe._code&Ke&&(ht=se(xe,ue,Ke,d,T),ht._code=de(ht,d),b.push(ht)),b.push(ue));l=b}return l}function Wa(l,d){var T,b,C,P,H,te,ue,xe,De;if(!l||l.length===0)throw new Error("latlngs not passed");Mt(l)||(console.warn("latlngs are not flat! Only the first ring will be used"),l=l[0]);var Ke=Ae([0,0]),ht=le(l),Gn=ht.getNorthWest().distanceTo(ht.getSouthWest())*ht.getNorthEast().distanceTo(ht.getNorthWest());Gn<1700&&(Ke=Uo(l));var Sn=l.length,Mi=[];for(T=0;T<Sn;T++){var Ot=Ae(l[T]);Mi.push(d.project(Ae([Ot.lat-Ke.lat,Ot.lng-Ke.lng])))}for(te=ue=xe=0,T=0,b=Sn-1;T<Sn;b=T++)C=Mi[T],P=Mi[b],H=C.y*P.x-P.y*C.x,ue+=(C.x+P.x)*H,xe+=(C.y+P.y)*H,te+=H*3;te===0?De=Mi[0]:De=[ue/te,xe/te];var Ut=d.unproject(Me(De));return Ae([Ut.lat+Ke.lat,Ut.lng+Ke.lng])}function Uo(l){for(var d=0,T=0,b=0,C=0;C<l.length;C++){var P=Ae(l[C]);d+=P.lat,T+=P.lng,b++}return Ae([d/b,T/b])}var xr={__proto__:null,clipPolygon:Ya,polygonCenter:Wa,centroid:Uo};function Qn(l,d){if(!d||!l.length)return l.slice();var T=d*d;return l=I(l,T),l=$s(l,T),l}function Qa(l,d,T){return Math.sqrt(it(l,d,T,!0))}function ou(l,d,T){return it(l,d,T)}function $s(l,d){var T=l.length,b=typeof Uint8Array<"u"?Uint8Array:Array,C=new b(T);C[0]=C[T-1]=1,y(l,C,d,0,T-1);var P,H=[];for(P=0;P<T;P++)C[P]&&H.push(l[P]);return H}function y(l,d,T,b,C){var P=0,H,te,ue;for(te=b+1;te<=C-1;te++)ue=it(l[te],l[b],l[C],!0),ue>P&&(H=te,P=ue);P>T&&(d[H]=1,y(l,d,T,b,H),y(l,d,T,H,C))}function I(l,d){for(var T=[l[0]],b=1,C=0,P=l.length;b<P;b++)Re(l[b],l[C])>d&&(T.push(l[b]),C=b);return C<P-1&&T.push(l[P-1]),T}var M;function U(l,d,T,b,C){var P=b?M:de(l,T),H=de(d,T),te,ue,xe;for(M=H;;){if(!(P|H))return[l,d];if(P&H)return!1;te=P||H,ue=se(l,d,te,T,C),xe=de(ue,T),te===P?(l=ue,P=xe):(d=ue,H=xe)}}function se(l,d,T,b,C){var P=d.x-l.x,H=d.y-l.y,te=b.min,ue=b.max,xe,De;return T&8?(xe=l.x+P*(ue.y-l.y)/H,De=ue.y):T&4?(xe=l.x+P*(te.y-l.y)/H,De=te.y):T&2?(xe=ue.x,De=l.y+H*(ue.x-l.x)/P):T&1&&(xe=te.x,De=l.y+H*(te.x-l.x)/P),new Se(xe,De,C)}function de(l,d){var T=0;return l.x<d.min.x?T|=1:l.x>d.max.x&&(T|=2),l.y<d.min.y?T|=4:l.y>d.max.y&&(T|=8),T}function Re(l,d){var T=d.x-l.x,b=d.y-l.y;return T*T+b*b}function it(l,d,T,b){var C=d.x,P=d.y,H=T.x-C,te=T.y-P,ue=H*H+te*te,xe;return ue>0&&(xe=((l.x-C)*H+(l.y-P)*te)/ue,xe>1?(C=T.x,P=T.y):xe>0&&(C+=H*xe,P+=te*xe)),H=l.x-C,te=l.y-P,b?H*H+te*te:new Se(C,P)}function Mt(l){return!Q(l[0])||typeof l[0][0]!="object"&&typeof l[0][0]<"u"}function Pt(l){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Mt(l)}function sn(l,d){var T,b,C,P,H,te,ue,xe;if(!l||l.length===0)throw new Error("latlngs not passed");Mt(l)||(console.warn("latlngs are not flat! Only the first ring will be used"),l=l[0]);var De=Ae([0,0]),Ke=le(l),ht=Ke.getNorthWest().distanceTo(Ke.getSouthWest())*Ke.getNorthEast().distanceTo(Ke.getNorthWest());ht<1700&&(De=Uo(l));var Gn=l.length,Sn=[];for(T=0;T<Gn;T++){var Mi=Ae(l[T]);Sn.push(d.project(Ae([Mi.lat-De.lat,Mi.lng-De.lng])))}for(T=0,b=0;T<Gn-1;T++)b+=Sn[T].distanceTo(Sn[T+1])/2;if(b===0)xe=Sn[0];else for(T=0,P=0;T<Gn-1;T++)if(H=Sn[T],te=Sn[T+1],C=H.distanceTo(te),P+=C,P>b){ue=(P-b)/C,xe=[te.x-ue*(te.x-H.x),te.y-ue*(te.y-H.y)];break}var Ot=d.unproject(Me(xe));return Ae([Ot.lat+De.lat,Ot.lng+De.lng])}var Gi={__proto__:null,simplify:Qn,pointToSegmentDistance:Qa,closestPointOnSegment:ou,clipSegment:U,_getEdgeIntersection:se,_getBitCode:de,_sqClosestPointOnSegment:it,isFlat:Mt,_flat:Pt,polylineCenter:sn},Hi={project:function(l){return new Se(l.lng,l.lat)},unproject:function(l){return new ge(l.y,l.x)},bounds:new j([-180,-90],[180,90])},Ri={R:6378137,R_MINOR:6356752314245179e-9,bounds:new j([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(l){var d=Math.PI/180,T=this.R,b=l.lat*d,C=this.R_MINOR/T,P=Math.sqrt(1-C*C),H=P*Math.sin(b),te=Math.tan(Math.PI/4-b/2)/Math.pow((1-H)/(1+H),P/2);return b=-T*Math.log(Math.max(te,1e-10)),new Se(l.lng*d*T,b)},unproject:function(l){for(var d=180/Math.PI,T=this.R,b=this.R_MINOR/T,C=Math.sqrt(1-b*b),P=Math.exp(-l.y/T),H=Math.PI/2-2*Math.atan(P),te=0,ue=.1,xe;te<15&&Math.abs(ue)>1e-7;te++)xe=C*Math.sin(H),xe=Math.pow((1-xe)/(1+xe),C/2),ue=Math.PI/2-2*Math.atan(P*xe)-H,H+=ue;return new ge(H*d,l.x*d/T)}},fs={__proto__:null,LonLat:Hi,Mercator:Ri,SphericalMercator:et},Yr=r({},Ue,{code:"EPSG:3395",projection:Ri,transformation:(function(){var l=.5/(Math.PI*Ri.R);return nt(l,.5,-l,.5)})()}),Wr=r({},Ue,{code:"EPSG:4326",projection:Hi,transformation:nt(1/180,1,-1/180,.5)}),Bo=r({},He,{projection:Hi,transformation:nt(1,0,-1,0),scale:function(l){return Math.pow(2,l)},zoom:function(l){return Math.log(l)/Math.LN2},distance:function(l,d){var T=d.lng-l.lng,b=d.lat-l.lat;return Math.sqrt(T*T+b*b)},infinite:!0});He.Earth=Ue,He.EPSG3395=Yr,He.EPSG3857=qt,He.EPSG900913=_n,He.EPSG4326=Wr,He.Simple=Bo;var ms=be.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(l){return l.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(l){return l&&l.removeLayer(this),this},getPane:function(l){return this._map.getPane(l?this.options[l]||l:this.options.pane)},addInteractiveTarget:function(l){return this._map._targets[m(l)]=this,this},removeInteractiveTarget:function(l){return delete this._map._targets[m(l)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(l){var d=l.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var T=this.getEvents();d.on(T,this),this.once("remove",function(){d.off(T,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});mt.include({addLayer:function(l){if(!l._layerAdd)throw new Error("The provided object is not a Layer.");var d=m(l);return this._layers[d]?this:(this._layers[d]=l,l._mapToAdd=this,l.beforeAdd&&l.beforeAdd(this),this.whenReady(l._layerAdd,l),this)},removeLayer:function(l){var d=m(l);return this._layers[d]?(this._loaded&&l.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:l}),l.fire("remove")),l._map=l._mapToAdd=null,this):this},hasLayer:function(l){return m(l)in this._layers},eachLayer:function(l,d){for(var T in this._layers)l.call(d,this._layers[T]);return this},_addLayers:function(l){l=l?Q(l)?l:[l]:[];for(var d=0,T=l.length;d<T;d++)this.addLayer(l[d])},_addZoomLimit:function(l){(!isNaN(l.options.maxZoom)||!isNaN(l.options.minZoom))&&(this._zoomBoundLayers[m(l)]=l,this._updateZoomLevels())},_removeZoomLimit:function(l){var d=m(l);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var l=1/0,d=-1/0,T=this._getZoomSpan();for(var b in this._zoomBoundLayers){var C=this._zoomBoundLayers[b].options;l=C.minZoom===void 0?l:Math.min(l,C.minZoom),d=C.maxZoom===void 0?d:Math.max(d,C.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=l===1/0?void 0:l,T!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var zo=ms.extend({initialize:function(l,d){z(this,d),this._layers={};var T,b;if(l)for(T=0,b=l.length;T<b;T++)this.addLayer(l[T])},addLayer:function(l){var d=this.getLayerId(l);return this._layers[d]=l,this._map&&this._map.addLayer(l),this},removeLayer:function(l){var d=l in this._layers?l:this.getLayerId(l);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(l){var d=typeof l=="number"?l:this.getLayerId(l);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(l){var d=Array.prototype.slice.call(arguments,1),T,b;for(T in this._layers)b=this._layers[T],b[l]&&b[l].apply(b,d);return this},onAdd:function(l){this.eachLayer(l.addLayer,l)},onRemove:function(l){this.eachLayer(l.removeLayer,l)},eachLayer:function(l,d){for(var T in this._layers)l.call(d,this._layers[T]);return this},getLayer:function(l){return this._layers[l]},getLayers:function(){var l=[];return this.eachLayer(l.push,l),l},setZIndex:function(l){return this.invoke("setZIndex",l)},getLayerId:function(l){return m(l)}}),bp=function(l,d){return new zo(l,d)},ks=zo.extend({addLayer:function(l){return this.hasLayer(l)?this:(l.addEventParent(this),zo.prototype.addLayer.call(this,l),this.fire("layeradd",{layer:l}))},removeLayer:function(l){return this.hasLayer(l)?(l in this._layers&&(l=this._layers[l]),l.removeEventParent(this),zo.prototype.removeLayer.call(this,l),this.fire("layerremove",{layer:l})):this},setStyle:function(l){return this.invoke("setStyle",l)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var l=new Ie;for(var d in this._layers){var T=this._layers[d];l.extend(T.getBounds?T.getBounds():T.getLatLng())}return l}}),Sh=function(l,d){return new ks(l,d)},Ls=qe.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(l){z(this,l)},createIcon:function(l){return this._createIcon("icon",l)},createShadow:function(l){return this._createIcon("shadow",l)},_createIcon:function(l,d){var T=this._getIconUrl(l);if(!T){if(l==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(T,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(b,l),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),b},_setIconStyles:function(l,d){var T=this.options,b=T[d+"Size"];typeof b=="number"&&(b=[b,b]);var C=Me(b),P=Me(d==="shadow"&&T.shadowAnchor||T.iconAnchor||C&&C.divideBy(2,!0));l.className="leaflet-marker-"+d+" "+(T.className||""),P&&(l.style.marginLeft=-P.x+"px",l.style.marginTop=-P.y+"px"),C&&(l.style.width=C.x+"px",l.style.height=C.y+"px")},_createImg:function(l,d){return d=d||document.createElement("img"),d.src=l,d},_getIconUrl:function(l){return Be.retina&&this.options[l+"RetinaUrl"]||this.options[l+"Url"]}});function $a(l){return new Ls(l)}var Xa=Ls.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(l){return typeof Xa.imagePath!="string"&&(Xa.imagePath=this._detectIconPath()),(this.options.imagePath||Xa.imagePath)+Ls.prototype._getIconUrl.call(this,l)},_stripUrl:function(l){var d=function(T,b,C){var P=b.exec(T);return P&&P[C]};return l=d(l,/^url\((['"])?(.+)\1\)$/,2),l&&d(l,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var l=gt("div","leaflet-default-icon-path",document.body),d=pr(l,"background-image")||pr(l,"backgroundImage");if(document.body.removeChild(l),d=this._stripUrl(d),d)return d;var T=document.querySelector('link[href$="leaflet.css"]');return T?T.href.substring(0,T.href.length-11-1):""}}),el=Ni.extend({initialize:function(l){this._marker=l},addHooks:function(){var l=this._marker._icon;this._draggable||(this._draggable=new hs(l,l,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Oe(l,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&jt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(l){var d=this._marker,T=d._map,b=this._marker.options.autoPanSpeed,C=this._marker.options.autoPanPadding,P=Rs(d._icon),H=T.getPixelBounds(),te=T.getPixelOrigin(),ue=fe(H.min._subtract(te).add(C),H.max._subtract(te).subtract(C));if(!ue.contains(P)){var xe=Me((Math.max(ue.max.x,P.x)-ue.max.x)/(H.max.x-ue.max.x)-(Math.min(ue.min.x,P.x)-ue.min.x)/(H.min.x-ue.min.x),(Math.max(ue.max.y,P.y)-ue.max.y)/(H.max.y-ue.max.y)-(Math.min(ue.min.y,P.y)-ue.min.y)/(H.min.y-ue.min.y)).multiplyBy(b);T.panBy(xe,{animate:!1}),this._draggable._newPos._add(xe),this._draggable._startPos._add(xe),Kt(d._icon,this._draggable._newPos),this._onDrag(l),this._panRequest=q(this._adjustPan.bind(this,l))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(l){this._marker.options.autoPan&&(K(this._panRequest),this._panRequest=q(this._adjustPan.bind(this,l)))},_onDrag:function(l){var d=this._marker,T=d._shadow,b=Rs(d._icon),C=d._map.layerPointToLatLng(b);T&&Kt(T,b),d._latlng=C,l.latlng=C,l.oldLatLng=this._oldLatLng,d.fire("move",l).fire("drag",l)},_onDragEnd:function(l){K(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",l)}}),tl=ms.extend({options:{icon:new Xa,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(l,d){z(this,d),this._latlng=Ae(l)},onAdd:function(l){this._zoomAnimated=this._zoomAnimated&&l.options.markerZoomAnimation,this._zoomAnimated&&l.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(l){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&l.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(l){var d=this._latlng;return this._latlng=Ae(l),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(l){return this.options.zIndexOffset=l,this.update()},getIcon:function(){return this.options.icon},setIcon:function(l){return this.options.icon=l,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var l=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(l)}return this},_initIcon:function(){var l=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),T=l.icon.createIcon(this._icon),b=!1;T!==this._icon&&(this._icon&&this._removeIcon(),b=!0,l.title&&(T.title=l.title),T.tagName==="IMG"&&(T.alt=l.alt||"")),Oe(T,d),l.keyboard&&(T.tabIndex="0",T.setAttribute("role","button")),this._icon=T,l.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Xe(T,"focus",this._panOnFocus,this);var C=l.icon.createShadow(this._shadow),P=!1;C!==this._shadow&&(this._removeShadow(),P=!0),C&&(Oe(C,d),C.alt=""),this._shadow=C,l.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),C&&P&&this.getPane(l.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Lt(this._icon,"focus",this._panOnFocus,this),Tt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Tt(this._shadow),this._shadow=null},_setPos:function(l){this._icon&&Kt(this._icon,l),this._shadow&&Kt(this._shadow,l),this._zIndex=l.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(l){this._icon&&(this._icon.style.zIndex=this._zIndex+l)},_animateZoom:function(l){var d=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(Oe(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),el)){var l=this.options.draggable;this.dragging&&(l=this.dragging.enabled(),this.dragging.disable()),this.dragging=new el(this),l&&this.dragging.enable()}},setOpacity:function(l){return this.options.opacity=l,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var l=this.options.opacity;this._icon&&nn(this._icon,l),this._shadow&&nn(this._shadow,l)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var l=this._map;if(l){var d=this.options.icon.options,T=d.iconSize?Me(d.iconSize):Me(0,0),b=d.iconAnchor?Me(d.iconAnchor):Me(0,0);l.panInside(this._latlng,{paddingTopLeft:b,paddingBottomRight:T.subtract(b)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function bh(l,d){return new tl(l,d)}var Vs=ms.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(l){this._renderer=l.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(l){return z(this,l),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&l&&Object.prototype.hasOwnProperty.call(l,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Fo=Vs.extend({options:{fill:!0,radius:10},initialize:function(l,d){z(this,d),this._latlng=Ae(l),this._radius=this.options.radius},setLatLng:function(l){var d=this._latlng;return this._latlng=Ae(l),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(l){return this.options.radius=this._radius=l,this.redraw()},getRadius:function(){return this._radius},setStyle:function(l){var d=l&&l.radius||this._radius;return Vs.prototype.setStyle.call(this,l),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var l=this._radius,d=this._radiusY||l,T=this._clickTolerance(),b=[l+T,d+T];this._pxBounds=new j(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(l){return l.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ah(l,d){return new Fo(l,d)}var au=Fo.extend({initialize:function(l,d,T){if(typeof d=="number"&&(d=r({},T,{radius:d})),z(this,d),this._latlng=Ae(l),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(l){return this._mRadius=l,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var l=[this._radius,this._radiusY||this._radius];return new Ie(this._map.layerPointToLatLng(this._point.subtract(l)),this._map.layerPointToLatLng(this._point.add(l)))},setStyle:Vs.prototype.setStyle,_project:function(){var l=this._latlng.lng,d=this._latlng.lat,T=this._map,b=T.options.crs;if(b.distance===Ue.distance){var C=Math.PI/180,P=this._mRadius/Ue.R/C,H=T.project([d+P,l]),te=T.project([d-P,l]),ue=H.add(te).divideBy(2),xe=T.unproject(ue).lat,De=Math.acos((Math.cos(P*C)-Math.sin(d*C)*Math.sin(xe*C))/(Math.cos(d*C)*Math.cos(xe*C)))/C;(isNaN(De)||De===0)&&(De=P/Math.cos(Math.PI/180*d)),this._point=ue.subtract(T.getPixelOrigin()),this._radius=isNaN(De)?0:ue.x-T.project([xe,l-De]).x,this._radiusY=ue.y-H.y}else{var Ke=b.unproject(b.project(this._latlng).subtract([this._mRadius,0]));this._point=T.latLngToLayerPoint(this._latlng),this._radius=this._point.x-T.latLngToLayerPoint(Ke).x}this._updateBounds()}});function Ih(l,d,T){return new au(l,d,T)}var Xs=Vs.extend({options:{smoothFactor:1,noClip:!1},initialize:function(l,d){z(this,d),this._setLatLngs(l)},getLatLngs:function(){return this._latlngs},setLatLngs:function(l){return this._setLatLngs(l),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(l){for(var d=1/0,T=null,b=it,C,P,H=0,te=this._parts.length;H<te;H++)for(var ue=this._parts[H],xe=1,De=ue.length;xe<De;xe++){C=ue[xe-1],P=ue[xe];var Ke=b(l,C,P,!0);Ke<d&&(d=Ke,T=b(l,C,P))}return T&&(T.distance=Math.sqrt(d)),T},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return sn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(l,d){return d=d||this._defaultShape(),l=Ae(l),d.push(l),this._bounds.extend(l),this.redraw()},_setLatLngs:function(l){this._bounds=new Ie,this._latlngs=this._convertLatLngs(l)},_defaultShape:function(){return Mt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(l){for(var d=[],T=Mt(l),b=0,C=l.length;b<C;b++)T?(d[b]=Ae(l[b]),this._bounds.extend(d[b])):d[b]=this._convertLatLngs(l[b]);return d},_project:function(){var l=new j;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,l),this._bounds.isValid()&&l.isValid()&&(this._rawPxBounds=l,this._updateBounds())},_updateBounds:function(){var l=this._clickTolerance(),d=new Se(l,l);this._rawPxBounds&&(this._pxBounds=new j([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(l,d,T){var b=l[0]instanceof ge,C=l.length,P,H;if(b){for(H=[],P=0;P<C;P++)H[P]=this._map.latLngToLayerPoint(l[P]),T.extend(H[P]);d.push(H)}else for(P=0;P<C;P++)this._projectLatlngs(l[P],d,T)},_clipPoints:function(){var l=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(l))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,T,b,C,P,H,te,ue;for(T=0,C=0,P=this._rings.length;T<P;T++)for(ue=this._rings[T],b=0,H=ue.length;b<H-1;b++)te=U(ue[b],ue[b+1],l,b,!0),te&&(d[C]=d[C]||[],d[C].push(te[0]),(te[1]!==ue[b+1]||b===H-2)&&(d[C].push(te[1]),C++))}},_simplifyPoints:function(){for(var l=this._parts,d=this.options.smoothFactor,T=0,b=l.length;T<b;T++)l[T]=Qn(l[T],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(l,d){var T,b,C,P,H,te,ue=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(l))return!1;for(T=0,P=this._parts.length;T<P;T++)for(te=this._parts[T],b=0,H=te.length,C=H-1;b<H;C=b++)if(!(!d&&b===0)&&Qa(l,te[C],te[b])<=ue)return!0;return!1}});function Ap(l,d){return new Xs(l,d)}Xs._flat=Pt;var qo=Xs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Wa(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(l){var d=Xs.prototype._convertLatLngs.call(this,l),T=d.length;return T>=2&&d[0]instanceof ge&&d[0].equals(d[T-1])&&d.pop(),d},_setLatLngs:function(l){Xs.prototype._setLatLngs.call(this,l),Mt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Mt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var l=this._renderer._bounds,d=this.options.weight,T=new Se(d,d);if(l=new j(l.min.subtract(T),l.max.add(T)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(l))){if(this.options.noClip){this._parts=this._rings;return}for(var b=0,C=this._rings.length,P;b<C;b++)P=Ya(this._rings[b],l,!0),P.length&&this._parts.push(P)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(l){var d=!1,T,b,C,P,H,te,ue,xe;if(!this._pxBounds||!this._pxBounds.contains(l))return!1;for(P=0,ue=this._parts.length;P<ue;P++)for(T=this._parts[P],H=0,xe=T.length,te=xe-1;H<xe;te=H++)b=T[H],C=T[te],b.y>l.y!=C.y>l.y&&l.x<(C.x-b.x)*(l.y-b.y)/(C.y-b.y)+b.x&&(d=!d);return d||Xs.prototype._containsPoint.call(this,l,!0)}});function Ip(l,d){return new qo(l,d)}var er=ks.extend({initialize:function(l,d){z(this,d),this._layers={},l&&this.addData(l)},addData:function(l){var d=Q(l)?l:l.features,T,b,C;if(d){for(T=0,b=d.length;T<b;T++)C=d[T],(C.geometries||C.geometry||C.features||C.coordinates)&&this.addData(C);return this}var P=this.options;if(P.filter&&!P.filter(l))return this;var H=$n(l,P);return H?(H.feature=cu(l),H.defaultOptions=H.options,this.resetStyle(H),P.onEachFeature&&P.onEachFeature(l,H),this.addLayer(H)):this},resetStyle:function(l){return l===void 0?this.eachLayer(this.resetStyle,this):(l.options=r({},l.defaultOptions),this._setLayerStyle(l,this.options.style),this)},setStyle:function(l){return this.eachLayer(function(d){this._setLayerStyle(d,l)},this)},_setLayerStyle:function(l,d){l.setStyle&&(typeof d=="function"&&(d=d(l.feature)),l.setStyle(d))}});function $n(l,d){var T=l.type==="Feature"?l.geometry:l,b=T?T.coordinates:null,C=[],P=d&&d.pointToLayer,H=d&&d.coordsToLatLng||lu,te,ue,xe,De;if(!b&&!T)return null;switch(T.type){case"Point":return te=H(b),Go(P,l,te,d);case"MultiPoint":for(xe=0,De=b.length;xe<De;xe++)te=H(b[xe]),C.push(Go(P,l,te,d));return new ks(C);case"LineString":case"MultiLineString":return ue=nl(b,T.type==="LineString"?0:1,H),new Xs(ue,d);case"Polygon":case"MultiPolygon":return ue=nl(b,T.type==="Polygon"?1:2,H),new qo(ue,d);case"GeometryCollection":for(xe=0,De=T.geometries.length;xe<De;xe++){var Ke=$n({geometry:T.geometries[xe],type:"Feature",properties:l.properties},d);Ke&&C.push(Ke)}return new ks(C);case"FeatureCollection":for(xe=0,De=T.features.length;xe<De;xe++){var ht=$n(T.features[xe],d);ht&&C.push(ht)}return new ks(C);default:throw new Error("Invalid GeoJSON object.")}}function Go(l,d,T,b){return l?l(d,T):new tl(T,b&&b.markersInheritOptions&&b)}function lu(l){return new ge(l[1],l[0],l[2])}function nl(l,d,T){for(var b=[],C=0,P=l.length,H;C<P;C++)H=d?nl(l[C],d-1,T):(T||lu)(l[C]),b.push(H);return b}function uu(l,d){return l=Ae(l),l.alt!==void 0?[A(l.lng,d),A(l.lat,d),A(l.alt,d)]:[A(l.lng,d),A(l.lat,d)]}function il(l,d,T,b){for(var C=[],P=0,H=l.length;P<H;P++)C.push(d?il(l[P],Mt(l[P])?0:d-1,T,b):uu(l[P],b));return!d&&T&&C.length>0&&C.push(C[0].slice()),C}function Er(l,d){return l.feature?r({},l.feature,{geometry:d}):cu(d)}function cu(l){return l.type==="Feature"||l.type==="FeatureCollection"?l:{type:"Feature",properties:{},geometry:l}}var wr={toGeoJSON:function(l){return Er(this,{type:"Point",coordinates:uu(this.getLatLng(),l)})}};tl.include(wr),au.include(wr),Fo.include(wr),Xs.include({toGeoJSON:function(l){var d=!Mt(this._latlngs),T=il(this._latlngs,d?1:0,!1,l);return Er(this,{type:(d?"Multi":"")+"LineString",coordinates:T})}}),qo.include({toGeoJSON:function(l){var d=!Mt(this._latlngs),T=d&&!Mt(this._latlngs[0]),b=il(this._latlngs,T?2:d?1:0,!0,l);return d||(b=[b]),Er(this,{type:(T?"Multi":"")+"Polygon",coordinates:b})}}),zo.include({toMultiPoint:function(l){var d=[];return this.eachLayer(function(T){d.push(T.toGeoJSON(l).geometry.coordinates)}),Er(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(l){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(l);var T=d==="GeometryCollection",b=[];return this.eachLayer(function(C){if(C.toGeoJSON){var P=C.toGeoJSON(l);if(T)b.push(P.geometry);else{var H=cu(P);H.type==="FeatureCollection"?b.push.apply(b,H.features):b.push(H)}}}),T?Er(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});function du(l,d){return new er(l,d)}var sl=du,Ho=ms.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(l,d,T){this._url=l,this._bounds=le(d),z(this,T)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Oe(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Tt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(l){return this.options.opacity=l,this._image&&this._updateOpacity(),this},setStyle:function(l){return l.opacity&&this.setOpacity(l.opacity),this},bringToFront:function(){return this._map&&dn(this._image),this},bringToBack:function(){return this._map&&Ii(this._image),this},setUrl:function(l){return this._url=l,this._image&&(this._image.src=l),this},setBounds:function(l){return this._bounds=le(l),this._map&&this._reset(),this},getEvents:function(){var l={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},setZIndex:function(l){return this.options.zIndex=l,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var l=this._url.tagName==="IMG",d=this._image=l?this._url:gt("img");if(Oe(d,"leaflet-image-layer"),this._zoomAnimated&&Oe(d,"leaflet-zoom-animated"),this.options.className&&Oe(d,this.options.className),d.onselectstart=S,d.onmousemove=S,d.onload=u(this.fire,this,"load"),d.onerror=u(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),l){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(l){var d=this._map.getZoomScale(l.zoom),T=this._map._latLngBoundsToNewLayerBounds(this._bounds,l.zoom,l.center).min;as(this._image,T,d)},_reset:function(){var l=this._image,d=new j(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),T=d.getSize();Kt(l,d.min),l.style.width=T.x+"px",l.style.height=T.y+"px"},_updateOpacity:function(){nn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var l=this.options.errorOverlayUrl;l&&this._url!==l&&(this._url=l,this._image.src=l)},getCenter:function(){return this._bounds.getCenter()}}),Ch=function(l,d,T){return new Ho(l,d,T)},Sr=Ho.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var l=this._url.tagName==="VIDEO",d=this._image=l?this._url:gt("video");if(Oe(d,"leaflet-image-layer"),this._zoomAnimated&&Oe(d,"leaflet-zoom-animated"),this.options.className&&Oe(d,this.options.className),d.onselectstart=S,d.onmousemove=S,d.onloadeddata=u(this.fire,this,"load"),l){for(var T=d.getElementsByTagName("source"),b=[],C=0;C<T.length;C++)b.push(T[C].src);this._url=T.length>0?b:[d.src];return}Q(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var P=0;P<this._url.length;P++){var H=gt("source");H.src=this._url[P],d.appendChild(H)}}});function jo(l,d,T){return new Sr(l,d,T)}var hu=Ho.extend({_initImage:function(){var l=this._image=this._url;Oe(l,"leaflet-image-layer"),this._zoomAnimated&&Oe(l,"leaflet-zoom-animated"),this.options.className&&Oe(l,this.options.className),l.onselectstart=S,l.onmousemove=S}});function Nh(l,d,T){return new hu(l,d,T)}var Xn=ms.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(l,d){l&&(l instanceof ge||Q(l))?(this._latlng=Ae(l),z(this,d)):(z(this,l),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(l){return l=arguments.length?l:this._source._map,l.hasLayer(this)||l.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(l){return this._map?this.close():(arguments.length?this._source=l:l=this._source,this._prepareOpen(),this.openOn(l._map)),this},onAdd:function(l){this._zoomAnimated=l._zoomAnimated,this._container||this._initLayout(),l._fadeAnimated&&nn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),l._fadeAnimated&&nn(this._container,1),this.bringToFront(),this.options.interactive&&(Oe(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(l){l._fadeAnimated?(nn(this._container,0),this._removeTimeout=setTimeout(u(Tt,void 0,this._container),200)):Tt(this._container),this.options.interactive&&(jt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(l){return this._latlng=Ae(l),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(l){return this._content=l,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var l={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&dn(this._container),this},bringToBack:function(){return this._map&&Ii(this._container),this},_prepareOpen:function(l){var d=this._source;if(!d._map)return!1;if(d instanceof ks){d=null;var T=this._source._layers;for(var b in T)if(T[b]._map){d=T[b];break}if(!d)return!1;this._source=d}if(!l)if(d.getCenter)l=d.getCenter();else if(d.getLatLng)l=d.getLatLng();else if(d.getBounds)l=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(l),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var l=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")l.innerHTML=d;else{for(;l.hasChildNodes();)l.removeChild(l.firstChild);l.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var l=this._map.latLngToLayerPoint(this._latlng),d=Me(this.options.offset),T=this._getAnchor();this._zoomAnimated?Kt(this._container,l.add(T)):d=d.add(l).add(T);var b=this._containerBottom=-d.y,C=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=b+"px",this._container.style.left=C+"px"}},_getAnchor:function(){return[0,0]}});mt.include({_initOverlay:function(l,d,T,b){var C=d;return C instanceof l||(C=new l(b).setContent(d)),T&&C.setLatLng(T),C}}),ms.include({_initOverlay:function(l,d,T,b){var C=T;return C instanceof l?(z(C,b),C._source=this):(C=d&&!b?d:new l(b,this),C.setContent(T)),C}});var rl=Xn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(l){return l=arguments.length?l:this._source._map,!l.hasLayer(this)&&l._popup&&l._popup.options.autoClose&&l.removeLayer(l._popup),l._popup=this,Xn.prototype.openOn.call(this,l)},onAdd:function(l){Xn.prototype.onAdd.call(this,l),l.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Vs||this._source.on("preclick",bt))},onRemove:function(l){Xn.prototype.onRemove.call(this,l),l.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Vs||this._source.off("preclick",bt))},getEvents:function(){var l=Xn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(l.preclick=this.close),this.options.keepInView&&(l.moveend=this._adjustPan),l},_initLayout:function(){var l="leaflet-popup",d=this._container=gt("div",l+" "+(this.options.className||"")+" leaflet-zoom-animated"),T=this._wrapper=gt("div",l+"-content-wrapper",d);if(this._contentNode=gt("div",l+"-content",T),Ys(d),qi(this._contentNode),Xe(d,"contextmenu",bt),this._tipContainer=gt("div",l+"-tip-container",d),this._tip=gt("div",l+"-tip",this._tipContainer),this.options.closeButton){var b=this._closeButton=gt("a",l+"-close-button",d);b.setAttribute("role","button"),b.setAttribute("aria-label","Close popup"),b.href="#close",b.innerHTML='<span aria-hidden="true">&#215;</span>',Xe(b,"click",function(C){hn(C),this.close()},this)}},_updateLayout:function(){var l=this._contentNode,d=l.style;d.width="",d.whiteSpace="nowrap";var T=l.offsetWidth;T=Math.min(T,this.options.maxWidth),T=Math.max(T,this.options.minWidth),d.width=T+1+"px",d.whiteSpace="",d.height="";var b=l.offsetHeight,C=this.options.maxHeight,P="leaflet-popup-scrolled";C&&b>C?(d.height=C+"px",Oe(l,P)):jt(l,P),this._containerWidth=this._container.offsetWidth},_animateZoom:function(l){var d=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center),T=this._getAnchor();Kt(this._container,d.add(T))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var l=this._map,d=parseInt(pr(this._container,"marginBottom"),10)||0,T=this._container.offsetHeight+d,b=this._containerWidth,C=new Se(this._containerLeft,-T-this._containerBottom);C._add(Rs(this._container));var P=l.layerPointToContainerPoint(C),H=Me(this.options.autoPanPadding),te=Me(this.options.autoPanPaddingTopLeft||H),ue=Me(this.options.autoPanPaddingBottomRight||H),xe=l.getSize(),De=0,Ke=0;P.x+b+ue.x>xe.x&&(De=P.x+b-xe.x+ue.x),P.x-De-te.x<0&&(De=P.x-te.x),P.y+T+ue.y>xe.y&&(Ke=P.y+T-xe.y+ue.y),P.y-Ke-te.y<0&&(Ke=P.y-te.y),(De||Ke)&&(this.options.keepInView&&(this._autopanning=!0),l.fire("autopanstart").panBy([De,Ke]))}},_getAnchor:function(){return Me(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Rh=function(l,d){return new rl(l,d)};mt.mergeOptions({closePopupOnClick:!0}),mt.include({openPopup:function(l,d,T){return this._initOverlay(rl,l,d,T).openOn(this),this},closePopup:function(l){return l=arguments.length?l:this._popup,l&&l.close(),this}}),ms.include({bindPopup:function(l,d){return this._popup=this._initOverlay(rl,this._popup,l,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(l){return this._popup&&(this instanceof ks||(this._popup._source=this),this._popup._prepareOpen(l||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(l){return this._popup&&this._popup.setContent(l),this},getPopup:function(){return this._popup},_openPopup:function(l){if(!(!this._popup||!this._map)){ls(l);var d=l.layer||l.target;if(this._popup._source===d&&!(d instanceof Vs)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(l.latlng);return}this._popup._source=d,this.openPopup(l.latlng)}},_movePopup:function(l){this._popup.setLatLng(l.latlng)},_onKeyPress:function(l){l.originalEvent.keyCode===13&&this._openPopup(l)}});var ol=Xn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(l){Xn.prototype.onAdd.call(this,l),this.setOpacity(this.options.opacity),l.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(l){Xn.prototype.onRemove.call(this,l),l.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var l=Xn.prototype.getEvents.call(this);return this.options.permanent||(l.preclick=this.close),l},_initLayout:function(){var l="leaflet-tooltip",d=l+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=gt("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+m(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(l){var d,T,b=this._map,C=this._container,P=b.latLngToContainerPoint(b.getCenter()),H=b.layerPointToContainerPoint(l),te=this.options.direction,ue=C.offsetWidth,xe=C.offsetHeight,De=Me(this.options.offset),Ke=this._getAnchor();te==="top"?(d=ue/2,T=xe):te==="bottom"?(d=ue/2,T=0):te==="center"?(d=ue/2,T=xe/2):te==="right"?(d=0,T=xe/2):te==="left"?(d=ue,T=xe/2):H.x<P.x?(te="right",d=0,T=xe/2):(te="left",d=ue+(De.x+Ke.x)*2,T=xe/2),l=l.subtract(Me(d,T,!0)).add(De).add(Ke),jt(C,"leaflet-tooltip-right"),jt(C,"leaflet-tooltip-left"),jt(C,"leaflet-tooltip-top"),jt(C,"leaflet-tooltip-bottom"),Oe(C,"leaflet-tooltip-"+te),Kt(C,l)},_updatePosition:function(){var l=this._map.latLngToLayerPoint(this._latlng);this._setPosition(l)},setOpacity:function(l){this.options.opacity=l,this._container&&nn(this._container,l)},_animateZoom:function(l){var d=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center);this._setPosition(d)},_getAnchor:function(){return Me(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Cp=function(l,d){return new ol(l,d)};mt.include({openTooltip:function(l,d,T){return this._initOverlay(ol,l,d,T).openOn(this),this},closeTooltip:function(l){return l.close(),this}}),ms.include({bindTooltip:function(l,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ol,this._tooltip,l,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(l){if(!(!l&&this._tooltipHandlersAdded)){var d=l?"off":"on",T={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?T.add=this._openTooltip:(T.mouseover=this._openTooltip,T.mouseout=this.closeTooltip,T.click=this._openTooltip,this._map?this._addFocusListeners():T.add=this._addFocusListeners),this._tooltip.options.sticky&&(T.mousemove=this._moveTooltip),this[d](T),this._tooltipHandlersAdded=!l}},openTooltip:function(l){return this._tooltip&&(this instanceof ks||(this._tooltip._source=this),this._tooltip._prepareOpen(l)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(l){return this._tooltip&&this._tooltip.setContent(l),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(l){var d=typeof l.getElement=="function"&&l.getElement();d&&(Xe(d,"focus",function(){this._tooltip._source=l,this.openTooltip()},this),Xe(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(l){var d=typeof l.getElement=="function"&&l.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(l){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(l)});return}this._tooltip._source=l.layer||l.target,this.openTooltip(this._tooltip.options.sticky?l.latlng:void 0)}},_moveTooltip:function(l){var d=l.latlng,T,b;this._tooltip.options.sticky&&l.originalEvent&&(T=this._map.mouseEventToContainerPoint(l.originalEvent),b=this._map.containerPointToLayerPoint(T),d=this._map.layerPointToLatLng(b)),this._tooltip.setLatLng(d)}});var Mh=Ls.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(l){var d=l&&l.tagName==="DIV"?l:document.createElement("div"),T=this.options;if(T.html instanceof Element?(cn(d),d.appendChild(T.html)):d.innerHTML=T.html!==!1?T.html:"",T.bgPos){var b=Me(T.bgPos);d.style.backgroundPosition=-b.x+"px "+-b.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function Np(l){return new Mh(l)}Ls.Default=Xa;var Ko=ms.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Be.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(l){z(this,l)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(l){l._addZoomLimit(this)},onRemove:function(l){this._removeAllTiles(),Tt(this._container),l._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(dn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ii(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(l){return this.options.opacity=l,this._updateOpacity(),this},setZIndex:function(l){return this.options.zIndex=l,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var l=this._clampZoom(this._map.getZoom());l!==this._tileZoom&&(this._tileZoom=l,this._updateLevels()),this._update()}return this},getEvents:function(){var l={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),l.move=this._onMove),this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},createTile:function(){return document.createElement("div")},getTileSize:function(){var l=this.options.tileSize;return l instanceof Se?l:new Se(l,l)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(l){for(var d=this.getPane().children,T=-l(-1/0,1/0),b=0,C=d.length,P;b<C;b++)P=d[b].style.zIndex,d[b]!==this._container&&P&&(T=l(T,+P));isFinite(T)&&(this.options.zIndex=T+l(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Be.ielt9){nn(this._container,this.options.opacity);var l=+new Date,d=!1,T=!1;for(var b in this._tiles){var C=this._tiles[b];if(!(!C.current||!C.loaded)){var P=Math.min(1,(l-C.loaded)/200);nn(C.el,P),P<1?d=!0:(C.active?T=!0:this._onOpaqueTile(C),C.active=!0)}}T&&!this._noPrune&&this._pruneTiles(),d&&(K(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this))}},_onOpaqueTile:S,_initContainer:function(){this._container||(this._container=gt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var l=this._tileZoom,d=this.options.maxZoom;if(l!==void 0){for(var T in this._levels)T=Number(T),this._levels[T].el.children.length||T===l?(this._levels[T].el.style.zIndex=d-Math.abs(l-T),this._onUpdateLevel(T)):(Tt(this._levels[T].el),this._removeTilesAtZoom(T),this._onRemoveLevel(T),delete this._levels[T]);var b=this._levels[l],C=this._map;return b||(b=this._levels[l]={},b.el=gt("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=d,b.origin=C.project(C.unproject(C.getPixelOrigin()),l).round(),b.zoom=l,this._setZoomTransform(b,C.getCenter(),C.getZoom()),S(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b,b}},_onUpdateLevel:S,_onRemoveLevel:S,_onCreateLevel:S,_pruneTiles:function(){if(this._map){var l,d,T=this._map.getZoom();if(T>this.options.maxZoom||T<this.options.minZoom){this._removeAllTiles();return}for(l in this._tiles)d=this._tiles[l],d.retain=d.current;for(l in this._tiles)if(d=this._tiles[l],d.current&&!d.active){var b=d.coords;this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2)}for(l in this._tiles)this._tiles[l].retain||this._removeTile(l)}},_removeTilesAtZoom:function(l){for(var d in this._tiles)this._tiles[d].coords.z===l&&this._removeTile(d)},_removeAllTiles:function(){for(var l in this._tiles)this._removeTile(l)},_invalidateAll:function(){for(var l in this._levels)Tt(this._levels[l].el),this._onRemoveLevel(Number(l)),delete this._levels[l];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(l,d,T,b){var C=Math.floor(l/2),P=Math.floor(d/2),H=T-1,te=new Se(+C,+P);te.z=+H;var ue=this._tileCoordsToKey(te),xe=this._tiles[ue];return xe&&xe.active?(xe.retain=!0,!0):(xe&&xe.loaded&&(xe.retain=!0),H>b?this._retainParent(C,P,H,b):!1)},_retainChildren:function(l,d,T,b){for(var C=2*l;C<2*l+2;C++)for(var P=2*d;P<2*d+2;P++){var H=new Se(C,P);H.z=T+1;var te=this._tileCoordsToKey(H),ue=this._tiles[te];if(ue&&ue.active){ue.retain=!0;continue}else ue&&ue.loaded&&(ue.retain=!0);T+1<b&&this._retainChildren(C,P,T+1,b)}},_resetView:function(l){var d=l&&(l.pinch||l.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(l){this._setView(l.center,l.zoom,!0,l.noUpdate)},_clampZoom:function(l){var d=this.options;return d.minNativeZoom!==void 0&&l<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<l?d.maxNativeZoom:l},_setView:function(l,d,T,b){var C=Math.round(d);this.options.maxZoom!==void 0&&C>this.options.maxZoom||this.options.minZoom!==void 0&&C<this.options.minZoom?C=void 0:C=this._clampZoom(C);var P=this.options.updateWhenZooming&&C!==this._tileZoom;(!b||P)&&(this._tileZoom=C,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),C!==void 0&&this._update(l),T||this._pruneTiles(),this._noPrune=!!T),this._setZoomTransforms(l,d)},_setZoomTransforms:function(l,d){for(var T in this._levels)this._setZoomTransform(this._levels[T],l,d)},_setZoomTransform:function(l,d,T){var b=this._map.getZoomScale(T,l.zoom),C=l.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(d,T)).round();Be.any3d?as(l.el,C,b):Kt(l.el,C)},_resetGrid:function(){var l=this._map,d=l.options.crs,T=this._tileSize=this.getTileSize(),b=this._tileZoom,C=this._map.getPixelWorldBounds(this._tileZoom);C&&(this._globalTileRange=this._pxBoundsToTileRange(C)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(l.project([0,d.wrapLng[0]],b).x/T.x),Math.ceil(l.project([0,d.wrapLng[1]],b).x/T.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(l.project([d.wrapLat[0],0],b).y/T.x),Math.ceil(l.project([d.wrapLat[1],0],b).y/T.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(l){var d=this._map,T=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),b=d.getZoomScale(T,this._tileZoom),C=d.project(l,this._tileZoom).floor(),P=d.getSize().divideBy(b*2);return new j(C.subtract(P),C.add(P))},_update:function(l){var d=this._map;if(d){var T=this._clampZoom(d.getZoom());if(l===void 0&&(l=d.getCenter()),this._tileZoom!==void 0){var b=this._getTiledPixelBounds(l),C=this._pxBoundsToTileRange(b),P=C.getCenter(),H=[],te=this.options.keepBuffer,ue=new j(C.getBottomLeft().subtract([te,-te]),C.getTopRight().add([te,-te]));if(!(isFinite(C.min.x)&&isFinite(C.min.y)&&isFinite(C.max.x)&&isFinite(C.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var xe in this._tiles){var De=this._tiles[xe].coords;(De.z!==this._tileZoom||!ue.contains(new Se(De.x,De.y)))&&(this._tiles[xe].current=!1)}if(Math.abs(T-this._tileZoom)>1){this._setView(l,T);return}for(var Ke=C.min.y;Ke<=C.max.y;Ke++)for(var ht=C.min.x;ht<=C.max.x;ht++){var Gn=new Se(ht,Ke);if(Gn.z=this._tileZoom,!!this._isValidTile(Gn)){var Sn=this._tiles[this._tileCoordsToKey(Gn)];Sn?Sn.current=!0:H.push(Gn)}}if(H.sort(function(Ot,Ut){return Ot.distanceTo(P)-Ut.distanceTo(P)}),H.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Mi=document.createDocumentFragment();for(ht=0;ht<H.length;ht++)this._addTile(H[ht],Mi);this._level.el.appendChild(Mi)}}}},_isValidTile:function(l){var d=this._map.options.crs;if(!d.infinite){var T=this._globalTileRange;if(!d.wrapLng&&(l.x<T.min.x||l.x>T.max.x)||!d.wrapLat&&(l.y<T.min.y||l.y>T.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(l);return le(this.options.bounds).overlaps(b)},_keyToBounds:function(l){return this._tileCoordsToBounds(this._keyToTileCoords(l))},_tileCoordsToNwSe:function(l){var d=this._map,T=this.getTileSize(),b=l.scaleBy(T),C=b.add(T),P=d.unproject(b,l.z),H=d.unproject(C,l.z);return[P,H]},_tileCoordsToBounds:function(l){var d=this._tileCoordsToNwSe(l),T=new Ie(d[0],d[1]);return this.options.noWrap||(T=this._map.wrapLatLngBounds(T)),T},_tileCoordsToKey:function(l){return l.x+":"+l.y+":"+l.z},_keyToTileCoords:function(l){var d=l.split(":"),T=new Se(+d[0],+d[1]);return T.z=+d[2],T},_removeTile:function(l){var d=this._tiles[l];d&&(Tt(d.el),delete this._tiles[l],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(l)}))},_initTile:function(l){Oe(l,"leaflet-tile");var d=this.getTileSize();l.style.width=d.x+"px",l.style.height=d.y+"px",l.onselectstart=S,l.onmousemove=S,Be.ielt9&&this.options.opacity<1&&nn(l,this.options.opacity)},_addTile:function(l,d){var T=this._getTilePos(l),b=this._tileCoordsToKey(l),C=this.createTile(this._wrapCoords(l),u(this._tileReady,this,l));this._initTile(C),this.createTile.length<2&&q(u(this._tileReady,this,l,null,C)),Kt(C,T),this._tiles[b]={el:C,coords:l,current:!0},d.appendChild(C),this.fire("tileloadstart",{tile:C,coords:l})},_tileReady:function(l,d,T){d&&this.fire("tileerror",{error:d,tile:T,coords:l});var b=this._tileCoordsToKey(l);T=this._tiles[b],T&&(T.loaded=+new Date,this._map._fadeAnimated?(nn(T.el,0),K(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this)):(T.active=!0,this._pruneTiles()),d||(Oe(T.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:T.el,coords:l})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Be.ielt9||!this._map._fadeAnimated?q(this._pruneTiles,this):setTimeout(u(this._pruneTiles,this),250)))},_getTilePos:function(l){return l.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(l){var d=new Se(this._wrapX?E(l.x,this._wrapX):l.x,this._wrapY?E(l.y,this._wrapY):l.y);return d.z=l.z,d},_pxBoundsToTileRange:function(l){var d=this.getTileSize();return new j(l.min.unscaleBy(d).floor(),l.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var l in this._tiles)if(!this._tiles[l].loaded)return!1;return!0}});function Ph(l){return new Ko(l)}var br=Ko.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(l,d){this._url=l,d=z(this,d),d.detectRetina&&Be.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(l,d){return this._url===l&&d===void 0&&(d=!0),this._url=l,d||this.redraw(),this},createTile:function(l,d){var T=document.createElement("img");return Xe(T,"load",u(this._tileOnLoad,this,d,T)),Xe(T,"error",u(this._tileOnError,this,d,T)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(T.referrerPolicy=this.options.referrerPolicy),T.alt="",T.src=this.getTileUrl(l),T},getTileUrl:function(l){var d={r:Be.retina?"@2x":"",s:this._getSubdomain(l),x:l.x,y:l.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var T=this._globalTileRange.max.y-l.y;this.options.tms&&(d.y=T),d["-y"]=T}return ne(this._url,r(d,this.options))},_tileOnLoad:function(l,d){Be.ielt9?setTimeout(u(l,this,null,d),0):l(null,d)},_tileOnError:function(l,d,T){var b=this.options.errorTileUrl;b&&d.getAttribute("src")!==b&&(d.src=b),l(T,d)},_onTileRemove:function(l){l.tile.onload=null},_getZoomForUrl:function(){var l=this._tileZoom,d=this.options.maxZoom,T=this.options.zoomReverse,b=this.options.zoomOffset;return T&&(l=d-l),l+b},_getSubdomain:function(l){var d=Math.abs(l.x+l.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var l,d;for(l in this._tiles)if(this._tiles[l].coords.z!==this._tileZoom&&(d=this._tiles[l].el,d.onload=S,d.onerror=S,!d.complete)){d.src=he;var T=this._tiles[l].coords;Tt(d),delete this._tiles[l],this.fire("tileabort",{tile:d,coords:T})}},_removeTile:function(l){var d=this._tiles[l];if(d)return d.el.setAttribute("src",he),Ko.prototype._removeTile.call(this,l)},_tileReady:function(l,d,T){if(!(!this._map||T&&T.getAttribute("src")===he))return Ko.prototype._tileReady.call(this,l,d,T)}});function ji(l,d){return new br(l,d)}var al=br.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(l,d){this._url=l;var T=r({},this.defaultWmsParams);for(var b in d)b in this.options||(T[b]=d[b]);d=z(this,d);var C=d.detectRetina&&Be.retina?2:1,P=this.getTileSize();T.width=P.x*C,T.height=P.y*C,this.wmsParams=T},onAdd:function(l){this._crs=this.options.crs||l.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,br.prototype.onAdd.call(this,l)},getTileUrl:function(l){var d=this._tileCoordsToNwSe(l),T=this._crs,b=fe(T.project(d[0]),T.project(d[1])),C=b.min,P=b.max,H=(this._wmsVersion>=1.3&&this._crs===Wr?[C.y,C.x,P.y,P.x]:[C.x,C.y,P.x,P.y]).join(","),te=br.prototype.getTileUrl.call(this,l);return te+Z(this.wmsParams,te,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+H},setParams:function(l,d){return r(this.wmsParams,l),d||this.redraw(),this}});function Ki(l,d){return new al(l,d)}br.WMS=al,ji.wms=Ki;var mi=ms.extend({options:{padding:.1},initialize:function(l){z(this,l),m(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Oe(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var l={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(l.zoomanim=this._onAnimZoom),l},_onAnimZoom:function(l){this._updateTransform(l.center,l.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(l,d){var T=this._map.getZoomScale(d,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),C=this._map.project(this._center,d),P=b.multiplyBy(-T).add(C).subtract(this._map._getNewPixelOrigin(l,d));Be.any3d?as(this._container,P,T):Kt(this._container,P)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var l in this._layers)this._layers[l]._reset()},_onZoomEnd:function(){for(var l in this._layers)this._layers[l]._project()},_updatePaths:function(){for(var l in this._layers)this._layers[l]._update()},_update:function(){var l=this.options.padding,d=this._map.getSize(),T=this._map.containerPointToLayerPoint(d.multiplyBy(-l)).round();this._bounds=new j(T,T.add(d.multiplyBy(1+l*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),fu=mi.extend({options:{tolerance:0},getEvents:function(){var l=mi.prototype.getEvents.call(this);return l.viewprereset=this._onViewPreReset,l},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){mi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var l=this._container=document.createElement("canvas");Xe(l,"mousemove",this._onMouseMove,this),Xe(l,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Xe(l,"mouseout",this._handleMouseOut,this),l._leaflet_disable_events=!0,this._ctx=l.getContext("2d")},_destroyContainer:function(){K(this._redrawRequest),delete this._ctx,Tt(this._container),Lt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var l;this._redrawBounds=null;for(var d in this._layers)l=this._layers[d],l._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){mi.prototype._update.call(this);var l=this._bounds,d=this._container,T=l.getSize(),b=Be.retina?2:1;Kt(d,l.min),d.width=b*T.x,d.height=b*T.y,d.style.width=T.x+"px",d.style.height=T.y+"px",Be.retina&&this._ctx.scale(2,2),this._ctx.translate(-l.min.x,-l.min.y),this.fire("update")}},_reset:function(){mi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(l){this._updateDashArray(l),this._layers[m(l)]=l;var d=l._order={layer:l,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(l){this._requestRedraw(l)},_removePath:function(l){var d=l._order,T=d.next,b=d.prev;T?T.prev=b:this._drawLast=b,b?b.next=T:this._drawFirst=T,delete l._order,delete this._layers[m(l)],this._requestRedraw(l)},_updatePath:function(l){this._extendRedrawBounds(l),l._project(),l._update(),this._requestRedraw(l)},_updateStyle:function(l){this._updateDashArray(l),this._requestRedraw(l)},_updateDashArray:function(l){if(typeof l.options.dashArray=="string"){var d=l.options.dashArray.split(/[, ]+/),T=[],b,C;for(C=0;C<d.length;C++){if(b=Number(d[C]),isNaN(b))return;T.push(b)}l.options._dashArray=T}else l.options._dashArray=l.options.dashArray},_requestRedraw:function(l){this._map&&(this._extendRedrawBounds(l),this._redrawRequest=this._redrawRequest||q(this._redraw,this))},_extendRedrawBounds:function(l){if(l._pxBounds){var d=(l.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new j,this._redrawBounds.extend(l._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(l._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var l=this._redrawBounds;if(l){var d=l.getSize();this._ctx.clearRect(l.min.x,l.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var l,d=this._redrawBounds;if(this._ctx.save(),d){var T=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,T.x,T.y),this._ctx.clip()}this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)l=b.layer,(!d||l._pxBounds&&l._pxBounds.intersects(d))&&l._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(l,d){if(this._drawing){var T,b,C,P,H=l._parts,te=H.length,ue=this._ctx;if(te){for(ue.beginPath(),T=0;T<te;T++){for(b=0,C=H[T].length;b<C;b++)P=H[T][b],ue[b?"lineTo":"moveTo"](P.x,P.y);d&&ue.closePath()}this._fillStroke(ue,l)}}},_updateCircle:function(l){if(!(!this._drawing||l._empty())){var d=l._point,T=this._ctx,b=Math.max(Math.round(l._radius),1),C=(Math.max(Math.round(l._radiusY),1)||b)/b;C!==1&&(T.save(),T.scale(1,C)),T.beginPath(),T.arc(d.x,d.y/C,b,0,Math.PI*2,!1),C!==1&&T.restore(),this._fillStroke(T,l)}},_fillStroke:function(l,d){var T=d.options;T.fill&&(l.globalAlpha=T.fillOpacity,l.fillStyle=T.fillColor||T.color,l.fill(T.fillRule||"evenodd")),T.stroke&&T.weight!==0&&(l.setLineDash&&l.setLineDash(d.options&&d.options._dashArray||[]),l.globalAlpha=T.opacity,l.lineWidth=T.weight,l.strokeStyle=T.color,l.lineCap=T.lineCap,l.lineJoin=T.lineJoin,l.stroke())},_onClick:function(l){for(var d=this._map.mouseEventToLayerPoint(l),T,b,C=this._drawFirst;C;C=C.next)T=C.layer,T.options.interactive&&T._containsPoint(d)&&(!(l.type==="click"||l.type==="preclick")||!this._map._draggableMoved(T))&&(b=T);this._fireEvent(b?[b]:!1,l)},_onMouseMove:function(l){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(l);this._handleMouseHover(l,d)}},_handleMouseOut:function(l){var d=this._hoveredLayer;d&&(jt(this._container,"leaflet-interactive"),this._fireEvent([d],l,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(l,d){if(!this._mouseHoverThrottled){for(var T,b,C=this._drawFirst;C;C=C.next)T=C.layer,T.options.interactive&&T._containsPoint(d)&&(b=T);b!==this._hoveredLayer&&(this._handleMouseOut(l),b&&(Oe(this._container,"leaflet-interactive"),this._fireEvent([b],l,"mouseover"),this._hoveredLayer=b)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,l),this._mouseHoverThrottled=!0,setTimeout(u(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(l,d,T){this._map._fireDOMEvent(d,T||d.type,l)},_bringToFront:function(l){var d=l._order;if(d){var T=d.next,b=d.prev;if(T)T.prev=b;else return;b?b.next=T:T&&(this._drawFirst=T),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(l)}},_bringToBack:function(l){var d=l._order;if(d){var T=d.next,b=d.prev;if(b)b.next=T;else return;T?T.prev=b:b&&(this._drawLast=b),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(l)}}});function ll(l){return Be.canvas?new fu(l):null}var Ar=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(l){return document.createElement("<lvml:"+l+' class="lvml">')}}catch{}return function(l){return document.createElement("<"+l+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Uc={_initContainer:function(){this._container=gt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(mi.prototype._update.call(this),this.fire("update"))},_initPath:function(l){var d=l._container=Ar("shape");Oe(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",l._path=Ar("path"),d.appendChild(l._path),this._updateStyle(l),this._layers[m(l)]=l},_addPath:function(l){var d=l._container;this._container.appendChild(d),l.options.interactive&&l.addInteractiveTarget(d)},_removePath:function(l){var d=l._container;Tt(d),l.removeInteractiveTarget(d),delete this._layers[m(l)]},_updateStyle:function(l){var d=l._stroke,T=l._fill,b=l.options,C=l._container;C.stroked=!!b.stroke,C.filled=!!b.fill,b.stroke?(d||(d=l._stroke=Ar("stroke")),C.appendChild(d),d.weight=b.weight+"px",d.color=b.color,d.opacity=b.opacity,b.dashArray?d.dashStyle=Q(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=b.lineCap.replace("butt","flat"),d.joinstyle=b.lineJoin):d&&(C.removeChild(d),l._stroke=null),b.fill?(T||(T=l._fill=Ar("fill")),C.appendChild(T),T.color=b.fillColor||b.color,T.opacity=b.fillOpacity):T&&(C.removeChild(T),l._fill=null)},_updateCircle:function(l){var d=l._point.round(),T=Math.round(l._radius),b=Math.round(l._radiusY||T);this._setPath(l,l._empty()?"M0 0":"AL "+d.x+","+d.y+" "+T+","+b+" 0,"+65535*360)},_setPath:function(l,d){l._path.v=d},_bringToFront:function(l){dn(l._container)},_bringToBack:function(l){Ii(l._container)}},Os=Be.vml?Ar:Vt,Zo=mi.extend({_initContainer:function(){this._container=Os("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Os("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Tt(this._container),Lt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){mi.prototype._update.call(this);var l=this._bounds,d=l.getSize(),T=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,T.setAttribute("width",d.x),T.setAttribute("height",d.y)),Kt(T,l.min),T.setAttribute("viewBox",[l.min.x,l.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(l){var d=l._path=Os("path");l.options.className&&Oe(d,l.options.className),l.options.interactive&&Oe(d,"leaflet-interactive"),this._updateStyle(l),this._layers[m(l)]=l},_addPath:function(l){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(l._path),l.addInteractiveTarget(l._path)},_removePath:function(l){Tt(l._path),l.removeInteractiveTarget(l._path),delete this._layers[m(l)]},_updatePath:function(l){l._project(),l._update()},_updateStyle:function(l){var d=l._path,T=l.options;d&&(T.stroke?(d.setAttribute("stroke",T.color),d.setAttribute("stroke-opacity",T.opacity),d.setAttribute("stroke-width",T.weight),d.setAttribute("stroke-linecap",T.lineCap),d.setAttribute("stroke-linejoin",T.lineJoin),T.dashArray?d.setAttribute("stroke-dasharray",T.dashArray):d.removeAttribute("stroke-dasharray"),T.dashOffset?d.setAttribute("stroke-dashoffset",T.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),T.fill?(d.setAttribute("fill",T.fillColor||T.color),d.setAttribute("fill-opacity",T.fillOpacity),d.setAttribute("fill-rule",T.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(l,d){this._setPath(l,yt(l._parts,d))},_updateCircle:function(l){var d=l._point,T=Math.max(Math.round(l._radius),1),b=Math.max(Math.round(l._radiusY),1)||T,C="a"+T+","+b+" 0 1,0 ",P=l._empty()?"M0 0":"M"+(d.x-T)+","+d.y+C+T*2+",0 "+C+-T*2+",0 ";this._setPath(l,P)},_setPath:function(l,d){l._path.setAttribute("d",d)},_bringToFront:function(l){dn(l._path)},_bringToBack:function(l){Ii(l._path)}});Be.vml&&Zo.include(Uc);function ul(l){return Be.svg||Be.vml?new Zo(l):null}mt.include({getRenderer:function(l){var d=l.options.renderer||this._getPaneRenderer(l.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(l){if(l==="overlayPane"||l===void 0)return!1;var d=this._paneRenderers[l];return d===void 0&&(d=this._createRenderer({pane:l}),this._paneRenderers[l]=d),d},_createRenderer:function(l){return this.options.preferCanvas&&ll(l)||ul(l)}});var Qr=qo.extend({initialize:function(l,d){qo.prototype.initialize.call(this,this._boundsToLatLngs(l),d)},setBounds:function(l){return this.setLatLngs(this._boundsToLatLngs(l))},_boundsToLatLngs:function(l){return l=le(l),[l.getSouthWest(),l.getNorthWest(),l.getNorthEast(),l.getSouthEast()]}});function Rp(l,d){return new Qr(l,d)}Zo.create=Os,Zo.pointsToPath=yt,er.geometryToLayer=$n,er.coordsToLatLng=lu,er.coordsToLatLngs=nl,er.latLngToCoords=uu,er.latLngsToCoords=il,er.getFeature=Er,er.asFeature=cu,mt.mergeOptions({boxZoom:!0});var pi=Ni.extend({initialize:function(l){this._map=l,this._container=l._container,this._pane=l._panes.overlayPane,this._resetStateTimeout=0,l.on("unload",this._destroy,this)},addHooks:function(){Xe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Lt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Tt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(l){if(!l.shiftKey||l.which!==1&&l.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Fi(),jr(),this._startPoint=this._map.mouseEventToContainerPoint(l),Xe(document,{contextmenu:ls,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(l){this._moved||(this._moved=!0,this._box=gt("div","leaflet-zoom-box",this._container),Oe(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(l);var d=new j(this._point,this._startPoint),T=d.getSize();Kt(this._box,d.min),this._box.style.width=T.x+"px",this._box.style.height=T.y+"px"},_finish:function(){this._moved&&(Tt(this._box),jt(this._container,"leaflet-crosshair")),kn(),gr(),Lt(document,{contextmenu:ls,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(l){if(!(l.which!==1&&l.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(u(this._resetState,this),0);var d=new Ie(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(l){l.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});mt.addInitHook("addHandler","boxZoom",pi),mt.mergeOptions({doubleClickZoom:!0});var mu=Ni.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(l){var d=this._map,T=d.getZoom(),b=d.options.zoomDelta,C=l.originalEvent.shiftKey?T-b:T+b;d.options.doubleClickZoom==="center"?d.setZoom(C):d.setZoomAround(l.containerPoint,C)}});mt.addInitHook("addHandler","doubleClickZoom",mu),mt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Us=Ni.extend({addHooks:function(){if(!this._draggable){var l=this._map;this._draggable=new hs(l._mapPane,l._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),l.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),l.on("zoomend",this._onZoomEnd,this),l.whenReady(this._onZoomEnd,this))}Oe(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){jt(this._map._container,"leaflet-grab"),jt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var l=this._map;if(l._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=le(this._map.options.maxBounds);this._offsetLimit=fe(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;l.fire("movestart").fire("dragstart"),l.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(l){if(this._map.options.inertia){var d=this._lastTime=+new Date,T=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(T),this._times.push(d),this._prunePositions(d)}this._map.fire("move",l).fire("drag",l)},_prunePositions:function(l){for(;this._positions.length>1&&l-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var l=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(l).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(l,d){return l-(l-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var l=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;l.x<d.min.x&&(l.x=this._viscousLimit(l.x,d.min.x)),l.y<d.min.y&&(l.y=this._viscousLimit(l.y,d.min.y)),l.x>d.max.x&&(l.x=this._viscousLimit(l.x,d.max.x)),l.y>d.max.y&&(l.y=this._viscousLimit(l.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(l)}},_onPreDragWrap:function(){var l=this._worldWidth,d=Math.round(l/2),T=this._initialWorldOffset,b=this._draggable._newPos.x,C=(b-d+T)%l+d-T,P=(b+d+T)%l-d-T,H=Math.abs(C+T)<Math.abs(P+T)?C:P;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=H},_onDragEnd:function(l){var d=this._map,T=d.options,b=!T.inertia||l.noInertia||this._times.length<2;if(d.fire("dragend",l),b)d.fire("moveend");else{this._prunePositions(+new Date);var C=this._lastPos.subtract(this._positions[0]),P=(this._lastTime-this._times[0])/1e3,H=T.easeLinearity,te=C.multiplyBy(H/P),ue=te.distanceTo([0,0]),xe=Math.min(T.inertiaMaxSpeed,ue),De=te.multiplyBy(xe/ue),Ke=xe/(T.inertiaDeceleration*H),ht=De.multiplyBy(-Ke/2).round();!ht.x&&!ht.y?d.fire("moveend"):(ht=d._limitOffset(ht,d.options.maxBounds),q(function(){d.panBy(ht,{duration:Ke,easeLinearity:H,noMoveStart:!0,animate:!0})}))}}});mt.addInitHook("addHandler","dragging",Us),mt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Bc=Ni.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(l){this._map=l,this._setPanDelta(l.options.keyboardPanDelta),this._setZoomDelta(l.options.zoomDelta)},addHooks:function(){var l=this._map._container;l.tabIndex<=0&&(l.tabIndex="0"),Xe(l,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Lt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var l=document.body,d=document.documentElement,T=l.scrollTop||d.scrollTop,b=l.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(b,T)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(l){var d=this._panKeys={},T=this.keyCodes,b,C;for(b=0,C=T.left.length;b<C;b++)d[T.left[b]]=[-1*l,0];for(b=0,C=T.right.length;b<C;b++)d[T.right[b]]=[l,0];for(b=0,C=T.down.length;b<C;b++)d[T.down[b]]=[0,l];for(b=0,C=T.up.length;b<C;b++)d[T.up[b]]=[0,-1*l]},_setZoomDelta:function(l){var d=this._zoomKeys={},T=this.keyCodes,b,C;for(b=0,C=T.zoomIn.length;b<C;b++)d[T.zoomIn[b]]=l;for(b=0,C=T.zoomOut.length;b<C;b++)d[T.zoomOut[b]]=-l},_addHooks:function(){Xe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Lt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(l){if(!(l.altKey||l.ctrlKey||l.metaKey)){var d=l.keyCode,T=this._map,b;if(d in this._panKeys){if(!T._panAnim||!T._panAnim._inProgress)if(b=this._panKeys[d],l.shiftKey&&(b=Me(b).multiplyBy(3)),T.options.maxBounds&&(b=T._limitOffset(Me(b),T.options.maxBounds)),T.options.worldCopyJump){var C=T.wrapLatLng(T.unproject(T.project(T.getCenter()).add(b)));T.panTo(C)}else T.panBy(b)}else if(d in this._zoomKeys)T.setZoom(T.getZoom()+(l.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&T._popup&&T._popup.options.closeOnEscapeKey)T.closePopup();else return;ls(l)}}});mt.addInitHook("addHandler","keyboard",Bc),mt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var cl=Ni.extend({addHooks:function(){Xe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Lt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(l){var d=Ln(l),T=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(l),this._startTime||(this._startTime=+new Date);var b=Math.max(T-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(u(this._performZoom,this),b),ls(l)},_performZoom:function(){var l=this._map,d=l.getZoom(),T=this._map.options.zoomSnap||0;l._stop();var b=this._delta/(this._map.options.wheelPxPerZoomLevel*4),C=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,P=T?Math.ceil(C/T)*T:C,H=l._limitZoom(d+(this._delta>0?P:-P))-d;this._delta=0,this._startTime=null,H&&(l.options.scrollWheelZoom==="center"?l.setZoom(d+H):l.setZoomAround(this._lastMousePos,d+H))}});mt.addInitHook("addHandler","scrollWheelZoom",cl);var $r=600;mt.mergeOptions({tapHold:Be.touchNative&&Be.safari&&Be.mobile,tapTolerance:15});var pu=Ni.extend({addHooks:function(){Xe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Lt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(l){if(clearTimeout(this._holdTimeout),l.touches.length===1){var d=l.touches[0];this._startPos=this._newPos=new Se(d.clientX,d.clientY),this._holdTimeout=setTimeout(u(function(){this._cancel(),this._isTapValid()&&(Xe(document,"touchend",hn),Xe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),$r),Xe(document,"touchend touchcancel contextmenu",this._cancel,this),Xe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function l(){Lt(document,"touchend",hn),Lt(document,"touchend touchcancel",l)},_cancel:function(){clearTimeout(this._holdTimeout),Lt(document,"touchend touchcancel contextmenu",this._cancel,this),Lt(document,"touchmove",this._onMove,this)},_onMove:function(l){var d=l.touches[0];this._newPos=new Se(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(l,d){var T=new MouseEvent(l,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});T._simulated=!0,d.target.dispatchEvent(T)}});mt.addInitHook("addHandler","tapHold",pu),mt.mergeOptions({touchZoom:Be.touch,bounceAtZoomLimits:!0});var zc=Ni.extend({addHooks:function(){Oe(this._map._container,"leaflet-touch-zoom"),Xe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){jt(this._map._container,"leaflet-touch-zoom"),Lt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(l){var d=this._map;if(!(!l.touches||l.touches.length!==2||d._animatingZoom||this._zooming)){var T=d.mouseEventToContainerPoint(l.touches[0]),b=d.mouseEventToContainerPoint(l.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(T.add(b)._divideBy(2))),this._startDist=T.distanceTo(b),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),Xe(document,"touchmove",this._onTouchMove,this),Xe(document,"touchend touchcancel",this._onTouchEnd,this),hn(l)}},_onTouchMove:function(l){if(!(!l.touches||l.touches.length!==2||!this._zooming)){var d=this._map,T=d.mouseEventToContainerPoint(l.touches[0]),b=d.mouseEventToContainerPoint(l.touches[1]),C=T.distanceTo(b)/this._startDist;if(this._zoom=d.getScaleZoom(C,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&C<1||this._zoom>d.getMaxZoom()&&C>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,C===1)return}else{var P=T._add(b)._divideBy(2)._subtract(this._centerPoint);if(C===1&&P.x===0&&P.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(P),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),K(this._animRequest);var H=u(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=q(H,this,!0),hn(l)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,K(this._animRequest),Lt(document,"touchmove",this._onTouchMove,this),Lt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});mt.addInitHook("addHandler","touchZoom",zc),mt.BoxZoom=pi,mt.DoubleClickZoom=mu,mt.Drag=Us,mt.Keyboard=Bc,mt.ScrollWheelZoom=cl,mt.TapHold=pu,mt.TouchZoom=zc,t.Bounds=j,t.Browser=Be,t.CRS=He,t.Canvas=fu,t.Circle=au,t.CircleMarker=Fo,t.Class=qe,t.Control=Wn,t.DivIcon=Mh,t.DivOverlay=Xn,t.DomEvent=Ds,t.DomUtil=yr,t.Draggable=hs,t.Evented=be,t.FeatureGroup=ks,t.GeoJSON=er,t.GridLayer=Ko,t.Handler=Ni,t.Icon=Ls,t.ImageOverlay=Ho,t.LatLng=ge,t.LatLngBounds=Ie,t.Layer=ms,t.LayerGroup=zo,t.LineUtil=Gi,t.Map=mt,t.Marker=tl,t.Mixin=ru,t.Path=Vs,t.Point=Se,t.PolyUtil=xr,t.Polygon=qo,t.Polyline=Xs,t.Popup=rl,t.PosAnimation=Ws,t.Projection=fs,t.Rectangle=Qr,t.Renderer=mi,t.SVG=Zo,t.SVGOverlay=hu,t.TileLayer=br,t.Tooltip=ol,t.Transformation=vt,t.Util=F,t.VideoOverlay=Sr,t.bind=u,t.bounds=fe,t.canvas=ll,t.circle=Ih,t.circleMarker=Ah,t.control=fi,t.divIcon=Np,t.extend=r,t.featureGroup=Sh,t.geoJSON=du,t.geoJson=sl,t.gridLayer=Ph,t.icon=$a,t.imageOverlay=Ch,t.latLng=Ae,t.latLngBounds=le,t.layerGroup=bp,t.map=Tr,t.marker=bh,t.point=Me,t.polygon=Ip,t.polyline=Ap,t.popup=Rh,t.rectangle=Rp,t.setOptions=z,t.stamp=m,t.svg=ul,t.svgOverlay=Nh,t.tileLayer=ji,t.tooltip=Cp,t.transformation=nt,t.version=i,t.videoOverlay=jo;var Fc=window.L;t.noConflict=function(){return window.L=Fc,this},window.L=t}))})(Rd,Rd.exports)),Rd.exports}var Ac=KL();const Ql=Cy(Ac);function jm(n,e,t){return Object.freeze({instance:n,context:e,container:t})}function Km(n,e){return e==null?function(i,r){const a=W.useRef(void 0);return a.current||(a.current=n(i,r)),a}:function(i,r){const a=W.useRef(void 0);a.current||(a.current=n(i,r));const u=W.useRef(i),{instance:f}=a.current;return W.useEffect(function(){u.current!==i&&(e(f,i,u.current),u.current=i)},[f,i,e]),a}}function L1(n,e){W.useEffect(function(){return(e.layerContainer??e.map).addLayer(n.instance),function(){var a;(a=e.layerContainer)==null||a.removeLayer(n.instance),e.map.removeLayer(n.instance)}},[e,n])}function V1(n){return function(t){const i=Gm(),r=n(Hm(t,i),i);return P1(i.map,t.attribution),Gy(r.current,t.eventHandlers),L1(r.current,i),r}}function ZL(n,e){const t=W.useRef(void 0);W.useEffect(function(){if(e.pathOptions!==t.current){const r=e.pathOptions??{};n.instance.setStyle(r),t.current=r}},[n,e])}function JL(n){return function(t){const i=Gm(),r=n(Hm(t,i),i);return Gy(r.current,t.eventHandlers),L1(r.current,i),ZL(r.current,t),r}}function YL(n,e){const t=Km(n,e),i=V1(t);return k1(i)}function WL(n,e){const t=Km(n),i=HL(t,e);return qL(i)}function QL(n,e){const t=Km(n,e),i=JL(t);return k1(i)}function $L(n,e){const t=Km(n,e),i=V1(t);return GL(i)}function XL(n,e,t){const{opacity:i,zIndex:r}=e;i!=null&&i!==t.opacity&&n.setOpacity(i),r!=null&&r!==t.zIndex&&n.setZIndex(r)}function Zm(){return Gm().map}function e4({bounds:n,boundsOptions:e,center:t,children:i,className:r,id:a,placeholder:u,style:f,whenReady:m,zoom:p,...E},S){const[A]=W.useState({className:r,id:a,style:f}),[R,V]=W.useState(null),z=W.useRef(void 0);W.useImperativeHandle(S,()=>(R==null?void 0:R.map)??null,[R]);const Z=W.useCallback(ne=>{if(ne!==null&&!z.current){const Q=new Ac.Map(ne,E);z.current=Q,t!=null&&p!=null?Q.setView(t,p):n!=null&&Q.fitBounds(n,e),m!=null&&Q.whenReady(m),V(FL(Q))}},[]);W.useEffect(()=>()=>{R==null||R.map.remove()},[R]);const X=R?Wd.createElement(qy,{value:R},i):u??null;return Wd.createElement("div",{...A,ref:Z},X)}const O1=W.forwardRef(e4),Hy=YL(function({position:e,...t},i){const r=new Ac.Marker(e,t);return jm(r,D1(i,{overlayContainer:r}))},function(e,t,i){t.position!==i.position&&e.setLatLng(t.position),t.icon!=null&&t.icon!==i.icon&&e.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==i.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==i.opacity&&e.setOpacity(t.opacity),e.dragging!=null&&t.draggable!==i.draggable&&(t.draggable===!0?e.dragging.enable():e.dragging.disable())}),t4=QL(function({positions:e,...t},i){const r=new Ac.Polyline(e,t);return jm(r,D1(i,{overlayContainer:r}))},function(e,t,i){t.positions!==i.positions&&e.setLatLngs(t.positions)}),jy=WL(function(e,t){const i=new Ac.Popup(e,t.overlayContainer);return jm(i,t)},function(e,t,{position:i},r){W.useEffect(function(){const{instance:u}=e;function f(p){p.popup===u&&(u.update(),r(!0))}function m(p){p.popup===u&&r(!1)}return t.map.on({popupopen:f,popupclose:m}),t.overlayContainer==null?(i!=null&&u.setLatLng(i),u.openOn(t.map)):t.overlayContainer.bindPopup(u),function(){var E;t.map.off({popupopen:f,popupclose:m}),(E=t.overlayContainer)==null||E.unbindPopup(),t.map.removeLayer(u)}},[e,t,r,i])}),U1=$L(function({url:e,...t},i){const r=new Ac.TileLayer(e,Hm(t,i));return jm(r,i)},function(e,t,i){XL(e,t,i);const{url:r}=t;r!=null&&r!==i.url&&e.setUrl(r)}),n4={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var Lw={};const i4=()=>{try{if(typeof import.meta<"u"&&n4)return"";if(typeof process<"u"&&Lw)return Lw.VITE_API_KEY||""}catch(n){console.warn("Failed to access API key",n)}return""},f_=i4(),s4="AIzaSyC2SRWVViygm5tBgGQeGgFEq9_jK_PdT_0",r4=n=>{var e,t,i,r;if(typeof n.text=="string")return n.text;if(typeof n.text=="function")return n.text();if(n.candidates&&((r=(i=(t=(e=n.candidates[0])==null?void 0:e.content)==null?void 0:t.parts)==null?void 0:i[0])!=null&&r.text))return n.candidates[0].content.parts[0].text;throw new Error("No text found in AI response")},Vw={1:{lat:25.033,lng:121.5654},"taipei 101":{lat:25.033,lng:121.5654},2:{lat:25.0421,lng:121.5082},3:{lat:25.1024,lng:121.5486},test:{lat:25.033,lng:121.5654},kyoto:{lat:35.0116,lng:135.7681},osaka:{lat:34.6937,lng:135.5023},tokyo:{lat:35.6762,lng:139.6503},:{lat:26.2048,lng:127.6458}," () check in":{lat:26.2048,lng:127.6458},:{lat:26.2048,lng:127.6458},"  ":{lat:26.196,lng:127.665},:{lat:26.196,lng:127.665},:{lat:26.196,lng:127.665},:{lat:26.2206,lng:127.6711},:{lat:26.1308,lng:127.7739},:{lat:26.3164,lng:127.7577},:{lat:26.695,lng:128.022},:{lat:26.6942,lng:127.8779},:{lat:26.505,lng:127.8512},:{lat:26.215,lng:127.685},"tokyo tower":{lat:35.6586,lng:139.7454},:{lat:35.6586,lng:139.7454}},Od=async(n,e)=>{const t=n.toLowerCase().trim();if(Vw[t])return console.log(`Using Test Location for: ${n}`),Vw[t];const i=async S=>{if(!S)return null;try{const R=await new T1({apiKey:S}).models.generateContent({model:"gemini-2.5-flash-lite",contents:`Convert this address to latitude and longitude coordinates: "${n}". 
                
                IMPORTANT: Return ONLY a JSON object in this exact format:
                {"lat": 25.0330, "lng": 121.5654}
                
                Do not include any explanations, just the JSON object.`,config:{responseMimeType:"application/json"}}),V=r4(R),z=JSON.parse(V);if(z.lat&&z.lng)return{lat:parseFloat(z.lat),lng:parseFloat(z.lng)}}catch(A){return console.warn(`Geocoding failed with key ${S.substring(0,5)}...`,A),null}return null},r=async S=>{if(!S)return null;try{console.log(`Trying Google Maps Geocoding API with key ${S.substring(0,5)}...`);const A=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(n)}&key=${S}`,V=await(await fetch(A)).json();if(V.status==="OK"&&V.results&&V.results.length>0){const z=V.results[0].geometry.location;return{lat:z.lat,lng:z.lng}}else console.warn("Google Maps Geocoding API error:",V.status,V.error_message),typeof window<"u"&&window.localStorage.setItem("last_geocode_error",`${V.status}: ${V.error_message||"Unknown error"}`)}catch(A){console.warn("Google Maps Geocoding API request failed:",A),typeof window<"u"&&window.localStorage.setItem("last_geocode_error",`Network Error: ${A}`)}return null},a=S=>S.split(/|\/|\|/).map(R=>R.trim()).filter(R=>R).map(R=>R.replace(/\(.*\)|.*/g,"").trim()).filter(R=>R.length>0),u=async(S,A={},R=5e3)=>{const V=new AbortController,z=setTimeout(()=>V.abort(),R);try{const Z=await fetch(S,{...A,signal:V.signal});return clearTimeout(z),Z}catch(Z){throw clearTimeout(z),Z}},f=async S=>{try{console.log(`[Geocoding] Trying Nominatim for: ${S}`);const A=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(S)}&limit=1`,{headers:{"User-Agent":"NomadAI-Travel-Journal/1.0"}});if(!A.ok)return console.warn(`[Geocoding] Nominatim request failed: ${A.status}`),null;const R=await A.json();if(console.log("[Geocoding] Nominatim response:",R),R&&R.length>0){const V=parseFloat(R[0].lat),z=parseFloat(R[0].lon);return console.log("[Geocoding] Nominatim success:",{lat:V,lng:z}),{lat:V,lng:z}}return null}catch(A){return console.error("Nominatim geocoding error:",A),null}},m=async S=>{try{console.log(`Trying Open-Meteo Geocoding for: "${S}"...`);const A=`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(S)}&count=1&language=zh&format=json`,R=await u(A);if(!R.ok)throw new Error(`Open-Meteo status: ${R.status}`);const V=await R.json();if(V&&V.results&&V.results.length>0){const z=V.results[0];return{lat:z.latitude,lng:z.longitude}}}catch(A){console.warn(`Open-Meteo failed for "${S}":`,A)}return null},p=[n,...a(n)],E=Array.from(new Set(p));console.log("Geocoding candidates:",E);for(const S of E){if(e){let V=await i(e);if(V||(V=await r(e),V))return V}if(f_){let V=await i(f_);if(V||(V=await r(f_),V))return V}{const V=await i(s4);if(V)return V}const A=await f(S);if(A)return A;const R=await m(S);if(R)return R}return null},o4=Object.freeze(Object.defineProperty({__proto__:null,geocodeAddress:Od},Symbol.toStringTag,{value:"Module"})),B1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",z1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";let a4=Ql.icon({iconUrl:B1,shadowUrl:z1,iconSize:[25,41],iconAnchor:[12,41]});Ql.Marker.prototype.options.icon=a4;const l4=({bounds:n,isMapReady:e})=>{const t=Zm();return W.useEffect(()=>{e&&n&&n.length>0&&setTimeout(()=>{t.fitBounds(n,{padding:[80,80]})},100)},[n,t,e]),null},u4=({onReady:n})=>{const e=Zm();return W.useEffect(()=>{const t=setTimeout(()=>{e.invalidateSize(),n()},250);return()=>clearTimeout(t)},[e,n]),null},c4=({selectedLocation:n,searchedLocation:e,isMapReady:t})=>{const i=Zm();return W.useEffect(()=>{t&&(e?i.flyTo([e.lat,e.lng],16,{animate:!0,duration:1.5}):n&&i.flyTo([n.lat,n.lng],16,{animate:!0,duration:1.5}))},[n,e,i,t]),null},d4=({item:n,index:e,isSelected:t,color:i,onClick:r})=>{var m,p;const a=Wd.useRef(null);W.useEffect(()=>{t&&a.current&&a.current.openPopup()},[t]);const u=((m=n.coordinates)==null?void 0:m.lat)||n.lat,f=((p=n.coordinates)==null?void 0:p.lng)||n.lng;return!u||!f?null:v.jsx(Hy,{ref:a,position:[u,f],icon:Ql.divIcon({className:"custom-div-icon",html:`<div style="background-color: ${t?"#C5A059":i}; width: ${t?"32px":"24px"}; height: ${t?"32px":"24px"}; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: ${t?"14px":"12px"}; transition: all 0.3s ease;">${e+1}</div>`,iconSize:[t?32:24,t?32:24],iconAnchor:[t?16:12,t?16:12]}),eventHandlers:{click:r},children:v.jsx(jy,{children:v.jsxs("div",{className:"text-center",children:[v.jsxs("div",{className:"font-bold text-ink",children:[e+1,". ",n.activity]}),v.jsx("div",{className:"text-xs text-gray-500",children:n.time}),v.jsxs("div",{className:"text-xs text-coral mt-1",children:["Day ",n.day]})]})})})},h4=({trip:n,settings:e,onUpdateTrip:t,searchedLocation:i,onItemClick:r,mapSearchQuery:a})=>{on[e.language]||on["zh-TW"];const[u,f]=W.useState(null),[m,p]=W.useState(new Set),[E,S]=W.useState("ALL"),[A,R]=W.useState(null),[V,z]=W.useState(!1),Z=W.useMemo(()=>{const Y=n.itinerary||[];return E==="ALL"?Y:Y.filter(D=>D.day===E)},[n.itinerary,E]),X=W.useMemo(()=>{const Y={};return(n.itinerary||[]).forEach(D=>{Y[D.day]||(Y[D.day]=[]),Y[D.day].push(D)}),Object.keys(Y).forEach(D=>{Y[Number(D)].sort((B,O)=>B.time.localeCompare(O.time))}),Y},[n.itinerary]),ne=W.useMemo(()=>Object.keys(X).map(Number).sort((Y,D)=>Y-D),[X]),Q=["#FF5733","#33FF57","#3357FF","#FF33F5","#33FFF5","#F5FF33"],pe=W.useMemo(()=>{const Y=Z.filter(D=>D.coordinates||D.lat&&D.lng).map(D=>{var B,O;return[((B=D.coordinates)==null?void 0:B.lat)||D.lat,((O=D.coordinates)==null?void 0:O.lng)||D.lng]});return Y.length===0?null:Y},[Z]),he=W.useMemo(()=>{var D,B,O;if(!A)return null;const Y=(D=n.itinerary)==null?void 0:D.find(G=>G.id===A);return Y&&(Y.coordinates||Y.lat&&Y.lng)?{lat:((B=Y.coordinates)==null?void 0:B.lat)||Y.lat,lng:((O=Y.coordinates)==null?void 0:O.lng)||Y.lng}:null},[A,n.itinerary]);return W.useEffect(()=>{if(n.itinerary&&n.itinerary.length>0){const Y=Array.from(new Set(n.itinerary.map(D=>Number(D.day)))).sort((D,B)=>D-B);if(Y.length>0){const D=Y[0],B=n.itinerary.filter(O=>O.day===D).sort((O,G)=>O.time.localeCompare(G.time));if(B.length>0){const O=B[0];if(R(O.id),S(D),r){const G=O.location||O.activity;G&&setTimeout(()=>r(G),500)}}}}},[n.id]),W.useEffect(()=>{window.localStorage.removeItem("last_geocode_error")},[n.id]),v.jsxs("div",{className:"h-full flex flex-col pb-24",children:[v.jsxs("div",{className:"mb-4 flex gap-2 overflow-x-auto no-scrollbar py-1 shrink-0",children:[v.jsx("button",{onClick:()=>{S("ALL"),R(null)},className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${E==="ALL"?"bg-ink text-white":"bg-white text-gray-500 border border-sand"}`,children:"ALL"}),ne.map(Y=>v.jsxs("button",{onClick:()=>{S(Y),R(null)},className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${E===Y?"bg-coral text-white":"bg-white text-gray-500 border border-sand"}`,children:["Day ",Y]},Y))]}),v.jsx("div",{className:"h-[35vh] shrink-0 bg-gray-100 rounded-3xl overflow-hidden shadow-inner border border-sand relative z-0 mb-4",children:v.jsxs(O1,{center:[25.033,121.5654],zoom:13,style:{height:"100%",width:"100%"},children:[v.jsx(U1,{attribution:' <a href="https://www.google.com/maps">Google Maps</a>',url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"}),v.jsx(u4,{onReady:()=>z(!0)}),pe&&!he&&!i&&v.jsx(l4,{bounds:pe,isMapReady:V}),v.jsx(c4,{selectedLocation:he,searchedLocation:i,isMapReady:V}),i&&(()=>{const Y=Z.findIndex(G=>{var q,K;return((q=G.coordinates)==null?void 0:q.lat)===i.lat&&((K=G.coordinates)==null?void 0:K.lng)===i.lng||G.location===a||G.activity===a}),D=Y!==-1?Z[Y]:null;if(D&&D.coordinates)return null;const B=Y!==-1?Y+1:"?",O=D?Q[(D.day-1)%Q.length]:"#FF0000";return v.jsx(Hy,{position:[i.lat,i.lng],icon:Ql.divIcon({className:"custom-div-icon",html:`<div style="background-color: ${O}; width: 32px; height: 32px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 16px;">${B}</div>`,iconSize:[32,32],iconAnchor:[16,16]}),children:v.jsx(jy,{children:v.jsx("div",{className:"text-center font-bold",children:"Searched Location"})})})})(),Z.map((Y,D)=>v.jsx(d4,{item:Y,index:D,isSelected:A===Y.id,color:Q[(Y.day-1)%Q.length],onClick:()=>R(Y.id)},Y.id||D)),ne.map((Y,D)=>{if(E!=="ALL"&&E!==Y)return null;const O=X[Y].filter(G=>{var q,K;return(((q=G.coordinates)==null?void 0:q.lat)||G.lat)&&(((K=G.coordinates)==null?void 0:K.lng)||G.lng)}).map(G=>{var q,K;return[((q=G.coordinates)==null?void 0:q.lat)||G.lat,((K=G.coordinates)==null?void 0:K.lng)||G.lng]});return O.length<2?null:v.jsx(t4,{positions:O,color:Q[D%Q.length],weight:4,opacity:.7,dashArray:"10, 10"},Y)})]})}),v.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-3 px-1",children:Z.map((Y,D)=>{var q,K;const B=(((q=Y.coordinates)==null?void 0:q.lat)||Y.lat)&&(((K=Y.coordinates)==null?void 0:K.lng)||Y.lng),O=u===Y.id||u==="BATCH"&&!B,G=m.has(Y.id);return v.jsxs("div",{onClick:async()=>{if(R(Y.id),S(Y.day),r){const F=Y.location||Y.activity;F&&r(F)}if(!B&&!u){if(f(Y.id),m.has(Y.id)){const F=new Set(m);F.delete(Y.id),p(F)}console.log(`[TripMap] Starting geocode for item: ${Y.activity}`);try{let F=Y.location,qe=null;if(F&&(console.log(`[TripMap] Trying location: ${F}`),qe=await Od(F,e.apiKey)),qe||(console.log(`[TripMap] Location failed or empty, trying activity: ${Y.activity}`),qe=await Od(Y.activity,e.apiKey)),!qe){const Je=Y.activity.split(/[\(]/)[0].split(/|\/|\|/)[0].trim();Je&&Je!==Y.activity&&(console.log(`[TripMap] Activity failed, trying simplified: ${Je}`),qe=await Od(Je,e.apiKey))}if(console.log("[TripMap] Final geocode result:",qe),qe&&t){const Je=[...n.itinerary||[]],ie=Je.findIndex(be=>be.id===Y.id);ie!==-1&&(console.log(`[TripMap] Updating item ${ie} with coords`,qe),Je[ie]={...Je[ie],coordinates:qe,lat:qe.lat,lng:qe.lng},t({...n,itinerary:Je}),console.log("[TripMap] onUpdateTrip called"))}else console.warn(`[TripMap] No coords found for item ${Y.id}`),p(Je=>new Set(Je).add(Y.id))}catch(F){console.error("On-demand geocoding failed",F),p(qe=>new Set(qe).add(Y.id))}finally{f(null)}}},className:`p-4 rounded-2xl border transition-all cursor-pointer flex items-center gap-4 ${A===Y.id?"bg-coral/10 border-coral shadow-md":"bg-white border-sand hover:border-coral/50"}`,children:[v.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold shrink-0 relative",style:{backgroundColor:Q[(Y.day-1)%Q.length]},children:O&&!B?v.jsx("div",{className:"absolute inset-0 border-2 border-white border-t-transparent rounded-full animate-spin"}):D+1}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsx("h3",{className:"font-bold text-ink truncate",children:Y.activity}),v.jsxs("span",{className:"text-xs font-bold text-coral bg-coral/10 px-2 py-0.5 rounded-full whitespace-nowrap",children:["Day ",Y.day]})]}),v.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[v.jsx("span",{className:"font-mono bg-gray-100 px-1.5 py-0.5 rounded",children:Y.time}),v.jsxs("span",{className:"truncate flex-1",children:[Y.location,O&&!B&&v.jsx("span",{className:"text-coral ml-1 text-[10px] animate-pulse",children:"..."}),G&&!B&&!O&&!(i&&(Y.location===a||Y.activity===a))&&v.jsx("span",{className:"text-red-500 ml-1 text-[10px]",children:""})]})]})]})]},Y.id||D)})})]})},f4=()=>{};var Ow={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},m4=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const a=n[t++];e[i++]=String.fromCharCode((r&31)<<6|a&63)}else if(r>239&&r<365){const a=n[t++],u=n[t++],f=n[t++],m=((r&7)<<18|(a&63)<<12|(u&63)<<6|f&63)-65536;e[i++]=String.fromCharCode(55296+(m>>10)),e[i++]=String.fromCharCode(56320+(m&1023))}else{const a=n[t++],u=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(a&63)<<6|u&63)}}return e.join("")},q1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const a=n[r],u=r+1<n.length,f=u?n[r+1]:0,m=r+2<n.length,p=m?n[r+2]:0,E=a>>2,S=(a&3)<<4|f>>4;let A=(f&15)<<2|p>>6,R=p&63;m||(R=64,u||(A=64)),i.push(t[E],t[S],t[A],t[R])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(F1(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):m4(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const a=t[n.charAt(r++)],f=r<n.length?t[n.charAt(r)]:0;++r;const p=r<n.length?t[n.charAt(r)]:64;++r;const S=r<n.length?t[n.charAt(r)]:64;if(++r,a==null||f==null||p==null||S==null)throw new p4;const A=a<<2|f>>4;if(i.push(A),p!==64){const R=f<<4&240|p>>2;if(i.push(R),S!==64){const V=p<<6&192|S;i.push(V)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class p4 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const g4=function(n){const e=F1(n);return q1.encodeByteArray(e,!0)},um=function(n){return g4(n).replace(/\./g,"")},G1=function(n){try{return q1.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=()=>H1().__FIREBASE_DEFAULTS__,y4=()=>{if(typeof process>"u"||typeof Ow>"u")return;const n=Ow.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},v4=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&G1(n[1]);return e&&JSON.parse(e)},Jm=()=>{try{return f4()||_4()||y4()||v4()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},j1=n=>{var e,t;return(t=(e=Jm())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},T4=n=>{const e=j1(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},K1=()=>{var n;return(n=Jm())==null?void 0:n.config},Z1=n=>{var e;return(e=Jm())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ic(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function J1(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E4(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[um(JSON.stringify(t)),um(JSON.stringify(u)),""].join(".")}const Ud={};function w4(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ud))Ud[e]?n.emulator.push(e):n.prod.push(e);return n}function S4(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Uw=!1;function Y1(n,e){if(typeof window>"u"||typeof document>"u"||!Ic(window.location.host)||Ud[n]===e||Ud[n]||Uw)return;Ud[n]=e;function t(A){return`__firebase__banner__${A}`}const i="__firebase__banner",a=w4().prod.length>0;function u(){const A=document.getElementById(i);A&&A.remove()}function f(A){A.style.display="flex",A.style.background="#7faaf0",A.style.position="fixed",A.style.bottom="5px",A.style.left="5px",A.style.padding=".5em",A.style.borderRadius="5px",A.style.alignItems="center"}function m(A,R){A.setAttribute("width","24"),A.setAttribute("id",R),A.setAttribute("height","24"),A.setAttribute("viewBox","0 0 24 24"),A.setAttribute("fill","none"),A.style.marginLeft="-6px"}function p(){const A=document.createElement("span");return A.style.cursor="pointer",A.style.marginLeft="16px",A.style.fontSize="24px",A.innerHTML=" &times;",A.onclick=()=>{Uw=!0,u()},A}function E(A,R){A.setAttribute("id",R),A.innerText="Learn more",A.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",A.setAttribute("target","__blank"),A.style.paddingLeft="5px",A.style.textDecoration="underline"}function S(){const A=S4(i),R=t("text"),V=document.getElementById(R)||document.createElement("span"),z=t("learnmore"),Z=document.getElementById(z)||document.createElement("a"),X=t("preprendIcon"),ne=document.getElementById(X)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(A.created){const Q=A.element;f(Q),E(Z,z);const pe=p();m(ne,X),Q.append(ne,V,Z,pe),document.body.appendChild(Q)}a?(V.innerText="Preview backend disconnected.",ne.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ne.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,V.innerText="Preview backend running in this workspace."),V.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",S):S()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function b4(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(jn())}function W1(){var e;const n=(e=Jm())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function A4(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function I4(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function C4(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function N4(){const n=jn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Q1(){return!W1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $1(){return!W1()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function X1(){try{return typeof indexedDB=="object"}catch{return!1}}function R4(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var a;e(((a=r.error)==null?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4="FirebaseError";class Io extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=M4,Object.setPrototypeOf(this,Io.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ch.prototype.create)}}class ch{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,a=this.errors[e],u=a?P4(a,i):"Error",f=`${this.serviceName}: ${u} (${r}).`;return new Io(r,f,i)}}function P4(n,e){return n.replace(D4,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const D4=/\{\$([^}]+)}/g;function k4(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ma(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const a=n[r],u=e[r];if(Bw(a)&&Bw(u)){if(!Ma(a,u))return!1}else if(a!==u)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function Bw(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dh(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function L4(n,e){const t=new V4(n,e);return t.subscribe.bind(t)}class V4{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");O4(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=m_),r.error===void 0&&(r.error=m_),r.complete===void 0&&(r.complete=m_);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function O4(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function m_(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(n){return n&&n._delegate?n._delegate:n}class Bl{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new x4;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(z4(e))try{this.getOrInitializeService({instanceIdentifier:wl})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:r});i.resolve(a)}catch{}}}}clearInstance(e=wl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wl){return this.instances.has(e)}getOptions(e=wl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[a,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(a);i===f&&u.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const a=this.instances.get(i);return a&&e(a,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:B4(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=wl){return this.component?this.component.multipleInstances?e:wl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function B4(n){return n===wl?void 0:n}function z4(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new U4(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ct;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ct||(Ct={}));const q4={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},G4=Ct.INFO,H4={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},j4=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=H4[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ky{constructor(e){this.name=e,this._logLevel=G4,this._logHandler=j4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?q4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...e),this._logHandler(this,Ct.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...e),this._logHandler(this,Ct.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...e),this._logHandler(this,Ct.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...e),this._logHandler(this,Ct.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...e),this._logHandler(this,Ct.ERROR,...e)}}const K4=(n,e)=>e.some(t=>n instanceof t);let zw,Fw;function Z4(){return zw||(zw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function J4(){return Fw||(Fw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eA=new WeakMap,q_=new WeakMap,tA=new WeakMap,p_=new WeakMap,Zy=new WeakMap;function Y4(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",a),n.removeEventListener("error",u)},a=()=>{t(Sa(n.result)),r()},u=()=>{i(n.error),r()};n.addEventListener("success",a),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&eA.set(t,n)}).catch(()=>{}),Zy.set(e,n),e}function W4(n){if(q_.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",u),n.removeEventListener("abort",u)},a=()=>{t(),r()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",a),n.addEventListener("error",u),n.addEventListener("abort",u)});q_.set(n,e)}let G_={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return q_.get(n);if(e==="objectStoreNames")return n.objectStoreNames||tA.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Sa(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Q4(n){G_=n(G_)}function $4(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(g_(this),e,...t);return tA.set(i,e.sort?e.sort():[e]),Sa(i)}:J4().includes(n)?function(...e){return n.apply(g_(this),e),Sa(eA.get(this))}:function(...e){return Sa(n.apply(g_(this),e))}}function X4(n){return typeof n=="function"?$4(n):(n instanceof IDBTransaction&&W4(n),K4(n,Z4())?new Proxy(n,G_):n)}function Sa(n){if(n instanceof IDBRequest)return Y4(n);if(p_.has(n))return p_.get(n);const e=X4(n);return e!==n&&(p_.set(n,e),Zy.set(e,n)),e}const g_=n=>Zy.get(n);function e3(n,e,{blocked:t,upgrade:i,blocking:r,terminated:a}={}){const u=indexedDB.open(n,e),f=Sa(u);return i&&u.addEventListener("upgradeneeded",m=>{i(Sa(u.result),m.oldVersion,m.newVersion,Sa(u.transaction),m)}),t&&u.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{a&&m.addEventListener("close",()=>a()),r&&m.addEventListener("versionchange",p=>r(p.oldVersion,p.newVersion,p))}).catch(()=>{}),f}const t3=["get","getKey","getAll","getAllKeys","count"],n3=["put","add","delete","clear"],__=new Map;function qw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(__.get(e))return __.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=n3.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||t3.includes(t)))return;const a=async function(u,...f){const m=this.transaction(u,r?"readwrite":"readonly");let p=m.store;return i&&(p=p.index(f.shift())),(await Promise.all([p[t](...f),r&&m.done]))[0]};return __.set(e,a),a}Q4(n=>({...n,get:(e,t,i)=>qw(e,t)||n.get(e,t,i),has:(e,t)=>!!qw(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(s3(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function s3(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const H_="@firebase/app",Gw="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=new Ky("@firebase/app"),r3="@firebase/app-compat",o3="@firebase/analytics-compat",a3="@firebase/analytics",l3="@firebase/app-check-compat",u3="@firebase/app-check",c3="@firebase/auth",d3="@firebase/auth-compat",h3="@firebase/database",f3="@firebase/data-connect",m3="@firebase/database-compat",p3="@firebase/functions",g3="@firebase/functions-compat",_3="@firebase/installations",y3="@firebase/installations-compat",v3="@firebase/messaging",T3="@firebase/messaging-compat",x3="@firebase/performance",E3="@firebase/performance-compat",w3="@firebase/remote-config",S3="@firebase/remote-config-compat",b3="@firebase/storage",A3="@firebase/storage-compat",I3="@firebase/firestore",C3="@firebase/ai",N3="@firebase/firestore-compat",R3="firebase",M3="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j_="[DEFAULT]",P3={[H_]:"fire-core",[r3]:"fire-core-compat",[a3]:"fire-analytics",[o3]:"fire-analytics-compat",[u3]:"fire-app-check",[l3]:"fire-app-check-compat",[c3]:"fire-auth",[d3]:"fire-auth-compat",[h3]:"fire-rtdb",[f3]:"fire-data-connect",[m3]:"fire-rtdb-compat",[p3]:"fire-fn",[g3]:"fire-fn-compat",[_3]:"fire-iid",[y3]:"fire-iid-compat",[v3]:"fire-fcm",[T3]:"fire-fcm-compat",[x3]:"fire-perf",[E3]:"fire-perf-compat",[w3]:"fire-rc",[S3]:"fire-rc-compat",[b3]:"fire-gcs",[A3]:"fire-gcs-compat",[I3]:"fire-fst",[N3]:"fire-fst-compat",[C3]:"fire-vertex","fire-js":"fire-js",[R3]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cm=new Map,D3=new Map,K_=new Map;function Hw(n,e){try{n.container.addComponent(e)}catch(t){To.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function sc(n){const e=n.name;if(K_.has(e))return To.debug(`There were multiple attempts to register component ${e}.`),!1;K_.set(e,n);for(const t of cm.values())Hw(t,n);for(const t of D3.values())Hw(t,n);return!0}function Jy(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function or(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ba=new ch("app","Firebase",k3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Bl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ba.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cc=M3;function nA(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:j_,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw ba.create("bad-app-name",{appName:String(r)});if(t||(t=K1()),!t)throw ba.create("no-options");const a=cm.get(r);if(a){if(Ma(t,a.options)&&Ma(i,a.config))return a;throw ba.create("duplicate-app",{appName:r})}const u=new F4(r);for(const m of K_.values())u.addComponent(m);const f=new L3(t,i,u);return cm.set(r,f),f}function iA(n=j_){const e=cm.get(n);if(!e&&n===j_&&K1())return nA();if(!e)throw ba.create("no-app",{appName:n});return e}function Aa(n,e,t){let i=P3[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),a=e.match(/\s|\//);if(r||a){const u=[`Unable to register library "${i}" with version "${e}":`];r&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),To.warn(u.join(" "));return}sc(new Bl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V3="firebase-heartbeat-database",O3=1,Qd="firebase-heartbeat-store";let y_=null;function sA(){return y_||(y_=e3(V3,O3,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Qd)}catch(t){console.warn(t)}}}}).catch(n=>{throw ba.create("idb-open",{originalErrorMessage:n.message})})),y_}async function U3(n){try{const t=(await sA()).transaction(Qd),i=await t.objectStore(Qd).get(rA(n));return await t.done,i}catch(e){if(e instanceof Io)To.warn(e.message);else{const t=ba.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});To.warn(t.message)}}}async function jw(n,e){try{const i=(await sA()).transaction(Qd,"readwrite");await i.objectStore(Qd).put(e,rA(n)),await i.done}catch(t){if(t instanceof Io)To.warn(t.message);else{const i=ba.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});To.warn(i.message)}}}function rA(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B3=1024,z3=30;class F3{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new G3(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Kw();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(u=>u.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:r}),this._heartbeatsCache.heartbeats.length>z3){const u=H3(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){To.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Kw(),{heartbeatsToSend:i,unsentEntries:r}=q3(this._heartbeatsCache.heartbeats),a=um(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return To.warn(t),""}}}function Kw(){return new Date().toISOString().substring(0,10)}function q3(n,e=B3){const t=[];let i=n.slice();for(const r of n){const a=t.find(u=>u.agent===r.agent);if(a){if(a.dates.push(r.date),Zw(t)>e){a.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Zw(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class G3{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return X1()?R4().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await U3(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return jw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return jw(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Zw(n){return um(JSON.stringify({version:2,heartbeats:n})).length}function H3(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j3(n){sc(new Bl("platform-logger",e=>new i3(e),"PRIVATE")),sc(new Bl("heartbeat",e=>new F3(e),"PRIVATE")),Aa(H_,Gw,n),Aa(H_,Gw,"esm2020"),Aa("fire-js","")}j3("");var K3="firebase",Z3="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Aa(K3,Z3,"app");function oA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const J3=oA,aA=new ch("auth","Firebase",oA());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dm=new Ky("@firebase/auth");function Y3(n,...e){dm.logLevel<=Ct.WARN&&dm.warn(`Auth (${Cc}): ${n}`,...e)}function Ff(n,...e){dm.logLevel<=Ct.ERROR&&dm.error(`Auth (${Cc}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Br(n,...e){throw Wy(n,...e)}function lr(n,...e){return Wy(n,...e)}function Yy(n,e,t){const i={...J3(),[e]:t};return new ch("auth","Firebase",i).create(e,{appName:n.name})}function Dl(n){return Yy(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function W3(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Br(n,"argument-error"),Yy(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Wy(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return aA.create(n,...e)}function rt(n,e,...t){if(!n)throw Wy(e,...t)}function po(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ff(e),new Error(e)}function xo(n,e){n||po(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z_(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function Q3(){return Jw()==="http:"||Jw()==="https:"}function Jw(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Q3()||I4()||"connection"in navigator)?navigator.onLine:!0}function X3(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hh{constructor(e,t){this.shortDelay=e,this.longDelay=t,xo(t>e,"Short delay should be less than long delay!"),this.isMobile=b4()||C4()}get(){return $3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(n,e){xo(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;po("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;po("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;po("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nV=new hh(3e4,6e4);function $y(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Nc(n,e,t,i,r={}){return uA(n,r,async()=>{let a={},u={};i&&(e==="GET"?u=i:a={body:JSON.stringify(i)});const f=dh({key:n.config.apiKey,...u}).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:m,...a};return A4()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Ic(n.emulatorConfig.host)&&(p.credentials="include"),lA.fetch()(await cA(n,n.config.apiHost,t,f),p)})}async function uA(n,e,t){n._canInitEmulator=!1;const i={...eV,...e};try{const r=new sV(n),a=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const u=await a.json();if("needConfirmation"in u)throw Rf(n,"account-exists-with-different-credential",u);if(a.ok&&!("errorMessage"in u))return u;{const f=a.ok?u.errorMessage:u.error.message,[m,p]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw Rf(n,"credential-already-in-use",u);if(m==="EMAIL_EXISTS")throw Rf(n,"email-already-in-use",u);if(m==="USER_DISABLED")throw Rf(n,"user-disabled",u);const E=i[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Yy(n,E,p);Br(n,E)}}catch(r){if(r instanceof Io)throw r;Br(n,"network-request-failed",{message:String(r)})}}async function iV(n,e,t,i,r={}){const a=await Nc(n,e,t,i,r);return"mfaPendingCredential"in a&&Br(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function cA(n,e,t,i){const r=`${e}${t}?${i}`,a=n,u=a.config.emulator?Qy(n.config,r):`${n.config.apiScheme}://${r}`;return tV.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(u).toString():u}class sV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(lr(this.auth,"network-request-failed")),nV.get())})}}function Rf(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=lr(n,e,i);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rV(n,e){return Nc(n,"POST","/v1/accounts:delete",e)}async function hm(n,e){return Nc(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bd(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oV(n,e=!1){const t=ii(n),i=await t.getIdToken(e),r=Xy(i);rt(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const a=typeof r.firebase=="object"?r.firebase:void 0,u=a==null?void 0:a.sign_in_provider;return{claims:r,token:i,authTime:Bd(v_(r.auth_time)),issuedAtTime:Bd(v_(r.iat)),expirationTime:Bd(v_(r.exp)),signInProvider:u||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function v_(n){return Number(n)*1e3}function Xy(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Ff("JWT malformed, contained fewer than 3 sections"),null;try{const r=G1(t);return r?JSON.parse(r):(Ff("Failed to decode base64 JWT payload"),null)}catch(r){return Ff("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function Yw(n){const e=Xy(n);return rt(e,"internal-error"),rt(typeof e.exp<"u","internal-error"),rt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $d(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Io&&aV(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function aV({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bd(this.lastLoginAt),this.creationTime=Bd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fm(n){var S;const e=n.auth,t=await n.getIdToken(),i=await $d(n,hm(e,{idToken:t}));rt(i==null?void 0:i.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const a=(S=r.providerUserInfo)!=null&&S.length?dA(r.providerUserInfo):[],u=cV(n.providerData,a),f=n.isAnonymous,m=!(n.email&&r.passwordHash)&&!(u!=null&&u.length),p=f?m:!1,E={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:u,metadata:new J_(r.createdAt,r.lastLoginAt),isAnonymous:p};Object.assign(n,E)}async function uV(n){const e=ii(n);await fm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function cV(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function dA(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dV(n,e){const t=await uA(n,{},async()=>{const i=dh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:a}=n.config,u=await cA(n,r,"/v1/token",`key=${a}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:i};return n.emulatorConfig&&Ic(n.emulatorConfig.host)&&(m.credentials="include"),lA.fetch()(u,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function hV(n,e){return Nc(n,"POST","/v2/accounts:revokeToken",$y(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){rt(e.idToken,"internal-error"),rt(typeof e.idToken<"u","internal-error"),rt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){rt(e.length!==0,"internal-error");const t=Yw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(rt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:a}=await dV(e,t);this.updateTokensAndExpiration(i,r,Number(a))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:a}=t,u=new Xu;return i&&(rt(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),r&&(rt(typeof r=="string","internal-error",{appName:e}),u.accessToken=r),a&&(rt(typeof a=="number","internal-error",{appName:e}),u.expirationTime=a),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Xu,this.toJSON())}_performRefresh(){return po("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fa(n,e){rt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ar{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new lV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new J_(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await $d(this,this.stsTokenManager.getToken(this.auth,e));return rt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return oV(this,e)}reload(){return uV(this)}_assign(e){this!==e&&(rt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ar({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){rt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await fm(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(or(this.auth.app))return Promise.reject(Dl(this.auth));const e=await this.getIdToken();return await $d(this,rV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,a=t.phoneNumber??void 0,u=t.photoURL??void 0,f=t.tenantId??void 0,m=t._redirectEventId??void 0,p=t.createdAt??void 0,E=t.lastLoginAt??void 0,{uid:S,emailVerified:A,isAnonymous:R,providerData:V,stsTokenManager:z}=t;rt(S&&z,e,"internal-error");const Z=Xu.fromJSON(this.name,z);rt(typeof S=="string",e,"internal-error"),fa(i,e.name),fa(r,e.name),rt(typeof A=="boolean",e,"internal-error"),rt(typeof R=="boolean",e,"internal-error"),fa(a,e.name),fa(u,e.name),fa(f,e.name),fa(m,e.name),fa(p,e.name),fa(E,e.name);const X=new ar({uid:S,auth:e,email:r,emailVerified:A,displayName:i,isAnonymous:R,photoURL:u,phoneNumber:a,tenantId:f,stsTokenManager:Z,createdAt:p,lastLoginAt:E});return V&&Array.isArray(V)&&(X.providerData=V.map(ne=>({...ne}))),m&&(X._redirectEventId=m),X}static async _fromIdTokenResponse(e,t,i=!1){const r=new Xu;r.updateFromServerResponse(t);const a=new ar({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await fm(a),a}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];rt(r.localId!==void 0,"internal-error");const a=r.providerUserInfo!==void 0?dA(r.providerUserInfo):[],u=!(r.email&&r.passwordHash)&&!(a!=null&&a.length),f=new Xu;f.updateFromIdToken(i);const m=new ar({uid:r.localId,auth:e,stsTokenManager:f,isAnonymous:u}),p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new J_(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(a!=null&&a.length)};return Object.assign(m,p),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ww=new Map;function go(n){xo(n instanceof Function,"Expected a class definition");let e=Ww.get(n);return e?(xo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Ww.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}hA.type="NONE";const Qw=hA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qf(n,e,t){return`firebase:${n}:${e}:${t}`}class ec{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:a}=this.auth;this.fullUserKey=qf(this.userKey,r.apiKey,a),this.fullPersistenceKey=qf("persistence",r.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await hm(this.auth,{idToken:e}).catch(()=>{});return t?ar._fromGetAccountInfoResponse(this.auth,t,e):null}return ar._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new ec(go(Qw),e,i);const r=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=r[0]||go(Qw);const u=qf(i,e.config.apiKey,e.name);let f=null;for(const p of t)try{const E=await p._get(u);if(E){let S;if(typeof E=="string"){const A=await hm(e,{idToken:E}).catch(()=>{});if(!A)break;S=await ar._fromGetAccountInfoResponse(e,A,E)}else S=ar._fromJSON(e,E);p!==a&&(f=S),a=p;break}}catch{}const m=r.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!m.length?new ec(a,e,i):(a=m[0],f&&await a._set(u,f.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(u)}catch{}})),new ec(a,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yA(e))return"Blackberry";if(vA(e))return"Webos";if(mA(e))return"Safari";if((e.includes("chrome/")||pA(e))&&!e.includes("edge/"))return"Chrome";if(_A(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function fA(n=jn()){return/firefox\//i.test(n)}function mA(n=jn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pA(n=jn()){return/crios\//i.test(n)}function gA(n=jn()){return/iemobile/i.test(n)}function _A(n=jn()){return/android/i.test(n)}function yA(n=jn()){return/blackberry/i.test(n)}function vA(n=jn()){return/webos/i.test(n)}function ev(n=jn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function fV(n=jn()){var e;return ev(n)&&!!((e=window.navigator)!=null&&e.standalone)}function mV(){return N4()&&document.documentMode===10}function TA(n=jn()){return ev(n)||_A(n)||vA(n)||yA(n)||/windows phone/i.test(n)||gA(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(n,e=[]){let t;switch(n){case"Browser":t=$w(jn());break;case"Worker":t=`${$w(jn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Cc}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=a=>new Promise((u,f)=>{try{const m=e(a);u(m)}catch(m){f(m)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gV(n,e={}){return Nc(n,"GET","/v2/passwordPolicy",$y(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _V=6;class yV{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??_V,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vV{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Xw(this),this.idTokenSubscription=new Xw(this),this.beforeStateQueue=new pV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=aA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=go(t)),this._initializationPromise=this.queue(async()=>{var i,r,a;if(!this._deleted&&(this.persistenceManager=await ec.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await hm(this,{idToken:e}),i=await ar._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(or(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(f,f))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(a=this.redirectUser)==null?void 0:a._redirectEventId,f=i==null?void 0:i._redirectEventId,m=await this.tryRedirectSignIn(e);(!u||u===f)&&(m!=null&&m.user)&&(i=m.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return rt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await fm(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=X3()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(or(this.app))return Promise.reject(Dl(this));const t=e?ii(e):null;return t&&rt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&rt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return or(this.app)?Promise.reject(Dl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return or(this.app)?Promise.reject(Dl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(go(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gV(this),t=new yV(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ch("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await hV(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&go(e)||this._popupRedirectResolver;rt(t,this,"argument-error"),this.redirectPersistenceManager=await ec.create(this,[go(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let u=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(rt(f,this,"internal-error"),f.then(()=>{u||a(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,i,r);return()=>{u=!0,m()}}else{const m=e.addObserver(t);return()=>{u=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return rt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(or(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&Y3(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ym(n){return ii(n)}class Xw{constructor(e){this.auth=e,this.observer=null,this.addObserver=L4(t=>this.observer=t)}get next(){return rt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function TV(n){tv=n}function xV(n){return tv.loadJS(n)}function EV(){return tv.gapiScript}function wV(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SV(n,e){const t=Jy(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),a=t.getOptions();if(Ma(a,e??{}))return r;Br(r,"already-initialized")}return t.initialize({options:e})}function bV(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(go);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function AV(n,e,t){const i=Ym(n);rt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,a=EA(e),{host:u,port:f}=IV(e),m=f===null?"":`:${f}`,p={url:`${a}//${u}${m}/`},E=Object.freeze({host:u,port:f,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){rt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),rt(Ma(p,i.config.emulator)&&Ma(E,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=E,i.settings.appVerificationDisabledForTesting=!0,Ic(u)?(J1(`${a}//${u}${m}`),Y1("Auth",!0)):CV()}function EA(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function IV(n){const e=EA(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const a=r[1];return{host:a,port:eS(i.substr(a.length+1))}}else{const[a,u]=i.split(":");return{host:a,port:eS(u)}}}function eS(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function CV(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return po("not implemented")}_getIdTokenResponse(e){return po("not implemented")}_linkToIdToken(e,t){return po("not implemented")}_getReauthenticationResolver(e){return po("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tc(n,e){return iV(n,"POST","/v1/accounts:signInWithIdp",$y(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NV="http://localhost";class zl extends wA{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new zl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Br("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...a}=t;if(!i||!r)return null;const u=new zl(i,r);return u.idToken=a.idToken||void 0,u.accessToken=a.accessToken||void 0,u.secret=a.secret,u.nonce=a.nonce,u.pendingToken=a.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return tc(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,tc(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,tc(e,t)}buildRequest(){const e={requestUri:NV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=dh(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh extends nv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a extends fh{constructor(){super("facebook.com")}static credential(e){return zl._fromParams({providerId:_a.PROVIDER_ID,signInMethod:_a.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _a.credentialFromTaggedObject(e)}static credentialFromError(e){return _a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _a.credential(e.oauthAccessToken)}catch{return null}}}_a.FACEBOOK_SIGN_IN_METHOD="facebook.com";_a.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo extends fh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return zl._fromParams({providerId:mo.PROVIDER_ID,signInMethod:mo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return mo.credentialFromTaggedObject(e)}static credentialFromError(e){return mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return mo.credential(t,i)}catch{return null}}}mo.GOOGLE_SIGN_IN_METHOD="google.com";mo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends fh{constructor(){super("github.com")}static credential(e){return zl._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ya.credential(e.oauthAccessToken)}catch{return null}}}ya.GITHUB_SIGN_IN_METHOD="github.com";ya.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va extends fh{constructor(){super("twitter.com")}static credential(e,t){return zl._fromParams({providerId:va.PROVIDER_ID,signInMethod:va.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return va.credentialFromTaggedObject(e)}static credentialFromError(e){return va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return va.credential(t,i)}catch{return null}}}va.TWITTER_SIGN_IN_METHOD="twitter.com";va.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const a=await ar._fromIdTokenResponse(e,i,r),u=tS(i);return new rc({user:a,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=tS(i);return new rc({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function tS(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mm extends Io{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,mm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new mm(e,t,i,r)}}function SA(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?mm._fromErrorAndOperation(n,a,e,i):a})}async function RV(n,e,t=!1){const i=await $d(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return rc._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MV(n,e,t=!1){const{auth:i}=n;if(or(i.app))return Promise.reject(Dl(i));const r="reauthenticate";try{const a=await $d(n,SA(i,r,e,n),t);rt(a.idToken,i,"internal-error");const u=Xy(a.idToken);rt(u,i,"internal-error");const{sub:f}=u;return rt(n.uid===f,i,"user-mismatch"),rc._forOperation(n,r,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Br(i,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PV(n,e,t=!1){if(or(n.app))return Promise.reject(Dl(n));const i="signIn",r=await SA(n,i,e),a=await rc._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(a.user),a}function DV(n,e,t,i){return ii(n).onIdTokenChanged(e,t,i)}function kV(n,e,t){return ii(n).beforeAuthStateChanged(e,t)}function LV(n,e,t,i){return ii(n).onAuthStateChanged(e,t,i)}function VV(n){return ii(n).signOut()}const pm="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(pm,"1"),this.storage.removeItem(pm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OV=1e3,UV=10;class AA extends bA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=TA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,f,m)=>{this.notifyListeners(u,m)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);mV()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,UV):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},OV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}AA.type="LOCAL";const BV=AA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA extends bA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}IA.type="SESSION";const CA=IA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zV(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Wm(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:a}=t.data,u=this.handlersMap[r];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const f=Array.from(u).map(async p=>p(t.origin,a)),m=await zV(f);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iv(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,u;return new Promise((f,m)=>{const p=iv("",20);r.port1.start();const E=setTimeout(()=>{m(new Error("unsupported_event"))},i);u={messageChannel:r,onMessage(S){const A=S;if(A.data.eventId===p)switch(A.data.status){case"ack":clearTimeout(E),a=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),f(A.data.response);break;default:clearTimeout(E),clearTimeout(a),m(new Error("invalid_response"));break}}},this.handlers.add(u),r.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[r.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(){return window}function qV(n){Vr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(){return typeof Vr().WorkerGlobalScope<"u"&&typeof Vr().importScripts=="function"}async function GV(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function HV(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function jV(){return NA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA="firebaseLocalStorageDb",KV=1,gm="firebaseLocalStorage",MA="fbase_key";class mh{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Qm(n,e){return n.transaction([gm],e?"readwrite":"readonly").objectStore(gm)}function ZV(){const n=indexedDB.deleteDatabase(RA);return new mh(n).toPromise()}function Y_(){const n=indexedDB.open(RA,KV);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(gm,{keyPath:MA})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(gm)?e(i):(i.close(),await ZV(),e(await Y_()))})})}async function nS(n,e,t){const i=Qm(n,!0).put({[MA]:e,value:t});return new mh(i).toPromise()}async function JV(n,e){const t=Qm(n,!1).get(e),i=await new mh(t).toPromise();return i===void 0?null:i.value}function iS(n,e){const t=Qm(n,!0).delete(e);return new mh(t).toPromise()}const YV=800,WV=3;class PA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Y_(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>WV)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return NA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wm._getInstance(jV()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await GV(),!this.activeServiceWorker)return;this.sender=new FV(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||HV()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Y_();return await nS(e,pm,"1"),await iS(e,pm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>nS(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>JV(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>iS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const a=Qm(r,!1).getAll();return new mh(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:a}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}PA.type="LOCAL";const QV=PA;new hh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DA(n,e){return e?go(e):(rt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv extends wA{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return tc(e,this._buildIdpRequest())}_linkToIdToken(e,t){return tc(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return tc(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $V(n){return PV(n.auth,new sv(n),n.bypassAuthState)}function XV(n){const{auth:e,user:t}=n;return rt(t,e,"internal-error"),MV(t,new sv(n),n.bypassAuthState)}async function e6(n){const{auth:e,user:t}=n;return rt(t,e,"internal-error"),RV(t,new sv(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e,t,i,r,a=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:a,error:u,type:f}=e;if(u){this.reject(u);return}const m={auth:this.auth,requestUri:t,sessionId:i,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $V;case"linkViaPopup":case"linkViaRedirect":return e6;case"reauthViaPopup":case"reauthViaRedirect":return XV;default:Br(this.auth,"internal-error")}}resolve(e){xo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t6=new hh(2e3,1e4);async function n6(n,e,t){if(or(n.app))return Promise.reject(lr(n,"operation-not-supported-in-this-environment"));const i=Ym(n);W3(n,e,nv);const r=DA(i,t);return new Ml(i,"signInViaPopup",e,r).executeNotNull()}class Ml extends kA{constructor(e,t,i,r,a){super(e,t,r,a),this.provider=i,this.authWindow=null,this.pollId=null,Ml.currentPopupAction&&Ml.currentPopupAction.cancel(),Ml.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return rt(e,this.auth,"internal-error"),e}async onExecution(){xo(this.filter.length===1,"Popup operations only handle one event");const e=iv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(lr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ml.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,t6.get())};e()}}Ml.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6="pendingRedirect",Gf=new Map;class s6 extends kA{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Gf.get(this.auth._key());if(!e){try{const i=await r6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Gf.set(this.auth._key(),e)}return this.bypassAuthState||Gf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function r6(n,e){const t=l6(e),i=a6(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function o6(n,e){Gf.set(n._key(),e)}function a6(n){return go(n._redirectPersistence)}function l6(n){return qf(i6,n.config.apiKey,n.name)}async function u6(n,e,t=!1){if(or(n.app))return Promise.reject(Dl(n));const i=Ym(n),r=DA(i,e),u=await new s6(i,r,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c6=600*1e3;class d6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!h6(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!LA(e)){const r=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(lr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=c6&&this.cachedEventUids.clear(),this.cachedEventUids.has(sS(e))}saveEventToCache(e){this.cachedEventUids.add(sS(e)),this.lastProcessedEventTime=Date.now()}}function sS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function LA({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function h6(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return LA(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f6(n,e={}){return Nc(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,p6=/^https?/;async function g6(n){if(n.config.emulator)return;const{authorizedDomains:e}=await f6(n);for(const t of e)try{if(_6(t))return}catch{}Br(n,"unauthorized-domain")}function _6(n){const e=Z_(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!p6.test(t))return!1;if(m6.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y6=new hh(3e4,6e4);function rS(){const n=Vr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function v6(n){return new Promise((e,t)=>{var r,a,u;function i(){rS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rS(),t(lr(n,"network-request-failed"))},timeout:y6.get()})}if((a=(r=Vr().gapi)==null?void 0:r.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((u=Vr().gapi)!=null&&u.load)i();else{const f=wV("iframefcb");return Vr()[f]=()=>{gapi.load?i():t(lr(n,"network-request-failed"))},xV(`${EV()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw Hf=null,e})}let Hf=null;function T6(n){return Hf=Hf||v6(n),Hf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x6=new hh(5e3,15e3),E6="__/auth/iframe",w6="emulator/auth/iframe",S6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},b6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function A6(n){const e=n.config;rt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qy(e,w6):`https://${n.config.authDomain}/${E6}`,i={apiKey:e.apiKey,appName:n.name,v:Cc},r=b6.get(n.config.apiHost);r&&(i.eid=r);const a=n._getFrameworks();return a.length&&(i.fw=a.join(",")),`${t}?${dh(i).slice(1)}`}async function I6(n){const e=await T6(n),t=Vr().gapi;return rt(t,n,"internal-error"),e.open({where:document.body,url:A6(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:S6,dontclear:!0},i=>new Promise(async(r,a)=>{await i.restyle({setHideOnLeave:!1});const u=lr(n,"network-request-failed"),f=Vr().setTimeout(()=>{a(u)},x6.get());function m(){Vr().clearTimeout(f),r(i)}i.ping(m).then(m,()=>{a(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},N6=500,R6=600,M6="_blank",P6="http://localhost";class oS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function D6(n,e,t,i=N6,r=R6){const a=Math.max((window.screen.availHeight-r)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const m={...C6,width:i.toString(),height:r.toString(),top:a,left:u},p=jn().toLowerCase();t&&(f=pA(p)?M6:t),fA(p)&&(e=e||P6,m.scrollbars="yes");const E=Object.entries(m).reduce((A,[R,V])=>`${A}${R}=${V},`,"");if(fV(p)&&f!=="_self")return k6(e||"",f),new oS(null);const S=window.open(e||"",f,E);rt(S,n,"popup-blocked");try{S.focus()}catch{}return new oS(S)}function k6(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L6="__/auth/handler",V6="emulator/auth/handler",O6=encodeURIComponent("fac");async function aS(n,e,t,i,r,a){rt(n.config.authDomain,n,"auth-domain-config-required"),rt(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Cc,eventId:r};if(e instanceof nv){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",k4(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[E,S]of Object.entries({}))u[E]=S}if(e instanceof fh){const E=e.getScopes().filter(S=>S!=="");E.length>0&&(u.scopes=E.join(","))}n.tenantId&&(u.tid=n.tenantId);const f=u;for(const E of Object.keys(f))f[E]===void 0&&delete f[E];const m=await n._getAppCheckToken(),p=m?`#${O6}=${encodeURIComponent(m)}`:"";return`${U6(n)}?${dh(f).slice(1)}${p}`}function U6({config:n}){return n.emulator?Qy(n,V6):`https://${n.authDomain}/${L6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_="webStorageSupport";class B6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=CA,this._completeRedirectFn=u6,this._overrideRedirectResult=o6}async _openPopup(e,t,i,r){var u;xo((u=this.eventManagers[e._key()])==null?void 0:u.manager,"_initialize() not called before _openPopup()");const a=await aS(e,t,i,Z_(),r);return D6(e,a,iv())}async _openRedirect(e,t,i,r){await this._originValidation(e);const a=await aS(e,t,i,Z_(),r);return qV(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:a}=this.eventManagers[t];return r?Promise.resolve(r):(xo(a,"If manager is not set, promise should be"),a)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await I6(e),i=new d6(e);return t.register("authEvent",r=>(rt(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(T_,{type:T_},r=>{var u;const a=(u=r==null?void 0:r[0])==null?void 0:u[T_];a!==void 0&&t(!!a),Br(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=g6(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return TA()||mA()||ev()}}const z6=B6;var lS="@firebase/auth",uS="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){rt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q6(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function G6(n){sc(new Bl("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:u,authDomain:f}=i.options;rt(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const m={apiKey:u,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xA(n)},p=new vV(i,r,a,m);return bV(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),sc(new Bl("auth-internal",e=>{const t=Ym(e.getProvider("auth").getImmediate());return(i=>new F6(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Aa(lS,uS,q6(n)),Aa(lS,uS,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6=300,j6=Z1("authIdTokenMaxAge")||H6;let cS=null;const K6=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>j6)return;const r=t==null?void 0:t.token;cS!==r&&(cS=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function Z6(n=iA()){const e=Jy(n,"auth");if(e.isInitialized())return e.getImmediate();const t=SV(n,{popupRedirectResolver:z6,persistence:[QV,BV,CA]}),i=Z1("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(i,location.origin);if(location.origin===a.origin){const u=K6(a.toString());kV(t,u,()=>u(t.currentUser)),DV(t,f=>u(f))}}const r=j1("auth");return r&&AV(t,`http://${r}`),t}function J6(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}TV({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const a=lr("internal-error");a.customData=r,t(a)},i.type="text/javascript",i.charset="UTF-8",J6().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});G6("Browser");var dS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ia,VA;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,B){function O(){}O.prototype=B.prototype,D.F=B.prototype,D.prototype=new O,D.prototype.constructor=D,D.D=function(G,q,K){for(var F=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)F[qe-2]=arguments[qe];return B.prototype[q].apply(G,F)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(D,B,O){O||(O=0);const G=Array(16);if(typeof B=="string")for(var q=0;q<16;++q)G[q]=B.charCodeAt(O++)|B.charCodeAt(O++)<<8|B.charCodeAt(O++)<<16|B.charCodeAt(O++)<<24;else for(q=0;q<16;++q)G[q]=B[O++]|B[O++]<<8|B[O++]<<16|B[O++]<<24;B=D.g[0],O=D.g[1],q=D.g[2];let K=D.g[3],F;F=B+(K^O&(q^K))+G[0]+3614090360&4294967295,B=O+(F<<7&4294967295|F>>>25),F=K+(q^B&(O^q))+G[1]+3905402710&4294967295,K=B+(F<<12&4294967295|F>>>20),F=q+(O^K&(B^O))+G[2]+606105819&4294967295,q=K+(F<<17&4294967295|F>>>15),F=O+(B^q&(K^B))+G[3]+3250441966&4294967295,O=q+(F<<22&4294967295|F>>>10),F=B+(K^O&(q^K))+G[4]+4118548399&4294967295,B=O+(F<<7&4294967295|F>>>25),F=K+(q^B&(O^q))+G[5]+1200080426&4294967295,K=B+(F<<12&4294967295|F>>>20),F=q+(O^K&(B^O))+G[6]+2821735955&4294967295,q=K+(F<<17&4294967295|F>>>15),F=O+(B^q&(K^B))+G[7]+4249261313&4294967295,O=q+(F<<22&4294967295|F>>>10),F=B+(K^O&(q^K))+G[8]+1770035416&4294967295,B=O+(F<<7&4294967295|F>>>25),F=K+(q^B&(O^q))+G[9]+2336552879&4294967295,K=B+(F<<12&4294967295|F>>>20),F=q+(O^K&(B^O))+G[10]+4294925233&4294967295,q=K+(F<<17&4294967295|F>>>15),F=O+(B^q&(K^B))+G[11]+2304563134&4294967295,O=q+(F<<22&4294967295|F>>>10),F=B+(K^O&(q^K))+G[12]+1804603682&4294967295,B=O+(F<<7&4294967295|F>>>25),F=K+(q^B&(O^q))+G[13]+4254626195&4294967295,K=B+(F<<12&4294967295|F>>>20),F=q+(O^K&(B^O))+G[14]+2792965006&4294967295,q=K+(F<<17&4294967295|F>>>15),F=O+(B^q&(K^B))+G[15]+1236535329&4294967295,O=q+(F<<22&4294967295|F>>>10),F=B+(q^K&(O^q))+G[1]+4129170786&4294967295,B=O+(F<<5&4294967295|F>>>27),F=K+(O^q&(B^O))+G[6]+3225465664&4294967295,K=B+(F<<9&4294967295|F>>>23),F=q+(B^O&(K^B))+G[11]+643717713&4294967295,q=K+(F<<14&4294967295|F>>>18),F=O+(K^B&(q^K))+G[0]+3921069994&4294967295,O=q+(F<<20&4294967295|F>>>12),F=B+(q^K&(O^q))+G[5]+3593408605&4294967295,B=O+(F<<5&4294967295|F>>>27),F=K+(O^q&(B^O))+G[10]+38016083&4294967295,K=B+(F<<9&4294967295|F>>>23),F=q+(B^O&(K^B))+G[15]+3634488961&4294967295,q=K+(F<<14&4294967295|F>>>18),F=O+(K^B&(q^K))+G[4]+3889429448&4294967295,O=q+(F<<20&4294967295|F>>>12),F=B+(q^K&(O^q))+G[9]+568446438&4294967295,B=O+(F<<5&4294967295|F>>>27),F=K+(O^q&(B^O))+G[14]+3275163606&4294967295,K=B+(F<<9&4294967295|F>>>23),F=q+(B^O&(K^B))+G[3]+4107603335&4294967295,q=K+(F<<14&4294967295|F>>>18),F=O+(K^B&(q^K))+G[8]+1163531501&4294967295,O=q+(F<<20&4294967295|F>>>12),F=B+(q^K&(O^q))+G[13]+2850285829&4294967295,B=O+(F<<5&4294967295|F>>>27),F=K+(O^q&(B^O))+G[2]+4243563512&4294967295,K=B+(F<<9&4294967295|F>>>23),F=q+(B^O&(K^B))+G[7]+1735328473&4294967295,q=K+(F<<14&4294967295|F>>>18),F=O+(K^B&(q^K))+G[12]+2368359562&4294967295,O=q+(F<<20&4294967295|F>>>12),F=B+(O^q^K)+G[5]+4294588738&4294967295,B=O+(F<<4&4294967295|F>>>28),F=K+(B^O^q)+G[8]+2272392833&4294967295,K=B+(F<<11&4294967295|F>>>21),F=q+(K^B^O)+G[11]+1839030562&4294967295,q=K+(F<<16&4294967295|F>>>16),F=O+(q^K^B)+G[14]+4259657740&4294967295,O=q+(F<<23&4294967295|F>>>9),F=B+(O^q^K)+G[1]+2763975236&4294967295,B=O+(F<<4&4294967295|F>>>28),F=K+(B^O^q)+G[4]+1272893353&4294967295,K=B+(F<<11&4294967295|F>>>21),F=q+(K^B^O)+G[7]+4139469664&4294967295,q=K+(F<<16&4294967295|F>>>16),F=O+(q^K^B)+G[10]+3200236656&4294967295,O=q+(F<<23&4294967295|F>>>9),F=B+(O^q^K)+G[13]+681279174&4294967295,B=O+(F<<4&4294967295|F>>>28),F=K+(B^O^q)+G[0]+3936430074&4294967295,K=B+(F<<11&4294967295|F>>>21),F=q+(K^B^O)+G[3]+3572445317&4294967295,q=K+(F<<16&4294967295|F>>>16),F=O+(q^K^B)+G[6]+76029189&4294967295,O=q+(F<<23&4294967295|F>>>9),F=B+(O^q^K)+G[9]+3654602809&4294967295,B=O+(F<<4&4294967295|F>>>28),F=K+(B^O^q)+G[12]+3873151461&4294967295,K=B+(F<<11&4294967295|F>>>21),F=q+(K^B^O)+G[15]+530742520&4294967295,q=K+(F<<16&4294967295|F>>>16),F=O+(q^K^B)+G[2]+3299628645&4294967295,O=q+(F<<23&4294967295|F>>>9),F=B+(q^(O|~K))+G[0]+4096336452&4294967295,B=O+(F<<6&4294967295|F>>>26),F=K+(O^(B|~q))+G[7]+1126891415&4294967295,K=B+(F<<10&4294967295|F>>>22),F=q+(B^(K|~O))+G[14]+2878612391&4294967295,q=K+(F<<15&4294967295|F>>>17),F=O+(K^(q|~B))+G[5]+4237533241&4294967295,O=q+(F<<21&4294967295|F>>>11),F=B+(q^(O|~K))+G[12]+1700485571&4294967295,B=O+(F<<6&4294967295|F>>>26),F=K+(O^(B|~q))+G[3]+2399980690&4294967295,K=B+(F<<10&4294967295|F>>>22),F=q+(B^(K|~O))+G[10]+4293915773&4294967295,q=K+(F<<15&4294967295|F>>>17),F=O+(K^(q|~B))+G[1]+2240044497&4294967295,O=q+(F<<21&4294967295|F>>>11),F=B+(q^(O|~K))+G[8]+1873313359&4294967295,B=O+(F<<6&4294967295|F>>>26),F=K+(O^(B|~q))+G[15]+4264355552&4294967295,K=B+(F<<10&4294967295|F>>>22),F=q+(B^(K|~O))+G[6]+2734768916&4294967295,q=K+(F<<15&4294967295|F>>>17),F=O+(K^(q|~B))+G[13]+1309151649&4294967295,O=q+(F<<21&4294967295|F>>>11),F=B+(q^(O|~K))+G[4]+4149444226&4294967295,B=O+(F<<6&4294967295|F>>>26),F=K+(O^(B|~q))+G[11]+3174756917&4294967295,K=B+(F<<10&4294967295|F>>>22),F=q+(B^(K|~O))+G[2]+718787259&4294967295,q=K+(F<<15&4294967295|F>>>17),F=O+(K^(q|~B))+G[9]+3951481745&4294967295,D.g[0]=D.g[0]+B&4294967295,D.g[1]=D.g[1]+(q+(F<<21&4294967295|F>>>11))&4294967295,D.g[2]=D.g[2]+q&4294967295,D.g[3]=D.g[3]+K&4294967295}i.prototype.v=function(D,B){B===void 0&&(B=D.length);const O=B-this.blockSize,G=this.C;let q=this.h,K=0;for(;K<B;){if(q==0)for(;K<=O;)r(this,D,K),K+=this.blockSize;if(typeof D=="string"){for(;K<B;)if(G[q++]=D.charCodeAt(K++),q==this.blockSize){r(this,G),q=0;break}}else for(;K<B;)if(G[q++]=D[K++],q==this.blockSize){r(this,G),q=0;break}}this.h=q,this.o+=B},i.prototype.A=function(){var D=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);D[0]=128;for(var B=1;B<D.length-8;++B)D[B]=0;B=this.o*8;for(var O=D.length-8;O<D.length;++O)D[O]=B&255,B/=256;for(this.v(D),D=Array(16),B=0,O=0;O<4;++O)for(let G=0;G<32;G+=8)D[B++]=this.g[O]>>>G&255;return D};function a(D,B){var O=f;return Object.prototype.hasOwnProperty.call(O,D)?O[D]:O[D]=B(D)}function u(D,B){this.h=B;const O=[];let G=!0;for(let q=D.length-1;q>=0;q--){const K=D[q]|0;G&&K==B||(O[q]=K,G=!1)}this.g=O}var f={};function m(D){return-128<=D&&D<128?a(D,function(B){return new u([B|0],B<0?-1:0)}):new u([D|0],D<0?-1:0)}function p(D){if(isNaN(D)||!isFinite(D))return S;if(D<0)return Z(p(-D));const B=[];let O=1;for(let G=0;D>=O;G++)B[G]=D/O|0,O*=4294967296;return new u(B,0)}function E(D,B){if(D.length==0)throw Error("number format error: empty string");if(B=B||10,B<2||36<B)throw Error("radix out of range: "+B);if(D.charAt(0)=="-")return Z(E(D.substring(1),B));if(D.indexOf("-")>=0)throw Error('number format error: interior "-" character');const O=p(Math.pow(B,8));let G=S;for(let K=0;K<D.length;K+=8){var q=Math.min(8,D.length-K);const F=parseInt(D.substring(K,K+q),B);q<8?(q=p(Math.pow(B,q)),G=G.j(q).add(p(F))):(G=G.j(O),G=G.add(p(F)))}return G}var S=m(0),A=m(1),R=m(16777216);n=u.prototype,n.m=function(){if(z(this))return-Z(this).m();let D=0,B=1;for(let O=0;O<this.g.length;O++){const G=this.i(O);D+=(G>=0?G:4294967296+G)*B,B*=4294967296}return D},n.toString=function(D){if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(V(this))return"0";if(z(this))return"-"+Z(this).toString(D);const B=p(Math.pow(D,6));var O=this;let G="";for(;;){const q=pe(O,B).g;O=X(O,q.j(B));let K=((O.g.length>0?O.g[0]:O.h)>>>0).toString(D);if(O=q,V(O))return K+G;for(;K.length<6;)K="0"+K;G=K+G}},n.i=function(D){return D<0?0:D<this.g.length?this.g[D]:this.h};function V(D){if(D.h!=0)return!1;for(let B=0;B<D.g.length;B++)if(D.g[B]!=0)return!1;return!0}function z(D){return D.h==-1}n.l=function(D){return D=X(this,D),z(D)?-1:V(D)?0:1};function Z(D){const B=D.g.length,O=[];for(let G=0;G<B;G++)O[G]=~D.g[G];return new u(O,~D.h).add(A)}n.abs=function(){return z(this)?Z(this):this},n.add=function(D){const B=Math.max(this.g.length,D.g.length),O=[];let G=0;for(let q=0;q<=B;q++){let K=G+(this.i(q)&65535)+(D.i(q)&65535),F=(K>>>16)+(this.i(q)>>>16)+(D.i(q)>>>16);G=F>>>16,K&=65535,F&=65535,O[q]=F<<16|K}return new u(O,O[O.length-1]&-2147483648?-1:0)};function X(D,B){return D.add(Z(B))}n.j=function(D){if(V(this)||V(D))return S;if(z(this))return z(D)?Z(this).j(Z(D)):Z(Z(this).j(D));if(z(D))return Z(this.j(Z(D)));if(this.l(R)<0&&D.l(R)<0)return p(this.m()*D.m());const B=this.g.length+D.g.length,O=[];for(var G=0;G<2*B;G++)O[G]=0;for(G=0;G<this.g.length;G++)for(let q=0;q<D.g.length;q++){const K=this.i(G)>>>16,F=this.i(G)&65535,qe=D.i(q)>>>16,Je=D.i(q)&65535;O[2*G+2*q]+=F*Je,ne(O,2*G+2*q),O[2*G+2*q+1]+=K*Je,ne(O,2*G+2*q+1),O[2*G+2*q+1]+=F*qe,ne(O,2*G+2*q+1),O[2*G+2*q+2]+=K*qe,ne(O,2*G+2*q+2)}for(D=0;D<B;D++)O[D]=O[2*D+1]<<16|O[2*D];for(D=B;D<2*B;D++)O[D]=0;return new u(O,0)};function ne(D,B){for(;(D[B]&65535)!=D[B];)D[B+1]+=D[B]>>>16,D[B]&=65535,B++}function Q(D,B){this.g=D,this.h=B}function pe(D,B){if(V(B))throw Error("division by zero");if(V(D))return new Q(S,S);if(z(D))return B=pe(Z(D),B),new Q(Z(B.g),Z(B.h));if(z(B))return B=pe(D,Z(B)),new Q(Z(B.g),B.h);if(D.g.length>30){if(z(D)||z(B))throw Error("slowDivide_ only works with positive integers.");for(var O=A,G=B;G.l(D)<=0;)O=he(O),G=he(G);var q=Y(O,1),K=Y(G,1);for(G=Y(G,2),O=Y(O,2);!V(G);){var F=K.add(G);F.l(D)<=0&&(q=q.add(O),K=F),G=Y(G,1),O=Y(O,1)}return B=X(D,q.j(B)),new Q(q,B)}for(q=S;D.l(B)>=0;){for(O=Math.max(1,Math.floor(D.m()/B.m())),G=Math.ceil(Math.log(O)/Math.LN2),G=G<=48?1:Math.pow(2,G-48),K=p(O),F=K.j(B);z(F)||F.l(D)>0;)O-=G,K=p(O),F=K.j(B);V(K)&&(K=A),q=q.add(K),D=X(D,F)}return new Q(q,D)}n.B=function(D){return pe(this,D).h},n.and=function(D){const B=Math.max(this.g.length,D.g.length),O=[];for(let G=0;G<B;G++)O[G]=this.i(G)&D.i(G);return new u(O,this.h&D.h)},n.or=function(D){const B=Math.max(this.g.length,D.g.length),O=[];for(let G=0;G<B;G++)O[G]=this.i(G)|D.i(G);return new u(O,this.h|D.h)},n.xor=function(D){const B=Math.max(this.g.length,D.g.length),O=[];for(let G=0;G<B;G++)O[G]=this.i(G)^D.i(G);return new u(O,this.h^D.h)};function he(D){const B=D.g.length+1,O=[];for(let G=0;G<B;G++)O[G]=D.i(G)<<1|D.i(G-1)>>>31;return new u(O,D.h)}function Y(D,B){const O=B>>5;B%=32;const G=D.g.length-O,q=[];for(let K=0;K<G;K++)q[K]=B>0?D.i(K+O)>>>B|D.i(K+O+1)<<32-B:D.i(K+O);return new u(q,D.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,VA=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=E,Ia=u}).apply(typeof dS<"u"?dS:typeof self<"u"?self:typeof window<"u"?window:{});var Mf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var OA,Md,UA,jf,W_,BA,zA,FA;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Mf=="object"&&Mf];for(var I=0;I<y.length;++I){var M=y[I];if(M&&M.Math==Math)return M}throw Error("Cannot find global object")}var i=t(this);function r(y,I){if(I)e:{var M=i;y=y.split(".");for(var U=0;U<y.length-1;U++){var se=y[U];if(!(se in M))break e;M=M[se]}y=y[y.length-1],U=M[y],I=I(U),I!=U&&I!=null&&e(M,y,{configurable:!0,writable:!0,value:I})}}r("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(y){return y||function(I){var M=[],U;for(U in I)Object.prototype.hasOwnProperty.call(I,U)&&M.push([U,I[U]]);return M}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},u=this||self;function f(y){var I=typeof y;return I=="object"&&y!=null||I=="function"}function m(y,I,M){return y.call.apply(y.bind,arguments)}function p(y,I,M){return p=m,p.apply(null,arguments)}function E(y,I){var M=Array.prototype.slice.call(arguments,1);return function(){var U=M.slice();return U.push.apply(U,arguments),y.apply(this,U)}}function S(y,I){function M(){}M.prototype=I.prototype,y.Z=I.prototype,y.prototype=new M,y.prototype.constructor=y,y.Ob=function(U,se,de){for(var Re=Array(arguments.length-2),it=2;it<arguments.length;it++)Re[it-2]=arguments[it];return I.prototype[se].apply(U,Re)}}var A=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function R(y){const I=y.length;if(I>0){const M=Array(I);for(let U=0;U<I;U++)M[U]=y[U];return M}return[]}function V(y,I){for(let U=1;U<arguments.length;U++){const se=arguments[U];var M=typeof se;if(M=M!="object"?M:se?Array.isArray(se)?"array":M:"null",M=="array"||M=="object"&&typeof se.length=="number"){M=y.length||0;const de=se.length||0;y.length=M+de;for(let Re=0;Re<de;Re++)y[M+Re]=se[Re]}else y.push(se)}}class z{constructor(I,M){this.i=I,this.j=M,this.h=0,this.g=null}get(){let I;return this.h>0?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function Z(y){u.setTimeout(()=>{throw y},0)}function X(){var y=D;let I=null;return y.g&&(I=y.g,y.g=y.g.next,y.g||(y.h=null),I.next=null),I}class ne{constructor(){this.h=this.g=null}add(I,M){const U=Q.get();U.set(I,M),this.h?this.h.next=U:this.g=U,this.h=U}}var Q=new z(()=>new pe,y=>y.reset());class pe{constructor(){this.next=this.g=this.h=null}set(I,M){this.h=I,this.g=M,this.next=null}reset(){this.next=this.g=this.h=null}}let he,Y=!1,D=new ne,B=()=>{const y=Promise.resolve(void 0);he=()=>{y.then(O)}};function O(){for(var y;y=X();){try{y.h.call(y.g)}catch(M){Z(M)}var I=Q;I.j(y),I.h<100&&(I.h++,y.next=I.g,I.g=y)}Y=!1}function G(){this.u=this.u,this.C=this.C}G.prototype.u=!1,G.prototype.dispose=function(){this.u||(this.u=!0,this.N())},G.prototype[Symbol.dispose]=function(){this.dispose()},G.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(y,I){this.type=y,this.g=this.target=I,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var K=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var y=!1,I=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const M=()=>{};u.addEventListener("test",M,I),u.removeEventListener("test",M,I)}catch{}return y})();function F(y){return/^[\s\xa0]*$/.test(y)}function qe(y,I){q.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,I)}S(qe,q),qe.prototype.init=function(y,I){const M=this.type=y.type,U=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=I,I=y.relatedTarget,I||(M=="mouseover"?I=y.fromElement:M=="mouseout"&&(I=y.toElement)),this.relatedTarget=I,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&qe.Z.h.call(this)},qe.prototype.h=function(){qe.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var Je="closure_listenable_"+(Math.random()*1e6|0),ie=0;function be(y,I,M,U,se){this.listener=y,this.proxy=null,this.src=I,this.type=M,this.capture=!!U,this.ha=se,this.key=++ie,this.da=this.fa=!1}function Se(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function $e(y,I,M){for(const U in y)I.call(M,y[U],U,y)}function Me(y,I){for(const M in y)I.call(void 0,y[M],M,y)}function j(y){const I={};for(const M in y)I[M]=y[M];return I}const fe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ie(y,I){let M,U;for(let se=1;se<arguments.length;se++){U=arguments[se];for(M in U)y[M]=U[M];for(let de=0;de<fe.length;de++)M=fe[de],Object.prototype.hasOwnProperty.call(U,M)&&(y[M]=U[M])}}function le(y){this.src=y,this.g={},this.h=0}le.prototype.add=function(y,I,M,U,se){const de=y.toString();y=this.g[de],y||(y=this.g[de]=[],this.h++);const Re=Ae(y,I,U,se);return Re>-1?(I=y[Re],M||(I.fa=!1)):(I=new be(I,this.src,de,!!U,se),I.fa=M,y.push(I)),I};function ge(y,I){const M=I.type;if(M in y.g){var U=y.g[M],se=Array.prototype.indexOf.call(U,I,void 0),de;(de=se>=0)&&Array.prototype.splice.call(U,se,1),de&&(Se(I),y.g[M].length==0&&(delete y.g[M],y.h--))}}function Ae(y,I,M,U){for(let se=0;se<y.length;++se){const de=y[se];if(!de.da&&de.listener==I&&de.capture==!!M&&de.ha==U)return se}return-1}var He="closure_lm_"+(Math.random()*1e6|0),Ue={};function we(y,I,M,U,se){if(Array.isArray(I)){for(let de=0;de<I.length;de++)we(y,I[de],M,U,se);return null}return M=kt(M),y&&y[Je]?y.J(I,M,f(U)?!!U.capture:!1,se):et(y,I,M,!1,U,se)}function et(y,I,M,U,se,de){if(!I)throw Error("Invalid event type");const Re=f(se)?!!se.capture:!!se;let it=yt(y);if(it||(y[He]=it=new le(y)),M=it.add(I,M,U,Re,de),M.proxy)return M;if(U=vt(),M.proxy=U,U.src=y,U.listener=M,y.addEventListener)K||(se=Re),se===void 0&&(se=!1),y.addEventListener(I.toString(),U,se);else if(y.attachEvent)y.attachEvent(_n(I.toString()),U);else if(y.addListener&&y.removeListener)y.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return M}function vt(){function y(M){return I.call(y.src,y.listener,M)}const I=Vt;return y}function nt(y,I,M,U,se){if(Array.isArray(I))for(var de=0;de<I.length;de++)nt(y,I[de],M,U,se);else U=f(U)?!!U.capture:!!U,M=kt(M),y&&y[Je]?(y=y.i,de=String(I).toString(),de in y.g&&(I=y.g[de],M=Ae(I,M,U,se),M>-1&&(Se(I[M]),Array.prototype.splice.call(I,M,1),I.length==0&&(delete y.g[de],y.h--)))):y&&(y=yt(y))&&(I=y.g[I.toString()],y=-1,I&&(y=Ae(I,M,U,se)),(M=y>-1?I[y]:null)&&qt(M))}function qt(y){if(typeof y!="number"&&y&&!y.da){var I=y.src;if(I&&I[Je])ge(I.i,y);else{var M=y.type,U=y.proxy;I.removeEventListener?I.removeEventListener(M,U,y.capture):I.detachEvent?I.detachEvent(_n(M),U):I.addListener&&I.removeListener&&I.removeListener(U),(M=yt(I))?(ge(M,y),M.h==0&&(M.src=null,I[He]=null)):Se(y)}}}function _n(y){return y in Ue?Ue[y]:Ue[y]="on"+y}function Vt(y,I){if(y.da)y=!0;else{I=new qe(I,this);const M=y.listener,U=y.ha||y.src;y.fa&&qt(y),y=M.call(U,I)}return y}function yt(y){return y=y[He],y instanceof le?y:null}var St="__closure_events_fn_"+(Math.random()*1e9>>>0);function kt(y){return typeof y=="function"?y:(y[St]||(y[St]=function(I){return y.handleEvent(I)}),y[St])}function Rt(){G.call(this),this.i=new le(this),this.M=this,this.G=null}S(Rt,G),Rt.prototype[Je]=!0,Rt.prototype.removeEventListener=function(y,I,M,U){nt(this,y,I,M,U)};function ve(y,I){var M,U=y.G;if(U)for(M=[];U;U=U.G)M.push(U);if(y=y.M,U=I.type||I,typeof I=="string")I=new q(I,y);else if(I instanceof q)I.target=I.target||y;else{var se=I;I=new q(U,y),Ie(I,se)}se=!0;let de,Re;if(M)for(Re=M.length-1;Re>=0;Re--)de=I.g=M[Re],se=Ve(de,U,!0,I)&&se;if(de=I.g=y,se=Ve(de,U,!0,I)&&se,se=Ve(de,U,!1,I)&&se,M)for(Re=0;Re<M.length;Re++)de=I.g=M[Re],se=Ve(de,U,!1,I)&&se}Rt.prototype.N=function(){if(Rt.Z.N.call(this),this.i){var y=this.i;for(const I in y.g){const M=y.g[I];for(let U=0;U<M.length;U++)Se(M[U]);delete y.g[I],y.h--}}this.G=null},Rt.prototype.J=function(y,I,M,U){return this.i.add(String(y),I,!1,M,U)},Rt.prototype.K=function(y,I,M,U){return this.i.add(String(y),I,!0,M,U)};function Ve(y,I,M,U){if(I=y.i.g[String(I)],!I)return!0;I=I.concat();let se=!0;for(let de=0;de<I.length;++de){const Re=I[de];if(Re&&!Re.da&&Re.capture==M){const it=Re.listener,Mt=Re.ha||Re.src;Re.fa&&ge(y.i,Re),se=it.call(Mt,U)!==!1&&se}}return se&&!U.defaultPrevented}function Ye(y,I){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=p(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(I)>2147483647?-1:u.setTimeout(y,I||0)}function pt(y){y.g=Ye(()=>{y.g=null,y.i&&(y.i=!1,pt(y))},y.l);const I=y.h;y.h=null,y.m.apply(null,I)}class dt extends G{constructor(I,M){super(),this.m=I,this.l=M,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:pt(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xn(y){G.call(this),this.h=y,this.g={}}S(xn,G);var Si=[];function ki(y){$e(y.g,function(I,M){this.g.hasOwnProperty(M)&&qt(I)},y),y.g={}}xn.prototype.N=function(){xn.Z.N.call(this),ki(this)},xn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var an=u.JSON.stringify,ns=u.JSON.parse,fr=class{stringify(y){return u.JSON.stringify(y,void 0)}parse(y){return u.JSON.parse(y,void 0)}};function mr(){}function Fr(){}var si={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ne(){q.call(this,"d")}S(Ne,q);function lt(){q.call(this,"c")}S(lt,q);var at={},$t=null;function ui(){return $t=$t||new Rt}at.Ia="serverreachability";function is(y){q.call(this,at.Ia,y)}S(is,q);function Cn(y){const I=ui();ve(I,new is(I))}at.STAT_EVENT="statevent";function Li(y,I){q.call(this,at.STAT_EVENT,y),this.stat=I}S(Li,q);function ln(y){const I=ui();ve(I,new Li(I,y))}at.Ja="timingevent";function bi(y,I){q.call(this,at.Ja,y),this.size=I}S(bi,q);function Ai(y,I){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){y()},I)}function qn(){this.g=!0}qn.prototype.ua=function(){this.g=!1};function Vc(y,I,M,U,se,de){y.info(function(){if(y.g)if(de){var Re="",it=de.split("&");for(let Pt=0;Pt<it.length;Pt++){var Mt=it[Pt].split("=");if(Mt.length>1){const sn=Mt[0];Mt=Mt[1];const Gi=sn.split("_");Re=Gi.length>=2&&Gi[1]=="type"?Re+(sn+"="+Mt+"&"):Re+(sn+"=redacted&")}}}else Re=null;else Re=de;return"XMLHTTP REQ ("+U+") [attempt "+se+"]: "+I+`
`+M+`
`+Re})}function eu(y,I,M,U,se,de,Re){y.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+se+"]: "+I+`
`+M+`
`+de+" "+Re})}function bs(y,I,M,U){y.info(function(){return"XMLHTTP TEXT ("+I+"): "+Oc(y,M)+(U?" "+U:"")})}function Hs(y,I){y.info(function(){return"TIMEOUT: "+I})}qn.prototype.info=function(){};function Oc(y,I){if(!y.g)return I;if(!I)return null;try{const de=JSON.parse(I);if(de){for(y=0;y<de.length;y++)if(Array.isArray(de[y])){var M=de[y];if(!(M.length<2)){var U=M[1];if(Array.isArray(U)&&!(U.length<1)){var se=U[0];if(se!="noop"&&se!="stop"&&se!="close")for(let Re=1;Re<U.length;Re++)U[Re]=""}}}}return an(de)}catch{return I}}var qr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Fa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},qa;function Zn(){}S(Zn,mr),Zn.prototype.g=function(){return new XMLHttpRequest},qa=new Zn;function Be(y){return encodeURIComponent(String(y))}function Ga(y){var I=1;y=y.split(":");const M=[];for(;I>0&&y.length;)M.push(y.shift()),I--;return y.length&&M.push(y.join(":")),M}function Vi(y,I,M,U){this.j=y,this.i=I,this.l=M,this.S=U||1,this.V=new xn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Oi}function Oi(){this.i=null,this.g="",this.h=!1}var yn={},En={};function ss(y,I,M){y.M=1,y.A=jt(cn(I)),y.u=M,y.R=!0,rs(y,null)}function rs(y,I){y.F=Date.now(),As(y),y.B=cn(y.A);var M=y.B,U=y.S;Array.isArray(U)||(U=[String(U)]),gr(M.i,"t",U),y.C=0,M=y.j.L,y.h=new Oi,y.g=Wa(y.j,M?I:null,!y.u),y.P>0&&(y.O=new dt(p(y.Y,y,y.g),y.P)),I=y.V,M=y.g,U=y.ba;var se="readystatechange";Array.isArray(se)||(se&&(Si[0]=se.toString()),se=Si);for(let de=0;de<se.length;de++){const Re=we(M,se[de],U||I.handleEvent,!1,I.h||I);if(!Re)break;I.g[Re.key]=Re}I=y.J?j(y.J):{},y.u?(y.v||(y.v="POST"),I["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,I)):(y.v="GET",y.g.ea(y.B,y.v,null,I)),Cn(),Vc(y.i,y.v,y.B,y.l,y.S,y.u)}Vi.prototype.ba=function(y){y=y.target;const I=this.O;I&&us(y)==3?I.j():this.Y(y)},Vi.prototype.Y=function(y){try{if(y==this.g)e:{const it=us(this.g),Mt=this.g.ya(),Pt=this.g.ca();if(!(it<3)&&(it!=3||this.g&&(this.h.h||this.g.la()||Ln(this.g)))){this.K||it!=4||Mt==7||(Mt==8||Pt<=0?Cn(3):Cn(2)),os(this);var I=this.g.ca();this.X=I;var M=tu(this);if(this.o=I==200,eu(this.i,this.v,this.B,this.l,this.S,it,I),this.o){if(this.U&&!this.L){t:{if(this.g){var U,se=this.g;if((U=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!F(U)){var de=U;break t}}de=null}if(y=de)bs(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Is(this,y);else{this.o=!1,this.m=3,ln(12),Jn(this),Ui(this);break e}}if(this.R){y=!0;let sn;for(;!this.K&&this.C<M.length;)if(sn=iu(this,M),sn==En){it==4&&(this.m=4,ln(14),y=!1),bs(this.i,this.l,null,"[Incomplete Response]");break}else if(sn==yn){this.m=4,ln(15),bs(this.i,this.l,M,"[Invalid Chunk]"),y=!1;break}else bs(this.i,this.l,sn,null),Is(this,sn);if(nu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),it!=4||M.length!=0||this.h.h||(this.m=1,ln(16),y=!1),this.o=this.o&&y,!y)bs(this.i,this.l,M,"[Invalid Chunked Response]"),Jn(this),Ui(this);else if(M.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+M.length),Ja(Re),Re.P=!0,ln(11))}}else bs(this.i,this.l,M,null),Is(this,M);it==4&&Jn(this),this.o&&!this.K&&(it==4?Ni(this.j,this):(this.o=!1,As(this)))}else cs(this.g),I==400&&M.indexOf("Unknown SID")>0?(this.m=3,ln(12)):(this.m=0,ln(13)),Jn(this),Ui(this)}}}catch{}finally{}};function tu(y){if(!nu(y))return y.g.la();const I=Ln(y.g);if(I==="")return"";let M="";const U=I.length,se=us(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return Jn(y),Ui(y),"";y.h.i=new u.TextDecoder}for(let de=0;de<U;de++)y.h.h=!0,M+=y.h.i.decode(I[de],{stream:!(se&&de==U-1)});return I.length=0,y.h.g+=M,y.C=0,y.h.g}function nu(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function iu(y,I){var M=y.C,U=I.indexOf(`
`,M);return U==-1?En:(M=Number(I.substring(M,U)),isNaN(M)?yn:(U+=1,U+M>I.length?En:(I=I.slice(U,U+M),y.C=U+M,I)))}Vi.prototype.cancel=function(){this.K=!0,Jn(this)};function As(y){y.T=Date.now()+y.H,Ro(y,y.H)}function Ro(y,I){if(y.D!=null)throw Error("WatchDog timer not null");y.D=Ai(p(y.aa,y),I)}function os(y){y.D&&(u.clearTimeout(y.D),y.D=null)}Vi.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(Hs(this.i,this.B),this.M!=2&&(Cn(),ln(17)),Jn(this),this.m=2,Ui(this)):Ro(this,this.T-y)};function Ui(y){y.j.I==0||y.K||Ni(y.j,y)}function Jn(y){os(y);var I=y.O;I&&typeof I.dispose=="function"&&I.dispose(),y.O=null,ki(y.V),y.g&&(I=y.g,y.g=null,I.abort(),I.dispose())}function Is(y,I){try{var M=y.j;if(M.I!=0&&(M.g==y||Bi(M.h,y))){if(!y.L&&Bi(M.h,y)&&M.I==3){try{var U=M.Ba.g.parse(I)}catch{U=null}if(Array.isArray(U)&&U.length==3){var se=U;if(se[0]==0){e:if(!M.v){if(M.g)if(M.g.F+3e3<y.F)Oo(M),Tr(M);else break e;Jr(M),ln(18)}}else M.xa=se[1],0<M.xa-M.K&&se[2]<37500&&M.F&&M.A==0&&!M.C&&(M.C=Ai(p(M.Va,M),6e3));Cs(M.h)<=1&&M.ta&&(M.ta=void 0)}else ds(M,11)}else if((y.L||M.g==y)&&Oo(M),!F(I))for(se=M.Ba.g.parse(I),I=0;I<se.length;I++){let Pt=se[I];const sn=Pt[0];if(!(sn<=M.K))if(M.K=sn,Pt=Pt[1],M.I==2)if(Pt[0]=="c"){M.M=Pt[1],M.ba=Pt[2];const Gi=Pt[3];Gi!=null&&(M.ka=Gi,M.j.info("VER="+M.ka));const Hi=Pt[4];Hi!=null&&(M.za=Hi,M.j.info("SVER="+M.za));const Ri=Pt[5];Ri!=null&&typeof Ri=="number"&&Ri>0&&(U=1.5*Ri,M.O=U,M.j.info("backChannelRequestTimeoutMs_="+U)),U=M;const fs=y.g;if(fs){const Yr=fs.g?fs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yr){var de=U.h;de.g||Yr.indexOf("spdy")==-1&&Yr.indexOf("quic")==-1&&Yr.indexOf("h2")==-1||(de.j=de.l,de.g=new Set,de.h&&(js(de,de.h),de.h=null))}if(U.G){const Wr=fs.g?fs.g.getResponseHeader("X-HTTP-Session-Id"):null;Wr&&(U.wa=Wr,Oe(U.J,U.G,Wr))}}M.I=3,M.l&&M.l.ra(),M.aa&&(M.T=Date.now()-y.F,M.j.info("Handshake RTT: "+M.T+"ms")),U=M;var Re=y;if(U.na=Ya(U,U.L?U.ba:null,U.W),Re.L){Mo(U.h,Re);var it=Re,Mt=U.O;Mt&&(it.H=Mt),it.D&&(os(it),As(it)),U.g=Re}else Za(U);M.i.length>0&&fi(M)}else Pt[0]!="stop"&&Pt[0]!="close"||ds(M,7);else M.I==3&&(Pt[0]=="stop"||Pt[0]=="close"?Pt[0]=="stop"?ds(M,7):mt(M):Pt[0]!="noop"&&M.l&&M.l.qa(Pt),M.A=0)}}Cn(4)}catch{}}var wn=class{constructor(y,I){this.g=y,this.map=I}};function Ha(y){this.l=y||10,u.PerformanceNavigationTiming?(y=u.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ja(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Cs(y){return y.h?1:y.g?y.g.size:0}function Bi(y,I){return y.h?y.h==I:y.g?y.g.has(I):!1}function js(y,I){y.g?y.g.add(I):y.h=I}function Mo(y,I){y.h&&y.h==I?y.h=null:y.g&&y.g.has(I)&&y.g.delete(I)}Ha.prototype.cancel=function(){if(this.i=Po(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Po(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let I=y.i;for(const M of y.g.values())I=I.concat(M.G);return I}return R(y.i)}var pr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gt(y,I){if(y){y=y.split("&");for(let M=0;M<y.length;M++){const U=y[M].indexOf("=");let se,de=null;U>=0?(se=y[M].substring(0,U),de=y[M].substring(U+1)):se=y[M],I(se,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function Tt(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let I;y instanceof Tt?(this.l=y.l,dn(this,y.j),this.o=y.o,this.g=y.g,Ii(this,y.u),this.h=y.h,Gr(this,Kr(y.i)),this.m=y.m):y&&(I=String(y).match(pr))?(this.l=!1,dn(this,I[1]||"",!0),this.o=zi(I[2]||""),this.g=zi(I[3]||"",!0),Ii(this,I[4]),this.h=zi(I[5]||"",!0),Gr(this,I[6]||"",!0),this.m=zi(I[7]||"")):(this.l=!1,this.i=new Fi(null,this.l))}Tt.prototype.toString=function(){const y=[];var I=this.j;I&&y.push(Ns(I,Do,!0),":");var M=this.g;return(M||I=="file")&&(y.push("//"),(I=this.o)&&y.push(Ns(I,Do,!0),"@"),y.push(Be(M).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),M=this.u,M!=null&&y.push(":",String(M))),(M=this.h)&&(this.g&&M.charAt(0)!="/"&&y.push("/"),y.push(Ns(M,M.charAt(0)=="/"?as:Hr,!0))),(M=this.i.toString())&&y.push("?",M),(M=this.m)&&y.push("#",Ns(M,Rs)),y.join("")},Tt.prototype.resolve=function(y){const I=cn(this);let M=!!y.j;M?dn(I,y.j):M=!!y.o,M?I.o=y.o:M=!!y.g,M?I.g=y.g:M=y.u!=null;var U=y.h;if(M)Ii(I,y.u);else if(M=!!y.h){if(U.charAt(0)!="/")if(this.g&&!this.h)U="/"+U;else{var se=I.h.lastIndexOf("/");se!=-1&&(U=I.h.slice(0,se+1)+U)}if(se=U,se==".."||se==".")U="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){U=se.lastIndexOf("/",0)==0,se=se.split("/");const de=[];for(let Re=0;Re<se.length;){const it=se[Re++];it=="."?U&&Re==se.length&&de.push(""):it==".."?((de.length>1||de.length==1&&de[0]!="")&&de.pop(),U&&Re==se.length&&de.push("")):(de.push(it),U=!0)}U=de.join("/")}else U=se}return M?I.h=U:M=y.i.toString()!=="",M?Gr(I,Kr(y.i)):M=!!y.m,M&&(I.m=y.m),I};function cn(y){return new Tt(y)}function dn(y,I,M){y.j=M?zi(I,!0):I,y.j&&(y.j=y.j.replace(/:$/,""))}function Ii(y,I){if(I){if(I=Number(I),isNaN(I)||I<0)throw Error("Bad port number "+I);y.u=I}else y.u=null}function Gr(y,I,M){I instanceof Fi?(y.i=I,_r(y.i,y.l)):(M||(I=Ns(I,Kt)),y.i=new Fi(I,y.l))}function Oe(y,I,M){y.i.set(I,M)}function jt(y){return Oe(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function zi(y,I){return y?I?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Ns(y,I,M){return typeof y=="string"?(y=encodeURI(y).replace(I,nn),M&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function nn(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var Do=/[#\/\?@]/g,Hr=/[#\?:]/g,as=/[#\?]/g,Kt=/[#\?@]/g,Rs=/#/g;function Fi(y,I){this.h=this.g=null,this.i=y||null,this.j=!!I}function kn(y){y.g||(y.g=new Map,y.h=0,y.i&&gt(y.i,function(I,M){y.add(decodeURIComponent(I.replace(/\+/g," ")),M)}))}n=Fi.prototype,n.add=function(y,I){kn(this),this.i=null,y=Ms(this,y);let M=this.g.get(y);return M||this.g.set(y,M=[]),M.push(I),this.h+=1,this};function ko(y,I){kn(y),I=Ms(y,I),y.g.has(I)&&(y.i=null,y.h-=y.g.get(I).length,y.g.delete(I))}function Ks(y,I){return kn(y),I=Ms(y,I),y.g.has(I)}n.forEach=function(y,I){kn(this),this.g.forEach(function(M,U){M.forEach(function(se){y.call(I,se,U,this)},this)},this)};function jr(y,I){kn(y);let M=[];if(typeof I=="string")Ks(y,I)&&(M=M.concat(y.g.get(Ms(y,I))));else for(y=Array.from(y.g.values()),I=0;I<y.length;I++)M=M.concat(y[I]);return M}n.set=function(y,I){return kn(this),this.i=null,y=Ms(this,y),Ks(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[I]),this.h+=1,this},n.get=function(y,I){return y?(y=jr(this,y),y.length>0?String(y[0]):I):I};function gr(y,I,M){ko(y,I),M.length>0&&(y.i=null,y.g.set(Ms(y,I),R(M)),y.h+=M.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],I=Array.from(this.g.keys());for(let U=0;U<I.length;U++){var M=I[U];const se=Be(M);M=jr(this,M);for(let de=0;de<M.length;de++){let Re=se;M[de]!==""&&(Re+="="+Be(M[de])),y.push(Re)}}return this.i=y.join("&")};function Kr(y){const I=new Fi;return I.i=y.i,y.g&&(I.g=new Map(y.g),I.h=y.h),I}function Ms(y,I){return I=String(I),y.j&&(I=I.toLowerCase()),I}function _r(y,I){I&&!y.j&&(kn(y),y.i=null,y.g.forEach(function(M,U){const se=U.toLowerCase();U!=se&&(ko(this,U),gr(this,se,M))},y)),y.j=I}function ci(y,I){const M=new qn;if(u.Image){const U=new Image;U.onload=E(di,M,"TestLoadImage: loaded",!0,I,U),U.onerror=E(di,M,"TestLoadImage: error",!1,I,U),U.onabort=E(di,M,"TestLoadImage: abort",!1,I,U),U.ontimeout=E(di,M,"TestLoadImage: timeout",!1,I,U),u.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=y}else I(!1)}function Lo(y,I){const M=new qn,U=new AbortController,se=setTimeout(()=>{U.abort(),di(M,"TestPingServer: timeout",!1,I)},1e4);fetch(y,{signal:U.signal}).then(de=>{clearTimeout(se),de.ok?di(M,"TestPingServer: ok",!0,I):di(M,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(se),di(M,"TestPingServer: error",!1,I)})}function di(y,I,M,U,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),U(M)}catch{}}function yr(){this.g=new fr}function Xe(y){this.i=y.Sb||null,this.h=y.ab||!1}S(Xe,mr),Xe.prototype.g=function(){return new Yn(this.i,this.h)};function Yn(y,I){Rt.call(this),this.H=y,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}S(Yn,Rt),n=Yn.prototype,n.open=function(y,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=I,this.readyState=1,Ci(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const I={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(I.body=y),(this.H||u).fetch(new Request(this.D,I)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Zs(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Ci(this)),this.g&&(this.readyState=3,Ci(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Lt(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function Lt(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var I=y.value?y.value:new Uint8Array(0);(I=this.B.decode(I,{stream:!y.done}))&&(this.response=this.responseText+=I)}y.done?Zs(this):Ci(this),this.readyState==3&&Lt(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,Zs(this))},n.Na=function(y){this.g&&(this.response=y,Zs(this))},n.ga=function(){this.g&&Zs(this)};function Zs(y){y.readyState=4,y.l=null,y.j=null,y.B=null,Ci(y)}n.setRequestHeader=function(y,I){this.A.append(y,I)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],I=this.h.entries();for(var M=I.next();!M.done;)M=M.value,y.push(M[0]+": "+M[1]),M=I.next();return y.join(`\r
`)};function Ci(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Yn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function hi(y){let I="";return $e(y,function(M,U){I+=U,I+=":",I+=M,I+=`\r
`}),I}function Js(y,I,M){e:{for(U in M){var U=!1;break e}U=!0}U||(M=hi(M),typeof y=="string"?M!=null&&Be(M):Oe(y,I,M))}function bt(y){Rt.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}S(bt,Rt);var qi=/^https?$/i,Ys=["POST","PUT"];n=bt.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,I,M,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);I=I?I.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():qa.g(),this.g.onreadystatechange=A(p(this.Ca,this));try{this.B=!0,this.g.open(I,String(y),!0),this.B=!1}catch(de){hn(this,de);return}if(y=M||"",M=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var se in U)M.set(se,U[se]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const de of U.keys())M.set(de,U.get(de));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(M.keys()).find(de=>de.toLowerCase()=="content-type"),se=u.FormData&&y instanceof u.FormData,!(Array.prototype.indexOf.call(Ys,I,void 0)>=0)||U||se||M.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[de,Re]of M)this.g.setRequestHeader(de,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(de){hn(this,de)}};function hn(y,I){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=I,y.o=5,ls(y),Ps(y)}function ls(y){y.A||(y.A=!0,ve(y,"complete"),ve(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,ve(this,"complete"),ve(this,"abort"),Ps(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ps(this,!0)),bt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?vr(this):this.Xa())},n.Xa=function(){vr(this)};function vr(y){if(y.h&&typeof a<"u"){if(y.v&&us(y)==4)setTimeout(y.Ca.bind(y),0);else if(ve(y,"readystatechange"),us(y)==4){y.h=!1;try{const de=y.ca();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var M;if(!(M=I)){var U;if(U=de===0){let Re=String(y.D).match(pr)[1]||null;!Re&&u.self&&u.self.location&&(Re=u.self.location.protocol.slice(0,-1)),U=!qi.test(Re?Re.toLowerCase():"")}M=U}if(M)ve(y,"complete"),ve(y,"success");else{y.o=6;try{var se=us(y)>2?y.g.statusText:""}catch{se=""}y.l=se+" ["+y.ca()+"]",ls(y)}}finally{Ps(y)}}}}function Ps(y,I){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const M=y.g;y.g=null,I||ve(y,"ready");try{M.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function us(y){return y.g?y.g.readyState:0}n.ca=function(){try{return us(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var I=this.g.responseText;return y&&I.indexOf(y)==0&&(I=I.substring(y.length)),ns(I)}};function Ln(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function cs(y){const I={};y=(y.g&&us(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<y.length;U++){if(F(y[U]))continue;var M=Ga(y[U]);const se=M[0];if(M=M[1],typeof M!="string")continue;M=M.trim();const de=I[se]||[];I[se]=de,de.push(M)}Me(I,function(U){return U.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ds(y,I,M){return M&&M.internalChannelParams&&M.internalChannelParams[y]||I}function Ws(y){this.za=0,this.i=[],this.j=new qn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ds("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ds("baseRetryDelayMs",5e3,y),this.Za=Ds("retryDelaySeedMs",1e4,y),this.Ta=Ds("forwardChannelMaxRetries",2,y),this.va=Ds("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Ha(y&&y.concurrentRequestLimit),this.Ba=new yr,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ws.prototype,n.ka=8,n.I=1,n.connect=function(y,I,M,U){ln(0),this.W=y,this.H=I||{},M&&U!==void 0&&(this.H.OSID=M,this.H.OAID=U),this.F=this.X,this.J=Ya(this,null,this.W),fi(this)};function mt(y){if(Wn(y),y.I==3){var I=y.V++,M=cn(y.J);if(Oe(M,"SID",y.M),Oe(M,"RID",I),Oe(M,"TYPE","terminate"),Qs(y,M),I=new Vi(y,y.j,I),I.M=2,I.A=jt(cn(M)),M=!1,u.navigator&&u.navigator.sendBeacon)try{M=u.navigator.sendBeacon(I.A.toString(),"")}catch{}!M&&u.Image&&(new Image().src=I.A,M=!0),M||(I.g=Wa(I.j,null),I.g.ea(I.A)),I.F=Date.now(),As(I)}hs(y)}function Tr(y){y.g&&(Ja(y),y.g.cancel(),y.g=null)}function Wn(y){Tr(y),y.v&&(u.clearTimeout(y.v),y.v=null),Oo(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&u.clearTimeout(y.m),y.m=null)}function fi(y){if(!ja(y.h)&&!y.m){y.m=!0;var I=y.Ea;he||B(),Y||(he(),Y=!0),D.add(I,y),y.D=0}}function Zr(y,I){return Cs(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=I.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=Ai(p(y.Ea,y,I),ru(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const se=new Vi(this,this.j,y);let de=this.o;if(this.U&&(de?(de=j(de),Ie(de,this.U)):de=this.U),this.u!==null||this.R||(se.J=de,de=null),this.S)e:{for(var I=0,M=0;M<this.i.length;M++){t:{var U=this.i[M];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(I+=U,I>4096){I=M;break e}if(I===4096||M===this.i.length-1){I=M+1;break e}}I=1e3}else I=1e3;I=su(this,se,I),M=cn(this.J),Oe(M,"RID",y),Oe(M,"CVER",22),this.G&&Oe(M,"X-HTTP-Session-Id",this.G),Qs(this,M),de&&(this.R?I="headers="+Be(hi(de))+"&"+I:this.u&&Js(M,this.u,de)),js(this.h,se),this.Ra&&Oe(M,"TYPE","init"),this.S?(Oe(M,"$req",I),Oe(M,"SID","null"),se.U=!0,ss(se,M,null)):ss(se,M,I),this.I=2}}else this.I==3&&(y?Ka(this,y):this.i.length==0||ja(this.h)||Ka(this))};function Ka(y,I){var M;I?M=I.l:M=y.V++;const U=cn(y.J);Oe(U,"SID",y.M),Oe(U,"RID",M),Oe(U,"AID",y.K),Qs(y,U),y.u&&y.o&&Js(U,y.u,y.o),M=new Vi(y,y.j,M,y.D+1),y.u===null&&(M.J=y.o),I&&(y.i=I.G.concat(y.i)),I=su(y,M,1e3),M.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),js(y.h,M),ss(M,U,I)}function Qs(y,I){y.H&&$e(y.H,function(M,U){Oe(I,U,M)}),y.l&&$e({},function(M,U){Oe(I,U,M)})}function su(y,I,M){M=Math.min(y.i.length,M);const U=y.l?p(y.l.Ka,y.l,y):null;e:{var se=y.i;let it=-1;for(;;){const Mt=["count="+M];it==-1?M>0?(it=se[0].g,Mt.push("ofs="+it)):it=0:Mt.push("ofs="+it);let Pt=!0;for(let sn=0;sn<M;sn++){var de=se[sn].g;const Gi=se[sn].map;if(de-=it,de<0)it=Math.max(0,se[sn].g-100),Pt=!1;else try{de="req"+de+"_"||"";try{var Re=Gi instanceof Map?Gi:Object.entries(Gi);for(const[Hi,Ri]of Re){let fs=Ri;f(Ri)&&(fs=an(Ri)),Mt.push(de+Hi+"="+encodeURIComponent(fs))}}catch(Hi){throw Mt.push(de+"type="+encodeURIComponent("_badmap")),Hi}}catch{U&&U(Gi)}}if(Pt){Re=Mt.join("&");break e}}Re=void 0}return y=y.i.splice(0,M),I.G=y,Re}function Za(y){if(!y.g&&!y.v){y.Y=1;var I=y.Da;he||B(),Y||(he(),Y=!0),D.add(I,y),y.A=0}}function Jr(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=Ai(p(y.Da,y),ru(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,Vo(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=Ai(p(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ln(10),Tr(this),Vo(this))};function Ja(y){y.B!=null&&(u.clearTimeout(y.B),y.B=null)}function Vo(y){y.g=new Vi(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var I=cn(y.na);Oe(I,"RID","rpc"),Oe(I,"SID",y.M),Oe(I,"AID",y.K),Oe(I,"CI",y.F?"0":"1"),!y.F&&y.ia&&Oe(I,"TO",y.ia),Oe(I,"TYPE","xmlhttp"),Qs(y,I),y.u&&y.o&&Js(I,y.u,y.o),y.O&&(y.g.H=y.O);var M=y.g;y=y.ba,M.M=1,M.A=jt(cn(I)),M.u=null,M.R=!0,rs(M,y)}n.Va=function(){this.C!=null&&(this.C=null,Tr(this),Jr(this),ln(19))};function Oo(y){y.C!=null&&(u.clearTimeout(y.C),y.C=null)}function Ni(y,I){var M=null;if(y.g==I){Oo(y),Ja(y),y.g=null;var U=2}else if(Bi(y.h,I))M=I.G,Mo(y.h,I),U=1;else return;if(y.I!=0){if(I.o)if(U==1){M=I.u?I.u.length:0,I=Date.now()-I.F;var se=y.D;U=ui(),ve(U,new bi(U,M)),fi(y)}else Za(y);else if(se=I.m,se==3||se==0&&I.X>0||!(U==1&&Zr(y,I)||U==2&&Jr(y)))switch(M&&M.length>0&&(I=y.h,I.i=I.i.concat(M)),se){case 1:ds(y,5);break;case 4:ds(y,10);break;case 3:ds(y,6);break;default:ds(y,2)}}}function ru(y,I){let M=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(M*=2),M*I}function ds(y,I){if(y.j.info("Error code "+I),I==2){var M=p(y.bb,y),U=y.Ua;const se=!U;U=new Tt(U||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||dn(U,"https"),jt(U),se?ci(U.toString(),M):Lo(U.toString(),M)}else ln(2);y.I=0,y.l&&y.l.pa(I),hs(y),Wn(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),ln(2)):(this.j.info("Failed to ping google.com"),ln(1))};function hs(y){if(y.I=0,y.ja=[],y.l){const I=Po(y.h);(I.length!=0||y.i.length!=0)&&(V(y.ja,I),V(y.ja,y.i),y.h.i.length=0,R(y.i),y.i.length=0),y.l.oa()}}function Ya(y,I,M){var U=M instanceof Tt?cn(M):new Tt(M);if(U.g!="")I&&(U.g=I+"."+U.g),Ii(U,U.u);else{var se=u.location;U=se.protocol,I=I?I+"."+se.hostname:se.hostname,se=+se.port;const de=new Tt(null);U&&dn(de,U),I&&(de.g=I),se&&Ii(de,se),M&&(de.h=M),U=de}return M=y.G,I=y.wa,M&&I&&Oe(U,M,I),Oe(U,"VER",y.ka),Qs(y,U),U}function Wa(y,I,M){if(I&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return I=y.Aa&&!y.ma?new bt(new Xe({ab:M})):new bt(y.ma),I.Fa(y.L),I}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Uo(){}n=Uo.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function xr(){}xr.prototype.g=function(y,I){return new Qn(y,I)};function Qn(y,I){Rt.call(this),this.g=new Ws(I),this.l=y,this.h=I&&I.messageUrlParams||null,y=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(y?y["X-WebChannel-Content-Type"]=I.messageContentType:y={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.sa&&(y?y["X-WebChannel-Client-Profile"]=I.sa:y={"X-WebChannel-Client-Profile":I.sa}),this.g.U=y,(y=I&&I.Qb)&&!F(y)&&(this.g.u=y),this.A=I&&I.supportsCrossDomainXhr||!1,this.v=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!F(I)&&(this.g.G=I,y=this.h,y!==null&&I in y&&(y=this.h,I in y&&delete y[I])),this.j=new $s(this)}S(Qn,Rt),Qn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qn.prototype.close=function(){mt(this.g)},Qn.prototype.o=function(y){var I=this.g;if(typeof y=="string"){var M={};M.__data__=y,y=M}else this.v&&(M={},M.__data__=an(y),y=M);I.i.push(new wn(I.Ya++,y)),I.I==3&&fi(I)},Qn.prototype.N=function(){this.g.l=null,delete this.j,mt(this.g),delete this.g,Qn.Z.N.call(this)};function Qa(y){Ne.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var I=y.__sm__;if(I){e:{for(const M in I){y=M;break e}y=void 0}(this.i=y)&&(y=this.i,I=I!==null&&y in I?I[y]:void 0),this.data=I}else this.data=y}S(Qa,Ne);function ou(){lt.call(this),this.status=1}S(ou,lt);function $s(y){this.g=y}S($s,Uo),$s.prototype.ra=function(){ve(this.g,"a")},$s.prototype.qa=function(y){ve(this.g,new Qa(y))},$s.prototype.pa=function(y){ve(this.g,new ou)},$s.prototype.oa=function(){ve(this.g,"b")},xr.prototype.createWebChannel=xr.prototype.g,Qn.prototype.send=Qn.prototype.o,Qn.prototype.open=Qn.prototype.m,Qn.prototype.close=Qn.prototype.close,FA=function(){return new xr},zA=function(){return ui()},BA=at,W_={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},qr.NO_ERROR=0,qr.TIMEOUT=8,qr.HTTP_ERROR=6,jf=qr,Fa.COMPLETE="complete",UA=Fa,Fr.EventType=si,si.OPEN="a",si.CLOSE="b",si.ERROR="c",si.MESSAGE="d",Rt.prototype.listen=Rt.prototype.J,Md=Fr,bt.prototype.listenOnce=bt.prototype.K,bt.prototype.getLastError=bt.prototype.Ha,bt.prototype.getLastErrorCode=bt.prototype.ya,bt.prototype.getStatus=bt.prototype.ca,bt.prototype.getResponseJson=bt.prototype.La,bt.prototype.getResponseText=bt.prototype.la,bt.prototype.send=bt.prototype.ea,bt.prototype.setWithCredentials=bt.prototype.Fa,OA=bt}).apply(typeof Mf<"u"?Mf:typeof self<"u"?self:typeof window<"u"?window:{});const hS="@firebase/firestore",fS="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ni.UNAUTHENTICATED=new ni(null),ni.GOOGLE_CREDENTIALS=new ni("google-credentials-uid"),ni.FIRST_PARTY=new ni("first-party-uid"),ni.MOCK_USER=new ni("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rc="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fl=new Ky("@firebase/firestore");function Hu(){return Fl.logLevel}function Ce(n,...e){if(Fl.logLevel<=Ct.DEBUG){const t=e.map(rv);Fl.debug(`Firestore (${Rc}): ${n}`,...t)}}function Mn(n,...e){if(Fl.logLevel<=Ct.ERROR){const t=e.map(rv);Fl.error(`Firestore (${Rc}): ${n}`,...t)}}function ql(n,...e){if(Fl.logLevel<=Ct.WARN){const t=e.map(rv);Fl.warn(`Firestore (${Rc}): ${n}`,...t)}}function rv(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,qA(n,i,t)}function qA(n,e,t){let i=`FIRESTORE (${Rc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Mn(i),new Error(i)}function Ze(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||qA(e,r,i)}function Ge(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ye={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Pe extends Io{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Y6{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ni.UNAUTHENTICATED)))}shutdown(){}}class W6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Q6{constructor(e){this.t=e,this.currentUser=ni.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ze(this.o===void 0,42304);let i=this.i;const r=m=>this.i!==i?(i=this.i,t(m)):Promise.resolve();let a=new yo;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new yo,e.enqueueRetryable((()=>r(this.currentUser)))};const u=()=>{const m=a;e.enqueueRetryable((async()=>{await m.promise,await r(this.currentUser)}))},f=m=>{Ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new yo)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ze(typeof i.accessToken=="string",31837,{l:i}),new GA(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ze(e===null||typeof e=="string",2055,{h:e}),new ni(e)}}class $6{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=ni.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class X6{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new $6(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ni.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class mS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eO{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,or(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ze(this.o===void 0,3512);const i=a=>{a.error!=null&&Ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const u=a.token!==this.m;return this.m=a.token,Ce("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>i(a)))};const r=a=>{Ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>r(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?r(a):Ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new mS(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ze(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new mS(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=tO(40);for(let a=0;a<r.length;++a)i.length<20&&r[a]<t&&(i+=e.charAt(r[a]%62))}return i}}function ot(n,e){return n<e?-1:n>e?1:0}function Q_(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),a=e.charAt(i);if(r!==a)return x_(r)===x_(a)?ot(r,a):x_(r)?1:-1}return ot(n.length,e.length)}const nO=55296,iO=57343;function x_(n){const e=n.charCodeAt(0);return e>=nO&&e<=iO}function oc(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}function HA(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS="__name__";class Pr{constructor(e,t,i){t===void 0?t=0:t>e.length&&ze(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&ze(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Pr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Pr?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const a=Pr.compareSegments(e.get(r),t.get(r));if(a!==0)return a}return ot(e.length,t.length)}static compareSegments(e,t){const i=Pr.isNumericId(e),r=Pr.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Pr.extractNumericId(e).compare(Pr.extractNumericId(t)):Q_(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ia.fromString(e.substring(4,e.length-2))}}class Ht extends Pr{construct(e,t,i){return new Ht(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Pe(ye.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Ht(t)}static emptyPath(){return new Ht([])}}const sO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tn extends Pr{construct(e,t,i){return new Tn(e,t,i)}static isValidIdentifier(e){return sO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pS}static keyField(){return new Tn([pS])}static fromServerFormat(e){const t=[];let i="",r=0;const a=()=>{if(i.length===0)throw new Pe(ye.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;r<e.length;){const f=e[r];if(f==="\\"){if(r+1===e.length)throw new Pe(ye.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[r+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Pe(ye.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=m,r+=2}else f==="`"?(u=!u,r++):f!=="."||u?(i+=f,r++):(a(),r++)}if(a(),u)throw new Pe(ye.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Tn(t)}static emptyPath(){return new Tn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.path=e}static fromPath(e){return new ke(Ht.fromString(e))}static fromName(e){return new ke(Ht.fromString(e).popFirst(5))}static empty(){return new ke(Ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ht.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ke(new Ht(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jA(n,e,t){if(!t)throw new Pe(ye.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function rO(n,e,t,i){if(e===!0&&i===!0)throw new Pe(ye.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gS(n){if(!ke.isDocumentKey(n))throw new Pe(ye.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function _S(n){if(ke.isDocumentKey(n))throw new Pe(ye.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function KA(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function $m(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ze(12329,{type:typeof n})}function Es(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Pe(ye.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=$m(n);throw new Pe(ye.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(n,e){const t={typeString:n};return e&&(t.value=e),t}function ph(n,e){if(!KA(n))throw new Pe(ye.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,a="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const u=n[i];if(r&&typeof u!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(a!==void 0&&u!==a.value){t=`Expected '${i}' field to equal '${a.value}'`;break}}if(t)throw new Pe(ye.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS=-62135596800,vS=1e6;class Yt{static now(){return Yt.fromMillis(Date.now())}static fromDate(e){return Yt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*vS);return new Yt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Pe(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Pe(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<yS)throw new Pe(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Pe(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vS}_compareTo(e){return this.seconds===e.seconds?ot(this.nanoseconds,e.nanoseconds):ot(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Yt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ph(e,Yt._jsonSchema))return new Yt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-yS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Yt._jsonSchemaVersion="firestore/timestamp/1.0",Yt._jsonSchema={type:Fn("string",Yt._jsonSchemaVersion),seconds:Fn("number"),nanoseconds:Fn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{static fromTimestamp(e){return new Qe(e)}static min(){return new Qe(new Yt(0,0))}static max(){return new Qe(new Yt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ac=-1;class _m{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}}function $_(n){return n.fields.find((e=>e.kind===2))}function Sl(n){return n.fields.filter((e=>e.kind!==2))}_m.UNKNOWN_ID=-1;class Kf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Xd{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Xd(0,Ss.min())}}function ZA(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=Qe.fromTimestamp(i===1e9?new Yt(t+1,0):new Yt(t,i));return new Ss(r,ke.empty(),e)}function JA(n){return new Ss(n.readTime,n.key,ac)}class Ss{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Ss(Qe.min(),ke.empty(),ac)}static max(){return new Ss(Qe.max(),ke.empty(),ac)}}function av(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ke.comparator(n.documentKey,e.documentKey),t!==0?t:ot(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class WA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oa(n){if(n.code!==ye.FAILED_PRECONDITION||n.message!==YA)throw n;Ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new re(((i,r)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(i,r)},this.catchCallback=a=>{this.wrapFailure(t,a).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof re?t:re.resolve(t)}catch(t){return re.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):re.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):re.reject(t)}static resolve(e){return new re(((t,i)=>{t(e)}))}static reject(e){return new re(((t,i)=>{i(e)}))}static waitFor(e){return new re(((t,i)=>{let r=0,a=0,u=!1;e.forEach((f=>{++r,f.next((()=>{++a,u&&a===r&&t()}),(m=>i(m)))})),u=!0,a===r&&t()}))}static or(e){let t=re.resolve(!1);for(const i of e)t=t.next((r=>r?re.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,a)=>{i.push(t.call(this,r,a))})),this.waitFor(i)}static mapArray(e,t){return new re(((i,r)=>{const a=e.length,u=new Array(a);let f=0;for(let m=0;m<a;m++){const p=m;t(e[p]).next((E=>{u[p]=E,++f,f===a&&i(u)}),(E=>r(E)))}}))}static doWhile(e,t){return new re(((i,r)=>{const a=()=>{e()===!0?t().next((()=>{a()}),r):i()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts="SimpleDb";class Xm{static open(e,t,i,r){try{return new Xm(t,e.transaction(r,i))}catch(a){throw new zd(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new yo,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new zd(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const r=lv(i.target.error);this.S.reject(new zd(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ce(Ts,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new aO(t)}}class Ca{static delete(e){return Ce(Ts,"Removing database:",e),Al(H1().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!X1())return!1;if(Ca.F())return!0;const e=jn(),t=Ca.M(e),i=0<t&&t<10,r=QA(e),a=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Ca.M(jn())===12.2&&Mn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(Ce(Ts,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=a=>{const u=a.target.result;t(u)},r.onblocked=()=>{i(new zd(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=a=>{const u=a.target.error;u.name==="VersionError"?i(new Pe(ye.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?i(new Pe(ye.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):i(new zd(e,u))},r.onupgradeneeded=a=>{Ce(Ts,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const u=a.target.result;this.N.k(u,r.transaction,a.oldVersion,this.version).next((()=>{Ce(Ts,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,r){const a=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const f=Xm.open(this.db,e,a?"readonly":"readwrite",i),m=r(f).next((p=>(f.C(),p))).catch((p=>(f.abort(p),re.reject(p)))).toPromise();return m.catch((()=>{})),await f.D,m}catch(f){const m=f,p=m.name!=="FirebaseError"&&u<3;if(Ce(Ts,"Transaction failed with error:",m.message,"Retrying:",p),this.close(),!p)return Promise.reject(m)}}}close(){this.db&&this.db.close(),this.db=void 0}}function QA(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class oO{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Al(this.U.delete())}}class zd extends Pe{constructor(e,t){super(ye.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ua(n){return n.name==="IndexedDbTransactionError"}class aO{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(Ce(Ts,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(Ce(Ts,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Al(i)}add(e){return Ce(Ts,"ADD",this.store.name,e,e),Al(this.store.add(e))}get(e){return Al(this.store.get(e)).next((t=>(t===void 0&&(t=null),Ce(Ts,"GET",this.store.name,e,t),t)))}delete(e){return Ce(Ts,"DELETE",this.store.name,e),Al(this.store.delete(e))}count(){return Ce(Ts,"COUNT",this.store.name),Al(this.store.count())}J(e,t){const i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){const a=r.getAll(i.range);return new re(((u,f)=>{a.onerror=m=>{f(m.target.error)},a.onsuccess=m=>{u(m.target.result)}}))}{const a=this.cursor(i),u=[];return this.H(a,((f,m)=>{u.push(m)})).next((()=>u))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new re(((r,a)=>{i.onerror=u=>{a(u.target.error)},i.onsuccess=u=>{r(u.target.result)}}))}Z(e,t){Ce(Ts,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const r=this.cursor(i);return this.H(r,((a,u,f)=>f.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const r=this.cursor(i);return this.H(r,t)}te(e){const t=this.cursor({});return new re(((i,r)=>{t.onerror=a=>{const u=lv(a.target.error);r(u)},t.onsuccess=a=>{const u=a.target.result;u?e(u.primaryKey,u.value).next((f=>{f?u.continue():i()})):i()}}))}H(e,t){const i=[];return new re(((r,a)=>{e.onerror=u=>{a(u.target.error)},e.onsuccess=u=>{const f=u.target.result;if(!f)return void r();const m=new oO(f),p=t(f.primaryKey,f.value,m);if(p instanceof re){const E=p.catch((S=>(m.done(),re.reject(S))));i.push(E)}m.isDone?r():m.G===null?f.continue():f.continue(m.G)}})).next((()=>re.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Al(n){return new re(((e,t)=>{n.onsuccess=i=>{const r=i.target.result;e(r)},n.onerror=i=>{const r=lv(i.target.error);t(r)}}))}let TS=!1;function lv(n){const e=Ca.M(jn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new Pe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return TS||(TS=!0,setTimeout((()=>{throw i}),0)),i}}return n}const Fd="IndexBackfiller";class lO{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){Ce(Fd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();Ce(Fd,`Documents written: ${t}`)}catch(t){Ua(t)?Ce(Fd,"Ignoring IndexedDB error during index backfill: ",t):await Oa(t)}await this.re(6e4)}))}}class uO{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let r=t,a=!0;return re.doWhile((()=>a===!0&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!i.has(u))return Ce(Fd,`Processing collection: ${u}`),this.oe(e,u,r).next((f=>{r-=f,i.add(u)}));a=!1})))).next((()=>t-r))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next((a=>{const u=a.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(r,a))).next((f=>(Ce(Fd,`Updating offset: ${f}`),this.localStore.indexManager.updateCollectionGroup(e,t,f)))).next((()=>u.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((r,a)=>{const u=JA(a);av(u,i)>0&&(i=u)})),new Ss(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Xi.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kl=-1;function ep(n){return n==null}function eh(n){return n===0&&1/n==-1/0}function $A(n){return typeof n=="number"&&Number.isInteger(n)&&!eh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ym="";function Ei(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=xS(e)),e=cO(n.get(t),e);return xS(e)}function cO(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const a=n.charAt(r);switch(a){case"\0":t+="";break;case ym:t+="";break;default:t+=a}}return t}function xS(n){return n+ym+""}function kr(n){const e=n.length;if(Ze(e>=2,64408,{path:n}),e===2)return Ze(n.charAt(0)===ym&&n.charAt(1)==="",56145,{path:n}),Ht.emptyPath();const t=e-2,i=[];let r="";for(let a=0;a<e;){const u=n.indexOf(ym,a);switch((u<0||u>t)&&ze(50515,{path:n}),n.charAt(u+1)){case"":const f=n.substring(a,u);let m;r.length===0?m=f:(r+=f,m=r,r=""),i.push(m);break;case"":r+=n.substring(a,u),r+="\0";break;case"":r+=n.substring(a,u+1);break;default:ze(61167,{path:n})}a=u+2}return new Ht(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bl="remoteDocuments",gh="owner",Uu="owner",th="mutationQueues",dO="userId",rr="mutations",ES="batchId",Pl="userMutationsIndex",wS=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(n,e){return[n,Ei(e)]}function XA(n,e,t){return[n,Ei(e),t]}const hO={},lc="documentMutations",vm="remoteDocumentsV14",fO=["prefixPath","collectionGroup","readTime","documentId"],Jf="documentKeyIndex",mO=["prefixPath","collectionGroup","documentId"],eI="collectionGroupIndex",pO=["collectionGroup","readTime","prefixPath","documentId"],nh="remoteDocumentGlobal",X_="remoteDocumentGlobalKey",uc="targets",tI="queryTargetsIndex",gO=["canonicalId","targetId"],cc="targetDocuments",_O=["targetId","path"],uv="documentTargetsIndex",yO=["path","targetId"],Tm="targetGlobalKey",Ll="targetGlobal",ih="collectionParents",vO=["collectionId","parent"],dc="clientMetadata",TO="clientId",tp="bundles",xO="bundleId",np="namedQueries",EO="name",cv="indexConfiguration",wO="indexId",ey="collectionGroupIndex",SO="collectionGroup",qd="indexState",bO=["indexId","uid"],nI="sequenceNumberIndex",AO=["uid","sequenceNumber"],Gd="indexEntries",IO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],iI="documentKeyIndex",CO=["indexId","uid","orderedDocumentKey"],ip="documentOverlays",NO=["userId","collectionPath","documentId"],ty="collectionPathOverlayIndex",RO=["userId","collectionPath","largestBatchId"],sI="collectionGroupOverlayIndex",MO=["userId","collectionGroup","largestBatchId"],dv="globals",PO="name",rI=[th,rr,lc,bl,uc,gh,Ll,cc,dc,nh,ih,tp,np],DO=[...rI,ip],oI=[th,rr,lc,vm,uc,gh,Ll,cc,dc,nh,ih,tp,np,ip],aI=oI,hv=[...aI,cv,qd,Gd],kO=hv,lI=[...hv,dv],LO=lI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny extends WA{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Kn(n,e){const t=Ge(n);return Ca.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ba(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function uI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,t){this.comparator=e,this.root=t||li.EMPTY}insert(e,t){return new un(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,li.BLACK,null,null))}remove(e){return new un(this.comparator,this.root.remove(e,this.comparator).copy(null,null,li.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pf(this.root,e,this.comparator,!0)}}class Pf{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?i(e.key,t):1,t&&r&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class li{constructor(e,t,i,r,a){this.key=e,this.value=t,this.color=i??li.RED,this.left=r??li.EMPTY,this.right=a??li.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,a){return new li(e??this.key,t??this.value,i??this.color,r??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const a=i(e,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(e,t,i),null):a===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return li.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return li.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,li.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,li.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ze(27949);return e+(this.isRed()?0:1)}}li.EMPTY=null,li.RED=!0,li.BLACK=!1;li.EMPTY=new class{constructor(){this.size=0}get key(){throw ze(57766)}get value(){throw ze(16141)}get color(){throw ze(16727)}get left(){throw ze(29726)}get right(){throw ze(36894)}copy(e,t,i,r,a){return this}insert(e,t,i){return new li(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e){this.comparator=e,this.data=new un(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new bS(this.data.getIterator())}getIteratorFrom(e){return new bS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Qt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,a=i.getNext().key;if(this.comparator(r,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Qt(this.comparator);return t.data=e,t}}class bS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Bu(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e){this.fields=e,e.sort(Tn.comparator)}static empty(){return new es([])}unionWith(e){let t=new Qt(Tn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new es(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return oc(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new cI("Invalid base64 string: "+a):a}})(e);return new Dn(t)}static fromUint8Array(e){const t=(function(r){let a="";for(let u=0;u<r.length;++u)a+=String.fromCharCode(r[u]);return a})(e);return new Dn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ot(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dn.EMPTY_BYTE_STRING=new Dn("");const VO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Eo(n){if(Ze(!!n,39018),typeof n=="string"){let e=0;const t=VO.exec(n);if(Ze(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:gn(n.seconds),nanos:gn(n.nanos)}}function gn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wo(n){return typeof n=="string"?Dn.fromBase64String(n):Dn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI="server_timestamp",hI="__type__",fI="__previous_value__",mI="__local_write_time__";function fv(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[hI])==null?void 0:i.stringValue)===dI}function sp(n){const e=n.mapValue.fields[fI];return fv(e)?sp(e):e}function sh(n){const e=Eo(n.mapValue.fields[mI].timestampValue);return new Yt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(e,t,i,r,a,u,f,m,p,E){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=a,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=p,this.isUsingEmulator=E}}const xm="(default)";class Gl{constructor(e,t){this.projectId=e,this.database=t||xm}static empty(){return new Gl("","")}get isDefaultDatabase(){return this.database===xm}isEqual(e){return e instanceof Gl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mv="__type__",pI="__max__",Ea={mapValue:{fields:{__type__:{stringValue:pI}}}},pv="__vector__",hc="value",Yf={nullValue:"NULL_VALUE"};function Pa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?fv(n)?4:gI(n)?9007199254740991:rp(n)?10:11:ze(28295,{value:n})}function zr(n,e){if(n===e)return!0;const t=Pa(n);if(t!==Pa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return sh(n).isEqual(sh(e));case 3:return(function(r,a){if(typeof r.timestampValue=="string"&&typeof a.timestampValue=="string"&&r.timestampValue.length===a.timestampValue.length)return r.timestampValue===a.timestampValue;const u=Eo(r.timestampValue),f=Eo(a.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,a){return wo(r.bytesValue).isEqual(wo(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,a){return gn(r.geoPointValue.latitude)===gn(a.geoPointValue.latitude)&&gn(r.geoPointValue.longitude)===gn(a.geoPointValue.longitude)})(n,e);case 2:return(function(r,a){if("integerValue"in r&&"integerValue"in a)return gn(r.integerValue)===gn(a.integerValue);if("doubleValue"in r&&"doubleValue"in a){const u=gn(r.doubleValue),f=gn(a.doubleValue);return u===f?eh(u)===eh(f):isNaN(u)&&isNaN(f)}return!1})(n,e);case 9:return oc(n.arrayValue.values||[],e.arrayValue.values||[],zr);case 10:case 11:return(function(r,a){const u=r.mapValue.fields||{},f=a.mapValue.fields||{};if(SS(u)!==SS(f))return!1;for(const m in u)if(u.hasOwnProperty(m)&&(f[m]===void 0||!zr(u[m],f[m])))return!1;return!0})(n,e);default:return ze(52216,{left:n})}}function rh(n,e){return(n.values||[]).find((t=>zr(t,e)))!==void 0}function Da(n,e){if(n===e)return 0;const t=Pa(n),i=Pa(e);if(t!==i)return ot(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return ot(n.booleanValue,e.booleanValue);case 2:return(function(a,u){const f=gn(a.integerValue||a.doubleValue),m=gn(u.integerValue||u.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return AS(n.timestampValue,e.timestampValue);case 4:return AS(sh(n),sh(e));case 5:return Q_(n.stringValue,e.stringValue);case 6:return(function(a,u){const f=wo(a),m=wo(u);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(a,u){const f=a.split("/"),m=u.split("/");for(let p=0;p<f.length&&p<m.length;p++){const E=ot(f[p],m[p]);if(E!==0)return E}return ot(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,u){const f=ot(gn(a.latitude),gn(u.latitude));return f!==0?f:ot(gn(a.longitude),gn(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return IS(n.arrayValue,e.arrayValue);case 10:return(function(a,u){var A,R,V,z;const f=a.fields||{},m=u.fields||{},p=(A=f[hc])==null?void 0:A.arrayValue,E=(R=m[hc])==null?void 0:R.arrayValue,S=ot(((V=p==null?void 0:p.values)==null?void 0:V.length)||0,((z=E==null?void 0:E.values)==null?void 0:z.length)||0);return S!==0?S:IS(p,E)})(n.mapValue,e.mapValue);case 11:return(function(a,u){if(a===Ea.mapValue&&u===Ea.mapValue)return 0;if(a===Ea.mapValue)return 1;if(u===Ea.mapValue)return-1;const f=a.fields||{},m=Object.keys(f),p=u.fields||{},E=Object.keys(p);m.sort(),E.sort();for(let S=0;S<m.length&&S<E.length;++S){const A=Q_(m[S],E[S]);if(A!==0)return A;const R=Da(f[m[S]],p[E[S]]);if(R!==0)return R}return ot(m.length,E.length)})(n.mapValue,e.mapValue);default:throw ze(23264,{he:t})}}function AS(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ot(n,e);const t=Eo(n),i=Eo(e),r=ot(t.seconds,i.seconds);return r!==0?r:ot(t.nanos,i.nanos)}function IS(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const a=Da(t[r],i[r]);if(a)return a}return ot(t.length,i.length)}function fc(n){return iy(n)}function iy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Eo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return wo(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ke.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const a of t.values||[])r?r=!1:i+=",",i+=iy(a);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",a=!0;for(const u of i)a?a=!1:r+=",",r+=`${u}:${iy(t.fields[u])}`;return r+"}"})(n.mapValue):ze(61005,{value:n})}function Wf(n){switch(Pa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=sp(n);return e?16+Wf(e):16;case 5:return 2*n.stringValue.length;case 6:return wo(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,a)=>r+Wf(a)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return Ba(i.fields,((a,u)=>{r+=a.length+Wf(u)})),r})(n.mapValue);default:throw ze(13486,{value:n})}}function oh(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function sy(n){return!!n&&"integerValue"in n}function ah(n){return!!n&&"arrayValue"in n}function CS(n){return!!n&&"nullValue"in n}function NS(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Qf(n){return!!n&&"mapValue"in n}function rp(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[mv])==null?void 0:i.stringValue)===pv}function Hd(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Ba(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Hd(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Hd(n.arrayValue.values[t]);return e}return{...n}}function gI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===pI}const _I={mapValue:{fields:{[mv]:{stringValue:pv},[hc]:{arrayValue:{}}}}};function UO(n){return"nullValue"in n?Yf:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?oh(Gl.empty(),ke.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?rp(n)?_I:{mapValue:{}}:ze(35942,{value:n})}function BO(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?oh(Gl.empty(),ke.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?_I:"mapValue"in n?rp(n)?{mapValue:{}}:Ea:ze(61959,{value:n})}function RS(n,e){const t=Da(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function MS(n,e){const t=Da(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e){this.value=e}static empty(){return new vi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Qf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hd(t)}setAll(e){let t=Tn.emptyPath(),i={},r=[];e.forEach(((u,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,i,r),i={},r=[],t=f.popLast()}u?i[f.lastSegment()]=Hd(u):r.push(f.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,i,r)}delete(e){const t=this.field(e.popLast());Qf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return zr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Qf(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Ba(t,((r,a)=>e[r]=a));for(const r of i)delete e[r]}clone(){return new vi(Hd(this.value))}}function yI(n){const e=[];return Ba(n.fields,((t,i)=>{const r=new Tn([t]);if(Qf(i)){const a=yI(i.mapValue).fields;if(a.length===0)e.push(r);else for(const u of a)e.push(r.child(u))}else e.push(r)})),new es(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,t,i,r,a,u,f){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=a,this.data=u,this.documentState=f}static newInvalidDocument(e){return new In(e,0,Qe.min(),Qe.min(),Qe.min(),vi.empty(),0)}static newFoundDocument(e,t,i,r){return new In(e,1,t,Qe.min(),i,r,0)}static newNoDocument(e,t){return new In(e,2,t,Qe.min(),Qe.min(),vi.empty(),0)}static newUnknownDocument(e,t){return new In(e,3,t,Qe.min(),Qe.min(),vi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Qe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=vi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=vi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Qe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof In&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new In(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,t){this.position=e,this.inclusive=t}}function PS(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const a=e[r],u=n.position[r];if(a.field.isKeyField()?i=ke.comparator(ke.fromName(u.referenceValue),t.key):i=Da(u,t.data.field(a.field)),a.dir==="desc"&&(i*=-1),i!==0)break}return i}function DS(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!zr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Em{constructor(e,t="asc"){this.field=e,this.dir=t}}function zO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{}class Nt extends vI{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new FO(e,t,i):t==="array-contains"?new HO(e,i):t==="in"?new bI(e,i):t==="not-in"?new jO(e,i):t==="array-contains-any"?new KO(e,i):new Nt(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new qO(e,i):new GO(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Da(t,this.value)):t!==null&&Pa(this.value)===Pa(t)&&this.matchesComparison(Da(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Wt extends vI{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Wt(e,t)}matches(e){return pc(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function pc(n){return n.op==="and"}function ry(n){return n.op==="or"}function gv(n){return TI(n)&&pc(n)}function TI(n){for(const e of n.filters)if(e instanceof Wt)return!1;return!0}function oy(n){if(n instanceof Nt)return n.field.canonicalString()+n.op.toString()+fc(n.value);if(gv(n))return n.filters.map((e=>oy(e))).join(",");{const e=n.filters.map((t=>oy(t))).join(",");return`${n.op}(${e})`}}function xI(n,e){return n instanceof Nt?(function(i,r){return r instanceof Nt&&i.op===r.op&&i.field.isEqual(r.field)&&zr(i.value,r.value)})(n,e):n instanceof Wt?(function(i,r){return r instanceof Wt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((a,u,f)=>a&&xI(u,r.filters[f])),!0):!1})(n,e):void ze(19439)}function EI(n,e){const t=n.filters.concat(e);return Wt.create(t,n.op)}function wI(n){return n instanceof Nt?(function(t){return`${t.field.canonicalString()} ${t.op} ${fc(t.value)}`})(n):n instanceof Wt?(function(t){return t.op.toString()+" {"+t.getFilters().map(wI).join(" ,")+"}"})(n):"Filter"}class FO extends Nt{constructor(e,t,i){super(e,t,i),this.key=ke.fromName(i.referenceValue)}matches(e){const t=ke.comparator(e.key,this.key);return this.matchesComparison(t)}}class qO extends Nt{constructor(e,t){super(e,"in",t),this.keys=SI("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class GO extends Nt{constructor(e,t){super(e,"not-in",t),this.keys=SI("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function SI(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>ke.fromName(i.referenceValue)))}class HO extends Nt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ah(t)&&rh(t.arrayValue,this.value)}}class bI extends Nt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&rh(this.value.arrayValue,t)}}class jO extends Nt{constructor(e,t){super(e,"not-in",t)}matches(e){if(rh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!rh(this.value.arrayValue,t)}}class KO extends Nt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ah(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>rh(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,t=null,i=[],r=[],a=null,u=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=a,this.startAt=u,this.endAt=f,this.Te=null}}function ay(n,e=null,t=[],i=[],r=null,a=null,u=null){return new ZO(n,e,t,i,r,a,u)}function Hl(n){const e=Ge(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>oy(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(a){return a.field.canonicalString()+a.dir})(i))).join(","),ep(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>fc(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>fc(i))).join(",")),e.Te=t}return e.Te}function _h(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!zO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!xI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!DS(n.startAt,e.startAt)&&DS(n.endAt,e.endAt)}function wm(n){return ke.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Sm(n,e){return n.filters.filter((t=>t instanceof Nt&&t.field.isEqual(e)))}function kS(n,e,t){let i=Yf,r=!0;for(const a of Sm(n,e)){let u=Yf,f=!0;switch(a.op){case"<":case"<=":u=UO(a.value);break;case"==":case"in":case">=":u=a.value;break;case">":u=a.value,f=!1;break;case"!=":case"not-in":u=Yf}RS({value:i,inclusive:r},{value:u,inclusive:f})<0&&(i=u,r=f)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const u=t.position[a];RS({value:i,inclusive:r},{value:u,inclusive:t.inclusive})<0&&(i=u,r=t.inclusive);break}}return{value:i,inclusive:r}}function LS(n,e,t){let i=Ea,r=!0;for(const a of Sm(n,e)){let u=Ea,f=!0;switch(a.op){case">=":case">":u=BO(a.value),f=!1;break;case"==":case"in":case"<=":u=a.value;break;case"<":u=a.value,f=!1;break;case"!=":case"not-in":u=Ea}MS({value:i,inclusive:r},{value:u,inclusive:f})>0&&(i=u,r=f)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const u=t.position[a];MS({value:i,inclusive:r},{value:u,inclusive:t.inclusive})>0&&(i=u,r=t.inclusive);break}}return{value:i,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,t=null,i=[],r=[],a=null,u="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=a,this.limitType=u,this.startAt=f,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function AI(n,e,t,i,r,a,u,f){return new yh(n,e,t,i,r,a,u,f)}function op(n){return new yh(n)}function VS(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function II(n){return n.collectionGroup!==null}function jd(n){const e=Ge(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new Qt(Tn.comparator);return u.filters.forEach((m=>{m.getFlattenedFilters().forEach((p=>{p.isInequality()&&(f=f.add(p.field))}))})),f})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Em(a,i))})),t.has(Tn.keyField().canonicalString())||e.Ie.push(new Em(Tn.keyField(),i))}return e.Ie}function ws(n){const e=Ge(n);return e.Ee||(e.Ee=JO(e,jd(n))),e.Ee}function JO(n,e){if(n.limitType==="F")return ay(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const a=r.dir==="desc"?"asc":"desc";return new Em(r.field,a)}));const t=n.endAt?new mc(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new mc(n.startAt.position,n.startAt.inclusive):null;return ay(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function ly(n,e){const t=n.filters.concat([e]);return new yh(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function uy(n,e,t){return new yh(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ap(n,e){return _h(ws(n),ws(e))&&n.limitType===e.limitType}function CI(n){return`${Hl(ws(n))}|lt:${n.limitType}`}function ju(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>wI(r))).join(", ")}]`),ep(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>fc(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>fc(r))).join(",")),`Target(${i})`})(ws(n))}; limitType=${n.limitType})`}function vh(n,e){return e.isFoundDocument()&&(function(i,r){const a=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(a):ke.isDocumentKey(i.path)?i.path.isEqual(a):i.path.isImmediateParentOf(a)})(n,e)&&(function(i,r){for(const a of jd(i))if(!a.field.isKeyField()&&r.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const a of i.filters)if(!a.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(u,f,m){const p=PS(u,f,m);return u.inclusive?p<=0:p<0})(i.startAt,jd(i),r)||i.endAt&&!(function(u,f,m){const p=PS(u,f,m);return u.inclusive?p>=0:p>0})(i.endAt,jd(i),r))})(n,e)}function NI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function RI(n){return(e,t)=>{let i=!1;for(const r of jd(n)){const a=YO(r,e,t);if(a!==0)return a;i=i||r.field.isKeyField()}return 0}}function YO(n,e,t){const i=n.field.isKeyField()?ke.comparator(e.key,t.key):(function(a,u,f){const m=u.data.field(a),p=f.data.field(a);return m!==null&&p!==null?Da(m,p):ze(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return ze(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,a]of i)if(this.equalsFn(r,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ba(this.inner,((t,i)=>{for(const[r,a]of i)e(r,a)}))}isEmpty(){return uI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO=new un(ke.comparator);function xs(){return WO}const MI=new un(ke.comparator);function Pd(...n){let e=MI;for(const t of n)e=e.insert(t.key,t);return e}function PI(n){let e=MI;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Lr(){return Kd()}function DI(){return Kd()}function Kd(){return new Co((n=>n.toString()),((n,e)=>n.isEqual(e)))}const QO=new un(ke.comparator),$O=new Qt(ke.comparator);function _t(...n){let e=$O;for(const t of n)e=e.add(t);return e}const XO=new Qt(ot);function _v(){return XO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:eh(e)?"-0":e}}function kI(n){return{integerValue:""+n}}function eU(n,e){return $A(e)?kI(e):yv(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(){this._=void 0}}function tU(n,e,t){return n instanceof gc?(function(r,a){const u={fields:{[hI]:{stringValue:dI},[mI]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return a&&fv(a)&&(a=sp(a)),a&&(u.fields[fI]=a),{mapValue:u}})(t,e):n instanceof jl?VI(n,e):n instanceof _c?OI(n,e):(function(r,a){const u=LI(r,a),f=OS(u)+OS(r.Ae);return sy(u)&&sy(r.Ae)?kI(f):yv(r.serializer,f)})(n,e)}function nU(n,e,t){return n instanceof jl?VI(n,e):n instanceof _c?OI(n,e):t}function LI(n,e){return n instanceof lh?(function(i){return sy(i)||(function(a){return!!a&&"doubleValue"in a})(i)})(e)?e:{integerValue:0}:null}class gc extends lp{}class jl extends lp{constructor(e){super(),this.elements=e}}function VI(n,e){const t=UI(e);for(const i of n.elements)t.some((r=>zr(r,i)))||t.push(i);return{arrayValue:{values:t}}}class _c extends lp{constructor(e){super(),this.elements=e}}function OI(n,e){let t=UI(e);for(const i of n.elements)t=t.filter((r=>!zr(r,i)));return{arrayValue:{values:t}}}class lh extends lp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function OS(n){return gn(n.integerValue||n.doubleValue)}function UI(n){return ah(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(e,t){this.field=e,this.transform=t}}function iU(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof jl&&r instanceof jl||i instanceof _c&&r instanceof _c?oc(i.elements,r.elements,zr):i instanceof lh&&r instanceof lh?zr(i.Ae,r.Ae):i instanceof gc&&r instanceof gc})(n.transform,e.transform)}class sU{constructor(e,t){this.version=e,this.transformResults=t}}class xi{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new xi}static exists(e){return new xi(void 0,e)}static updateTime(e){return new xi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function $f(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class up{}function BI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new cp(n.key,xi.none()):new Mc(n.key,n.data,xi.none());{const t=n.data,i=vi.empty();let r=new Qt(Tn.comparator);for(let a of e.fields)if(!r.has(a)){let u=t.field(a);u===null&&a.length>1&&(a=a.popLast(),u=t.field(a)),u===null?i.delete(a):i.set(a,u),r=r.add(a)}return new No(n.key,i,new es(r.toArray()),xi.none())}}function rU(n,e,t){n instanceof Mc?(function(r,a,u){const f=r.value.clone(),m=BS(r.fieldTransforms,a,u.transformResults);f.setAll(m),a.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(n,e,t):n instanceof No?(function(r,a,u){if(!$f(r.precondition,a))return void a.convertToUnknownDocument(u.version);const f=BS(r.fieldTransforms,a,u.transformResults),m=a.data;m.setAll(zI(r)),m.setAll(f),a.convertToFoundDocument(u.version,m).setHasCommittedMutations()})(n,e,t):(function(r,a,u){a.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function Zd(n,e,t,i){return n instanceof Mc?(function(a,u,f,m){if(!$f(a.precondition,u))return f;const p=a.value.clone(),E=zS(a.fieldTransforms,m,u);return p.setAll(E),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof No?(function(a,u,f,m){if(!$f(a.precondition,u))return f;const p=zS(a.fieldTransforms,m,u),E=u.data;return E.setAll(zI(a)),E.setAll(p),u.convertToFoundDocument(u.version,E).setHasLocalMutations(),f===null?null:f.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((S=>S.field)))})(n,e,t,i):(function(a,u,f){return $f(a.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f})(n,e,t)}function oU(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),a=LI(i.transform,r||null);a!=null&&(t===null&&(t=vi.empty()),t.set(i.field,a))}return t||null}function US(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&oc(i,r,((a,u)=>iU(a,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Mc extends up{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class No extends up{constructor(e,t,i,r,a=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function zI(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function BS(n,e,t){const i=new Map;Ze(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const a=n[r],u=a.transform,f=e.data.field(a.field);i.set(a.field,nU(u,f,t[r]))}return i}function zS(n,e,t){const i=new Map;for(const r of n){const a=r.transform,u=t.data.field(r.field);i.set(r.field,tU(a,u,e))}return i}class cp extends up{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class FI extends up{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const a=this.mutations[r];a.key.isEqual(e.key)&&rU(a,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Zd(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Zd(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=DI();return this.mutations.forEach((r=>{const a=e.get(r.key),u=a.overlayedDocument;let f=this.applyToLocalView(u,a.mutatedFields);f=t.has(r.key)?null:f;const m=BI(u,f);m!==null&&i.set(r.key,m),u.isValidDocument()||u.convertToNoDocument(Qe.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),_t())}isEqual(e){return this.batchId===e.batchId&&oc(this.mutations,e.mutations,((t,i)=>US(t,i)))&&oc(this.baseMutations,e.baseMutations,((t,i)=>US(t,i)))}}class xv{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Ze(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return QO})();const a=e.mutations;for(let u=0;u<a.length;u++)r=r.insert(a[u].key,i[u].version);return new xv(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aU{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zn,Dt;function lU(n){switch(n){case ye.OK:return ze(64938);case ye.CANCELLED:case ye.UNKNOWN:case ye.DEADLINE_EXCEEDED:case ye.RESOURCE_EXHAUSTED:case ye.INTERNAL:case ye.UNAVAILABLE:case ye.UNAUTHENTICATED:return!1;case ye.INVALID_ARGUMENT:case ye.NOT_FOUND:case ye.ALREADY_EXISTS:case ye.PERMISSION_DENIED:case ye.FAILED_PRECONDITION:case ye.ABORTED:case ye.OUT_OF_RANGE:case ye.UNIMPLEMENTED:case ye.DATA_LOSS:return!0;default:return ze(15467,{code:n})}}function qI(n){if(n===void 0)return Mn("GRPC error has no .code"),ye.UNKNOWN;switch(n){case zn.OK:return ye.OK;case zn.CANCELLED:return ye.CANCELLED;case zn.UNKNOWN:return ye.UNKNOWN;case zn.DEADLINE_EXCEEDED:return ye.DEADLINE_EXCEEDED;case zn.RESOURCE_EXHAUSTED:return ye.RESOURCE_EXHAUSTED;case zn.INTERNAL:return ye.INTERNAL;case zn.UNAVAILABLE:return ye.UNAVAILABLE;case zn.UNAUTHENTICATED:return ye.UNAUTHENTICATED;case zn.INVALID_ARGUMENT:return ye.INVALID_ARGUMENT;case zn.NOT_FOUND:return ye.NOT_FOUND;case zn.ALREADY_EXISTS:return ye.ALREADY_EXISTS;case zn.PERMISSION_DENIED:return ye.PERMISSION_DENIED;case zn.FAILED_PRECONDITION:return ye.FAILED_PRECONDITION;case zn.ABORTED:return ye.ABORTED;case zn.OUT_OF_RANGE:return ye.OUT_OF_RANGE;case zn.UNIMPLEMENTED:return ye.UNIMPLEMENTED;case zn.DATA_LOSS:return ye.DATA_LOSS;default:return ze(39323,{code:n})}}(Dt=zn||(zn={}))[Dt.OK=0]="OK",Dt[Dt.CANCELLED=1]="CANCELLED",Dt[Dt.UNKNOWN=2]="UNKNOWN",Dt[Dt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Dt[Dt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Dt[Dt.NOT_FOUND=5]="NOT_FOUND",Dt[Dt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Dt[Dt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Dt[Dt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Dt[Dt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Dt[Dt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Dt[Dt.ABORTED=10]="ABORTED",Dt[Dt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Dt[Dt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Dt[Dt.INTERNAL=13]="INTERNAL",Dt[Dt.UNAVAILABLE=14]="UNAVAILABLE",Dt[Dt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cU=new Ia([4294967295,4294967295],0);function FS(n){const e=uU().encode(n),t=new VA;return t.update(e),new Uint8Array(t.digest())}function qS(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Ia([t,i],0),new Ia([r,a],0)]}class wv{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Dd(`Invalid padding: ${t}`);if(i<0)throw new Dd(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Dd(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Dd(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ia.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(Ia.fromNumber(i)));return r.compare(cU)===1&&(r=new Ia([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=FS(e),[i,r]=qS(t);for(let a=0;a<this.hashCount;a++){const u=this.ye(i,r,a);if(!this.we(u))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),u=new wv(a,r,t);return i.forEach((f=>u.insert(f))),u}insert(e){if(this.ge===0)return;const t=FS(e),[i,r]=qS(t);for(let a=0;a<this.hashCount;a++){const u=this.ye(i,r,a);this.Se(u)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Dd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e,t,i,r,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,xh.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Th(Qe.min(),r,new un(ot),xs(),_t())}}class xh{constructor(e,t,i,r,a){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new xh(i,t,_t(),_t(),_t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(e,t,i,r){this.be=e,this.removedTargetIds=t,this.key=i,this.De=r}}class GI{constructor(e,t){this.targetId=e,this.Ce=t}}class HI{constructor(e,t,i=Dn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class GS{constructor(){this.ve=0,this.Fe=HS(),this.Me=Dn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=_t(),t=_t(),i=_t();return this.Fe.forEach(((r,a)=>{switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:ze(38017,{changeType:a})}})),new xh(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=HS()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ze(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class dU{constructor(e){this.Ge=e,this.ze=new Map,this.je=xs(),this.Je=Df(),this.He=Df(),this.Ye=new un(ot)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:ze(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const a=r.target;if(wm(a))if(i===0){const u=new ke(a.path);this.et(t,u,In.newNoDocument(u,Qe.min()))}else Ze(i===1,20013,{expectedCount:i});else{const u=this._t(t);if(u!==i){const f=this.ut(e),m=f?this.ct(f,e,u):1;if(m!==0){this.it(t);const p=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:a=0}=t;let u,f;try{u=wo(i).toUint8Array()}catch(m){if(m instanceof cI)return ql("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new wv(u,r,a)}catch(m){return ql(m instanceof Dd?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.ge===0?null:f}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((a=>{const u=this.Ge.ht(),f=`projects/${u.projectId}/databases/${u.database}/documents/${a.path.canonicalString()}`;e.mightContain(f)||(this.et(t,a,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((a,u)=>{const f=this.ot(u);if(f){if(a.current&&wm(f.target)){const m=new ke(f.target.path);this.It(m).has(u)||this.Et(u,m)||this.et(u,m,In.newNoDocument(m,e))}a.Be&&(t.set(u,a.ke()),a.qe())}}));let i=_t();this.He.forEach(((a,u)=>{let f=!0;u.forEachWhile((m=>{const p=this.ot(m);return!p||p.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(i=i.add(a))})),this.je.forEach(((a,u)=>u.setReadTime(e)));const r=new Th(e,t,this.Ye,this.je,i);return this.je=xs(),this.Je=Df(),this.He=Df(),this.Ye=new un(ot),r}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new GS,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Qt(ot),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Qt(ot),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ce("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new GS),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Df(){return new un(ke.comparator)}function HS(){return new un(ke.comparator)}const hU={asc:"ASCENDING",desc:"DESCENDING"},fU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mU={and:"AND",or:"OR"};class pU{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function cy(n,e){return n.useProto3Json||ep(e)?e:{value:e}}function yc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function jI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function gU(n,e){return yc(n,e.toTimestamp())}function Di(n){return Ze(!!n,49232),Qe.fromTimestamp((function(t){const i=Eo(t);return new Yt(i.seconds,i.nanos)})(n))}function Sv(n,e){return dy(n,e).canonicalString()}function dy(n,e){const t=(function(r){return new Ht(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function KI(n){const e=Ht.fromString(n);return Ze(tC(e),10190,{key:e.toString()}),e}function bm(n,e){return Sv(n.databaseId,e.path)}function Vl(n,e){const t=KI(e);if(t.get(1)!==n.databaseId.projectId)throw new Pe(ye.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Pe(ye.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ke(YI(t))}function ZI(n,e){return Sv(n.databaseId,e)}function JI(n){const e=KI(n);return e.length===4?Ht.emptyPath():YI(e)}function hy(n){return new Ht(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function YI(n){return Ze(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function jS(n,e,t){return{name:bm(n,e),fields:t.value.mapValue.fields}}function _U(n,e,t){const i=Vl(n,e.name),r=Di(e.updateTime),a=e.createTime?Di(e.createTime):Qe.min(),u=new vi({mapValue:{fields:e.fields}}),f=In.newFoundDocument(i,r,a,u);return t&&f.setHasCommittedMutations(),t?f.setHasCommittedMutations():f}function yU(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:ze(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],a=(function(p,E){return p.useProto3Json?(Ze(E===void 0||typeof E=="string",58123),Dn.fromBase64String(E||"")):(Ze(E===void 0||E instanceof Buffer||E instanceof Uint8Array,16193),Dn.fromUint8Array(E||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&(function(p){const E=p.code===void 0?ye.UNKNOWN:qI(p.code);return new Pe(E,p.message||"")})(u);t=new HI(i,r,a,f||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Vl(n,i.document.name),a=Di(i.document.updateTime),u=i.document.createTime?Di(i.document.createTime):Qe.min(),f=new vi({mapValue:{fields:i.document.fields}}),m=In.newFoundDocument(r,a,u,f),p=i.targetIds||[],E=i.removedTargetIds||[];t=new Xf(p,E,m.key,m)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Vl(n,i.document),a=i.readTime?Di(i.readTime):Qe.min(),u=In.newNoDocument(r,a),f=i.removedTargetIds||[];t=new Xf([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Vl(n,i.document),a=i.removedTargetIds||[];t=new Xf([],a,r,null)}else{if(!("filter"in e))return ze(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:a}=i,u=new aU(r,a),f=i.targetId;t=new GI(f,u)}}return t}function Am(n,e){let t;if(e instanceof Mc)t={update:jS(n,e.key,e.value)};else if(e instanceof cp)t={delete:bm(n,e.key)};else if(e instanceof No)t={update:jS(n,e.key,e.data),updateMask:SU(e.fieldMask)};else{if(!(e instanceof FI))return ze(16599,{Vt:e.type});t={verify:bm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(a,u){const f=u.transform;if(f instanceof gc)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof jl)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof _c)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof lh)return{fieldPath:u.field.canonicalString(),increment:f.Ae};throw ze(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,a){return a.updateTime!==void 0?{updateTime:gU(r,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ze(27497)})(n,e.precondition)),t}function fy(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?xi.updateTime(Di(a.updateTime)):a.exists!==void 0?xi.exists(a.exists):xi.none()})(e.currentDocument):xi.none(),i=e.updateTransforms?e.updateTransforms.map((r=>(function(u,f){let m=null;if("setToServerValue"in f)Ze(f.setToServerValue==="REQUEST_TIME",16630,{proto:f}),m=new gc;else if("appendMissingElements"in f){const E=f.appendMissingElements.values||[];m=new jl(E)}else if("removeAllFromArray"in f){const E=f.removeAllFromArray.values||[];m=new _c(E)}else"increment"in f?m=new lh(u,f.increment):ze(16584,{proto:f});const p=Tn.fromServerFormat(f.fieldPath);return new vv(p,m)})(n,r))):[];if(e.update){e.update.name;const r=Vl(n,e.update.name),a=new vi({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(m){const p=m.fieldPaths||[];return new es(p.map((E=>Tn.fromServerFormat(E))))})(e.updateMask);return new No(r,a,u,t,i)}return new Mc(r,a,t,i)}if(e.delete){const r=Vl(n,e.delete);return new cp(r,t)}if(e.verify){const r=Vl(n,e.verify);return new FI(r,t)}return ze(1463,{proto:e})}function vU(n,e){return n&&n.length>0?(Ze(e!==void 0,14353),n.map((t=>(function(r,a){let u=r.updateTime?Di(r.updateTime):Di(a);return u.isEqual(Qe.min())&&(u=Di(a)),new sU(u,r.transformResults||[])})(t,e)))):[]}function WI(n,e){return{documents:[ZI(n,e.path)]}}function QI(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=ZI(n,r);const a=(function(p){if(p.length!==0)return eC(Wt.create(p,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const u=(function(p){if(p.length!==0)return p.map((E=>(function(A){return{field:Ku(A.field),direction:xU(A.dir)}})(E)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const f=cy(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:r}}function $I(n){let e=JI(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Ze(i===1,65062);const E=t.from[0];E.allDescendants?r=E.collectionId:e=e.child(E.collectionId)}let a=[];t.where&&(a=(function(S){const A=XI(S);return A instanceof Wt&&gv(A)?A.getFilters():[A]})(t.where));let u=[];t.orderBy&&(u=(function(S){return S.map((A=>(function(V){return new Em(Zu(V.field),(function(Z){switch(Z){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(V.direction))})(A)))})(t.orderBy));let f=null;t.limit&&(f=(function(S){let A;return A=typeof S=="object"?S.value:S,ep(A)?null:A})(t.limit));let m=null;t.startAt&&(m=(function(S){const A=!!S.before,R=S.values||[];return new mc(R,A)})(t.startAt));let p=null;return t.endAt&&(p=(function(S){const A=!S.before,R=S.values||[];return new mc(R,A)})(t.endAt)),AI(e,r,u,a,f,"F",m,p)}function TU(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ze(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function XI(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Zu(t.unaryFilter.field);return Nt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Zu(t.unaryFilter.field);return Nt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Zu(t.unaryFilter.field);return Nt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Zu(t.unaryFilter.field);return Nt.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ze(61313);default:return ze(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Nt.create(Zu(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ze(58110);default:return ze(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Wt.create(t.compositeFilter.filters.map((i=>XI(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ze(1026)}})(t.compositeFilter.op))})(n):ze(30097,{filter:n})}function xU(n){return hU[n]}function EU(n){return fU[n]}function wU(n){return mU[n]}function Ku(n){return{fieldPath:n.canonicalString()}}function Zu(n){return Tn.fromServerFormat(n.fieldPath)}function eC(n){return n instanceof Nt?(function(t){if(t.op==="=="){if(NS(t.value))return{unaryFilter:{field:Ku(t.field),op:"IS_NAN"}};if(CS(t.value))return{unaryFilter:{field:Ku(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(NS(t.value))return{unaryFilter:{field:Ku(t.field),op:"IS_NOT_NAN"}};if(CS(t.value))return{unaryFilter:{field:Ku(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ku(t.field),op:EU(t.op),value:t.value}}})(n):n instanceof Wt?(function(t){const i=t.getFilters().map((r=>eC(r)));return i.length===1?i[0]:{compositeFilter:{op:wU(t.op),filters:i}}})(n):ze(54877,{filter:n})}function SU(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function tC(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,t,i,r,a=Qe.min(),u=Qe.min(),f=Dn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new _o(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new _o(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new _o(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new _o(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e){this.yt=e}}function bU(n,e){let t;if(e.document)t=_U(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=ke.fromSegments(e.noDocument.path),r=Zl(e.noDocument.readTime);t=In.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ze(56709);{const i=ke.fromSegments(e.unknownDocument.path),r=Zl(e.unknownDocument.version);t=In.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime((function(r){const a=new Yt(r[0],r[1]);return Qe.fromTimestamp(a)})(e.readTime)),t}function KS(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Im(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(a,u){return{name:bm(a,u.key),fields:u.data.value.mapValue.fields,updateTime:yc(a,u.version.toTimestamp()),createTime:yc(a,u.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Kl(e.version)};else{if(!e.isUnknownDocument())return ze(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Kl(e.version)}}return i}function Im(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Kl(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Zl(n){const e=new Yt(n.seconds,n.nanoseconds);return Qe.fromTimestamp(e)}function Il(n,e){const t=(e.baseMutations||[]).map((a=>fy(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const u=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const f=e.mutations[a+1];u.updateTransforms=f.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const i=e.mutations.map((a=>fy(n.yt,a))),r=Yt.fromMillis(e.localWriteTimeMs);return new Tv(e.batchId,r,t,i)}function kd(n){const e=Zl(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Zl(n.lastLimboFreeSnapshotVersion):Qe.min();let i;return i=(function(a){return a.documents!==void 0})(n.query)?(function(a){const u=a.documents.length;return Ze(u===1,1966,{count:u}),ws(op(JI(a.documents[0])))})(n.query):(function(a){return ws($I(a))})(n.query),new _o(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Dn.fromBase64String(n.resumeToken))}function iC(n,e){const t=Kl(e.snapshotVersion),i=Kl(e.lastLimboFreeSnapshotVersion);let r;r=wm(e.target)?WI(n.yt,e.target):QI(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Hl(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function sC(n){const e=$I({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?uy(e,e.limit,"L"):e}function E_(n,e){return new Ev(e.largestBatchId,fy(n.yt,e.overlayMutation))}function ZS(n,e){const t=e.path.lastSegment();return[n,Ei(e.path.popLast()),t]}function JS(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Kl(i.readTime),documentKey:Ei(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{getBundleMetadata(e,t){return YS(e).get(t).next((i=>{if(i)return(function(a){return{id:a.bundleId,createTime:Zl(a.createTime),version:a.version}})(i)}))}saveBundleMetadata(e,t){return YS(e).put((function(r){return{bundleId:r.id,createTime:Kl(Di(r.createTime)),version:r.version}})(t))}getNamedQuery(e,t){return WS(e).get(t).next((i=>{if(i)return(function(a){return{name:a.name,query:sC(a.bundledQuery),readTime:Zl(a.readTime)}})(i)}))}saveNamedQuery(e,t){return WS(e).put((function(r){return{name:r.name,readTime:Kl(Di(r.readTime)),bundledQuery:r.bundledQuery}})(t))}}function YS(n){return Kn(n,tp)}function WS(n){return Kn(n,np)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new dp(e,i)}getOverlay(e,t){return wd(e).get(ZS(this.userId,t)).next((i=>i?E_(this.serializer,i):null))}getOverlays(e,t){const i=Lr();return re.forEach(t,(r=>this.getOverlay(e,r).next((a=>{a!==null&&i.set(r,a)})))).next((()=>i))}saveOverlays(e,t,i){const r=[];return i.forEach(((a,u)=>{const f=new Ev(t,u);r.push(this.St(e,f))})),re.waitFor(r)}removeOverlaysForBatchId(e,t,i){const r=new Set;t.forEach((u=>r.add(Ei(u.getCollectionPath()))));const a=[];return r.forEach((u=>{const f=IDBKeyRange.bound([this.userId,u,i],[this.userId,u,i+1],!1,!0);a.push(wd(e).Z(ty,f))})),re.waitFor(a)}getOverlaysForCollection(e,t,i){const r=Lr(),a=Ei(t),u=IDBKeyRange.bound([this.userId,a,i],[this.userId,a,Number.POSITIVE_INFINITY],!0);return wd(e).J(ty,u).next((f=>{for(const m of f){const p=E_(this.serializer,m);r.set(p.getKey(),p)}return r}))}getOverlaysForCollectionGroup(e,t,i,r){const a=Lr();let u;const f=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return wd(e).ee({index:sI,range:f},((m,p,E)=>{const S=E_(this.serializer,p);a.size()<r||S.largestBatchId===u?(a.set(S.getKey(),S),u=S.largestBatchId):E.done()})).next((()=>a))}St(e,t){return wd(e).put((function(r,a,u){const[f,m,p]=ZS(a,u.mutation.key);return{userId:a,collectionPath:m,documentId:p,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:Am(r.yt,u.mutation)}})(this.serializer,this.userId,t))}}function wd(n){return Kn(n,ip)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IU{bt(e){return Kn(e,dv)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t==null?void 0:t.value;return i?Dn.fromUint8Array(i):Dn.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(gn(e.integerValue));else if("doubleValue"in e){const i=gn(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),eh(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=Eo(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(wo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?gI(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):rp(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):ze(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const r of Object.keys(i))this.Ot(r,t),this.Ct(i[r],t)}kt(e,t){var u,f;const i=e.fields||{};this.Ft(t,53);const r=hc,a=((f=(u=i[r].arrayValue)==null?void 0:u.values)==null?void 0:f.length)||0;this.Ft(t,15),t.Mt(gn(a)),this.Ot(r,t),this.Ct(i[r],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const r of i)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),ke.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Cl.Kt=new Cl;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zu=255;function CU(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function QS(n){const e=64-(function(i){let r=0;for(let a=0;a<8;++a){const u=CU(255&i[a]);if(r+=u,u!==8)break}return r})(n);return Math.ceil(e/8)}class NU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const r=t.codePointAt(0);this.Gt(240|r>>>18),this.Gt(128|63&r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const r=t.codePointAt(0);this.Jt(240|r>>>18),this.Jt(128|63&r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r)}}this.Ht()}Xt(e){const t=this.en(e),i=QS(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}nn(e){const t=this.en(e),i=QS(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}rn(){this.sn(zu),this.sn(255)}_n(){this.an(zu),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,a,!1),new Uint8Array(u.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===zu?(this.sn(zu),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===zu?(this.an(zu),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}}class RU{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class MU{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Sd{constructor(){this.cn=new NU,this.ln=new RU(this.cn),this.hn=new MU(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl{constructor(e,t,i,r){this.Tn=e,this.In=t,this.En=i,this.dn=r}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Nl(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:em(this.En),directionalValue:em(this.dn),orderedDocumentKey:em(t),documentKey:i.path.toArray()}}Vn(e,t,i){const r=this.Rn(e,t,i);return[r.indexId,r.uid,r.arrayValue,r.directionalValue,r.orderedDocumentKey,r.documentKey]}}function ma(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=$S(n.En,e.En),t!==0?t:(t=$S(n.dn,e.dn),t!==0?t:ke.comparator(n.In,e.In)))}function $S(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function em(n){return $1()?(function(t){let i="";for(let r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i})(n):n}function XS(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(n)}class eb{constructor(e){this.mn=new Qt(((t,i)=>Tn.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Ze(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=$_(e);if(t!==void 0&&!this.wn(t))return!1;const i=Sl(e);let r=new Set,a=0,u=0;for(;a<i.length&&this.wn(i[a]);++a)r=r.add(i[a].fieldPath.canonicalString());if(a===i.length)return!0;if(this.mn.size>0){const f=this.mn.getIterator().getNext();if(!r.has(f.field.canonicalString())){const m=i[a];if(!this.Sn(f,m)||!this.bn(this.fn[u++],m))return!1}++a}for(;a<i.length;++a){const f=i[a];if(u>=this.fn.length||!this.bn(this.fn[u++],f))return!1}return!0}Dn(){if(this.pn)return null;let e=new Qt(Tn.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Kf(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Kf(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Kf(i.field,i.dir==="asc"?0:1)));return new _m(_m.UNKNOWN_ID,this.collectionId,t,Xd.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(n){var t,i;if(Ze(n instanceof Nt||n instanceof Wt,20012),n instanceof Nt){if(n instanceof bI){const r=((i=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:i.map((a=>Nt.create(n.field,"==",a))))||[];return Wt.create(r,"or")}return n}const e=n.filters.map((r=>rC(r)));return Wt.create(e,n.op)}function PU(n){if(n.getFilters().length===0)return[];const e=gy(rC(n));return Ze(oC(e),7391),my(e)||py(e)?[e]:e.getFilters()}function my(n){return n instanceof Nt}function py(n){return n instanceof Wt&&gv(n)}function oC(n){return my(n)||py(n)||(function(t){if(t instanceof Wt&&ry(t)){for(const i of t.getFilters())if(!my(i)&&!py(i))return!1;return!0}return!1})(n)}function gy(n){if(Ze(n instanceof Nt||n instanceof Wt,34018),n instanceof Nt)return n;if(n.filters.length===1)return gy(n.filters[0]);const e=n.filters.map((i=>gy(i)));let t=Wt.create(e,n.op);return t=Cm(t),oC(t)?t:(Ze(t instanceof Wt,64498),Ze(pc(t),40251),Ze(t.filters.length>1,57927),t.filters.reduce(((i,r)=>bv(i,r))))}function bv(n,e){let t;return Ze(n instanceof Nt||n instanceof Wt,38388),Ze(e instanceof Nt||e instanceof Wt,25473),t=n instanceof Nt?e instanceof Nt?(function(r,a){return Wt.create([r,a],"and")})(n,e):tb(n,e):e instanceof Nt?tb(e,n):(function(r,a){if(Ze(r.filters.length>0&&a.filters.length>0,48005),pc(r)&&pc(a))return EI(r,a.getFilters());const u=ry(r)?r:a,f=ry(r)?a:r,m=u.filters.map((p=>bv(p,f)));return Wt.create(m,"or")})(n,e),Cm(t)}function tb(n,e){if(pc(e))return EI(e,n.getFilters());{const t=e.filters.map((i=>bv(n,i)));return Wt.create(t,"or")}}function Cm(n){if(Ze(n instanceof Nt||n instanceof Wt,11850),n instanceof Nt)return n;const e=n.getFilters();if(e.length===1)return Cm(e[0]);if(TI(n))return n;const t=e.map((r=>Cm(r))),i=[];return t.forEach((r=>{r instanceof Nt?i.push(r):r instanceof Wt&&(r.op===n.op?i.push(...r.filters):i.push(r))})),i.length===1?i[0]:Wt.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(){this.Cn=new Av}addToCollectionParentIndex(e,t){return this.Cn.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(Ss.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(Ss.min())}updateCollectionGroup(e,t,i){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}}class Av{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Qt(Ht.comparator),a=!r.has(i);return this.index[t]=r.add(i),a}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Qt(Ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nb="IndexedDbIndexManager",kf=new Uint8Array(0);class kU{constructor(e,t){this.databaseId=t,this.vn=new Av,this.Fn=new Co((i=>Hl(i)),((i,r)=>_h(i,r))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:i,parent:Ei(r)};return ib(e).put(a)}return re.resolve()}getCollectionParents(e,t){const i=[],r=IDBKeyRange.bound([t,""],[HA(t),""],!1,!0);return ib(e).J(r).next((a=>{for(const u of a){if(u.collectionId!==t)break;i.push(kr(u.parent))}return i}))}addFieldIndex(e,t){const i=bd(e),r=(function(f){return{indexId:f.indexId,collectionGroup:f.collectionGroup,fields:f.fields.map((m=>[m.fieldPath.canonicalString(),m.kind]))}})(t);delete r.indexId;const a=i.add(r);if(t.indexState){const u=qu(e);return a.next((f=>{u.put(JS(f,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const i=bd(e),r=qu(e),a=Fu(e);return i.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=bd(e),i=Fu(e),r=qu(e);return t.Z().next((()=>i.Z())).next((()=>r.Z()))}createTargetIndexes(e,t){return re.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((r=>{if(r===0||r===1){const a=new eb(i).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const i=Fu(e);let r=!0;const a=new Map;return re.forEach(this.Mn(t),(u=>this.xn(e,u).next((f=>{r&&(r=!!f),a.set(u,f)})))).next((()=>{if(r){let u=_t();const f=[];return re.forEach(a,((m,p)=>{Ce(nb,`Using index ${(function(Q){return`id=${Q.indexId}|cg=${Q.collectionGroup}|f=${Q.fields.map((pe=>`${pe.fieldPath}:${pe.kind}`)).join(",")}`})(m)} to execute ${Hl(t)}`);const E=(function(Q,pe){const he=$_(pe);if(he===void 0)return null;for(const Y of Sm(Q,he.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null})(p,m),S=(function(Q,pe){const he=new Map;for(const Y of Sl(pe))for(const D of Sm(Q,Y.fieldPath))switch(D.op){case"==":case"in":he.set(Y.fieldPath.canonicalString(),D.value);break;case"not-in":case"!=":return he.set(Y.fieldPath.canonicalString(),D.value),Array.from(he.values())}return null})(p,m),A=(function(Q,pe){const he=[];let Y=!0;for(const D of Sl(pe)){const B=D.kind===0?kS(Q,D.fieldPath,Q.startAt):LS(Q,D.fieldPath,Q.startAt);he.push(B.value),Y&&(Y=B.inclusive)}return new mc(he,Y)})(p,m),R=(function(Q,pe){const he=[];let Y=!0;for(const D of Sl(pe)){const B=D.kind===0?LS(Q,D.fieldPath,Q.endAt):kS(Q,D.fieldPath,Q.endAt);he.push(B.value),Y&&(Y=B.inclusive)}return new mc(he,Y)})(p,m),V=this.On(m,p,A),z=this.On(m,p,R),Z=this.Nn(m,p,S),X=this.Bn(m.indexId,E,V,A.inclusive,z,R.inclusive,Z);return re.forEach(X,(ne=>i.Y(ne,t.limit).next((Q=>{Q.forEach((pe=>{const he=ke.fromSegments(pe.documentKey);u.has(he)||(u=u.add(he),f.push(he))}))}))))})).next((()=>f))}return re.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=PU(Wt.create(e.filters,"and")).map((i=>ay(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,r,a,u,f){const m=(t!=null?t.length:1)*Math.max(i.length,a.length),p=m/(t!=null?t.length:1),E=[];for(let S=0;S<m;++S){const A=t?this.Ln(t[S/p]):kf,R=this.kn(e,A,i[S%p],r),V=this.qn(e,A,a[S%p],u),z=f.map((Z=>this.kn(e,A,Z,!0)));E.push(...this.createRange(R,V,z))}return E}kn(e,t,i,r){const a=new Nl(e,ke.empty(),t,i);return r?a:a.An()}qn(e,t,i,r){const a=new Nl(e,ke.empty(),t,i);return r?a.An():a}xn(e,t){const i=new eb(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((a=>{let u=null;for(const f of a)i.yn(f)&&(!u||f.fields.length>u.fields.length)&&(u=f);return u}))}getIndexType(e,t){let i=2;const r=this.Mn(t);return re.forEach(r,(a=>this.xn(e,a).next((u=>{u?i!==0&&u.fields.length<(function(m){let p=new Qt(Tn.comparator),E=!1;for(const S of m.filters)for(const A of S.getFlattenedFilters())A.field.isKeyField()||(A.op==="array-contains"||A.op==="array-contains-any"?E=!0:p=p.add(A.field));for(const S of m.orderBy)S.field.isKeyField()||(p=p.add(S.field));return p.size+(E?1:0)})(a)&&(i=1):i=0})))).next((()=>(function(u){return u.limit!==null})(t)&&r.length>1&&i===2?1:i))}Qn(e,t){const i=new Sd;for(const r of Sl(e)){const a=t.data.field(r.fieldPath);if(a==null)return null;const u=i.Pn(r.kind);Cl.Kt.Dt(a,u)}return i.un()}Ln(e){const t=new Sd;return Cl.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Sd;return Cl.Kt.Dt(oh(this.databaseId,t),i.Pn((function(a){const u=Sl(a);return u.length===0?0:u[u.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let r=[];r.push(new Sd);let a=0;for(const u of Sl(e)){const f=i[a++];for(const m of r)if(this.Un(t,u.fieldPath)&&ah(f))r=this.Kn(r,u,f);else{const p=m.Pn(u.kind);Cl.Kt.Dt(f,p)}}return this.Wn(r)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const r=[...e],a=[];for(const u of i.arrayValue.values||[])for(const f of r){const m=new Sd;m.seed(f.un()),Cl.Kt.Dt(u,m.Pn(t.kind)),a.push(m)}return a}Un(e,t){return!!e.filters.find((i=>i instanceof Nt&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=bd(e),r=qu(e);return(t?i.J(ey,IDBKeyRange.bound(t,t)):i.J()).next((a=>{const u=[];return re.forEach(a,(f=>r.get([f.indexId,this.uid]).next((m=>{u.push((function(E,S){const A=S?new Xd(S.sequenceNumber,new Ss(Zl(S.readTime),new ke(kr(S.documentKey)),S.largestBatchId)):Xd.empty(),R=E.fields.map((([V,z])=>new Kf(Tn.fromServerFormat(V),z)));return new _m(E.indexId,E.collectionGroup,R,A)})(f,m))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,r)=>{const a=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return a!==0?a:ot(i.collectionGroup,r.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const r=bd(e),a=qu(e);return this.Gn(e).next((u=>r.J(ey,IDBKeyRange.bound(t,t)).next((f=>re.forEach(f,(m=>a.put(JS(m.indexId,this.uid,u,i))))))))}updateIndexEntries(e,t){const i=new Map;return re.forEach(t,((r,a)=>{const u=i.get(r.collectionGroup);return(u?re.resolve(u):this.getFieldIndexes(e,r.collectionGroup)).next((f=>(i.set(r.collectionGroup,f),re.forEach(f,(m=>this.zn(e,r,m).next((p=>{const E=this.jn(a,m);return p.isEqual(E)?re.resolve():this.Jn(e,a,m,p,E)})))))))}))}Hn(e,t,i,r){return Fu(e).put(r.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,r){return Fu(e).delete(r.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const r=Fu(e);let a=new Qt(ma);return r.ee({index:iI,range:IDBKeyRange.only([i.indexId,this.uid,em(this.$n(i,t))])},((u,f)=>{a=a.add(new Nl(i.indexId,t,XS(f.arrayValue),XS(f.directionalValue)))})).next((()=>a))}jn(e,t){let i=new Qt(ma);const r=this.Qn(t,e);if(r==null)return i;const a=$_(t);if(a!=null){const u=e.data.field(a.fieldPath);if(ah(u))for(const f of u.arrayValue.values||[])i=i.add(new Nl(t.indexId,e.key,this.Ln(f),r))}else i=i.add(new Nl(t.indexId,e.key,kf,r));return i}Jn(e,t,i,r,a){Ce(nb,"Updating index entries for document '%s'",t.key);const u=[];return(function(m,p,E,S,A){const R=m.getIterator(),V=p.getIterator();let z=Bu(R),Z=Bu(V);for(;z||Z;){let X=!1,ne=!1;if(z&&Z){const Q=E(z,Z);Q<0?ne=!0:Q>0&&(X=!0)}else z!=null?ne=!0:X=!0;X?(S(Z),Z=Bu(V)):ne?(A(z),z=Bu(R)):(z=Bu(R),Z=Bu(V))}})(r,a,ma,(f=>{u.push(this.Hn(e,t,i,f))}),(f=>{u.push(this.Yn(e,t,i,f))})),re.waitFor(u)}Gn(e){let t=1;return qu(e).ee({index:nI,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,r,a)=>{a.done(),t=r.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((u,f)=>ma(u,f))).filter(((u,f,m)=>!f||ma(u,m[f-1])!==0));const r=[];r.push(e);for(const u of i){const f=ma(u,e),m=ma(u,t);if(f===0)r[0]=e.An();else if(f>0&&m<0)r.push(u),r.push(u.An());else if(m>0)break}r.push(t);const a=[];for(let u=0;u<r.length;u+=2){if(this.Zn(r[u],r[u+1]))return[];const f=r[u].Vn(this.uid,kf,ke.empty()),m=r[u+1].Vn(this.uid,kf,ke.empty());a.push(IDBKeyRange.bound(f,m))}return a}Zn(e,t){return ma(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(sb)}getMinOffset(e,t){return re.mapArray(this.Mn(t),(i=>this.xn(e,i).next((r=>r||ze(44426))))).next(sb)}}function ib(n){return Kn(n,ih)}function Fu(n){return Kn(n,Gd)}function bd(n){return Kn(n,cv)}function qu(n){return Kn(n,qd)}function sb(n){Ze(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const r=n[i].indexState.offset;av(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Ss(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},aC=41943040;class yi{static withCacheSize(e){return new yi(e,yi.DEFAULT_COLLECTION_PERCENTILE,yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(n,e,t){const i=n.store(rr),r=n.store(lc),a=[],u=IDBKeyRange.only(t.batchId);let f=0;const m=i.ee({range:u},((E,S,A)=>(f++,A.delete())));a.push(m.next((()=>{Ze(f===1,47070,{batchId:t.batchId})})));const p=[];for(const E of t.mutations){const S=XA(e,E.key.path,t.batchId);a.push(r.delete(S)),p.push(E.key)}return re.waitFor(a).next((()=>p))}function Nm(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ze(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yi.DEFAULT_COLLECTION_PERCENTILE=10,yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,yi.DEFAULT=new yi(aC,yi.DEFAULT_COLLECTION_PERCENTILE,yi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),yi.DISABLED=new yi(-1,0,0);class hp{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Xn={}}static wt(e,t,i,r){Ze(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new hp(a,t,i,r)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return pa(e).ee({index:Pl,range:i},((r,a,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,i,r){const a=Ju(e),u=pa(e);return u.add({}).next((f=>{Ze(typeof f=="number",49019);const m=new Tv(f,t,i,r),p=(function(R,V,z){const Z=z.baseMutations.map((ne=>Am(R.yt,ne))),X=z.mutations.map((ne=>Am(R.yt,ne)));return{userId:V,batchId:z.batchId,localWriteTimeMs:z.localWriteTime.toMillis(),baseMutations:Z,mutations:X}})(this.serializer,this.userId,m),E=[];let S=new Qt(((A,R)=>ot(A.canonicalString(),R.canonicalString())));for(const A of r){const R=XA(this.userId,A.key.path,f);S=S.add(A.key.path.popLast()),E.push(u.put(p)),E.push(a.put(R,hO))}return S.forEach((A=>{E.push(this.indexManager.addToCollectionParentIndex(e,A))})),e.addOnCommittedListener((()=>{this.Xn[f]=m.keys()})),re.waitFor(E).next((()=>m))}))}lookupMutationBatch(e,t){return pa(e).get(t).next((i=>i?(Ze(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),Il(this.serializer,i)):null))}er(e,t){return this.Xn[t]?re.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const r=i.keys();return this.Xn[t]=r,r}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]);let a=null;return pa(e).ee({index:Pl,range:r},((u,f,m)=>{f.userId===this.userId&&(Ze(f.batchId>=i,47524,{tr:i}),a=Il(this.serializer,f)),m.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=kl;return pa(e).ee({index:Pl,range:t,reverse:!0},((r,a,u)=>{i=a.batchId,u.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,kl],[this.userId,Number.POSITIVE_INFINITY]);return pa(e).J(Pl,t).next((i=>i.map((r=>Il(this.serializer,r)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Zf(this.userId,t.path),r=IDBKeyRange.lowerBound(i),a=[];return Ju(e).ee({range:r},((u,f,m)=>{const[p,E,S]=u,A=kr(E);if(p===this.userId&&t.path.isEqual(A))return pa(e).get(S).next((R=>{if(!R)throw ze(61480,{nr:u,batchId:S});Ze(R.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:R.userId,batchId:S}),a.push(Il(this.serializer,R))}));m.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Qt(ot);const r=[];return t.forEach((a=>{const u=Zf(this.userId,a.path),f=IDBKeyRange.lowerBound(u),m=Ju(e).ee({range:f},((p,E,S)=>{const[A,R,V]=p,z=kr(R);A===this.userId&&a.path.isEqual(z)?i=i.add(V):S.done()}));r.push(m)})),re.waitFor(r).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1,a=Zf(this.userId,i),u=IDBKeyRange.lowerBound(a);let f=new Qt(ot);return Ju(e).ee({range:u},((m,p,E)=>{const[S,A,R]=m,V=kr(A);S===this.userId&&i.isPrefixOf(V)?V.length===r&&(f=f.add(R)):E.done()})).next((()=>this.rr(e,f)))}rr(e,t){const i=[],r=[];return t.forEach((a=>{r.push(pa(e).get(a).next((u=>{if(u===null)throw ze(35274,{batchId:a});Ze(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:a}),i.push(Il(this.serializer,u))})))})),re.waitFor(r).next((()=>i))}removeMutationBatch(e,t){return lC(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),re.forEach(i,(r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return re.resolve();const i=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),r=[];return Ju(e).ee({range:i},((a,u,f)=>{if(a[0]===this.userId){const m=kr(a[1]);r.push(m)}else f.done()})).next((()=>{Ze(r.length===0,56720,{sr:r.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return uC(e,this.userId,t)}_r(e){return cC(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:kl,lastStreamToken:""}))}}function uC(n,e,t){const i=Zf(e,t.path),r=i[1],a=IDBKeyRange.lowerBound(i);let u=!1;return Ju(n).ee({range:a,X:!0},((f,m,p)=>{const[E,S,A]=f;E===e&&S===r&&(u=!0),p.done()})).next((()=>u))}function pa(n){return Kn(n,rr)}function Ju(n){return Kn(n,lc)}function cC(n){return Kn(n,th)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Jl(0)}static cr(){return new Jl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Jl(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Qe.fromTimestamp(new Yt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.hr(e,r))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Gu(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Ze(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let r=0;const a=[];return Gu(e).ee(((u,f)=>{const m=kd(f);m.sequenceNumber<=t&&i.get(m.targetId)===null&&(r++,a.push(this.removeTargetData(e,m)))})).next((()=>re.waitFor(a))).next((()=>r))}forEachTarget(e,t){return Gu(e).ee(((i,r)=>{const a=kd(r);t(a)}))}lr(e){return ob(e).get(Tm).next((t=>(Ze(t!==null,2888),t)))}hr(e,t){return ob(e).put(Tm,t)}Pr(e,t){return Gu(e).put(iC(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=Hl(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let a=null;return Gu(e).ee({range:r,index:tI},((u,f,m)=>{const p=kd(f);_h(t,p.target)&&(a=p,m.done())})).next((()=>a))}addMatchingKeys(e,t,i){const r=[],a=Ta(e);return t.forEach((u=>{const f=Ei(u.path);r.push(a.put({targetId:i,path:f})),r.push(this.referenceDelegate.addReference(e,i,u))})),re.waitFor(r)}removeMatchingKeys(e,t,i){const r=Ta(e);return re.forEach(t,(a=>{const u=Ei(a.path);return re.waitFor([r.delete([i,u]),this.referenceDelegate.removeReference(e,i,a)])}))}removeMatchingKeysForTargetId(e,t){const i=Ta(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Ta(e);let a=_t();return r.ee({range:i,X:!0},((u,f,m)=>{const p=kr(u[1]),E=new ke(p);a=a.add(E)})).next((()=>a))}containsKey(e,t){const i=Ei(t.path),r=IDBKeyRange.bound([i],[HA(i)],!1,!0);let a=0;return Ta(e).ee({index:uv,X:!0,range:r},(([u,f],m,p)=>{u!==0&&(a++,p.done())})).next((()=>a>0))}At(e,t){return Gu(e).get(t).next((i=>i?kd(i):null))}}function Gu(n){return Kn(n,uc)}function ob(n){return Kn(n,Ll)}function Ta(n){return Kn(n,cc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab="LruGarbageCollector",VU=1048576;function lb([n,e],[t,i]){const r=ot(n,t);return r===0?ot(e,i):r}class OU{constructor(e){this.Ir=e,this.buffer=new Qt(lb),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();lb(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class dC{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ce(ab,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ua(t)?Ce(ab,"Ignoring IndexedDB error during garbage collection: ",t):await Oa(t)}await this.Vr(3e5)}))}}class UU{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return re.resolve(Xi.ce);const i=new OU(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ce("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(rb)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rb):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,a,u,f,m,p;const E=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((S=>(S>this.params.maximumSequenceNumbersToCollect?(Ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),r=this.params.maximumSequenceNumbersToCollect):r=S,u=Date.now(),this.nthSequenceNumber(e,r)))).next((S=>(i=S,f=Date.now(),this.removeTargets(e,i,t)))).next((S=>(a=S,m=Date.now(),this.removeOrphanedDocuments(e,i)))).next((S=>(p=Date.now(),Hu()<=Ct.DEBUG&&Ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-E}ms
	Determined least recently used ${r} in `+(f-u)+`ms
	Removed ${a} targets in `+(m-f)+`ms
	Removed ${S} documents in `+(p-m)+`ms
Total Duration: ${p-E}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:S}))))}}function hC(n,e){return new UU(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e,t){this.db=e,this.garbageCollector=hC(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,r)=>t(r)))}addReference(e,t,i){return Lf(e,i)}removeReference(e,t,i){return Lf(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Lf(e,t)}br(e,t){return(function(r,a){let u=!1;return cC(r).te((f=>uC(r,f,a).next((m=>(m&&(u=!0),re.resolve(!m)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let a=0;return this.Sr(e,((u,f)=>{if(f<=t){const m=this.br(e,u).next((p=>{if(!p)return a++,i.getEntry(e,u).next((()=>(i.removeEntry(u,Qe.min()),Ta(e).delete((function(S){return[0,Ei(S.path)]})(u)))))}));r.push(m)}})).next((()=>re.waitFor(r))).next((()=>i.apply(e))).next((()=>a))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Lf(e,t)}Sr(e,t){const i=Ta(e);let r,a=Xi.ce;return i.ee({index:uv},(([u,f],{path:m,sequenceNumber:p})=>{u===0?(a!==Xi.ce&&t(new ke(kr(r)),a),a=p,r=m):a=Xi.ce})).next((()=>{a!==Xi.ce&&t(new ke(kr(r)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Lf(n,e){return Ta(n).put((function(i,r){return{targetId:0,path:Ei(i.path),sequenceNumber:r}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(){this.changes=new Co((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,In.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?re.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return El(e).put(i)}removeEntry(e,t,i){return El(e).delete((function(a,u){const f=a.path.toArray();return[f.slice(0,f.length-2),f[f.length-2],Im(u),f[f.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=In.newInvalidDocument(t);return El(e).ee({index:Jf,range:IDBKeyRange.only(Ad(t))},((r,a)=>{i=this.Cr(t,a)})).next((()=>i))}vr(e,t){let i={size:0,document:In.newInvalidDocument(t)};return El(e).ee({index:Jf,range:IDBKeyRange.only(Ad(t))},((r,a)=>{i={document:this.Cr(t,a),size:Nm(a)}})).next((()=>i))}getEntries(e,t){let i=xs();return this.Fr(e,t,((r,a)=>{const u=this.Cr(r,a);i=i.insert(r,u)})).next((()=>i))}Mr(e,t){let i=xs(),r=new un(ke.comparator);return this.Fr(e,t,((a,u)=>{const f=this.Cr(a,u);i=i.insert(a,f),r=r.insert(a,Nm(u))})).next((()=>({documents:i,Or:r})))}Fr(e,t,i){if(t.isEmpty())return re.resolve();let r=new Qt(db);t.forEach((m=>r=r.add(m)));const a=IDBKeyRange.bound(Ad(r.first()),Ad(r.last())),u=r.getIterator();let f=u.getNext();return El(e).ee({index:Jf,range:a},((m,p,E)=>{const S=ke.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;f&&db(f,S)<0;)i(f,null),f=u.getNext();f&&f.isEqual(S)&&(i(f,p),f=u.hasNext()?u.getNext():null),f?E.j(Ad(f)):E.done()})).next((()=>{for(;f;)i(f,null),f=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,i,r,a){const u=t.path,f=[u.popLast().toArray(),u.lastSegment(),Im(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],m=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return El(e).J(IDBKeyRange.bound(f,m,!0)).next((p=>{a==null||a.incrementDocumentReadCount(p.length);let E=xs();for(const S of p){const A=this.Cr(ke.fromSegments(S.prefixPath.concat(S.collectionGroup,S.documentId)),S);A.isFoundDocument()&&(vh(t,A)||r.has(A.key))&&(E=E.insert(A.key,A))}return E}))}getAllFromCollectionGroup(e,t,i,r){let a=xs();const u=cb(t,i),f=cb(t,Ss.max());return El(e).ee({index:eI,range:IDBKeyRange.bound(u,f,!0)},((m,p,E)=>{const S=this.Cr(ke.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(S.key,S),a.size===r&&E.done()})).next((()=>a))}newChangeBuffer(e){return new FU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return ub(e).get(X_).next((t=>(Ze(!!t,20021),t)))}Dr(e,t){return ub(e).put(X_,t)}Cr(e,t){if(t){const i=bU(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Qe.min())))return i}return In.newInvalidDocument(e)}}function mC(n){return new zU(n)}class FU extends fC{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Co((i=>i.toString()),((i,r)=>i.isEqual(r)))}applyChanges(e){const t=[];let i=0,r=new Qt(((a,u)=>ot(a.canonicalString(),u.canonicalString())));return this.changes.forEach(((a,u)=>{const f=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,f.readTime)),u.isValidDocument()){const m=KS(this.Nr.serializer,u);r=r.add(a.path.popLast());const p=Nm(m);i+=p-f.size,t.push(this.Nr.addEntry(e,a,m))}else if(i-=f.size,this.trackRemovals){const m=KS(this.Nr.serializer,u.convertToNoDocument(Qe.min()));t.push(this.Nr.addEntry(e,a,m))}})),r.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,i)),re.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:r})=>(r.forEach(((a,u)=>{this.Br.set(a,{size:u,readTime:i.get(a).readTime})})),i)))}}function ub(n){return Kn(n,nh)}function El(n){return Kn(n,vm)}function Ad(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function cb(n,e){const t=e.documentKey.path.toArray();return[n,Im(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function db(n,e){const t=n.path.toArray(),i=e.path.toArray();let r=0;for(let a=0;a<t.length-2&&a<i.length-2;++a)if(r=ot(t[a],i[a]),r)return r;return r=ot(t.length,i.length),r||(r=ot(t[t.length-2],i[i.length-2]),r||ot(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&Zd(i.mutation,r,es.empty(),Yt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,_t()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=_t()){const r=Lr();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((a=>{let u=Pd();return a.forEach(((f,m)=>{u=u.insert(f,m.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const i=Lr();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,_t())))}populateOverlays(e,t,i){const r=[];return i.forEach((a=>{t.has(a)||r.push(a)})),this.documentOverlayCache.getOverlays(e,r).next((a=>{a.forEach(((u,f)=>{t.set(u,f)}))}))}computeViews(e,t,i,r){let a=xs();const u=Kd(),f=(function(){return Kd()})();return t.forEach(((m,p)=>{const E=i.get(p.key);r.has(p.key)&&(E===void 0||E.mutation instanceof No)?a=a.insert(p.key,p):E!==void 0?(u.set(p.key,E.mutation.getFieldMask()),Zd(E.mutation,p,E.mutation.getFieldMask(),Yt.now())):u.set(p.key,es.empty())})),this.recalculateAndSaveOverlays(e,a).next((m=>(m.forEach(((p,E)=>u.set(p,E))),t.forEach(((p,E)=>f.set(p,new qU(E,u.get(p)??null)))),f)))}recalculateAndSaveOverlays(e,t){const i=Kd();let r=new un(((u,f)=>u-f)),a=_t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const f of u)f.keys().forEach((m=>{const p=t.get(m);if(p===null)return;let E=i.get(m)||es.empty();E=f.applyToLocalView(p,E),i.set(m,E);const S=(r.get(f.batchId)||_t()).add(m);r=r.insert(f.batchId,S)}))})).next((()=>{const u=[],f=r.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),p=m.key,E=m.value,S=DI();E.forEach((A=>{if(!a.has(A)){const R=BI(t.get(A),i.get(A));R!==null&&S.set(A,R),a=a.add(A)}})),u.push(this.documentOverlayCache.saveOverlays(e,p,S))}return re.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(u){return ke.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):II(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((a=>{const u=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-a.size):re.resolve(Lr());let f=ac,m=a;return u.next((p=>re.forEach(p,((E,S)=>(f<S.largestBatchId&&(f=S.largestBatchId),a.get(E)?re.resolve():this.remoteDocumentCache.getEntry(e,E).next((A=>{m=m.insert(E,A)}))))).next((()=>this.populateOverlays(e,p,a))).next((()=>this.computeViews(e,m,p,_t()))).next((E=>({batchId:f,changes:PI(E)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ke(t)).next((i=>{let r=Pd();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const a=t.collectionGroup;let u=Pd();return this.indexManager.getCollectionParents(e,a).next((f=>re.forEach(f,(m=>{const p=(function(S,A){return new yh(A,null,S.explicitOrderBy.slice(),S.filters.slice(),S.limit,S.limitType,S.startAt,S.endAt)})(t,m.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,i,r).next((E=>{E.forEach(((S,A)=>{u=u.insert(S,A)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((u=>(a=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,a,r)))).next((u=>{a.forEach(((m,p)=>{const E=p.getKey();u.get(E)===null&&(u=u.insert(E,In.newInvalidDocument(E)))}));let f=Pd();return u.forEach(((m,p)=>{const E=a.get(m);E!==void 0&&Zd(E.mutation,p,es.empty(),Yt.now()),vh(t,p)&&(f=f.insert(m,p))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return re.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Di(r.createTime)}})(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:sC(r.bundledQuery),readTime:Di(r.readTime)}})(t)),re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{constructor(){this.overlays=new un(ke.comparator),this.qr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Lr();return re.forEach(t,(r=>this.getOverlay(e,r).next((a=>{a!==null&&i.set(r,a)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,a)=>{this.St(e,t,a)})),re.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(i)),re.resolve()}getOverlaysForCollection(e,t,i){const r=Lr(),a=t.length+1,u=new ke(t.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const m=f.getNext().value,p=m.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&m.largestBatchId>i&&r.set(m.getKey(),m)}return re.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let a=new un(((p,E)=>p-E));const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let E=a.get(p.largestBatchId);E===null&&(E=Lr(),a=a.insert(p.largestBatchId,E)),E.set(p.getKey(),p)}}const f=Lr(),m=a.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((p,E)=>f.set(p,E))),!(f.size()>=r)););return re.resolve(f)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const u=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new Ev(t,i));let a=this.qr.get(t);a===void 0&&(a=_t(),this.qr.set(t,a)),this.qr.set(t,a.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jU{constructor(){this.sessionToken=Dn.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(){this.Qr=new Qt(ti.$r),this.Ur=new Qt(ti.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new ti(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new ti(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new ke(new Ht([])),i=new ti(t,e),r=new ti(t,e+1),a=[];return this.Ur.forEachInRange([i,r],(u=>{this.Gr(u),a.push(u.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ke(new Ht([])),i=new ti(t,e),r=new ti(t,e+1);let a=_t();return this.Ur.forEachInRange([i,r],(u=>{a=a.add(u.key)})),a}containsKey(e){const t=new ti(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class ti{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ke.comparator(e.key,t.key)||ot(e.Yr,t.Yr)}static Kr(e,t){return ot(e.Yr,t.Yr)||ke.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Qt(ti.$r)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new Tv(a,t,i,r);this.mutationQueue.push(u);for(const f of r)this.Zr=this.Zr.add(new ti(f.key,a)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return re.resolve(u)}lookupMutationBatch(e,t){return re.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),a=r<0?0:r;return re.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?kl:this.tr-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new ti(t,0),r=new ti(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([i,r],(u=>{const f=this.Xr(u.Yr);a.push(f)})),re.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Qt(ot);return t.forEach((r=>{const a=new ti(r,0),u=new ti(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,u],(f=>{i=i.add(f.Yr)}))})),re.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let a=i;ke.isDocumentKey(a)||(a=a.child(""));const u=new ti(new ke(a),0);let f=new Qt(ot);return this.Zr.forEachWhile((m=>{const p=m.key.path;return!!i.isPrefixOf(p)&&(p.length===r&&(f=f.add(m.Yr)),!0)}),u),re.resolve(this.ti(f))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Ze(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return re.forEach(t.mutations,(r=>{const a=new ti(r.key,t.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new ti(t,0),r=this.Zr.firstAfterOrEqual(i);return re.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZU{constructor(e){this.ri=e,this.docs=(function(){return new un(ke.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),a=r?r.size:0,u=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-a,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return re.resolve(i?i.document.mutableCopy():In.newInvalidDocument(t))}getEntries(e,t){let i=xs();return t.forEach((r=>{const a=this.docs.get(r);i=i.insert(r,a?a.document.mutableCopy():In.newInvalidDocument(r))})),re.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let a=xs();const u=t.path,f=new ke(u.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:p,value:{document:E}}=m.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||av(JA(E),i)<=0||(r.has(E.key)||vh(t,E))&&(a=a.insert(E.key,E.mutableCopy()))}return re.resolve(a)}getAllFromCollectionGroup(e,t,i,r){ze(9500)}ii(e,t){return re.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new JU(this)}getSize(e){return re.resolve(this.size)}}class JU extends fC{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),re.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YU{constructor(e){this.persistence=e,this.si=new Co((t=>Hl(t)),_h),this.lastRemoteSnapshotVersion=Qe.min(),this.highestTargetId=0,this.oi=0,this._i=new Iv,this.targetCount=0,this.ai=Jl.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),re.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Jl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.Pr(t),re.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,i){let r=0;const a=[];return this.si.forEach(((u,f)=>{f.sequenceNumber<=t&&i.get(f.targetId)===null&&(this.si.delete(u),a.push(this.removeMatchingKeysForTargetId(e,f.targetId)),r++)})),re.waitFor(a).next((()=>r))}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return re.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),re.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,a=[];return r&&t.forEach((u=>{a.push(r.markPotentiallyOrphaned(e,u))})),re.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),re.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return re.resolve(i)}containsKey(e,t){return re.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,t){this.ui={},this.overlays={},this.ci=new Xi(0),this.li=!1,this.li=!0,this.hi=new jU,this.referenceDelegate=e(this),this.Pi=new YU(this),this.indexManager=new DU,this.remoteDocumentCache=(function(r){return new ZU(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new nC(t),this.Ii=new GU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new HU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new KU(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){Ce("MemoryPersistence","Starting transaction:",e);const r=new WU(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((a=>this.referenceDelegate.di(r).next((()=>a)))).toPromise().then((a=>(r.raiseOnCommittedEvent(),a)))}Ai(e,t){return re.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class WU extends WA{constructor(e){super(),this.currentSequenceNumber=e}}class fp{constructor(e){this.persistence=e,this.Ri=new Iv,this.Vi=null}static mi(e){return new fp(e)}get fi(){if(this.Vi)return this.Vi;throw ze(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),re.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),re.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((a=>this.fi.add(a.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.fi,(i=>{const r=ke.fromPath(i);return this.gi(e,r).next((a=>{a||t.removeEntry(r,Qe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return re.or([()=>re.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Rm{constructor(e,t){this.persistence=e,this.pi=new Co((i=>Ei(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=hC(this,t)}static mi(e,t){return new Rm(e,t)}Ei(){}di(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return re.forEach(this.pi,((i,r)=>this.br(e,i,r).next((a=>a?re.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),a=r.newChangeBuffer();return r.ii(e,(u=>this.br(e,u,t).next((f=>{f||(i++,a.removeEntry(u,Qe.min()))})))).next((()=>a.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),re.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),re.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wf(e.data.value)),t}br(e,t,i){return re.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return re.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QU{constructor(e){this.serializer=e}k(e,t,i,r){const a=new Xm("createOrUpgrade",t);i<1&&r>=1&&((function(m){m.createObjectStore(gh)})(e),(function(m){m.createObjectStore(th,{keyPath:dO}),m.createObjectStore(rr,{keyPath:ES,autoIncrement:!0}).createIndex(Pl,wS,{unique:!0}),m.createObjectStore(lc)})(e),hb(e),(function(m){m.createObjectStore(bl)})(e));let u=re.resolve();return i<3&&r>=3&&(i!==0&&((function(m){m.deleteObjectStore(cc),m.deleteObjectStore(uc),m.deleteObjectStore(Ll)})(e),hb(e)),u=u.next((()=>(function(m){const p=m.store(Ll),E={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Qe.min().toTimestamp(),targetCount:0};return p.put(Tm,E)})(a)))),i<4&&r>=4&&(i!==0&&(u=u.next((()=>(function(m,p){return p.store(rr).J().next((S=>{m.deleteObjectStore(rr),m.createObjectStore(rr,{keyPath:ES,autoIncrement:!0}).createIndex(Pl,wS,{unique:!0});const A=p.store(rr),R=S.map((V=>A.put(V)));return re.waitFor(R)}))})(e,a)))),u=u.next((()=>{(function(m){m.createObjectStore(dc,{keyPath:TO})})(e)}))),i<5&&r>=5&&(u=u.next((()=>this.yi(a)))),i<6&&r>=6&&(u=u.next((()=>((function(m){m.createObjectStore(nh)})(e),this.wi(a))))),i<7&&r>=7&&(u=u.next((()=>this.Si(a)))),i<8&&r>=8&&(u=u.next((()=>this.bi(e,a)))),i<9&&r>=9&&(u=u.next((()=>{(function(m){m.objectStoreNames.contains("remoteDocumentChanges")&&m.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&r>=10&&(u=u.next((()=>this.Di(a)))),i<11&&r>=11&&(u=u.next((()=>{(function(m){m.createObjectStore(tp,{keyPath:xO})})(e),(function(m){m.createObjectStore(np,{keyPath:EO})})(e)}))),i<12&&r>=12&&(u=u.next((()=>{(function(m){const p=m.createObjectStore(ip,{keyPath:NO});p.createIndex(ty,RO,{unique:!1}),p.createIndex(sI,MO,{unique:!1})})(e)}))),i<13&&r>=13&&(u=u.next((()=>(function(m){const p=m.createObjectStore(vm,{keyPath:fO});p.createIndex(Jf,mO),p.createIndex(eI,pO)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(bl)))),i<14&&r>=14&&(u=u.next((()=>this.Fi(e,a)))),i<15&&r>=15&&(u=u.next((()=>(function(m){m.createObjectStore(cv,{keyPath:wO,autoIncrement:!0}).createIndex(ey,SO,{unique:!1}),m.createObjectStore(qd,{keyPath:bO}).createIndex(nI,AO,{unique:!1}),m.createObjectStore(Gd,{keyPath:IO}).createIndex(iI,CO,{unique:!1})})(e)))),i<16&&r>=16&&(u=u.next((()=>{t.objectStore(qd).clear()})).next((()=>{t.objectStore(Gd).clear()}))),i<17&&r>=17&&(u=u.next((()=>{(function(m){m.createObjectStore(dv,{keyPath:PO})})(e)}))),i<18&&r>=18&&$1()&&(u=u.next((()=>{t.objectStore(qd).clear()})).next((()=>{t.objectStore(Gd).clear()}))),u}wi(e){let t=0;return e.store(bl).ee(((i,r)=>{t+=Nm(r)})).next((()=>{const i={byteSize:t};return e.store(nh).put(X_,i)}))}yi(e){const t=e.store(th),i=e.store(rr);return t.J().next((r=>re.forEach(r,(a=>{const u=IDBKeyRange.bound([a.userId,kl],[a.userId,a.lastAcknowledgedBatchId]);return i.J(Pl,u).next((f=>re.forEach(f,(m=>{Ze(m.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:m.batchId});const p=Il(this.serializer,m);return lC(e,a.userId,p).next((()=>{}))}))))}))))}Si(e){const t=e.store(cc),i=e.store(bl);return e.store(Ll).get(Tm).next((r=>{const a=[];return i.ee(((u,f)=>{const m=new Ht(u),p=(function(S){return[0,Ei(S)]})(m);a.push(t.get(p).next((E=>E?re.resolve():(S=>t.put({targetId:0,path:Ei(S),sequenceNumber:r.highestListenSequenceNumber}))(m))))})).next((()=>re.waitFor(a)))}))}bi(e,t){e.createObjectStore(ih,{keyPath:vO});const i=t.store(ih),r=new Av,a=u=>{if(r.add(u)){const f=u.lastSegment(),m=u.popLast();return i.put({collectionId:f,parent:Ei(m)})}};return t.store(bl).ee({X:!0},((u,f)=>{const m=new Ht(u);return a(m.popLast())})).next((()=>t.store(lc).ee({X:!0},(([u,f,m],p)=>{const E=kr(f);return a(E.popLast())}))))}Di(e){const t=e.store(uc);return t.ee(((i,r)=>{const a=kd(r),u=iC(this.serializer,a);return t.put(u)}))}Ci(e,t){const i=t.store(bl),r=[];return i.ee(((a,u)=>{const f=t.store(vm),m=(function(S){return S.document?new ke(Ht.fromString(S.document.name).popFirst(5)):S.noDocument?ke.fromSegments(S.noDocument.path):S.unknownDocument?ke.fromSegments(S.unknownDocument.path):ze(36783)})(u).path.toArray(),p={prefixPath:m.slice(0,m.length-2),collectionGroup:m[m.length-2],documentId:m[m.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};r.push(f.put(p))})).next((()=>re.waitFor(r)))}Fi(e,t){const i=t.store(rr),r=mC(this.serializer),a=new Cv(fp.mi,this.serializer.yt);return i.J().next((u=>{const f=new Map;return u.forEach((m=>{let p=f.get(m.userId)??_t();Il(this.serializer,m).keys().forEach((E=>p=p.add(E))),f.set(m.userId,p)})),re.forEach(f,((m,p)=>{const E=new ni(p),S=dp.wt(this.serializer,E),A=a.getIndexManager(E),R=hp.wt(E,this.serializer,A,a.referenceDelegate);return new pC(r,R,S,A).recalculateAndSaveOverlaysForDocumentKeys(new ny(t,Xi.ce),m).next()}))}))}}function hb(n){n.createObjectStore(cc,{keyPath:_O}).createIndex(uv,yO,{unique:!0}),n.createObjectStore(uc,{keyPath:"targetId"}).createIndex(tI,gO,{unique:!0}),n.createObjectStore(Ll)}const ga="IndexedDbPersistence",w_=18e5,S_=5e3,b_="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",$U="main";class Nv{constructor(e,t,i,r,a,u,f,m,p,E,S=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=a,this.window=u,this.document=f,this.xi=p,this.Oi=E,this.Ni=S,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=A=>Promise.resolve(),!Nv.v())throw new Pe(ye.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new BU(this,r),this.$i=t+$U,this.serializer=new nC(m),this.Ui=new Ca(this.$i,this.Ni,new QU(this.serializer)),this.hi=new IU,this.Pi=new LU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=mC(this.serializer),this.Ii=new AU,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,E===!1&&Mn(ga,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Pe(ye.FAILED_PRECONDITION,b_);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Xi(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Vf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Ua(e))return Ce(ga,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ce(ga,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return Id(e).get(Uu).next((t=>re.resolve(this.es(t))))}ts(e){return Vf(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,w_)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=Kn(t,dc);return i.J().next((r=>{const a=this.ss(r,w_),u=r.filter((f=>a.indexOf(f)===-1));return re.forEach(u,(f=>i.delete(f.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?re.resolve(!0):Id(e).get(Uu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,S_)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new Pe(ye.FAILED_PRECONDITION,b_);return!1}}return!(!this.networkEnabled||!this.inForeground)||Vf(e).J().next((i=>this.ss(i,S_).find((r=>{if(this.clientId!==r.clientId){const a=!this.networkEnabled&&r.networkEnabled,u=!this.inForeground&&r.inForeground,f=this.networkEnabled===r.networkEnabled;if(a||u&&f)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&Ce(ga,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[gh,dc],(e=>{const t=new ny(e,Xi.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Vf(e).J().next((t=>this.ss(t,w_).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return hp.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new kU(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return dp.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){Ce(ga,"Starting transaction:",e);const r=t==="readonly"?"readonly":"readwrite",a=(function(m){return m===18?LO:m===17?lI:m===16?kO:m===15?hv:m===14?aI:m===13?oI:m===12?DO:m===11?rI:void ze(60245)})(this.Ni);let u;return this.Ui.runTransaction(e,r,a,(f=>(u=new ny(f,this.ci?this.ci.next():Xi.ce),t==="readwrite-primary"?this.Hi(u).next((m=>!!m||this.Yi(u))).next((m=>{if(!m)throw Mn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new Pe(ye.FAILED_PRECONDITION,YA);return i(u)})).next((m=>this.Xi(u).next((()=>m)))):this.Is(u).next((()=>i(u)))))).then((f=>(u.raiseOnCommittedEvent(),f)))}Is(e){return Id(e).get(Uu).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,S_)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Pe(ye.FAILED_PRECONDITION,b_)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Id(e).put(Uu,t)}static v(){return Ca.v()}Zi(e){const t=Id(e);return t.get(Uu).next((i=>this.es(i)?(Ce(ga,"Releasing primary lease."),t.delete(Uu)):re.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Mn(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;Q1()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const i=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return Ce(ga,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Mn(ga,"Failed to get zombied client id.",i),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Mn("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Id(n){return Kn(n,gh)}function Vf(n){return Kn(n,dc)}function gC(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=_t(),r=_t();for(const a of t.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new Rv(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Q1()?8:QA(jn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const a={result:null};return this.ys(e,t).next((u=>{a.result=u})).next((()=>{if(!a.result)return this.ws(e,t,r,i).next((u=>{a.result=u}))})).next((()=>{if(a.result)return;const u=new XU;return this.Ss(e,t,u).next((f=>{if(a.result=f,this.Vs)return this.bs(e,t,u,f.size)}))})).next((()=>a.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Hu()<=Ct.DEBUG&&Ce("QueryEngine","SDK will not create cache indexes for query:",ju(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),re.resolve()):(Hu()<=Ct.DEBUG&&Ce("QueryEngine","Query:",ju(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Hu()<=Ct.DEBUG&&Ce("QueryEngine","The SDK decides to create cache indexes for query:",ju(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ws(t))):re.resolve())}ys(e,t){if(VS(t))return re.resolve(null);let i=ws(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=uy(t,null,"F"),i=ws(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((a=>{const u=_t(...a);return this.ps.getDocuments(e,u).next((f=>this.indexManager.getMinOffset(e,i).next((m=>{const p=this.Ds(t,f);return this.Cs(t,p,u,m.readTime)?this.ys(e,uy(t,null,"F")):this.vs(e,p,t,m)}))))})))))}ws(e,t,i,r){return VS(t)||r.isEqual(Qe.min())?re.resolve(null):this.ps.getDocuments(e,i).next((a=>{const u=this.Ds(t,a);return this.Cs(t,u,i,r)?re.resolve(null):(Hu()<=Ct.DEBUG&&Ce("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ju(t)),this.vs(e,u,t,ZA(r,ac)).next((f=>f)))}))}Ds(e,t){let i=new Qt(RI(e));return t.forEach(((r,a)=>{vh(e,a)&&(i=i.add(a))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}Ss(e,t,i){return Hu()<=Ct.DEBUG&&Ce("QueryEngine","Using full collection scan to execute query:",ju(t)),this.ps.getDocumentsMatchingQuery(e,t,Ss.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((a=>(t.forEach((u=>{a=a.insert(u.key,u)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv="LocalStore",e9=3e8;class t9{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new un(ot),this.xs=new Co((a=>Hl(a)),_h),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function yC(n,e,t,i){return new t9(n,e,t,i)}async function vC(n,e){const t=Ge(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((a=>(r=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((a=>{const u=[],f=[];let m=_t();for(const p of r){u.push(p.batchId);for(const E of p.mutations)m=m.add(E.key)}for(const p of a){f.push(p.batchId);for(const E of p.mutations)m=m.add(E.key)}return t.localDocuments.getDocuments(i,m).next((p=>({Ls:p,removedBatchIds:u,addedBatchIds:f})))}))}))}function n9(n,e){const t=Ge(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(f,m,p,E){const S=p.batch,A=S.keys();let R=re.resolve();return A.forEach((V=>{R=R.next((()=>E.getEntry(m,V))).next((z=>{const Z=p.docVersions.get(V);Ze(Z!==null,48541),z.version.compareTo(Z)<0&&(S.applyToRemoteDocument(z,p),z.isValidDocument()&&(z.setReadTime(p.commitVersion),E.addEntry(z)))}))})),R.next((()=>f.mutationQueue.removeMutationBatch(m,S)))})(t,i,e,a).next((()=>a.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(f){let m=_t();for(let p=0;p<f.mutationResults.length;++p)f.mutationResults[p].transformResults.length>0&&(m=m.add(f.batch.mutations[p].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function TC(n){const e=Ge(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function i9(n,e){const t=Ge(n),i=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const f=[];e.targetChanges.forEach(((E,S)=>{const A=r.get(S);if(!A)return;f.push(t.Pi.removeMatchingKeys(a,E.removedDocuments,S).next((()=>t.Pi.addMatchingKeys(a,E.addedDocuments,S))));let R=A.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(S)!==null?R=R.withResumeToken(Dn.EMPTY_BYTE_STRING,Qe.min()).withLastLimboFreeSnapshotVersion(Qe.min()):E.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(E.resumeToken,i)),r=r.insert(S,R),(function(z,Z,X){return z.resumeToken.approximateByteSize()===0||Z.snapshotVersion.toMicroseconds()-z.snapshotVersion.toMicroseconds()>=e9?!0:X.addedDocuments.size+X.modifiedDocuments.size+X.removedDocuments.size>0})(A,R,E)&&f.push(t.Pi.updateTargetData(a,R))}));let m=xs(),p=_t();if(e.documentUpdates.forEach((E=>{e.resolvedLimboDocuments.has(E)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(a,E))})),f.push(s9(a,u,e.documentUpdates).next((E=>{m=E.ks,p=E.qs}))),!i.isEqual(Qe.min())){const E=t.Pi.getLastRemoteSnapshotVersion(a).next((S=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,i)));f.push(E)}return re.waitFor(f).next((()=>u.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,m,p))).next((()=>m))})).then((a=>(t.Ms=r,a)))}function s9(n,e,t){let i=_t(),r=_t();return t.forEach((a=>i=i.add(a))),e.getEntries(n,i).next((a=>{let u=xs();return t.forEach(((f,m)=>{const p=a.get(f);m.isFoundDocument()!==p.isFoundDocument()&&(r=r.add(f)),m.isNoDocument()&&m.version.isEqual(Qe.min())?(e.removeEntry(f,m.readTime),u=u.insert(f,m)):!p.isValidDocument()||m.version.compareTo(p.version)>0||m.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(m),u=u.insert(f,m)):Ce(Mv,"Ignoring outdated watch update for ",f,". Current version:",p.version," Watch version:",m.version)})),{ks:u,qs:r}}))}function r9(n,e){const t=Ge(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=kl),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Mm(n,e){const t=Ge(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Pi.getTargetData(i,e).next((a=>a?(r=a,re.resolve(r)):t.Pi.allocateTargetId(i).next((u=>(r=new _o(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function vc(n,e,t){const i=Ge(n),r=i.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",a,(u=>i.persistence.referenceDelegate.removeTarget(u,r)))}catch(u){if(!Ua(u))throw u;Ce(Mv,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function _y(n,e,t){const i=Ge(n);let r=Qe.min(),a=_t();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(m,p,E){const S=Ge(m),A=S.xs.get(E);return A!==void 0?re.resolve(S.Ms.get(A)):S.Pi.getTargetData(p,E)})(i,u,ws(e)).next((f=>{if(f)return r=f.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,f.targetId).next((m=>{a=m}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,t?r:Qe.min(),t?a:_t()))).next((f=>(wC(i,NI(e),f),{documents:f,Qs:a})))))}function xC(n,e){const t=Ge(n),i=Ge(t.Pi),r=t.Ms.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",(a=>i.At(a,e).next((u=>u?u.target:null))))}function EC(n,e){const t=Ge(n),i=t.Os.get(e)||Qe.min();return t.persistence.runTransaction("Get new document changes","readonly",(r=>t.Ns.getAllFromCollectionGroup(r,e,ZA(i,ac),Number.MAX_SAFE_INTEGER))).then((r=>(wC(t,e,r),r)))}function wC(n,e,t){let i=n.Os.get(e)||Qe.min();t.forEach(((r,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)})),n.Os.set(e,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC="firestore_clients";function fb(n,e){return`${SC}_${n}_${e}`}const bC="firestore_mutations";function mb(n,e,t){let i=`${bC}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const AC="firestore_targets";function A_(n,e){return`${AC}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr="SharedClientState";class Pm{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static Ws(e,t,i){const r=JSON.parse(i);let a,u=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return u&&r.error&&(u=typeof r.error.message=="string"&&typeof r.error.code=="string",u&&(a=new Pe(r.error.code,r.error.message))),u?new Pm(e,t,r.state,a):(Mn(Dr,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Jd{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Ws(e,t){const i=JSON.parse(t);let r,a=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(r=new Pe(i.error.code,i.error.message))),a?new Jd(e,i.state,r):(Mn(Dr,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Dm{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const i=JSON.parse(t);let r=typeof i=="object"&&i.activeTargetIds instanceof Array,a=_v();for(let u=0;r&&u<i.activeTargetIds.length;++u)r=$A(i.activeTargetIds[u]),a=a.add(i.activeTargetIds[u]);return r?new Dm(e,a):(Mn(Dr,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Pv{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Pv(t.clientId,t.onlineState):(Mn(Dr,`Failed to parse online state: ${e}`),null)}}class yy{constructor(){this.activeTargetIds=_v()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class I_{constructor(e,t,i,r,a){this.window=e,this.Mi=t,this.persistenceKey=i,this.Js=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new un(ot),this.started=!1,this.Xs=[];const u=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=fb(this.persistenceKey,this.Js),this.no=(function(m){return`firestore_sequence_number_${m}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new yy),this.ro=new RegExp(`^${SC}_${u}_([^_]*)$`),this.io=new RegExp(`^${bC}_${u}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${AC}_${u}_(\\d+)$`),this.oo=(function(m){return`firestore_online_state_${m}`})(this.persistenceKey),this._o=(function(m){return`firestore_bundle_loaded_v2_${m}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const i of e){if(i===this.Js)continue;const r=this.getItem(fb(this.persistenceKey,i));if(r){const a=Dm.Ws(i,r);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const i=this.uo(t);i&&this.co(i)}for(const i of this.Xs)this.Ys(i);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,i){this.ho(e,t,i),this.Po(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(A_(this.persistenceKey,e));if(r){const a=Jd.Ws(e,r);a&&(i=a.state)}}return t&&this.To.zs(e),this.ao(),i}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(A_(this.persistenceKey,e))}updateQueryState(e,t,i){this.Io(e,t,i)}handleUserChange(e,t,i){t.forEach((r=>{this.Po(r)})),this.currentUser=e,i.forEach((r=>{this.addPendingMutation(r)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ce(Dr,"READ",e,t),t}setItem(e,t){Ce(Dr,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ce(Dr,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(Ce(Dr,"EVENT",t.key,t.newValue),t.key===this.eo)return void Mn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const i=this.Ro(t.key);return this.Vo(i,null)}{const i=this.mo(t.key,t.newValue);if(i)return this.Vo(i.clientId,i)}}else if(this.io.test(t.key)){if(t.newValue!==null){const i=this.fo(t.key,t.newValue);if(i)return this.po(i)}}else if(this.so.test(t.key)){if(t.newValue!==null){const i=this.yo(t.key,t.newValue);if(i)return this.wo(i)}}else if(t.key===this.oo){if(t.newValue!==null){const i=this.uo(t.newValue);if(i)return this.co(i)}}else if(t.key===this.no){const i=(function(a){let u=Xi.ce;if(a!=null)try{const f=JSON.parse(a);Ze(typeof f=="number",30636,{So:a}),u=f}catch(f){Mn(Dr,"Failed to read sequence number from WebStorage",f)}return u})(t.newValue);i!==Xi.ce&&this.sequenceNumberHandler(i)}else if(t.key===this._o){const i=this.bo(t.newValue);await Promise.all(i.map((r=>this.syncEngine.Do(r))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,i){const r=new Pm(this.currentUser,e,t,i),a=mb(this.persistenceKey,this.currentUser,e);this.setItem(a,r.Gs())}Po(e){const t=mb(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,i){const r=A_(this.persistenceKey,e),a=new Jd(e,t,i);this.setItem(r,a.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const i=this.Ro(e);return Dm.Ws(i,t)}fo(e,t){const i=this.io.exec(e),r=Number(i[1]),a=i[2]!==void 0?i[2]:null;return Pm.Ws(new ni(a),r,t)}yo(e,t){const i=this.so.exec(e),r=Number(i[1]);return Jd.Ws(r,t)}uo(e){return Pv.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Ce(Dr,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const i=t?this.Zs.insert(e,t):this.Zs.remove(e),r=this.lo(this.Zs),a=this.lo(i),u=[],f=[];return a.forEach((m=>{r.has(m)||u.push(m)})),r.forEach((m=>{a.has(m)||f.push(m)})),this.syncEngine.Fo(u,f).then((()=>{this.Zs=i}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=_v();return e.forEach(((i,r)=>{t=t.unionWith(r.activeTargetIds)})),t}}class IC{constructor(){this.Mo=new yy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new yy,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o9{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pb="ConnectivityMonitor";class gb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ce(pb,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ce(pb,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Of=null;function vy(){return Of===null?Of=(function(){return 268435456+Math.round(2147483648*Math.random())})():Of++,"0x"+Of.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_="RestConnection",a9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class l9{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===xm?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,a){const u=vy(),f=this.zo(e,t.toUriEncodedString());Ce(C_,`Sending RPC '${e}' ${u}:`,f,i);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,r,a);const{host:p}=new URL(f),E=Ic(p);return this.Jo(e,f,m,i,E).then((S=>(Ce(C_,`Received RPC '${e}' ${u}: `,S),S)),(S=>{throw ql(C_,`RPC '${e}' ${u} failed with error: `,S,"url: ",f,"request:",i),S}))}Ho(e,t,i,r,a,u){return this.Go(e,t,i,r,a)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Rc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,a)=>e[a]=r)),i&&i.headers.forEach(((r,a)=>e[a]=r))}zo(e,t){const i=a9[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u9{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i="WebChannelConnection";class c9 extends l9{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,a){const u=vy();return new Promise(((f,m)=>{const p=new OA;p.setWithCredentials(!0),p.listenOnce(UA.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case jf.NO_ERROR:const S=p.getResponseJson();Ce(_i,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(S)),f(S);break;case jf.TIMEOUT:Ce(_i,`RPC '${e}' ${u} timed out`),m(new Pe(ye.DEADLINE_EXCEEDED,"Request time out"));break;case jf.HTTP_ERROR:const A=p.getStatus();if(Ce(_i,`RPC '${e}' ${u} failed with status:`,A,"response text:",p.getResponseText()),A>0){let R=p.getResponseJson();Array.isArray(R)&&(R=R[0]);const V=R==null?void 0:R.error;if(V&&V.status&&V.message){const z=(function(X){const ne=X.toLowerCase().replace(/_/g,"-");return Object.values(ye).indexOf(ne)>=0?ne:ye.UNKNOWN})(V.status);m(new Pe(z,V.message))}else m(new Pe(ye.UNKNOWN,"Server responded with status "+p.getStatus()))}else m(new Pe(ye.UNAVAILABLE,"Connection failed."));break;default:ze(9055,{l_:e,streamId:u,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Ce(_i,`RPC '${e}' ${u} completed.`)}}));const E=JSON.stringify(r);Ce(_i,`RPC '${e}' ${u} sending request:`,r),p.send(t,"POST",E,i,15)}))}T_(e,t,i){const r=vy(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=FA(),f=zA(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(m.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,t,i),m.encodeInitMessageHeaders=!0;const E=a.join("");Ce(_i,`Creating RPC '${e}' stream ${r}: ${E}`,m);const S=u.createWebChannel(E,m);this.I_(S);let A=!1,R=!1;const V=new u9({Yo:Z=>{R?Ce(_i,`Not sending because RPC '${e}' stream ${r} is closed:`,Z):(A||(Ce(_i,`Opening RPC '${e}' stream ${r} transport.`),S.open(),A=!0),Ce(_i,`RPC '${e}' stream ${r} sending:`,Z),S.send(Z))},Zo:()=>S.close()}),z=(Z,X,ne)=>{Z.listen(X,(Q=>{try{ne(Q)}catch(pe){setTimeout((()=>{throw pe}),0)}}))};return z(S,Md.EventType.OPEN,(()=>{R||(Ce(_i,`RPC '${e}' stream ${r} transport opened.`),V.o_())})),z(S,Md.EventType.CLOSE,(()=>{R||(R=!0,Ce(_i,`RPC '${e}' stream ${r} transport closed`),V.a_(),this.E_(S))})),z(S,Md.EventType.ERROR,(Z=>{R||(R=!0,ql(_i,`RPC '${e}' stream ${r} transport errored. Name:`,Z.name,"Message:",Z.message),V.a_(new Pe(ye.UNAVAILABLE,"The operation could not be completed")))})),z(S,Md.EventType.MESSAGE,(Z=>{var X;if(!R){const ne=Z.data[0];Ze(!!ne,16349);const Q=ne,pe=(Q==null?void 0:Q.error)||((X=Q[0])==null?void 0:X.error);if(pe){Ce(_i,`RPC '${e}' stream ${r} received error:`,pe);const he=pe.status;let Y=(function(O){const G=zn[O];if(G!==void 0)return qI(G)})(he),D=pe.message;Y===void 0&&(Y=ye.INTERNAL,D="Unknown error status: "+he+" with message "+pe.message),R=!0,V.a_(new Pe(Y,D)),S.close()}else Ce(_i,`RPC '${e}' stream ${r} received:`,ne),V.u_(ne)}})),z(f,BA.STAT_EVENT,(Z=>{Z.stat===W_.PROXY?Ce(_i,`RPC '${e}' stream ${r} detected buffering proxy`):Z.stat===W_.NOPROXY&&Ce(_i,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{V.__()}),0),V}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CC(){return typeof window<"u"?window:null}function tm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mp(n){return new pU(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,t,i=1e3,r=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&Ce("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _b="PersistentStream";class RC{constructor(e,t,i,r,a,u,f,m){this.Mi=e,this.S_=i,this.b_=r,this.connection=a,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new NC(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ye.RESOURCE_EXHAUSTED?(Mn(t.toString()),Mn("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ye.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Pe(ye.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ce(_b,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ce(_b,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class d9 extends RC{constructor(e,t,i,r,a,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,u),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=yU(this.serializer,e),i=(function(a){if(!("targetChange"in a))return Qe.min();const u=a.targetChange;return u.targetIds&&u.targetIds.length?Qe.min():u.readTime?Di(u.readTime):Qe.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=hy(this.serializer),t.addTarget=(function(a,u){let f;const m=u.target;if(f=wm(m)?{documents:WI(a,m)}:{query:QI(a,m).ft},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=jI(a,u.resumeToken);const p=cy(a,u.expectedCount);p!==null&&(f.expectedCount=p)}else if(u.snapshotVersion.compareTo(Qe.min())>0){f.readTime=yc(a,u.snapshotVersion.toTimestamp());const p=cy(a,u.expectedCount);p!==null&&(f.expectedCount=p)}return f})(this.serializer,e);const i=TU(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=hy(this.serializer),t.removeTarget=e,this.q_(t)}}class h9 extends RC{constructor(e,t,i,r,a,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,u),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ze(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ze(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ze(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=vU(e.writeResults,e.commitTime),i=Di(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=hy(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>Am(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f9{}class m9 extends f9{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Pe(ye.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,u])=>this.connection.Go(e,dy(t,i),r,a,u))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Pe(ye.UNKNOWN,a.toString())}))}Ho(e,t,i,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,f])=>this.connection.Ho(e,dy(t,i),r,u,f,a))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Pe(ye.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class p9{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Mn(t),this.aa=!1):Ce("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl="RemoteStore";class g9{constructor(e,t,i,r,a){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{$l(this)&&(Ce(Yl,"Restarting streams for network reachability change."),await(async function(m){const p=Ge(m);p.Ea.add(4),await Eh(p),p.Ra.set("Unknown"),p.Ea.delete(4),await pp(p)})(this))}))})),this.Ra=new p9(i,r)}}async function pp(n){if($l(n))for(const e of n.da)await e(!0)}async function Eh(n){for(const e of n.da)await e(!1)}function gp(n,e){const t=Ge(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Lv(t)?kv(t):Dc(t).O_()&&Dv(t,e))}function Tc(n,e){const t=Ge(n),i=Dc(t);t.Ia.delete(e),i.O_()&&MC(t,e),t.Ia.size===0&&(i.O_()?i.L_():$l(t)&&t.Ra.set("Unknown"))}function Dv(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Qe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Dc(n).Y_(e)}function MC(n,e){n.Va.Ue(e),Dc(n).Z_(e)}function kv(n){n.Va=new dU({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Dc(n).start(),n.Ra.ua()}function Lv(n){return $l(n)&&!Dc(n).x_()&&n.Ia.size>0}function $l(n){return Ge(n).Ea.size===0}function PC(n){n.Va=void 0}async function _9(n){n.Ra.set("Online")}async function y9(n){n.Ia.forEach(((e,t)=>{Dv(n,e)}))}async function v9(n,e){PC(n),Lv(n)?(n.Ra.ha(e),kv(n)):n.Ra.set("Unknown")}async function T9(n,e,t){if(n.Ra.set("Online"),e instanceof HI&&e.state===2&&e.cause)try{await(async function(r,a){const u=a.cause;for(const f of a.targetIds)r.Ia.has(f)&&(await r.remoteSyncer.rejectListen(f,u),r.Ia.delete(f),r.Va.removeTarget(f))})(n,e)}catch(i){Ce(Yl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await km(n,i)}else if(e instanceof Xf?n.Va.Ze(e):e instanceof GI?n.Va.st(e):n.Va.tt(e),!t.isEqual(Qe.min()))try{const i=await TC(n.localStore);t.compareTo(i)>=0&&await(function(a,u){const f=a.Va.Tt(u);return f.targetChanges.forEach(((m,p)=>{if(m.resumeToken.approximateByteSize()>0){const E=a.Ia.get(p);E&&a.Ia.set(p,E.withResumeToken(m.resumeToken,u))}})),f.targetMismatches.forEach(((m,p)=>{const E=a.Ia.get(m);if(!E)return;a.Ia.set(m,E.withResumeToken(Dn.EMPTY_BYTE_STRING,E.snapshotVersion)),MC(a,m);const S=new _o(E.target,m,p,E.sequenceNumber);Dv(a,S)})),a.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(i){Ce(Yl,"Failed to raise snapshot:",i),await km(n,i)}}async function km(n,e,t){if(!Ua(e))throw e;n.Ea.add(1),await Eh(n),n.Ra.set("Offline"),t||(t=()=>TC(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ce(Yl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await pp(n)}))}function DC(n,e){return e().catch((t=>km(n,t,e)))}async function Pc(n){const e=Ge(n),t=ka(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:kl;for(;x9(e);)try{const r=await r9(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,E9(e,r)}catch(r){await km(e,r)}kC(e)&&LC(e)}function x9(n){return $l(n)&&n.Ta.length<10}function E9(n,e){n.Ta.push(e);const t=ka(n);t.O_()&&t.X_&&t.ea(e.mutations)}function kC(n){return $l(n)&&!ka(n).x_()&&n.Ta.length>0}function LC(n){ka(n).start()}async function w9(n){ka(n).ra()}async function S9(n){const e=ka(n);for(const t of n.Ta)e.ea(t.mutations)}async function b9(n,e,t){const i=n.Ta.shift(),r=xv.from(i,e,t);await DC(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Pc(n)}async function A9(n,e){e&&ka(n).X_&&await(async function(i,r){if((function(u){return lU(u)&&u!==ye.ABORTED})(r.code)){const a=i.Ta.shift();ka(i).B_(),await DC(i,(()=>i.remoteSyncer.rejectFailedWrite(a.batchId,r))),await Pc(i)}})(n,e),kC(n)&&LC(n)}async function yb(n,e){const t=Ge(n);t.asyncQueue.verifyOperationInProgress(),Ce(Yl,"RemoteStore received new credentials");const i=$l(t);t.Ea.add(3),await Eh(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await pp(t)}async function Ty(n,e){const t=Ge(n);e?(t.Ea.delete(2),await pp(t)):e||(t.Ea.add(2),await Eh(t),t.Ra.set("Unknown"))}function Dc(n){return n.ma||(n.ma=(function(t,i,r){const a=Ge(t);return a.sa(),new d9(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)})(n.datastore,n.asyncQueue,{Xo:_9.bind(null,n),t_:y9.bind(null,n),r_:v9.bind(null,n),H_:T9.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Lv(n)?kv(n):n.Ra.set("Unknown")):(await n.ma.stop(),PC(n))}))),n.ma}function ka(n){return n.fa||(n.fa=(function(t,i,r){const a=Ge(t);return a.sa(),new h9(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:w9.bind(null,n),r_:A9.bind(null,n),ta:S9.bind(null,n),na:b9.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Pc(n)):(await n.fa.stop(),n.Ta.length>0&&(Ce(Yl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,t,i,r,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=a,this.deferred=new yo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,a){const u=Date.now()+i,f=new Vv(e,t,u,r,a);return f.start(i),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Pe(ye.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ov(n,e){if(Mn("AsyncQueue",`${e}: ${n}`),Ua(n))return new Pe(ye.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{static emptySet(e){return new nc(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||ke.comparator(t.key,i.key):(t,i)=>ke.comparator(t.key,i.key),this.keyedMap=Pd(),this.sortedSet=new un(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof nc)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,a=i.getNext().key;if(!r.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new nc;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(){this.ga=new un(ke.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ze(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class xc{constructor(e,t,i,r,a,u,f,m,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=a,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,r,a){const u=[];return t.forEach((f=>{u.push({type:0,doc:f})})),new xc(e,t,nc.emptySet(t),u,i,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ap(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I9{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class C9{constructor(){this.queries=Tb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Ge(t),a=r.queries;r.queries=Tb(),a.forEach(((u,f)=>{for(const m of f.Sa)m.onError(i)}))})(this,new Pe(ye.ABORTED,"Firestore shutting down"))}}function Tb(){return new Co((n=>CI(n)),ap)}async function VC(n,e){const t=Ge(n);let i=3;const r=e.query;let a=t.queries.get(r);a?!a.ba()&&e.Da()&&(i=2):(a=new I9,i=e.Da()?0:1);try{switch(i){case 0:a.wa=await t.onListen(r,!0);break;case 1:a.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(u){const f=Ov(u,`Initialization of query '${ju(e.query)}' failed`);return void e.onError(f)}t.queries.set(r,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&Uv(t)}async function OC(n,e){const t=Ge(n),i=e.query;let r=3;const a=t.queries.get(i);if(a){const u=a.Sa.indexOf(e);u>=0&&(a.Sa.splice(u,1),a.Sa.length===0?r=e.Da()?0:1:!a.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function N9(n,e){const t=Ge(n);let i=!1;for(const r of e){const a=r.query,u=t.queries.get(a);if(u){for(const f of u.Sa)f.Fa(r)&&(i=!0);u.wa=r}}i&&Uv(t)}function R9(n,e,t){const i=Ge(n),r=i.queries.get(e);if(r)for(const a of r.Sa)a.onError(t);i.queries.delete(e)}function Uv(n){n.Ca.forEach((e=>{e.next()}))}var xy,xb;(xb=xy||(xy={})).Ma="default",xb.Cache="cache";class UC{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new xc(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=xc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==xy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e){this.key=e}}class zC{constructor(e){this.key=e}}class M9{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=_t(),this.mutatedKeys=_t(),this.eu=RI(e),this.tu=new nc(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new vb,r=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,u=r,f=!1;const m=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,p=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((E,S)=>{const A=r.get(E),R=vh(this.query,S)?S:null,V=!!A&&this.mutatedKeys.has(A.key),z=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations);let Z=!1;A&&R?A.data.isEqual(R.data)?V!==z&&(i.track({type:3,doc:R}),Z=!0):this.su(A,R)||(i.track({type:2,doc:R}),Z=!0,(m&&this.eu(R,m)>0||p&&this.eu(R,p)<0)&&(f=!0)):!A&&R?(i.track({type:0,doc:R}),Z=!0):A&&!R&&(i.track({type:1,doc:A}),Z=!0,(m||p)&&(f=!0)),Z&&(R?(u=u.add(R),a=z?a.add(E):a.delete(E)):(u=u.delete(E),a=a.delete(E)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const E=this.query.limitType==="F"?u.last():u.first();u=u.delete(E.key),a=a.delete(E.key),i.track({type:1,doc:E})}return{tu:u,iu:i,Cs:f,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((E,S)=>(function(R,V){const z=Z=>{switch(Z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ze(20277,{Rt:Z})}};return z(R)-z(V)})(E.type,S.type)||this.eu(E.doc,S.doc))),this.ou(i),r=r??!1;const f=t&&!r?this._u():[],m=this.Xa.size===0&&this.current&&!r?1:0,p=m!==this.Za;return this.Za=m,u.length!==0||p?{snapshot:new xc(this.query,e.tu,a,u,e.mutatedKeys,m===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=_t(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new zC(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new BC(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=_t();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return xc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const kc="SyncEngine";class P9{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class D9{constructor(e){this.key=e,this.hu=!1}}class k9{constructor(e,t,i,r,a,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Co((f=>CI(f)),ap),this.Iu=new Map,this.Eu=new Set,this.du=new un(ke.comparator),this.Au=new Map,this.Ru=new Iv,this.Vu={},this.mu=new Map,this.fu=Jl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function L9(n,e,t=!0){const i=_p(n);let r;const a=i.Tu.get(e);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),r=a.view.lu()):r=await FC(i,e,t,!0),r}async function V9(n,e){const t=_p(n);await FC(t,e,!0,!1)}async function FC(n,e,t,i){const r=await Mm(n.localStore,ws(e)),a=r.targetId,u=n.sharedClientState.addLocalQueryTarget(a,t);let f;return i&&(f=await Bv(n,e,a,u==="current",r.resumeToken)),n.isPrimaryClient&&t&&gp(n.remoteStore,r),f}async function Bv(n,e,t,i,r){n.pu=(S,A,R)=>(async function(z,Z,X,ne){let Q=Z.view.ru(X);Q.Cs&&(Q=await _y(z.localStore,Z.query,!1).then((({documents:D})=>Z.view.ru(D,Q))));const pe=ne&&ne.targetChanges.get(Z.targetId),he=ne&&ne.targetMismatches.get(Z.targetId)!=null,Y=Z.view.applyChanges(Q,z.isPrimaryClient,pe,he);return Ey(z,Z.targetId,Y.au),Y.snapshot})(n,S,A,R);const a=await _y(n.localStore,e,!0),u=new M9(e,a.Qs),f=u.ru(a.documents),m=xh.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),p=u.applyChanges(f,n.isPrimaryClient,m);Ey(n,t,p.au);const E=new P9(e,t,u);return n.Tu.set(e,E),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function O9(n,e,t){const i=Ge(n),r=i.Tu.get(e),a=i.Iu.get(r.targetId);if(a.length>1)return i.Iu.set(r.targetId,a.filter((u=>!ap(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await vc(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Tc(i.remoteStore,r.targetId),Ec(i,r.targetId)})).catch(Oa)):(Ec(i,r.targetId),await vc(i.localStore,r.targetId,!0))}async function U9(n,e){const t=Ge(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Tc(t.remoteStore,i.targetId))}async function B9(n,e,t){const i=Gv(n);try{const r=await(function(u,f){const m=Ge(u),p=Yt.now(),E=f.reduce(((R,V)=>R.add(V.key)),_t());let S,A;return m.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let V=xs(),z=_t();return m.Ns.getEntries(R,E).next((Z=>{V=Z,V.forEach(((X,ne)=>{ne.isValidDocument()||(z=z.add(X))}))})).next((()=>m.localDocuments.getOverlayedDocuments(R,V))).next((Z=>{S=Z;const X=[];for(const ne of f){const Q=oU(ne,S.get(ne.key).overlayedDocument);Q!=null&&X.push(new No(ne.key,Q,yI(Q.value.mapValue),xi.exists(!0)))}return m.mutationQueue.addMutationBatch(R,p,X,f)})).next((Z=>{A=Z;const X=Z.applyToLocalDocumentSet(S,z);return m.documentOverlayCache.saveOverlays(R,Z.batchId,X)}))})).then((()=>({batchId:A.batchId,changes:PI(S)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(u,f,m){let p=u.Vu[u.currentUser.toKey()];p||(p=new un(ot)),p=p.insert(f,m),u.Vu[u.currentUser.toKey()]=p})(i,r.batchId,t),await za(i,r.changes),await Pc(i.remoteStore)}catch(r){const a=Ov(r,"Failed to persist write");t.reject(a)}}async function qC(n,e){const t=Ge(n);try{const i=await i9(t.localStore,e);e.targetChanges.forEach(((r,a)=>{const u=t.Au.get(a);u&&(Ze(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?u.hu=!0:r.modifiedDocuments.size>0?Ze(u.hu,14607):r.removedDocuments.size>0&&(Ze(u.hu,42227),u.hu=!1))})),await za(t,i,e)}catch(i){await Oa(i)}}function Eb(n,e,t){const i=Ge(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((a,u)=>{const f=u.view.va(e);f.snapshot&&r.push(f.snapshot)})),(function(u,f){const m=Ge(u);m.onlineState=f;let p=!1;m.queries.forEach(((E,S)=>{for(const A of S.Sa)A.va(f)&&(p=!0)})),p&&Uv(m)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function z9(n,e,t){const i=Ge(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),a=r&&r.key;if(a){let u=new un(ke.comparator);u=u.insert(a,In.newNoDocument(a,Qe.min()));const f=_t().add(a),m=new Th(Qe.min(),new Map,new un(ot),u,f);await qC(i,m),i.du=i.du.remove(a),i.Au.delete(e),qv(i)}else await vc(i.localStore,e,!1).then((()=>Ec(i,e,t))).catch(Oa)}async function F9(n,e){const t=Ge(n),i=e.batch.batchId;try{const r=await n9(t.localStore,e);Fv(t,i,null),zv(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await za(t,r)}catch(r){await Oa(r)}}async function q9(n,e,t){const i=Ge(n);try{const r=await(function(u,f){const m=Ge(u);return m.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let E;return m.mutationQueue.lookupMutationBatch(p,f).next((S=>(Ze(S!==null,37113),E=S.keys(),m.mutationQueue.removeMutationBatch(p,S)))).next((()=>m.mutationQueue.performConsistencyCheck(p))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(p,E,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,E))).next((()=>m.localDocuments.getDocuments(p,E)))}))})(i.localStore,e);Fv(i,e,t),zv(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await za(i,r)}catch(r){await Oa(r)}}function zv(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function Fv(n,e,t){const i=Ge(n);let r=i.Vu[i.currentUser.toKey()];if(r){const a=r.get(e);a&&(t?a.reject(t):a.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function Ec(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||GC(n,i)}))}function GC(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Tc(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),qv(n))}function Ey(n,e,t){for(const i of t)i instanceof BC?(n.Ru.addReference(i.key,e),G9(n,i)):i instanceof zC?(Ce(kc,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||GC(n,i.key)):ze(19791,{wu:i})}function G9(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(Ce(kc,"New document in limbo: "+t),n.Eu.add(i),qv(n))}function qv(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new ke(Ht.fromString(e)),i=n.fu.next();n.Au.set(i,new D9(t)),n.du=n.du.insert(t,i),gp(n.remoteStore,new _o(ws(op(t.path)),i,"TargetPurposeLimboResolution",Xi.ce))}}async function za(n,e,t){const i=Ge(n),r=[],a=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((f,m)=>{u.push(i.pu(m,e,t).then((p=>{var E;if((p||t)&&i.isPrimaryClient){const S=p?!p.fromCache:(E=t==null?void 0:t.targetChanges.get(m.targetId))==null?void 0:E.current;i.sharedClientState.updateQueryState(m.targetId,S?"current":"not-current")}if(p){r.push(p);const S=Rv.As(m.targetId,p);a.push(S)}})))})),await Promise.all(u),i.Pu.H_(r),await(async function(m,p){const E=Ge(m);try{await E.persistence.runTransaction("notifyLocalViewChanges","readwrite",(S=>re.forEach(p,(A=>re.forEach(A.Es,(R=>E.persistence.referenceDelegate.addReference(S,A.targetId,R))).next((()=>re.forEach(A.ds,(R=>E.persistence.referenceDelegate.removeReference(S,A.targetId,R)))))))))}catch(S){if(!Ua(S))throw S;Ce(Mv,"Failed to update sequence numbers: "+S)}for(const S of p){const A=S.targetId;if(!S.fromCache){const R=E.Ms.get(A),V=R.snapshotVersion,z=R.withLastLimboFreeSnapshotVersion(V);E.Ms=E.Ms.insert(A,z)}}})(i.localStore,a))}async function H9(n,e){const t=Ge(n);if(!t.currentUser.isEqual(e)){Ce(kc,"User change. New user:",e.toKey());const i=await vC(t.localStore,e);t.currentUser=e,(function(a,u){a.mu.forEach((f=>{f.forEach((m=>{m.reject(new Pe(ye.CANCELLED,u))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await za(t,i.Ls)}}function j9(n,e){const t=Ge(n),i=t.Au.get(e);if(i&&i.hu)return _t().add(i.key);{let r=_t();const a=t.Iu.get(e);if(!a)return r;for(const u of a){const f=t.Tu.get(u);r=r.unionWith(f.view.nu)}return r}}async function K9(n,e){const t=Ge(n),i=await _y(t.localStore,e.query,!0),r=e.view.cu(i);return t.isPrimaryClient&&Ey(t,e.targetId,r.au),r}async function Z9(n,e){const t=Ge(n);return EC(t.localStore,e).then((i=>za(t,i)))}async function J9(n,e,t,i){const r=Ge(n),a=await(function(f,m){const p=Ge(f),E=Ge(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(S=>E.er(S,m).next((A=>A?p.localDocuments.getDocuments(S,A):re.resolve(null)))))})(r.localStore,e);a!==null?(t==="pending"?await Pc(r.remoteStore):t==="acknowledged"||t==="rejected"?(Fv(r,e,i||null),zv(r,e),(function(f,m){Ge(Ge(f).mutationQueue).ir(m)})(r.localStore,e)):ze(6720,"Unknown batchState",{Su:t}),await za(r,a)):Ce(kc,"Cannot apply mutation batch with id: "+e)}async function Y9(n,e){const t=Ge(n);if(_p(t),Gv(t),e===!0&&t.gu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),r=await wb(t,i.toArray());t.gu=!0,await Ty(t.remoteStore,!0);for(const a of r)gp(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const i=[];let r=Promise.resolve();t.Iu.forEach(((a,u)=>{t.sharedClientState.isLocalQueryTarget(u)?i.push(u):r=r.then((()=>(Ec(t,u),vc(t.localStore,u,!0)))),Tc(t.remoteStore,u)})),await r,await wb(t,i),(function(u){const f=Ge(u);f.Au.forEach(((m,p)=>{Tc(f.remoteStore,p)})),f.Ru.Jr(),f.Au=new Map,f.du=new un(ke.comparator)})(t),t.gu=!1,await Ty(t.remoteStore,!1)}}async function wb(n,e,t){const i=Ge(n),r=[],a=[];for(const u of e){let f;const m=i.Iu.get(u);if(m&&m.length!==0){f=await Mm(i.localStore,ws(m[0]));for(const p of m){const E=i.Tu.get(p),S=await K9(i,E);S.snapshot&&a.push(S.snapshot)}}else{const p=await xC(i.localStore,u);f=await Mm(i.localStore,p),await Bv(i,HC(p),u,!1,f.resumeToken)}r.push(f)}return i.Pu.H_(a),r}function HC(n){return AI(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function W9(n){return(function(t){return Ge(Ge(t).persistence).Ts()})(Ge(n).localStore)}async function Q9(n,e,t,i){const r=Ge(n);if(r.gu)return void Ce(kc,"Ignoring unexpected query state notification.");const a=r.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const u=await EC(r.localStore,NI(a[0])),f=Th.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Dn.EMPTY_BYTE_STRING);await za(r,u,f);break}case"rejected":await vc(r.localStore,e,!0),Ec(r,e,i);break;default:ze(64155,t)}}async function $9(n,e,t){const i=_p(n);if(i.gu){for(const r of e){if(i.Iu.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){Ce(kc,"Adding an already active target "+r);continue}const a=await xC(i.localStore,r),u=await Mm(i.localStore,a);await Bv(i,HC(a),u.targetId,!1,u.resumeToken),gp(i.remoteStore,u)}for(const r of t)i.Iu.has(r)&&await vc(i.localStore,r,!1).then((()=>{Tc(i.remoteStore,r),Ec(i,r)})).catch(Oa)}}function _p(n){const e=Ge(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=qC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=j9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=z9.bind(null,e),e.Pu.H_=N9.bind(null,e.eventManager),e.Pu.yu=R9.bind(null,e.eventManager),e}function Gv(n){const e=Ge(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=F9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=q9.bind(null,e),e}class uh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return yC(this.persistence,new _C,e.initialUser,this.serializer)}Cu(e){return new Cv(fp.mi,this.serializer)}Du(e){return new IC}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}uh.provider={build:()=>new uh};class X9 extends uh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ze(this.persistence.referenceDelegate instanceof Rm,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new dC(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?yi.withCacheSize(this.cacheSizeBytes):yi.DEFAULT;return new Cv((i=>Rm.mi(i,t)),this.serializer)}}class eB extends uh{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Gv(this.xu.syncEngine),await Pc(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return yC(this.persistence,new _C,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new dC(i,e.asyncQueue,t)}Mu(e,t){const i=new uO(t,this.persistence);return new lO(e.asyncQueue,i)}Cu(e){const t=gC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?yi.withCacheSize(this.cacheSizeBytes):yi.DEFAULT;return new Nv(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,CC(),tm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new IC}}class tB extends eB{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof I_&&(this.sharedClientState.syncEngine={Co:J9.bind(null,t),vo:Q9.bind(null,t),Fo:$9.bind(null,t),Ts:W9.bind(null,t),Do:Z9.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async i=>{await Y9(this.xu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Du(e){const t=CC();if(!I_.v(t))throw new Pe(ye.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=gC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new I_(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Lm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Eb(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=H9.bind(null,this.syncEngine),await Ty(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new C9})()}createDatastore(e){const t=mp(e.databaseInfo.databaseId),i=(function(a){return new c9(a)})(e.databaseInfo);return(function(a,u,f,m){return new m9(a,u,f,m)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,a,u,f){return new g9(i,r,a,u,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Eb(this.syncEngine,t,0)),(function(){return gb.v()?new gb:new o9})())}createSyncEngine(e,t){return(function(r,a,u,f,m,p,E){const S=new k9(r,a,u,f,m,p);return E&&(S.gu=!0),S})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const a=Ge(r);Ce(Yl,"RemoteStore shutting down."),a.Ea.add(5),await Eh(a),a.Aa.shutdown(),a.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Lm.provider={build:()=>new Lm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Mn("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La="FirestoreClient";class nB{constructor(e,t,i,r,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=ni.UNAUTHENTICATED,this.clientId=ov.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(i,(async u=>{Ce(La,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(Ce(La,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new yo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=Ov(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function N_(n,e){n.asyncQueue.verifyOperationInProgress(),Ce(La,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await vC(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Sb(n,e){n.asyncQueue.verifyOperationInProgress();const t=await iB(n);Ce(La,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>yb(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>yb(e.remoteStore,r))),n._onlineComponents=e}async function iB(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ce(La,"Using user provided OfflineComponentProvider");try{await N_(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===ye.FAILED_PRECONDITION||r.code===ye.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;ql("Error using user provided cache. Falling back to memory cache: "+t),await N_(n,new uh)}}else Ce(La,"Using default OfflineComponentProvider"),await N_(n,new X9(void 0));return n._offlineComponents}async function KC(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ce(La,"Using user provided OnlineComponentProvider"),await Sb(n,n._uninitializedComponentsProvider._online)):(Ce(La,"Using default OnlineComponentProvider"),await Sb(n,new Lm))),n._onlineComponents}function sB(n){return KC(n).then((e=>e.syncEngine))}async function wy(n){const e=await KC(n),t=e.eventManager;return t.onListen=L9.bind(null,e.syncEngine),t.onUnlisten=O9.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=V9.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=U9.bind(null,e.syncEngine),t}function rB(n,e,t={}){const i=new yo;return n.asyncQueue.enqueueAndForget((async()=>(function(a,u,f,m,p){const E=new jC({next:A=>{E.Nu(),u.enqueueAndForget((()=>OC(a,S))),A.fromCache&&m.source==="server"?p.reject(new Pe(ye.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(A)},error:A=>p.reject(A)}),S=new UC(f,E,{includeMetadataChanges:!0,qa:!0});return VC(a,S)})(await wy(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bb=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC="firestore.googleapis.com",Ab=!0;class Ib{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Pe(ye.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=JC,this.ssl=Ab}else this.host=e.host,this.ssl=e.ssl??Ab;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=aC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<VU)throw new Pe(ye.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rO("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZC(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Pe(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Pe(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Pe(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class yp{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ib({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Pe(ye.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Pe(ye.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ib(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Y6;switch(i.type){case"firstParty":return new X6(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Pe(ye.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=bb.get(t);i&&(Ce("ComponentProvider","Removing Datastore"),bb.delete(t),i.terminate())})(this),Promise.resolve()}}function oB(n,e,t,i={}){var p;n=Es(n,yp);const r=Ic(e),a=n._getSettings(),u={...a,emulatorOptions:n._getEmulatorOptions()},f=`${e}:${t}`;r&&(J1(`https://${f}`),Y1("Firestore",!0)),a.host!==JC&&a.host!==f&&ql("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...a,host:f,ssl:r,emulatorOptions:i};if(!Ma(m,u)&&(n._setSettings(m),i.mockUserToken)){let E,S;if(typeof i.mockUserToken=="string")E=i.mockUserToken,S=ni.MOCK_USER;else{E=E4(i.mockUserToken,(p=n._app)==null?void 0:p.options.projectId);const A=i.mockUserToken.sub||i.mockUserToken.user_id;if(!A)throw new Pe(ye.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");S=new ni(A)}n._authCredentials=new W6(new GA(E,S))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Xl(this.firestore,e,this._query)}}class Pn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Na(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pn(this.firestore,e,this._key)}toJSON(){return{type:Pn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(ph(t,Pn._jsonSchema))return new Pn(e,i||null,new ke(Ht.fromString(t.referencePath)))}}Pn._jsonSchemaVersion="firestore/documentReference/1.0",Pn._jsonSchema={type:Fn("string",Pn._jsonSchemaVersion),referencePath:Fn("string")};class Na extends Xl{constructor(e,t,i){super(e,t,op(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pn(this.firestore,null,new ke(e))}withConverter(e){return new Na(this.firestore,e,this._path)}}function nm(n,e,...t){if(n=ii(n),jA("collection","path",e),n instanceof yp){const i=Ht.fromString(e,...t);return _S(i),new Na(n,null,i)}{if(!(n instanceof Pn||n instanceof Na))throw new Pe(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ht.fromString(e,...t));return _S(i),new Na(n.firestore,null,i)}}function Yd(n,e,...t){if(n=ii(n),arguments.length===1&&(e=ov.newId()),jA("doc","path",e),n instanceof yp){const i=Ht.fromString(e,...t);return gS(i),new Pn(n,null,new ke(i))}{if(!(n instanceof Pn||n instanceof Na))throw new Pe(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ht.fromString(e,...t));return gS(i),new Pn(n.firestore,n instanceof Na?n.converter:null,new ke(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cb="AsyncQueue";class Nb{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new NC(this,"async_queue_retry"),this._c=()=>{const i=tm();i&&Ce(Cb,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=tm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=tm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new yo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ua(e))throw e;Ce(Cb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Mn("INTERNAL UNHANDLED ERROR: ",Rb(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Vv.createAndSchedule(this,e,t,i,(a=>this.hc(a)));return this.tc.push(r),r}uc(){this.nc&&ze(47125,{Pc:Rb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Rb(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mb(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const a of i)if(a in r&&typeof r[a]=="function")return!0;return!1})(n,["next","error","complete"])}class So extends yp{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Nb,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nb(e),this._firestoreClient=void 0,await e}}}function aB(n,e){const t=typeof n=="object"?n:iA(),i=typeof n=="string"?n:xm,r=Jy(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const a=T4("firestore");a&&oB(r,...a)}return r}function Hv(n){if(n._terminated)throw new Pe(ye.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||YC(n),n._firestoreClient}function YC(n){var i,r,a;const e=n._freezeSettings(),t=(function(f,m,p,E){return new OO(f,m,p,E.host,E.ssl,E.experimentalForceLongPolling,E.experimentalAutoDetectLongPolling,ZC(E.experimentalLongPollingOptions),E.useFetchStreams,E.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new nB(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}async function lB(n){ql("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();uB(n,Lm.provider,{build:t=>new tB(t,e.cacheSizeBytes)})}function uB(n,e,t){if((n=Es(n,So))._firestoreClient||n._terminated)throw new Pe(ye.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Pe(ye.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},YC(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qs(Dn.fromBase64String(e))}catch(t){throw new Pe(ye.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new qs(Dn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:qs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ph(e,qs._jsonSchema))return qs.fromBase64String(e.bytes)}}qs._jsonSchemaVersion="firestore/bytes/1.0",qs._jsonSchema={type:Fn("string",qs._jsonSchemaVersion),bytes:Fn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Pe(ye.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Pe(ye.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Pe(ye.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ot(this._lat,e._lat)||ot(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Or._jsonSchemaVersion}}static fromJSON(e){if(ph(e,Or._jsonSchema))return new Or(e.latitude,e.longitude)}}Or._jsonSchemaVersion="firestore/geoPoint/1.0",Or._jsonSchema={type:Fn("string",Or._jsonSchemaVersion),latitude:Fn("number"),longitude:Fn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let a=0;a<i.length;++a)if(i[a]!==r[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ur._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ph(e,Ur._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ur(e.vectorValues);throw new Pe(ye.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ur._jsonSchemaVersion="firestore/vectorValue/1.0",Ur._jsonSchema={type:Fn("string",Ur._jsonSchemaVersion),vectorValues:Fn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cB=/^__.*__$/;class dB{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new No(e,this.data,this.fieldMask,t,this.fieldTransforms):new Mc(e,this.data,t,this.fieldTransforms)}}class WC{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new No(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function QC(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ze(40011,{Ac:n})}}class Tp{constructor(e,t,i,r,a,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Tp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Vm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(QC(this.Ac)&&cB.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class hB{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||mp(e)}Cc(e,t,i,r=!1){return new Tp({Ac:e,methodName:t,Dc:i,path:Tn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xp(n){const e=n._freezeSettings(),t=mp(n._databaseId);return new hB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function $C(n,e,t,i,r,a={}){const u=n.Cc(a.merge||a.mergeFields?2:0,e,t,r);Zv("Data must be an object, but it was:",u,i);const f=XC(i,u);let m,p;if(a.merge)m=new es(u.fieldMask),p=u.fieldTransforms;else if(a.mergeFields){const E=[];for(const S of a.mergeFields){const A=Sy(e,S,t);if(!u.contains(A))throw new Pe(ye.INVALID_ARGUMENT,`Field '${A}' is specified in your field mask but missing from your input data.`);tN(E,A)||E.push(A)}m=new es(E),p=u.fieldTransforms.filter((S=>m.covers(S.field)))}else m=null,p=u.fieldTransforms;return new dB(new vi(f),m,p)}class Ep extends wh{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ep}}function fB(n,e,t){return new Tp({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class jv extends wh{_toFieldTransform(e){return new vv(e.path,new gc)}isEqual(e){return e instanceof jv}}class Kv extends wh{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=fB(this,e,!0),i=this.vc.map((a=>Lc(a,t))),r=new jl(i);return new vv(e.path,r)}isEqual(e){return e instanceof Kv&&Ma(this.vc,e.vc)}}function mB(n,e,t,i){const r=n.Cc(1,e,t);Zv("Data must be an object, but it was:",r,i);const a=[],u=vi.empty();Ba(i,((m,p)=>{const E=Jv(e,m,t);p=ii(p);const S=r.yc(E);if(p instanceof Ep)a.push(E);else{const A=Lc(p,S);A!=null&&(a.push(E),u.set(E,A))}}));const f=new es(a);return new WC(u,f,r.fieldTransforms)}function pB(n,e,t,i,r,a){const u=n.Cc(1,e,t),f=[Sy(e,i,t)],m=[r];if(a.length%2!=0)throw new Pe(ye.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let A=0;A<a.length;A+=2)f.push(Sy(e,a[A])),m.push(a[A+1]);const p=[],E=vi.empty();for(let A=f.length-1;A>=0;--A)if(!tN(p,f[A])){const R=f[A];let V=m[A];V=ii(V);const z=u.yc(R);if(V instanceof Ep)p.push(R);else{const Z=Lc(V,z);Z!=null&&(p.push(R),E.set(R,Z))}}const S=new es(p);return new WC(E,S,u.fieldTransforms)}function gB(n,e,t,i=!1){return Lc(t,n.Cc(i?4:3,e))}function Lc(n,e){if(eN(n=ii(n)))return Zv("Unsupported field value:",e,n),XC(n,e);if(n instanceof wh)return(function(i,r){if(!QC(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const a=i._toFieldTransform(r);a&&r.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,r){const a=[];let u=0;for(const f of i){let m=Lc(f,r.wc(u));m==null&&(m={nullValue:"NULL_VALUE"}),a.push(m),u++}return{arrayValue:{values:a}}})(n,e)}return(function(i,r){if((i=ii(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return eU(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const a=Yt.fromDate(i);return{timestampValue:yc(r.serializer,a)}}if(i instanceof Yt){const a=new Yt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:yc(r.serializer,a)}}if(i instanceof Or)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof qs)return{bytesValue:jI(r.serializer,i._byteString)};if(i instanceof Pn){const a=r.databaseId,u=i.firestore._databaseId;if(!u.isEqual(a))throw r.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Sv(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Ur)return(function(u,f){return{mapValue:{fields:{[mv]:{stringValue:pv},[hc]:{arrayValue:{values:u.toArray().map((p=>{if(typeof p!="number")throw f.Sc("VectorValues must only contain numeric values.");return yv(f.serializer,p)}))}}}}}})(i,r);throw r.Sc(`Unsupported field value: ${$m(i)}`)})(n,e)}function XC(n,e){const t={};return uI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ba(n,((i,r)=>{const a=Lc(r,e.mc(i));a!=null&&(t[i]=a)})),{mapValue:{fields:t}}}function eN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Yt||n instanceof Or||n instanceof qs||n instanceof Pn||n instanceof wh||n instanceof Ur)}function Zv(n,e,t){if(!eN(t)||!KA(t)){const i=$m(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function Sy(n,e,t){if((e=ii(e))instanceof vp)return e._internalPath;if(typeof e=="string")return Jv(n,e);throw Vm("Field path arguments must be of type string or ",n,!1,void 0,t)}const _B=new RegExp("[~\\*/\\[\\]]");function Jv(n,e,t){if(e.search(_B)>=0)throw Vm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new vp(...e.split("."))._internalPath}catch{throw Vm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Vm(n,e,t,i,r){const a=i&&!i.isEmpty(),u=r!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(a||u)&&(m+=" (found",a&&(m+=` in field ${i}`),u&&(m+=` in document ${r}`),m+=")"),new Pe(ye.INVALID_ARGUMENT,f+n+m)}function tN(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(e,t,i,r,a){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Pn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new yB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Yv("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class yB extends nN{data(){return super.data()}}function Yv(n,e){return typeof e=="string"?Jv(n,e):e instanceof vp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iN(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Pe(ye.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wv{}class vB extends Wv{}function by(n,e,...t){let i=[];e instanceof Wv&&i.push(e),i=i.concat(t),(function(a){const u=a.filter((m=>m instanceof Qv)).length,f=a.filter((m=>m instanceof wp)).length;if(u>1||u>0&&f>0)throw new Pe(ye.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class wp extends vB{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new wp(e,t,i)}_apply(e){const t=this._parse(e);return sN(e._query,t),new Xl(e.firestore,e.converter,ly(e._query,t))}_parse(e){const t=xp(e.firestore);return(function(a,u,f,m,p,E,S){let A;if(p.isKeyField()){if(E==="array-contains"||E==="array-contains-any")throw new Pe(ye.INVALID_ARGUMENT,`Invalid Query. You can't perform '${E}' queries on documentId().`);if(E==="in"||E==="not-in"){Db(S,E);const V=[];for(const z of S)V.push(Pb(m,a,z));A={arrayValue:{values:V}}}else A=Pb(m,a,S)}else E!=="in"&&E!=="not-in"&&E!=="array-contains-any"||Db(S,E),A=gB(f,u,S,E==="in"||E==="not-in");return Nt.create(p,E,A)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Ay(n,e,t){const i=e,r=Yv("where",n);return wp._create(r,i,t)}class Qv extends Wv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Qv(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Wt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,a){let u=r;const f=a.getFlattenedFilters();for(const m of f)sN(u,m),u=ly(u,m)})(e._query,t),new Xl(e.firestore,e.converter,ly(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Pb(n,e,t){if(typeof(t=ii(t))=="string"){if(t==="")throw new Pe(ye.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!II(e)&&t.indexOf("/")!==-1)throw new Pe(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Ht.fromString(t));if(!ke.isDocumentKey(i))throw new Pe(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return oh(n,new ke(i))}if(t instanceof Pn)return oh(n,t._key);throw new Pe(ye.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$m(t)}.`)}function Db(n,e){if(!Array.isArray(n)||n.length===0)throw new Pe(ye.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sN(n,e){const t=(function(r,a){for(const u of r)for(const f of u.getFlattenedFilters())if(a.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Pe(ye.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Pe(ye.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class TB{convertValue(e,t="none"){switch(Pa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ze(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Ba(e,((r,a)=>{i[r]=this.convertValue(a,t)})),i}convertVectorValue(e){var i,r,a;const t=(a=(r=(i=e.fields)==null?void 0:i[hc].arrayValue)==null?void 0:r.values)==null?void 0:a.map((u=>gn(u.doubleValue)));return new Ur(t)}convertGeoPoint(e){return new Or(gn(e.latitude),gn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=sp(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(sh(e));default:return null}}convertTimestamp(e){const t=Eo(e);return new Yt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Ht.fromString(e);Ze(tC(i),9688,{name:e});const r=new Gl(i.get(1),i.get(3)),a=new ke(i.popFirst(5));return r.isEqual(t)||Mn(`Document ${a} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rN(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Ld{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ol extends nN{constructor(e,t,i,r,a,u){super(e,t,i,r,u),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new im(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Yv("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Pe(ye.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ol._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ol._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ol._jsonSchema={type:Fn("string",Ol._jsonSchemaVersion),bundleSource:Fn("string","DocumentSnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class im extends Ol{data(e={}){return super.data(e)}}class Ul{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ld(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new im(this._firestore,this._userDataWriter,i.key,i,new Ld(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Pe(ye.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,a){if(r._snapshot.oldDocs.isEmpty()){let u=0;return r._snapshot.docChanges.map((f=>{const m=new im(r._firestore,r._userDataWriter,f.doc.key,f.doc,new Ld(r._snapshot.mutatedKeys.has(f.doc.key),r._snapshot.fromCache),r.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:u++}}))}{let u=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((f=>a||f.type!==3)).map((f=>{const m=new im(r._firestore,r._userDataWriter,f.doc.key,f.doc,new Ld(r._snapshot.mutatedKeys.has(f.doc.key),r._snapshot.fromCache),r.query.converter);let p=-1,E=-1;return f.type!==0&&(p=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),E=u.indexOf(f.doc.key)),{type:xB(f.type),doc:m,oldIndex:p,newIndex:E}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Pe(ye.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ul._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ov.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),i.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),r.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function xB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ze(61501,{type:n})}}Ul._jsonSchemaVersion="firestore/querySnapshot/1.0",Ul._jsonSchema={type:Fn("string",Ul._jsonSchemaVersion),bundleSource:Fn("string","QuerySnapshot"),bundleName:Fn("string"),bundle:Fn("string")};class $v extends TB{constructor(e){super(),this.firestore=e}convertBytes(e){return new qs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pn(this.firestore,null,t)}}function EB(n){n=Es(n,Xl);const e=Es(n.firestore,So),t=Hv(e),i=new $v(e);return iN(n._query),rB(t,n._query).then((r=>new Ul(e,i,n,r)))}function wB(n,e,t){n=Es(n,Pn);const i=Es(n.firestore,So),r=rN(n.converter,e,t);return Sp(i,[$C(xp(i),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,xi.none())])}function sm(n,e,t,...i){n=Es(n,Pn);const r=Es(n.firestore,So),a=xp(r);let u;return u=typeof(e=ii(e))=="string"||e instanceof vp?pB(a,"updateDoc",n._key,e,t,i):mB(a,"updateDoc",n._key,e),Sp(r,[u.toMutation(n._key,xi.exists(!0))])}function SB(n){return Sp(Es(n.firestore,So),[new cp(n._key,xi.none())])}function bB(n,e){const t=Es(n.firestore,So),i=Yd(n),r=rN(n.converter,e);return Sp(t,[$C(xp(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,xi.exists(!1))]).then((()=>i))}function Cd(n,...e){var m,p,E;n=ii(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Mb(e[i])||(t=e[i++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Mb(e[i])){const S=e[i];e[i]=(m=S.next)==null?void 0:m.bind(S),e[i+1]=(p=S.error)==null?void 0:p.bind(S),e[i+2]=(E=S.complete)==null?void 0:E.bind(S)}let a,u,f;if(n instanceof Pn)u=Es(n.firestore,So),f=op(n._key.path),a={next:S=>{e[i]&&e[i](AB(u,n,S))},error:e[i+1],complete:e[i+2]};else{const S=Es(n,Xl);u=Es(S.firestore,So),f=S._query;const A=new $v(u);a={next:R=>{e[i]&&e[i](new Ul(u,A,S,R))},error:e[i+1],complete:e[i+2]},iN(n._query)}return(function(A,R,V,z){const Z=new jC(z),X=new UC(R,Z,V);return A.asyncQueue.enqueueAndForget((async()=>VC(await wy(A),X))),()=>{Z.Nu(),A.asyncQueue.enqueueAndForget((async()=>OC(await wy(A),X)))}})(Hv(u),f,r,a)}function Sp(n,e){return(function(i,r){const a=new yo;return i.asyncQueue.enqueueAndForget((async()=>B9(await sB(i),r,a))),a.promise})(Hv(n),e)}function AB(n,e,t){const i=t.docs.get(e._key),r=new $v(n);return new Ol(n,r,e._key,i,new Ld(t.hasPendingWrites,t.fromCache),e.converter)}function kb(){return new jv("serverTimestamp")}function Lb(...n){return new Kv("arrayUnion",n)}(function(e,t=!0){(function(r){Rc=r})(Cc),sc(new Bl("firestore",((i,{instanceIdentifier:r,options:a})=>{const u=i.getProvider("app").getImmediate(),f=new So(new Q6(i.getProvider("auth-internal")),new eO(u,i.getProvider("app-check-internal")),(function(p,E){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Pe(ye.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gl(p.options.projectId,E)})(u,r),u);return a={useFetchStreams:t,...a},f._setSettings(a),f}),"PUBLIC").setMultipleInstances(!0)),Aa(hS,fS,e),Aa(hS,fS,"esm2020")})();const IB={apiKey:"AIzaSyBCnLlCaVWh9iKhclzPWJcEPDuyH0OHPUM",authDomain:"ques-trip.firebaseapp.com",projectId:"ques-trip",storageBucket:"ques-trip.firebasestorage.app",messagingSenderId:"765263595886",appId:"1:765263595886:web:3e501d362abe47bfb8597f",measurementId:"G-R1NF9EVRHY"},Xv=nA(IB);console.log("Firebase App Initialized:",Xv.name);const Iy=Z6(Xv),CB=new mo,fo=aB(Xv);lB(fo).catch(n=>{n.code=="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open"):n.code=="unimplemented"&&console.warn("Firestore persistence not supported by browser")});const NB=({trip:n,currentUser:e,onClose:t,onUpdate:i})=>{var R;const[r,a]=W.useState(""),[u,f]=W.useState(!1),[m,p]=W.useState(null),[E,S]=W.useState(null),A=async()=>{var V;if(r.trim()){f(!0),p(null),S(null);try{const z=nm(fo,"users"),Z=by(z,Ay("email","==",r.trim())),X=await EB(Z);if(X.empty){p(" Email "),f(!1);return}const ne=X.docs[0],Q=ne.data(),pe=ne.id;if(pe===e.id){p(""),f(!1);return}if((V=n.userIds)!=null&&V.includes(pe)){p(""),f(!1);return}const he={uid:pe,email:Q.email,username:Q.username||"Traveler"},Y=Yd(fo,"itineraries",n.id);await sm(Y,{userIds:Lb(pe),collaborators:Lb(he)}),i({...n,userIds:[...n.userIds||[],pe],collaborators:[...n.collaborators||[],he]}),S(` ${he.username}`),a("")}catch(z){console.error("Share error:",z),p(": "+z.message)}finally{f(!1)}}};return v.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:t,children:v.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm overflow-hidden shadow-2xl",onClick:V=>V.stopPropagation(),children:[v.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50/50",children:[v.jsx("h3",{className:"font-bold text-lg text-gray-800",children:""}),v.jsx("button",{onClick:t,className:"p-1 rounded-full hover:bg-gray-200 transition-colors",children:v.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),v.jsxs("div",{className:"p-6 space-y-4",children:[v.jsxs("p",{className:"text-sm text-gray-600",children:[" ",v.jsx("strong",{children:n.title}),""]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:" Email"}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{type:"email",value:r,onChange:V=>a(V.target.value),placeholder:"friend@example.com",className:"flex-1 bg-gray-50 border border-gray-200 rounded-xl px-4 py-2 text-gray-800 focus:outline-none focus:ring-2 focus:ring-coral/20 focus:border-coral transition-all",onKeyDown:V=>V.key==="Enter"&&A()}),v.jsx("button",{onClick:A,disabled:u||!r,className:"bg-coral text-white px-4 py-2 rounded-xl font-medium shadow-lg shadow-coral/30 hover:shadow-xl hover:shadow-coral/40 hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-50 disabled:transform-none transition-all flex items-center justify-center min-w-[4rem]",children:u?v.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[v.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),v.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):""})]}),m&&v.jsx("p",{className:"text-red-500 text-xs mt-1",children:m}),E&&v.jsx("p",{className:"text-green-500 text-xs mt-1",children:E})]}),v.jsxs("div",{className:"pt-2",children:[v.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-2",children:""}),v.jsxs("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:[v.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-xl bg-gray-50",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-coral/10 text-coral flex items-center justify-center font-bold text-xs ring-2 ring-white",children:""}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:""}),n.userIds&&n.userIds.length>0&&e.id===n.userIds[0]&&v.jsx("p",{className:"text-xs text-gray-500 truncate",children:"()"})]})]}),(R=n.collaborators)==null?void 0:R.map((V,z)=>{var Z,X;return v.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-xl hover:bg-gray-50 transition-colors",children:[v.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-bold text-xs ring-2 ring-white",children:((X=(Z=V.username)==null?void 0:Z[0])==null?void 0:X.toUpperCase())||"U"}),v.jsxs("div",{className:"flex-1 min-w-0",children:[v.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:V.username}),v.jsx("p",{className:"text-xs text-gray-500 truncate",children:V.email})]})]},z)}),(!n.collaborators||n.collaborators.length===0)&&v.jsx("p",{className:"text-xs text-gray-400 italic text-center py-2",children:""})]})]})]})]})})},RB=({trip:n,user:e,onBack:t,onDelete:i,onUpdateTrip:r,onOpenAI:a,settings:u})=>{var fr,mr,Fr,si;const f=on[u.language]||on["zh-TW"],[m,p]=W.useState("ITINERARY"),[E,S]=W.useState(!1),[A,R]=W.useState(!1),[V,z]=W.useState(""),[Z,X]=W.useState(null),[ne,Q]=W.useState(!1),pe=async Ne=>{const lt=Ne||V;if(lt.trim()){Ne&&z(Ne),Q(!0);try{const at=await Od(lt,u.apiKey);at?X(at):(Ne||alert("Location not found"),console.log(`Location not found for: ${lt}`))}catch(at){console.error("Map search failed:",at)}finally{Q(!1)}}},[he,Y]=W.useState(null),[D,B]=W.useState(""),[O,G]=W.useState(""),[q,K]=W.useState(""),[F,qe]=W.useState([{name:"",price:""}]),[Je,ie]=W.useState(((fr=n.budget)==null?void 0:fr.currency)||"TWD"),[be,Se]=W.useState(""),[$e,Me]=W.useState(0),[j,fe]=W.useState(!1),[Ie,le]=W.useState(null),[ge,Ae]=W.useState(!1),[He,Ue]=W.useState(!1);W.useEffect(()=>{var Ne;ge&&(ie(((Ne=n.budget)==null?void 0:Ne.currency)||"TWD"),Se(""))},[ge,(mr=n.budget)==null?void 0:mr.currency]),W.useEffect(()=>{(async()=>{var at;const lt=((at=n.budget)==null?void 0:at.currency)||"TWD";if(le(null),Je!==lt&&u.apiKey){fe(!0);try{const $t=await zy(Je,lt);$t?Se($t):le(" (API Key )")}catch($t){console.error("Failed to fetch rate:",$t),le("")}fe(!1)}})()},[Je,(Fr=n.budget)==null?void 0:Fr.currency,u.apiKey]),W.useEffect(()=>{const Ne=parseFloat(O)||0,lt=parseFloat(be)||1;Me(Math.round(Ne*lt))},[O,be]);const[we,et]=W.useState(!1),[vt,nt]=W.useState(!1),[qt,_n]=W.useState(n.title),[Vt,yt]=W.useState(!1),[St,kt]=W.useState(""),[Rt,ve]=W.useState(!1),Ve=()=>{i==null||i(n.id)},Ye=()=>{qt.trim()&&qt!==n.title&&(r==null||r({...n,title:qt})),nt(!1)},pt=async Ne=>{if(Ne==="upload"){const lt=document.createElement("input");lt.type="file",lt.accept="image/*",lt.onchange=at=>{var ui,is;const $t=(is=(ui=at.target)==null?void 0:ui.files)==null?void 0:is[0];if($t){const Cn=new FileReader;Cn.onload=()=>{const Li=Cn.result;r==null||r({...n,coverImage:Li}),yt(!1)},Cn.readAsDataURL($t)}},lt.click()}else if(Ne==="url")St.trim()&&(r==null||r({...n,coverImage:St}),kt(""),yt(!1));else if(Ne==="ai"){ve(!0);try{const{generateCoverImage:lt}=await qm(async()=>{const{generateCoverImage:$t}=await Promise.resolve().then(()=>NL);return{generateCoverImage:$t}},void 0),at=await lt(n.title);r==null||r({...n,coverImage:at}),yt(!1)}catch(lt){console.error("Failed to generate cover:",lt),alert("AI ")}finally{ve(!1)}}},dt=Ne=>{Y(Ne),G(""),K(""),qe([{name:"",price:""}]),Ae(!0)},xn=()=>{var ln,bi,Ai;if(!he||!O)return;const Ne=parseFloat(O);if(Ne<=0){alert("Amount must be greater than 0");return}const lt=parseFloat(be)||1,at=Math.round(Ne*lt),$t=F.filter(qn=>qn.name&&qn.price).map(qn=>`${qn.name}: ${Rl(Je)}${qn.price}`).join(", "),ui=q?$t?`${q} (${$t})`:q:$t,is={id:Date.now().toString(),title:he.activity,amount:at,category:"Shopping",date:n.startDate?new Date(n.startDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],payer:"ME",paymentMethod:"Cash",note:ui,originalCurrency:Je,originalAmount:Ne,exchangeRate:lt},Cn=((ln=n.budget)==null?void 0:ln.expenses)||[],Li={...n,budget:{...n.budget,total:((bi=n.budget)==null?void 0:bi.total)||0,currency:((Ai=n.budget)==null?void 0:Ai.currency)||"TWD",expenses:[is,...Cn]}};r==null||r(Li),Ae(!1)},Si=(Ne,lt,at)=>{const $t=[...F];if($t[Ne][lt]=at,qe($t),lt==="price"){const ui=$t.reduce((is,Cn)=>is+(parseInt(Cn.price)||0),0);ui>0&&G(ui.toString())}},ki=()=>{qe([...F,{name:"",price:""}])},an=((si=n.budget)==null?void 0:si.currency)||"TWD",ns=Rl(an);return v.jsxs("div",{className:"flex flex-col h-full bg-paper animate-fade-in relative",children:[v.jsxs("div",{className:"relative h-64 shrink-0 group",children:[v.jsxs("div",{className:"absolute inset-0 bg-gray-200",children:[n.coverImage?v.jsx("img",{src:n.coverImage,alt:n.title,className:`w-full h-full object-cover transition-opacity duration-700 ${A?"opacity-100":"opacity-0"}`,onLoad:()=>R(!0)}):v.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-coral/20 to-sand/30",children:v.jsx(rE,{className:"w-16 h-16 text-coral/40"})}),v.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"})]}),v.jsxs("div",{className:"absolute top-[15px] left-0 right-0 p-4 pt-safe pt-4 flex justify-between items-start z-10",children:[v.jsx("button",{onClick:t,className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-black/50 transition-colors",children:v.jsx(ts,{className:"w-6 h-6"})}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>yt(!0),className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-black/50 transition-colors opacity-0 group-hover:opacity-100",children:v.jsx(wa,{className:"w-5 h-5"})}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("button",{onClick:()=>Ue(!0),className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors",children:v.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})}),v.jsx("button",{onClick:()=>a(n.id),"data-testid":"btn-ai-planner",className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors",children:v.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),v.jsx("button",{onClick:()=>i(n.id),className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-red-500/50 transition-colors",children:v.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),He&&v.jsx(NB,{trip:n,currentUser:e,onClose:()=>Ue(!1),onUpdate:r})]}),v.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-5 text-white z-10",children:[vt?v.jsx("div",{className:"flex items-center gap-2 mb-2",children:v.jsx("input",{value:qt,onChange:Ne=>_n(Ne.target.value),className:"bg-white/20 backdrop-blur-md text-white text-3xl font-black px-2 py-1 rounded-lg outline-none w-full",autoFocus:!0,onBlur:Ye,onKeyDown:Ne=>Ne.key==="Enter"&&Ye()})}):v.jsxs("h1",{className:"text-3xl font-black mb-2 leading-tight drop-shadow-md cursor-pointer hover:text-coral/90 transition-colors flex items-center gap-2",onClick:()=>{nt(!0),_n(n.title)},children:[n.title,v.jsx(jb,{className:"w-5 h-5 opacity-50"})]}),v.jsxs("div",{className:"flex items-center gap-3 text-sm font-bold text-gray-200",children:[v.jsxs("span",{className:"bg-white/20 backdrop-blur-md px-2 py-0.5 rounded text-xs",children:[n.days," Days"]}),v.jsxs("span",{children:[n.startDate," - ",n.endDate]})]})]})]}),v.jsx("div",{className:"flex-1 overflow-y-auto bg-paper relative rounded-t-3xl -mt-6 z-20 shadow-[0_-4px_20px_rgba(0,0,0,0.1)]",children:v.jsxs("div",{className:"p-5 min-h-full",children:[m==="ITINERARY"&&v.jsx(LL,{trip:n,settings:u,onUpdateTrip:r,onOpenQuickExpense:dt}),m==="MAP"&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{className:"mb-4 flex gap-2",children:[v.jsxs("div",{className:"flex-1 relative",children:[v.jsx("input",{type:"text",value:V,onChange:Ne=>z(Ne.target.value),onKeyDown:Ne=>Ne.key==="Enter"&&pe(),placeholder:f.search_placeholder,className:"w-full pl-10 pr-4 py-2 rounded-full border border-sand focus:border-coral focus:ring-1 focus:ring-coral outline-none text-sm"}),v.jsx($2,{className:"w-4 h-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2"})]}),v.jsx("button",{onClick:()=>pe(),disabled:ne||!V.trim(),className:"bg-ink text-white px-4 py-2 rounded-full text-sm font-bold disabled:opacity-50 flex items-center gap-1",children:ne?v.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):f.search_location})]}),v.jsx(h4,{trip:n,settings:u,searchedLocation:Z,onItemClick:Ne=>pe(Ne),mapSearchQuery:V})]}),m==="BUDGET"&&v.jsx(OL,{trip:n,settings:u,onUpdateTrip:r}),m==="BOOKINGS"&&v.jsx(UL,{trip:n,settings:u,onUpdateTrip:r}),m==="SHOPPING"&&v.jsx(kL,{items:n.shoppingList||[],onUpdateItems:Ne=>r==null?void 0:r({...n,shoppingList:Ne}),settings:u})]})}),v.jsx("div",{className:"absolute bottom-6 left-6 right-6 bg-white/90 backdrop-blur-xl rounded-full shadow-2xl border border-white/50 p-1.5 flex justify-between items-center z-30",children:[{id:"ITINERARY",icon:Hb,label:f.itinerary},{id:"MAP",icon:rE,label:f.map},{id:"BUDGET",icon:Fb,label:f.budget},{id:"BOOKINGS",icon:qb,label:f.bookings},{id:"SHOPPING",icon:Kb,label:f.shopping}].map(Ne=>v.jsxs("button",{onClick:()=>p(Ne.id),className:`flex-1 flex flex-col items-center justify-center py-2 rounded-full transition-all duration-300 ${m===Ne.id?"bg-ink text-white shadow-lg scale-105":"text-gray-400 hover:text-ink hover:bg-gray-100"}`,children:[v.jsx(Ne.icon,{className:`w-5 h-5 ${m===Ne.id?"stroke-2":"stroke-[1.5]"}`}),m===Ne.id&&v.jsx("span",{className:"text-[10px] font-bold mt-0.5",children:Ne.label})]},Ne.id))}),E&&v.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",children:v.jsxs("div",{className:"bg-white rounded-3xl p-6 w-full max-w-xs shadow-2xl animate-scale-in text-center",children:[v.jsx("div",{className:"w-16 h-16 bg-red-100 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx(Ra,{className:"w-8 h-8"})}),v.jsx("h3",{className:"text-xl font-bold text-ink mb-2",children:f.delete_trip}),v.jsx("p",{className:"text-gray-500 mb-6",children:f.delete_trip_confirm.replace("{title}",n.title)}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{onClick:()=>S(!1),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:f.cancel}),v.jsx("button",{onClick:Ve,className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 shadow-lg shadow-red-500/30 transition-colors",children:f.delete})]})]})}),Vt&&v.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>yt(!1),children:v.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:Ne=>Ne.stopPropagation(),children:[v.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:""}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("button",{onClick:()=>pt("upload"),className:"w-full py-4 bg-white border border-sand rounded-xl font-bold text-ink hover:bg-gray-50 flex items-center justify-center gap-2",children:[v.jsx("span",{children:""})," "]}),v.jsx("button",{onClick:()=>pt("ai"),disabled:Rt,className:"w-full py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:Rt?v.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):v.jsxs(v.Fragment,{children:[v.jsx("span",{children:""})," AI "]})}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-0 flex items-center",children:v.jsx("div",{className:"w-full border-t border-sand"})}),v.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:v.jsx("span",{className:"bg-paper px-2 text-gray-400",children:"OR"})})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{value:St,onChange:Ne=>kt(Ne.target.value),placeholder:"...",className:"flex-1 bg-white p-3 rounded-xl border border-sand outline-none"}),v.jsx("button",{onClick:()=>pt("url"),disabled:!St,className:"bg-ink text-white px-4 rounded-xl font-bold disabled:opacity-50",children:"OK"})]})]})]})}),ge&&v.jsx("div",{className:"fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>Ae(!1),children:v.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:Ne=>Ne.stopPropagation(),children:[v.jsx("h3",{className:"text-xl font-bold text-ink mb-2 text-center",children:""}),v.jsx("p",{className:"text-center text-gray-400 text-sm mb-6",children:he==null?void 0:he.activity}),v.jsxs("div",{className:"space-y-4",children:[F.map((Ne,lt)=>v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{value:Ne.name,onChange:at=>Si(lt,"name",at.target.value),placeholder:" (: )",className:"flex-1 bg-white p-3 rounded-xl font-bold border-none shadow-sm outline-none",autoFocus:lt===0}),v.jsx("input",{type:"number",value:Ne.price,onChange:at=>Si(lt,"price",at.target.value),placeholder:Rl(Je),className:"w-24 bg-white p-3 rounded-xl font-bold border-none shadow-sm outline-none text-center",onFocus:at=>at.target.select()})]},lt)),v.jsx("button",{onClick:ki,className:"text-xs font-bold text-coral flex items-center gap-1 mx-auto hover:bg-coral/10 px-3 py-1 rounded-lg transition-colors",children:"+ "}),v.jsxs("div",{className:"pt-4 border-t border-sand",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("div",{className:"flex items-center gap-2",children:v.jsx("select",{value:Je,onChange:Ne=>ie(Ne.target.value),className:"bg-transparent font-bold text-gray-400 outline-none text-sm",children:Fy.map(Ne=>v.jsx("option",{value:Ne.code,children:Ne.code},Ne.code))})}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("span",{className:"font-bold text-ink text-2xl",children:Rl(Je)}),v.jsx("input",{type:"number",value:O,onChange:Ne=>G(Ne.target.value),className:"w-32 bg-transparent text-right text-3xl font-black border-none outline-none p-0",placeholder:"0",onFocus:Ne=>Ne.target.select()})]})]}),Je!==an&&v.jsxs("div",{className:"mb-4 bg-sand/30 p-3 rounded-xl",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsxs("label",{className:"text-xs font-bold text-gray-500",children:[" (",Je,"  ",an,")"]}),v.jsxs("span",{className:"text-xs font-bold text-coral",children:[" ",ns,$e.toLocaleString()]})]}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{value:be,onChange:Ne=>Se(Ne.target.value),type:"number",step:"0.01",placeholder:j?"...":"Exchange Rate",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none",onFocus:Ne=>Ne.target.select(),disabled:j}),j&&v.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:v.jsx("div",{className:"w-4 h-4 border-2 border-coral border-t-transparent rounded-full animate-spin"})})]}),!u.apiKey&&v.jsx("p",{className:"text-[10px] text-red-400 mt-1",children:"*  API Key "}),Ie&&v.jsxs("p",{className:"text-[10px] text-red-400 mt-1",children:["* ",Ie]})]}),v.jsx("textarea",{value:q,onChange:Ne=>K(Ne.target.value),placeholder:"...",className:"w-full bg-white p-3 rounded-xl text-sm font-medium border-none shadow-sm outline-none min-h-[60px]"})]}),v.jsx("button",{onClick:xn,disabled:!O,className:"w-full bg-ink text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-ink/30 mt-2 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:""})]})]})})]})},MB=({onStartGeneration:n,onCancel:e,settings:t,sessions:i,currentSessionId:r,onCreateSession:a,onUpdateSession:u,onDeleteSession:f,onSelectSession:m})=>{const p=on[t.language]||on["zh-TW"],[E,S]=W.useState(""),[A,R]=W.useState(!1),[V,z]=W.useState(!1),Z=W.useRef(null),X=i.find(Y=>Y.id===r),ne=(X==null?void 0:X.messages)||[],Q=()=>{var Y;(Y=Z.current)==null||Y.scrollIntoView({behavior:"smooth"})};W.useEffect(Q,[ne]),W.useEffect(()=>{r&&ne.length===0?u(r,[{role:"ai",content:p.ai_planner_intro,timestamp:Date.now()}]):!r&&i.length===0?a():!r&&i.length>0&&m(i[0].id)},[r,i.length]);const pe=()=>{a(),z(!1)},he=async()=>{if(!E.trim()||!r)return;const Y={role:"user",content:E,timestamp:Date.now()},D=[...ne,Y];u(r,D),S(""),R(!0);const B={role:"ai",content:p.ai_planning,timestamp:Date.now()};u(r,[...D,B]),n(E,X==null?void 0:X.tripId).then(O=>{const G={role:"ai",content:p.ai_done,timestamp:Date.now()};O?u(r,[...D,G],O.title,O.tripId):u(r,[...D,G]),R(!1)})};return v.jsxs("div",{className:"flex h-full bg-paper pt-safe relative overflow-hidden",children:[V&&v.jsx("div",{className:"absolute inset-0 bg-black/20 z-20 backdrop-blur-sm",onClick:()=>z(!1)}),v.jsxs("div",{className:`absolute top-0 left-0 bottom-0 w-64 bg-white shadow-2xl z-30 transform transition-transform duration-300 ease-in-out ${V?"translate-x-0":"-translate-x-full"}`,children:[v.jsxs("div",{className:"p-4 border-b border-sand flex justify-between items-center pt-12",children:[v.jsx("h3",{className:"font-bold text-lg text-ink",children:t.language==="zh-TW"?"":"Chat History"}),v.jsx("button",{onClick:pe,className:"p-2 bg-coral/10 rounded-full text-coral hover:bg-coral/20",children:v.jsx(Ry,{className:"w-5 h-5"})})]}),v.jsxs("div",{className:"overflow-y-auto h-full pb-20",children:[i.map(Y=>v.jsxs("div",{onClick:()=>{m(Y.id),z(!1)},className:`p-4 border-b border-sand/50 cursor-pointer hover:bg-sand/30 transition-colors ${r===Y.id?"bg-sand/50 border-l-4 border-l-coral":""}`,children:[v.jsx("div",{className:"font-medium text-ink truncate",children:Y.title}),v.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(Y.updatedAt).toLocaleDateString()})]},Y.id)),i.length===0&&v.jsx("div",{className:"p-8 text-center text-gray-400 text-sm",children:t.language==="zh-TW"?"":"No chat history"})]})]}),v.jsxs("div",{className:"flex-1 flex flex-col h-full w-full",children:[v.jsxs("div",{className:"px-4 py-3 border-b border-sand/50 flex items-center justify-between bg-paper sticky top-0 z-10 pt-safe pt-4",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-white text-gray-500 transition-colors",children:v.jsx(ts,{className:"w-6 h-6"})}),v.jsx("button",{onClick:()=>z(!0),className:"ml-2 p-2 rounded-full hover:bg-white text-gray-500 transition-colors",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})}),v.jsxs("h2",{className:"text-lg font-bold text-ink ml-2 flex items-center gap-2 truncate max-w-[150px]",children:[v.jsx(Gb,{className:"w-5 h-5 text-coral"}),(X==null?void 0:X.title)||p.ai_planner_title]})]}),v.jsx("button",{onClick:pe,className:"text-xs font-bold text-coral border border-coral/30 px-3 py-1.5 rounded-full hover:bg-coral/10 transition-colors",children:t.language==="zh-TW"?"":"New Chat"})]}),v.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24",children:[ne.map((Y,D)=>v.jsx("div",{className:`flex ${Y.role==="user"?"justify-end":"justify-start"} animate-slide-up`,children:v.jsx("div",{className:`max-w-[85%] p-4 rounded-2xl text-sm font-medium leading-relaxed shadow-sm whitespace-pre-line ${Y.role==="user"?"bg-coral text-white rounded-tr-none":"bg-white text-ink border border-sand rounded-tl-none"}`,children:Y.content})},D)),A&&v.jsx("div",{className:"flex justify-start",children:v.jsxs("div",{className:"bg-white p-4 rounded-2xl rounded-tl-none border border-sand flex items-center gap-2",children:[v.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce"}),v.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce delay-100"}),v.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce delay-200"}),v.jsx("span",{className:"text-xs text-gray-400 font-bold ml-1",children:p.planning_process})]})}),v.jsx("div",{ref:Z})]}),v.jsxs("div",{className:"p-4 bg-white/90 backdrop-blur border-t border-sand pb-32",children:[v.jsxs("div",{className:"flex gap-2",children:[v.jsx("textarea",{value:E,onChange:Y=>S(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&!Y.shiftKey&&(Y.preventDefault(),he())},placeholder:p.input_placeholder,"data-testid":"input-ai-chat",className:"flex-1 bg-paper rounded-2xl px-5 py-3.5 outline-none focus:ring-2 focus:ring-coral/50 transition-all font-medium text-ink placeholder:text-gray-400 border border-sand resize-none min-h-[50px] max-h-[120px]",disabled:A,rows:1}),v.jsx("button",{onClick:he,"data-testid":"btn-ai-send",disabled:!E.trim()||A,className:"bg-coral text-white p-3.5 rounded-2xl disabled:opacity-50 active:scale-95 transition-transform shadow-lg shadow-coral/20",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:v.jsx("path",{d:"M3.105 2.289a.75.75 0 0 0-.826.95l1.414 4.925A1.5 1.5 0 0 0 5.135 9.25h6.115a.75.75 0 0 1 0 1.5H5.135a1.5 1.5 0 0 0-1.442 1.086l-1.414 4.926a.75.75 0 0 0 .826.95 28.896 28.896 0 0 0 15.293-7.154.75.75 0 0 0 0-1.115A28.897 28.897 0 0 0 3.105 2.289Z"})})})]}),v.jsx("div",{className:"flex gap-2 mt-3 overflow-x-auto no-scrollbar pb-2",children:[p.prompt_tokyo,p.prompt_bangkok,p.prompt_paris].map(Y=>v.jsx("button",{onClick:()=>S(Y),className:"whitespace-nowrap px-4 py-2 bg-white text-gray-500 text-xs font-bold rounded-xl border border-sand hover:text-coral hover:border-coral transition-colors",disabled:A,children:Y},Y))})]})]})]})},PB="https://api.exchangerate-api.com/v4/latest/TWD";let Nd=null,Vb=0;const DB=1440*60*1e3,kB=async()=>{const n=Date.now();if(Nd&&n-Vb<DB)return Nd;try{const t=await(await fetch(PB)).json();return Nd=t,Vb=n,t}catch(e){return console.error("Failed to fetch exchange rates:",e),Nd||{base:"TWD",rates:{TWD:1,JPY:.22,KRW:.043,USD:31.5,EUR:34.2}}}},LB=async(n,e)=>{if(e==="TWD")return n;const i=(await kB()).rates[e];return i?n/i:(console.warn(`Unknown currency: ${e}`),n)},VB=(n,e="TWD")=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:e==="TWD"?"TWD":e,minimumFractionDigits:0,maximumFractionDigits:0}).format(n),oN=()=>"webkitSpeechRecognition"in window||"SpeechRecognition"in window,e0=()=>"speechSynthesis"in window,OB=(n="zh-TW",e,t)=>{if(!oN())return t==null||t(""),null;const i=window.webkitSpeechRecognition||window.SpeechRecognition,r=new i;return r.continuous=!1,r.interimResults=!1,r.lang=n,r.onresult=a=>{const u=a.results[0][0].transcript;e(u)},r.onerror=a=>{t==null||t(a.error)},r.start(),r},aN=(n,e="zh-TW",t)=>{if(!e0()){console.error("");return}window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(n);i.lang=e,i.rate=1,i.pitch=1,i.volume=1,t&&(i.onend=t),window.speechSynthesis.speak(i)},UB=()=>{e0()&&window.speechSynthesis.cancel()},BB=async(n,e,t,i,r)=>new Promise((a,u)=>{OB(n,async m=>{t==null||t(m);try{const p=await R1(m,e,n);p?(i==null||i(p),aN(p,e,()=>{a()})):(r==null||r(""),u("Translation failed"))}catch(p){r==null||r(p),u(p)}},m=>{r==null||r(m),u(m)})||u("Speech recognition not supported")}),Uf={recognition:oN(),synthesis:e0()};function zB({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"}))}const FB=W.forwardRef(zB);function qB({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"}))}const GB=W.forwardRef(qB);function HB({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const Ob=W.forwardRef(HB);function jB({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"}))}const KB=W.forwardRef(jB),ZB=({defaultSourceLang:n="zh-TW",defaultTargetLang:e="en-US"})=>{const[t,i]=W.useState(n),[r,a]=W.useState(e),[u,f]=W.useState(""),[m,p]=W.useState(""),[E,S]=W.useState(!1),[A,R]=W.useState(!1),[V,z]=W.useState(""),Z=[{code:"zh-TW",name:""},{code:"en-US",name:"English"},{code:"ja-JP",name:""},{code:"ko-KR",name:""},{code:"th-TH",name:""}],X=async()=>{if(!Uf.recognition){z("");return}z(""),S(!0),f(""),p("");try{await BB(t,r,he=>{f(he)},he=>{p(he),R(!0)},he=>{z(`${he}`)})}catch(he){console.error(he)}finally{S(!1),R(!1)}},ne=()=>{i(r),a(t),f(""),p("")},Q=(he,Y)=>{if(!Uf.synthesis){z("");return}aN(he,Y)},pe=()=>{UB(),R(!1)};return v.jsxs("div",{className:"max-w-4xl mx-auto p-6 pt-12 bg-paper rounded-3xl shadow-float",children:[v.jsx("h2",{className:"text-2xl font-bold text-ink mb-6 text-center",children:" "}),v.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[v.jsx("select",{value:t,onChange:he=>i(he.target.value),className:"flex-1 p-3 rounded-xl border-2 border-sand bg-white text-ink font-medium focus:border-coral outline-none",children:Z.map(he=>v.jsx("option",{value:he.code,children:he.name},he.code))}),v.jsx("button",{onClick:ne,className:"p-3 rounded-full bg-coral text-white hover:bg-coralDark active:scale-95 transition-all",children:v.jsx(FB,{className:"w-5 h-5"})}),v.jsx("select",{value:r,onChange:he=>a(he.target.value),className:"flex-1 p-3 rounded-xl border-2 border-sand bg-white text-ink font-medium focus:border-coral outline-none",children:Z.map(he=>v.jsx("option",{value:he.code,children:he.name},he.code))})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[v.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-sand min-h-[120px] flex flex-col",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:" ()"}),u&&v.jsx("button",{onClick:()=>Q(u,t),className:"p-1 text-coral hover:text-coralDark",children:v.jsx(Ob,{className:"w-4 h-4"})})]}),v.jsx("textarea",{value:u,onChange:he=>f(he.target.value),placeholder:"...",className:"w-full flex-1 resize-none outline-none text-ink bg-transparent placeholder:text-gray-300"})]}),v.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-sand min-h-[120px]",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),m&&v.jsx("button",{onClick:()=>Q(m,r),className:"p-1 text-coral hover:text-coralDark",children:v.jsx(Ob,{className:"w-4 h-4"})})]}),v.jsx("p",{className:"text-ink whitespace-pre-wrap",children:m||"..."})]})]}),V&&v.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm",children:V}),v.jsxs("div",{className:"flex gap-3",children:[v.jsxs("button",{onClick:X,disabled:E||A,className:`flex-1 py-4 rounded-2xl font-bold text-lg flex items-center justify-center gap-2 transition-all ${E?"bg-red-500 text-white animate-pulse":"bg-coral text-white hover:bg-coralDark active:scale-95"}`,children:[v.jsx(GB,{className:"w-6 h-6"}),E?"...":""]}),(E||A)&&v.jsxs("button",{onClick:pe,className:"px-6 py-4 rounded-2xl font-bold bg-gray-500 text-white hover:bg-gray-600 active:scale-95 transition-all flex items-center gap-2",children:[v.jsx(KB,{className:"w-6 h-6"}),""]})]}),(!Uf.recognition||!Uf.synthesis)&&v.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-xl text-yellow-800 text-sm",children:"  ChromeEdge  Safari "})]})},JB=({onBack:n})=>v.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[v.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[v.jsx("button",{onClick:n,children:v.jsx(ts,{className:"w-6 h-6 text-gray-500"})}),v.jsx("h3",{className:"font-bold text-lg text-ink",children:""})]}),v.jsx("div",{className:"p-5 flex items-center justify-center h-full text-gray-400 text-center font-medium",children:v.jsx("p",{children:""})})]}),YB=({onBack:n,t:e,language:t,onOpenSettings:i})=>{var R,V,z,Z,X,ne;const[r,a]=W.useState("Taiwan (ROC)"),[u,f]=W.useState(""),[m,p]=W.useState(null),[E,S]=W.useState(!1),A=async()=>{if(u){S(!0),p(null);try{const Q=await S1(r,u,t);p(Q)}catch(Q){console.error(Q),p(null)}finally{S(!1)}}};return v.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[v.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[v.jsx("button",{onClick:n,children:v.jsx(ts,{className:"w-6 h-6 text-gray-500"})}),v.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_visa})]}),v.jsxs("div",{className:"p-5 space-y-4 overflow-y-auto flex-1 pb-32",children:[v.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card space-y-5 border border-sand",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),v.jsxs("select",{value:r,onChange:Q=>a(Q.target.value),className:"w-full mt-2 p-3 bg-paper rounded-xl text-ink font-medium border-none outline-none",children:[v.jsx("option",{value:"Taiwan (ROC)",children:" (Taiwan)"}),v.jsx("option",{value:"Japan",children:" (Japan)"}),v.jsx("option",{value:"USA",children:" (USA)"}),v.jsx("option",{value:"Hong Kong",children:" (Hong Kong)"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),v.jsx("input",{value:u,onChange:Q=>f(Q.target.value),placeholder:"...",className:"w-full mt-2 p-3 bg-paper rounded-xl text-ink font-medium border-none outline-none"})]}),v.jsx("button",{onClick:A,disabled:E||!u,className:"w-full bg-coral text-white py-3.5 rounded-xl font-bold shadow-lg shadow-coral/30 disabled:opacity-50",children:E?e.loading:e.confirm})]}),m&&v.jsxs("div",{className:"space-y-4 animate-slide-up",children:[v.jsxs("div",{className:"bg-white p-4 rounded-3xl shadow-sm border border-sand flex justify-between items-center",children:[v.jsx("span",{className:"font-bold text-gray-500 text-sm uppercase",children:""}),v.jsx("span",{className:`px-4 py-1.5 rounded-full font-bold text-sm ${(R=m.difficulty)!=null&&R.includes("Easy")||(V=m.difficulty)!=null&&V.includes("")||(z=m.difficulty)!=null&&z.includes("")?"bg-green-100 text-green-600":(Z=m.difficulty)!=null&&Z.includes("Hard")||(X=m.difficulty)!=null&&X.includes("")?"bg-red-100 text-red-600":"bg-yellow-100 text-yellow-600"}`,children:m.difficulty})]}),v.jsx("div",{className:"bg-ink text-white p-6 rounded-3xl shadow-lg",children:v.jsx("p",{className:"font-medium leading-relaxed",children:m.summary})}),v.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand",children:[v.jsxs("h4",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[v.jsx("span",{className:"w-2 h-6 bg-coral rounded-full"}),""]}),v.jsx("ul",{className:"space-y-3",children:(ne=m.requirements)==null?void 0:ne.map((Q,pe)=>v.jsxs("li",{className:"flex gap-3 text-sm text-gray-600",children:[v.jsx("span",{className:"text-coral mt-0.5",children:""}),v.jsx("span",{className:"flex-1",children:Q})]},pe))})]})]})]})]})},WB=({onBack:n,t:e,language:t,onOpenSettings:i})=>{var S,A;const[r,a]=W.useState(""),[u,f]=W.useState(null),[m,p]=W.useState(!1),E=async()=>{p(!0),f(null);try{const V=await b1(r||"Kyoto, Japan",t);f(V)}catch(R){console.error(R)}finally{p(!1)}};return v.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[v.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[v.jsx("button",{onClick:n,children:v.jsx(ts,{className:"w-6 h-6 text-gray-500"})}),v.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_culture})]}),v.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[v.jsx("div",{className:"mb-4",children:v.jsx("input",{value:r,onChange:R=>a(R.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl shadow-sm border border-sand font-medium text-ink outline-none"})}),v.jsx("button",{onClick:E,disabled:m,className:"w-full bg-orange-400 text-white px-4 py-3.5 rounded-2xl font-bold text-sm shadow-md mb-6",children:m?e.loading:e.confirm}),u&&v.jsxs("div",{className:"space-y-4 animate-slide-up",children:[v.jsxs("div",{className:"bg-white p-5 rounded-3xl shadow-sm border border-sand",children:[v.jsx("h4",{className:"font-bold text-orange-500 text-sm uppercase mb-2",children:" "}),v.jsx("p",{className:"text-ink text-sm leading-relaxed",children:u.tipping})]}),v.jsxs("div",{className:"bg-green-50 p-5 rounded-3xl border border-green-100",children:[v.jsx("h4",{className:"font-bold text-green-600 text-sm uppercase mb-3",children:" Do's ()"}),v.jsx("ul",{className:"space-y-2",children:(S=u.dos)==null?void 0:S.map((R,V)=>v.jsxs("li",{className:"flex gap-2 text-sm text-green-800",children:[v.jsx("span",{children:""}),v.jsx("span",{children:R})]},V))})]}),v.jsxs("div",{className:"bg-red-50 p-5 rounded-3xl border border-red-100",children:[v.jsx("h4",{className:"font-bold text-red-600 text-sm uppercase mb-3",children:" Don'ts ()"}),v.jsx("ul",{className:"space-y-2",children:(A=u.donts)==null?void 0:A.map((R,V)=>v.jsxs("li",{className:"flex gap-2 text-sm text-red-800",children:[v.jsx("span",{children:""}),v.jsx("span",{children:R})]},V))})]}),v.jsxs("div",{className:"bg-white p-5 rounded-3xl shadow-sm border border-sand",children:[v.jsx("h4",{className:"font-bold text-gray-400 text-sm uppercase mb-2",children:" "}),v.jsx("p",{className:"text-ink text-sm leading-relaxed",children:u.dressCode})]})]})]})]})},QB=({onBack:n,t:e})=>v.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[v.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[v.jsx("button",{onClick:n,children:v.jsx(ts,{className:"w-6 h-6 text-gray-500"})}),v.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_restroom})]}),v.jsx("div",{className:"flex-1 relative rounded-t-3xl overflow-hidden shadow-inner border-t border-sand",children:v.jsx("iframe",{width:"100%",height:"100%",style:{border:0},loading:"lazy",allowFullScreen:!0,src:"https://maps.google.com/maps?q=public+restroom&output=embed"})})]}),$B=({onBack:n,t:e,language:t,onOpenSettings:i})=>{var R;const[r,a]=W.useState(""),[u,f]=W.useState(null),[m,p]=W.useState(null),[E,S]=W.useState(!1),A=async()=>{if(r){S(!0),f(null),p(null);try{const V=await I1(r,t);V?f(V):p(" API Key ")}catch{p("")}finally{S(!1)}}};return v.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[v.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[v.jsx("button",{onClick:n,children:v.jsx(ts,{className:"w-6 h-6 text-gray-500"})}),v.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_emergency})]}),v.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[v.jsxs("div",{className:"bg-red-500 text-white p-6 rounded-3xl shadow-lg shadow-red-500/20 mb-6",children:[v.jsx("h2",{className:"text-xl font-bold mb-2",children:"SOS?"}),v.jsxs("p",{className:"opacity-90 text-sm",children:[": ",v.jsx("span",{className:"font-black text-2xl ml-1",children:"112"})]})]}),v.jsxs("div",{className:"space-y-3 mb-6",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:""}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{value:r,onChange:V=>a(V.target.value),onKeyDown:V=>V.key==="Enter"&&A(),placeholder:" ()...",className:"flex-1 p-4 bg-white rounded-2xl border border-sand shadow-sm outline-none font-bold text-ink"}),v.jsx("button",{onClick:A,disabled:E||!r,className:"px-6 bg-ink text-white rounded-2xl font-bold shadow-lg disabled:opacity-50",children:E?v.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Go"})]})]}),m&&v.jsxs("div",{className:"p-6 bg-red-50 border border-red-200 rounded-3xl text-red-600 text-center font-medium animate-fade-in",children:[m,m.includes("API")&&v.jsx("button",{onClick:i,className:"mt-3 text-sm underline hover:text-red-800",children:""})]}),u&&v.jsxs("div",{className:"space-y-6 animate-slide-up",children:[v.jsxs("div",{className:"bg-white rounded-3xl shadow-card border border-sand overflow-hidden",children:[v.jsx("div",{className:"p-4 bg-gray-50 border-b border-sand",children:v.jsx("h4",{className:"font-bold text-gray-500 text-sm uppercase",children:""})}),v.jsx("div",{className:"divide-y divide-sand",children:(R=u.numbers)==null?void 0:R.map((V,z)=>v.jsxs("div",{className:"flex justify-between items-center p-4 hover:bg-gray-50 transition-colors",children:[v.jsx("span",{className:"font-bold text-ink",children:V.label}),v.jsx("a",{href:`tel:${V.number}`,className:"font-black text-xl text-coral bg-coral/10 px-3 py-1 rounded-lg hover:bg-coral hover:text-white transition-colors",children:V.number})]},z))})]}),u.hospital&&v.jsxs("div",{className:"bg-white rounded-3xl shadow-card border border-sand overflow-hidden",children:[v.jsx("div",{className:"p-4 bg-gray-50 border-b border-sand",children:v.jsx("h4",{className:"font-bold text-gray-500 text-sm uppercase",children:""})}),v.jsxs("div",{className:"p-5 space-y-3",children:[v.jsx("h3",{className:"text-lg font-black text-ink",children:u.hospital.name}),v.jsxs("div",{className:"flex items-start gap-3 text-sm text-gray-600",children:[v.jsx("span",{className:"shrink-0 text-xl",children:""}),v.jsx("span",{className:"font-medium leading-relaxed",children:u.hospital.address})]}),v.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[v.jsx("span",{className:"text-xl",children:""}),v.jsx("a",{href:`tel:${u.hospital.phone}`,className:"font-bold text-coral underline decoration-2 underline-offset-2",children:u.hospital.phone})]})]})]})]})]})]})},XB=({onBack:n,t:e,language:t,onOpenSettings:i})=>{var S,A;const[r,a]=W.useState(""),[u,f]=W.useState(null),[m,p]=W.useState(!1),E=async()=>{if(r){p(!0),f(null);try{const R=await C1(r,t);f(R)}catch(R){console.error(R)}finally{p(!1)}}};return v.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[v.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[v.jsx("button",{onClick:n,children:v.jsx(ts,{className:"w-6 h-6 text-gray-500"})}),v.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_card})]}),v.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[v.jsxs("div",{className:"space-y-3",children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:""}),v.jsx("input",{value:r,onChange:R=>a(R.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl border border-sand shadow-sm outline-none"}),v.jsx("button",{onClick:E,disabled:m||!r,className:"w-full py-3.5 bg-indigo-500 text-white rounded-2xl font-bold shadow-lg shadow-indigo-200",children:m?e.loading:e.confirm})]}),u&&v.jsxs("div",{className:"space-y-4 mt-6 animate-slide-up",children:[v.jsxs("div",{className:"bg-indigo-50 p-5 rounded-3xl border border-indigo-100",children:[v.jsx("h4",{className:"font-bold text-indigo-600 text-sm uppercase mb-3",children:" "}),v.jsx("div",{className:"flex flex-wrap gap-2",children:(S=u.bestCards)==null?void 0:S.map((R,V)=>v.jsx("span",{className:"bg-white text-indigo-600 px-3 py-1 rounded-lg text-sm font-bold shadow-sm",children:R},V))})]}),v.jsxs("div",{className:"bg-white p-5 rounded-3xl shadow-sm border border-sand",children:[v.jsx("h4",{className:"font-bold text-gray-400 text-sm uppercase mb-2",children:" "}),v.jsx("p",{className:"text-ink text-sm leading-relaxed",children:u.cashInfo})]}),v.jsxs("div",{className:"bg-white p-5 rounded-3xl shadow-sm border border-sand",children:[v.jsx("h4",{className:"font-bold text-gray-400 text-sm uppercase mb-2",children:" "}),v.jsx("ul",{className:"space-y-2",children:(A=u.tips)==null?void 0:A.map((R,V)=>v.jsxs("li",{className:"flex gap-2 text-sm text-gray-600",children:[v.jsx("span",{className:"text-coral mt-0.5",children:""}),v.jsx("span",{children:R})]},V))})]})]})]})]})};let ez=Ql.icon({iconUrl:B1,shadowUrl:z1,iconSize:[25,41],iconAnchor:[12,41]});Ql.Marker.prototype.options.icon=ez;const Ub={Japan:[36.2048,138.2529],Taiwan:[23.6978,120.9605],Thailand:[15.87,100.9925],USA:[37.0902,-95.7129],France:[46.2276,2.2137],"South Korea":[35.9078,127.7669],Vietnam:[14.0583,108.2772],China:[35.8617,104.1954],Germany:[51.1657,10.4515],Italy:[41.8719,12.5674],UK:[55.3781,-3.436],Spain:[40.4637,-3.7492],Australia:[-25.2744,133.7751],Canada:[56.1304,-106.3468],Singapore:[1.3521,103.8198],Malaysia:[4.2105,101.9758],Philippines:[12.8797,121.774],Indonesia:[-.7893,113.9213],India:[20.5937,78.9629],Russia:[61.524,105.3188],Brazil:[-14.235,-51.9253],Mexico:[23.6345,-102.5528],Egypt:[26.8206,30.8025],Turkey:[38.9637,35.2433],Netherlands:[52.1326,5.2913],Switzerland:[46.8182,8.2275],Austria:[47.5162,14.5501],Belgium:[50.5039,4.4699],Sweden:[60.1282,18.6435],Norway:[60.472,8.4689],Denmark:[56.2639,9.5018],Finland:[61.9241,25.7482],"New Zealand":[-40.9006,174.886],"Hong Kong":[22.3193,114.1694],Macau:[22.1987,113.5439]},tz=({onReady:n})=>{const e=Zm();return W.useEffect(()=>{const t=setTimeout(()=>{e.invalidateSize(),n()},250);return()=>clearTimeout(t)},[e,n]),null},nz=({onBack:n,trips:e,t})=>{const[i,r]=W.useState(new Set(["Japan","Thailand","Taiwan"])),[a,u]=W.useState(""),[f,m]=W.useState(!1);W.useEffect(()=>{if(e){const S=new Set(i);e.forEach(A=>{(A.title.includes("")||A.title.includes("Japan")||A.title.includes("")||A.title.includes("")||A.title.includes("Tokyo"))&&S.add("Japan"),(A.title.includes("")||A.title.includes("Thailand")||A.title.includes(""))&&S.add("Thailand"),(A.title.includes("")||A.title.includes("Taiwan")||A.title.includes(""))&&S.add("Taiwan"),(A.title.includes("")||A.title.includes("USA"))&&S.add("USA"),(A.title.includes("")||A.title.includes("France")||A.title.includes("Paris"))&&S.add("France"),(A.title.includes("")||A.title.includes("Korea")||A.title.includes(""))&&S.add("South Korea"),(A.title.includes("")||A.title.includes("Vietnam"))&&S.add("Vietnam"),(A.title.includes("")||A.title.includes("China")||A.title.includes("")||A.title.includes(""))&&S.add("China"),(A.title.includes("")||A.title.includes("Hong Kong"))&&S.add("Hong Kong")}),r(S)}},[e]);const p=()=>{if(a.trim()){const S=a.trim(),A=Object.keys(Ub).find(R=>R.toLowerCase()===S.toLowerCase());r(A?R=>new Set(R).add(A):R=>new Set(R).add(S)),u("")}},E=S=>{const A=new Set(i);A.delete(S),r(A)};return v.jsxs("div",{className:"flex flex-col h-full bg-[#111827] text-white",children:[v.jsx("div",{className:"bg-[#111827] p-4 pt-9 flex items-center justify-between sticky top-0 z-10 border-b border-gray-800",children:v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{onClick:n,children:v.jsx(ts,{className:"w-6 h-6 text-gray-300"})}),v.jsx("h3",{className:"font-bold text-lg",children:t.tool_map})]})}),v.jsxs("div",{className:"p-6 flex-1 overflow-y-auto pb-32",children:[v.jsxs("div",{className:"relative w-full aspect-[1.6] bg-[#1F2937] rounded-3xl overflow-hidden mb-8 shadow-2xl border border-gray-700",children:[v.jsxs(O1,{center:[20,0],zoom:2,style:{height:"100%",width:"100%",background:"#1F2937"},zoomControl:!1,attributionControl:!1,children:[v.jsx(U1,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),v.jsx(tz,{onReady:()=>m(!0)}),Array.from(i).map(S=>{const A=Ub[S];return A?v.jsx(Hy,{position:A,icon:Ql.divIcon({className:"custom-div-icon",html:'<div style="background-color: #FF6B6B; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 10px #FF6B6B;"></div>',iconSize:[12,12],iconAnchor:[6,6]}),children:v.jsx(jy,{children:v.jsx("div",{className:"text-ink font-bold",children:S})})},S):null})]}),v.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center pointer-events-none",children:v.jsx("div",{className:"inline-block bg-black/50 backdrop-blur-sm px-3 py-1 rounded-full text-xs text-gray-400 font-mono tracking-widest border border-white/10",children:"[  ]"})})]}),v.jsxs("div",{className:"bg-[#1F2937] rounded-3xl p-6 shadow-lg border border-gray-700 mb-6",children:[v.jsxs("div",{className:"flex justify-between items-center mb-5",children:[v.jsxs("h4",{className:"font-bold text-gray-200",children:[" (",i.size,")"]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsx("input",{value:a,onChange:S=>u(S.target.value),placeholder:" ()...",className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-1.5 text-sm text-white focus:outline-none focus:border-coral w-36 placeholder-gray-500"}),v.jsx("button",{onClick:p,className:"bg-coral p-1.5 rounded-lg text-white hover:bg-coralDark",children:v.jsx(Om,{className:"w-4 h-4"})})]})]}),v.jsx("div",{className:"flex flex-wrap gap-3",children:Array.from(i).map(S=>v.jsxs("div",{className:"group relative px-4 py-2 bg-coral/10 text-coral rounded-xl text-sm font-bold border border-coral/20 flex items-center gap-2",children:[S," ",v.jsx("button",{onClick:()=>E(S),className:"opacity-0 group-hover:opacity-100 absolute -top-2 -right-2 bg-white text-coral rounded-full p-0.5 transition-opacity",children:v.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},S))})]})]})]})},iz=({onBack:n,t:e})=>{const[t,i]=W.useState(""),[r,a]=W.useState("USD"),[u,f]=W.useState(null),[m,p]=W.useState(!1),E=[{code:"USD",name:" (USD)"},{code:"JPY",name:" (JPY)"},{code:"KRW",name:" (KRW)"},{code:"EUR",name:" (EUR)"},{code:"CNY",name:" (CNY)"},{code:"THB",name:" (THB)"},{code:"VND",name:" (VND)"}],S=async()=>{if(t){p(!0);try{const A=parseFloat(t),R=await LB(A,r);f(VB(R))}catch{f("")}finally{p(!1)}}};return v.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[v.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[v.jsx("button",{onClick:n,children:v.jsx(ts,{className:"w-6 h-6 text-gray-500"})}),v.jsx("h3",{className:"font-bold text-lg text-ink",children:""})]}),v.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[v.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand space-y-5",children:[v.jsxs("div",{children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),v.jsx("input",{type:"number",value:t,onChange:A=>i(A.target.value),placeholder:"...",className:"w-full mt-2 p-4 bg-paper rounded-2xl text-xl font-bold text-ink border-none outline-none"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),v.jsx("select",{value:r,onChange:A=>a(A.target.value),className:"w-full mt-2 p-4 bg-paper rounded-2xl text-ink font-medium border-none outline-none",children:E.map(A=>v.jsx("option",{value:A.code,children:A.name},A.code))})]}),v.jsx("button",{onClick:S,disabled:m||!t,className:"w-full bg-green-500 text-white py-4 rounded-2xl font-bold shadow-lg shadow-green-500/30 disabled:opacity-50 active:scale-95 transition-all",children:m?"...":" (TWD)"})]}),u&&v.jsxs("div",{className:"mt-6 bg-white p-6 rounded-3xl shadow-card border border-sand text-center animate-fade-in",children:[v.jsx("p",{className:"text-gray-400 text-sm font-medium mb-1",children:""}),v.jsx("p",{className:"text-3xl font-black text-ink",children:u})]})]})]})},sz=({onBack:n,t:e,language:t})=>v.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[v.jsxs("div",{className:"bg-paper p-4 pt-9 flex items-center gap-2 sticky top-0 z-10",children:[v.jsx("button",{onClick:n,children:v.jsx(ts,{className:"w-6 h-6 text-gray-500"})}),v.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_translation||"Translation"})]}),v.jsx("div",{className:"flex-1 overflow-y-auto pb-32",children:v.jsx(ZB,{defaultSourceLang:t})})]}),rz=({onBack:n,trips:e,settings:t,onMagicEditor:i,onOpenSettings:r})=>{const[a,u]=W.useState("MENU"),f=on[t.language]||on["zh-TW"];if(a==="EXPENSE")return v.jsx(JB,{onBack:()=>u("MENU")});if(a==="VISA")return v.jsx(YB,{onBack:()=>u("MENU"),t:f,language:t.language,onOpenSettings:r});if(a==="CULTURE")return v.jsx(WB,{onBack:()=>u("MENU"),t:f,language:t.language,onOpenSettings:r});if(a==="RESTROOM")return v.jsx(QB,{onBack:()=>u("MENU"),t:f});if(a==="SCRATCH_MAP")return v.jsx(nz,{onBack:()=>u("MENU"),trips:e,t:f});if(a==="EMERGENCY")return v.jsx($B,{onBack:()=>u("MENU"),t:f,language:t.language,onOpenSettings:r});if(a==="CARD_ADVICE")return v.jsx(XB,{onBack:()=>u("MENU"),t:f,language:t.language,onOpenSettings:r});if(a==="TIME_CAPSULE")return v.jsx("div",{onClick:()=>u("MENU"),children:"Coming Soon"});if(a==="TRANSLATION")return v.jsx(sz,{onBack:()=>u("MENU"),t:f,language:t.language});if(a==="CURRENCY")return v.jsx(iz,{onBack:()=>u("MENU"),t:f});const m=[{id:"MAGIC_EDITOR",name:"",icon:wa,color:"text-pink-500",bg:"bg-pink-50",desc:"AI ",action:i},{id:"CURRENCY",name:"",icon:B2,color:"text-green-500",bg:"bg-green-50",desc:""},{id:"TRANSLATION",name:f.tool_translation,icon:K2,color:"text-purple-500",bg:"bg-purple-50",desc:f.desc_translator},{id:"EMERGENCY",name:f.tool_emergency,icon:H2,color:"text-red-500",bg:"bg-red-50",desc:f.desc_emergency},{id:"CARD_ADVICE",name:f.tool_card,icon:j2,color:"text-indigo-500",bg:"bg-indigo-50",desc:f.desc_card},{id:"SCRATCH_MAP",name:f.tool_map,icon:q2,color:"text-teal-500",bg:"bg-teal-50",desc:f.desc_map},{id:"RESTROOM",name:f.tool_restroom,icon:F2,color:"text-cyan-500",bg:"bg-cyan-50",desc:f.desc_restroom},{id:"VISA",name:f.tool_visa,icon:z2,color:"text-blue-500",bg:"bg-blue-50",desc:f.desc_visa},{id:"CULTURE",name:f.tool_culture,icon:P_,color:"text-orange-500",bg:"bg-orange-50",desc:f.desc_culture}];return v.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[v.jsx("div",{className:"px-5 py-4 pt-9 bg-paper sticky top-0 z-10 flex items-center justify-between border-b border-sand/50",children:v.jsxs("h2",{className:"text-xl font-extrabold text-ink flex items-center gap-2",children:[v.jsx(Ry,{className:"w-6 h-6 text-coral"}),f.tools_title]})}),v.jsx("div",{className:"p-5 grid grid-cols-2 gap-4 pb-32 overflow-y-auto",children:m.map(p=>v.jsxs("div",{onClick:()=>p.action?p.action():u(p.id),className:"bg-white p-5 rounded-3xl shadow-card border border-sand active:scale-95 transition-all cursor-pointer hover:shadow-soft hover:border-coral group",children:[v.jsx("div",{className:`w-12 h-12 ${p.bg} ${p.color} rounded-2xl flex items-center justify-center mb-4 transition-transform group-hover:scale-110`,children:v.jsx(p.icon,{className:"w-6 h-6 stroke-2"})}),v.jsx("h3",{className:"font-bold text-ink mb-1",children:p.name}),v.jsx("p",{className:"text-xs text-gray-400 font-medium",children:p.desc})]},p.id))})]})},oz=({onBack:n,settings:e,onUpdateSettings:t,onResetApp:i,user:r,onLogout:a})=>{const[u,f]=W.useState(!1),[m,p]=W.useState(!1),E=on[e.language]||on["zh-TW"];W.useEffect(()=>{const R=localStorage.getItem("nomad_user_api_key");R&&!e.apiKey&&(t({apiKey:R}),localStorage.removeItem("nomad_user_api_key"))},[]);const S=R=>{t({apiKey:R}),localStorage.setItem("geminiApiKey",R),R&&(p(!0),setTimeout(()=>p(!1),2e3))},A=[{name:"",value:"#FF6B6B"},{name:"",value:"#4ECDC4"},{name:"",value:"#FFE66D"},{name:"",value:"#A06CD5"},{name:"",value:"#6BCB77"}];return v.jsxs("div",{className:"h-full flex flex-col bg-paper animate-slide-in",children:[v.jsxs("div",{className:"px-6 py-6 flex items-center justify-between bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-sand",children:[v.jsx("button",{onClick:n,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 transition-colors",children:v.jsx(ts,{className:"w-6 h-6 text-ink"})}),v.jsx("h1",{className:"text-xl font-bold text-ink",children:""}),v.jsx("div",{className:"w-10"})]}),v.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[r&&v.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[v.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"text-lg font-bold text-ink",children:r.username}),v.jsxs("p",{className:"text-xs text-gray-400",children:["ID: ",r.id]})]}),v.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-xl transition-colors text-sm font-medium",children:[v.jsx(W2,{className:"w-4 h-4"}),""]})]})]}),v.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[v.jsxs("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider flex items-center gap-2",children:[v.jsx(Q2,{className:"w-4 h-4"}),E.api_settings||"API "]}),v.jsxs("div",{className:"space-y-3",children:[v.jsx("label",{className:"text-sm font-bold text-ink",children:E.api_key_label||"Gemini API Key"}),v.jsxs("div",{className:"relative",children:[v.jsx("input",{type:"password",value:e.apiKey||"",onChange:R=>S(R.target.value),placeholder:E.api_key_placeholder||" API Key",className:"w-full p-4 pr-20 bg-gray-50 rounded-xl border border-gray-200 focus:border-coral focus:ring-2 focus:ring-coral/20 outline-none transition-all font-mono text-sm"}),m&&v.jsx("div",{className:"text-right mt-1",children:v.jsx("span",{className:"text-green-500 text-xs font-bold animate-fade-in",children:E.api_key_saved||""})})]}),v.jsxs("p",{className:"text-xs text-gray-400 leading-relaxed",children:[E.api_key_help||" Key ",v.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-coral hover:underline ml-1",children:" Key"})]})]})]}),v.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[v.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),v.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:[A.map(R=>v.jsx("button",{onClick:()=>t({themeColor:R.value}),className:`w-10 h-10 rounded-full flex-shrink-0 transition-transform ${e.themeColor===R.value?"scale-110 ring-2 ring-offset-2 ring-gray-300":"hover:scale-105"}`,style:{backgroundColor:R.value},"aria-label":R.name},R.value)),v.jsx("button",{onClick:()=>t({themeColor:void 0}),className:`w-10 h-10 rounded-full flex-shrink-0 bg-coral flex items-center justify-center text-white text-xs font-bold transition-transform ${e.themeColor?"hover:scale-105":"scale-110 ring-2 ring-offset-2 ring-gray-300"}`,children:""})]})]}),v.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[v.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),v.jsx("div",{className:"space-y-2",children:[{code:"zh-TW",label:""},{code:"en-US",label:"English"},{code:"ja-JP",label:""}].map(R=>v.jsxs("button",{onClick:()=>t({language:R.code}),className:`w-full flex items-center justify-between p-3 rounded-xl transition-colors ${e.language===R.code?"bg-coral/10 text-coral font-bold":"hover:bg-gray-50 text-ink"}`,children:[v.jsx("span",{children:R.label}),e.language===R.code&&v.jsx("div",{className:"w-2 h-2 rounded-full bg-coral"})]},R.code))})]}),v.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[v.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),u?v.jsxs("div",{className:"space-y-3 animate-fade-in",children:[v.jsx("p",{className:"text-center text-sm text-red-500 font-medium",children:""}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold",children:""}),v.jsx("button",{onClick:()=>{i(),f(!1)},className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg shadow-red-500/30",children:""})]})]}):v.jsxs("button",{onClick:()=>f(!0),className:"w-full flex items-center justify-center gap-2 p-4 border-2 border-red-100 text-red-500 rounded-xl hover:bg-red-50 transition-colors font-bold",children:[v.jsx(Ra,{className:"w-5 h-5"}),""]})]}),v.jsxs("div",{className:"text-center text-xs text-gray-400 py-4",children:[v.jsx("p",{children:"NomadAI Travel Journal v1.0.0"}),v.jsx("p",{className:"mt-1",children:"Made with  by NomadAI Team"})]})]})]})},az=({onLogin:n})=>{const[e,t]=W.useState(""),[i,r]=W.useState(!1),a=async()=>{console.log("Attempting Google Login..."),r(!0),t("");try{const u=await n6(Iy,CB);console.log("Google Login Success:",u.user.uid)}catch(u){console.error("Login failed",u),t(u.message||"")}finally{r(!1)}};return v.jsx("div",{className:"h-full flex flex-col items-center justify-center p-6 bg-paper",children:v.jsxs("div",{className:"w-full max-w-sm bg-white rounded-3xl shadow-card p-8 border border-sand text-center",children:[v.jsxs("div",{className:"flex flex-col items-center mb-8",children:[v.jsx("div",{className:"w-16 h-16 bg-coral rounded-2xl flex items-center justify-center mb-4 shadow-lg shadow-coral/30",children:v.jsx(wa,{className:"w-8 h-8 text-white"})}),v.jsx("h1",{className:"text-2xl font-bold text-ink",children:"Ques-trip"}),v.jsx("p",{className:"text-gray-400 text-sm mt-2",children:""})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("button",{id:"google-login-btn",onClick:a,disabled:i,className:"w-full bg-white border border-gray-300 text-gray-700 py-3.5 rounded-xl font-bold shadow-sm hover:bg-gray-50 active:scale-95 transition-all flex items-center justify-center gap-3",children:[i?v.jsx("div",{className:"w-5 h-5 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}):v.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[v.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),v.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),v.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.84z",fill:"#FBBC05"}),v.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]})," Google "]}),e&&v.jsx("div",{className:"text-red-500 text-sm font-medium bg-red-50 p-2 rounded-lg",children:e})]})]})})},lz=({memories:n,onAddMemory:e,onDeleteMemory:t,settings:i})=>{const[r,a]=W.useState(""),[u,f]=W.useState(null),m=W.useRef(null),p=async S=>{var R;const A=(R=S.target.files)==null?void 0:R[0];if(A)try{const{compressImage:V}=await qm(async()=>{const{compressImage:Z}=await import("./image-CYcWJ_KT.js");return{compressImage:Z}},[]),z=await V(A);f(z)}catch(V){console.error("Image compression failed",V),alert("")}},E=S=>{if(S.preventDefault(),!u)return;const A={id:Date.now().toString(),userId:"",imageUrl:u,caption:r,date:new Date().toISOString()};e(A),a(""),f(null),m.current&&(m.current.value="")};return v.jsxs("div",{className:"h-full flex flex-col bg-paper animate-slide-in pb-24",children:[v.jsxs("div",{className:"px-6 py-6 bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-sand pt-safe pt-12",children:[v.jsxs("h1",{className:"text-2xl font-bold text-ink flex items-center gap-2",children:[v.jsx(ic,{className:"w-8 h-8 text-coral"}),""]}),v.jsx("p",{className:"text-sm text-gray-400 mt-1",children:""})]}),v.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[v.jsx("div",{className:"bg-white rounded-3xl p-6 shadow-card border border-sand",children:v.jsxs("form",{onSubmit:E,className:"space-y-4",children:[v.jsxs("div",{onClick:()=>{var S;return(S=m.current)==null?void 0:S.click()},className:`relative w-full aspect-video rounded-2xl border-2 border-dashed border-sand flex flex-col items-center justify-center cursor-pointer transition-all hover:bg-gray-50 ${u?"border-none p-0 overflow-hidden":""}`,children:[u?v.jsx("img",{src:u,alt:"Preview",className:"w-full h-full object-cover"}):v.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[v.jsx(ic,{className:"w-12 h-12 mb-2"}),v.jsx("span",{className:"font-medium",children:""})]}),v.jsx("input",{type:"file",ref:m,onChange:p,accept:"image/*",className:"hidden"})]}),v.jsx("textarea",{value:r,onChange:S=>a(S.target.value),placeholder:"...",className:"w-full bg-paper rounded-xl p-4 text-ink font-medium outline-none focus:ring-2 focus:ring-coral/50 transition-all border border-sand resize-none h-24"}),v.jsxs("button",{type:"submit",disabled:!u,className:`w-full py-3.5 rounded-xl font-bold shadow-lg transition-all flex items-center justify-center gap-2 ${u?"bg-coral text-white shadow-coral/30 active:scale-95":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[v.jsx(Om,{className:"w-5 h-5"}),""]})]})}),v.jsx("div",{className:"grid grid-cols-1 gap-6",children:n.length===0?v.jsxs("div",{className:"text-center py-12 text-gray-400",children:[v.jsx("p",{children:""}),v.jsx("p",{className:"text-sm mt-2",children:""})]}):n.map(S=>v.jsxs("div",{className:"bg-white rounded-3xl overflow-hidden shadow-card border border-sand group",children:[v.jsxs("div",{className:"relative aspect-video",children:[v.jsx("img",{src:S.imageUrl,alt:S.caption,className:"w-full h-full object-cover"}),v.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-end p-4",children:v.jsx("button",{onClick:()=>t(S.id),className:"p-2 bg-white/20 backdrop-blur-md text-white rounded-full hover:bg-red-500 transition-colors",children:v.jsx(Ra,{className:"w-5 h-5"})})})]}),v.jsxs("div",{className:"p-5",children:[v.jsx("p",{className:"text-ink font-medium whitespace-pre-wrap",children:S.caption}),v.jsx("p",{className:"text-xs text-gray-400 mt-3",children:new Date(S.date).toLocaleDateString()})]})]},S.id))})]})]})};function uz(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:i,onRegistered:r,onRegisteredSW:a,onRegisterError:u}=n;let f,m;const p=async(S=!0)=>{await m};async function E(){if("serviceWorker"in navigator){if(f=await qm(async()=>{const{Workbox:S}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:S}},[]).then(({Workbox:S})=>new S("/sw.js",{scope:"/",type:"classic"})).catch(S=>{u==null||u(S)}),!f)return;f.addEventListener("activated",S=>{(S.isUpdate||S.isExternal)&&window.location.reload()}),f.addEventListener("installed",S=>{S.isUpdate||i==null||i()}),f.register({immediate:e}).then(S=>{a?a("/sw.js",S):r==null||r(S)}).catch(S=>{u==null||u(S)})}}return m=E(),p}function cz(n={}){const{immediate:e=!0,onNeedRefresh:t,onOfflineReady:i,onRegistered:r,onRegisteredSW:a,onRegisterError:u}=n,[f,m]=W.useState(!1),[p,E]=W.useState(!1),[S]=W.useState(()=>uz({immediate:e,onOfflineReady(){E(!0),i==null||i()},onNeedRefresh(){m(!0),t==null||t()},onRegistered:r,onRegisteredSW:a,onRegisterError:u}));return{needRefresh:[f,m],offlineReady:[p,E],updateServiceWorker:S}}const dz=({settings:n})=>{n&&on[n.language]||on["zh-TW"];const{offlineReady:[e,t],needRefresh:[i,r],updateServiceWorker:a}=cz({onRegistered(f){console.log("SW Registered: "+f)},onRegisterError(f){console.log("SW registration error",f)}}),u=()=>{t(!1),r(!1)};return!e&&!i?null:v.jsxs("div",{className:"fixed bottom-6 right-6 z-[1000] p-4 bg-ink text-white rounded-xl shadow-2xl animate-slide-up max-w-xs border border-white/10",children:[v.jsx("div",{className:"mb-3 font-bold",children:e?v.jsx("span",{children:"App ready to work offline"}):v.jsx("span",{children:"New content available, click on reload button to update."})}),v.jsxs("div",{className:"flex gap-2",children:[i&&v.jsx("button",{className:"flex-1 px-3 py-2 bg-coral text-white rounded-lg font-bold text-sm hover:bg-coralDark transition-colors",onClick:()=>a(!0),children:"Reload"}),v.jsx("button",{className:"flex-1 px-3 py-2 bg-white/10 text-white rounded-lg font-bold text-sm hover:bg-white/20 transition-colors",onClick:u,children:"Close"})]})]})},hz={USERS:"nomad_app_users_v1",CURRENT_USER:"nomad_app_current_user_v1",getTripsKey:n=>`nomad_app_trips_${n} `,getSettingsKey:n=>`nomad_app_settings_${n} `,getMemoriesKey:n=>`nomad_app_memories_${n} `,getChatSessionsKey:n=>`nomad_app_chat_sessions_${n} `},fz=()=>{console.log("App Component Rendering...");const[n,e]=W.useState({id:"test-user-id",username:"Test User",password:"",createdAt:new Date().toISOString()}),[t,i]=W.useState([]),[r,a]=W.useState([]),[u,f]=W.useState([]),[m,p]=W.useState(null),[E,S]=W.useState({language:"zh-TW",minimalistMode:!1}),[A,R]=W.useState(!0),[V,z]=W.useState(null),[Z,X]=W.useState(st.HOME),[ne,Q]=W.useState(null),[pe,he]=W.useState([]);W.useEffect(()=>{console.log("Setting up Auth Listener...");const le=LV(Iy,ge=>{if(console.log("Auth State Changed:",ge?"User Logged In":"User Logged Out",ge==null?void 0:ge.uid),ge){const Ae={id:ge.uid,username:ge.displayName||"Traveler",email:ge.email||"",password:"",createdAt:ge.metadata.creationTime||new Date().toISOString()};e(Ae),(async()=>{try{const Vt=Yd(fo,"users",ge.uid);await wB(Vt,{uid:ge.uid,email:ge.email,username:ge.displayName||"Traveler",lastSeen:kb()},{merge:!0})}catch(Vt){console.error("Error syncing user:",Vt)}})(),console.log("Listening to trips for user:",ge.uid);const Ue=by(nm(fo,"itineraries"),Ay("userIds","array-contains",ge.uid)),we=by(nm(fo,"itineraries"),Ay("uid","==",ge.uid));Cd(Ue,Vt=>{}),Cd(Ue,Vt=>{const yt=[];Vt.forEach(kt=>{yt.push({id:kt.id,...kt.data()})});const St=Cd(we,kt=>{const Rt=new Map;yt.forEach(Ve=>Rt.set(Ve.id,Ve)),kt.forEach(Ve=>{const Ye=Ve.data(),pt={id:Ve.id,...Ye};pt.userIds||(console.log("Migrating legacy trip:",pt.id),sm(Ve.ref,{userIds:[ge.uid],collaborators:[]}).catch(dt=>console.error("Migration failed",dt))),Rt.set(pt.id,pt)});const ve=Array.from(Rt.values());ve.sort((Ve,Ye)=>{const pt=Ve.createdAt?typeof Ve.createdAt=="string"?new Date(Ve.createdAt).getTime():Ve.createdAt.toMillis?Ve.createdAt.toMillis():0:0;return(Ye.createdAt?typeof Ye.createdAt=="string"?new Date(Ye.createdAt).getTime():Ye.createdAt.toMillis?Ye.createdAt.toMillis():0:0)-pt}),i(ve),R(!0),z(null)});return()=>St()});let et=[],vt=[];const nt=()=>{const Vt=new Map;et.forEach(St=>Vt.set(St.id,St)),vt.forEach(St=>Vt.set(St.id,St));const yt=Array.from(Vt.values());yt.sort((St,kt)=>{const Rt=St.createdAt?typeof St.createdAt=="string"?new Date(St.createdAt).getTime():St.createdAt.toMillis?St.createdAt.toMillis():0:0;return(kt.createdAt?typeof kt.createdAt=="string"?new Date(kt.createdAt).getTime():kt.createdAt.toMillis?kt.createdAt.toMillis():0:0)-Rt}),i(yt),R(!0)},qt=Cd(Ue,Vt=>{et=[],Vt.forEach(yt=>{et.push({id:yt.id,...yt.data()})}),nt()}),_n=Cd(we,Vt=>{vt=[],Vt.forEach(yt=>{const St=yt.data();St.userIds||(console.log("Migrating legacy trip:",yt.id),sm(yt.ref,{userIds:[ge.uid],collaborators:[]}),vt.push({id:yt.id,...St}))}),nt()});return()=>{qt(),_n()}}else e(null),i([]),R(!0)});return()=>le()},[]);const Y=async le=>{if(n)try{const{id:ge,...Ae}=le;await bB(nm(fo,"itineraries"),{...Ae,...Ae,uid:n.id,userIds:[n.id],collaborators:[],createdAt:kb()}),Z===st.AI_PLANNER&&X(st.HOME)}catch(ge){console.error("Error adding trip",ge),z(`Add Trip Error: ${ge.message}`),alert(": "+ge.message)}},D=async le=>{if(!(!n||!le.id))try{const ge=Yd(fo,"itineraries",le.id),{id:Ae,...He}=le;await sm(ge,He),(ne==null?void 0:ne.id)===le.id&&Q(le)}catch(ge){console.error("Error updating trip",ge),alert("")}},B=async le=>{try{await SB(Yd(fo,"itineraries",le)),(ne==null?void 0:ne.id)===le&&(Q(null),X(st.HOME))}catch(ge){console.error("Error deleting trip",ge),alert("")}},O=W.useCallback(async(le,ge)=>{var He;console.log("Starting background generation...",{userPrompt:le,tripId:ge});const Ae=Date.now().toString();he(Ue=>[...Ue,Ae]);try{let Ue,we=null;ge&&(we=t.find(nt=>nt.id===ge)),we?(console.log("Updating existing trip:",we.title),Ue=await w1(we,le,E.language),console.log("Updated Trip Plan:",Ue)):(console.log("Generating new trip..."),Ue=await E1(le,E.language),console.log("New Trip Plan:",Ue));let et=Ue.coverImage||(we==null?void 0:we.coverImage);if(!et)try{const nt=Ue.title||le;et=await By(nt)}catch(nt){console.error("Failed to generate cover image:",nt),et=`https://placehold.co/800x600/e2e8f0/475569?text=${encodeURIComponent(((He=Ue.title)==null?void 0:He.split(" ")[0])||"Travel")}`}!Ue.itinerary||Ue.itinerary.length===0?console.warn("AI returned empty itinerary:",Ue):Ue.itinerary=Ue.itinerary.map(nt=>({...nt,day:Number(nt.day)||1,id:nt.id||Math.random().toString(36).substr(2,9),time:nt.time||"09:00",activity:nt.activity||"New Activity",location:nt.location||"",notes:nt.notes||""}));let vt;return we?(vt={...we,...Ue,id:we.id,coverImage:et},D(vt)):(vt={...Ue,id:Ae,coverImage:et,bookings:[],budget:Ue.budget||{total:0,currency:"TWD",expenses:[]},weather:Ue.weather||[]},Y(vt)),he(nt=>nt.filter(qt=>qt!==Ae)),{title:vt.title,tripId:vt.id}}catch(Ue){return console.error("Background generation failed",Ue),he(we=>we.filter(et=>et!==Ae)),null}},[t,E.language]),G=le=>{S(ge=>({...ge,...le}))},q=()=>{n&&K()},K=async()=>{try{await VV(Iy),X(st.HOME),Q(null)}catch(le){console.error("Logout failed",le)}},F=()=>{},qe=()=>{},Je=le=>{a([le,...r])},ie=le=>{a(r.filter(ge=>ge.id!==le))},be=()=>{const le={id:Date.now().toString(),title:E.language==="zh-TW"?"":"New Chat",messages:[],createdAt:Date.now(),updatedAt:Date.now()};return f(ge=>[le,...ge]),p(le.id),le.id},Se=(le,ge,Ae,He)=>{f(Ue=>Ue.map(we=>{if(we.id===le){let et=we.title;if(Ae)et=Ae;else if(!we.messages.some(nt=>nt.role==="user")){const nt=ge.find(qt=>qt.role==="user");nt&&(et=nt.content.slice(0,20)+(nt.content.length>20?"...":""))}return{...we,messages:ge,title:et,tripId:He||we.tripId,updatedAt:Date.now()}}return we}))},$e=le=>{f(ge=>ge.filter(Ae=>Ae.id!==le)),m===le&&p(null)},Me=le=>{p(le)};if(W.useEffect(()=>{const le=document.getElementById("loading-screen");le?(console.log("Removing loading screen..."),le.style.opacity="0",setTimeout(()=>le.remove(),500)):console.log("Loading screen not found (already removed?)")},[]),W.useEffect(()=>{if(n&&A)try{localStorage.setItem(hz.getSettingsKey(n.id),JSON.stringify(E))}catch(le){console.error("Failed to save settings",le)}E.themeColor?document.documentElement.style.setProperty("--color-coral",E.themeColor):document.documentElement.style.removeProperty("--color-coral")},[E,n,A]),!n)return v.jsx(az,{onLogin:F,onRegister:qe});const j=le=>{const ge=u.find(Ae=>Ae.tripId===le);if(ge)p(ge.id);else{const Ae=be();f(He=>He.map(Ue=>{var we;return Ue.id===Ae?{...Ue,tripId:le,title:`${((we=t.find(et=>et.id===le))==null?void 0:we.title)||"Trip"} Planning`}:Ue}))}X(st.AI_PLANNER)},fe=()=>{switch(Z){case st.HOME:return v.jsx(X2,{trips:t,onSelectTrip:le=>{Q(le),X(st.TRIP_DETAILS)},onAddTrip:()=>X(st.ADD_TRIP),onOpenSettings:()=>X(st.SETTINGS),settings:E});case st.ADD_TRIP:return v.jsx(RL,{onSave:le=>{Y(le),X(st.HOME)},onCancel:()=>X(st.HOME),settings:E});case st.MAGIC_EDITOR:return v.jsx(ML,{settings:E,onBack:()=>X(st.TOOLS)});case st.TRIP_MEMORY:return v.jsx(lz,{memories:r,onAddMemory:Je,onDeleteMemory:ie,settings:E});case st.AI_PLANNER:return v.jsx(MB,{onStartGeneration:O,onCancel:()=>X(st.HOME),settings:E,sessions:u,currentSessionId:m,onCreateSession:be,onUpdateSession:Se,onDeleteSession:$e,onSelectSession:Me});case st.TOOLS:return v.jsx(rz,{onBack:()=>X(st.HOME),trips:t,settings:E,onMagicEditor:()=>X(st.MAGIC_EDITOR),onOpenSettings:()=>X(st.SETTINGS)});case st.TRIP_DETAILS:return ne?v.jsx(RB,{trip:ne,onBack:()=>X(st.HOME),onDelete:B,onUpdateTrip:D,onOpenAI:j,settings:E,user:n}):null;case st.SETTINGS:return v.jsx(oz,{onBack:()=>X(st.HOME),settings:E,onUpdateSettings:G,onResetApp:q,user:n,onLogout:K});default:return null}},Ie=[st.HOME,st.TRIP_MEMORY,st.TOOLS,st.AI_PLANNER].includes(Z);return v.jsxs("div",{className:"h-full w-full max-w-md mx-auto bg-paper shadow-2xl relative overflow-hidden flex flex-col font-sans text-ink",children:[V&&v.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 relative",role:"alert",children:[v.jsx("strong",{className:"font-bold",children:"Error: "}),v.jsx("span",{className:"block sm:inline",children:V}),v.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>z(null),children:v.jsxs("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[v.jsx("title",{children:"Close"}),v.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]}),v.jsx("div",{className:"flex-1 overflow-hidden relative bg-paper",children:fe()}),Ie&&v.jsx("div",{className:"absolute bottom-6 left-4 right-4 z-40",children:v.jsxs("div",{className:"bg-white/90 backdrop-blur-xl border border-white/50 shadow-float rounded-3xl px-2 py-3 flex justify-around items-center",children:[v.jsxs("button",{onClick:()=>X(st.HOME),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Z===st.HOME?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[v.jsx(L2,{className:`w-6 h-6 ${Z===st.HOME?"stroke-2":"stroke-[1.5]"}`}),Z===st.HOME&&v.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),v.jsxs("button",{onClick:()=>X(st.AI_PLANNER),className:`relative flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Z===st.AI_PLANNER?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[v.jsxs("div",{className:"relative",children:[v.jsx(Gb,{className:`w-6 h-6 ${Z===st.AI_PLANNER?"stroke-2":"stroke-[1.5]"}`}),(pe==null?void 0:pe.length)>0&&v.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-coral rounded-full animate-ping"}),(pe==null?void 0:pe.length)>0&&v.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-coral rounded-full border-2 border-white"})]}),Z===st.AI_PLANNER&&v.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),v.jsxs("button",{onClick:()=>X(st.TRIP_MEMORY),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Z===st.TRIP_MEMORY?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[v.jsx(ic,{className:`w-6 h-6 ${Z===st.TRIP_MEMORY?"stroke-2":"stroke-[1.5]"}`}),Z===st.TRIP_MEMORY&&v.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),v.jsxs("button",{onClick:()=>X(st.TOOLS),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Z===st.TOOLS?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[v.jsx(Ry,{className:`w-6 h-6 ${Z===st.TOOLS?"stroke-2":"stroke-[1.5]"}`}),Z===st.TOOLS&&v.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]})]})}),v.jsx(dz,{settings:E})]})};console.log("NomadAI App Starting...");const lN=document.getElementById("root");if(!lN)throw new Error("Could not find root element to mount to");const mz=k2.createRoot(lN);try{mz.render(v.jsx(Wd.StrictMode,{children:v.jsx(fz,{})})),setTimeout(()=>{const n=document.getElementById("loading-screen");n&&(console.warn("Force removing loader after timeout"),n.style.opacity="0",setTimeout(()=>n.remove(),500))},3e3)}catch(n){console.error("React Render Error:",n)}
