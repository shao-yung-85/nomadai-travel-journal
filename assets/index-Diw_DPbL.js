(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const u of r)if(u.type==="childList")for(const c of u.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const u={};return r.integrity&&(u.integrity=r.integrity),r.referrerPolicy&&(u.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?u.credentials="include":r.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(r){if(r.ep)return;r.ep=!0;const u=t(r);fetch(r.href,u)}})();function hg(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var lp={exports:{}},gc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y0;function _C(){if(y0)return gc;y0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,u){var c=null;if(u!==void 0&&(c=""+u),r.key!==void 0&&(c=""+r.key),"key"in r){u={};for(var m in r)m!=="key"&&(u[m]=r[m])}else u=r;return r=u.ref,{$$typeof:n,type:i,key:c,ref:r!==void 0?r:null,props:u}}return gc.Fragment=e,gc.jsx=t,gc.jsxs=t,gc}var v0;function yC(){return v0||(v0=1,lp.exports=_C()),lp.exports}var E=yC(),up={exports:{}},tt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T0;function vC(){if(T0)return tt;T0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),c=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),b=Symbol.iterator;function M(j){return j===null||typeof j!="object"?null:(j=b&&j[b]||j["@@iterator"],typeof j=="function"?j:null)}var K={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G=Object.assign,z={};function W(j,he,Ce){this.props=j,this.context=he,this.refs=z,this.updater=Ce||K}W.prototype.isReactComponent={},W.prototype.setState=function(j,he){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,he,"setState")},W.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function te(){}te.prototype=W.prototype;function Q(j,he,Ce){this.props=j,this.context=he,this.refs=z,this.updater=Ce||K}var me=Q.prototype=new te;me.constructor=Q,G(me,W.prototype),me.isPureReactComponent=!0;var de=Array.isArray;function fe(){}var V={H:null,A:null,T:null,S:null},O=Object.prototype.hasOwnProperty;function U(j,he,Ce){var ue=Ce.ref;return{$$typeof:n,type:j,key:he,ref:ue!==void 0?ue:null,props:Ce}}function H(j,he){return U(j.type,he,j.props)}function F(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function Y(j){var he={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(Ce){return he[Ce]})}var B=/\/+/g;function Ke(j,he){return typeof j=="object"&&j!==null&&j.key!=null?Y(""+j.key):he.toString(36)}function mt(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(fe,fe):(j.status="pending",j.then(function(he){j.status==="pending"&&(j.status="fulfilled",j.value=he)},function(he){j.status==="pending"&&(j.status="rejected",j.reason=he)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function oe(j,he,Ce,ue,ge){var Se=typeof j;(Se==="undefined"||Se==="boolean")&&(j=null);var be=!1;if(j===null)be=!0;else switch(Se){case"bigint":case"string":case"number":be=!0;break;case"object":switch(j.$$typeof){case n:case e:be=!0;break;case x:return be=j._init,oe(be(j._payload),he,Ce,ue,ge)}}if(be)return ge=ge(j),be=ue===""?"."+Ke(j,0):ue,de(ge)?(Ce="",be!=null&&(Ce=be.replace(B,"$&/")+"/"),oe(ge,he,Ce,"",function(it){return it})):ge!=null&&(F(ge)&&(ge=H(ge,Ce+(ge.key==null||j&&j.key===ge.key?"":(""+ge.key).replace(B,"$&/")+"/")+be)),he.push(ge)),1;be=0;var Me=ue===""?".":ue+":";if(de(j))for(var ke=0;ke<j.length;ke++)ue=j[ke],Se=Me+Ke(ue,ke),be+=oe(ue,he,Ce,Se,ge);else if(ke=M(j),typeof ke=="function")for(j=ke.call(j),ke=0;!(ue=j.next()).done;)ue=ue.value,Se=Me+Ke(ue,ke++),be+=oe(ue,he,Ce,Se,ge);else if(Se==="object"){if(typeof j.then=="function")return oe(mt(j),he,Ce,ue,ge);throw he=String(j),Error("Objects are not valid as a React child (found: "+(he==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":he)+"). If you meant to render a collection of children, use an array instead.")}return be}function Ae(j,he,Ce){if(j==null)return j;var ue=[],ge=0;return oe(j,ue,"","",function(Se){return he.call(Ce,Se,ge++)}),ue}function we(j){if(j._status===-1){var he=j._result;he=he(),he.then(function(Ce){(j._status===0||j._status===-1)&&(j._status=1,j._result=Ce)},function(Ce){(j._status===0||j._status===-1)&&(j._status=2,j._result=Ce)}),j._status===-1&&(j._status=0,j._result=he)}if(j._status===1)return j._result.default;throw j._result}var Qe=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var he=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(he))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)},Ne={map:Ae,forEach:function(j,he,Ce){Ae(j,function(){he.apply(this,arguments)},Ce)},count:function(j){var he=0;return Ae(j,function(){he++}),he},toArray:function(j){return Ae(j,function(he){return he})||[]},only:function(j){if(!F(j))throw Error("React.Children.only expected to receive a single React element child.");return j}};return tt.Activity=A,tt.Children=Ne,tt.Component=W,tt.Fragment=t,tt.Profiler=r,tt.PureComponent=Q,tt.StrictMode=i,tt.Suspense=g,tt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=V,tt.__COMPILER_RUNTIME={__proto__:null,c:function(j){return V.H.useMemoCache(j)}},tt.cache=function(j){return function(){return j.apply(null,arguments)}},tt.cacheSignal=function(){return null},tt.cloneElement=function(j,he,Ce){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var ue=G({},j.props),ge=j.key;if(he!=null)for(Se in he.key!==void 0&&(ge=""+he.key),he)!O.call(he,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&he.ref===void 0||(ue[Se]=he[Se]);var Se=arguments.length-2;if(Se===1)ue.children=Ce;else if(1<Se){for(var be=Array(Se),Me=0;Me<Se;Me++)be[Me]=arguments[Me+2];ue.children=be}return U(j.type,ge,ue)},tt.createContext=function(j){return j={$$typeof:c,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:u,_context:j},j},tt.createElement=function(j,he,Ce){var ue,ge={},Se=null;if(he!=null)for(ue in he.key!==void 0&&(Se=""+he.key),he)O.call(he,ue)&&ue!=="key"&&ue!=="__self"&&ue!=="__source"&&(ge[ue]=he[ue]);var be=arguments.length-2;if(be===1)ge.children=Ce;else if(1<be){for(var Me=Array(be),ke=0;ke<be;ke++)Me[ke]=arguments[ke+2];ge.children=Me}if(j&&j.defaultProps)for(ue in be=j.defaultProps,be)ge[ue]===void 0&&(ge[ue]=be[ue]);return U(j,Se,ge)},tt.createRef=function(){return{current:null}},tt.forwardRef=function(j){return{$$typeof:m,render:j}},tt.isValidElement=F,tt.lazy=function(j){return{$$typeof:x,_payload:{_status:-1,_result:j},_init:we}},tt.memo=function(j,he){return{$$typeof:p,type:j,compare:he===void 0?null:he}},tt.startTransition=function(j){var he=V.T,Ce={};V.T=Ce;try{var ue=j(),ge=V.S;ge!==null&&ge(Ce,ue),typeof ue=="object"&&ue!==null&&typeof ue.then=="function"&&ue.then(fe,Qe)}catch(Se){Qe(Se)}finally{he!==null&&Ce.types!==null&&(he.types=Ce.types),V.T=he}},tt.unstable_useCacheRefresh=function(){return V.H.useCacheRefresh()},tt.use=function(j){return V.H.use(j)},tt.useActionState=function(j,he,Ce){return V.H.useActionState(j,he,Ce)},tt.useCallback=function(j,he){return V.H.useCallback(j,he)},tt.useContext=function(j){return V.H.useContext(j)},tt.useDebugValue=function(){},tt.useDeferredValue=function(j,he){return V.H.useDeferredValue(j,he)},tt.useEffect=function(j,he){return V.H.useEffect(j,he)},tt.useEffectEvent=function(j){return V.H.useEffectEvent(j)},tt.useId=function(){return V.H.useId()},tt.useImperativeHandle=function(j,he,Ce){return V.H.useImperativeHandle(j,he,Ce)},tt.useInsertionEffect=function(j,he){return V.H.useInsertionEffect(j,he)},tt.useLayoutEffect=function(j,he){return V.H.useLayoutEffect(j,he)},tt.useMemo=function(j,he){return V.H.useMemo(j,he)},tt.useOptimistic=function(j,he){return V.H.useOptimistic(j,he)},tt.useReducer=function(j,he,Ce){return V.H.useReducer(j,he,Ce)},tt.useRef=function(j){return V.H.useRef(j)},tt.useState=function(j){return V.H.useState(j)},tt.useSyncExternalStore=function(j,he,Ce){return V.H.useSyncExternalStore(j,he,Ce)},tt.useTransition=function(){return V.H.useTransition()},tt.version="19.2.0",tt}var E0;function fg(){return E0||(E0=1,up.exports=vC()),up.exports}var X=fg();const Sh=hg(X);var cp={exports:{}},_c={},dp={exports:{}},hp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x0;function TC(){return x0||(x0=1,(function(n){function e(oe,Ae){var we=oe.length;oe.push(Ae);e:for(;0<we;){var Qe=we-1>>>1,Ne=oe[Qe];if(0<r(Ne,Ae))oe[Qe]=Ae,oe[we]=Ne,we=Qe;else break e}}function t(oe){return oe.length===0?null:oe[0]}function i(oe){if(oe.length===0)return null;var Ae=oe[0],we=oe.pop();if(we!==Ae){oe[0]=we;e:for(var Qe=0,Ne=oe.length,j=Ne>>>1;Qe<j;){var he=2*(Qe+1)-1,Ce=oe[he],ue=he+1,ge=oe[ue];if(0>r(Ce,we))ue<Ne&&0>r(ge,Ce)?(oe[Qe]=ge,oe[ue]=we,Qe=ue):(oe[Qe]=Ce,oe[he]=we,Qe=he);else if(ue<Ne&&0>r(ge,we))oe[Qe]=ge,oe[ue]=we,Qe=ue;else break e}}return Ae}function r(oe,Ae){var we=oe.sortIndex-Ae.sortIndex;return we!==0?we:oe.id-Ae.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var c=Date,m=c.now();n.unstable_now=function(){return c.now()-m}}var g=[],p=[],x=1,A=null,b=3,M=!1,K=!1,G=!1,z=!1,W=typeof setTimeout=="function"?setTimeout:null,te=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;function me(oe){for(var Ae=t(p);Ae!==null;){if(Ae.callback===null)i(p);else if(Ae.startTime<=oe)i(p),Ae.sortIndex=Ae.expirationTime,e(g,Ae);else break;Ae=t(p)}}function de(oe){if(G=!1,me(oe),!K)if(t(g)!==null)K=!0,fe||(fe=!0,Y());else{var Ae=t(p);Ae!==null&&mt(de,Ae.startTime-oe)}}var fe=!1,V=-1,O=5,U=-1;function H(){return z?!0:!(n.unstable_now()-U<O)}function F(){if(z=!1,fe){var oe=n.unstable_now();U=oe;var Ae=!0;try{e:{K=!1,G&&(G=!1,te(V),V=-1),M=!0;var we=b;try{t:{for(me(oe),A=t(g);A!==null&&!(A.expirationTime>oe&&H());){var Qe=A.callback;if(typeof Qe=="function"){A.callback=null,b=A.priorityLevel;var Ne=Qe(A.expirationTime<=oe);if(oe=n.unstable_now(),typeof Ne=="function"){A.callback=Ne,me(oe),Ae=!0;break t}A===t(g)&&i(g),me(oe)}else i(g);A=t(g)}if(A!==null)Ae=!0;else{var j=t(p);j!==null&&mt(de,j.startTime-oe),Ae=!1}}break e}finally{A=null,b=we,M=!1}Ae=void 0}}finally{Ae?Y():fe=!1}}}var Y;if(typeof Q=="function")Y=function(){Q(F)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,Ke=B.port2;B.port1.onmessage=F,Y=function(){Ke.postMessage(null)}}else Y=function(){W(F,0)};function mt(oe,Ae){V=W(function(){oe(n.unstable_now())},Ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(oe){oe.callback=null},n.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<oe?Math.floor(1e3/oe):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_next=function(oe){switch(b){case 1:case 2:case 3:var Ae=3;break;default:Ae=b}var we=b;b=Ae;try{return oe()}finally{b=we}},n.unstable_requestPaint=function(){z=!0},n.unstable_runWithPriority=function(oe,Ae){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var we=b;b=oe;try{return Ae()}finally{b=we}},n.unstable_scheduleCallback=function(oe,Ae,we){var Qe=n.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?Qe+we:Qe):we=Qe,oe){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=we+Ne,oe={id:x++,callback:Ae,priorityLevel:oe,startTime:we,expirationTime:Ne,sortIndex:-1},we>Qe?(oe.sortIndex=we,e(p,oe),t(g)===null&&oe===t(p)&&(G?(te(V),V=-1):G=!0,mt(de,we-Qe))):(oe.sortIndex=Ne,e(g,oe),K||M||(K=!0,fe||(fe=!0,Y()))),oe},n.unstable_shouldYield=H,n.unstable_wrapCallback=function(oe){var Ae=b;return function(){var we=b;b=Ae;try{return oe.apply(this,arguments)}finally{b=we}}}})(hp)),hp}var w0;function EC(){return w0||(w0=1,dp.exports=TC()),dp.exports}var fp={exports:{}},ni={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S0;function xC(){if(S0)return ni;S0=1;var n=fg();function e(g){var p="https://react.dev/errors/"+g;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)p+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function u(g,p,x){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:A==null?null:""+A,children:g,containerInfo:p,implementation:x}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(g,p){if(g==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return ni.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ni.createPortal=function(g,p){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return u(g,p,null,x)},ni.flushSync=function(g){var p=c.T,x=i.p;try{if(c.T=null,i.p=2,g)return g()}finally{c.T=p,i.p=x,i.d.f()}},ni.preconnect=function(g,p){typeof g=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(g,p))},ni.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ni.preinit=function(g,p){if(typeof g=="string"&&p&&typeof p.as=="string"){var x=p.as,A=m(x,p.crossOrigin),b=typeof p.integrity=="string"?p.integrity:void 0,M=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;x==="style"?i.d.S(g,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:A,integrity:b,fetchPriority:M}):x==="script"&&i.d.X(g,{crossOrigin:A,integrity:b,fetchPriority:M,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},ni.preinitModule=function(g,p){if(typeof g=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var x=m(p.as,p.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(g)},ni.preload=function(g,p){if(typeof g=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var x=p.as,A=m(x,p.crossOrigin);i.d.L(g,x,{crossOrigin:A,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},ni.preloadModule=function(g,p){if(typeof g=="string")if(p){var x=m(p.as,p.crossOrigin);i.d.m(g,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(g)},ni.requestFormReset=function(g){i.d.r(g)},ni.unstable_batchedUpdates=function(g,p){return g(p)},ni.useFormState=function(g,p,x){return c.H.useFormState(g,p,x)},ni.useFormStatus=function(){return c.H.useHostTransitionStatus()},ni.version="19.2.0",ni}var A0;function Vx(){if(A0)return fp.exports;A0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),fp.exports=xC(),fp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C0;function wC(){if(C0)return _c;C0=1;var n=EC(),e=fg(),t=Vx();function i(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var o=s,l=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(l=o.return),s=o.return;while(s)}return o.tag===3?l:null}function c(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function m(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function p(s){var o=s.alternate;if(!o){if(o=u(s),o===null)throw Error(i(188));return o!==s?null:s}for(var l=s,h=o;;){var T=l.return;if(T===null)break;var w=T.alternate;if(w===null){if(h=T.return,h!==null){l=h;continue}break}if(T.child===w.child){for(w=T.child;w;){if(w===l)return g(T),s;if(w===h)return g(T),o;w=w.sibling}throw Error(i(188))}if(l.return!==h.return)l=T,h=w;else{for(var N=!1,D=T.child;D;){if(D===l){N=!0,l=T,h=w;break}if(D===h){N=!0,h=T,l=w;break}D=D.sibling}if(!N){for(D=w.child;D;){if(D===l){N=!0,l=w,h=T;break}if(D===h){N=!0,h=w,l=T;break}D=D.sibling}if(!N)throw Error(i(189))}}if(l.alternate!==h)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:o}function x(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=x(s),o!==null)return o;s=s.sibling}return null}var A=Object.assign,b=Symbol.for("react.element"),M=Symbol.for("react.transitional.element"),K=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),te=Symbol.for("react.consumer"),Q=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),de=Symbol.for("react.suspense"),fe=Symbol.for("react.suspense_list"),V=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function Y(s){return s===null||typeof s!="object"?null:(s=F&&s[F]||s["@@iterator"],typeof s=="function"?s:null)}var B=Symbol.for("react.client.reference");function Ke(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===B?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case G:return"Fragment";case W:return"Profiler";case z:return"StrictMode";case de:return"Suspense";case fe:return"SuspenseList";case U:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case K:return"Portal";case Q:return s.displayName||"Context";case te:return(s._context.displayName||"Context")+".Consumer";case me:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case V:return o=s.displayName||null,o!==null?o:Ke(s.type)||"Memo";case O:o=s._payload,s=s._init;try{return Ke(s(o))}catch{}}return null}var mt=Array.isArray,oe=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,we={pending:!1,data:null,method:null,action:null},Qe=[],Ne=-1;function j(s){return{current:s}}function he(s){0>Ne||(s.current=Qe[Ne],Qe[Ne]=null,Ne--)}function Ce(s,o){Ne++,Qe[Ne]=s.current,s.current=o}var ue=j(null),ge=j(null),Se=j(null),be=j(null);function Me(s,o){switch(Ce(Se,o),Ce(ge,s),Ce(ue,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?Fv(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=Fv(o),s=qv(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}he(ue),Ce(ue,s)}function ke(){he(ue),he(ge),he(Se)}function it(s){s.memoizedState!==null&&Ce(be,s);var o=ue.current,l=qv(o,s.type);o!==l&&(Ce(ge,s),Ce(ue,l))}function ut(s){ge.current===s&&(he(ue),he(ge)),be.current===s&&(he(be),hc._currentValue=we)}var je,Ft;function gn(s){if(je===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);je=o&&o[1]||"",Ft=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+je+s+Ft}var Vi=!1;function In(s,o){if(!s||Vi)return"";Vi=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(ce){var ae=ce}Reflect.construct(s,[],ve)}else{try{ve.call()}catch(ce){ae=ce}s.call(ve.prototype)}}else{try{throw Error()}catch(ce){ae=ce}(ve=s())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(ce){if(ce&&ae&&typeof ce.stack=="string")return[ce.stack,ae.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var T=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");T&&T.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=h.DetermineComponentFrameRoot(),N=w[0],D=w[1];if(N&&D){var Z=N.split(`
`),se=D.split(`
`);for(T=h=0;h<Z.length&&!Z[h].includes("DetermineComponentFrameRoot");)h++;for(;T<se.length&&!se[T].includes("DetermineComponentFrameRoot");)T++;if(h===Z.length||T===se.length)for(h=Z.length-1,T=se.length-1;1<=h&&0<=T&&Z[h]!==se[T];)T--;for(;1<=h&&0<=T;h--,T--)if(Z[h]!==se[T]){if(h!==1||T!==1)do if(h--,T--,0>T||Z[h]!==se[T]){var pe=`
`+Z[h].replace(" at new "," at ");return s.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",s.displayName)),pe}while(1<=h&&0<=T);break}}}finally{Vi=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?gn(l):""}function As(s,o){switch(s.tag){case 26:case 27:case 5:return gn(s.type);case 16:return gn("Lazy");case 13:return s.child!==o&&o!==null?gn("Suspense Fallback"):gn("Suspense");case 19:return gn("SuspenseList");case 0:case 15:return In(s.type,!1);case 11:return In(s.type.render,!1);case 1:return In(s.type,!0);case 31:return gn("Activity");default:return""}}function Nn(s){try{var o="",l=null;do o+=As(s,l),l=s,s=s.return;while(s);return o}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Kt=Object.prototype.hasOwnProperty,Te=n.unstable_scheduleCallback,Fe=n.unstable_cancelCallback,Xe=n.unstable_shouldYield,Ot=n.unstable_requestPaint,pt=n.unstable_now,_n=n.unstable_getCurrentPriorityLevel,is=n.unstable_ImmediatePriority,Ks=n.unstable_UserBlockingPriority,Rn=n.unstable_NormalPriority,Co=n.unstable_LowPriority,ma=n.unstable_IdlePriority,pa=n.log,dl=n.unstable_setDisableYieldValue,gi=null,hn=null;function ui(s){if(typeof pa=="function"&&dl(s),hn&&typeof hn.setStrictMode=="function")try{hn.setStrictMode(gi,s)}catch{}}var tn=Math.clz32?Math.clz32:hl,Ys=Math.log,ur=Math.LN2;function hl(s){return s>>>=0,s===0?32:31-(Ys(s)/ur|0)|0}var Oi=256,Js=262144,nn=4194304;function ss(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function os(s,o,l){var h=s.pendingLanes;if(h===0)return 0;var T=0,w=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var D=h&134217727;return D!==0?(h=D&~w,h!==0?T=ss(h):(N&=D,N!==0?T=ss(N):l||(l=D&~s,l!==0&&(T=ss(l))))):(D=h&~w,D!==0?T=ss(D):N!==0?T=ss(N):l||(l=h&~s,l!==0&&(T=ss(l)))),T===0?0:o!==0&&o!==T&&(o&w)===0&&(w=T&-T,l=o&-o,w>=l||w===32&&(l&4194048)!==0)?o:T}function Ui(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Pu(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fl(){var s=nn;return nn<<=1,(nn&62914560)===0&&(nn=4194304),s}function rs(s){for(var o=[],l=0;31>l;l++)o.push(s);return o}function Cs(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Du(s,o,l,h,T,w){var N=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var D=s.entanglements,Z=s.expirationTimes,se=s.hiddenUpdates;for(l=N&~l;0<l;){var pe=31-tn(l),ve=1<<pe;D[pe]=0,Z[pe]=-1;var ae=se[pe];if(ae!==null)for(se[pe]=null,pe=0;pe<ae.length;pe++){var ce=ae[pe];ce!==null&&(ce.lane&=-536870913)}l&=~ve}h!==0&&bo(s,h,0),w!==0&&T===0&&s.tag!==0&&(s.suspendedLanes|=w&~(N&~o))}function bo(s,o,l){s.pendingLanes|=o,s.suspendedLanes&=~o;var h=31-tn(o);s.entangledLanes|=o,s.entanglements[h]=s.entanglements[h]|1073741824|l&261930}function ga(s,o){var l=s.entangledLanes|=o;for(s=s.entanglements;l;){var h=31-tn(l),T=1<<h;T&o|s[h]&o&&(s[h]|=o),l&=~T}}function _a(s,o){var l=o&-o;return l=(l&42)!==0?1:kn(l),(l&(s.suspendedLanes|o))!==0?0:l}function kn(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Oe(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function ya(){var s=Ae.p;return s!==0?s:(s=window.event,s===void 0?32:d0(s.type))}function _i(s,o){var l=Ae.p;try{return Ae.p=s,o()}finally{Ae.p=l}}var yi=Math.random().toString(36).slice(2),sn="__reactFiber$"+yi,an="__reactProps$"+yi,zi="__reactContainer$"+yi,Bi="__reactEvents$"+yi,ml="__reactListeners$"+yi,pl="__reactHandles$"+yi,gl="__reactResources$"+yi,as="__reactMarker$"+yi;function cr(s){delete s[sn],delete s[an],delete s[Bi],delete s[ml],delete s[pl]}function Fi(s){var o=s[sn];if(o)return o;for(var l=s.parentNode;l;){if(o=l[zi]||l[sn]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(s=Jv(s);s!==null;){if(l=s[sn])return l;s=Jv(s)}return o}s=l,l=s.parentNode}return null}function vi(s){if(s=s[sn]||s[zi]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function Ln(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(i(33))}function ls(s){var o=s[gl];return o||(o=s[gl]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function ln(s){s[as]=!0}var va=new Set,Ta={};function us(s,o){Ti(s,o),Ti(s+"Capture",o)}function Ti(s,o){for(Ta[s]=o,s=0;s<o.length;s++)va.add(o[s])}var bs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),dr={},hr={};function Ws(s){return Kt.call(hr,s)?!0:Kt.call(dr,s)?!1:bs.test(s)?hr[s]=!0:(dr[s]=!0,!1)}function lt(s,o,l){if(Ws(o))if(l===null)s.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+l)}}function ct(s,o,l){if(l===null)s.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+l)}}function Yt(s,o,l,h){if(h===null)s.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(o,l,""+h)}}function Jt(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ci(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Io(s,o,l){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var T=h.get,w=h.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return T.call(this)},set:function(N){l=""+N,w.call(this,N)}}),Object.defineProperty(s,o,{enumerable:h.enumerable}),{getValue:function(){return l},setValue:function(N){l=""+N},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function De(s){if(!s._valueTracker){var o=ci(s)?"checked":"value";s._valueTracker=Io(s,o,""+s[o])}}function Dt(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var l=o.getValue(),h="";return s&&(h=ci(s)?s.checked?"true":"false":s.value),s=h,s!==l?(o.setValue(s),!0):!1}function Ei(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var cs=/[\n"\\]/g;function qt(s){return s.replace(cs,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function fr(s,o,l,h,T,w,N,D){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),o!=null?N==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+Jt(o)):s.value!==""+Jt(o)&&(s.value=""+Jt(o)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),o!=null?qi(s,N,Jt(o)):l!=null?qi(s,N,Jt(l)):h!=null&&s.removeAttribute("value"),T==null&&w!=null&&(s.defaultChecked=!!w),T!=null&&(s.checked=T&&typeof T!="function"&&typeof T!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.name=""+Jt(D):s.removeAttribute("name")}function No(s,o,l,h,T,w,N,D){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.type=w),o!=null||l!=null){if(!(w!=="submit"&&w!=="reset"||o!=null)){De(s);return}l=l!=null?""+Jt(l):"",o=o!=null?""+Jt(o):l,D||o===s.value||(s.value=o),s.defaultValue=o}h=h??T,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=D?s.checked:!!h,s.defaultChecked=!!h,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),De(s)}function qi(s,o,l){o==="number"&&Ei(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function kt(s,o,l,h){if(s=s.options,o){o={};for(var T=0;T<l.length;T++)o["$"+l[T]]=!0;for(l=0;l<s.length;l++)T=o.hasOwnProperty("$"+s[l].value),s[l].selected!==T&&(s[l].selected=T),T&&h&&(s[l].defaultSelected=!0)}else{for(l=""+Jt(l),o=null,T=0;T<s.length;T++){if(s[T].value===l){s[T].selected=!0,h&&(s[T].defaultSelected=!0);return}o!==null||s[T].disabled||(o=s[T])}o!==null&&(o.selected=!0)}}function ds(s,o,l){if(o!=null&&(o=""+Jt(o),o!==s.value&&(s.value=o),l==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=l!=null?""+Jt(l):""}function xi(s,o,l,h){if(o==null){if(h!=null){if(l!=null)throw Error(i(92));if(mt(h)){if(1<h.length)throw Error(i(93));h=h[0]}l=h}l==null&&(l=""),o=l}l=Jt(o),s.defaultValue=l,h=s.textContent,h===l&&h!==""&&h!==null&&(s.value=h),De(s)}function yn(s,o){if(o){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=o;return}}s.textContent=o}var mr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Is(s,o,l){var h=o.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?h?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":h?s.setProperty(o,l):typeof l!="number"||l===0||mr.has(o)?o==="float"?s.cssFloat=l:s[o]=(""+l).trim():s[o]=l+"px"}function Ro(s,o,l){if(o!=null&&typeof o!="object")throw Error(i(62));if(s=s.style,l!=null){for(var h in l)!l.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var T in o)h=o[T],o.hasOwnProperty(T)&&l[T]!==h&&Is(s,T,h)}else for(var w in o)o.hasOwnProperty(w)&&Is(s,w,o[w])}function Qs(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xs(s){return hs.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Wn(){}var pr=null;function Qn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var $s=null,Ge=null;function Vn(s){var o=vi(s);if(o&&(s=o.stateNode)){var l=s[an]||null;e:switch(s=o.stateNode,o.type){case"input":if(fr(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),o=l.name,l.type==="radio"&&o!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+qt(""+o)+'"][type="radio"]'),o=0;o<l.length;o++){var h=l[o];if(h!==s&&h.form===s.form){var T=h[an]||null;if(!T)throw Error(i(90));fr(h,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name)}}for(o=0;o<l.length;o++)h=l[o],h.form===s.form&&Dt(h)}break e;case"textarea":ds(s,l.value,l.defaultValue);break e;case"select":o=l.value,o!=null&&kt(s,!!l.multiple,o,!1)}}}var At=!1;function Ns(s,o,l){if(At)return s(o,l);At=!0;try{var h=s(o);return h}finally{if(At=!1,($s!==null||Ge!==null)&&(Vd(),$s&&(o=$s,s=Ge,Ge=$s=null,Vn(o),s)))for(o=0;o<s.length;o++)Vn(s[o])}}function di(s,o){var l=s.stateNode;if(l===null)return null;var h=l[an]||null;if(h===null)return null;l=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,o,typeof l));return l}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rs=!1;if(Xn)try{var gt={};Object.defineProperty(gt,"passive",{get:function(){Rs=!0}}),window.addEventListener("test",gt,gt),window.removeEventListener("test",gt,gt)}catch{Rs=!1}var wi=null,Ms=null,Wt=null;function Hi(){if(Wt)return Wt;var s,o=Ms,l=o.length,h,T="value"in wi?wi.value:wi.textContent,w=T.length;for(s=0;s<l&&o[s]===T[s];s++);var N=l-s;for(h=1;h<=N&&o[l-h]===T[w-h];h++);return Wt=T.slice(s,1<h?1-h:void 0)}function eo(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function fs(){return!0}function Gi(){return!1}function vn(s){function o(l,h,T,w,N){this._reactName=l,this._targetInst=T,this.type=h,this.nativeEvent=w,this.target=N,this.currentTarget=null;for(var D in s)s.hasOwnProperty(D)&&(l=s[D],this[D]=l?l(w):w[D]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?fs:Gi,this.isPropagationStopped=Gi,this}return A(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=fs)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=fs)},persist:function(){},isPersistent:fs}),o}var ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ms=vn(ji),Ps=A({},ji,{view:0,detail:0}),at=vn(Ps),to,On,$n,Po=A({},Ps,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:no,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==$n&&($n&&s.type==="mousemove"?(to=s.screenX-$n.screenX,On=s.screenY-$n.screenY):On=to=0,$n=s),to)},movementY:function(s){return"movementY"in s?s.movementY:On}}),Ea=vn(Po),Ds=A({},Po,{dataTransfer:0}),_l=vn(Ds),xa=A({},Ps,{relatedTarget:0}),Do=vn(xa),wa=A({},ji,{animationName:0,elapsedTime:0,pseudoElement:0}),gr=vn(wa),_r=A({},ji,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),hi=vn(_r),yl=A({},ji,{data:0}),Zi=vn(yl),Ki={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Aa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yr(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=Aa[s])?!!o[s]:!1}function no(){return yr}var Un=A({},Ps,{key:function(s){if(s.key){var o=Ki[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=eo(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Sa[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:no,charCode:function(s){return s.type==="keypress"?eo(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?eo(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ca=vn(Un),vl=A({},Po,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ks=vn(vl),y=A({},Ps,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:no}),C=vn(y),R=A({},ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),k=vn(R),ne=A({},Po,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),le=vn(ne),Ie=A({},ji,{newState:0,oldState:0}),Je=vn(Ie),xt=[9,13,27,32],wt=Xn&&"CompositionEvent"in window,Ht=null;Xn&&"documentMode"in document&&(Ht=document.documentMode);var Si=Xn&&"TextEvent"in window&&!Ht,Ai=Xn&&(!wt||Ht&&8<Ht&&11>=Ht),fi=" ",Yi=!1;function ko(s,o){switch(s){case"keyup":return xt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lo(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var vr=!1;function Ji(s,o){switch(s){case"compositionend":return Lo(o);case"keypress":return o.which!==32?null:(Yi=!0,fi);case"textInput":return s=o.data,s===fi&&Yi?null:s;default:return null}}function Tr(s,o){if(vr)return s==="compositionend"||!wt&&ko(s,o)?(s=Hi(),Wt=Ms=wi=null,vr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Ai&&o.locale!=="ko"?null:o.data;default:return null}}var Cf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ps(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!Cf[s.type]:o==="textarea"}function $c(s,o,l,h){$s?Ge?Ge.push(h):Ge=[h]:$s=h,o=Hd(o,"onChange"),0<o.length&&(l=new ms("onChange","change",null,l,h),s.push({event:l,listeners:o}))}var gs=null,ba=null;function Ia(s){Lv(s,0)}function Na(s){var o=Ln(s);if(Dt(o))return s}function Ra(s,o){if(s==="change")return o}var ed=!1;if(Xn){var _s;if(Xn){var Er="oninput"in document;if(!Er){var td=document.createElement("div");td.setAttribute("oninput","return;"),Er=typeof td.oninput=="function"}_s=Er}else _s=!1;ed=_s&&(!document.documentMode||9<document.documentMode)}function Tl(){gs&&(gs.detachEvent("onpropertychange",nd),ba=gs=null)}function nd(s){if(s.propertyName==="value"&&Na(ba)){var o=[];$c(o,ba,s,Qn(s)),Ns(Ia,o)}}function Ls(s,o,l){s==="focusin"?(Tl(),gs=o,ba=l,gs.attachEvent("onpropertychange",nd)):s==="focusout"&&Tl()}function bf(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Na(ba)}function xr(s,o){if(s==="click")return Na(o)}function If(s,o){if(s==="input"||s==="change")return Na(o)}function Vs(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var zn=typeof Object.is=="function"?Object.is:Vs;function wr(s,o){if(zn(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var l=Object.keys(s),h=Object.keys(o);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var T=l[h];if(!Kt.call(o,T)||!zn(s[T],o[T]))return!1}return!0}function El(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ma(s,o){var l=El(s);s=0;for(var h;l;){if(l.nodeType===3){if(h=s+l.textContent.length,s<=o&&h>=o)return{node:l,offset:o-s};s=h}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=El(l)}}function xl(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?xl(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Pa(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Ei(s.document);o instanceof s.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)s=o.contentWindow;else break;o=Ei(s.document)}return o}function io(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var wl=Xn&&"documentMode"in document&&11>=document.documentMode,so=null,Sl=null,Da=null,Sr=!1;function id(s,o,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Sr||so==null||so!==Ei(h)||(h=so,"selectionStart"in h&&io(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Da&&wr(Da,h)||(Da=h,h=Hd(Sl,"onSelect"),0<h.length&&(o=new ms("onSelect","select",null,o,l),s.push({event:o,listeners:h}),o.target=so)))}function oo(s,o){var l={};return l[s.toLowerCase()]=o.toLowerCase(),l["Webkit"+s]="webkit"+o,l["Moz"+s]="moz"+o,l}var Ar={animationend:oo("Animation","AnimationEnd"),animationiteration:oo("Animation","AnimationIteration"),animationstart:oo("Animation","AnimationStart"),transitionrun:oo("Transition","TransitionRun"),transitionstart:oo("Transition","TransitionStart"),transitioncancel:oo("Transition","TransitionCancel"),transitionend:oo("Transition","TransitionEnd")},Al={},sd={};Xn&&(sd=document.createElement("div").style,"AnimationEvent"in window||(delete Ar.animationend.animation,delete Ar.animationiteration.animation,delete Ar.animationstart.animation),"TransitionEvent"in window||delete Ar.transitionend.transition);function Bn(s){if(Al[s])return Al[s];if(!Ar[s])return s;var o=Ar[s],l;for(l in o)if(o.hasOwnProperty(l)&&l in sd)return Al[s]=o[l];return s}var ka=Bn("animationend"),od=Bn("animationiteration"),La=Bn("animationstart"),Nf=Bn("transitionrun"),rd=Bn("transitionstart"),Rf=Bn("transitioncancel"),Cr=Bn("transitionend"),ad=new Map,ro="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ro.push("scrollEnd");function Ci(s,o){ad.set(s,o),us(o,[s])}var Va=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},bi=[],ei=0,Cl=0;function Oa(){for(var s=ei,o=Cl=ei=0;o<s;){var l=bi[o];bi[o++]=null;var h=bi[o];bi[o++]=null;var T=bi[o];bi[o++]=null;var w=bi[o];if(bi[o++]=null,h!==null&&T!==null){var N=h.pending;N===null?T.next=T:(T.next=N.next,N.next=T),h.pending=T}w!==0&&br(l,T,w)}}function ao(s,o,l,h){bi[ei++]=s,bi[ei++]=o,bi[ei++]=l,bi[ei++]=h,Cl|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function ku(s,o,l,h){return ao(s,o,l,h),Ua(s)}function ys(s,o){return ao(s,null,null,o),Ua(s)}function br(s,o,l){s.lanes|=l;var h=s.alternate;h!==null&&(h.lanes|=l);for(var T=!1,w=s.return;w!==null;)w.childLanes|=l,h=w.alternate,h!==null&&(h.childLanes|=l),w.tag===22&&(s=w.stateNode,s===null||s._visibility&1||(T=!0)),s=w,w=w.return;return s.tag===3?(w=s.stateNode,T&&o!==null&&(T=31-tn(l),s=w.hiddenUpdates,h=s[T],h===null?s[T]=[o]:h.push(o),o.lane=l|536870912),w):null}function Ua(s){if(50<oc)throw oc=0,Pm=null,Error(i(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var Vo={};function Mf(s,o,l,h){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ti(s,o,l,h){return new Mf(s,o,l,h)}function bl(s){return s=s.prototype,!(!s||!s.isReactComponent)}function vs(s,o){var l=s.alternate;return l===null?(l=ti(s.tag,o,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=o,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,o=s.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Lu(s,o){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,o=l.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function za(s,o,l,h,T,w){var N=0;if(h=s,typeof s=="function")bl(s)&&(N=1);else if(typeof s=="string")N=oC(s,l,ue.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case U:return s=ti(31,l,o,T),s.elementType=U,s.lanes=w,s;case G:return Oo(l.children,T,w,o);case z:N=8,T|=24;break;case W:return s=ti(12,l,o,T|2),s.elementType=W,s.lanes=w,s;case de:return s=ti(13,l,o,T),s.elementType=de,s.lanes=w,s;case fe:return s=ti(19,l,o,T),s.elementType=fe,s.lanes=w,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Q:N=10;break e;case te:N=9;break e;case me:N=11;break e;case V:N=14;break e;case O:N=16,h=null;break e}N=29,l=Error(i(130,s===null?"null":typeof s,"")),h=null}return o=ti(N,l,o,T),o.elementType=s,o.type=h,o.lanes=w,o}function Oo(s,o,l,h){return s=ti(7,s,h,o),s.lanes=l,s}function Il(s,o,l){return s=ti(6,s,null,o),s.lanes=l,s}function Vu(s){var o=ti(18,null,null,0);return o.stateNode=s,o}function Ou(s,o,l){return o=ti(4,s.children!==null?s.children:[],s.key,o),o.lanes=l,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var a=new WeakMap;function d(s,o){if(typeof s=="object"&&s!==null){var l=a.get(s);return l!==void 0?l:(o={value:s,source:o,stack:Nn(o)},a.set(s,o),o)}return{value:s,source:o,stack:Nn(o)}}var v=[],S=0,I=null,P=0,q=[],ee=0,re=null,ye=1,Re="";function Be(s,o){v[S++]=P,v[S++]=I,I=s,P=o}function ot(s,o,l){q[ee++]=ye,q[ee++]=Re,q[ee++]=re,re=s;var h=ye;s=Re;var T=32-tn(h)-1;h&=~(1<<T),l+=1;var w=32-tn(o)+T;if(30<w){var N=T-T%5;w=(h&(1<<N)-1).toString(32),h>>=N,T-=N,ye=1<<32-tn(o)+T|l<<T|h,Re=w+s}else ye=1<<w|l<<T|h,Re=s}function Mn(s){s.return!==null&&(Be(s,1),ot(s,1,0))}function un(s){for(;s===I;)I=v[--S],v[S]=null,P=v[--S],v[S]=null;for(;s===re;)re=q[--ee],q[ee]=null,Re=q[--ee],q[ee]=null,ye=q[--ee],q[ee]=null}function mi(s,o){q[ee++]=ye,q[ee++]=Re,q[ee++]=re,ye=o.id,Re=o.overflow,re=s}var Ct=null,bt=null,dt=!1,lo=null,Ii=!1,Nl=Error(i(519));function uo(s){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ba(d(o,s)),Nl}function Uu(s){var o=s.stateNode,l=s.type,h=s.memoizedProps;switch(o[sn]=s,o[an]=h,l){case"dialog":ft("cancel",o),ft("close",o);break;case"iframe":case"object":case"embed":ft("load",o);break;case"video":case"audio":for(l=0;l<ac.length;l++)ft(ac[l],o);break;case"source":ft("error",o);break;case"img":case"image":case"link":ft("error",o),ft("load",o);break;case"details":ft("toggle",o);break;case"input":ft("invalid",o),No(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":ft("invalid",o);break;case"textarea":ft("invalid",o),xi(o,h.value,h.defaultValue,h.children)}l=h.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||o.textContent===""+l||h.suppressHydrationWarning===!0||zv(o.textContent,l)?(h.popover!=null&&(ft("beforetoggle",o),ft("toggle",o)),h.onScroll!=null&&ft("scroll",o),h.onScrollEnd!=null&&ft("scrollend",o),h.onClick!=null&&(o.onclick=Wn),o=!0):o=!1,o||uo(s,!0)}function on(s){for(Ct=s.return;Ct;)switch(Ct.tag){case 5:case 31:case 13:Ii=!1;return;case 27:case 3:Ii=!0;return;default:Ct=Ct.return}}function Os(s){if(s!==Ct)return!1;if(!dt)return on(s),dt=!0,!1;var o=s.tag,l;if((l=o!==3&&o!==27)&&((l=o===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||Km(s.type,s.memoizedProps)),l=!l),l&&bt&&uo(s),on(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));bt=Yv(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));bt=Yv(s)}else o===27?(o=bt,Fr(s.type)?(s=Xm,Xm=null,bt=s):bt=o):bt=Ct?Es(s.stateNode.nextSibling):null;return!0}function Uo(){bt=Ct=null,dt=!1}function zu(){var s=lo;return s!==null&&(Pi===null?Pi=s:Pi.push.apply(Pi,s),lo=null),s}function Ba(s){lo===null?lo=[s]:lo.push(s)}var Fa=j(null),co=null,Us=null;function Ir(s,o,l){Ce(Fa,o._currentValue),o._currentValue=l}function zo(s){s._currentValue=Fa.current,he(Fa)}function Pf(s,o,l){for(;s!==null;){var h=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),s===l)break;s=s.return}}function Df(s,o,l,h){var T=s.child;for(T!==null&&(T.return=s);T!==null;){var w=T.dependencies;if(w!==null){var N=T.child;w=w.firstContext;e:for(;w!==null;){var D=w;w=T;for(var Z=0;Z<o.length;Z++)if(D.context===o[Z]){w.lanes|=l,D=w.alternate,D!==null&&(D.lanes|=l),Pf(w.return,l,s),h||(N=null);break e}w=D.next}}else if(T.tag===18){if(N=T.return,N===null)throw Error(i(341));N.lanes|=l,w=N.alternate,w!==null&&(w.lanes|=l),Pf(N,l,s),N=null}else N=T.child;if(N!==null)N.return=T;else for(N=T;N!==null;){if(N===s){N=null;break}if(T=N.sibling,T!==null){T.return=N.return,N=T;break}N=N.return}T=N}}function Rl(s,o,l,h){s=null;for(var T=o,w=!1;T!==null;){if(!w){if((T.flags&524288)!==0)w=!0;else if((T.flags&262144)!==0)break}if(T.tag===10){var N=T.alternate;if(N===null)throw Error(i(387));if(N=N.memoizedProps,N!==null){var D=T.type;zn(T.pendingProps.value,N.value)||(s!==null?s.push(D):s=[D])}}else if(T===be.current){if(N=T.alternate,N===null)throw Error(i(387));N.memoizedState.memoizedState!==T.memoizedState.memoizedState&&(s!==null?s.push(hc):s=[hc])}T=T.return}s!==null&&Df(o,s,l,h),o.flags|=262144}function ld(s){for(s=s.firstContext;s!==null;){if(!zn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function qa(s){co=s,Us=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Gn(s){return S_(co,s)}function ud(s,o){return co===null&&qa(s),S_(s,o)}function S_(s,o){var l=o._currentValue;if(o={context:o,memoizedValue:l,next:null},Us===null){if(s===null)throw Error(i(308));Us=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Us=Us.next=o;return l}var t1=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(l,h){s.push(h)}};this.abort=function(){o.aborted=!0,s.forEach(function(l){return l()})}},n1=n.unstable_scheduleCallback,i1=n.unstable_NormalPriority,Tn={$$typeof:Q,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function kf(){return{controller:new t1,data:new Map,refCount:0}}function Bu(s){s.refCount--,s.refCount===0&&n1(i1,function(){s.controller.abort()})}var Fu=null,Lf=0,Ml=0,Pl=null;function s1(s,o){if(Fu===null){var l=Fu=[];Lf=0,Ml=Um(),Pl={status:"pending",value:void 0,then:function(h){l.push(h)}}}return Lf++,o.then(A_,A_),o}function A_(){if(--Lf===0&&Fu!==null){Pl!==null&&(Pl.status="fulfilled");var s=Fu;Fu=null,Ml=0,Pl=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function o1(s,o){var l=[],h={status:"pending",value:null,reason:null,then:function(T){l.push(T)}};return s.then(function(){h.status="fulfilled",h.value=o;for(var T=0;T<l.length;T++)(0,l[T])(o)},function(T){for(h.status="rejected",h.reason=T,T=0;T<l.length;T++)(0,l[T])(void 0)}),h}var C_=oe.S;oe.S=function(s,o){uv=pt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&s1(s,o),C_!==null&&C_(s,o)};var Ha=j(null);function Vf(){var s=Ha.current;return s!==null?s:Gt.pooledCache}function cd(s,o){o===null?Ce(Ha,Ha.current):Ce(Ha,o.pool)}function b_(){var s=Vf();return s===null?null:{parent:Tn._currentValue,pool:s}}var Dl=Error(i(460)),Of=Error(i(474)),dd=Error(i(542)),hd={then:function(){}};function I_(s){return s=s.status,s==="fulfilled"||s==="rejected"}function N_(s,o,l){switch(l=s[l],l===void 0?s.push(o):l!==o&&(o.then(Wn,Wn),o=l),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,M_(s),s;default:if(typeof o.status=="string")o.then(Wn,Wn);else{if(s=Gt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=o,s.status="pending",s.then(function(h){if(o.status==="pending"){var T=o;T.status="fulfilled",T.value=h}},function(h){if(o.status==="pending"){var T=o;T.status="rejected",T.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,M_(s),s}throw ja=o,Dl}}function Ga(s){try{var o=s._init;return o(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(ja=l,Dl):l}}var ja=null;function R_(){if(ja===null)throw Error(i(459));var s=ja;return ja=null,s}function M_(s){if(s===Dl||s===dd)throw Error(i(483))}var kl=null,qu=0;function fd(s){var o=qu;return qu+=1,kl===null&&(kl=[]),N_(kl,s,o)}function Hu(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function md(s,o){throw o.$$typeof===b?Error(i(525)):(s=Object.prototype.toString.call(o),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function P_(s){function o($,J){if(s){var ie=$.deletions;ie===null?($.deletions=[J],$.flags|=16):ie.push(J)}}function l($,J){if(!s)return null;for(;J!==null;)o($,J),J=J.sibling;return null}function h($){for(var J=new Map;$!==null;)$.key!==null?J.set($.key,$):J.set($.index,$),$=$.sibling;return J}function T($,J){return $=vs($,J),$.index=0,$.sibling=null,$}function w($,J,ie){return $.index=ie,s?(ie=$.alternate,ie!==null?(ie=ie.index,ie<J?($.flags|=67108866,J):ie):($.flags|=67108866,J)):($.flags|=1048576,J)}function N($){return s&&$.alternate===null&&($.flags|=67108866),$}function D($,J,ie,_e){return J===null||J.tag!==6?(J=Il(ie,$.mode,_e),J.return=$,J):(J=T(J,ie),J.return=$,J)}function Z($,J,ie,_e){var qe=ie.type;return qe===G?pe($,J,ie.props.children,_e,ie.key):J!==null&&(J.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===O&&Ga(qe)===J.type)?(J=T(J,ie.props),Hu(J,ie),J.return=$,J):(J=za(ie.type,ie.key,ie.props,null,$.mode,_e),Hu(J,ie),J.return=$,J)}function se($,J,ie,_e){return J===null||J.tag!==4||J.stateNode.containerInfo!==ie.containerInfo||J.stateNode.implementation!==ie.implementation?(J=Ou(ie,$.mode,_e),J.return=$,J):(J=T(J,ie.children||[]),J.return=$,J)}function pe($,J,ie,_e,qe){return J===null||J.tag!==7?(J=Oo(ie,$.mode,_e,qe),J.return=$,J):(J=T(J,ie),J.return=$,J)}function ve($,J,ie){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=Il(""+J,$.mode,ie),J.return=$,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case M:return ie=za(J.type,J.key,J.props,null,$.mode,ie),Hu(ie,J),ie.return=$,ie;case K:return J=Ou(J,$.mode,ie),J.return=$,J;case O:return J=Ga(J),ve($,J,ie)}if(mt(J)||Y(J))return J=Oo(J,$.mode,ie,null),J.return=$,J;if(typeof J.then=="function")return ve($,fd(J),ie);if(J.$$typeof===Q)return ve($,ud($,J),ie);md($,J)}return null}function ae($,J,ie,_e){var qe=J!==null?J.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return qe!==null?null:D($,J,""+ie,_e);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case M:return ie.key===qe?Z($,J,ie,_e):null;case K:return ie.key===qe?se($,J,ie,_e):null;case O:return ie=Ga(ie),ae($,J,ie,_e)}if(mt(ie)||Y(ie))return qe!==null?null:pe($,J,ie,_e,null);if(typeof ie.then=="function")return ae($,J,fd(ie),_e);if(ie.$$typeof===Q)return ae($,J,ud($,ie),_e);md($,ie)}return null}function ce($,J,ie,_e,qe){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return $=$.get(ie)||null,D(J,$,""+_e,qe);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case M:return $=$.get(_e.key===null?ie:_e.key)||null,Z(J,$,_e,qe);case K:return $=$.get(_e.key===null?ie:_e.key)||null,se(J,$,_e,qe);case O:return _e=Ga(_e),ce($,J,ie,_e,qe)}if(mt(_e)||Y(_e))return $=$.get(ie)||null,pe(J,$,_e,qe,null);if(typeof _e.then=="function")return ce($,J,ie,fd(_e),qe);if(_e.$$typeof===Q)return ce($,J,ie,ud(J,_e),qe);md(J,_e)}return null}function Ue($,J,ie,_e){for(var qe=null,It=null,ze=J,rt=J=0,yt=null;ze!==null&&rt<ie.length;rt++){ze.index>rt?(yt=ze,ze=null):yt=ze.sibling;var Nt=ae($,ze,ie[rt],_e);if(Nt===null){ze===null&&(ze=yt);break}s&&ze&&Nt.alternate===null&&o($,ze),J=w(Nt,J,rt),It===null?qe=Nt:It.sibling=Nt,It=Nt,ze=yt}if(rt===ie.length)return l($,ze),dt&&Be($,rt),qe;if(ze===null){for(;rt<ie.length;rt++)ze=ve($,ie[rt],_e),ze!==null&&(J=w(ze,J,rt),It===null?qe=ze:It.sibling=ze,It=ze);return dt&&Be($,rt),qe}for(ze=h(ze);rt<ie.length;rt++)yt=ce(ze,$,rt,ie[rt],_e),yt!==null&&(s&&yt.alternate!==null&&ze.delete(yt.key===null?rt:yt.key),J=w(yt,J,rt),It===null?qe=yt:It.sibling=yt,It=yt);return s&&ze.forEach(function(Zr){return o($,Zr)}),dt&&Be($,rt),qe}function Ze($,J,ie,_e){if(ie==null)throw Error(i(151));for(var qe=null,It=null,ze=J,rt=J=0,yt=null,Nt=ie.next();ze!==null&&!Nt.done;rt++,Nt=ie.next()){ze.index>rt?(yt=ze,ze=null):yt=ze.sibling;var Zr=ae($,ze,Nt.value,_e);if(Zr===null){ze===null&&(ze=yt);break}s&&ze&&Zr.alternate===null&&o($,ze),J=w(Zr,J,rt),It===null?qe=Zr:It.sibling=Zr,It=Zr,ze=yt}if(Nt.done)return l($,ze),dt&&Be($,rt),qe;if(ze===null){for(;!Nt.done;rt++,Nt=ie.next())Nt=ve($,Nt.value,_e),Nt!==null&&(J=w(Nt,J,rt),It===null?qe=Nt:It.sibling=Nt,It=Nt);return dt&&Be($,rt),qe}for(ze=h(ze);!Nt.done;rt++,Nt=ie.next())Nt=ce(ze,$,rt,Nt.value,_e),Nt!==null&&(s&&Nt.alternate!==null&&ze.delete(Nt.key===null?rt:Nt.key),J=w(Nt,J,rt),It===null?qe=Nt:It.sibling=Nt,It=Nt);return s&&ze.forEach(function(gC){return o($,gC)}),dt&&Be($,rt),qe}function Bt($,J,ie,_e){if(typeof ie=="object"&&ie!==null&&ie.type===G&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case M:e:{for(var qe=ie.key;J!==null;){if(J.key===qe){if(qe=ie.type,qe===G){if(J.tag===7){l($,J.sibling),_e=T(J,ie.props.children),_e.return=$,$=_e;break e}}else if(J.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===O&&Ga(qe)===J.type){l($,J.sibling),_e=T(J,ie.props),Hu(_e,ie),_e.return=$,$=_e;break e}l($,J);break}else o($,J);J=J.sibling}ie.type===G?(_e=Oo(ie.props.children,$.mode,_e,ie.key),_e.return=$,$=_e):(_e=za(ie.type,ie.key,ie.props,null,$.mode,_e),Hu(_e,ie),_e.return=$,$=_e)}return N($);case K:e:{for(qe=ie.key;J!==null;){if(J.key===qe)if(J.tag===4&&J.stateNode.containerInfo===ie.containerInfo&&J.stateNode.implementation===ie.implementation){l($,J.sibling),_e=T(J,ie.children||[]),_e.return=$,$=_e;break e}else{l($,J);break}else o($,J);J=J.sibling}_e=Ou(ie,$.mode,_e),_e.return=$,$=_e}return N($);case O:return ie=Ga(ie),Bt($,J,ie,_e)}if(mt(ie))return Ue($,J,ie,_e);if(Y(ie)){if(qe=Y(ie),typeof qe!="function")throw Error(i(150));return ie=qe.call(ie),Ze($,J,ie,_e)}if(typeof ie.then=="function")return Bt($,J,fd(ie),_e);if(ie.$$typeof===Q)return Bt($,J,ud($,ie),_e);md($,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,J!==null&&J.tag===6?(l($,J.sibling),_e=T(J,ie),_e.return=$,$=_e):(l($,J),_e=Il(ie,$.mode,_e),_e.return=$,$=_e),N($)):l($,J)}return function($,J,ie,_e){try{qu=0;var qe=Bt($,J,ie,_e);return kl=null,qe}catch(ze){if(ze===Dl||ze===dd)throw ze;var It=ti(29,ze,null,$.mode);return It.lanes=_e,It.return=$,It}finally{}}}var Za=P_(!0),D_=P_(!1),Nr=!1;function Uf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zf(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Rr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Mr(s,o,l){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Mt&2)!==0){var T=h.pending;return T===null?o.next=o:(o.next=T.next,T.next=o),h.pending=o,o=Ua(s),br(s,null,l),o}return ao(s,h,o,l),Ua(s)}function Gu(s,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194048)!==0)){var h=o.lanes;h&=s.pendingLanes,l|=h,o.lanes=l,ga(s,l)}}function Bf(s,o){var l=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var T=null,w=null;if(l=l.firstBaseUpdate,l!==null){do{var N={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};w===null?T=w=N:w=w.next=N,l=l.next}while(l!==null);w===null?T=w=o:w=w.next=o}else T=w=o;l={baseState:h.baseState,firstBaseUpdate:T,lastBaseUpdate:w,shared:h.shared,callbacks:h.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=o:s.next=o,l.lastBaseUpdate=o}var Ff=!1;function ju(){if(Ff){var s=Pl;if(s!==null)throw s}}function Zu(s,o,l,h){Ff=!1;var T=s.updateQueue;Nr=!1;var w=T.firstBaseUpdate,N=T.lastBaseUpdate,D=T.shared.pending;if(D!==null){T.shared.pending=null;var Z=D,se=Z.next;Z.next=null,N===null?w=se:N.next=se,N=Z;var pe=s.alternate;pe!==null&&(pe=pe.updateQueue,D=pe.lastBaseUpdate,D!==N&&(D===null?pe.firstBaseUpdate=se:D.next=se,pe.lastBaseUpdate=Z))}if(w!==null){var ve=T.baseState;N=0,pe=se=Z=null,D=w;do{var ae=D.lane&-536870913,ce=ae!==D.lane;if(ce?(_t&ae)===ae:(h&ae)===ae){ae!==0&&ae===Ml&&(Ff=!0),pe!==null&&(pe=pe.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Ue=s,Ze=D;ae=o;var Bt=l;switch(Ze.tag){case 1:if(Ue=Ze.payload,typeof Ue=="function"){ve=Ue.call(Bt,ve,ae);break e}ve=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=Ze.payload,ae=typeof Ue=="function"?Ue.call(Bt,ve,ae):Ue,ae==null)break e;ve=A({},ve,ae);break e;case 2:Nr=!0}}ae=D.callback,ae!==null&&(s.flags|=64,ce&&(s.flags|=8192),ce=T.callbacks,ce===null?T.callbacks=[ae]:ce.push(ae))}else ce={lane:ae,tag:D.tag,payload:D.payload,callback:D.callback,next:null},pe===null?(se=pe=ce,Z=ve):pe=pe.next=ce,N|=ae;if(D=D.next,D===null){if(D=T.shared.pending,D===null)break;ce=D,D=ce.next,ce.next=null,T.lastBaseUpdate=ce,T.shared.pending=null}}while(!0);pe===null&&(Z=ve),T.baseState=Z,T.firstBaseUpdate=se,T.lastBaseUpdate=pe,w===null&&(T.shared.lanes=0),Vr|=N,s.lanes=N,s.memoizedState=ve}}function k_(s,o){if(typeof s!="function")throw Error(i(191,s));s.call(o)}function L_(s,o){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)k_(l[s],o)}var Ll=j(null),pd=j(0);function V_(s,o){s=Yo,Ce(pd,s),Ce(Ll,o),Yo=s|o.baseLanes}function qf(){Ce(pd,Yo),Ce(Ll,Ll.current)}function Hf(){Yo=pd.current,he(Ll),he(pd)}var Wi=j(null),Ts=null;function Pr(s){var o=s.alternate;Ce(fn,fn.current&1),Ce(Wi,s),Ts===null&&(o===null||Ll.current!==null||o.memoizedState!==null)&&(Ts=s)}function Gf(s){Ce(fn,fn.current),Ce(Wi,s),Ts===null&&(Ts=s)}function O_(s){s.tag===22?(Ce(fn,fn.current),Ce(Wi,s),Ts===null&&(Ts=s)):Dr()}function Dr(){Ce(fn,fn.current),Ce(Wi,Wi.current)}function Qi(s){he(Wi),Ts===s&&(Ts=null),he(fn)}var fn=j(0);function gd(s){for(var o=s;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Wm(l)||Qm(l)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Bo=0,st=null,Ut=null,En=null,_d=!1,Vl=!1,Ka=!1,yd=0,Ku=0,Ol=null,r1=0;function cn(){throw Error(i(321))}function jf(s,o){if(o===null)return!1;for(var l=0;l<o.length&&l<s.length;l++)if(!zn(s[l],o[l]))return!1;return!0}function Zf(s,o,l,h,T,w){return Bo=w,st=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,oe.H=s===null||s.memoizedState===null?Ty:am,Ka=!1,w=l(h,T),Ka=!1,Vl&&(w=z_(o,l,h,T)),U_(s),w}function U_(s){oe.H=Wu;var o=Ut!==null&&Ut.next!==null;if(Bo=0,En=Ut=st=null,_d=!1,Ku=0,Ol=null,o)throw Error(i(300));s===null||xn||(s=s.dependencies,s!==null&&ld(s)&&(xn=!0))}function z_(s,o,l,h){st=s;var T=0;do{if(Vl&&(Ol=null),Ku=0,Vl=!1,25<=T)throw Error(i(301));if(T+=1,En=Ut=null,s.updateQueue!=null){var w=s.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}oe.H=Ey,w=o(l,h)}while(Vl);return w}function a1(){var s=oe.H,o=s.useState()[0];return o=typeof o.then=="function"?Yu(o):o,s=s.useState()[0],(Ut!==null?Ut.memoizedState:null)!==s&&(st.flags|=1024),o}function Kf(){var s=yd!==0;return yd=0,s}function Yf(s,o,l){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~l}function Jf(s){if(_d){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}_d=!1}Bo=0,En=Ut=st=null,Vl=!1,Ku=yd=0,Ol=null}function pi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?st.memoizedState=En=s:En=En.next=s,En}function mn(){if(Ut===null){var s=st.alternate;s=s!==null?s.memoizedState:null}else s=Ut.next;var o=En===null?st.memoizedState:En.next;if(o!==null)En=o,Ut=s;else{if(s===null)throw st.alternate===null?Error(i(467)):Error(i(310));Ut=s,s={memoizedState:Ut.memoizedState,baseState:Ut.baseState,baseQueue:Ut.baseQueue,queue:Ut.queue,next:null},En===null?st.memoizedState=En=s:En=En.next=s}return En}function vd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yu(s){var o=Ku;return Ku+=1,Ol===null&&(Ol=[]),s=N_(Ol,s,o),o=st,(En===null?o.memoizedState:En.next)===null&&(o=o.alternate,oe.H=o===null||o.memoizedState===null?Ty:am),s}function Td(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Yu(s);if(s.$$typeof===Q)return Gn(s)}throw Error(i(438,String(s)))}function Wf(s){var o=null,l=st.updateQueue;if(l!==null&&(o=l.memoCache),o==null){var h=st.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(T){return T.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),l===null&&(l=vd(),st.updateQueue=l),l.memoCache=o,l=o.data[o.index],l===void 0)for(l=o.data[o.index]=Array(s),h=0;h<s;h++)l[h]=H;return o.index++,l}function Fo(s,o){return typeof o=="function"?o(s):o}function Ed(s){var o=mn();return Qf(o,Ut,s)}function Qf(s,o,l){var h=s.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=l;var T=s.baseQueue,w=h.pending;if(w!==null){if(T!==null){var N=T.next;T.next=w.next,w.next=N}o.baseQueue=T=w,h.pending=null}if(w=s.baseState,T===null)s.memoizedState=w;else{o=T.next;var D=N=null,Z=null,se=o,pe=!1;do{var ve=se.lane&-536870913;if(ve!==se.lane?(_t&ve)===ve:(Bo&ve)===ve){var ae=se.revertLane;if(ae===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),ve===Ml&&(pe=!0);else if((Bo&ae)===ae){se=se.next,ae===Ml&&(pe=!0);continue}else ve={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},Z===null?(D=Z=ve,N=w):Z=Z.next=ve,st.lanes|=ae,Vr|=ae;ve=se.action,Ka&&l(w,ve),w=se.hasEagerState?se.eagerState:l(w,ve)}else ae={lane:ve,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},Z===null?(D=Z=ae,N=w):Z=Z.next=ae,st.lanes|=ve,Vr|=ve;se=se.next}while(se!==null&&se!==o);if(Z===null?N=w:Z.next=D,!zn(w,s.memoizedState)&&(xn=!0,pe&&(l=Pl,l!==null)))throw l;s.memoizedState=w,s.baseState=N,s.baseQueue=Z,h.lastRenderedState=w}return T===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function Xf(s){var o=mn(),l=o.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var h=l.dispatch,T=l.pending,w=o.memoizedState;if(T!==null){l.pending=null;var N=T=T.next;do w=s(w,N.action),N=N.next;while(N!==T);zn(w,o.memoizedState)||(xn=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),l.lastRenderedState=w}return[w,h]}function B_(s,o,l){var h=st,T=mn(),w=dt;if(w){if(l===void 0)throw Error(i(407));l=l()}else l=o();var N=!zn((Ut||T).memoizedState,l);if(N&&(T.memoizedState=l,xn=!0),T=T.queue,tm(H_.bind(null,h,T,s),[s]),T.getSnapshot!==o||N||En!==null&&En.memoizedState.tag&1){if(h.flags|=2048,Ul(9,{destroy:void 0},q_.bind(null,h,T,l,o),null),Gt===null)throw Error(i(349));w||(Bo&127)!==0||F_(h,o,l)}return l}function F_(s,o,l){s.flags|=16384,s={getSnapshot:o,value:l},o=st.updateQueue,o===null?(o=vd(),st.updateQueue=o,o.stores=[s]):(l=o.stores,l===null?o.stores=[s]:l.push(s))}function q_(s,o,l,h){o.value=l,o.getSnapshot=h,G_(o)&&j_(s)}function H_(s,o,l){return l(function(){G_(o)&&j_(s)})}function G_(s){var o=s.getSnapshot;s=s.value;try{var l=o();return!zn(s,l)}catch{return!0}}function j_(s){var o=ys(s,2);o!==null&&Di(o,s,2)}function $f(s){var o=pi();if(typeof s=="function"){var l=s;if(s=l(),Ka){ui(!0);try{l()}finally{ui(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fo,lastRenderedState:s},o}function Z_(s,o,l,h){return s.baseState=l,Qf(s,Ut,typeof h=="function"?h:Fo)}function l1(s,o,l,h,T){if(Sd(s))throw Error(i(485));if(s=o.action,s!==null){var w={payload:T,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){w.listeners.push(N)}};oe.T!==null?l(!0):w.isTransition=!1,h(w),l=o.pending,l===null?(w.next=o.pending=w,K_(o,w)):(w.next=l.next,o.pending=l.next=w)}}function K_(s,o){var l=o.action,h=o.payload,T=s.state;if(o.isTransition){var w=oe.T,N={};oe.T=N;try{var D=l(T,h),Z=oe.S;Z!==null&&Z(N,D),Y_(s,o,D)}catch(se){em(s,o,se)}finally{w!==null&&N.types!==null&&(w.types=N.types),oe.T=w}}else try{w=l(T,h),Y_(s,o,w)}catch(se){em(s,o,se)}}function Y_(s,o,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(h){J_(s,o,h)},function(h){return em(s,o,h)}):J_(s,o,l)}function J_(s,o,l){o.status="fulfilled",o.value=l,W_(o),s.state=l,o=s.pending,o!==null&&(l=o.next,l===o?s.pending=null:(l=l.next,o.next=l,K_(s,l)))}function em(s,o,l){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=l,W_(o),o=o.next;while(o!==h)}s.action=null}function W_(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function Q_(s,o){return o}function X_(s,o){if(dt){var l=Gt.formState;if(l!==null){e:{var h=st;if(dt){if(bt){t:{for(var T=bt,w=Ii;T.nodeType!==8;){if(!w){T=null;break t}if(T=Es(T.nextSibling),T===null){T=null;break t}}w=T.data,T=w==="F!"||w==="F"?T:null}if(T){bt=Es(T.nextSibling),h=T.data==="F!";break e}}uo(h)}h=!1}h&&(o=l[0])}}return l=pi(),l.memoizedState=l.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Q_,lastRenderedState:o},l.queue=h,l=_y.bind(null,st,h),h.dispatch=l,h=$f(!1),w=rm.bind(null,st,!1,h.queue),h=pi(),T={state:o,dispatch:null,action:s,pending:null},h.queue=T,l=l1.bind(null,st,T,w,l),T.dispatch=l,h.memoizedState=s,[o,l,!1]}function $_(s){var o=mn();return ey(o,Ut,s)}function ey(s,o,l){if(o=Qf(s,o,Q_)[0],s=Ed(Fo)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=Yu(o)}catch(N){throw N===Dl?dd:N}else h=o;o=mn();var T=o.queue,w=T.dispatch;return l!==o.memoizedState&&(st.flags|=2048,Ul(9,{destroy:void 0},u1.bind(null,T,l),null)),[h,w,s]}function u1(s,o){s.action=o}function ty(s){var o=mn(),l=Ut;if(l!==null)return ey(o,l,s);mn(),o=o.memoizedState,l=mn();var h=l.queue.dispatch;return l.memoizedState=s,[o,h,!1]}function Ul(s,o,l,h){return s={tag:s,create:l,deps:h,inst:o,next:null},o=st.updateQueue,o===null&&(o=vd(),st.updateQueue=o),l=o.lastEffect,l===null?o.lastEffect=s.next=s:(h=l.next,l.next=s,s.next=h,o.lastEffect=s),s}function ny(){return mn().memoizedState}function xd(s,o,l,h){var T=pi();st.flags|=s,T.memoizedState=Ul(1|o,{destroy:void 0},l,h===void 0?null:h)}function wd(s,o,l,h){var T=mn();h=h===void 0?null:h;var w=T.memoizedState.inst;Ut!==null&&h!==null&&jf(h,Ut.memoizedState.deps)?T.memoizedState=Ul(o,w,l,h):(st.flags|=s,T.memoizedState=Ul(1|o,w,l,h))}function iy(s,o){xd(8390656,8,s,o)}function tm(s,o){wd(2048,8,s,o)}function c1(s){st.flags|=4;var o=st.updateQueue;if(o===null)o=vd(),st.updateQueue=o,o.events=[s];else{var l=o.events;l===null?o.events=[s]:l.push(s)}}function sy(s){var o=mn().memoizedState;return c1({ref:o,nextImpl:s}),function(){if((Mt&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function oy(s,o){return wd(4,2,s,o)}function ry(s,o){return wd(4,4,s,o)}function ay(s,o){if(typeof o=="function"){s=s();var l=o(s);return function(){typeof l=="function"?l():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function ly(s,o,l){l=l!=null?l.concat([s]):null,wd(4,4,ay.bind(null,o,s),l)}function nm(){}function uy(s,o){var l=mn();o=o===void 0?null:o;var h=l.memoizedState;return o!==null&&jf(o,h[1])?h[0]:(l.memoizedState=[s,o],s)}function cy(s,o){var l=mn();o=o===void 0?null:o;var h=l.memoizedState;if(o!==null&&jf(o,h[1]))return h[0];if(h=s(),Ka){ui(!0);try{s()}finally{ui(!1)}}return l.memoizedState=[h,o],h}function im(s,o,l){return l===void 0||(Bo&1073741824)!==0&&(_t&261930)===0?s.memoizedState=o:(s.memoizedState=l,s=dv(),st.lanes|=s,Vr|=s,l)}function dy(s,o,l,h){return zn(l,o)?l:Ll.current!==null?(s=im(s,l,h),zn(s,o)||(xn=!0),s):(Bo&42)===0||(Bo&1073741824)!==0&&(_t&261930)===0?(xn=!0,s.memoizedState=l):(s=dv(),st.lanes|=s,Vr|=s,o)}function hy(s,o,l,h,T){var w=Ae.p;Ae.p=w!==0&&8>w?w:8;var N=oe.T,D={};oe.T=D,rm(s,!1,o,l);try{var Z=T(),se=oe.S;if(se!==null&&se(D,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var pe=o1(Z,h);Ju(s,o,pe,es(s))}else Ju(s,o,h,es(s))}catch(ve){Ju(s,o,{then:function(){},status:"rejected",reason:ve},es())}finally{Ae.p=w,N!==null&&D.types!==null&&(N.types=D.types),oe.T=N}}function d1(){}function sm(s,o,l,h){if(s.tag!==5)throw Error(i(476));var T=fy(s).queue;hy(s,T,o,we,l===null?d1:function(){return my(s),l(h)})}function fy(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:we,baseState:we,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fo,lastRenderedState:we},next:null};var l={};return o.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fo,lastRenderedState:l},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function my(s){var o=fy(s);o.next===null&&(o=s.alternate.memoizedState),Ju(s,o.next.queue,{},es())}function om(){return Gn(hc)}function py(){return mn().memoizedState}function gy(){return mn().memoizedState}function h1(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var l=es();s=Rr(l);var h=Mr(o,s,l);h!==null&&(Di(h,o,l),Gu(h,o,l)),o={cache:kf()},s.payload=o;return}o=o.return}}function f1(s,o,l){var h=es();l={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Sd(s)?yy(o,l):(l=ku(s,o,l,h),l!==null&&(Di(l,s,h),vy(l,o,h)))}function _y(s,o,l){var h=es();Ju(s,o,l,h)}function Ju(s,o,l,h){var T={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Sd(s))yy(o,T);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var N=o.lastRenderedState,D=w(N,l);if(T.hasEagerState=!0,T.eagerState=D,zn(D,N))return ao(s,o,T,0),Gt===null&&Oa(),!1}catch{}finally{}if(l=ku(s,o,T,h),l!==null)return Di(l,s,h),vy(l,o,h),!0}return!1}function rm(s,o,l,h){if(h={lane:2,revertLane:Um(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Sd(s)){if(o)throw Error(i(479))}else o=ku(s,l,h,2),o!==null&&Di(o,s,2)}function Sd(s){var o=s.alternate;return s===st||o!==null&&o===st}function yy(s,o){Vl=_d=!0;var l=s.pending;l===null?o.next=o:(o.next=l.next,l.next=o),s.pending=o}function vy(s,o,l){if((l&4194048)!==0){var h=o.lanes;h&=s.pendingLanes,l|=h,o.lanes=l,ga(s,l)}}var Wu={readContext:Gn,use:Td,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useLayoutEffect:cn,useInsertionEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useSyncExternalStore:cn,useId:cn,useHostTransitionStatus:cn,useFormState:cn,useActionState:cn,useOptimistic:cn,useMemoCache:cn,useCacheRefresh:cn};Wu.useEffectEvent=cn;var Ty={readContext:Gn,use:Td,useCallback:function(s,o){return pi().memoizedState=[s,o===void 0?null:o],s},useContext:Gn,useEffect:iy,useImperativeHandle:function(s,o,l){l=l!=null?l.concat([s]):null,xd(4194308,4,ay.bind(null,o,s),l)},useLayoutEffect:function(s,o){return xd(4194308,4,s,o)},useInsertionEffect:function(s,o){xd(4,2,s,o)},useMemo:function(s,o){var l=pi();o=o===void 0?null:o;var h=s();if(Ka){ui(!0);try{s()}finally{ui(!1)}}return l.memoizedState=[h,o],h},useReducer:function(s,o,l){var h=pi();if(l!==void 0){var T=l(o);if(Ka){ui(!0);try{l(o)}finally{ui(!1)}}}else T=o;return h.memoizedState=h.baseState=T,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:T},h.queue=s,s=s.dispatch=f1.bind(null,st,s),[h.memoizedState,s]},useRef:function(s){var o=pi();return s={current:s},o.memoizedState=s},useState:function(s){s=$f(s);var o=s.queue,l=_y.bind(null,st,o);return o.dispatch=l,[s.memoizedState,l]},useDebugValue:nm,useDeferredValue:function(s,o){var l=pi();return im(l,s,o)},useTransition:function(){var s=$f(!1);return s=hy.bind(null,st,s.queue,!0,!1),pi().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,l){var h=st,T=pi();if(dt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=o(),Gt===null)throw Error(i(349));(_t&127)!==0||F_(h,o,l)}T.memoizedState=l;var w={value:l,getSnapshot:o};return T.queue=w,iy(H_.bind(null,h,w,s),[s]),h.flags|=2048,Ul(9,{destroy:void 0},q_.bind(null,h,w,l,o),null),l},useId:function(){var s=pi(),o=Gt.identifierPrefix;if(dt){var l=Re,h=ye;l=(h&~(1<<32-tn(h)-1)).toString(32)+l,o="_"+o+"R_"+l,l=yd++,0<l&&(o+="H"+l.toString(32)),o+="_"}else l=r1++,o="_"+o+"r_"+l.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:om,useFormState:X_,useActionState:X_,useOptimistic:function(s){var o=pi();o.memoizedState=o.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=l,o=rm.bind(null,st,!0,l),l.dispatch=o,[s,o]},useMemoCache:Wf,useCacheRefresh:function(){return pi().memoizedState=h1.bind(null,st)},useEffectEvent:function(s){var o=pi(),l={impl:s};return o.memoizedState=l,function(){if((Mt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},am={readContext:Gn,use:Td,useCallback:uy,useContext:Gn,useEffect:tm,useImperativeHandle:ly,useInsertionEffect:oy,useLayoutEffect:ry,useMemo:cy,useReducer:Ed,useRef:ny,useState:function(){return Ed(Fo)},useDebugValue:nm,useDeferredValue:function(s,o){var l=mn();return dy(l,Ut.memoizedState,s,o)},useTransition:function(){var s=Ed(Fo)[0],o=mn().memoizedState;return[typeof s=="boolean"?s:Yu(s),o]},useSyncExternalStore:B_,useId:py,useHostTransitionStatus:om,useFormState:$_,useActionState:$_,useOptimistic:function(s,o){var l=mn();return Z_(l,Ut,s,o)},useMemoCache:Wf,useCacheRefresh:gy};am.useEffectEvent=sy;var Ey={readContext:Gn,use:Td,useCallback:uy,useContext:Gn,useEffect:tm,useImperativeHandle:ly,useInsertionEffect:oy,useLayoutEffect:ry,useMemo:cy,useReducer:Xf,useRef:ny,useState:function(){return Xf(Fo)},useDebugValue:nm,useDeferredValue:function(s,o){var l=mn();return Ut===null?im(l,s,o):dy(l,Ut.memoizedState,s,o)},useTransition:function(){var s=Xf(Fo)[0],o=mn().memoizedState;return[typeof s=="boolean"?s:Yu(s),o]},useSyncExternalStore:B_,useId:py,useHostTransitionStatus:om,useFormState:ty,useActionState:ty,useOptimistic:function(s,o){var l=mn();return Ut!==null?Z_(l,Ut,s,o):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:Wf,useCacheRefresh:gy};Ey.useEffectEvent=sy;function lm(s,o,l,h){o=s.memoizedState,l=l(h,o),l=l==null?o:A({},o,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var um={enqueueSetState:function(s,o,l){s=s._reactInternals;var h=es(),T=Rr(h);T.payload=o,l!=null&&(T.callback=l),o=Mr(s,T,h),o!==null&&(Di(o,s,h),Gu(o,s,h))},enqueueReplaceState:function(s,o,l){s=s._reactInternals;var h=es(),T=Rr(h);T.tag=1,T.payload=o,l!=null&&(T.callback=l),o=Mr(s,T,h),o!==null&&(Di(o,s,h),Gu(o,s,h))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var l=es(),h=Rr(l);h.tag=2,o!=null&&(h.callback=o),o=Mr(s,h,l),o!==null&&(Di(o,s,l),Gu(o,s,l))}};function xy(s,o,l,h,T,w,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,w,N):o.prototype&&o.prototype.isPureReactComponent?!wr(l,h)||!wr(T,w):!0}function wy(s,o,l,h){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,h),o.state!==s&&um.enqueueReplaceState(o,o.state,null)}function Ya(s,o){var l=o;if("ref"in o){l={};for(var h in o)h!=="ref"&&(l[h]=o[h])}if(s=s.defaultProps){l===o&&(l=A({},l));for(var T in s)l[T]===void 0&&(l[T]=s[T])}return l}function Sy(s){Va(s)}function Ay(s){console.error(s)}function Cy(s){Va(s)}function Ad(s,o){try{var l=s.onUncaughtError;l(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function by(s,o,l){try{var h=s.onCaughtError;h(l.value,{componentStack:l.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(T){setTimeout(function(){throw T})}}function cm(s,o,l){return l=Rr(l),l.tag=3,l.payload={element:null},l.callback=function(){Ad(s,o)},l}function Iy(s){return s=Rr(s),s.tag=3,s}function Ny(s,o,l,h){var T=l.type.getDerivedStateFromError;if(typeof T=="function"){var w=h.value;s.payload=function(){return T(w)},s.callback=function(){by(o,l,h)}}var N=l.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){by(o,l,h),typeof T!="function"&&(Or===null?Or=new Set([this]):Or.add(this));var D=h.stack;this.componentDidCatch(h.value,{componentStack:D!==null?D:""})})}function m1(s,o,l,h,T){if(l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=l.alternate,o!==null&&Rl(o,l,T,!0),l=Wi.current,l!==null){switch(l.tag){case 31:case 13:return Ts===null?Od():l.alternate===null&&dn===0&&(dn=3),l.flags&=-257,l.flags|=65536,l.lanes=T,h===hd?l.flags|=16384:(o=l.updateQueue,o===null?l.updateQueue=new Set([h]):o.add(h),Lm(s,h,T)),!1;case 22:return l.flags|=65536,h===hd?l.flags|=16384:(o=l.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},l.updateQueue=o):(l=o.retryQueue,l===null?o.retryQueue=new Set([h]):l.add(h)),Lm(s,h,T)),!1}throw Error(i(435,l.tag))}return Lm(s,h,T),Od(),!1}if(dt)return o=Wi.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=T,h!==Nl&&(s=Error(i(422),{cause:h}),Ba(d(s,l)))):(h!==Nl&&(o=Error(i(423),{cause:h}),Ba(d(o,l))),s=s.current.alternate,s.flags|=65536,T&=-T,s.lanes|=T,h=d(h,l),T=cm(s.stateNode,h,T),Bf(s,T),dn!==4&&(dn=2)),!1;var w=Error(i(520),{cause:h});if(w=d(w,l),sc===null?sc=[w]:sc.push(w),dn!==4&&(dn=2),o===null)return!0;h=d(h,l),l=o;do{switch(l.tag){case 3:return l.flags|=65536,s=T&-T,l.lanes|=s,s=cm(l.stateNode,h,s),Bf(l,s),!1;case 1:if(o=l.type,w=l.stateNode,(l.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Or===null||!Or.has(w))))return l.flags|=65536,T&=-T,l.lanes|=T,T=Iy(T),Ny(T,s,l,h),Bf(l,T),!1}l=l.return}while(l!==null);return!1}var dm=Error(i(461)),xn=!1;function jn(s,o,l,h){o.child=s===null?D_(o,null,l,h):Za(o,s.child,l,h)}function Ry(s,o,l,h,T){l=l.render;var w=o.ref;if("ref"in h){var N={};for(var D in h)D!=="ref"&&(N[D]=h[D])}else N=h;return qa(o),h=Zf(s,o,l,N,w,T),D=Kf(),s!==null&&!xn?(Yf(s,o,T),qo(s,o,T)):(dt&&D&&Mn(o),o.flags|=1,jn(s,o,h,T),o.child)}function My(s,o,l,h,T){if(s===null){var w=l.type;return typeof w=="function"&&!bl(w)&&w.defaultProps===void 0&&l.compare===null?(o.tag=15,o.type=w,Py(s,o,w,h,T)):(s=za(l.type,null,h,o,o.mode,T),s.ref=o.ref,s.return=o,o.child=s)}if(w=s.child,!vm(s,T)){var N=w.memoizedProps;if(l=l.compare,l=l!==null?l:wr,l(N,h)&&s.ref===o.ref)return qo(s,o,T)}return o.flags|=1,s=vs(w,h),s.ref=o.ref,s.return=o,o.child=s}function Py(s,o,l,h,T){if(s!==null){var w=s.memoizedProps;if(wr(w,h)&&s.ref===o.ref)if(xn=!1,o.pendingProps=h=w,vm(s,T))(s.flags&131072)!==0&&(xn=!0);else return o.lanes=s.lanes,qo(s,o,T)}return hm(s,o,l,h,T)}function Dy(s,o,l,h){var T=h.children,w=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((o.flags&128)!==0){if(w=w!==null?w.baseLanes|l:l,s!==null){for(h=o.child=s.child,T=0;h!==null;)T=T|h.lanes|h.childLanes,h=h.sibling;h=T&~w}else h=0,o.child=null;return ky(s,o,w,l,h)}if((l&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&cd(o,w!==null?w.cachePool:null),w!==null?V_(o,w):qf(),O_(o);else return h=o.lanes=536870912,ky(s,o,w!==null?w.baseLanes|l:l,l,h)}else w!==null?(cd(o,w.cachePool),V_(o,w),Dr(),o.memoizedState=null):(s!==null&&cd(o,null),qf(),Dr());return jn(s,o,T,l),o.child}function Qu(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function ky(s,o,l,h,T){var w=Vf();return w=w===null?null:{parent:Tn._currentValue,pool:w},o.memoizedState={baseLanes:l,cachePool:w},s!==null&&cd(o,null),qf(),O_(o),s!==null&&Rl(s,o,h,!0),o.childLanes=T,null}function Cd(s,o){return o=Id({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function Ly(s,o,l){return Za(o,s.child,null,l),s=Cd(o,o.pendingProps),s.flags|=2,Qi(o),o.memoizedState=null,s}function p1(s,o,l){var h=o.pendingProps,T=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(dt){if(h.mode==="hidden")return s=Cd(o,h),o.lanes=536870912,Qu(null,s);if(Gf(o),(s=bt)?(s=Kv(s,Ii),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:re!==null?{id:ye,overflow:Re}:null,retryLane:536870912,hydrationErrors:null},l=Vu(s),l.return=o,o.child=l,Ct=o,bt=null)):s=null,s===null)throw uo(o);return o.lanes=536870912,null}return Cd(o,h)}var w=s.memoizedState;if(w!==null){var N=w.dehydrated;if(Gf(o),T)if(o.flags&256)o.flags&=-257,o=Ly(s,o,l);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(i(558));else if(xn||Rl(s,o,l,!1),T=(l&s.childLanes)!==0,xn||T){if(h=Gt,h!==null&&(N=_a(h,l),N!==0&&N!==w.retryLane))throw w.retryLane=N,ys(s,N),Di(h,s,N),dm;Od(),o=Ly(s,o,l)}else s=w.treeContext,bt=Es(N.nextSibling),Ct=o,dt=!0,lo=null,Ii=!1,s!==null&&mi(o,s),o=Cd(o,h),o.flags|=4096;return o}return s=vs(s.child,{mode:h.mode,children:h.children}),s.ref=o.ref,o.child=s,s.return=o,s}function bd(s,o){var l=o.ref;if(l===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(o.flags|=4194816)}}function hm(s,o,l,h,T){return qa(o),l=Zf(s,o,l,h,void 0,T),h=Kf(),s!==null&&!xn?(Yf(s,o,T),qo(s,o,T)):(dt&&h&&Mn(o),o.flags|=1,jn(s,o,l,T),o.child)}function Vy(s,o,l,h,T,w){return qa(o),o.updateQueue=null,l=z_(o,h,l,T),U_(s),h=Kf(),s!==null&&!xn?(Yf(s,o,w),qo(s,o,w)):(dt&&h&&Mn(o),o.flags|=1,jn(s,o,l,w),o.child)}function Oy(s,o,l,h,T){if(qa(o),o.stateNode===null){var w=Vo,N=l.contextType;typeof N=="object"&&N!==null&&(w=Gn(N)),w=new l(h,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=um,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=h,w.state=o.memoizedState,w.refs={},Uf(o),N=l.contextType,w.context=typeof N=="object"&&N!==null?Gn(N):Vo,w.state=o.memoizedState,N=l.getDerivedStateFromProps,typeof N=="function"&&(lm(o,l,N,h),w.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(N=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),N!==w.state&&um.enqueueReplaceState(w,w.state,null),Zu(o,h,w,T),ju(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(s===null){w=o.stateNode;var D=o.memoizedProps,Z=Ya(l,D);w.props=Z;var se=w.context,pe=l.contextType;N=Vo,typeof pe=="object"&&pe!==null&&(N=Gn(pe));var ve=l.getDerivedStateFromProps;pe=typeof ve=="function"||typeof w.getSnapshotBeforeUpdate=="function",D=o.pendingProps!==D,pe||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(D||se!==N)&&wy(o,w,h,N),Nr=!1;var ae=o.memoizedState;w.state=ae,Zu(o,h,w,T),ju(),se=o.memoizedState,D||ae!==se||Nr?(typeof ve=="function"&&(lm(o,l,ve,h),se=o.memoizedState),(Z=Nr||xy(o,l,Z,h,ae,se,N))?(pe||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=se),w.props=h,w.state=se,w.context=N,h=Z):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{w=o.stateNode,zf(s,o),N=o.memoizedProps,pe=Ya(l,N),w.props=pe,ve=o.pendingProps,ae=w.context,se=l.contextType,Z=Vo,typeof se=="object"&&se!==null&&(Z=Gn(se)),D=l.getDerivedStateFromProps,(se=typeof D=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(N!==ve||ae!==Z)&&wy(o,w,h,Z),Nr=!1,ae=o.memoizedState,w.state=ae,Zu(o,h,w,T),ju();var ce=o.memoizedState;N!==ve||ae!==ce||Nr||s!==null&&s.dependencies!==null&&ld(s.dependencies)?(typeof D=="function"&&(lm(o,l,D,h),ce=o.memoizedState),(pe=Nr||xy(o,l,pe,h,ae,ce,Z)||s!==null&&s.dependencies!==null&&ld(s.dependencies))?(se||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,ce,Z),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,ce,Z)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&ae===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ae===s.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=ce),w.props=h,w.state=ce,w.context=Z,h=pe):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&ae===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ae===s.memoizedState||(o.flags|=1024),h=!1)}return w=h,bd(s,o),h=(o.flags&128)!==0,w||h?(w=o.stateNode,l=h&&typeof l.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,s!==null&&h?(o.child=Za(o,s.child,null,T),o.child=Za(o,null,l,T)):jn(s,o,l,T),o.memoizedState=w.state,s=o.child):s=qo(s,o,T),s}function Uy(s,o,l,h){return Uo(),o.flags|=256,jn(s,o,l,h),o.child}var fm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function mm(s){return{baseLanes:s,cachePool:b_()}}function pm(s,o,l){return s=s!==null?s.childLanes&~l:0,o&&(s|=$i),s}function zy(s,o,l){var h=o.pendingProps,T=!1,w=(o.flags&128)!==0,N;if((N=w)||(N=s!==null&&s.memoizedState===null?!1:(fn.current&2)!==0),N&&(T=!0,o.flags&=-129),N=(o.flags&32)!==0,o.flags&=-33,s===null){if(dt){if(T?Pr(o):Dr(),(s=bt)?(s=Kv(s,Ii),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:re!==null?{id:ye,overflow:Re}:null,retryLane:536870912,hydrationErrors:null},l=Vu(s),l.return=o,o.child=l,Ct=o,bt=null)):s=null,s===null)throw uo(o);return Qm(s)?o.lanes=32:o.lanes=536870912,null}var D=h.children;return h=h.fallback,T?(Dr(),T=o.mode,D=Id({mode:"hidden",children:D},T),h=Oo(h,T,l,null),D.return=o,h.return=o,D.sibling=h,o.child=D,h=o.child,h.memoizedState=mm(l),h.childLanes=pm(s,N,l),o.memoizedState=fm,Qu(null,h)):(Pr(o),gm(o,D))}var Z=s.memoizedState;if(Z!==null&&(D=Z.dehydrated,D!==null)){if(w)o.flags&256?(Pr(o),o.flags&=-257,o=_m(s,o,l)):o.memoizedState!==null?(Dr(),o.child=s.child,o.flags|=128,o=null):(Dr(),D=h.fallback,T=o.mode,h=Id({mode:"visible",children:h.children},T),D=Oo(D,T,l,null),D.flags|=2,h.return=o,D.return=o,h.sibling=D,o.child=h,Za(o,s.child,null,l),h=o.child,h.memoizedState=mm(l),h.childLanes=pm(s,N,l),o.memoizedState=fm,o=Qu(null,h));else if(Pr(o),Qm(D)){if(N=D.nextSibling&&D.nextSibling.dataset,N)var se=N.dgst;N=se,h=Error(i(419)),h.stack="",h.digest=N,Ba({value:h,source:null,stack:null}),o=_m(s,o,l)}else if(xn||Rl(s,o,l,!1),N=(l&s.childLanes)!==0,xn||N){if(N=Gt,N!==null&&(h=_a(N,l),h!==0&&h!==Z.retryLane))throw Z.retryLane=h,ys(s,h),Di(N,s,h),dm;Wm(D)||Od(),o=_m(s,o,l)}else Wm(D)?(o.flags|=192,o.child=s.child,o=null):(s=Z.treeContext,bt=Es(D.nextSibling),Ct=o,dt=!0,lo=null,Ii=!1,s!==null&&mi(o,s),o=gm(o,h.children),o.flags|=4096);return o}return T?(Dr(),D=h.fallback,T=o.mode,Z=s.child,se=Z.sibling,h=vs(Z,{mode:"hidden",children:h.children}),h.subtreeFlags=Z.subtreeFlags&65011712,se!==null?D=vs(se,D):(D=Oo(D,T,l,null),D.flags|=2),D.return=o,h.return=o,h.sibling=D,o.child=h,Qu(null,h),h=o.child,D=s.child.memoizedState,D===null?D=mm(l):(T=D.cachePool,T!==null?(Z=Tn._currentValue,T=T.parent!==Z?{parent:Z,pool:Z}:T):T=b_(),D={baseLanes:D.baseLanes|l,cachePool:T}),h.memoizedState=D,h.childLanes=pm(s,N,l),o.memoizedState=fm,Qu(s.child,h)):(Pr(o),l=s.child,s=l.sibling,l=vs(l,{mode:"visible",children:h.children}),l.return=o,l.sibling=null,s!==null&&(N=o.deletions,N===null?(o.deletions=[s],o.flags|=16):N.push(s)),o.child=l,o.memoizedState=null,l)}function gm(s,o){return o=Id({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Id(s,o){return s=ti(22,s,null,o),s.lanes=0,s}function _m(s,o,l){return Za(o,s.child,null,l),s=gm(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function By(s,o,l){s.lanes|=o;var h=s.alternate;h!==null&&(h.lanes|=o),Pf(s.return,o,l)}function ym(s,o,l,h,T,w){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:T,treeForkCount:w}:(N.isBackwards=o,N.rendering=null,N.renderingStartTime=0,N.last=h,N.tail=l,N.tailMode=T,N.treeForkCount=w)}function Fy(s,o,l){var h=o.pendingProps,T=h.revealOrder,w=h.tail;h=h.children;var N=fn.current,D=(N&2)!==0;if(D?(N=N&1|2,o.flags|=128):N&=1,Ce(fn,N),jn(s,o,h,l),h=dt?P:0,!D&&s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&By(s,l,o);else if(s.tag===19)By(s,l,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(T){case"forwards":for(l=o.child,T=null;l!==null;)s=l.alternate,s!==null&&gd(s)===null&&(T=l),l=l.sibling;l=T,l===null?(T=o.child,o.child=null):(T=l.sibling,l.sibling=null),ym(o,!1,T,l,w,h);break;case"backwards":case"unstable_legacy-backwards":for(l=null,T=o.child,o.child=null;T!==null;){if(s=T.alternate,s!==null&&gd(s)===null){o.child=T;break}s=T.sibling,T.sibling=l,l=T,T=s}ym(o,!0,l,null,w,h);break;case"together":ym(o,!1,null,null,void 0,h);break;default:o.memoizedState=null}return o.child}function qo(s,o,l){if(s!==null&&(o.dependencies=s.dependencies),Vr|=o.lanes,(l&o.childLanes)===0)if(s!==null){if(Rl(s,o,l,!1),(l&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(i(153));if(o.child!==null){for(s=o.child,l=vs(s,s.pendingProps),o.child=l,l.return=o;s.sibling!==null;)s=s.sibling,l=l.sibling=vs(s,s.pendingProps),l.return=o;l.sibling=null}return o.child}function vm(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&ld(s)))}function g1(s,o,l){switch(o.tag){case 3:Me(o,o.stateNode.containerInfo),Ir(o,Tn,s.memoizedState.cache),Uo();break;case 27:case 5:it(o);break;case 4:Me(o,o.stateNode.containerInfo);break;case 10:Ir(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Gf(o),null;break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(Pr(o),o.flags|=128,null):(l&o.child.childLanes)!==0?zy(s,o,l):(Pr(o),s=qo(s,o,l),s!==null?s.sibling:null);Pr(o);break;case 19:var T=(s.flags&128)!==0;if(h=(l&o.childLanes)!==0,h||(Rl(s,o,l,!1),h=(l&o.childLanes)!==0),T){if(h)return Fy(s,o,l);o.flags|=128}if(T=o.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),Ce(fn,fn.current),h)break;return null;case 22:return o.lanes=0,Dy(s,o,l,o.pendingProps);case 24:Ir(o,Tn,s.memoizedState.cache)}return qo(s,o,l)}function qy(s,o,l){if(s!==null)if(s.memoizedProps!==o.pendingProps)xn=!0;else{if(!vm(s,l)&&(o.flags&128)===0)return xn=!1,g1(s,o,l);xn=(s.flags&131072)!==0}else xn=!1,dt&&(o.flags&1048576)!==0&&ot(o,P,o.index);switch(o.lanes=0,o.tag){case 16:e:{var h=o.pendingProps;if(s=Ga(o.elementType),o.type=s,typeof s=="function")bl(s)?(h=Ya(s,h),o.tag=1,o=Oy(null,o,s,h,l)):(o.tag=0,o=hm(null,o,s,h,l));else{if(s!=null){var T=s.$$typeof;if(T===me){o.tag=11,o=Ry(null,o,s,h,l);break e}else if(T===V){o.tag=14,o=My(null,o,s,h,l);break e}}throw o=Ke(s)||s,Error(i(306,o,""))}}return o;case 0:return hm(s,o,o.type,o.pendingProps,l);case 1:return h=o.type,T=Ya(h,o.pendingProps),Oy(s,o,h,T,l);case 3:e:{if(Me(o,o.stateNode.containerInfo),s===null)throw Error(i(387));h=o.pendingProps;var w=o.memoizedState;T=w.element,zf(s,o),Zu(o,h,null,l);var N=o.memoizedState;if(h=N.cache,Ir(o,Tn,h),h!==w.cache&&Df(o,[Tn],l,!0),ju(),h=N.element,w.isDehydrated)if(w={element:h,isDehydrated:!1,cache:N.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=Uy(s,o,h,l);break e}else if(h!==T){T=d(Error(i(424)),o),Ba(T),o=Uy(s,o,h,l);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(bt=Es(s.firstChild),Ct=o,dt=!0,lo=null,Ii=!0,l=D_(o,null,h,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Uo(),h===T){o=qo(s,o,l);break e}jn(s,o,h,l)}o=o.child}return o;case 26:return bd(s,o),s===null?(l=$v(o.type,null,o.pendingProps,null))?o.memoizedState=l:dt||(l=o.type,s=o.pendingProps,h=Gd(Se.current).createElement(l),h[sn]=o,h[an]=s,Zn(h,l,s),ln(h),o.stateNode=h):o.memoizedState=$v(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return it(o),s===null&&dt&&(h=o.stateNode=Wv(o.type,o.pendingProps,Se.current),Ct=o,Ii=!0,T=bt,Fr(o.type)?(Xm=T,bt=Es(h.firstChild)):bt=T),jn(s,o,o.pendingProps.children,l),bd(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&dt&&((T=h=bt)&&(h=Z1(h,o.type,o.pendingProps,Ii),h!==null?(o.stateNode=h,Ct=o,bt=Es(h.firstChild),Ii=!1,T=!0):T=!1),T||uo(o)),it(o),T=o.type,w=o.pendingProps,N=s!==null?s.memoizedProps:null,h=w.children,Km(T,w)?h=null:N!==null&&Km(T,N)&&(o.flags|=32),o.memoizedState!==null&&(T=Zf(s,o,a1,null,null,l),hc._currentValue=T),bd(s,o),jn(s,o,h,l),o.child;case 6:return s===null&&dt&&((s=l=bt)&&(l=K1(l,o.pendingProps,Ii),l!==null?(o.stateNode=l,Ct=o,bt=null,s=!0):s=!1),s||uo(o)),null;case 13:return zy(s,o,l);case 4:return Me(o,o.stateNode.containerInfo),h=o.pendingProps,s===null?o.child=Za(o,null,h,l):jn(s,o,h,l),o.child;case 11:return Ry(s,o,o.type,o.pendingProps,l);case 7:return jn(s,o,o.pendingProps,l),o.child;case 8:return jn(s,o,o.pendingProps.children,l),o.child;case 12:return jn(s,o,o.pendingProps.children,l),o.child;case 10:return h=o.pendingProps,Ir(o,o.type,h.value),jn(s,o,h.children,l),o.child;case 9:return T=o.type._context,h=o.pendingProps.children,qa(o),T=Gn(T),h=h(T),o.flags|=1,jn(s,o,h,l),o.child;case 14:return My(s,o,o.type,o.pendingProps,l);case 15:return Py(s,o,o.type,o.pendingProps,l);case 19:return Fy(s,o,l);case 31:return p1(s,o,l);case 22:return Dy(s,o,l,o.pendingProps);case 24:return qa(o),h=Gn(Tn),s===null?(T=Vf(),T===null&&(T=Gt,w=kf(),T.pooledCache=w,w.refCount++,w!==null&&(T.pooledCacheLanes|=l),T=w),o.memoizedState={parent:h,cache:T},Uf(o),Ir(o,Tn,T)):((s.lanes&l)!==0&&(zf(s,o),Zu(o,null,null,l),ju()),T=s.memoizedState,w=o.memoizedState,T.parent!==h?(T={parent:h,cache:h},o.memoizedState=T,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=T),Ir(o,Tn,h)):(h=w.cache,Ir(o,Tn,h),h!==T.cache&&Df(o,[Tn],l,!0))),jn(s,o,o.pendingProps.children,l),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function Ho(s){s.flags|=4}function Tm(s,o,l,h,T){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(T&335544128)===T)if(s.stateNode.complete)s.flags|=8192;else if(pv())s.flags|=8192;else throw ja=hd,Of}else s.flags&=-16777217}function Hy(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!s0(o))if(pv())s.flags|=8192;else throw ja=hd,Of}function Nd(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?fl():536870912,s.lanes|=o,ql|=o)}function Xu(s,o){if(!dt)switch(s.tailMode){case"hidden":o=s.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function Qt(s){var o=s.alternate!==null&&s.alternate.child===s.child,l=0,h=0;if(o)for(var T=s.child;T!==null;)l|=T.lanes|T.childLanes,h|=T.subtreeFlags&65011712,h|=T.flags&65011712,T.return=s,T=T.sibling;else for(T=s.child;T!==null;)l|=T.lanes|T.childLanes,h|=T.subtreeFlags,h|=T.flags,T.return=s,T=T.sibling;return s.subtreeFlags|=h,s.childLanes=l,o}function _1(s,o,l){var h=o.pendingProps;switch(un(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(o),null;case 1:return Qt(o),null;case 3:return l=o.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),zo(Tn),ke(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Os(o)?Ho(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,zu())),Qt(o),null;case 26:var T=o.type,w=o.memoizedState;return s===null?(Ho(o),w!==null?(Qt(o),Hy(o,w)):(Qt(o),Tm(o,T,null,h,l))):w?w!==s.memoizedState?(Ho(o),Qt(o),Hy(o,w)):(Qt(o),o.flags&=-16777217):(s=s.memoizedProps,s!==h&&Ho(o),Qt(o),Tm(o,T,s,h,l)),null;case 27:if(ut(o),l=Se.current,T=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==h&&Ho(o);else{if(!h){if(o.stateNode===null)throw Error(i(166));return Qt(o),null}s=ue.current,Os(o)?Uu(o):(s=Wv(T,h,l),o.stateNode=s,Ho(o))}return Qt(o),null;case 5:if(ut(o),T=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==h&&Ho(o);else{if(!h){if(o.stateNode===null)throw Error(i(166));return Qt(o),null}if(w=ue.current,Os(o))Uu(o);else{var N=Gd(Se.current);switch(w){case 1:w=N.createElementNS("http://www.w3.org/2000/svg",T);break;case 2:w=N.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;default:switch(T){case"svg":w=N.createElementNS("http://www.w3.org/2000/svg",T);break;case"math":w=N.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;case"script":w=N.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof h.is=="string"?N.createElement("select",{is:h.is}):N.createElement("select"),h.multiple?w.multiple=!0:h.size&&(w.size=h.size);break;default:w=typeof h.is=="string"?N.createElement(T,{is:h.is}):N.createElement(T)}}w[sn]=o,w[an]=h;e:for(N=o.child;N!==null;){if(N.tag===5||N.tag===6)w.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===o)break e;for(;N.sibling===null;){if(N.return===null||N.return===o)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}o.stateNode=w;e:switch(Zn(w,T,h),T){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Ho(o)}}return Qt(o),Tm(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,l),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==h&&Ho(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(i(166));if(s=Se.current,Os(o)){if(s=o.stateNode,l=o.memoizedProps,h=null,T=Ct,T!==null)switch(T.tag){case 27:case 5:h=T.memoizedProps}s[sn]=o,s=!!(s.nodeValue===l||h!==null&&h.suppressHydrationWarning===!0||zv(s.nodeValue,l)),s||uo(o,!0)}else s=Gd(s).createTextNode(h),s[sn]=o,o.stateNode=s}return Qt(o),null;case 31:if(l=o.memoizedState,s===null||s.memoizedState!==null){if(h=Os(o),l!==null){if(s===null){if(!h)throw Error(i(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[sn]=o}else Uo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Qt(o),s=!1}else l=zu(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return o.flags&256?(Qi(o),o):(Qi(o),null);if((o.flags&128)!==0)throw Error(i(558))}return Qt(o),null;case 13:if(h=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(T=Os(o),h!==null&&h.dehydrated!==null){if(s===null){if(!T)throw Error(i(318));if(T=o.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(i(317));T[sn]=o}else Uo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Qt(o),T=!1}else T=zu(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=T),T=!0;if(!T)return o.flags&256?(Qi(o),o):(Qi(o),null)}return Qi(o),(o.flags&128)!==0?(o.lanes=l,o):(l=h!==null,s=s!==null&&s.memoizedState!==null,l&&(h=o.child,T=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(T=h.alternate.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==T&&(h.flags|=2048)),l!==s&&l&&(o.child.flags|=8192),Nd(o,o.updateQueue),Qt(o),null);case 4:return ke(),s===null&&qm(o.stateNode.containerInfo),Qt(o),null;case 10:return zo(o.type),Qt(o),null;case 19:if(he(fn),h=o.memoizedState,h===null)return Qt(o),null;if(T=(o.flags&128)!==0,w=h.rendering,w===null)if(T)Xu(h,!1);else{if(dn!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(w=gd(s),w!==null){for(o.flags|=128,Xu(h,!1),s=w.updateQueue,o.updateQueue=s,Nd(o,s),o.subtreeFlags=0,s=l,l=o.child;l!==null;)Lu(l,s),l=l.sibling;return Ce(fn,fn.current&1|2),dt&&Be(o,h.treeForkCount),o.child}s=s.sibling}h.tail!==null&&pt()>kd&&(o.flags|=128,T=!0,Xu(h,!1),o.lanes=4194304)}else{if(!T)if(s=gd(w),s!==null){if(o.flags|=128,T=!0,s=s.updateQueue,o.updateQueue=s,Nd(o,s),Xu(h,!0),h.tail===null&&h.tailMode==="hidden"&&!w.alternate&&!dt)return Qt(o),null}else 2*pt()-h.renderingStartTime>kd&&l!==536870912&&(o.flags|=128,T=!0,Xu(h,!1),o.lanes=4194304);h.isBackwards?(w.sibling=o.child,o.child=w):(s=h.last,s!==null?s.sibling=w:o.child=w,h.last=w)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=pt(),s.sibling=null,l=fn.current,Ce(fn,T?l&1|2:l&1),dt&&Be(o,h.treeForkCount),s):(Qt(o),null);case 22:case 23:return Qi(o),Hf(),h=o.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(l&536870912)!==0&&(o.flags&128)===0&&(Qt(o),o.subtreeFlags&6&&(o.flags|=8192)):Qt(o),l=o.updateQueue,l!==null&&Nd(o,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==l&&(o.flags|=2048),s!==null&&he(Ha),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),o.memoizedState.cache!==l&&(o.flags|=2048),zo(Tn),Qt(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function y1(s,o){switch(un(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return zo(Tn),ke(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return ut(o),null;case 31:if(o.memoizedState!==null){if(Qi(o),o.alternate===null)throw Error(i(340));Uo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(Qi(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(i(340));Uo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return he(fn),null;case 4:return ke(),null;case 10:return zo(o.type),null;case 22:case 23:return Qi(o),Hf(),s!==null&&he(Ha),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return zo(Tn),null;case 25:return null;default:return null}}function Gy(s,o){switch(un(o),o.tag){case 3:zo(Tn),ke();break;case 26:case 27:case 5:ut(o);break;case 4:ke();break;case 31:o.memoizedState!==null&&Qi(o);break;case 13:Qi(o);break;case 19:he(fn);break;case 10:zo(o.type);break;case 22:case 23:Qi(o),Hf(),s!==null&&he(Ha);break;case 24:zo(Tn)}}function $u(s,o){try{var l=o.updateQueue,h=l!==null?l.lastEffect:null;if(h!==null){var T=h.next;l=T;do{if((l.tag&s)===s){h=void 0;var w=l.create,N=l.inst;h=w(),N.destroy=h}l=l.next}while(l!==T)}}catch(D){Vt(o,o.return,D)}}function kr(s,o,l){try{var h=o.updateQueue,T=h!==null?h.lastEffect:null;if(T!==null){var w=T.next;h=w;do{if((h.tag&s)===s){var N=h.inst,D=N.destroy;if(D!==void 0){N.destroy=void 0,T=o;var Z=l,se=D;try{se()}catch(pe){Vt(T,Z,pe)}}}h=h.next}while(h!==w)}}catch(pe){Vt(o,o.return,pe)}}function jy(s){var o=s.updateQueue;if(o!==null){var l=s.stateNode;try{L_(o,l)}catch(h){Vt(s,s.return,h)}}}function Zy(s,o,l){l.props=Ya(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(h){Vt(s,o,h)}}function ec(s,o){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof l=="function"?s.refCleanup=l(h):l.current=h}}catch(T){Vt(s,o,T)}}function ho(s,o){var l=s.ref,h=s.refCleanup;if(l!==null)if(typeof h=="function")try{h()}catch(T){Vt(s,o,T)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(T){Vt(s,o,T)}else l.current=null}function Ky(s){var o=s.type,l=s.memoizedProps,h=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":l.autoFocus&&h.focus();break e;case"img":l.src?h.src=l.src:l.srcSet&&(h.srcset=l.srcSet)}}catch(T){Vt(s,s.return,T)}}function Em(s,o,l){try{var h=s.stateNode;B1(h,s.type,l,o),h[an]=o}catch(T){Vt(s,s.return,T)}}function Yy(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Fr(s.type)||s.tag===4}function xm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Yy(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Fr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function wm(s,o,l){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,o):(o=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,o.appendChild(s),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=Wn));else if(h!==4&&(h===27&&Fr(s.type)&&(l=s.stateNode,o=null),s=s.child,s!==null))for(wm(s,o,l),s=s.sibling;s!==null;)wm(s,o,l),s=s.sibling}function Rd(s,o,l){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?l.insertBefore(s,o):l.appendChild(s);else if(h!==4&&(h===27&&Fr(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Rd(s,o,l),s=s.sibling;s!==null;)Rd(s,o,l),s=s.sibling}function Jy(s){var o=s.stateNode,l=s.memoizedProps;try{for(var h=s.type,T=o.attributes;T.length;)o.removeAttributeNode(T[0]);Zn(o,h,l),o[sn]=s,o[an]=l}catch(w){Vt(s,s.return,w)}}var Go=!1,wn=!1,Sm=!1,Wy=typeof WeakSet=="function"?WeakSet:Set,Fn=null;function v1(s,o){if(s=s.containerInfo,jm=Qd,s=Pa(s),io(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var T=h.anchorOffset,w=h.focusNode;h=h.focusOffset;try{l.nodeType,w.nodeType}catch{l=null;break e}var N=0,D=-1,Z=-1,se=0,pe=0,ve=s,ae=null;t:for(;;){for(var ce;ve!==l||T!==0&&ve.nodeType!==3||(D=N+T),ve!==w||h!==0&&ve.nodeType!==3||(Z=N+h),ve.nodeType===3&&(N+=ve.nodeValue.length),(ce=ve.firstChild)!==null;)ae=ve,ve=ce;for(;;){if(ve===s)break t;if(ae===l&&++se===T&&(D=N),ae===w&&++pe===h&&(Z=N),(ce=ve.nextSibling)!==null)break;ve=ae,ae=ve.parentNode}ve=ce}l=D===-1||Z===-1?null:{start:D,end:Z}}else l=null}l=l||{start:0,end:0}}else l=null;for(Zm={focusedElem:s,selectionRange:l},Qd=!1,Fn=o;Fn!==null;)if(o=Fn,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,Fn=s;else for(;Fn!==null;){switch(o=Fn,w=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)T=s[l],T.ref.impl=T.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&w!==null){s=void 0,l=o,T=w.memoizedProps,w=w.memoizedState,h=l.stateNode;try{var Ue=Ya(l.type,T);s=h.getSnapshotBeforeUpdate(Ue,w),h.__reactInternalSnapshotBeforeUpdate=s}catch(Ze){Vt(l,l.return,Ze)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,l=s.nodeType,l===9)Jm(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Jm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=o.sibling,s!==null){s.return=o.return,Fn=s;break}Fn=o.return}}function Qy(s,o,l){var h=l.flags;switch(l.tag){case 0:case 11:case 15:Zo(s,l),h&4&&$u(5,l);break;case 1:if(Zo(s,l),h&4)if(s=l.stateNode,o===null)try{s.componentDidMount()}catch(N){Vt(l,l.return,N)}else{var T=Ya(l.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(T,o,s.__reactInternalSnapshotBeforeUpdate)}catch(N){Vt(l,l.return,N)}}h&64&&jy(l),h&512&&ec(l,l.return);break;case 3:if(Zo(s,l),h&64&&(s=l.updateQueue,s!==null)){if(o=null,l.child!==null)switch(l.child.tag){case 27:case 5:o=l.child.stateNode;break;case 1:o=l.child.stateNode}try{L_(s,o)}catch(N){Vt(l,l.return,N)}}break;case 27:o===null&&h&4&&Jy(l);case 26:case 5:Zo(s,l),o===null&&h&4&&Ky(l),h&512&&ec(l,l.return);break;case 12:Zo(s,l);break;case 31:Zo(s,l),h&4&&ev(s,l);break;case 13:Zo(s,l),h&4&&tv(s,l),h&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=I1.bind(null,l),Y1(s,l))));break;case 22:if(h=l.memoizedState!==null||Go,!h){o=o!==null&&o.memoizedState!==null||wn,T=Go;var w=wn;Go=h,(wn=o)&&!w?Ko(s,l,(l.subtreeFlags&8772)!==0):Zo(s,l),Go=T,wn=w}break;case 30:break;default:Zo(s,l)}}function Xy(s){var o=s.alternate;o!==null&&(s.alternate=null,Xy(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&cr(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var en=null,Ni=!1;function jo(s,o,l){for(l=l.child;l!==null;)$y(s,o,l),l=l.sibling}function $y(s,o,l){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(gi,l)}catch{}switch(l.tag){case 26:wn||ho(l,o),jo(s,o,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:wn||ho(l,o);var h=en,T=Ni;Fr(l.type)&&(en=l.stateNode,Ni=!1),jo(s,o,l),uc(l.stateNode),en=h,Ni=T;break;case 5:wn||ho(l,o);case 6:if(h=en,T=Ni,en=null,jo(s,o,l),en=h,Ni=T,en!==null)if(Ni)try{(en.nodeType===9?en.body:en.nodeName==="HTML"?en.ownerDocument.body:en).removeChild(l.stateNode)}catch(w){Vt(l,o,w)}else try{en.removeChild(l.stateNode)}catch(w){Vt(l,o,w)}break;case 18:en!==null&&(Ni?(s=en,jv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Wl(s)):jv(en,l.stateNode));break;case 4:h=en,T=Ni,en=l.stateNode.containerInfo,Ni=!0,jo(s,o,l),en=h,Ni=T;break;case 0:case 11:case 14:case 15:kr(2,l,o),wn||kr(4,l,o),jo(s,o,l);break;case 1:wn||(ho(l,o),h=l.stateNode,typeof h.componentWillUnmount=="function"&&Zy(l,o,h)),jo(s,o,l);break;case 21:jo(s,o,l);break;case 22:wn=(h=wn)||l.memoizedState!==null,jo(s,o,l),wn=h;break;default:jo(s,o,l)}}function ev(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Wl(s)}catch(l){Vt(o,o.return,l)}}}function tv(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Wl(s)}catch(l){Vt(o,o.return,l)}}function T1(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new Wy),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new Wy),o;default:throw Error(i(435,s.tag))}}function Md(s,o){var l=T1(s);o.forEach(function(h){if(!l.has(h)){l.add(h);var T=N1.bind(null,s,h);h.then(T,T)}})}function Ri(s,o){var l=o.deletions;if(l!==null)for(var h=0;h<l.length;h++){var T=l[h],w=s,N=o,D=N;e:for(;D!==null;){switch(D.tag){case 27:if(Fr(D.type)){en=D.stateNode,Ni=!1;break e}break;case 5:en=D.stateNode,Ni=!1;break e;case 3:case 4:en=D.stateNode.containerInfo,Ni=!0;break e}D=D.return}if(en===null)throw Error(i(160));$y(w,N,T),en=null,Ni=!1,w=T.alternate,w!==null&&(w.return=null),T.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)nv(o,s),o=o.sibling}var zs=null;function nv(s,o){var l=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ri(o,s),Mi(s),h&4&&(kr(3,s,s.return),$u(3,s),kr(5,s,s.return));break;case 1:Ri(o,s),Mi(s),h&512&&(wn||l===null||ho(l,l.return)),h&64&&Go&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?h:l.concat(h))));break;case 26:var T=zs;if(Ri(o,s),Mi(s),h&512&&(wn||l===null||ho(l,l.return)),h&4){var w=l!==null?l.memoizedState:null;if(h=s.memoizedState,l===null)if(h===null)if(s.stateNode===null){e:{h=s.type,l=s.memoizedProps,T=T.ownerDocument||T;t:switch(h){case"title":w=T.getElementsByTagName("title")[0],(!w||w[as]||w[sn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=T.createElement(h),T.head.insertBefore(w,T.querySelector("head > title"))),Zn(w,h,l),w[sn]=s,ln(w),h=w;break e;case"link":var N=n0("link","href",T).get(h+(l.href||""));if(N){for(var D=0;D<N.length;D++)if(w=N[D],w.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&w.getAttribute("rel")===(l.rel==null?null:l.rel)&&w.getAttribute("title")===(l.title==null?null:l.title)&&w.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){N.splice(D,1);break t}}w=T.createElement(h),Zn(w,h,l),T.head.appendChild(w);break;case"meta":if(N=n0("meta","content",T).get(h+(l.content||""))){for(D=0;D<N.length;D++)if(w=N[D],w.getAttribute("content")===(l.content==null?null:""+l.content)&&w.getAttribute("name")===(l.name==null?null:l.name)&&w.getAttribute("property")===(l.property==null?null:l.property)&&w.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&w.getAttribute("charset")===(l.charSet==null?null:l.charSet)){N.splice(D,1);break t}}w=T.createElement(h),Zn(w,h,l),T.head.appendChild(w);break;default:throw Error(i(468,h))}w[sn]=s,ln(w),h=w}s.stateNode=h}else i0(T,s.type,s.stateNode);else s.stateNode=t0(T,h,s.memoizedProps);else w!==h?(w===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):w.count--,h===null?i0(T,s.type,s.stateNode):t0(T,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Em(s,s.memoizedProps,l.memoizedProps)}break;case 27:Ri(o,s),Mi(s),h&512&&(wn||l===null||ho(l,l.return)),l!==null&&h&4&&Em(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Ri(o,s),Mi(s),h&512&&(wn||l===null||ho(l,l.return)),s.flags&32){T=s.stateNode;try{yn(T,"")}catch(Ue){Vt(s,s.return,Ue)}}h&4&&s.stateNode!=null&&(T=s.memoizedProps,Em(s,T,l!==null?l.memoizedProps:T)),h&1024&&(Sm=!0);break;case 6:if(Ri(o,s),Mi(s),h&4){if(s.stateNode===null)throw Error(i(162));h=s.memoizedProps,l=s.stateNode;try{l.nodeValue=h}catch(Ue){Vt(s,s.return,Ue)}}break;case 3:if(Kd=null,T=zs,zs=jd(o.containerInfo),Ri(o,s),zs=T,Mi(s),h&4&&l!==null&&l.memoizedState.isDehydrated)try{Wl(o.containerInfo)}catch(Ue){Vt(s,s.return,Ue)}Sm&&(Sm=!1,iv(s));break;case 4:h=zs,zs=jd(s.stateNode.containerInfo),Ri(o,s),Mi(s),zs=h;break;case 12:Ri(o,s),Mi(s);break;case 31:Ri(o,s),Mi(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Md(s,h)));break;case 13:Ri(o,s),Mi(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Dd=pt()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Md(s,h)));break;case 22:T=s.memoizedState!==null;var Z=l!==null&&l.memoizedState!==null,se=Go,pe=wn;if(Go=se||T,wn=pe||Z,Ri(o,s),wn=pe,Go=se,Mi(s),h&8192)e:for(o=s.stateNode,o._visibility=T?o._visibility&-2:o._visibility|1,T&&(l===null||Z||Go||wn||Ja(s)),l=null,o=s;;){if(o.tag===5||o.tag===26){if(l===null){Z=l=o;try{if(w=Z.stateNode,T)N=w.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{D=Z.stateNode;var ve=Z.memoizedProps.style,ae=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;D.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(Ue){Vt(Z,Z.return,Ue)}}}else if(o.tag===6){if(l===null){Z=o;try{Z.stateNode.nodeValue=T?"":Z.memoizedProps}catch(Ue){Vt(Z,Z.return,Ue)}}}else if(o.tag===18){if(l===null){Z=o;try{var ce=Z.stateNode;T?Zv(ce,!0):Zv(Z.stateNode,!1)}catch(Ue){Vt(Z,Z.return,Ue)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;l===o&&(l=null),o=o.return}l===o&&(l=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=s.updateQueue,h!==null&&(l=h.retryQueue,l!==null&&(h.retryQueue=null,Md(s,l))));break;case 19:Ri(o,s),Mi(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Md(s,h)));break;case 30:break;case 21:break;default:Ri(o,s),Mi(s)}}function Mi(s){var o=s.flags;if(o&2){try{for(var l,h=s.return;h!==null;){if(Yy(h)){l=h;break}h=h.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var T=l.stateNode,w=xm(s);Rd(s,w,T);break;case 5:var N=l.stateNode;l.flags&32&&(yn(N,""),l.flags&=-33);var D=xm(s);Rd(s,D,N);break;case 3:case 4:var Z=l.stateNode.containerInfo,se=xm(s);wm(s,se,Z);break;default:throw Error(i(161))}}catch(pe){Vt(s,s.return,pe)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function iv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;iv(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Zo(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Qy(s,o.alternate,o),o=o.sibling}function Ja(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:kr(4,o,o.return),Ja(o);break;case 1:ho(o,o.return);var l=o.stateNode;typeof l.componentWillUnmount=="function"&&Zy(o,o.return,l),Ja(o);break;case 27:uc(o.stateNode);case 26:case 5:ho(o,o.return),Ja(o);break;case 22:o.memoizedState===null&&Ja(o);break;case 30:Ja(o);break;default:Ja(o)}s=s.sibling}}function Ko(s,o,l){for(l=l&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,T=s,w=o,N=w.flags;switch(w.tag){case 0:case 11:case 15:Ko(T,w,l),$u(4,w);break;case 1:if(Ko(T,w,l),h=w,T=h.stateNode,typeof T.componentDidMount=="function")try{T.componentDidMount()}catch(se){Vt(h,h.return,se)}if(h=w,T=h.updateQueue,T!==null){var D=h.stateNode;try{var Z=T.shared.hiddenCallbacks;if(Z!==null)for(T.shared.hiddenCallbacks=null,T=0;T<Z.length;T++)k_(Z[T],D)}catch(se){Vt(h,h.return,se)}}l&&N&64&&jy(w),ec(w,w.return);break;case 27:Jy(w);case 26:case 5:Ko(T,w,l),l&&h===null&&N&4&&Ky(w),ec(w,w.return);break;case 12:Ko(T,w,l);break;case 31:Ko(T,w,l),l&&N&4&&ev(T,w);break;case 13:Ko(T,w,l),l&&N&4&&tv(T,w);break;case 22:w.memoizedState===null&&Ko(T,w,l),ec(w,w.return);break;case 30:break;default:Ko(T,w,l)}o=o.sibling}}function Am(s,o){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Bu(l))}function Cm(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Bu(s))}function Bs(s,o,l,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)sv(s,o,l,h),o=o.sibling}function sv(s,o,l,h){var T=o.flags;switch(o.tag){case 0:case 11:case 15:Bs(s,o,l,h),T&2048&&$u(9,o);break;case 1:Bs(s,o,l,h);break;case 3:Bs(s,o,l,h),T&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Bu(s)));break;case 12:if(T&2048){Bs(s,o,l,h),s=o.stateNode;try{var w=o.memoizedProps,N=w.id,D=w.onPostCommit;typeof D=="function"&&D(N,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Z){Vt(o,o.return,Z)}}else Bs(s,o,l,h);break;case 31:Bs(s,o,l,h);break;case 13:Bs(s,o,l,h);break;case 23:break;case 22:w=o.stateNode,N=o.alternate,o.memoizedState!==null?w._visibility&2?Bs(s,o,l,h):tc(s,o):w._visibility&2?Bs(s,o,l,h):(w._visibility|=2,zl(s,o,l,h,(o.subtreeFlags&10256)!==0||!1)),T&2048&&Am(N,o);break;case 24:Bs(s,o,l,h),T&2048&&Cm(o.alternate,o);break;default:Bs(s,o,l,h)}}function zl(s,o,l,h,T){for(T=T&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var w=s,N=o,D=l,Z=h,se=N.flags;switch(N.tag){case 0:case 11:case 15:zl(w,N,D,Z,T),$u(8,N);break;case 23:break;case 22:var pe=N.stateNode;N.memoizedState!==null?pe._visibility&2?zl(w,N,D,Z,T):tc(w,N):(pe._visibility|=2,zl(w,N,D,Z,T)),T&&se&2048&&Am(N.alternate,N);break;case 24:zl(w,N,D,Z,T),T&&se&2048&&Cm(N.alternate,N);break;default:zl(w,N,D,Z,T)}o=o.sibling}}function tc(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var l=s,h=o,T=h.flags;switch(h.tag){case 22:tc(l,h),T&2048&&Am(h.alternate,h);break;case 24:tc(l,h),T&2048&&Cm(h.alternate,h);break;default:tc(l,h)}o=o.sibling}}var nc=8192;function Bl(s,o,l){if(s.subtreeFlags&nc)for(s=s.child;s!==null;)ov(s,o,l),s=s.sibling}function ov(s,o,l){switch(s.tag){case 26:Bl(s,o,l),s.flags&nc&&s.memoizedState!==null&&rC(l,zs,s.memoizedState,s.memoizedProps);break;case 5:Bl(s,o,l);break;case 3:case 4:var h=zs;zs=jd(s.stateNode.containerInfo),Bl(s,o,l),zs=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=nc,nc=16777216,Bl(s,o,l),nc=h):Bl(s,o,l));break;default:Bl(s,o,l)}}function rv(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function ic(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var l=0;l<o.length;l++){var h=o[l];Fn=h,lv(h,s)}rv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)av(s),s=s.sibling}function av(s){switch(s.tag){case 0:case 11:case 15:ic(s),s.flags&2048&&kr(9,s,s.return);break;case 3:ic(s);break;case 12:ic(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Pd(s)):ic(s);break;default:ic(s)}}function Pd(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var l=0;l<o.length;l++){var h=o[l];Fn=h,lv(h,s)}rv(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:kr(8,o,o.return),Pd(o);break;case 22:l=o.stateNode,l._visibility&2&&(l._visibility&=-3,Pd(o));break;default:Pd(o)}s=s.sibling}}function lv(s,o){for(;Fn!==null;){var l=Fn;switch(l.tag){case 0:case 11:case 15:kr(8,l,o);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var h=l.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Bu(l.memoizedState.cache)}if(h=l.child,h!==null)h.return=l,Fn=h;else e:for(l=s;Fn!==null;){h=Fn;var T=h.sibling,w=h.return;if(Xy(h),h===l){Fn=null;break e}if(T!==null){T.return=w,Fn=T;break e}Fn=w}}}var E1={getCacheForType:function(s){var o=Gn(Tn),l=o.data.get(s);return l===void 0&&(l=s(),o.data.set(s,l)),l},cacheSignal:function(){return Gn(Tn).controller.signal}},x1=typeof WeakMap=="function"?WeakMap:Map,Mt=0,Gt=null,ht=null,_t=0,Lt=0,Xi=null,Lr=!1,Fl=!1,bm=!1,Yo=0,dn=0,Vr=0,Wa=0,Im=0,$i=0,ql=0,sc=null,Pi=null,Nm=!1,Dd=0,uv=0,kd=1/0,Ld=null,Or=null,Pn=0,Ur=null,Hl=null,Jo=0,Rm=0,Mm=null,cv=null,oc=0,Pm=null;function es(){return(Mt&2)!==0&&_t!==0?_t&-_t:oe.T!==null?Um():ya()}function dv(){if($i===0)if((_t&536870912)===0||dt){var s=Js;Js<<=1,(Js&3932160)===0&&(Js=262144),$i=s}else $i=536870912;return s=Wi.current,s!==null&&(s.flags|=32),$i}function Di(s,o,l){(s===Gt&&(Lt===2||Lt===9)||s.cancelPendingCommit!==null)&&(Gl(s,0),zr(s,_t,$i,!1)),Cs(s,l),((Mt&2)===0||s!==Gt)&&(s===Gt&&((Mt&2)===0&&(Wa|=l),dn===4&&zr(s,_t,$i,!1)),fo(s))}function hv(s,o,l){if((Mt&6)!==0)throw Error(i(327));var h=!l&&(o&127)===0&&(o&s.expiredLanes)===0||Ui(s,o),T=h?A1(s,o):km(s,o,!0),w=h;do{if(T===0){Fl&&!h&&zr(s,o,0,!1);break}else{if(l=s.current.alternate,w&&!w1(l)){T=km(s,o,!1),w=!1;continue}if(T===2){if(w=o,s.errorRecoveryDisabledLanes&w)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){o=N;e:{var D=s;T=sc;var Z=D.current.memoizedState.isDehydrated;if(Z&&(Gl(D,N).flags|=256),N=km(D,N,!1),N!==2){if(bm&&!Z){D.errorRecoveryDisabledLanes|=w,Wa|=w,T=4;break e}w=Pi,Pi=T,w!==null&&(Pi===null?Pi=w:Pi.push.apply(Pi,w))}T=N}if(w=!1,T!==2)continue}}if(T===1){Gl(s,0),zr(s,o,0,!0);break}e:{switch(h=s,w=T,w){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:zr(h,o,$i,!Lr);break e;case 2:Pi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(T=Dd+300-pt(),10<T)){if(zr(h,o,$i,!Lr),os(h,0,!0)!==0)break e;Jo=o,h.timeoutHandle=Hv(fv.bind(null,h,l,Pi,Ld,Nm,o,$i,Wa,ql,Lr,w,"Throttled",-0,0),T);break e}fv(h,l,Pi,Ld,Nm,o,$i,Wa,ql,Lr,w,null,-0,0)}}break}while(!0);fo(s)}function fv(s,o,l,h,T,w,N,D,Z,se,pe,ve,ae,ce){if(s.timeoutHandle=-1,ve=o.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Wn},ov(o,w,ve);var Ue=(w&62914560)===w?Dd-pt():(w&4194048)===w?uv-pt():0;if(Ue=aC(ve,Ue),Ue!==null){Jo=w,s.cancelPendingCommit=Ue(Ev.bind(null,s,o,w,l,h,T,N,D,Z,pe,ve,null,ae,ce)),zr(s,w,N,!se);return}}Ev(s,o,w,l,h,T,N,D,Z)}function w1(s){for(var o=s;;){var l=o.tag;if((l===0||l===11||l===15)&&o.flags&16384&&(l=o.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var h=0;h<l.length;h++){var T=l[h],w=T.getSnapshot;T=T.value;try{if(!zn(w(),T))return!1}catch{return!1}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function zr(s,o,l,h){o&=~Im,o&=~Wa,s.suspendedLanes|=o,s.pingedLanes&=~o,h&&(s.warmLanes|=o),h=s.expirationTimes;for(var T=o;0<T;){var w=31-tn(T),N=1<<w;h[w]=-1,T&=~N}l!==0&&bo(s,l,o)}function Vd(){return(Mt&6)===0?(rc(0),!1):!0}function Dm(){if(ht!==null){if(Lt===0)var s=ht.return;else s=ht,Us=co=null,Jf(s),kl=null,qu=0,s=ht;for(;s!==null;)Gy(s.alternate,s),s=s.return;ht=null}}function Gl(s,o){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,H1(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Jo=0,Dm(),Gt=s,ht=l=vs(s.current,null),_t=o,Lt=0,Xi=null,Lr=!1,Fl=Ui(s,o),bm=!1,ql=$i=Im=Wa=Vr=dn=0,Pi=sc=null,Nm=!1,(o&8)!==0&&(o|=o&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=o;0<h;){var T=31-tn(h),w=1<<T;o|=s[T],h&=~w}return Yo=o,Oa(),l}function mv(s,o){st=null,oe.H=Wu,o===Dl||o===dd?(o=R_(),Lt=3):o===Of?(o=R_(),Lt=4):Lt=o===dm?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Xi=o,ht===null&&(dn=1,Ad(s,d(o,s.current)))}function pv(){var s=Wi.current;return s===null?!0:(_t&4194048)===_t?Ts===null:(_t&62914560)===_t||(_t&536870912)!==0?s===Ts:!1}function gv(){var s=oe.H;return oe.H=Wu,s===null?Wu:s}function _v(){var s=oe.A;return oe.A=E1,s}function Od(){dn=4,Lr||(_t&4194048)!==_t&&Wi.current!==null||(Fl=!0),(Vr&134217727)===0&&(Wa&134217727)===0||Gt===null||zr(Gt,_t,$i,!1)}function km(s,o,l){var h=Mt;Mt|=2;var T=gv(),w=_v();(Gt!==s||_t!==o)&&(Ld=null,Gl(s,o)),o=!1;var N=dn;e:do try{if(Lt!==0&&ht!==null){var D=ht,Z=Xi;switch(Lt){case 8:Dm(),N=6;break e;case 3:case 2:case 9:case 6:Wi.current===null&&(o=!0);var se=Lt;if(Lt=0,Xi=null,jl(s,D,Z,se),l&&Fl){N=0;break e}break;default:se=Lt,Lt=0,Xi=null,jl(s,D,Z,se)}}S1(),N=dn;break}catch(pe){mv(s,pe)}while(!0);return o&&s.shellSuspendCounter++,Us=co=null,Mt=h,oe.H=T,oe.A=w,ht===null&&(Gt=null,_t=0,Oa()),N}function S1(){for(;ht!==null;)yv(ht)}function A1(s,o){var l=Mt;Mt|=2;var h=gv(),T=_v();Gt!==s||_t!==o?(Ld=null,kd=pt()+500,Gl(s,o)):Fl=Ui(s,o);e:do try{if(Lt!==0&&ht!==null){o=ht;var w=Xi;t:switch(Lt){case 1:Lt=0,Xi=null,jl(s,o,w,1);break;case 2:case 9:if(I_(w)){Lt=0,Xi=null,vv(o);break}o=function(){Lt!==2&&Lt!==9||Gt!==s||(Lt=7),fo(s)},w.then(o,o);break e;case 3:Lt=7;break e;case 4:Lt=5;break e;case 7:I_(w)?(Lt=0,Xi=null,vv(o)):(Lt=0,Xi=null,jl(s,o,w,7));break;case 5:var N=null;switch(ht.tag){case 26:N=ht.memoizedState;case 5:case 27:var D=ht;if(N?s0(N):D.stateNode.complete){Lt=0,Xi=null;var Z=D.sibling;if(Z!==null)ht=Z;else{var se=D.return;se!==null?(ht=se,Ud(se)):ht=null}break t}}Lt=0,Xi=null,jl(s,o,w,5);break;case 6:Lt=0,Xi=null,jl(s,o,w,6);break;case 8:Dm(),dn=6;break e;default:throw Error(i(462))}}C1();break}catch(pe){mv(s,pe)}while(!0);return Us=co=null,oe.H=h,oe.A=T,Mt=l,ht!==null?0:(Gt=null,_t=0,Oa(),dn)}function C1(){for(;ht!==null&&!Xe();)yv(ht)}function yv(s){var o=qy(s.alternate,s,Yo);s.memoizedProps=s.pendingProps,o===null?Ud(s):ht=o}function vv(s){var o=s,l=o.alternate;switch(o.tag){case 15:case 0:o=Vy(l,o,o.pendingProps,o.type,void 0,_t);break;case 11:o=Vy(l,o,o.pendingProps,o.type.render,o.ref,_t);break;case 5:Jf(o);default:Gy(l,o),o=ht=Lu(o,Yo),o=qy(l,o,Yo)}s.memoizedProps=s.pendingProps,o===null?Ud(s):ht=o}function jl(s,o,l,h){Us=co=null,Jf(o),kl=null,qu=0;var T=o.return;try{if(m1(s,T,o,l,_t)){dn=1,Ad(s,d(l,s.current)),ht=null;return}}catch(w){if(T!==null)throw ht=T,w;dn=1,Ad(s,d(l,s.current)),ht=null;return}o.flags&32768?(dt||h===1?s=!0:Fl||(_t&536870912)!==0?s=!1:(Lr=s=!0,(h===2||h===9||h===3||h===6)&&(h=Wi.current,h!==null&&h.tag===13&&(h.flags|=16384))),Tv(o,s)):Ud(o)}function Ud(s){var o=s;do{if((o.flags&32768)!==0){Tv(o,Lr);return}s=o.return;var l=_1(o.alternate,o,Yo);if(l!==null){ht=l;return}if(o=o.sibling,o!==null){ht=o;return}ht=o=s}while(o!==null);dn===0&&(dn=5)}function Tv(s,o){do{var l=y1(s.alternate,s);if(l!==null){l.flags&=32767,ht=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!o&&(s=s.sibling,s!==null)){ht=s;return}ht=s=l}while(s!==null);dn=6,ht=null}function Ev(s,o,l,h,T,w,N,D,Z){s.cancelPendingCommit=null;do zd();while(Pn!==0);if((Mt&6)!==0)throw Error(i(327));if(o!==null){if(o===s.current)throw Error(i(177));if(w=o.lanes|o.childLanes,w|=Cl,Du(s,l,w,N,D,Z),s===Gt&&(ht=Gt=null,_t=0),Hl=o,Ur=s,Jo=l,Rm=w,Mm=T,cv=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,R1(Rn,function(){return Cv(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=oe.T,oe.T=null,T=Ae.p,Ae.p=2,N=Mt,Mt|=4;try{v1(s,o,l)}finally{Mt=N,Ae.p=T,oe.T=h}}Pn=1,xv(),wv(),Sv()}}function xv(){if(Pn===1){Pn=0;var s=Ur,o=Hl,l=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||l){l=oe.T,oe.T=null;var h=Ae.p;Ae.p=2;var T=Mt;Mt|=4;try{nv(o,s);var w=Zm,N=Pa(s.containerInfo),D=w.focusedElem,Z=w.selectionRange;if(N!==D&&D&&D.ownerDocument&&xl(D.ownerDocument.documentElement,D)){if(Z!==null&&io(D)){var se=Z.start,pe=Z.end;if(pe===void 0&&(pe=se),"selectionStart"in D)D.selectionStart=se,D.selectionEnd=Math.min(pe,D.value.length);else{var ve=D.ownerDocument||document,ae=ve&&ve.defaultView||window;if(ae.getSelection){var ce=ae.getSelection(),Ue=D.textContent.length,Ze=Math.min(Z.start,Ue),Bt=Z.end===void 0?Ze:Math.min(Z.end,Ue);!ce.extend&&Ze>Bt&&(N=Bt,Bt=Ze,Ze=N);var $=Ma(D,Ze),J=Ma(D,Bt);if($&&J&&(ce.rangeCount!==1||ce.anchorNode!==$.node||ce.anchorOffset!==$.offset||ce.focusNode!==J.node||ce.focusOffset!==J.offset)){var ie=ve.createRange();ie.setStart($.node,$.offset),ce.removeAllRanges(),Ze>Bt?(ce.addRange(ie),ce.extend(J.node,J.offset)):(ie.setEnd(J.node,J.offset),ce.addRange(ie))}}}}for(ve=[],ce=D;ce=ce.parentNode;)ce.nodeType===1&&ve.push({element:ce,left:ce.scrollLeft,top:ce.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<ve.length;D++){var _e=ve[D];_e.element.scrollLeft=_e.left,_e.element.scrollTop=_e.top}}Qd=!!jm,Zm=jm=null}finally{Mt=T,Ae.p=h,oe.T=l}}s.current=o,Pn=2}}function wv(){if(Pn===2){Pn=0;var s=Ur,o=Hl,l=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||l){l=oe.T,oe.T=null;var h=Ae.p;Ae.p=2;var T=Mt;Mt|=4;try{Qy(s,o.alternate,o)}finally{Mt=T,Ae.p=h,oe.T=l}}Pn=3}}function Sv(){if(Pn===4||Pn===3){Pn=0,Ot();var s=Ur,o=Hl,l=Jo,h=cv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Pn=5:(Pn=0,Hl=Ur=null,Av(s,s.pendingLanes));var T=s.pendingLanes;if(T===0&&(Or=null),Oe(l),o=o.stateNode,hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(gi,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=oe.T,T=Ae.p,Ae.p=2,oe.T=null;try{for(var w=s.onRecoverableError,N=0;N<h.length;N++){var D=h[N];w(D.value,{componentStack:D.stack})}}finally{oe.T=o,Ae.p=T}}(Jo&3)!==0&&zd(),fo(s),T=s.pendingLanes,(l&261930)!==0&&(T&42)!==0?s===Pm?oc++:(oc=0,Pm=s):oc=0,rc(0)}}function Av(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Bu(o)))}function zd(){return xv(),wv(),Sv(),Cv()}function Cv(){if(Pn!==5)return!1;var s=Ur,o=Rm;Rm=0;var l=Oe(Jo),h=oe.T,T=Ae.p;try{Ae.p=32>l?32:l,oe.T=null,l=Mm,Mm=null;var w=Ur,N=Jo;if(Pn=0,Hl=Ur=null,Jo=0,(Mt&6)!==0)throw Error(i(331));var D=Mt;if(Mt|=4,av(w.current),sv(w,w.current,N,l),Mt=D,rc(0,!1),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(gi,w)}catch{}return!0}finally{Ae.p=T,oe.T=h,Av(s,o)}}function bv(s,o,l){o=d(l,o),o=cm(s.stateNode,o,2),s=Mr(s,o,2),s!==null&&(Cs(s,2),fo(s))}function Vt(s,o,l){if(s.tag===3)bv(s,s,l);else for(;o!==null;){if(o.tag===3){bv(o,s,l);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Or===null||!Or.has(h))){s=d(l,s),l=Iy(2),h=Mr(o,l,2),h!==null&&(Ny(l,h,o,s),Cs(h,2),fo(h));break}}o=o.return}}function Lm(s,o,l){var h=s.pingCache;if(h===null){h=s.pingCache=new x1;var T=new Set;h.set(o,T)}else T=h.get(o),T===void 0&&(T=new Set,h.set(o,T));T.has(l)||(bm=!0,T.add(l),s=b1.bind(null,s,o,l),o.then(s,s))}function b1(s,o,l){var h=s.pingCache;h!==null&&h.delete(o),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Gt===s&&(_t&l)===l&&(dn===4||dn===3&&(_t&62914560)===_t&&300>pt()-Dd?(Mt&2)===0&&Gl(s,0):Im|=l,ql===_t&&(ql=0)),fo(s)}function Iv(s,o){o===0&&(o=fl()),s=ys(s,o),s!==null&&(Cs(s,o),fo(s))}function I1(s){var o=s.memoizedState,l=0;o!==null&&(l=o.retryLane),Iv(s,l)}function N1(s,o){var l=0;switch(s.tag){case 31:case 13:var h=s.stateNode,T=s.memoizedState;T!==null&&(l=T.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(o),Iv(s,l)}function R1(s,o){return Te(s,o)}var Bd=null,Zl=null,Vm=!1,Fd=!1,Om=!1,Br=0;function fo(s){s!==Zl&&s.next===null&&(Zl===null?Bd=Zl=s:Zl=Zl.next=s),Fd=!0,Vm||(Vm=!0,P1())}function rc(s,o){if(!Om&&Fd){Om=!0;do for(var l=!1,h=Bd;h!==null;){if(s!==0){var T=h.pendingLanes;if(T===0)var w=0;else{var N=h.suspendedLanes,D=h.pingedLanes;w=(1<<31-tn(42|s)+1)-1,w&=T&~(N&~D),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(l=!0,Pv(h,w))}else w=_t,w=os(h,h===Gt?w:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(w&3)===0||Ui(h,w)||(l=!0,Pv(h,w));h=h.next}while(l);Om=!1}}function M1(){Nv()}function Nv(){Fd=Vm=!1;var s=0;Br!==0&&q1()&&(s=Br);for(var o=pt(),l=null,h=Bd;h!==null;){var T=h.next,w=Rv(h,o);w===0?(h.next=null,l===null?Bd=T:l.next=T,T===null&&(Zl=l)):(l=h,(s!==0||(w&3)!==0)&&(Fd=!0)),h=T}Pn!==0&&Pn!==5||rc(s),Br!==0&&(Br=0)}function Rv(s,o){for(var l=s.suspendedLanes,h=s.pingedLanes,T=s.expirationTimes,w=s.pendingLanes&-62914561;0<w;){var N=31-tn(w),D=1<<N,Z=T[N];Z===-1?((D&l)===0||(D&h)!==0)&&(T[N]=Pu(D,o)):Z<=o&&(s.expiredLanes|=D),w&=~D}if(o=Gt,l=_t,l=os(s,s===o?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,l===0||s===o&&(Lt===2||Lt===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&Fe(h),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Ui(s,l)){if(o=l&-l,o===s.callbackPriority)return o;switch(h!==null&&Fe(h),Oe(l)){case 2:case 8:l=Ks;break;case 32:l=Rn;break;case 268435456:l=ma;break;default:l=Rn}return h=Mv.bind(null,s),l=Te(l,h),s.callbackPriority=o,s.callbackNode=l,o}return h!==null&&h!==null&&Fe(h),s.callbackPriority=2,s.callbackNode=null,2}function Mv(s,o){if(Pn!==0&&Pn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(zd()&&s.callbackNode!==l)return null;var h=_t;return h=os(s,s===Gt?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(hv(s,h,o),Rv(s,pt()),s.callbackNode!=null&&s.callbackNode===l?Mv.bind(null,s):null)}function Pv(s,o){if(zd())return null;hv(s,o,!0)}function P1(){G1(function(){(Mt&6)!==0?Te(is,M1):Nv()})}function Um(){if(Br===0){var s=Ml;s===0&&(s=Oi,Oi<<=1,(Oi&261888)===0&&(Oi=256)),Br=s}return Br}function Dv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Xs(""+s)}function kv(s,o){var l=o.ownerDocument.createElement("input");return l.name=o.name,l.value=o.value,s.id&&l.setAttribute("form",s.id),o.parentNode.insertBefore(l,o),s=new FormData(s),l.parentNode.removeChild(l),s}function D1(s,o,l,h,T){if(o==="submit"&&l&&l.stateNode===T){var w=Dv((T[an]||null).action),N=h.submitter;N&&(o=(o=N[an]||null)?Dv(o.formAction):N.getAttribute("formAction"),o!==null&&(w=o,N=null));var D=new ms("action","action",null,h,T);s.push({event:D,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Br!==0){var Z=N?kv(T,N):new FormData(T);sm(l,{pending:!0,data:Z,method:T.method,action:w},null,Z)}}else typeof w=="function"&&(D.preventDefault(),Z=N?kv(T,N):new FormData(T),sm(l,{pending:!0,data:Z,method:T.method,action:w},w,Z))},currentTarget:T}]})}}for(var zm=0;zm<ro.length;zm++){var Bm=ro[zm],k1=Bm.toLowerCase(),L1=Bm[0].toUpperCase()+Bm.slice(1);Ci(k1,"on"+L1)}Ci(ka,"onAnimationEnd"),Ci(od,"onAnimationIteration"),Ci(La,"onAnimationStart"),Ci("dblclick","onDoubleClick"),Ci("focusin","onFocus"),Ci("focusout","onBlur"),Ci(Nf,"onTransitionRun"),Ci(rd,"onTransitionStart"),Ci(Rf,"onTransitionCancel"),Ci(Cr,"onTransitionEnd"),Ti("onMouseEnter",["mouseout","mouseover"]),Ti("onMouseLeave",["mouseout","mouseover"]),Ti("onPointerEnter",["pointerout","pointerover"]),Ti("onPointerLeave",["pointerout","pointerover"]),us("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),us("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),us("onBeforeInput",["compositionend","keypress","textInput","paste"]),us("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),us("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),us("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ac="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),V1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ac));function Lv(s,o){o=(o&4)!==0;for(var l=0;l<s.length;l++){var h=s[l],T=h.event;h=h.listeners;e:{var w=void 0;if(o)for(var N=h.length-1;0<=N;N--){var D=h[N],Z=D.instance,se=D.currentTarget;if(D=D.listener,Z!==w&&T.isPropagationStopped())break e;w=D,T.currentTarget=se;try{w(T)}catch(pe){Va(pe)}T.currentTarget=null,w=Z}else for(N=0;N<h.length;N++){if(D=h[N],Z=D.instance,se=D.currentTarget,D=D.listener,Z!==w&&T.isPropagationStopped())break e;w=D,T.currentTarget=se;try{w(T)}catch(pe){Va(pe)}T.currentTarget=null,w=Z}}}}function ft(s,o){var l=o[Bi];l===void 0&&(l=o[Bi]=new Set);var h=s+"__bubble";l.has(h)||(Vv(o,s,2,!1),l.add(h))}function Fm(s,o,l){var h=0;o&&(h|=4),Vv(l,s,h,o)}var qd="_reactListening"+Math.random().toString(36).slice(2);function qm(s){if(!s[qd]){s[qd]=!0,va.forEach(function(l){l!=="selectionchange"&&(V1.has(l)||Fm(l,!1,s),Fm(l,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[qd]||(o[qd]=!0,Fm("selectionchange",!1,o))}}function Vv(s,o,l,h){switch(d0(o)){case 2:var T=cC;break;case 8:T=dC;break;default:T=ip}l=T.bind(null,o,l,s),T=void 0,!Rs||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(T=!0),h?T!==void 0?s.addEventListener(o,l,{capture:!0,passive:T}):s.addEventListener(o,l,!0):T!==void 0?s.addEventListener(o,l,{passive:T}):s.addEventListener(o,l,!1)}function Hm(s,o,l,h,T){var w=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var N=h.tag;if(N===3||N===4){var D=h.stateNode.containerInfo;if(D===T)break;if(N===4)for(N=h.return;N!==null;){var Z=N.tag;if((Z===3||Z===4)&&N.stateNode.containerInfo===T)return;N=N.return}for(;D!==null;){if(N=Fi(D),N===null)return;if(Z=N.tag,Z===5||Z===6||Z===26||Z===27){h=w=N;continue e}D=D.parentNode}}h=h.return}Ns(function(){var se=w,pe=Qn(l),ve=[];e:{var ae=ad.get(s);if(ae!==void 0){var ce=ms,Ue=s;switch(s){case"keypress":if(eo(l)===0)break e;case"keydown":case"keyup":ce=Ca;break;case"focusin":Ue="focus",ce=Do;break;case"focusout":Ue="blur",ce=Do;break;case"beforeblur":case"afterblur":ce=Do;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=Ea;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=_l;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=C;break;case ka:case od:case La:ce=gr;break;case Cr:ce=k;break;case"scroll":case"scrollend":ce=at;break;case"wheel":ce=le;break;case"copy":case"cut":case"paste":ce=hi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=ks;break;case"toggle":case"beforetoggle":ce=Je}var Ze=(o&4)!==0,Bt=!Ze&&(s==="scroll"||s==="scrollend"),$=Ze?ae!==null?ae+"Capture":null:ae;Ze=[];for(var J=se,ie;J!==null;){var _e=J;if(ie=_e.stateNode,_e=_e.tag,_e!==5&&_e!==26&&_e!==27||ie===null||$===null||(_e=di(J,$),_e!=null&&Ze.push(lc(J,_e,ie))),Bt)break;J=J.return}0<Ze.length&&(ae=new ce(ae,Ue,null,l,pe),ve.push({event:ae,listeners:Ze}))}}if((o&7)===0){e:{if(ae=s==="mouseover"||s==="pointerover",ce=s==="mouseout"||s==="pointerout",ae&&l!==pr&&(Ue=l.relatedTarget||l.fromElement)&&(Fi(Ue)||Ue[zi]))break e;if((ce||ae)&&(ae=pe.window===pe?pe:(ae=pe.ownerDocument)?ae.defaultView||ae.parentWindow:window,ce?(Ue=l.relatedTarget||l.toElement,ce=se,Ue=Ue?Fi(Ue):null,Ue!==null&&(Bt=u(Ue),Ze=Ue.tag,Ue!==Bt||Ze!==5&&Ze!==27&&Ze!==6)&&(Ue=null)):(ce=null,Ue=se),ce!==Ue)){if(Ze=Ea,_e="onMouseLeave",$="onMouseEnter",J="mouse",(s==="pointerout"||s==="pointerover")&&(Ze=ks,_e="onPointerLeave",$="onPointerEnter",J="pointer"),Bt=ce==null?ae:Ln(ce),ie=Ue==null?ae:Ln(Ue),ae=new Ze(_e,J+"leave",ce,l,pe),ae.target=Bt,ae.relatedTarget=ie,_e=null,Fi(pe)===se&&(Ze=new Ze($,J+"enter",Ue,l,pe),Ze.target=ie,Ze.relatedTarget=Bt,_e=Ze),Bt=_e,ce&&Ue)t:{for(Ze=O1,$=ce,J=Ue,ie=0,_e=$;_e;_e=Ze(_e))ie++;_e=0;for(var qe=J;qe;qe=Ze(qe))_e++;for(;0<ie-_e;)$=Ze($),ie--;for(;0<_e-ie;)J=Ze(J),_e--;for(;ie--;){if($===J||J!==null&&$===J.alternate){Ze=$;break t}$=Ze($),J=Ze(J)}Ze=null}else Ze=null;ce!==null&&Ov(ve,ae,ce,Ze,!1),Ue!==null&&Bt!==null&&Ov(ve,Bt,Ue,Ze,!0)}}e:{if(ae=se?Ln(se):window,ce=ae.nodeName&&ae.nodeName.toLowerCase(),ce==="select"||ce==="input"&&ae.type==="file")var It=Ra;else if(ps(ae))if(ed)It=If;else{It=bf;var ze=Ls}else ce=ae.nodeName,!ce||ce.toLowerCase()!=="input"||ae.type!=="checkbox"&&ae.type!=="radio"?se&&Qs(se.elementType)&&(It=Ra):It=xr;if(It&&(It=It(s,se))){$c(ve,It,l,pe);break e}ze&&ze(s,ae,se),s==="focusout"&&se&&ae.type==="number"&&se.memoizedProps.value!=null&&qi(ae,"number",ae.value)}switch(ze=se?Ln(se):window,s){case"focusin":(ps(ze)||ze.contentEditable==="true")&&(so=ze,Sl=se,Da=null);break;case"focusout":Da=Sl=so=null;break;case"mousedown":Sr=!0;break;case"contextmenu":case"mouseup":case"dragend":Sr=!1,id(ve,l,pe);break;case"selectionchange":if(wl)break;case"keydown":case"keyup":id(ve,l,pe)}var rt;if(wt)e:{switch(s){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else vr?ko(s,l)&&(yt="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(yt="onCompositionStart");yt&&(Ai&&l.locale!=="ko"&&(vr||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&vr&&(rt=Hi()):(wi=pe,Ms="value"in wi?wi.value:wi.textContent,vr=!0)),ze=Hd(se,yt),0<ze.length&&(yt=new Zi(yt,s,null,l,pe),ve.push({event:yt,listeners:ze}),rt?yt.data=rt:(rt=Lo(l),rt!==null&&(yt.data=rt)))),(rt=Si?Ji(s,l):Tr(s,l))&&(yt=Hd(se,"onBeforeInput"),0<yt.length&&(ze=new Zi("onBeforeInput","beforeinput",null,l,pe),ve.push({event:ze,listeners:yt}),ze.data=rt)),D1(ve,s,se,l,pe)}Lv(ve,o)})}function lc(s,o,l){return{instance:s,listener:o,currentTarget:l}}function Hd(s,o){for(var l=o+"Capture",h=[];s!==null;){var T=s,w=T.stateNode;if(T=T.tag,T!==5&&T!==26&&T!==27||w===null||(T=di(s,l),T!=null&&h.unshift(lc(s,T,w)),T=di(s,o),T!=null&&h.push(lc(s,T,w))),s.tag===3)return h;s=s.return}return[]}function O1(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Ov(s,o,l,h,T){for(var w=o._reactName,N=[];l!==null&&l!==h;){var D=l,Z=D.alternate,se=D.stateNode;if(D=D.tag,Z!==null&&Z===h)break;D!==5&&D!==26&&D!==27||se===null||(Z=se,T?(se=di(l,w),se!=null&&N.unshift(lc(l,se,Z))):T||(se=di(l,w),se!=null&&N.push(lc(l,se,Z)))),l=l.return}N.length!==0&&s.push({event:o,listeners:N})}var U1=/\r\n?/g,z1=/\u0000|\uFFFD/g;function Uv(s){return(typeof s=="string"?s:""+s).replace(U1,`
`).replace(z1,"")}function zv(s,o){return o=Uv(o),Uv(s)===o}function zt(s,o,l,h,T,w){switch(l){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||yn(s,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&yn(s,""+h);break;case"className":ct(s,"class",h);break;case"tabIndex":ct(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(s,l,h);break;case"style":Ro(s,h,w);break;case"data":if(o!=="object"){ct(s,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||l!=="href")){s.removeAttribute(l);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(l);break}h=Xs(""+h),s.setAttribute(l,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(l==="formAction"?(o!=="input"&&zt(s,o,"name",T.name,T,null),zt(s,o,"formEncType",T.formEncType,T,null),zt(s,o,"formMethod",T.formMethod,T,null),zt(s,o,"formTarget",T.formTarget,T,null)):(zt(s,o,"encType",T.encType,T,null),zt(s,o,"method",T.method,T,null),zt(s,o,"target",T.target,T,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(l);break}h=Xs(""+h),s.setAttribute(l,h);break;case"onClick":h!=null&&(s.onclick=Wn);break;case"onScroll":h!=null&&ft("scroll",s);break;case"onScrollEnd":h!=null&&ft("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(l=h.__html,l!=null){if(T.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}l=Xs(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(l,""+h):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":h===!0?s.setAttribute(l,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(l,h):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(l,h):s.removeAttribute(l);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(l):s.setAttribute(l,h);break;case"popover":ft("beforetoggle",s),ft("toggle",s),lt(s,"popover",h);break;case"xlinkActuate":Yt(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Yt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Yt(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Yt(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Yt(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Yt(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Yt(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Yt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Yt(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":lt(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Mo.get(l)||l,lt(s,l,h))}}function Gm(s,o,l,h,T,w){switch(l){case"style":Ro(s,h,w);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(l=h.__html,l!=null){if(T.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof h=="string"?yn(s,h):(typeof h=="number"||typeof h=="bigint")&&yn(s,""+h);break;case"onScroll":h!=null&&ft("scroll",s);break;case"onScrollEnd":h!=null&&ft("scrollend",s);break;case"onClick":h!=null&&(s.onclick=Wn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ta.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(T=l.endsWith("Capture"),o=l.slice(2,T?l.length-7:void 0),w=s[an]||null,w=w!=null?w[l]:null,typeof w=="function"&&s.removeEventListener(o,w,T),typeof h=="function")){typeof w!="function"&&w!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(o,h,T);break e}l in s?s[l]=h:h===!0?s.setAttribute(l,""):lt(s,l,h)}}}function Zn(s,o,l){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ft("error",s),ft("load",s);var h=!1,T=!1,w;for(w in l)if(l.hasOwnProperty(w)){var N=l[w];if(N!=null)switch(w){case"src":h=!0;break;case"srcSet":T=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:zt(s,o,w,N,l,null)}}T&&zt(s,o,"srcSet",l.srcSet,l,null),h&&zt(s,o,"src",l.src,l,null);return;case"input":ft("invalid",s);var D=w=N=T=null,Z=null,se=null;for(h in l)if(l.hasOwnProperty(h)){var pe=l[h];if(pe!=null)switch(h){case"name":T=pe;break;case"type":N=pe;break;case"checked":Z=pe;break;case"defaultChecked":se=pe;break;case"value":w=pe;break;case"defaultValue":D=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(i(137,o));break;default:zt(s,o,h,pe,l,null)}}No(s,w,D,Z,se,N,T,!1);return;case"select":ft("invalid",s),h=N=w=null;for(T in l)if(l.hasOwnProperty(T)&&(D=l[T],D!=null))switch(T){case"value":w=D;break;case"defaultValue":N=D;break;case"multiple":h=D;default:zt(s,o,T,D,l,null)}o=w,l=N,s.multiple=!!h,o!=null?kt(s,!!h,o,!1):l!=null&&kt(s,!!h,l,!0);return;case"textarea":ft("invalid",s),w=T=h=null;for(N in l)if(l.hasOwnProperty(N)&&(D=l[N],D!=null))switch(N){case"value":h=D;break;case"defaultValue":T=D;break;case"children":w=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(i(91));break;default:zt(s,o,N,D,l,null)}xi(s,h,T,w);return;case"option":for(Z in l)if(l.hasOwnProperty(Z)&&(h=l[Z],h!=null))switch(Z){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:zt(s,o,Z,h,l,null)}return;case"dialog":ft("beforetoggle",s),ft("toggle",s),ft("cancel",s),ft("close",s);break;case"iframe":case"object":ft("load",s);break;case"video":case"audio":for(h=0;h<ac.length;h++)ft(ac[h],s);break;case"image":ft("error",s),ft("load",s);break;case"details":ft("toggle",s);break;case"embed":case"source":case"link":ft("error",s),ft("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in l)if(l.hasOwnProperty(se)&&(h=l[se],h!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:zt(s,o,se,h,l,null)}return;default:if(Qs(o)){for(pe in l)l.hasOwnProperty(pe)&&(h=l[pe],h!==void 0&&Gm(s,o,pe,h,l,void 0));return}}for(D in l)l.hasOwnProperty(D)&&(h=l[D],h!=null&&zt(s,o,D,h,l,null))}function B1(s,o,l,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var T=null,w=null,N=null,D=null,Z=null,se=null,pe=null;for(ce in l){var ve=l[ce];if(l.hasOwnProperty(ce)&&ve!=null)switch(ce){case"checked":break;case"value":break;case"defaultValue":Z=ve;default:h.hasOwnProperty(ce)||zt(s,o,ce,null,h,ve)}}for(var ae in h){var ce=h[ae];if(ve=l[ae],h.hasOwnProperty(ae)&&(ce!=null||ve!=null))switch(ae){case"type":w=ce;break;case"name":T=ce;break;case"checked":se=ce;break;case"defaultChecked":pe=ce;break;case"value":N=ce;break;case"defaultValue":D=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,o));break;default:ce!==ve&&zt(s,o,ae,ce,h,ve)}}fr(s,N,D,Z,se,pe,w,T);return;case"select":ce=N=D=ae=null;for(w in l)if(Z=l[w],l.hasOwnProperty(w)&&Z!=null)switch(w){case"value":break;case"multiple":ce=Z;default:h.hasOwnProperty(w)||zt(s,o,w,null,h,Z)}for(T in h)if(w=h[T],Z=l[T],h.hasOwnProperty(T)&&(w!=null||Z!=null))switch(T){case"value":ae=w;break;case"defaultValue":D=w;break;case"multiple":N=w;default:w!==Z&&zt(s,o,T,w,h,Z)}o=D,l=N,h=ce,ae!=null?kt(s,!!l,ae,!1):!!h!=!!l&&(o!=null?kt(s,!!l,o,!0):kt(s,!!l,l?[]:"",!1));return;case"textarea":ce=ae=null;for(D in l)if(T=l[D],l.hasOwnProperty(D)&&T!=null&&!h.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:zt(s,o,D,null,h,T)}for(N in h)if(T=h[N],w=l[N],h.hasOwnProperty(N)&&(T!=null||w!=null))switch(N){case"value":ae=T;break;case"defaultValue":ce=T;break;case"children":break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(i(91));break;default:T!==w&&zt(s,o,N,T,h,w)}ds(s,ae,ce);return;case"option":for(var Ue in l)if(ae=l[Ue],l.hasOwnProperty(Ue)&&ae!=null&&!h.hasOwnProperty(Ue))switch(Ue){case"selected":s.selected=!1;break;default:zt(s,o,Ue,null,h,ae)}for(Z in h)if(ae=h[Z],ce=l[Z],h.hasOwnProperty(Z)&&ae!==ce&&(ae!=null||ce!=null))switch(Z){case"selected":s.selected=ae&&typeof ae!="function"&&typeof ae!="symbol";break;default:zt(s,o,Z,ae,h,ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ze in l)ae=l[Ze],l.hasOwnProperty(Ze)&&ae!=null&&!h.hasOwnProperty(Ze)&&zt(s,o,Ze,null,h,ae);for(se in h)if(ae=h[se],ce=l[se],h.hasOwnProperty(se)&&ae!==ce&&(ae!=null||ce!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(i(137,o));break;default:zt(s,o,se,ae,h,ce)}return;default:if(Qs(o)){for(var Bt in l)ae=l[Bt],l.hasOwnProperty(Bt)&&ae!==void 0&&!h.hasOwnProperty(Bt)&&Gm(s,o,Bt,void 0,h,ae);for(pe in h)ae=h[pe],ce=l[pe],!h.hasOwnProperty(pe)||ae===ce||ae===void 0&&ce===void 0||Gm(s,o,pe,ae,h,ce);return}}for(var $ in l)ae=l[$],l.hasOwnProperty($)&&ae!=null&&!h.hasOwnProperty($)&&zt(s,o,$,null,h,ae);for(ve in h)ae=h[ve],ce=l[ve],!h.hasOwnProperty(ve)||ae===ce||ae==null&&ce==null||zt(s,o,ve,ae,h,ce)}function Bv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function F1(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,l=performance.getEntriesByType("resource"),h=0;h<l.length;h++){var T=l[h],w=T.transferSize,N=T.initiatorType,D=T.duration;if(w&&D&&Bv(N)){for(N=0,D=T.responseEnd,h+=1;h<l.length;h++){var Z=l[h],se=Z.startTime;if(se>D)break;var pe=Z.transferSize,ve=Z.initiatorType;pe&&Bv(ve)&&(Z=Z.responseEnd,N+=pe*(Z<D?1:(D-se)/(Z-se)))}if(--h,o+=8*(w+N)/(T.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var jm=null,Zm=null;function Gd(s){return s.nodeType===9?s:s.ownerDocument}function Fv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qv(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Km(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ym=null;function q1(){var s=window.event;return s&&s.type==="popstate"?s===Ym?!1:(Ym=s,!0):(Ym=null,!1)}var Hv=typeof setTimeout=="function"?setTimeout:void 0,H1=typeof clearTimeout=="function"?clearTimeout:void 0,Gv=typeof Promise=="function"?Promise:void 0,G1=typeof queueMicrotask=="function"?queueMicrotask:typeof Gv<"u"?function(s){return Gv.resolve(null).then(s).catch(j1)}:Hv;function j1(s){setTimeout(function(){throw s})}function Fr(s){return s==="head"}function jv(s,o){var l=o,h=0;do{var T=l.nextSibling;if(s.removeChild(l),T&&T.nodeType===8)if(l=T.data,l==="/$"||l==="/&"){if(h===0){s.removeChild(T),Wl(o);return}h--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")h++;else if(l==="html")uc(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,uc(l);for(var w=l.firstChild;w;){var N=w.nextSibling,D=w.nodeName;w[as]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&w.rel.toLowerCase()==="stylesheet"||l.removeChild(w),w=N}}else l==="body"&&uc(s.ownerDocument.body);l=T}while(l);Wl(o)}function Zv(s,o){var l=s;s=0;do{var h=l.nextSibling;if(l.nodeType===1?o?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(o?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),h&&h.nodeType===8)if(l=h.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=h}while(l)}function Jm(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var l=o;switch(o=o.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Jm(l),cr(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function Z1(s,o,l,h){for(;s.nodeType===1;){var T=l;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[as])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(w=s.getAttribute("rel"),w==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(w!==T.rel||s.getAttribute("href")!==(T.href==null||T.href===""?null:T.href)||s.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin)||s.getAttribute("title")!==(T.title==null?null:T.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(w=s.getAttribute("src"),(w!==(T.src==null?null:T.src)||s.getAttribute("type")!==(T.type==null?null:T.type)||s.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin))&&w&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var w=T.name==null?null:""+T.name;if(T.type==="hidden"&&s.getAttribute("name")===w)return s}else return s;if(s=Es(s.nextSibling),s===null)break}return null}function K1(s,o,l){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Es(s.nextSibling),s===null))return null;return s}function Kv(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Es(s.nextSibling),s===null))return null;return s}function Wm(s){return s.data==="$?"||s.data==="$~"}function Qm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function Y1(s,o){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||l.readyState!=="loading")o();else{var h=function(){o(),l.removeEventListener("DOMContentLoaded",h)};l.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function Es(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var Xm=null;function Yv(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(o===0)return Es(s.nextSibling);o--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||o++}s=s.nextSibling}return null}function Jv(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(o===0)return s;o--}else l!=="/$"&&l!=="/&"||o++}s=s.previousSibling}return null}function Wv(s,o,l){switch(o=Gd(l),s){case"html":if(s=o.documentElement,!s)throw Error(i(452));return s;case"head":if(s=o.head,!s)throw Error(i(453));return s;case"body":if(s=o.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function uc(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);cr(s)}var xs=new Map,Qv=new Set;function jd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Wo=Ae.d;Ae.d={f:J1,r:W1,D:Q1,C:X1,L:$1,m:eC,X:nC,S:tC,M:iC};function J1(){var s=Wo.f(),o=Vd();return s||o}function W1(s){var o=vi(s);o!==null&&o.tag===5&&o.type==="form"?my(o):Wo.r(s)}var Kl=typeof document>"u"?null:document;function Xv(s,o,l){var h=Kl;if(h&&typeof o=="string"&&o){var T=qt(o);T='link[rel="'+s+'"][href="'+T+'"]',typeof l=="string"&&(T+='[crossorigin="'+l+'"]'),Qv.has(T)||(Qv.add(T),s={rel:s,crossOrigin:l,href:o},h.querySelector(T)===null&&(o=h.createElement("link"),Zn(o,"link",s),ln(o),h.head.appendChild(o)))}}function Q1(s){Wo.D(s),Xv("dns-prefetch",s,null)}function X1(s,o){Wo.C(s,o),Xv("preconnect",s,o)}function $1(s,o,l){Wo.L(s,o,l);var h=Kl;if(h&&s&&o){var T='link[rel="preload"][as="'+qt(o)+'"]';o==="image"&&l&&l.imageSrcSet?(T+='[imagesrcset="'+qt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(T+='[imagesizes="'+qt(l.imageSizes)+'"]')):T+='[href="'+qt(s)+'"]';var w=T;switch(o){case"style":w=Yl(s);break;case"script":w=Jl(s)}xs.has(w)||(s=A({rel:"preload",href:o==="image"&&l&&l.imageSrcSet?void 0:s,as:o},l),xs.set(w,s),h.querySelector(T)!==null||o==="style"&&h.querySelector(cc(w))||o==="script"&&h.querySelector(dc(w))||(o=h.createElement("link"),Zn(o,"link",s),ln(o),h.head.appendChild(o)))}}function eC(s,o){Wo.m(s,o);var l=Kl;if(l&&s){var h=o&&typeof o.as=="string"?o.as:"script",T='link[rel="modulepreload"][as="'+qt(h)+'"][href="'+qt(s)+'"]',w=T;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Jl(s)}if(!xs.has(w)&&(s=A({rel:"modulepreload",href:s},o),xs.set(w,s),l.querySelector(T)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(dc(w)))return}h=l.createElement("link"),Zn(h,"link",s),ln(h),l.head.appendChild(h)}}}function tC(s,o,l){Wo.S(s,o,l);var h=Kl;if(h&&s){var T=ls(h).hoistableStyles,w=Yl(s);o=o||"default";var N=T.get(w);if(!N){var D={loading:0,preload:null};if(N=h.querySelector(cc(w)))D.loading=5;else{s=A({rel:"stylesheet",href:s,"data-precedence":o},l),(l=xs.get(w))&&$m(s,l);var Z=N=h.createElement("link");ln(Z),Zn(Z,"link",s),Z._p=new Promise(function(se,pe){Z.onload=se,Z.onerror=pe}),Z.addEventListener("load",function(){D.loading|=1}),Z.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Zd(N,o,h)}N={type:"stylesheet",instance:N,count:1,state:D},T.set(w,N)}}}function nC(s,o){Wo.X(s,o);var l=Kl;if(l&&s){var h=ls(l).hoistableScripts,T=Jl(s),w=h.get(T);w||(w=l.querySelector(dc(T)),w||(s=A({src:s,async:!0},o),(o=xs.get(T))&&ep(s,o),w=l.createElement("script"),ln(w),Zn(w,"link",s),l.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(T,w))}}function iC(s,o){Wo.M(s,o);var l=Kl;if(l&&s){var h=ls(l).hoistableScripts,T=Jl(s),w=h.get(T);w||(w=l.querySelector(dc(T)),w||(s=A({src:s,async:!0,type:"module"},o),(o=xs.get(T))&&ep(s,o),w=l.createElement("script"),ln(w),Zn(w,"link",s),l.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(T,w))}}function $v(s,o,l,h){var T=(T=Se.current)?jd(T):null;if(!T)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(o=Yl(l.href),l=ls(T).hoistableStyles,h=l.get(o),h||(h={type:"style",instance:null,count:0,state:null},l.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Yl(l.href);var w=ls(T).hoistableStyles,N=w.get(s);if(N||(T=T.ownerDocument||T,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(s,N),(w=T.querySelector(cc(s)))&&!w._p&&(N.instance=w,N.state.loading=5),xs.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},xs.set(s,l),w||sC(T,s,l,N.state))),o&&h===null)throw Error(i(528,""));return N}if(o&&h!==null)throw Error(i(529,""));return null;case"script":return o=l.async,l=l.src,typeof l=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Jl(l),l=ls(T).hoistableScripts,h=l.get(o),h||(h={type:"script",instance:null,count:0,state:null},l.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Yl(s){return'href="'+qt(s)+'"'}function cc(s){return'link[rel="stylesheet"]['+s+"]"}function e0(s){return A({},s,{"data-precedence":s.precedence,precedence:null})}function sC(s,o,l,h){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=s.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),Zn(o,"link",l),ln(o),s.head.appendChild(o))}function Jl(s){return'[src="'+qt(s)+'"]'}function dc(s){return"script[async]"+s}function t0(s,o,l){if(o.count++,o.instance===null)switch(o.type){case"style":var h=s.querySelector('style[data-href~="'+qt(l.href)+'"]');if(h)return o.instance=h,ln(h),h;var T=A({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),ln(h),Zn(h,"style",T),Zd(h,l.precedence,s),o.instance=h;case"stylesheet":T=Yl(l.href);var w=s.querySelector(cc(T));if(w)return o.state.loading|=4,o.instance=w,ln(w),w;h=e0(l),(T=xs.get(T))&&$m(h,T),w=(s.ownerDocument||s).createElement("link"),ln(w);var N=w;return N._p=new Promise(function(D,Z){N.onload=D,N.onerror=Z}),Zn(w,"link",h),o.state.loading|=4,Zd(w,l.precedence,s),o.instance=w;case"script":return w=Jl(l.src),(T=s.querySelector(dc(w)))?(o.instance=T,ln(T),T):(h=l,(T=xs.get(w))&&(h=A({},l),ep(h,T)),s=s.ownerDocument||s,T=s.createElement("script"),ln(T),Zn(T,"link",h),s.head.appendChild(T),o.instance=T);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,Zd(h,l.precedence,s));return o.instance}function Zd(s,o,l){for(var h=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),T=h.length?h[h.length-1]:null,w=T,N=0;N<h.length;N++){var D=h[N];if(D.dataset.precedence===o)w=D;else if(w!==T)break}w?w.parentNode.insertBefore(s,w.nextSibling):(o=l.nodeType===9?l.head:l,o.insertBefore(s,o.firstChild))}function $m(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function ep(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Kd=null;function n0(s,o,l){if(Kd===null){var h=new Map,T=Kd=new Map;T.set(l,h)}else T=Kd,h=T.get(l),h||(h=new Map,T.set(l,h));if(h.has(s))return h;for(h.set(s,null),l=l.getElementsByTagName(s),T=0;T<l.length;T++){var w=l[T];if(!(w[as]||w[sn]||s==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var N=w.getAttribute(o)||"";N=s+N;var D=h.get(N);D?D.push(w):h.set(N,[w])}}return h}function i0(s,o,l){s=s.ownerDocument||s,s.head.insertBefore(l,o==="title"?s.querySelector("head > title"):null)}function oC(s,o,l){if(l===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function s0(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function rC(s,o,l,h){if(l.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var T=Yl(h.href),w=o.querySelector(cc(T));if(w){o=w._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=Yd.bind(s),o.then(s,s)),l.state.loading|=4,l.instance=w,ln(w);return}w=o.ownerDocument||o,h=e0(h),(T=xs.get(T))&&$m(h,T),w=w.createElement("link"),ln(w);var N=w;N._p=new Promise(function(D,Z){N.onload=D,N.onerror=Z}),Zn(w,"link",h),l.instance=w}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,o),(o=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=Yd.bind(s),o.addEventListener("load",l),o.addEventListener("error",l))}}var tp=0;function aC(s,o){return s.stylesheets&&s.count===0&&Wd(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var h=setTimeout(function(){if(s.stylesheets&&Wd(s,s.stylesheets),s.unsuspend){var w=s.unsuspend;s.unsuspend=null,w()}},6e4+o);0<s.imgBytes&&tp===0&&(tp=62500*F1());var T=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Wd(s,s.stylesheets),s.unsuspend)){var w=s.unsuspend;s.unsuspend=null,w()}},(s.imgBytes>tp?50:800)+o);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(T)}}:null}function Yd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Wd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Jd=null;function Wd(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Jd=new Map,o.forEach(lC,s),Jd=null,Yd.call(s))}function lC(s,o){if(!(o.state.loading&4)){var l=Jd.get(s);if(l)var h=l.get(null);else{l=new Map,Jd.set(s,l);for(var T=s.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<T.length;w++){var N=T[w];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(l.set(N.dataset.precedence,N),h=N)}h&&l.set(null,h)}T=o.instance,N=T.getAttribute("data-precedence"),w=l.get(N)||h,w===h&&l.set(null,T),l.set(N,T),this.count++,h=Yd.bind(this),T.addEventListener("load",h),T.addEventListener("error",h),w?w.parentNode.insertBefore(T,w.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(T,s.firstChild)),o.state.loading|=4}}var hc={$$typeof:Q,Provider:null,Consumer:null,_currentValue:we,_currentValue2:we,_threadCount:0};function uC(s,o,l,h,T,w,N,D,Z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=rs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rs(0),this.hiddenUpdates=rs(null),this.identifierPrefix=h,this.onUncaughtError=T,this.onCaughtError=w,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function o0(s,o,l,h,T,w,N,D,Z,se,pe,ve){return s=new uC(s,o,l,N,Z,se,pe,ve,D),o=1,w===!0&&(o|=24),w=ti(3,null,null,o),s.current=w,w.stateNode=s,o=kf(),o.refCount++,s.pooledCache=o,o.refCount++,w.memoizedState={element:h,isDehydrated:l,cache:o},Uf(w),s}function r0(s){return s?(s=Vo,s):Vo}function a0(s,o,l,h,T,w){T=r0(T),h.context===null?h.context=T:h.pendingContext=T,h=Rr(o),h.payload={element:l},w=w===void 0?null:w,w!==null&&(h.callback=w),l=Mr(s,h,o),l!==null&&(Di(l,s,o),Gu(l,s,o))}function l0(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<o?l:o}}function np(s,o){l0(s,o),(s=s.alternate)&&l0(s,o)}function u0(s){if(s.tag===13||s.tag===31){var o=ys(s,67108864);o!==null&&Di(o,s,67108864),np(s,67108864)}}function c0(s){if(s.tag===13||s.tag===31){var o=es();o=kn(o);var l=ys(s,o);l!==null&&Di(l,s,o),np(s,o)}}var Qd=!0;function cC(s,o,l,h){var T=oe.T;oe.T=null;var w=Ae.p;try{Ae.p=2,ip(s,o,l,h)}finally{Ae.p=w,oe.T=T}}function dC(s,o,l,h){var T=oe.T;oe.T=null;var w=Ae.p;try{Ae.p=8,ip(s,o,l,h)}finally{Ae.p=w,oe.T=T}}function ip(s,o,l,h){if(Qd){var T=sp(h);if(T===null)Hm(s,o,h,Xd,l),h0(s,h);else if(fC(T,s,o,l,h))h.stopPropagation();else if(h0(s,h),o&4&&-1<hC.indexOf(s)){for(;T!==null;){var w=vi(T);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var N=ss(w.pendingLanes);if(N!==0){var D=w;for(D.pendingLanes|=2,D.entangledLanes|=2;N;){var Z=1<<31-tn(N);D.entanglements[1]|=Z,N&=~Z}fo(w),(Mt&6)===0&&(kd=pt()+500,rc(0))}}break;case 31:case 13:D=ys(w,2),D!==null&&Di(D,w,2),Vd(),np(w,2)}if(w=sp(h),w===null&&Hm(s,o,h,Xd,l),w===T)break;T=w}T!==null&&h.stopPropagation()}else Hm(s,o,h,null,l)}}function sp(s){return s=Qn(s),op(s)}var Xd=null;function op(s){if(Xd=null,s=Fi(s),s!==null){var o=u(s);if(o===null)s=null;else{var l=o.tag;if(l===13){if(s=c(o),s!==null)return s;s=null}else if(l===31){if(s=m(o),s!==null)return s;s=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Xd=s,null}function d0(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(_n()){case is:return 2;case Ks:return 8;case Rn:case Co:return 32;case ma:return 268435456;default:return 32}default:return 32}}var rp=!1,qr=null,Hr=null,Gr=null,fc=new Map,mc=new Map,jr=[],hC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function h0(s,o){switch(s){case"focusin":case"focusout":qr=null;break;case"dragenter":case"dragleave":Hr=null;break;case"mouseover":case"mouseout":Gr=null;break;case"pointerover":case"pointerout":fc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":mc.delete(o.pointerId)}}function pc(s,o,l,h,T,w){return s===null||s.nativeEvent!==w?(s={blockedOn:o,domEventName:l,eventSystemFlags:h,nativeEvent:w,targetContainers:[T]},o!==null&&(o=vi(o),o!==null&&u0(o)),s):(s.eventSystemFlags|=h,o=s.targetContainers,T!==null&&o.indexOf(T)===-1&&o.push(T),s)}function fC(s,o,l,h,T){switch(o){case"focusin":return qr=pc(qr,s,o,l,h,T),!0;case"dragenter":return Hr=pc(Hr,s,o,l,h,T),!0;case"mouseover":return Gr=pc(Gr,s,o,l,h,T),!0;case"pointerover":var w=T.pointerId;return fc.set(w,pc(fc.get(w)||null,s,o,l,h,T)),!0;case"gotpointercapture":return w=T.pointerId,mc.set(w,pc(mc.get(w)||null,s,o,l,h,T)),!0}return!1}function f0(s){var o=Fi(s.target);if(o!==null){var l=u(o);if(l!==null){if(o=l.tag,o===13){if(o=c(l),o!==null){s.blockedOn=o,_i(s.priority,function(){c0(l)});return}}else if(o===31){if(o=m(l),o!==null){s.blockedOn=o,_i(s.priority,function(){c0(l)});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function $d(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var l=sp(s.nativeEvent);if(l===null){l=s.nativeEvent;var h=new l.constructor(l.type,l);pr=h,l.target.dispatchEvent(h),pr=null}else return o=vi(l),o!==null&&u0(o),s.blockedOn=l,!1;o.shift()}return!0}function m0(s,o,l){$d(s)&&l.delete(o)}function mC(){rp=!1,qr!==null&&$d(qr)&&(qr=null),Hr!==null&&$d(Hr)&&(Hr=null),Gr!==null&&$d(Gr)&&(Gr=null),fc.forEach(m0),mc.forEach(m0)}function eh(s,o){s.blockedOn===o&&(s.blockedOn=null,rp||(rp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,mC)))}var th=null;function p0(s){th!==s&&(th=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){th===s&&(th=null);for(var o=0;o<s.length;o+=3){var l=s[o],h=s[o+1],T=s[o+2];if(typeof h!="function"){if(op(h||l)===null)continue;break}var w=vi(l);w!==null&&(s.splice(o,3),o-=3,sm(w,{pending:!0,data:T,method:l.method,action:h},h,T))}}))}function Wl(s){function o(Z){return eh(Z,s)}qr!==null&&eh(qr,s),Hr!==null&&eh(Hr,s),Gr!==null&&eh(Gr,s),fc.forEach(o),mc.forEach(o);for(var l=0;l<jr.length;l++){var h=jr[l];h.blockedOn===s&&(h.blockedOn=null)}for(;0<jr.length&&(l=jr[0],l.blockedOn===null);)f0(l),l.blockedOn===null&&jr.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(h=0;h<l.length;h+=3){var T=l[h],w=l[h+1],N=T[an]||null;if(typeof w=="function")N||p0(l);else if(N){var D=null;if(w&&w.hasAttribute("formAction")){if(T=w,N=w[an]||null)D=N.formAction;else if(op(T)!==null)continue}else D=N.action;typeof D=="function"?l[h+1]=D:(l.splice(h,3),h-=3),p0(l)}}}function g0(){function s(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(N){return T=N})},focusReset:"manual",scroll:"manual"})}function o(){T!==null&&(T(),T=null),h||setTimeout(l,20)}function l(){if(!h&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,T=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(l,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),T!==null&&(T(),T=null)}}}function ap(s){this._internalRoot=s}nh.prototype.render=ap.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(i(409));var l=o.current,h=es();a0(l,h,s,o,null,null)},nh.prototype.unmount=ap.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;a0(s.current,2,null,s,null,null),Vd(),o[zi]=null}};function nh(s){this._internalRoot=s}nh.prototype.unstable_scheduleHydration=function(s){if(s){var o=ya();s={blockedOn:null,target:s,priority:o};for(var l=0;l<jr.length&&o!==0&&o<jr[l].priority;l++);jr.splice(l,0,s),l===0&&f0(s)}};var _0=e.version;if(_0!=="19.2.0")throw Error(i(527,_0,"19.2.0"));Ae.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=p(o),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var pC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:oe,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ih=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ih.isDisabled&&ih.supportsFiber)try{gi=ih.inject(pC),hn=ih}catch{}}return _c.createRoot=function(s,o){if(!r(s))throw Error(i(299));var l=!1,h="",T=Sy,w=Ay,N=Cy;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(T=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError)),o=o0(s,1,!1,null,null,l,h,null,T,w,N,g0),s[zi]=o.current,qm(s),new ap(o)},_c.hydrateRoot=function(s,o,l){if(!r(s))throw Error(i(299));var h=!1,T="",w=Sy,N=Ay,D=Cy,Z=null;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(T=l.identifierPrefix),l.onUncaughtError!==void 0&&(w=l.onUncaughtError),l.onCaughtError!==void 0&&(N=l.onCaughtError),l.onRecoverableError!==void 0&&(D=l.onRecoverableError),l.formState!==void 0&&(Z=l.formState)),o=o0(s,1,!0,o,l??null,h,T,Z,w,N,D,g0),o.context=r0(null),l=o.current,h=es(),h=kn(h),T=Rr(h),T.callback=null,Mr(l,T,h),l=h,o.current.lanes=l,Cs(o,l),fo(o),s[zi]=o.current,qm(s),new nh(o)},_c.version="19.2.0",_c}var b0;function SC(){if(b0)return cp.exports;b0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),cp.exports=wC(),cp.exports}var AC=SC();const CC=hg(AC);var $e=(n=>(n.HOME="HOME",n.ADD_TRIP="ADD_TRIP",n.TRIP_DETAILS="TRIP_DETAILS",n.SETTINGS="SETTINGS",n.MAGIC_EDITOR="MAGIC_EDITOR",n.AI_PLANNER="AI_PLANNER",n.TOOLS="TOOLS",n.TRIP_MEMORY="TRIP_MEMORY",n))($e||{});const bC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),Yh=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),po=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"})}),cu=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})]}),Cp=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})]}),ns=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})}),bp=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})}),IC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Ox=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:E.jsx("path",{d:"M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5Z"})}),Ux=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"})]}),zx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"})}),Bx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 9.75a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 0 1 .778-.332 48.294 48.294 0 0 0 5.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})}),NC=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:[E.jsx("path",{d:"M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.85 7h10.29l1.08 3.11H5.77L6.85 7zM19 17H5v-5h14v5z"}),E.jsx("circle",{cx:"7.5",cy:"14.5",r:"1.5"}),E.jsx("circle",{cx:"16.5",cy:"14.5",r:"1.5"})]}),I0=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"})}),mg=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z"})}),er=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),RC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"})}),MC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),PC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 0 1-2.25 2.25M16.5 7.5V18a2.25 2.25 0 0 0 2.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 0 0 2.25 2.25h13.5M6 7.5h3v3H6v-3Z"})}),Ip=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-1.94c.955-.13 1.93-.32 2.795-.591 3.615-1.133 4.705-4.884 2.636-7.962-1.373-2.042-3.738-3.257-6.236-3.257-4.14 0-7.5 3.36-7.5 7.5 0 2.053.84 3.942 2.22 5.297.808.796 1.83 1.344 2.923 1.564V18m2.25 0h-4.5m4.5 0a2.25 2.25 0 0 1-2.25 2.25h-1.5A2.25 2.25 0 0 1 7.5 18m9-9h.008v.008H16.5V9Zm-4.5 0h.008v.008H12V9Zm-4.5 0h.008v.008H7.5V9Z"})}),DC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h3.375c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125h-3.375c-.621 0-1.125-.504-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125Zm-3 7.5h10.5a.75.75 0 0 1 .75.75v3.375a3 3 0 0 1-3 3h-6a3 3 0 0 1-3-3V10.5a.75.75 0 0 1 .75-.75Zm9.375 12a1.125 1.125 0 1 0 0-2.25 1.125 1.125 0 0 0 0 2.25Z"})}),kC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"})}),Fx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 17.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),LC=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 0 1 1.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.559.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.894.149c-.424.07-.764.383-.929.78-.165.398-.143.854.107 1.204l-.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 0 1-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 0 1-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 0 1 .12-1.45l.773-.773a1.125 1.125 0 0 1 1.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894Z"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),VC=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),OC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"})}),qx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),Hx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 01-1.12-1.243l1.264-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.119 1.007zM8.625 10.5a.375.375 0 11-.75 0 .375.375 0 01.75 0zm7.5 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})}),UC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 016-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 01-3.827-5.802"})}),zC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})}),N0=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0 1 18 16.5h-2.25m-7.5 0h7.5m-7.5 0-1 3m8.5-3 1 3m0 0 .5 1.5m-.5-1.5h-9.5m0 0-.5 1.5M9 11.25v1.5M12 9v3m3-3v3M9 3.75V5.25m3-1.5h3m-3 0v1.5m0-1.5h-3m3 0v1.5M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})}),BC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:E.jsx("path",{d:"M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4S4 2.5 4 6v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z"})}),FC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:E.jsx("path",{d:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"})}),qC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),HC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})}),jt={"zh-TW":{back:"",cancel:"",confirm:"",save:"",delete:"",edit:"",loading:"...",day:"Day",my_trips:"",start_adventure:"",click_to_add:"",trips_count:"",new_trip:"",trip_destination_title:" / ",cover_photo:"",upload_photo:"",ai_generate_cover:"AI ",start_date:"",end_date:"",create_trip:"",add_trip_hint:"",itinerary:"",map:"",budget:"",bookings:"",shopping_list:"",origin:"",label_destination:"",status_confirmed:"",status_pending:"",status_cancelled:"",ai_guide:"AI ",add_activity:"",edit_activity:"",add_expense:"",add_booking:"",weather:"",nav_quick_jump:"",no_itinerary:"",click_add:"",delete_trip_title:"",delete_trip_confirm:"{title}",confirm_delete:"",activity_name:"",time:"",location:"",notes:" ()",duration:"",details:"",placeholder_duration:"15 ",placeholder_details:"JR ",ai_route:"AI ",expense_item:"",amount:"",payer:"",payment_method:"",booking_type:"",provider:" / ",booking_ref:" ()",ai_planner_title:"AI ",ai_planner_intro:" AI ",ai_planning:" 10-20 ",ai_done:"",input_placeholder:"...",planning_process:"...",magic_editor_title:"",upload_hint:"",magic_prompt_placeholder:"...",start_magic:"",generating:"...",settings_title:"",general:"",language:"",appearance:"",minimalist_mode:"",minimalist_desc:"",data_mgmt:"",reset_all:"",reset_confirm:"",tools_title:"",tool_emergency:"",tool_card:"",tool_map:"",tool_restroom:"",tool_visa:"",tool_translation:"",tool_culture:"",api_settings:"API ",api_key_label:"Gemini API Key",api_key_placeholder:" API Key",api_key_help:" Key ",api_key_saved:"API Key ",theme_color:"",payer_me:"",payer_other:"",payment_cash:"",payment_card:"",split_individual:"",split_shared:"",translate_to:"",enter_text:"...",translate_result:"",desc_translator:"AI ",desc_emergency:" / ",desc_card:"",desc_map:"",desc_restroom:"",desc_visa:"",desc_culture:"",prompt_tokyo:"",prompt_bangkok:"",prompt_paris:"",placeholder_item:"",placeholder_payer:"",lang_ja:"",lang_en:"",lang_zh:"",lang_ko:"",lang_th:"",lang_fr:"",lang_es:"",share_trip:"",share_success:"",travel_time:"",travel_mode:"",travel_details:" ( JR )",mode_walk:"",mode_train:"/",mode_bus:"/",mode_car:"/",mode_flight:"",minutes:""},"en-US":{back:"Back",cancel:"Cancel",confirm:"Confirm",save:"Save",delete:"Delete",edit:"Edit",loading:"Loading...",day:"Day",my_trips:"My Trips",start_adventure:"Start New Adventure",click_to_add:"Click button below to add trip",trips_count:"items",new_trip:"New Trip",trip_destination_title:"Destination / Title",cover_photo:"Cover Photo",upload_photo:"Upload",ai_generate_cover:"AI Generate",start_date:"Start Date",end_date:"End Date",create_trip:"Create Trip",add_trip_hint:"You can add detailed itinerary later",itinerary:"Itinerary",map:"Map",budget:"Budget",shopping_list:"Shopping List",bookings:"Bookings",origin:"Origin",label_destination:"Destination",status_confirmed:"Confirmed",status_pending:"Pending",status_cancelled:"Cancelled",ai_guide:"AI Guide",add_activity:"Add Activity",edit_activity:"Edit Activity",add_expense:"Add Expense",add_booking:"Add Booking",weather:"Weather",nav_quick_jump:"Jump to",no_itinerary:"No itinerary yet",click_add:"Click button to add",delete_trip_title:"Delete Trip?",delete_trip_confirm:'Are you sure you want to delete "{title}"? This cannot be undone.',confirm_delete:"Delete",activity_name:"Activity Name",time:"Time",location:"Location",notes:"Notes (Optional)",duration:"Duration",details:"Details",placeholder_duration:"e.g. 15 min",placeholder_details:"e.g. JR Line",ai_route:"AI Route",expense_item:"Item Name",amount:"Amount",payer:"Payer",payment_method:"Method",booking_type:"Type",provider:"Provider / Name",booking_ref:"Ref Number (Optional)",ai_planner_title:"AI Planner",ai_planner_intro:"Hi! I am your AI travel assistant. Where do you want to go?",ai_planning:"Sure! I am planning your trip. This takes about 10-20 seconds.",ai_done:"Planning complete! Check your trip list. ",input_placeholder:"Enter your travel ideas...",planning_process:"Processing...",magic_editor_title:"Magic Editor",upload_hint:"Upload Photo",magic_prompt_placeholder:"Make it sunny, add balloons...",start_magic:"Generate",generating:"Processing...",settings_title:"Settings",api_settings:"API Settings",api_key_label:"Gemini API Key",api_key_placeholder:"Paste your API Key here",api_key_help:"Your key is stored locally in your browser.",api_key_saved:"API Key Saved",general:"General",language:"Language",appearance:"Appearance",minimalist_mode:"Minimalist Mode",minimalist_desc:"Hide images, focus on text",data_mgmt:"Data Management",reset_all:"Reset All Data",reset_confirm:"Are you sure? This will delete all trips and settings. This cannot be undone.",tools_title:"Tools",tool_emergency:"Emergency",tool_card:"Card Tips",tool_map:"Scratch Map",tool_restroom:"Restroom",tool_visa:"Visa Check",tool_culture:"Culture",share_trip:"Share Trip",share_success:"Copied to clipboard!",travel_time:"Travel Time",travel_mode:"Travel Mode",travel_details:"Details (e.g. JR Line)",mode_walk:"Walk",mode_train:"Train/Subway",mode_bus:"Bus",mode_car:"Car/Taxi",mode_flight:"Flight",minutes:"min"},"ja-JP":{back:"",cancel:"",confirm:"",save:"",delete:"",edit:"",loading:"...",day:"Day",my_trips:"",start_adventure:"",click_to_add:"",trips_count:"",new_trip:"",trip_destination_title:" / ",cover_photo:"",upload_photo:"",ai_generate_cover:"AI",start_date:"",end_date:"",create_trip:"",add_trip_hint:"",itinerary:"",map:"",budget:"",shopping_list:"",bookings:"",origin:"",label_destination:"",status_confirmed:"",status_pending:"",status_cancelled:"",ai_guide:"AI",add_activity:"",edit_activity:"",add_expense:"",add_booking:"",weather:"",nav_quick_jump:"",no_itinerary:"",click_add:"",delete_trip_title:"",delete_trip_confirm:"{title}",confirm_delete:"",activity_name:"",time:"",location:"",notes:" ()",duration:"",details:"",placeholder_duration:"15",placeholder_details:"JR",ai_route:"AI",expense_item:"",amount:"",payer:"",payment_method:"",booking_type:"",provider:" / ",booking_ref:" ()",ai_planner_title:"AI",ai_planner_intro:"AI",ai_planning:"1020",ai_done:"",input_placeholder:"...",planning_process:"...",magic_editor_title:"",upload_hint:"",magic_prompt_placeholder:"...",start_magic:"",generating:"...",settings_title:"",general:"",language:"",appearance:"",minimalist_mode:"",minimalist_desc:"",data_mgmt:"",reset_all:"",reset_confirm:"",tools_title:"",tool_emergency:"",tool_card:"",tool_map:"",tool_restroom:"",tool_visa:"",tool_culture:"",share_trip:"",share_success:"",travel_time:"",travel_mode:"",travel_details:" (: JR)",mode_walk:"",mode_train:"/",mode_bus:"",mode_car:"/",mode_flight:"",minutes:""}},GC=({trips:n,onSelectTrip:e,onAddTrip:t,onOpenSettings:i,settings:r})=>{const[u,c]=X.useState(new Set),[m,g]=X.useState(new Set),p=jt[r.language]||jt["zh-TW"],x=A=>{c(b=>{const M=new Set(b);return M.add(A),M})};return E.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[E.jsxs("div",{className:"px-6 py-5 sticky top-0 z-10 flex justify-between items-center bg-paper/90 backdrop-blur-sm",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"w-14 h-14 flex items-center justify-center overflow-hidden",children:E.jsx("img",{src:"/nomadai-travel-journal_app_icon.png",alt:"Icon",className:"w-full h-full object-cover"})}),E.jsx("h1",{className:"text-3xl font-extrabold text-ink tracking-tight",children:p.my_trips})]}),E.jsx("button",{onClick:i,className:"p-2.5 bg-white shadow-card rounded-full text-gray-400 hover:text-coral transition-colors active:scale-95",children:E.jsx(LC,{className:"w-6 h-6"})})]}),E.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-2 space-y-6 pb-32 no-scrollbar",children:n.length===0?E.jsxs("div",{className:"flex flex-col items-center justify-center h-80 text-center animate-fade-in border-2 border-dashed border-sand rounded-3xl m-4",children:[E.jsx("div",{className:"w-16 h-16 bg-white shadow-soft rounded-full flex items-center justify-center mb-4 text-coral",children:E.jsx(Cp,{className:"w-8 h-8"})}),E.jsx("h3",{className:"text-xl font-bold text-ink mb-1",children:p.start_adventure}),E.jsx("p",{className:"text-gray-400 text-sm",children:p.click_to_add})]}):n==null?void 0:n.map(A=>{var b;return E.jsxs("div",{onClick:()=>e(A),className:`group cursor-pointer active:scale-[0.98] transition-all transform bg-white rounded-3xl shadow-card hover:shadow-soft overflow-hidden ${r.minimalistMode?"p-5 border border-sand":"p-3"}`,children:[!r.minimalistMode&&E.jsxs("div",{className:"aspect-[2/1] w-full relative overflow-hidden rounded-2xl bg-gray-100 mb-4 shadow-inner group",children:[A.coverImage&&!u.has(A.id)?E.jsxs(E.Fragment,{children:[E.jsx("div",{className:`absolute inset-0 bg-gray-200 transition-opacity duration-500 ${m.has(A.id)?"opacity-0 pointer-events-none":"opacity-100"}`}),E.jsx("img",{src:A.coverImage,alt:A.title,onLoad:()=>g(M=>new Set(M).add(A.id)),onError:()=>x(A.id),className:`w-full h-full object-cover transition-all duration-700 ${m.has(A.id)?"opacity-100 group-hover:scale-105":"opacity-0"}`})]}):E.jsx("div",{className:"w-full h-full bg-sand/30 flex items-center justify-center",children:E.jsx(Cp,{className:"w-12 h-12 text-gray-300"})}),E.jsxs("div",{className:"absolute top-3 right-3 bg-white/90 backdrop-blur text-ink text-xs font-bold px-3 py-1.5 rounded-full shadow-sm z-10",children:[((b=A.itinerary)==null?void 0:b.length)||0," ",p.trips_count]})]}),E.jsxs("div",{className:`${r.minimalistMode?"flex justify-between items-center":"px-2 pb-2"}`,children:[E.jsxs("div",{children:[E.jsx("h3",{className:`font-bold text-ink leading-tight ${r.minimalistMode?"text-lg":"text-xl mb-1"}`,children:A.title}),E.jsxs("div",{className:"flex items-center text-sm text-gray-400 font-medium",children:[E.jsx(bp,{className:"w-4 h-4 mr-1.5 text-coral"}),E.jsxs("span",{children:[A.startDate," - ",A.endDate]})]})]}),r.minimalistMode&&E.jsx("div",{className:"w-8 h-8 bg-paper rounded-full flex items-center justify-center text-coral",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-4 h-4",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})})})]})]},A.id)})}),E.jsx("button",{onClick:t,className:"fixed bottom-28 right-6 w-16 h-16 bg-coral text-white rounded-full shadow-float flex items-center justify-center transition-all active:scale-90 hover:bg-coralDark z-50 ring-4 ring-white",children:E.jsx(Yh,{className:"w-8 h-8 stroke-[2]"})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let jC,ZC;function KC(){return{geminiUrl:jC,vertexUrl:ZC}}function YC(n,e,t,i){var r,u;if(!(n!=null&&n.baseUrl)){const c=KC();return e?(r=c.vertexUrl)!==null&&r!==void 0?r:t:(u=c.geminiUrl)!==null&&u!==void 0?u:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rr{}function Pe(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const u=e[r];return u!=null?String(u):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function _(n,e,t){for(let u=0;u<e.length-1;u++){const c=e[u];if(c.endsWith("[]")){const m=c.slice(0,-2);if(!(m in n))if(Array.isArray(t))n[m]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(n[m])){const g=n[m];if(Array.isArray(t))for(let p=0;p<g.length;p++){const x=g[p];_(x,e.slice(u+1),t[p])}else for(const p of g)_(p,e.slice(u+1),t)}return}else if(c.endsWith("[0]")){const m=c.slice(0,-3);m in n||(n[m]=[{}]);const g=n[m];_(g[0],e.slice(u+1),t);return}(!n[c]||typeof n[c]!="object")&&(n[c]={}),n=n[c]}const i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function f(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const r=e[i];if(r.endsWith("[]")){const u=r.slice(0,-2);if(u in n){const c=n[u];return Array.isArray(c)?c.map(m=>f(m,e.slice(i+1),t)):t}else return t}else n=n[r]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function JC(n,e){for(const[t,i]of Object.entries(e)){const r=t.split("."),u=i.split("."),c=new Set;let m=-1;for(let g=0;g<r.length;g++)if(r[g]==="*"){m=g;break}if(m!==-1&&u.length>m)for(let g=m;g<u.length;g++){const p=u[g];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&c.add(p)}Np(n,r,u,0,c)}}function Np(n,e,t,i,r){if(i>=e.length||typeof n!="object"||n===null)return;const u=e[i];if(u.endsWith("[]")){const c=u.slice(0,-2),m=n;if(c in m&&Array.isArray(m[c]))for(const g of m[c])Np(g,e,t,i+1,r)}else if(u==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const c=n,m=Object.keys(c).filter(p=>!p.startsWith("_")&&!r.has(p)),g={};for(const p of m)g[p]=c[p];for(const[p,x]of Object.entries(g)){const A=[];for(const b of t.slice(i))b==="*"?A.push(p):A.push(b);_(c,A,x)}for(const p of m)delete c[p]}}else{const c=n;u in c&&Np(c[u],e,t,i+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pg(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WC(n){const e={},t=f(n,["operationName"]);t!=null&&_(e,["operationName"],t);const i=f(n,["resourceName"]);return i!=null&&_(e,["_url","resourceName"],i),e}function QC(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response","generateVideoResponse"]);return c!=null&&_(e,["response"],$C(c)),e}function XC(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response"]);return c!=null&&_(e,["response"],eb(c)),e}function $C(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let u=t;Array.isArray(u)&&(u=u.map(c=>tb(c))),_(e,["generatedVideos"],u)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function eb(n){const e={},t=f(n,["videos"]);if(t!=null){let u=t;Array.isArray(u)&&(u=u.map(c=>nb(c))),_(e,["generatedVideos"],u)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function tb(n){const e={},t=f(n,["video"]);return t!=null&&_(e,["video"],lb(t)),e}function nb(n){const e={},t=f(n,["_self"]);return t!=null&&_(e,["video"],ub(t)),e}function ib(n){const e={},t=f(n,["operationName"]);return t!=null&&_(e,["_url","operationName"],t),e}function sb(n){const e={},t=f(n,["operationName"]);return t!=null&&_(e,["_url","operationName"],t),e}function ob(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response"]);return c!=null&&_(e,["response"],rb(c)),e}function rb(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["parent"]);i!=null&&_(e,["parent"],i);const r=f(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function Gx(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response"]);return c!=null&&_(e,["response"],ab(c)),e}function ab(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["parent"]);i!=null&&_(e,["parent"],i);const r=f(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function lb(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["uri"],t);const i=f(n,["encodedVideo"]);i!=null&&_(e,["videoBytes"],pg(i));const r=f(n,["encoding"]);return r!=null&&_(e,["mimeType"],r),e}function ub(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["uri"],t);const i=f(n,["bytesBase64Encoded"]);i!=null&&_(e,["videoBytes"],pg(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var R0;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(R0||(R0={}));var M0;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(M0||(M0={}));var P0;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(P0||(P0={}));var Qr;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Qr||(Qr={}));var D0;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(D0||(D0={}));var k0;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(k0||(k0={}));var L0;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(L0||(L0={}));var V0;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(V0||(V0={}));var O0;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(O0||(O0={}));var U0;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(U0||(U0={}));var z0;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(z0||(z0={}));var B0;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(B0||(B0={}));var F0;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(F0||(F0={}));var q0;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(q0||(q0={}));var H0;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(H0||(H0={}));var G0;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(G0||(G0={}));var j0;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(j0||(j0={}));var Z0;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(Z0||(Z0={}));var K0;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(K0||(K0={}));var Ah;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Ah||(Ah={}));var Y0;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Y0||(Y0={}));var J0;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(J0||(J0={}));var W0;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(W0||(W0={}));var Rp;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Rp||(Rp={}));var Q0;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Q0||(Q0={}));var X0;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(X0||(X0={}));var $0;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})($0||($0={}));var eT;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(eT||(eT={}));var tT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(tT||(tT={}));var nT;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(nT||(nT={}));var iT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(iT||(iT={}));var sT;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(sT||(sT={}));var oT;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(oT||(oT={}));var rT;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(rT||(rT={}));var aT;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(aT||(aT={}));var lT;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(lT||(lT={}));var uT;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(uT||(uT={}));var cT;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(cT||(cT={}));var dT;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(dT||(dT={}));var hT;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(hT||(hT={}));var fT;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(fT||(fT={}));var mT;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(mT||(mT={}));var pT;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(pT||(pT={}));var gT;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(gT||(gT={}));var _T;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(_T||(_T={}));var yT;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(yT||(yT={}));var vT;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(vT||(vT={}));var TT;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(TT||(TT={}));var ET;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(ET||(ET={}));var xT;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(xT||(xT={}));var wT;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(wT||(wT={}));var ST;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ST||(ST={}));var AT;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(AT||(AT={}));var CT;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(CT||(CT={}));var tu;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(tu||(tu={}));class Mp{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class yc{get text(){var e,t,i,r,u,c,m,g;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",x=!1;const A=[];for(const b of(g=(m=(c=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)!==null&&g!==void 0?g:[]){for(const[M,K]of Object.entries(b))M!=="text"&&M!=="thought"&&M!=="thoughtSignature"&&(K!==null||K!==void 0)&&A.push(M);if(typeof b.text=="string"){if(typeof b.thought=="boolean"&&b.thought)continue;x=!0,p+=b.text}}return A.length>0&&console.warn(`there are non-text parts ${A} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),x?p:void 0}get data(){var e,t,i,r,u,c,m,g;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const x=[];for(const A of(g=(m=(c=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)!==null&&g!==void 0?g:[]){for(const[b,M]of Object.entries(A))b!=="inlineData"&&(M!==null||M!==void 0)&&x.push(b);A.inlineData&&typeof A.inlineData.data=="string"&&(p+=atob(A.inlineData.data))}return x.length>0&&console.warn(`there are non-data parts ${x} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,r,u,c,m,g;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(g=(m=(c=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)===null||g===void 0?void 0:g.filter(x=>x.functionCall).map(x=>x.functionCall).filter(x=>x!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,r,u,c,m,g,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const x=(g=(m=(c=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)===null||g===void 0?void 0:g.filter(A=>A.executableCode).map(A=>A.executableCode).filter(A=>A!==void 0);if((x==null?void 0:x.length)!==0)return(p=x==null?void 0:x[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,r,u,c,m,g,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const x=(g=(m=(c=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)===null||g===void 0?void 0:g.filter(A=>A.codeExecutionResult).map(A=>A.codeExecutionResult).filter(A=>A!==void 0);if((x==null?void 0:x.length)!==0)return(p=x==null?void 0:x[0])===null||p===void 0?void 0:p.output}}class bT{}class IT{}class cb{}class db{}class hb{}class fb{}class NT{}class RT{}class MT{}class mb{}class Ch{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Ch;let r;const u=e;return t?r=XC(u):r=QC(u),Object.assign(i,r),i}}class PT{}class DT{}class kT{}class pb{}class gb{}class _b{}class gg{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new gg,u=ob(e);return Object.assign(i,u),i}}class yb{}class vb{}class Tb{}class LT{}class Eb{get text(){var e,t,i;let r="",u=!1;const c=[];for(const m of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[g,p]of Object.entries(m))g!=="text"&&g!=="thought"&&p!==null&&c.push(g);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;u=!0,r+=m.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?r:void 0}get data(){var e,t,i;let r="";const u=[];for(const c of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[m,g]of Object.entries(c))m!=="inlineData"&&g!==null&&u.push(m);c.inlineData&&typeof c.inlineData.data=="string"&&(r+=atob(c.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class xb{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class _g{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new _g,u=Gx(e);return Object.assign(i,u),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Rt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function jx(n,e){const t=Rt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function Zx(n){return Array.isArray(n)?n.map(e=>bh(e)):[bh(n)]}function bh(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function Kx(n){const e=bh(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Yx(n){const e=bh(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function VT(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function Jx(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>VT(e)):[VT(n)]}function Pp(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function OT(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function UT(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function ri(n){if(n==null)throw new Error("ContentUnion is required");return Pp(n)?n:{role:"user",parts:Jx(n)}}function yg(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=ri(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=ri(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>ri(t)):[ri(e)]}function Ss(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(OT(n)||UT(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ri(n)]}const e=[],t=[],i=Pp(n[0]);for(const r of n){const u=Pp(r);if(u!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(u)e.push(r);else{if(OT(r)||UT(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:Jx(t)}),e}function wb(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(Qr).includes(t[0].toUpperCase())?t[0].toUpperCase():Qr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(Qr).includes(i.toUpperCase())?i.toUpperCase():Qr.TYPE_UNSPECIFIED})}}function nu(n){const e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const u=n.anyOf;u!=null&&u.length==2&&(u[0].type==="null"?(e.nullable=!0,n=u[1]):u[1].type==="null"&&(e.nullable=!0,n=u[0])),n.type instanceof Array&&wb(n.type,e);for(const[c,m]of Object.entries(n))if(m!=null)if(c=="type"){if(m==="null")throw new Error("type: null can not be the only possible type for the field.");if(m instanceof Array)continue;e.type=Object.values(Qr).includes(m.toUpperCase())?m.toUpperCase():Qr.TYPE_UNSPECIFIED}else if(t.includes(c))e[c]=nu(m);else if(i.includes(c)){const g=[];for(const p of m){if(p.type=="null"){e.nullable=!0;continue}g.push(nu(p))}e[c]=g}else if(r.includes(c)){const g={};for(const[p,x]of Object.entries(m))g[p]=nu(x);e[c]=g}else{if(c==="additionalProperties")continue;e[c]=m}return e}function vg(n){return nu(n)}function Tg(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Eg(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Tu(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=nu(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=nu(e.response));return n}function Eu(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Sb(n,e,t,i=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function ar(n,e){if(typeof e!="string")throw new Error("name must be a string");return Sb(n,e,"cachedContents")}function Wx(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function da(n){return pg(n)}function Ab(n){return n!=null&&typeof n=="object"&&"name"in n}function Cb(n){return n!=null&&typeof n=="object"&&"video"in n}function bb(n){return n!=null&&typeof n=="object"&&"uri"in n}function Qx(n){var e;let t;if(Ab(n)&&(t=n.name),!(bb(n)&&(t=n.uri,t===void 0))&&!(Cb(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function Xx(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function $x(n){for(const e of["models","tunedModels","publisherModels"])if(Ib(n,e))return n[e];return[]}function Ib(n,e){return n!==null&&typeof n=="object"&&e in n}function Nb(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function Rb(n,e={}){const t=[],i=new Set;for(const r of n){const u=r.name;if(i.has(u))throw new Error(`Duplicate function name ${u} found in MCP tools. Please ensure function names are unique.`);i.add(u);const c=Nb(r,e);c.functionDeclarations&&t.push(...c.functionDeclarations)}return{functionDeclarations:t}}function ew(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function Mb(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function tw(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let u=!1;for(const c of r){if(typeof c!="object"||c===null)continue;const g=c.response;if(typeof g!="object"||g===null)continue;if(g.embedding!==void 0){u=!0;break}}return u&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function xu(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function nw(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pb(n){const e={},t=f(n,["responsesFile"]);t!=null&&_(e,["fileName"],t);const i=f(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>hI(c))),_(e,["inlinedResponses"],u)}const r=f(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["inlinedEmbedContentResponses"],u)}return e}function Db(n){const e={},t=f(n,["predictionsFormat"]);t!=null&&_(e,["format"],t);const i=f(n,["gcsDestination","outputUriPrefix"]);i!=null&&_(e,["gcsUri"],i);const r=f(n,["bigqueryDestination","outputUri"]);return r!=null&&_(e,["bigqueryUri"],r),e}function kb(n){const e={},t=f(n,["format"]);t!=null&&_(e,["predictionsFormat"],t);const i=f(n,["gcsUri"]);i!=null&&_(e,["gcsDestination","outputUriPrefix"],i);const r=f(n,["bigqueryUri"]);if(r!=null&&_(e,["bigqueryDestination","outputUri"],r),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function hh(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata","displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["metadata","state"]);r!=null&&_(e,["state"],nw(r));const u=f(n,["metadata","createTime"]);u!=null&&_(e,["createTime"],u);const c=f(n,["metadata","endTime"]);c!=null&&_(e,["endTime"],c);const m=f(n,["metadata","updateTime"]);m!=null&&_(e,["updateTime"],m);const g=f(n,["metadata","model"]);g!=null&&_(e,["model"],g);const p=f(n,["metadata","output"]);return p!=null&&_(e,["dest"],Pb(tw(p))),e}function Dp(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["state"]);r!=null&&_(e,["state"],nw(r));const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["createTime"]);c!=null&&_(e,["createTime"],c);const m=f(n,["startTime"]);m!=null&&_(e,["startTime"],m);const g=f(n,["endTime"]);g!=null&&_(e,["endTime"],g);const p=f(n,["updateTime"]);p!=null&&_(e,["updateTime"],p);const x=f(n,["model"]);x!=null&&_(e,["model"],x);const A=f(n,["inputConfig"]);A!=null&&_(e,["src"],Lb(A));const b=f(n,["outputConfig"]);b!=null&&_(e,["dest"],Db(tw(b)));const M=f(n,["completionStats"]);return M!=null&&_(e,["completionStats"],M),e}function Lb(n){const e={},t=f(n,["instancesFormat"]);t!=null&&_(e,["format"],t);const i=f(n,["gcsSource","uris"]);i!=null&&_(e,["gcsUri"],i);const r=f(n,["bigquerySource","inputUri"]);return r!=null&&_(e,["bigqueryUri"],r),e}function Vb(n,e){const t={};if(f(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=f(e,["fileName"]);i!=null&&_(t,["fileName"],i);const r=f(e,["inlinedRequests"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>dI(n,c))),_(t,["requests","requests"],u)}return t}function Ob(n){const e={},t=f(n,["format"]);t!=null&&_(e,["instancesFormat"],t);const i=f(n,["gcsUri"]);i!=null&&_(e,["gcsSource","uris"],i);const r=f(n,["bigqueryUri"]);if(r!=null&&_(e,["bigquerySource","inputUri"],r),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Ub(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function zb(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],xu(n,i)),t}function Bb(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],xu(n,i)),t}function Fb(n){const e={},t=f(n,["content"]);t!=null&&_(e,["content"],t);const i=f(n,["citationMetadata"]);i!=null&&_(e,["citationMetadata"],qb(i));const r=f(n,["tokenCount"]);r!=null&&_(e,["tokenCount"],r);const u=f(n,["finishReason"]);u!=null&&_(e,["finishReason"],u);const c=f(n,["avgLogprobs"]);c!=null&&_(e,["avgLogprobs"],c);const m=f(n,["groundingMetadata"]);m!=null&&_(e,["groundingMetadata"],m);const g=f(n,["index"]);g!=null&&_(e,["index"],g);const p=f(n,["logprobsResult"]);p!=null&&_(e,["logprobsResult"],p);const x=f(n,["safetyRatings"]);if(x!=null){let b=x;Array.isArray(b)&&(b=b.map(M=>M)),_(e,["safetyRatings"],b)}const A=f(n,["urlContextMetadata"]);return A!=null&&_(e,["urlContextMetadata"],A),e}function qb(n){const e={},t=f(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["citations"],i)}return e}function iw(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(u=>vI(u))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function Hb(n,e){const t={},i=f(n,["displayName"]);if(e!==void 0&&i!=null&&_(e,["batch","displayName"],i),f(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function Gb(n,e){const t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=f(n,["dest"]);return e!==void 0&&r!=null&&_(e,["outputConfig"],kb(Mb(r))),t}function zT(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["src"]);r!=null&&_(t,["batch","inputConfig"],Vb(n,ew(n,r)));const u=f(e,["config"]);return u!=null&&Hb(u,t),t}function jb(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["model"],Rt(n,i));const r=f(e,["src"]);r!=null&&_(t,["inputConfig"],Ob(ew(n,r)));const u=f(e,["config"]);return u!=null&&Gb(u,t),t}function Zb(n,e){const t={},i=f(n,["displayName"]);return e!==void 0&&i!=null&&_(e,["batch","displayName"],i),t}function Kb(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["src"]);r!=null&&_(t,["batch","inputConfig"],eI(n,r));const u=f(e,["config"]);return u!=null&&Zb(u,t),t}function Yb(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],xu(n,i)),t}function Jb(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],xu(n,i)),t}function Wb(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);return u!=null&&_(e,["error"],u),e}function Qb(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);return u!=null&&_(e,["error"],u),e}function Xb(n,e){const t={},i=f(e,["contents"]);if(i!=null){let u=yg(n,i);Array.isArray(u)&&(u=u.map(c=>c)),_(t,["requests[]","request","content"],u)}const r=f(e,["config"]);return r!=null&&(_(t,["_self"],$b(r,t)),JC(t,{"requests[].*":"requests[].request.*"})),t}function $b(n,e){const t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&_(e,["requests[]","taskType"],i);const r=f(n,["title"]);e!==void 0&&r!=null&&_(e,["requests[]","title"],r);const u=f(n,["outputDimensionality"]);if(e!==void 0&&u!=null&&_(e,["requests[]","outputDimensionality"],u),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function eI(n,e){const t={},i=f(e,["fileName"]);i!=null&&_(t,["file_name"],i);const r=f(e,["inlinedRequests"]);return r!=null&&_(t,["requests"],Xb(n,r)),t}function tI(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function nI(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function iI(n){const e={},t=f(n,["mode"]);t!=null&&_(e,["mode"],t);const i=f(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function sI(n,e,t){const i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],iw(ri(r)));const u=f(e,["temperature"]);u!=null&&_(i,["temperature"],u);const c=f(e,["topP"]);c!=null&&_(i,["topP"],c);const m=f(e,["topK"]);m!=null&&_(i,["topK"],m);const g=f(e,["candidateCount"]);g!=null&&_(i,["candidateCount"],g);const p=f(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const x=f(e,["stopSequences"]);x!=null&&_(i,["stopSequences"],x);const A=f(e,["responseLogprobs"]);A!=null&&_(i,["responseLogprobs"],A);const b=f(e,["logprobs"]);b!=null&&_(i,["logprobs"],b);const M=f(e,["presencePenalty"]);M!=null&&_(i,["presencePenalty"],M);const K=f(e,["frequencyPenalty"]);K!=null&&_(i,["frequencyPenalty"],K);const G=f(e,["seed"]);G!=null&&_(i,["seed"],G);const z=f(e,["responseMimeType"]);z!=null&&_(i,["responseMimeType"],z);const W=f(e,["responseSchema"]);W!=null&&_(i,["responseSchema"],vg(W));const te=f(e,["responseJsonSchema"]);if(te!=null&&_(i,["responseJsonSchema"],te),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const Q=f(e,["safetySettings"]);if(t!==void 0&&Q!=null){let Y=Q;Array.isArray(Y)&&(Y=Y.map(B=>TI(B))),_(t,["safetySettings"],Y)}const me=f(e,["tools"]);if(t!==void 0&&me!=null){let Y=Eu(me);Array.isArray(Y)&&(Y=Y.map(B=>xI(Tu(B)))),_(t,["tools"],Y)}const de=f(e,["toolConfig"]);if(t!==void 0&&de!=null&&_(t,["toolConfig"],EI(de)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const fe=f(e,["cachedContent"]);t!==void 0&&fe!=null&&_(t,["cachedContent"],ar(n,fe));const V=f(e,["responseModalities"]);V!=null&&_(i,["responseModalities"],V);const O=f(e,["mediaResolution"]);O!=null&&_(i,["mediaResolution"],O);const U=f(e,["speechConfig"]);if(U!=null&&_(i,["speechConfig"],Tg(U)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const H=f(e,["thinkingConfig"]);H!=null&&_(i,["thinkingConfig"],H);const F=f(e,["imageConfig"]);return F!=null&&_(i,["imageConfig"],cI(F)),i}function oI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(p=>Fb(p))),_(e,["candidates"],g)}const r=f(n,["modelVersion"]);r!=null&&_(e,["modelVersion"],r);const u=f(n,["promptFeedback"]);u!=null&&_(e,["promptFeedback"],u);const c=f(n,["responseId"]);c!=null&&_(e,["responseId"],c);const m=f(n,["usageMetadata"]);return m!=null&&_(e,["usageMetadata"],m),e}function rI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],xu(n,i)),t}function aI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],xu(n,i)),t}function lI(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function uI(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function cI(n){const e={},t=f(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=f(n,["imageSize"]);if(i!=null&&_(e,["imageSize"],i),f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function dI(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["request","model"],Rt(n,i));const r=f(e,["contents"]);if(r!=null){let m=Ss(r);Array.isArray(m)&&(m=m.map(g=>iw(g))),_(t,["request","contents"],m)}const u=f(e,["metadata"]);u!=null&&_(t,["metadata"],u);const c=f(e,["config"]);return c!=null&&_(t,["request","generationConfig"],sI(n,c,f(t,["request"],{}))),t}function hI(n){const e={},t=f(n,["response"]);t!=null&&_(e,["response"],oI(t));const i=f(n,["error"]);return i!=null&&_(e,["error"],i),e}function fI(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);if(e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),f(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function mI(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);e!==void 0&&r!=null&&_(e,["_query","pageToken"],r);const u=f(n,["filter"]);return e!==void 0&&u!=null&&_(e,["_query","filter"],u),t}function pI(n){const e={},t=f(n,["config"]);return t!=null&&fI(t,e),e}function gI(n){const e={},t=f(n,["config"]);return t!=null&&mI(t,e),e}function _I(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["operations"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>hh(c))),_(e,["batchJobs"],u)}return e}function yI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["batchPredictionJobs"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>Dp(c))),_(e,["batchJobs"],u)}return e}function vI(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const u=f(n,["fileData"]);u!=null&&_(e,["fileData"],tI(u));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],nI(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],Ub(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const x=f(n,["thought"]);x!=null&&_(e,["thought"],x);const A=f(n,["thoughtSignature"]);A!=null&&_(e,["thoughtSignature"],A);const b=f(n,["videoMetadata"]);return b!=null&&_(e,["videoMetadata"],b),e}function TI(n){const e={},t=f(n,["category"]);if(t!=null&&_(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=f(n,["threshold"]);return i!=null&&_(e,["threshold"],i),e}function EI(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],iI(t));const i=f(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function xI(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(A=>A)),_(e,["functionDeclarations"],x)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const u=f(n,["fileSearch"]);u!=null&&_(e,["fileSearch"],u);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],lI(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],uI(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var tr;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(tr||(tr={}));class ll{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,u;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let c={config:{}};!i||Object.keys(i).length===0?c={config:{}}:typeof i=="object"?c=Object.assign({},i):c=i,c.config&&(c.config.pageToken=t.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(u=(r=c.config)===null||r===void 0?void 0:r.pageSize)!==null&&u!==void 0?u:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wI extends rr{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new ll(tr.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=zT(this.apiClient,e),i=t._url,r=Pe("{model}:batchGenerateContent",i),m=t.batch.inputConfig.requests,g=m.requests,p=[];for(const x of g){const A=Object.assign({},x);if(A.systemInstruction){const b=A.systemInstruction;delete A.systemInstruction;const M=A.request;M.systemInstruction=b,A.request=M}p.push(A)}return m.requests=p,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const u=this.getGcsUri(e),c=this.getBigqueryUri(e);if(u)u.endsWith(".jsonl")?i.dest=`${u.slice(0,-6)}/dest`:i.dest=`${u}_dest_${r}`;else if(c)i.dest=`${c}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=jb(this.apiClient,e);return m=Pe("batchPredictionJobs",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>Dp(x))}else{const p=zT(this.apiClient,e);return m=Pe("{model}:batchGenerateContent",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>hh(x))}}async createEmbeddingsInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=Kb(this.apiClient,e);return u=Pe("{model}:asyncBatchEmbedContent",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>hh(g))}}async get(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=aI(this.apiClient,e);return m=Pe("batchPredictionJobs/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>Dp(x))}else{const p=rI(this.apiClient,e);return m=Pe("batches/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>hh(x))}}async cancel(e){var t,i,r,u;let c="",m={};if(this.apiClient.isVertexAI()){const g=Bb(this.apiClient,e);c=Pe("batchPredictionJobs/{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=zb(this.apiClient,e);c=Pe("batches/{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal})}}async listInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=gI(e);return m=Pe("batchPredictionJobs",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=yI(x),b=new LT;return Object.assign(b,A),b})}else{const p=pI(e);return m=Pe("batches",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=_I(x),b=new LT;return Object.assign(b,A),b})}}async delete(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=Jb(this.apiClient,e);return m=Pe("batchPredictionJobs/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>Qb(x))}else{const p=Yb(this.apiClient,e);return m=Pe("batches/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>Wb(x))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SI(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function BT(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(u=>KI(u))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function AI(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);e!==void 0&&r!=null&&_(e,["expireTime"],r);const u=f(n,["displayName"]);e!==void 0&&u!=null&&_(e,["displayName"],u);const c=f(n,["contents"]);if(e!==void 0&&c!=null){let x=Ss(c);Array.isArray(x)&&(x=x.map(A=>BT(A))),_(e,["contents"],x)}const m=f(n,["systemInstruction"]);e!==void 0&&m!=null&&_(e,["systemInstruction"],BT(ri(m)));const g=f(n,["tools"]);if(e!==void 0&&g!=null){let x=g;Array.isArray(x)&&(x=x.map(A=>JI(A))),_(e,["tools"],x)}const p=f(n,["toolConfig"]);if(e!==void 0&&p!=null&&_(e,["toolConfig"],YI(p)),f(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function CI(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);e!==void 0&&r!=null&&_(e,["expireTime"],r);const u=f(n,["displayName"]);e!==void 0&&u!=null&&_(e,["displayName"],u);const c=f(n,["contents"]);if(e!==void 0&&c!=null){let A=Ss(c);Array.isArray(A)&&(A=A.map(b=>b)),_(e,["contents"],A)}const m=f(n,["systemInstruction"]);e!==void 0&&m!=null&&_(e,["systemInstruction"],ri(m));const g=f(n,["tools"]);if(e!==void 0&&g!=null){let A=g;Array.isArray(A)&&(A=A.map(b=>WI(b))),_(e,["tools"],A)}const p=f(n,["toolConfig"]);e!==void 0&&p!=null&&_(e,["toolConfig"],p);const x=f(n,["kmsKeyName"]);return e!==void 0&&x!=null&&_(e,["encryption_spec","kmsKeyName"],x),t}function bI(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["model"],jx(n,i));const r=f(e,["config"]);return r!=null&&AI(r,t),t}function II(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["model"],jx(n,i));const r=f(e,["config"]);return r!=null&&CI(r,t),t}function NI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],ar(n,i)),t}function RI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],ar(n,i)),t}function MI(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function PI(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function DI(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function kI(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function LI(n){const e={},t=f(n,["mode"]);t!=null&&_(e,["mode"],t);const i=f(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function VI(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&_(e,["description"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["parameters"]);r!=null&&_(e,["parameters"],r);const u=f(n,["parametersJsonSchema"]);u!=null&&_(e,["parametersJsonSchema"],u);const c=f(n,["response"]);c!=null&&_(e,["response"],c);const m=f(n,["responseJsonSchema"]);return m!=null&&_(e,["responseJsonSchema"],m),e}function OI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],ar(n,i)),t}function UI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],ar(n,i)),t}function zI(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function BI(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function FI(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function qI(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function HI(n){const e={},t=f(n,["config"]);return t!=null&&FI(t,e),e}function GI(n){const e={},t=f(n,["config"]);return t!=null&&qI(t,e),e}function jI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["cachedContents"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["cachedContents"],u)}return e}function ZI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["cachedContents"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["cachedContents"],u)}return e}function KI(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const u=f(n,["fileData"]);u!=null&&_(e,["fileData"],DI(u));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],kI(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],SI(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const x=f(n,["thought"]);x!=null&&_(e,["thought"],x);const A=f(n,["thoughtSignature"]);A!=null&&_(e,["thoughtSignature"],A);const b=f(n,["videoMetadata"]);return b!=null&&_(e,["videoMetadata"],b),e}function YI(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],LI(t));const i=f(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function JI(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(A=>A)),_(e,["functionDeclarations"],x)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const u=f(n,["fileSearch"]);u!=null&&_(e,["fileSearch"],u);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],zI(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],BI(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function WI(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(b=>VI(b))),_(e,["functionDeclarations"],A)}const i=f(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=f(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const u=f(n,["computerUse"]);if(u!=null&&_(e,["computerUse"],u),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=f(n,["codeExecution"]);c!=null&&_(e,["codeExecution"],c);const m=f(n,["enterpriseWebSearch"]);m!=null&&_(e,["enterpriseWebSearch"],m);const g=f(n,["googleMaps"]);g!=null&&_(e,["googleMaps"],g);const p=f(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const x=f(n,["urlContext"]);return x!=null&&_(e,["urlContext"],x),e}function QI(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);return e!==void 0&&r!=null&&_(e,["expireTime"],r),t}function XI(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);return e!==void 0&&r!=null&&_(e,["expireTime"],r),t}function $I(n,e){const t={},i=f(e,["name"]);i!=null&&_(t,["_url","name"],ar(n,i));const r=f(e,["config"]);return r!=null&&QI(r,t),t}function e2(n,e){const t={},i=f(e,["name"]);i!=null&&_(t,["_url","name"],ar(n,i));const r=f(e,["config"]);return r!=null&&XI(r,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class t2 extends rr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ll(tr.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=II(this.apiClient,e);return m=Pe("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>x)}else{const p=bI(this.apiClient,e);return m=Pe("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>x)}}async get(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=UI(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>x)}else{const p=OI(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>x)}}async delete(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=RI(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=PI(x),b=new DT;return Object.assign(b,A),b})}else{const p=NI(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=MI(x),b=new DT;return Object.assign(b,A),b})}}async update(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=e2(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>x)}else{const p=$I(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>x)}}async listInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=GI(e);return m=Pe("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=ZI(x),b=new kT;return Object.assign(b,A),b})}else{const p=HI(e);return m=Pe("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=jI(x),b=new kT;return Object.assign(b,A),b})}}}function FT(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xt(n){return this instanceof Xt?(this.v=n,this):new Xt(n)}function iu(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,u=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",c),r[Symbol.asyncIterator]=function(){return this},r;function c(M){return function(K){return Promise.resolve(K).then(M,A)}}function m(M,K){i[M]&&(r[M]=function(G){return new Promise(function(z,W){u.push([M,G,z,W])>1||g(M,G)})},K&&(r[M]=K(r[M])))}function g(M,K){try{p(i[M](K))}catch(G){b(u[0][3],G)}}function p(M){M.value instanceof Xt?Promise.resolve(M.value.v).then(x,A):b(u[0][2],M)}function x(M){g("next",M)}function A(M){g("throw",M)}function b(M,K){M(K),u.shift(),u.length&&g(u[0][0],u[0][1])}}function Ac(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof FT=="function"?FT(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(u){t[u]=n[u]&&function(c){return new Promise(function(m,g){c=n[u](c),r(m,g,c.done,c.value)})}}function r(u,c,m,g){Promise.resolve(g).then(function(p){u({value:p,done:m})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n2(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:sw(t)}function sw(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function i2(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function qT(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const r=[];let u=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),u&&!sw(n[i])&&(u=!1),i++;u?e.push(...r):e.pop()}return e}class s2{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new o2(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class o2{constructor(e,t,i,r={},u=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=u,this.sendPromise=Promise.resolve(),i2(u)}async sendMessage(e){var t;await this.sendPromise;const i=ri(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var u,c,m;const g=await r,p=(c=(u=g.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content,x=g.automaticFunctionCallingHistory,A=this.getHistory(!0).length;let b=[];x!=null&&(b=(m=x.slice(A))!==null&&m!==void 0?m:[]);const M=p?[p]:[];this.recordHistory(i,M,b)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const i=ri(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const u=await r;return this.processStreamResponse(u,i)}getHistory(e=!1){const t=e?qT(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,r;return iu(this,arguments,function*(){var c,m,g,p;const x=[];try{for(var A=!0,b=Ac(e),M;M=yield Xt(b.next()),c=M.done,!c;A=!0){p=M.value,A=!1;const K=p;if(n2(K)){const G=(r=(i=K.candidates)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.content;G!==void 0&&x.push(G)}yield yield Xt(K)}}catch(K){m={error:K}}finally{try{!A&&!c&&(g=b.return)&&(yield Xt(g.call(b)))}finally{if(m)throw m.error}}this.recordHistory(t,x)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(u=>u.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...qT(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Jh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Jh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function r2(n){const e={},t=f(n,["file"]);return t!=null&&_(e,["file"],t),e}function a2(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function l2(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","file"],Qx(t)),e}function u2(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function c2(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","file"],Qx(t)),e}function d2(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function h2(n){const e={},t=f(n,["config"]);return t!=null&&d2(t,e),e}function f2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["files"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["files"],u)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class m2 extends rr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ll(tr.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=h2(e);return u=Pe("files",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>{const p=f2(g),x=new yb;return Object.assign(x,p),x})}}async createInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=r2(e);return u=Pe("upload/v1beta/files",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=a2(g),x=new vb;return Object.assign(x,p),x})}}async get(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=c2(e);return u=Pe("files/{file}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async delete(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=l2(e);return u=Pe("files/{file}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>{const p=u2(g),x=new Tb;return Object.assign(x,p),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fh(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function p2(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(u=>M2(u))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function g2(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function _2(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function y2(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&_(e,["description"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["parameters"]);r!=null&&_(e,["parameters"],r);const u=f(n,["parametersJsonSchema"]);u!=null&&_(e,["parametersJsonSchema"],u);const c=f(n,["response"]);c!=null&&_(e,["response"],c);const m=f(n,["responseJsonSchema"]);return m!=null&&_(e,["responseJsonSchema"],m),e}function v2(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&_(e,["modelConfig"],t);const i=f(n,["responseJsonSchema"]);i!=null&&_(e,["responseJsonSchema"],i);const r=f(n,["audioTimestamp"]);r!=null&&_(e,["audioTimestamp"],r);const u=f(n,["candidateCount"]);u!=null&&_(e,["candidateCount"],u);const c=f(n,["enableAffectiveDialog"]);c!=null&&_(e,["enableAffectiveDialog"],c);const m=f(n,["frequencyPenalty"]);m!=null&&_(e,["frequencyPenalty"],m);const g=f(n,["logprobs"]);g!=null&&_(e,["logprobs"],g);const p=f(n,["maxOutputTokens"]);p!=null&&_(e,["maxOutputTokens"],p);const x=f(n,["mediaResolution"]);x!=null&&_(e,["mediaResolution"],x);const A=f(n,["presencePenalty"]);A!=null&&_(e,["presencePenalty"],A);const b=f(n,["responseLogprobs"]);b!=null&&_(e,["responseLogprobs"],b);const M=f(n,["responseMimeType"]);M!=null&&_(e,["responseMimeType"],M);const K=f(n,["responseModalities"]);K!=null&&_(e,["responseModalities"],K);const G=f(n,["responseSchema"]);G!=null&&_(e,["responseSchema"],G);const z=f(n,["routingConfig"]);z!=null&&_(e,["routingConfig"],z);const W=f(n,["seed"]);W!=null&&_(e,["seed"],W);const te=f(n,["speechConfig"]);te!=null&&_(e,["speechConfig"],ow(te));const Q=f(n,["stopSequences"]);Q!=null&&_(e,["stopSequences"],Q);const me=f(n,["temperature"]);me!=null&&_(e,["temperature"],me);const de=f(n,["thinkingConfig"]);de!=null&&_(e,["thinkingConfig"],de);const fe=f(n,["topK"]);fe!=null&&_(e,["topK"],fe);const V=f(n,["topP"]);if(V!=null&&_(e,["topP"],V),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function T2(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function E2(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function x2(n,e){const t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],i);const r=f(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const u=f(n,["temperature"]);e!==void 0&&u!=null&&_(e,["setup","generationConfig","temperature"],u);const c=f(n,["topP"]);e!==void 0&&c!=null&&_(e,["setup","generationConfig","topP"],c);const m=f(n,["topK"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","topK"],m);const g=f(n,["maxOutputTokens"]);e!==void 0&&g!=null&&_(e,["setup","generationConfig","maxOutputTokens"],g);const p=f(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const x=f(n,["seed"]);e!==void 0&&x!=null&&_(e,["setup","generationConfig","seed"],x);const A=f(n,["speechConfig"]);e!==void 0&&A!=null&&_(e,["setup","generationConfig","speechConfig"],Eg(A));const b=f(n,["thinkingConfig"]);e!==void 0&&b!=null&&_(e,["setup","generationConfig","thinkingConfig"],b);const M=f(n,["enableAffectiveDialog"]);e!==void 0&&M!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],M);const K=f(n,["systemInstruction"]);e!==void 0&&K!=null&&_(e,["setup","systemInstruction"],p2(ri(K)));const G=f(n,["tools"]);if(e!==void 0&&G!=null){let fe=Eu(G);Array.isArray(fe)&&(fe=fe.map(V=>D2(Tu(V)))),_(e,["setup","tools"],fe)}const z=f(n,["sessionResumption"]);e!==void 0&&z!=null&&_(e,["setup","sessionResumption"],P2(z));const W=f(n,["inputAudioTranscription"]);e!==void 0&&W!=null&&_(e,["setup","inputAudioTranscription"],W);const te=f(n,["outputAudioTranscription"]);e!==void 0&&te!=null&&_(e,["setup","outputAudioTranscription"],te);const Q=f(n,["realtimeInputConfig"]);e!==void 0&&Q!=null&&_(e,["setup","realtimeInputConfig"],Q);const me=f(n,["contextWindowCompression"]);e!==void 0&&me!=null&&_(e,["setup","contextWindowCompression"],me);const de=f(n,["proactivity"]);return e!==void 0&&de!=null&&_(e,["setup","proactivity"],de),t}function w2(n,e){const t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],v2(i));const r=f(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const u=f(n,["temperature"]);e!==void 0&&u!=null&&_(e,["setup","generationConfig","temperature"],u);const c=f(n,["topP"]);e!==void 0&&c!=null&&_(e,["setup","generationConfig","topP"],c);const m=f(n,["topK"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","topK"],m);const g=f(n,["maxOutputTokens"]);e!==void 0&&g!=null&&_(e,["setup","generationConfig","maxOutputTokens"],g);const p=f(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const x=f(n,["seed"]);e!==void 0&&x!=null&&_(e,["setup","generationConfig","seed"],x);const A=f(n,["speechConfig"]);e!==void 0&&A!=null&&_(e,["setup","generationConfig","speechConfig"],ow(Eg(A)));const b=f(n,["thinkingConfig"]);e!==void 0&&b!=null&&_(e,["setup","generationConfig","thinkingConfig"],b);const M=f(n,["enableAffectiveDialog"]);e!==void 0&&M!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],M);const K=f(n,["systemInstruction"]);e!==void 0&&K!=null&&_(e,["setup","systemInstruction"],ri(K));const G=f(n,["tools"]);if(e!==void 0&&G!=null){let fe=Eu(G);Array.isArray(fe)&&(fe=fe.map(V=>k2(Tu(V)))),_(e,["setup","tools"],fe)}const z=f(n,["sessionResumption"]);e!==void 0&&z!=null&&_(e,["setup","sessionResumption"],z);const W=f(n,["inputAudioTranscription"]);e!==void 0&&W!=null&&_(e,["setup","inputAudioTranscription"],W);const te=f(n,["outputAudioTranscription"]);e!==void 0&&te!=null&&_(e,["setup","outputAudioTranscription"],te);const Q=f(n,["realtimeInputConfig"]);e!==void 0&&Q!=null&&_(e,["setup","realtimeInputConfig"],Q);const me=f(n,["contextWindowCompression"]);e!==void 0&&me!=null&&_(e,["setup","contextWindowCompression"],me);const de=f(n,["proactivity"]);return e!==void 0&&de!=null&&_(e,["setup","proactivity"],de),t}function S2(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["setup","model"],Rt(n,i));const r=f(e,["config"]);return r!=null&&_(t,["config"],x2(r,t)),t}function A2(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["setup","model"],Rt(n,i));const r=f(e,["config"]);return r!=null&&_(t,["config"],w2(r,t)),t}function C2(n){const e={},t=f(n,["musicGenerationConfig"]);return t!=null&&_(e,["musicGenerationConfig"],t),e}function b2(n){const e={},t=f(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["weightedPrompts"],i)}return e}function I2(n){const e={},t=f(n,["media"]);if(t!=null){let p=Zx(t);Array.isArray(p)&&(p=p.map(x=>fh(x))),_(e,["mediaChunks"],p)}const i=f(n,["audio"]);i!=null&&_(e,["audio"],fh(Yx(i)));const r=f(n,["audioStreamEnd"]);r!=null&&_(e,["audioStreamEnd"],r);const u=f(n,["video"]);u!=null&&_(e,["video"],fh(Kx(u)));const c=f(n,["text"]);c!=null&&_(e,["text"],c);const m=f(n,["activityStart"]);m!=null&&_(e,["activityStart"],m);const g=f(n,["activityEnd"]);return g!=null&&_(e,["activityEnd"],g),e}function N2(n){const e={},t=f(n,["media"]);if(t!=null){let p=Zx(t);Array.isArray(p)&&(p=p.map(x=>x)),_(e,["mediaChunks"],p)}const i=f(n,["audio"]);i!=null&&_(e,["audio"],Yx(i));const r=f(n,["audioStreamEnd"]);r!=null&&_(e,["audioStreamEnd"],r);const u=f(n,["video"]);u!=null&&_(e,["video"],Kx(u));const c=f(n,["text"]);c!=null&&_(e,["text"],c);const m=f(n,["activityStart"]);m!=null&&_(e,["activityStart"],m);const g=f(n,["activityEnd"]);return g!=null&&_(e,["activityEnd"],g),e}function R2(n){const e={},t=f(n,["setupComplete"]);t!=null&&_(e,["setupComplete"],t);const i=f(n,["serverContent"]);i!=null&&_(e,["serverContent"],i);const r=f(n,["toolCall"]);r!=null&&_(e,["toolCall"],r);const u=f(n,["toolCallCancellation"]);u!=null&&_(e,["toolCallCancellation"],u);const c=f(n,["usageMetadata"]);c!=null&&_(e,["usageMetadata"],L2(c));const m=f(n,["goAway"]);m!=null&&_(e,["goAway"],m);const g=f(n,["sessionResumptionUpdate"]);return g!=null&&_(e,["sessionResumptionUpdate"],g),e}function M2(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const u=f(n,["fileData"]);u!=null&&_(e,["fileData"],g2(u));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],_2(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],fh(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const x=f(n,["thought"]);x!=null&&_(e,["thought"],x);const A=f(n,["thoughtSignature"]);A!=null&&_(e,["thoughtSignature"],A);const b=f(n,["videoMetadata"]);return b!=null&&_(e,["videoMetadata"],b),e}function P2(n){const e={},t=f(n,["handle"]);if(t!=null&&_(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function ow(n){const e={},t=f(n,["languageCode"]);t!=null&&_(e,["languageCode"],t);const i=f(n,["voiceConfig"]);if(i!=null&&_(e,["voiceConfig"],i),f(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function D2(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(A=>A)),_(e,["functionDeclarations"],x)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const u=f(n,["fileSearch"]);u!=null&&_(e,["fileSearch"],u);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],T2(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],E2(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function k2(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(b=>y2(b))),_(e,["functionDeclarations"],A)}const i=f(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=f(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const u=f(n,["computerUse"]);if(u!=null&&_(e,["computerUse"],u),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=f(n,["codeExecution"]);c!=null&&_(e,["codeExecution"],c);const m=f(n,["enterpriseWebSearch"]);m!=null&&_(e,["enterpriseWebSearch"],m);const g=f(n,["googleMaps"]);g!=null&&_(e,["googleMaps"],g);const p=f(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const x=f(n,["urlContext"]);return x!=null&&_(e,["urlContext"],x),e}function L2(n){const e={},t=f(n,["promptTokenCount"]);t!=null&&_(e,["promptTokenCount"],t);const i=f(n,["cachedContentTokenCount"]);i!=null&&_(e,["cachedContentTokenCount"],i);const r=f(n,["candidatesTokenCount"]);r!=null&&_(e,["responseTokenCount"],r);const u=f(n,["toolUsePromptTokenCount"]);u!=null&&_(e,["toolUsePromptTokenCount"],u);const c=f(n,["thoughtsTokenCount"]);c!=null&&_(e,["thoughtsTokenCount"],c);const m=f(n,["totalTokenCount"]);m!=null&&_(e,["totalTokenCount"],m);const g=f(n,["promptTokensDetails"]);if(g!=null){let M=g;Array.isArray(M)&&(M=M.map(K=>K)),_(e,["promptTokensDetails"],M)}const p=f(n,["cacheTokensDetails"]);if(p!=null){let M=p;Array.isArray(M)&&(M=M.map(K=>K)),_(e,["cacheTokensDetails"],M)}const x=f(n,["candidatesTokensDetails"]);if(x!=null){let M=x;Array.isArray(M)&&(M=M.map(K=>K)),_(e,["responseTokensDetails"],M)}const A=f(n,["toolUsePromptTokensDetails"]);if(A!=null){let M=A;Array.isArray(M)&&(M=M.map(K=>K)),_(e,["toolUsePromptTokensDetails"],M)}const b=f(n,["trafficType"]);return b!=null&&_(e,["trafficType"],b),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function V2(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function O2(n){const e={},t=f(n,["content"]);t!=null&&_(e,["content"],t);const i=f(n,["citationMetadata"]);i!=null&&_(e,["citationMetadata"],U2(i));const r=f(n,["tokenCount"]);r!=null&&_(e,["tokenCount"],r);const u=f(n,["finishReason"]);u!=null&&_(e,["finishReason"],u);const c=f(n,["avgLogprobs"]);c!=null&&_(e,["avgLogprobs"],c);const m=f(n,["groundingMetadata"]);m!=null&&_(e,["groundingMetadata"],m);const g=f(n,["index"]);g!=null&&_(e,["index"],g);const p=f(n,["logprobsResult"]);p!=null&&_(e,["logprobsResult"],p);const x=f(n,["safetyRatings"]);if(x!=null){let b=x;Array.isArray(b)&&(b=b.map(M=>M)),_(e,["safetyRatings"],b)}const A=f(n,["urlContextMetadata"]);return A!=null&&_(e,["urlContextMetadata"],A),e}function U2(n){const e={},t=f(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["citations"],i)}return e}function z2(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["contents"]);if(r!=null){let u=Ss(r);Array.isArray(u)&&(u=u.map(c=>c)),_(t,["contents"],u)}return t}function B2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["tokensInfo"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(u=>u)),_(e,["tokensInfo"],r)}return e}function F2(n){const e={},t=f(n,["values"]);t!=null&&_(e,["values"],t);const i=f(n,["statistics"]);return i!=null&&_(e,["statistics"],q2(i)),e}function q2(n){const e={},t=f(n,["truncated"]);t!=null&&_(e,["truncated"],t);const i=f(n,["token_count"]);return i!=null&&_(e,["tokenCount"],i),e}function Wh(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(u=>QN(u))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function H2(n){const e={},t=f(n,["controlType"]);t!=null&&_(e,["controlType"],t);const i=f(n,["enableControlImageComputation"]);return i!=null&&_(e,["computeControl"],i),e}function G2(n){const e={};if(f(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function j2(n,e){const t={},i=f(n,["systemInstruction"]);e!==void 0&&i!=null&&_(e,["systemInstruction"],ri(i));const r=f(n,["tools"]);if(e!==void 0&&r!=null){let c=r;Array.isArray(c)&&(c=c.map(m=>cw(m))),_(e,["tools"],c)}const u=f(n,["generationConfig"]);return e!==void 0&&u!=null&&_(e,["generationConfig"],VN(u)),t}function Z2(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ss(r);Array.isArray(c)&&(c=c.map(m=>Wh(m))),_(t,["contents"],c)}const u=f(e,["config"]);return u!=null&&G2(u),t}function K2(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ss(r);Array.isArray(c)&&(c=c.map(m=>m)),_(t,["contents"],c)}const u=f(e,["config"]);return u!=null&&j2(u,t),t}function Y2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["totalTokens"]);i!=null&&_(e,["totalTokens"],i);const r=f(n,["cachedContentTokenCount"]);return r!=null&&_(e,["cachedContentTokenCount"],r),e}function J2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["totalTokens"]);return i!=null&&_(e,["totalTokens"],i),e}function W2(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Rt(n,i)),t}function Q2(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Rt(n,i)),t}function X2(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function $2(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function eN(n,e){const t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=f(n,["negativePrompt"]);e!==void 0&&r!=null&&_(e,["parameters","negativePrompt"],r);const u=f(n,["numberOfImages"]);e!==void 0&&u!=null&&_(e,["parameters","sampleCount"],u);const c=f(n,["aspectRatio"]);e!==void 0&&c!=null&&_(e,["parameters","aspectRatio"],c);const m=f(n,["guidanceScale"]);e!==void 0&&m!=null&&_(e,["parameters","guidanceScale"],m);const g=f(n,["seed"]);e!==void 0&&g!=null&&_(e,["parameters","seed"],g);const p=f(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&_(e,["parameters","safetySetting"],p);const x=f(n,["personGeneration"]);e!==void 0&&x!=null&&_(e,["parameters","personGeneration"],x);const A=f(n,["includeSafetyAttributes"]);e!==void 0&&A!=null&&_(e,["parameters","includeSafetyAttributes"],A);const b=f(n,["includeRaiReason"]);e!==void 0&&b!=null&&_(e,["parameters","includeRaiReason"],b);const M=f(n,["language"]);e!==void 0&&M!=null&&_(e,["parameters","language"],M);const K=f(n,["outputMimeType"]);e!==void 0&&K!=null&&_(e,["parameters","outputOptions","mimeType"],K);const G=f(n,["outputCompressionQuality"]);e!==void 0&&G!=null&&_(e,["parameters","outputOptions","compressionQuality"],G);const z=f(n,["addWatermark"]);e!==void 0&&z!=null&&_(e,["parameters","addWatermark"],z);const W=f(n,["labels"]);e!==void 0&&W!=null&&_(e,["labels"],W);const te=f(n,["editMode"]);e!==void 0&&te!=null&&_(e,["parameters","editMode"],te);const Q=f(n,["baseSteps"]);return e!==void 0&&Q!=null&&_(e,["parameters","editConfig","baseSteps"],Q),t}function tN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const u=f(e,["referenceImages"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>iR(g))),_(t,["instances[0]","referenceImages"],m)}const c=f(e,["config"]);return c!=null&&eN(c,t),t}function nN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(u=>Qh(u))),_(e,["generatedImages"],r)}return e}function iN(n,e){const t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&_(e,["requests[]","taskType"],i);const r=f(n,["title"]);e!==void 0&&r!=null&&_(e,["requests[]","title"],r);const u=f(n,["outputDimensionality"]);if(e!==void 0&&u!=null&&_(e,["requests[]","outputDimensionality"],u),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function sN(n,e){const t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&_(e,["instances[]","task_type"],i);const r=f(n,["title"]);e!==void 0&&r!=null&&_(e,["instances[]","title"],r);const u=f(n,["outputDimensionality"]);e!==void 0&&u!=null&&_(e,["parameters","outputDimensionality"],u);const c=f(n,["mimeType"]);e!==void 0&&c!=null&&_(e,["instances[]","mimeType"],c);const m=f(n,["autoTruncate"]);return e!==void 0&&m!=null&&_(e,["parameters","autoTruncate"],m),t}function oN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["contents"]);if(r!=null){let m=yg(n,r);Array.isArray(m)&&(m=m.map(g=>g)),_(t,["requests[]","content"],m)}const u=f(e,["config"]);u!=null&&iN(u,t);const c=f(e,["model"]);return c!==void 0&&_(t,["requests[]","model"],Rt(n,c)),t}function rN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["contents"]);if(r!=null){let c=yg(n,r);Array.isArray(c)&&(c=c.map(m=>m)),_(t,["instances[]","content"],c)}const u=f(e,["config"]);return u!=null&&sN(u,t),t}function aN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["embeddings"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["embeddings"],u)}const r=f(n,["metadata"]);return r!=null&&_(e,["metadata"],r),e}function lN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions[]","embeddings"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>F2(c))),_(e,["embeddings"],u)}const r=f(n,["metadata"]);return r!=null&&_(e,["metadata"],r),e}function uN(n){const e={},t=f(n,["endpoint"]);t!=null&&_(e,["name"],t);const i=f(n,["deployedModelId"]);return i!=null&&_(e,["deployedModelId"],i),e}function cN(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function dN(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function hN(n){const e={},t=f(n,["mode"]);t!=null&&_(e,["mode"],t);const i=f(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function fN(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&_(e,["description"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["parameters"]);r!=null&&_(e,["parameters"],r);const u=f(n,["parametersJsonSchema"]);u!=null&&_(e,["parametersJsonSchema"],u);const c=f(n,["response"]);c!=null&&_(e,["response"],c);const m=f(n,["responseJsonSchema"]);return m!=null&&_(e,["responseJsonSchema"],m),e}function mN(n,e,t){const i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],Wh(ri(r)));const u=f(e,["temperature"]);u!=null&&_(i,["temperature"],u);const c=f(e,["topP"]);c!=null&&_(i,["topP"],c);const m=f(e,["topK"]);m!=null&&_(i,["topK"],m);const g=f(e,["candidateCount"]);g!=null&&_(i,["candidateCount"],g);const p=f(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const x=f(e,["stopSequences"]);x!=null&&_(i,["stopSequences"],x);const A=f(e,["responseLogprobs"]);A!=null&&_(i,["responseLogprobs"],A);const b=f(e,["logprobs"]);b!=null&&_(i,["logprobs"],b);const M=f(e,["presencePenalty"]);M!=null&&_(i,["presencePenalty"],M);const K=f(e,["frequencyPenalty"]);K!=null&&_(i,["frequencyPenalty"],K);const G=f(e,["seed"]);G!=null&&_(i,["seed"],G);const z=f(e,["responseMimeType"]);z!=null&&_(i,["responseMimeType"],z);const W=f(e,["responseSchema"]);W!=null&&_(i,["responseSchema"],vg(W));const te=f(e,["responseJsonSchema"]);if(te!=null&&_(i,["responseJsonSchema"],te),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const Q=f(e,["safetySettings"]);if(t!==void 0&&Q!=null){let Y=Q;Array.isArray(Y)&&(Y=Y.map(B=>sR(B))),_(t,["safetySettings"],Y)}const me=f(e,["tools"]);if(t!==void 0&&me!=null){let Y=Eu(me);Array.isArray(Y)&&(Y=Y.map(B=>dR(Tu(B)))),_(t,["tools"],Y)}const de=f(e,["toolConfig"]);if(t!==void 0&&de!=null&&_(t,["toolConfig"],cR(de)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const fe=f(e,["cachedContent"]);t!==void 0&&fe!=null&&_(t,["cachedContent"],ar(n,fe));const V=f(e,["responseModalities"]);V!=null&&_(i,["responseModalities"],V);const O=f(e,["mediaResolution"]);O!=null&&_(i,["mediaResolution"],O);const U=f(e,["speechConfig"]);if(U!=null&&_(i,["speechConfig"],Tg(U)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const H=f(e,["thinkingConfig"]);H!=null&&_(i,["thinkingConfig"],H);const F=f(e,["imageConfig"]);return F!=null&&_(i,["imageConfig"],FN(F)),i}function pN(n,e,t){const i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],ri(r));const u=f(e,["temperature"]);u!=null&&_(i,["temperature"],u);const c=f(e,["topP"]);c!=null&&_(i,["topP"],c);const m=f(e,["topK"]);m!=null&&_(i,["topK"],m);const g=f(e,["candidateCount"]);g!=null&&_(i,["candidateCount"],g);const p=f(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const x=f(e,["stopSequences"]);x!=null&&_(i,["stopSequences"],x);const A=f(e,["responseLogprobs"]);A!=null&&_(i,["responseLogprobs"],A);const b=f(e,["logprobs"]);b!=null&&_(i,["logprobs"],b);const M=f(e,["presencePenalty"]);M!=null&&_(i,["presencePenalty"],M);const K=f(e,["frequencyPenalty"]);K!=null&&_(i,["frequencyPenalty"],K);const G=f(e,["seed"]);G!=null&&_(i,["seed"],G);const z=f(e,["responseMimeType"]);z!=null&&_(i,["responseMimeType"],z);const W=f(e,["responseSchema"]);W!=null&&_(i,["responseSchema"],vg(W));const te=f(e,["responseJsonSchema"]);te!=null&&_(i,["responseJsonSchema"],te);const Q=f(e,["routingConfig"]);Q!=null&&_(i,["routingConfig"],Q);const me=f(e,["modelSelectionConfig"]);me!=null&&_(i,["modelConfig"],me);const de=f(e,["safetySettings"]);if(t!==void 0&&de!=null){let oe=de;Array.isArray(oe)&&(oe=oe.map(Ae=>Ae)),_(t,["safetySettings"],oe)}const fe=f(e,["tools"]);if(t!==void 0&&fe!=null){let oe=Eu(fe);Array.isArray(oe)&&(oe=oe.map(Ae=>cw(Tu(Ae)))),_(t,["tools"],oe)}const V=f(e,["toolConfig"]);t!==void 0&&V!=null&&_(t,["toolConfig"],V);const O=f(e,["labels"]);t!==void 0&&O!=null&&_(t,["labels"],O);const U=f(e,["cachedContent"]);t!==void 0&&U!=null&&_(t,["cachedContent"],ar(n,U));const H=f(e,["responseModalities"]);H!=null&&_(i,["responseModalities"],H);const F=f(e,["mediaResolution"]);F!=null&&_(i,["mediaResolution"],F);const Y=f(e,["speechConfig"]);Y!=null&&_(i,["speechConfig"],uw(Tg(Y)));const B=f(e,["audioTimestamp"]);B!=null&&_(i,["audioTimestamp"],B);const Ke=f(e,["thinkingConfig"]);Ke!=null&&_(i,["thinkingConfig"],Ke);const mt=f(e,["imageConfig"]);return mt!=null&&_(i,["imageConfig"],qN(mt)),i}function HT(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ss(r);Array.isArray(c)&&(c=c.map(m=>Wh(m))),_(t,["contents"],c)}const u=f(e,["config"]);return u!=null&&_(t,["generationConfig"],mN(n,u,t)),t}function GT(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ss(r);Array.isArray(c)&&(c=c.map(m=>m)),_(t,["contents"],c)}const u=f(e,["config"]);return u!=null&&_(t,["generationConfig"],pN(n,u,t)),t}function jT(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(p=>O2(p))),_(e,["candidates"],g)}const r=f(n,["modelVersion"]);r!=null&&_(e,["modelVersion"],r);const u=f(n,["promptFeedback"]);u!=null&&_(e,["promptFeedback"],u);const c=f(n,["responseId"]);c!=null&&_(e,["responseId"],c);const m=f(n,["usageMetadata"]);return m!=null&&_(e,["usageMetadata"],m),e}function ZT(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(x=>x)),_(e,["candidates"],p)}const r=f(n,["createTime"]);r!=null&&_(e,["createTime"],r);const u=f(n,["modelVersion"]);u!=null&&_(e,["modelVersion"],u);const c=f(n,["promptFeedback"]);c!=null&&_(e,["promptFeedback"],c);const m=f(n,["responseId"]);m!=null&&_(e,["responseId"],m);const g=f(n,["usageMetadata"]);return g!=null&&_(e,["usageMetadata"],g),e}function gN(n,e){const t={};if(f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=f(n,["numberOfImages"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=f(n,["aspectRatio"]);e!==void 0&&r!=null&&_(e,["parameters","aspectRatio"],r);const u=f(n,["guidanceScale"]);if(e!==void 0&&u!=null&&_(e,["parameters","guidanceScale"],u),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=f(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&_(e,["parameters","safetySetting"],c);const m=f(n,["personGeneration"]);e!==void 0&&m!=null&&_(e,["parameters","personGeneration"],m);const g=f(n,["includeSafetyAttributes"]);e!==void 0&&g!=null&&_(e,["parameters","includeSafetyAttributes"],g);const p=f(n,["includeRaiReason"]);e!==void 0&&p!=null&&_(e,["parameters","includeRaiReason"],p);const x=f(n,["language"]);e!==void 0&&x!=null&&_(e,["parameters","language"],x);const A=f(n,["outputMimeType"]);e!==void 0&&A!=null&&_(e,["parameters","outputOptions","mimeType"],A);const b=f(n,["outputCompressionQuality"]);if(e!==void 0&&b!=null&&_(e,["parameters","outputOptions","compressionQuality"],b),f(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=f(n,["imageSize"]);if(e!==void 0&&M!=null&&_(e,["parameters","sampleImageSize"],M),f(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function _N(n,e){const t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=f(n,["negativePrompt"]);e!==void 0&&r!=null&&_(e,["parameters","negativePrompt"],r);const u=f(n,["numberOfImages"]);e!==void 0&&u!=null&&_(e,["parameters","sampleCount"],u);const c=f(n,["aspectRatio"]);e!==void 0&&c!=null&&_(e,["parameters","aspectRatio"],c);const m=f(n,["guidanceScale"]);e!==void 0&&m!=null&&_(e,["parameters","guidanceScale"],m);const g=f(n,["seed"]);e!==void 0&&g!=null&&_(e,["parameters","seed"],g);const p=f(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&_(e,["parameters","safetySetting"],p);const x=f(n,["personGeneration"]);e!==void 0&&x!=null&&_(e,["parameters","personGeneration"],x);const A=f(n,["includeSafetyAttributes"]);e!==void 0&&A!=null&&_(e,["parameters","includeSafetyAttributes"],A);const b=f(n,["includeRaiReason"]);e!==void 0&&b!=null&&_(e,["parameters","includeRaiReason"],b);const M=f(n,["language"]);e!==void 0&&M!=null&&_(e,["parameters","language"],M);const K=f(n,["outputMimeType"]);e!==void 0&&K!=null&&_(e,["parameters","outputOptions","mimeType"],K);const G=f(n,["outputCompressionQuality"]);e!==void 0&&G!=null&&_(e,["parameters","outputOptions","compressionQuality"],G);const z=f(n,["addWatermark"]);e!==void 0&&z!=null&&_(e,["parameters","addWatermark"],z);const W=f(n,["labels"]);e!==void 0&&W!=null&&_(e,["labels"],W);const te=f(n,["imageSize"]);e!==void 0&&te!=null&&_(e,["parameters","sampleImageSize"],te);const Q=f(n,["enhancePrompt"]);return e!==void 0&&Q!=null&&_(e,["parameters","enhancePrompt"],Q),t}function yN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const u=f(e,["config"]);return u!=null&&gN(u,t),t}function vN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const u=f(e,["config"]);return u!=null&&_N(u,t),t}function TN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>PN(c))),_(e,["generatedImages"],u)}const r=f(n,["positivePromptSafetyAttributes"]);return r!=null&&_(e,["positivePromptSafetyAttributes"],aw(r)),e}function EN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>Qh(c))),_(e,["generatedImages"],u)}const r=f(n,["positivePromptSafetyAttributes"]);return r!=null&&_(e,["positivePromptSafetyAttributes"],lw(r)),e}function xN(n,e){const t={},i=f(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i),f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=f(n,["durationSeconds"]);if(e!==void 0&&r!=null&&_(e,["parameters","durationSeconds"],r),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=f(n,["aspectRatio"]);e!==void 0&&u!=null&&_(e,["parameters","aspectRatio"],u);const c=f(n,["resolution"]);e!==void 0&&c!=null&&_(e,["parameters","resolution"],c);const m=f(n,["personGeneration"]);if(e!==void 0&&m!=null&&_(e,["parameters","personGeneration"],m),f(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const g=f(n,["negativePrompt"]);e!==void 0&&g!=null&&_(e,["parameters","negativePrompt"],g);const p=f(n,["enhancePrompt"]);if(e!==void 0&&p!=null&&_(e,["parameters","enhancePrompt"],p),f(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const x=f(n,["lastFrame"]);e!==void 0&&x!=null&&_(e,["instances[0]","lastFrame"],Xh(x));const A=f(n,["referenceImages"]);if(e!==void 0&&A!=null){let b=A;Array.isArray(b)&&(b=b.map(M=>SR(M))),_(e,["instances[0]","referenceImages"],b)}if(f(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function wN(n,e){const t={},i=f(n,["numberOfVideos"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=f(n,["outputGcsUri"]);e!==void 0&&r!=null&&_(e,["parameters","storageUri"],r);const u=f(n,["fps"]);e!==void 0&&u!=null&&_(e,["parameters","fps"],u);const c=f(n,["durationSeconds"]);e!==void 0&&c!=null&&_(e,["parameters","durationSeconds"],c);const m=f(n,["seed"]);e!==void 0&&m!=null&&_(e,["parameters","seed"],m);const g=f(n,["aspectRatio"]);e!==void 0&&g!=null&&_(e,["parameters","aspectRatio"],g);const p=f(n,["resolution"]);e!==void 0&&p!=null&&_(e,["parameters","resolution"],p);const x=f(n,["personGeneration"]);e!==void 0&&x!=null&&_(e,["parameters","personGeneration"],x);const A=f(n,["pubsubTopic"]);e!==void 0&&A!=null&&_(e,["parameters","pubsubTopic"],A);const b=f(n,["negativePrompt"]);e!==void 0&&b!=null&&_(e,["parameters","negativePrompt"],b);const M=f(n,["enhancePrompt"]);e!==void 0&&M!=null&&_(e,["parameters","enhancePrompt"],M);const K=f(n,["generateAudio"]);e!==void 0&&K!=null&&_(e,["parameters","generateAudio"],K);const G=f(n,["lastFrame"]);e!==void 0&&G!=null&&_(e,["instances[0]","lastFrame"],Zs(G));const z=f(n,["referenceImages"]);if(e!==void 0&&z!=null){let Q=z;Array.isArray(Q)&&(Q=Q.map(me=>AR(me))),_(e,["instances[0]","referenceImages"],Q)}const W=f(n,["mask"]);e!==void 0&&W!=null&&_(e,["instances[0]","mask"],wR(W));const te=f(n,["compressionQuality"]);return e!==void 0&&te!=null&&_(e,["parameters","compressionQuality"],te),t}function SN(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response","generateVideoResponse"]);return c!=null&&_(e,["response"],IN(c)),e}function AN(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response"]);return c!=null&&_(e,["response"],NN(c)),e}function CN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const u=f(e,["image"]);u!=null&&_(t,["instances[0]","image"],Xh(u));const c=f(e,["video"]);c!=null&&_(t,["instances[0]","video"],dw(c));const m=f(e,["source"]);m!=null&&RN(m,t);const g=f(e,["config"]);return g!=null&&xN(g,t),t}function bN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const u=f(e,["image"]);u!=null&&_(t,["instances[0]","image"],Zs(u));const c=f(e,["video"]);c!=null&&_(t,["instances[0]","video"],hw(c));const m=f(e,["source"]);m!=null&&MN(m,t);const g=f(e,["config"]);return g!=null&&wN(g,t),t}function IN(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let u=t;Array.isArray(u)&&(u=u.map(c=>kN(c))),_(e,["generatedVideos"],u)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function NN(n){const e={},t=f(n,["videos"]);if(t!=null){let u=t;Array.isArray(u)&&(u=u.map(c=>LN(c))),_(e,["generatedVideos"],u)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function RN(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],Xh(r));const u=f(n,["video"]);return e!==void 0&&u!=null&&_(e,["instances[0]","video"],dw(u)),t}function MN(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],Zs(r));const u=f(n,["video"]);return e!==void 0&&u!=null&&_(e,["instances[0]","video"],hw(u)),t}function PN(n){const e={},t=f(n,["_self"]);t!=null&&_(e,["image"],HN(t));const i=f(n,["raiFilteredReason"]);i!=null&&_(e,["raiFilteredReason"],i);const r=f(n,["_self"]);return r!=null&&_(e,["safetyAttributes"],aw(r)),e}function Qh(n){const e={},t=f(n,["_self"]);t!=null&&_(e,["image"],rw(t));const i=f(n,["raiFilteredReason"]);i!=null&&_(e,["raiFilteredReason"],i);const r=f(n,["_self"]);r!=null&&_(e,["safetyAttributes"],lw(r));const u=f(n,["prompt"]);return u!=null&&_(e,["enhancedPrompt"],u),e}function DN(n){const e={},t=f(n,["_self"]);t!=null&&_(e,["mask"],rw(t));const i=f(n,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(u=>u)),_(e,["labels"],r)}return e}function kN(n){const e={},t=f(n,["video"]);return t!=null&&_(e,["video"],ER(t)),e}function LN(n){const e={},t=f(n,["_self"]);return t!=null&&_(e,["video"],xR(t)),e}function VN(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&_(e,["modelConfig"],t);const i=f(n,["responseJsonSchema"]);i!=null&&_(e,["responseJsonSchema"],i);const r=f(n,["audioTimestamp"]);r!=null&&_(e,["audioTimestamp"],r);const u=f(n,["candidateCount"]);u!=null&&_(e,["candidateCount"],u);const c=f(n,["enableAffectiveDialog"]);c!=null&&_(e,["enableAffectiveDialog"],c);const m=f(n,["frequencyPenalty"]);m!=null&&_(e,["frequencyPenalty"],m);const g=f(n,["logprobs"]);g!=null&&_(e,["logprobs"],g);const p=f(n,["maxOutputTokens"]);p!=null&&_(e,["maxOutputTokens"],p);const x=f(n,["mediaResolution"]);x!=null&&_(e,["mediaResolution"],x);const A=f(n,["presencePenalty"]);A!=null&&_(e,["presencePenalty"],A);const b=f(n,["responseLogprobs"]);b!=null&&_(e,["responseLogprobs"],b);const M=f(n,["responseMimeType"]);M!=null&&_(e,["responseMimeType"],M);const K=f(n,["responseModalities"]);K!=null&&_(e,["responseModalities"],K);const G=f(n,["responseSchema"]);G!=null&&_(e,["responseSchema"],G);const z=f(n,["routingConfig"]);z!=null&&_(e,["routingConfig"],z);const W=f(n,["seed"]);W!=null&&_(e,["seed"],W);const te=f(n,["speechConfig"]);te!=null&&_(e,["speechConfig"],uw(te));const Q=f(n,["stopSequences"]);Q!=null&&_(e,["stopSequences"],Q);const me=f(n,["temperature"]);me!=null&&_(e,["temperature"],me);const de=f(n,["thinkingConfig"]);de!=null&&_(e,["thinkingConfig"],de);const fe=f(n,["topK"]);fe!=null&&_(e,["topK"],fe);const V=f(n,["topP"]);if(V!=null&&_(e,["topP"],V),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function ON(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Rt(n,i)),t}function UN(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Rt(n,i)),t}function zN(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function BN(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function FN(n){const e={},t=f(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=f(n,["imageSize"]);if(i!=null&&_(e,["imageSize"],i),f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function qN(n){const e={},t=f(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=f(n,["imageSize"]);i!=null&&_(e,["imageSize"],i);const r=f(n,["outputMimeType"]);r!=null&&_(e,["imageOutputOptions","mimeType"],r);const u=f(n,["outputCompressionQuality"]);return u!=null&&_(e,["imageOutputOptions","compressionQuality"],u),e}function HN(n){const e={},t=f(n,["bytesBase64Encoded"]);t!=null&&_(e,["imageBytes"],da(t));const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function rw(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["gcsUri"],t);const i=f(n,["bytesBase64Encoded"]);i!=null&&_(e,["imageBytes"],da(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function Xh(n){const e={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=f(n,["imageBytes"]);t!=null&&_(e,["bytesBase64Encoded"],da(t));const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function Zs(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["gcsUri"],t);const i=f(n,["imageBytes"]);i!=null&&_(e,["bytesBase64Encoded"],da(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function GN(n,e,t){const i={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&_(t,["_query","pageSize"],r);const u=f(e,["pageToken"]);t!==void 0&&u!=null&&_(t,["_query","pageToken"],u);const c=f(e,["filter"]);t!==void 0&&c!=null&&_(t,["_query","filter"],c);const m=f(e,["queryBase"]);return t!==void 0&&m!=null&&_(t,["_url","models_url"],Xx(n,m)),i}function jN(n,e,t){const i={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&_(t,["_query","pageSize"],r);const u=f(e,["pageToken"]);t!==void 0&&u!=null&&_(t,["_query","pageToken"],u);const c=f(e,["filter"]);t!==void 0&&c!=null&&_(t,["_query","filter"],c);const m=f(e,["queryBase"]);return t!==void 0&&m!=null&&_(t,["_url","models_url"],Xx(n,m)),i}function ZN(n,e){const t={},i=f(e,["config"]);return i!=null&&GN(n,i,t),t}function KN(n,e){const t={},i=f(e,["config"]);return i!=null&&jN(n,i,t),t}function YN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["_self"]);if(r!=null){let u=$x(r);Array.isArray(u)&&(u=u.map(c=>kp(c))),_(e,["models"],u)}return e}function JN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["_self"]);if(r!=null){let u=$x(r);Array.isArray(u)&&(u=u.map(c=>Lp(c))),_(e,["models"],u)}return e}function WN(n){const e={},t=f(n,["maskMode"]);t!=null&&_(e,["maskMode"],t);const i=f(n,["segmentationClasses"]);i!=null&&_(e,["maskClasses"],i);const r=f(n,["maskDilation"]);return r!=null&&_(e,["dilation"],r),e}function kp(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);r!=null&&_(e,["description"],r);const u=f(n,["version"]);u!=null&&_(e,["version"],u);const c=f(n,["_self"]);c!=null&&_(e,["tunedModelInfo"],hR(c));const m=f(n,["inputTokenLimit"]);m!=null&&_(e,["inputTokenLimit"],m);const g=f(n,["outputTokenLimit"]);g!=null&&_(e,["outputTokenLimit"],g);const p=f(n,["supportedGenerationMethods"]);p!=null&&_(e,["supportedActions"],p);const x=f(n,["temperature"]);x!=null&&_(e,["temperature"],x);const A=f(n,["maxTemperature"]);A!=null&&_(e,["maxTemperature"],A);const b=f(n,["topP"]);b!=null&&_(e,["topP"],b);const M=f(n,["topK"]);M!=null&&_(e,["topK"],M);const K=f(n,["thinking"]);return K!=null&&_(e,["thinking"],K),e}function Lp(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);r!=null&&_(e,["description"],r);const u=f(n,["versionId"]);u!=null&&_(e,["version"],u);const c=f(n,["deployedModels"]);if(c!=null){let A=c;Array.isArray(A)&&(A=A.map(b=>uN(b))),_(e,["endpoints"],A)}const m=f(n,["labels"]);m!=null&&_(e,["labels"],m);const g=f(n,["_self"]);g!=null&&_(e,["tunedModelInfo"],fR(g));const p=f(n,["defaultCheckpointId"]);p!=null&&_(e,["defaultCheckpointId"],p);const x=f(n,["checkpoints"]);if(x!=null){let A=x;Array.isArray(A)&&(A=A.map(b=>b)),_(e,["checkpoints"],A)}return e}function QN(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const u=f(n,["fileData"]);u!=null&&_(e,["fileData"],cN(u));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],dN(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],V2(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const x=f(n,["thought"]);x!=null&&_(e,["thought"],x);const A=f(n,["thoughtSignature"]);A!=null&&_(e,["thoughtSignature"],A);const b=f(n,["videoMetadata"]);return b!=null&&_(e,["videoMetadata"],b),e}function XN(n){const e={},t=f(n,["productImage"]);return t!=null&&_(e,["image"],Zs(t)),e}function $N(n,e){const t={},i=f(n,["numberOfImages"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=f(n,["baseSteps"]);e!==void 0&&r!=null&&_(e,["parameters","baseSteps"],r);const u=f(n,["outputGcsUri"]);e!==void 0&&u!=null&&_(e,["parameters","storageUri"],u);const c=f(n,["seed"]);e!==void 0&&c!=null&&_(e,["parameters","seed"],c);const m=f(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&_(e,["parameters","safetySetting"],m);const g=f(n,["personGeneration"]);e!==void 0&&g!=null&&_(e,["parameters","personGeneration"],g);const p=f(n,["addWatermark"]);e!==void 0&&p!=null&&_(e,["parameters","addWatermark"],p);const x=f(n,["outputMimeType"]);e!==void 0&&x!=null&&_(e,["parameters","outputOptions","mimeType"],x);const A=f(n,["outputCompressionQuality"]);e!==void 0&&A!=null&&_(e,["parameters","outputOptions","compressionQuality"],A);const b=f(n,["enhancePrompt"]);e!==void 0&&b!=null&&_(e,["parameters","enhancePrompt"],b);const M=f(n,["labels"]);return e!==void 0&&M!=null&&_(e,["labels"],M),t}function eR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["source"]);r!=null&&nR(r,t);const u=f(e,["config"]);return u!=null&&$N(u,t),t}function tR(n){const e={},t=f(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>Qh(r))),_(e,["generatedImages"],i)}return e}function nR(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["personImage"]);e!==void 0&&r!=null&&_(e,["instances[0]","personImage","image"],Zs(r));const u=f(n,["productImages"]);if(e!==void 0&&u!=null){let c=u;Array.isArray(c)&&(c=c.map(m=>XN(m))),_(e,["instances[0]","productImages"],c)}return t}function iR(n){const e={},t=f(n,["referenceImage"]);t!=null&&_(e,["referenceImage"],Zs(t));const i=f(n,["referenceId"]);i!=null&&_(e,["referenceId"],i);const r=f(n,["referenceType"]);r!=null&&_(e,["referenceType"],r);const u=f(n,["maskImageConfig"]);u!=null&&_(e,["maskImageConfig"],WN(u));const c=f(n,["controlImageConfig"]);c!=null&&_(e,["controlImageConfig"],H2(c));const m=f(n,["styleImageConfig"]);m!=null&&_(e,["styleImageConfig"],m);const g=f(n,["subjectImageConfig"]);return g!=null&&_(e,["subjectImageConfig"],g),e}function aw(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&_(e,["categories"],t);const i=f(n,["safetyAttributes","scores"]);i!=null&&_(e,["scores"],i);const r=f(n,["contentType"]);return r!=null&&_(e,["contentType"],r),e}function lw(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&_(e,["categories"],t);const i=f(n,["safetyAttributes","scores"]);i!=null&&_(e,["scores"],i);const r=f(n,["contentType"]);return r!=null&&_(e,["contentType"],r),e}function sR(n){const e={},t=f(n,["category"]);if(t!=null&&_(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=f(n,["threshold"]);return i!=null&&_(e,["threshold"],i),e}function oR(n){const e={},t=f(n,["image"]);return t!=null&&_(e,["image"],Zs(t)),e}function rR(n,e){const t={},i=f(n,["mode"]);e!==void 0&&i!=null&&_(e,["parameters","mode"],i);const r=f(n,["maxPredictions"]);e!==void 0&&r!=null&&_(e,["parameters","maxPredictions"],r);const u=f(n,["confidenceThreshold"]);e!==void 0&&u!=null&&_(e,["parameters","confidenceThreshold"],u);const c=f(n,["maskDilation"]);e!==void 0&&c!=null&&_(e,["parameters","maskDilation"],c);const m=f(n,["binaryColorThreshold"]);e!==void 0&&m!=null&&_(e,["parameters","binaryColorThreshold"],m);const g=f(n,["labels"]);return e!==void 0&&g!=null&&_(e,["labels"],g),t}function aR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["source"]);r!=null&&uR(r,t);const u=f(e,["config"]);return u!=null&&rR(u,t),t}function lR(n){const e={},t=f(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>DN(r))),_(e,["generatedMasks"],i)}return e}function uR(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],Zs(r));const u=f(n,["scribbleImage"]);return e!==void 0&&u!=null&&_(e,["instances[0]","scribble"],oR(u)),t}function uw(n){const e={},t=f(n,["languageCode"]);t!=null&&_(e,["languageCode"],t);const i=f(n,["voiceConfig"]);if(i!=null&&_(e,["voiceConfig"],i),f(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function cR(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],hN(t));const i=f(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function dR(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(A=>A)),_(e,["functionDeclarations"],x)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const u=f(n,["fileSearch"]);u!=null&&_(e,["fileSearch"],u);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],zN(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],BN(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function cw(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let A=t;Array.isArray(A)&&(A=A.map(b=>fN(b))),_(e,["functionDeclarations"],A)}const i=f(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=f(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const u=f(n,["computerUse"]);if(u!=null&&_(e,["computerUse"],u),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=f(n,["codeExecution"]);c!=null&&_(e,["codeExecution"],c);const m=f(n,["enterpriseWebSearch"]);m!=null&&_(e,["enterpriseWebSearch"],m);const g=f(n,["googleMaps"]);g!=null&&_(e,["googleMaps"],g);const p=f(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const x=f(n,["urlContext"]);return x!=null&&_(e,["urlContext"],x),e}function hR(n){const e={},t=f(n,["baseModel"]);t!=null&&_(e,["baseModel"],t);const i=f(n,["createTime"]);i!=null&&_(e,["createTime"],i);const r=f(n,["updateTime"]);return r!=null&&_(e,["updateTime"],r),e}function fR(n){const e={},t=f(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&_(e,["baseModel"],t);const i=f(n,["createTime"]);i!=null&&_(e,["createTime"],i);const r=f(n,["updateTime"]);return r!=null&&_(e,["updateTime"],r),e}function mR(n,e){const t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);e!==void 0&&r!=null&&_(e,["description"],r);const u=f(n,["defaultCheckpointId"]);return e!==void 0&&u!=null&&_(e,["defaultCheckpointId"],u),t}function pR(n,e){const t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);e!==void 0&&r!=null&&_(e,["description"],r);const u=f(n,["defaultCheckpointId"]);return e!==void 0&&u!=null&&_(e,["defaultCheckpointId"],u),t}function gR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","name"],Rt(n,i));const r=f(e,["config"]);return r!=null&&mR(r,t),t}function _R(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["config"]);return r!=null&&pR(r,t),t}function yR(n,e){const t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=f(n,["safetyFilterLevel"]);e!==void 0&&r!=null&&_(e,["parameters","safetySetting"],r);const u=f(n,["personGeneration"]);e!==void 0&&u!=null&&_(e,["parameters","personGeneration"],u);const c=f(n,["includeRaiReason"]);e!==void 0&&c!=null&&_(e,["parameters","includeRaiReason"],c);const m=f(n,["outputMimeType"]);e!==void 0&&m!=null&&_(e,["parameters","outputOptions","mimeType"],m);const g=f(n,["outputCompressionQuality"]);e!==void 0&&g!=null&&_(e,["parameters","outputOptions","compressionQuality"],g);const p=f(n,["enhanceInputImage"]);e!==void 0&&p!=null&&_(e,["parameters","upscaleConfig","enhanceInputImage"],p);const x=f(n,["imagePreservationFactor"]);e!==void 0&&x!=null&&_(e,["parameters","upscaleConfig","imagePreservationFactor"],x);const A=f(n,["labels"]);e!==void 0&&A!=null&&_(e,["labels"],A);const b=f(n,["numberOfImages"]);e!==void 0&&b!=null&&_(e,["parameters","sampleCount"],b);const M=f(n,["mode"]);return e!==void 0&&M!=null&&_(e,["parameters","mode"],M),t}function vR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Rt(n,i));const r=f(e,["image"]);r!=null&&_(t,["instances[0]","image"],Zs(r));const u=f(e,["upscaleFactor"]);u!=null&&_(t,["parameters","upscaleConfig","upscaleFactor"],u);const c=f(e,["config"]);return c!=null&&yR(c,t),t}function TR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(u=>Qh(u))),_(e,["generatedImages"],r)}return e}function ER(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["uri"],t);const i=f(n,["encodedVideo"]);i!=null&&_(e,["videoBytes"],da(i));const r=f(n,["encoding"]);return r!=null&&_(e,["mimeType"],r),e}function xR(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["uri"],t);const i=f(n,["bytesBase64Encoded"]);i!=null&&_(e,["videoBytes"],da(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function wR(n){const e={},t=f(n,["image"]);t!=null&&_(e,["_self"],Zs(t));const i=f(n,["maskMode"]);return i!=null&&_(e,["maskMode"],i),e}function SR(n){const e={},t=f(n,["image"]);t!=null&&_(e,["image"],Xh(t));const i=f(n,["referenceType"]);return i!=null&&_(e,["referenceType"],i),e}function AR(n){const e={},t=f(n,["image"]);t!=null&&_(e,["image"],Zs(t));const i=f(n,["referenceType"]);return i!=null&&_(e,["referenceType"],i),e}function dw(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["uri"],t);const i=f(n,["videoBytes"]);i!=null&&_(e,["encodedVideo"],da(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["encoding"],r),e}function hw(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["gcsUri"],t);const i=f(n,["videoBytes"]);i!=null&&_(e,["bytesBase64Encoded"],da(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const CR="Content-Type",bR="X-Server-Timeout",IR="User-Agent",Vp="x-goog-api-client",NR="1.30.0",RR=`google-genai-sdk/${NR}`,MR="v1beta1",PR="v1beta",KT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class DR{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:MR,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:PR,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[c,m]of Object.entries(e.queryParams))r.searchParams.append(c,String(m));let u={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else u.body=e.body;return u=await this.includeExtraHttpOptionsToRequestInit(u,t,r.toString(),e.abortSignal),this.unaryApiCall(r,u,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[r,u]of Object.entries(t))typeof u=="object"?i[r]=Object.assign(Object.assign({},i[r]),u):u!==void 0&&(i[r]=u);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let u={};return u.body=e.body,u=await this.includeExtraHttpOptionsToRequestInit(u,t,r.toString(),e.abortSignal),this.streamApiCall(r,u,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,r){if(t&&t.timeout||r){const u=new AbortController,c=u.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const m=setTimeout(()=>u.abort(),t.timeout);m&&typeof m.unref=="function"&&m.unref()}r&&r.addEventListener("abort",()=>{u.abort()}),e.signal=c}return t&&t.extraBody!==null&&kR(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await YT(r),new Mp(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await YT(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return iu(this,arguments,function*(){const r=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),u=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let c="";for(;;){const{done:m,value:g}=yield Xt(r.read());if(m){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=u.decode(g,{stream:!0});try{const A=JSON.parse(p);if("error"in A){const b=JSON.parse(JSON.stringify(A.error)),M=b.status,K=b.code,G=`got status: ${M}. ${JSON.stringify(A)}`;if(K>=400&&K<600)throw new Jh({message:G,status:K})}}catch(A){if(A.name==="ApiError")throw A}c+=p;let x=c.match(KT);for(;x;){const A=x[1];try{const b=new Response(A,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Xt(new Mp(b)),c=c.slice(x[0].length),x=c.match(KT)}catch(b){throw new Error(`exception parsing stream chunk ${A}. ${b}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=RR+" "+this.clientOptions.userAgentExtra;return e[IR]=t,e[Vp]=t,e[CR]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[r,u]of Object.entries(e.headers))i.append(r,u);e.timeout&&e.timeout>0&&i.append(bR,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const u=this.clientOptions.uploader,c=await u.stat(e);r.sizeBytes=String(c.size);const m=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:c.type;if(m===void 0||m==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=m;const g={file:r},p=this.getFileName(e),x=Pe("upload/v1beta/files",g._url),A=await this.fetchUploadUrl(x,r.sizeBytes,r.mimeType,p,g,t==null?void 0:t.httpOptions);return u.upload(e,A,this)}async uploadFileToFileSearchStore(e,t,i){var r;const u=this.clientOptions.uploader,c=await u.stat(t),m=String(c.size),g=(r=i==null?void 0:i.mimeType)!==null&&r!==void 0?r:c.type;if(g===void 0||g==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,x=this.getFileName(t),A={};i!=null&&i.customMetadata&&(A.customMetadata=i.customMetadata),i!=null&&i.chunkingConfig&&(A.chunkingConfig=i.chunkingConfig);const b=await this.fetchUploadUrl(p,m,g,x,A,i==null?void 0:i.httpOptions);return u.uploadToFileSearchStore(t,b,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,r,u,c){var m;let g={};c?g=c:g={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};const p=await this.request({path:e,body:JSON.stringify(u),httpMethod:"POST",httpOptions:g});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const x=(m=p==null?void 0:p.headers)===null||m===void 0?void 0:m["x-goog-upload-url"];if(x===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return x}}async function YT(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(i);throw t>=400&&t<600?new Jh({message:r,status:t}):new Error(r)}}function kR(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const u=JSON.parse(n.body);if(typeof u=="object"&&u!==null&&!Array.isArray(u))t=u;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(u,c){const m=Object.assign({},u);for(const g in c)if(Object.prototype.hasOwnProperty.call(c,g)){const p=c[g],x=m[g];p&&typeof p=="object"&&!Array.isArray(p)&&x&&typeof x=="object"&&!Array.isArray(x)?m[g]=i(x,p):(x&&p&&typeof x!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${g}". Original type: ${typeof x}, New type: ${typeof p}. Overwriting.`),m[g]=p)}return m}const r=i(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const LR="mcp_used/unknown";let VR=!1;function fw(n){for(const e of n)if(OR(e)||typeof e=="object"&&"inputSchema"in e)return!0;return VR}function mw(n){var e;const t=(e=n[Vp])!==null&&e!==void 0?e:"";n[Vp]=(t+` ${LR}`).trimStart()}function OR(n){return n!==null&&typeof n=="object"&&n instanceof xg}function UR(n,e=100){return iu(this,arguments,function*(){let i,r=0;for(;r<e;){const u=yield Xt(n.listTools({cursor:i}));for(const c of u.tools)yield yield Xt(c),r++;if(!u.nextCursor)break;i=u.nextCursor}})}class xg{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new xg(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;const u={},c=[];for(const x of this.mcpClients)try{for(var m=!0,g=(t=void 0,Ac(UR(x))),p;p=await g.next(),e=p.done,!e;m=!0){r=p.value,m=!1;const A=r;c.push(A);const b=A.name;if(u[b])throw new Error(`Duplicate function name ${b} found in MCP tools. Please ensure function names are unique.`);u[b]=x}}catch(A){t={error:A}}finally{try{!m&&!e&&(i=g.return)&&await i.call(g)}finally{if(t)throw t.error}}this.mcpTools=c,this.functionNameToMcpClient=u}async tool(){return await this.initialize(),Rb(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let u;this.config.timeout&&(u={timeout:this.config.timeout});const c=await r.callTool({name:i.name,arguments:i.args},void 0,u);t.push({functionResponse:{name:i.name,response:c.isError?{error:c}:c}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function zR(n,e,t){const i=new xb;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(i,r),e(i)}class BR{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion(),c=HR(this.apiClient.getDefaultHeaders()),m=this.apiClient.getApiKey(),g=`${r}/ws/google.ai.generativelanguage.${u}.GenerativeService.BidiGenerateMusic?key=${m}`;let p=()=>{};const x=new Promise(Q=>{p=Q}),A=e.callbacks,b=function(){p({})},M=this.apiClient,K={onopen:b,onmessage:Q=>{zR(M,A.onmessage,Q)},onerror:(t=A==null?void 0:A.onerror)!==null&&t!==void 0?t:function(Q){},onclose:(i=A==null?void 0:A.onclose)!==null&&i!==void 0?i:function(Q){}},G=this.webSocketFactory.create(g,qR(c),K);G.connect(),await x;const te={setup:{model:Rt(this.apiClient,e.model)}};return G.send(JSON.stringify(te)),new FR(G,this.apiClient)}}class FR{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=b2(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=C2(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(tu.PLAY)}pause(){this.sendPlaybackControl(tu.PAUSE)}stop(){this.sendPlaybackControl(tu.STOP)}resetContext(){this.sendPlaybackControl(tu.RESET_CONTEXT)}close(){this.conn.close()}}function qR(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function HR(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GR="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function jR(n,e,t){const i=new Eb;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const u=JSON.parse(r);if(n.isVertexAI()){const c=R2(u);Object.assign(i,c)}else Object.assign(i,u);e(i)}class ZR{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new BR(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,u,c,m;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const g=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let x;const A=this.apiClient.getHeaders();e.config&&e.config.tools&&fw(e.config.tools)&&mw(A);const b=WR(A);if(this.apiClient.isVertexAI())x=`${g}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(b,x);else{const U=this.apiClient.getApiKey();let H="BidiGenerateContent",F="key";U!=null&&U.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),H="BidiGenerateContentConstrained",F="access_token"),x=`${g}/ws/google.ai.generativelanguage.${p}.GenerativeService.${H}?${F}=${U}`}let M=()=>{};const K=new Promise(U=>{M=U}),G=e.callbacks,z=function(){var U;(U=G==null?void 0:G.onopen)===null||U===void 0||U.call(G),M({})},W=this.apiClient,te={onopen:z,onmessage:U=>{jR(W,G.onmessage,U)},onerror:(t=G==null?void 0:G.onerror)!==null&&t!==void 0?t:function(U){},onclose:(i=G==null?void 0:G.onclose)!==null&&i!==void 0?i:function(U){}},Q=this.webSocketFactory.create(x,JR(b),te);Q.connect(),await K;let me=Rt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&me.startsWith("publishers/")){const U=this.apiClient.getProject(),H=this.apiClient.getLocation();me=`projects/${U}/locations/${H}/`+me}let de={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Ah.AUDIO]}:e.config.responseModalities=[Ah.AUDIO]),!((u=e.config)===null||u===void 0)&&u.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const fe=(m=(c=e.config)===null||c===void 0?void 0:c.tools)!==null&&m!==void 0?m:[],V=[];for(const U of fe)if(this.isCallableTool(U)){const H=U;V.push(await H.tool())}else V.push(U);V.length>0&&(e.config.tools=V);const O={model:me,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?de=A2(this.apiClient,O):de=S2(this.apiClient,O),delete de.config,Q.send(JSON.stringify(de)),new YR(Q,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const KR={turnComplete:!0};class YR{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Ss(t.turns),e.isVertexAI()||(i=i.map(r=>Wh(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const u of i){if(typeof u!="object"||u===null||!("name"in u)||!("response"in u))throw new Error(`Could not parse function response, type '${typeof u}'.`);if(!e.isVertexAI()&&!("id"in u))throw new Error(GR)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},KR),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:N2(e)}:t={realtimeInput:I2(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function JR(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function WR(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const JT=10;function WT(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const c of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(su(c)){r=!0;break}if(!r)return!0;const u=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return u&&(u<0||!Number.isInteger(u))||u==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",u),!0):!1}function su(n){return"callTool"in n&&typeof n.callTool=="function"}function QR(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>su(r)))!==null&&i!==void 0?i:!1}function QT(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,r)=>{if(su(i))return;const u=i;u.functionDeclarations&&u.functionDeclarations.length>0&&t.push(r)}),t}function XT(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XR extends rr{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,u,c,m;const g=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!QR(t)||WT(t.config))return await this.generateContentInternal(g);const p=QT(t);if(p.length>0){const G=p.map(z=>`tools[${z}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${G}.`)}let x,A;const b=Ss(g.contents),M=(u=(r=(i=g.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&u!==void 0?u:JT;let K=0;for(;K<M&&(x=await this.generateContentInternal(g),!(!x.functionCalls||x.functionCalls.length===0));){const G=x.candidates[0].content,z=[];for(const W of(m=(c=t.config)===null||c===void 0?void 0:c.tools)!==null&&m!==void 0?m:[])if(su(W)){const Q=await W.callTool(x.functionCalls);z.push(...Q)}K++,A={role:"user",parts:z},g.contents=Ss(g.contents),g.contents.push(G),g.contents.push(A),XT(g.config)&&(b.push(G),b.push(A))}return XT(g.config)&&(x.automaticFunctionCallingHistory=b),x},this.generateContentStream=async t=>{var i,r,u,c,m;if(this.maybeMoveToResponseJsonSchem(t),WT(t.config)){const A=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(A)}const g=QT(t);if(g.length>0){const A=g.map(b=>`tools[${b}]`).join(", ");throw new Error(`Incompatible tools found at ${A}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(u=(r=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||u===void 0?void 0:u.streamFunctionCallArguments,x=(m=(c=t==null?void 0:t.config)===null||c===void 0?void 0:c.automaticFunctionCalling)===null||m===void 0?void 0:m.disable;if(p&&!x)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let u;const c=[];if(i!=null&&i.generatedImages)for(const g of i.generatedImages)g&&(g!=null&&g.safetyAttributes)&&((r=g==null?void 0:g.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?u=g==null?void 0:g.safetyAttributes:c.push(g);let m;return u?m={generatedImages:c,positivePromptSafetyAttributes:u,sdkHttpResponse:i.sdkHttpResponse}:m={generatedImages:c,sdkHttpResponse:i.sdkHttpResponse},m}),this.list=async t=>{var i;const c={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((i=c.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new ll(tr.PAGED_ITEM_MODELS,m=>this.listInternal(m),await this.listInternal(c),c)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var i,r,u,c,m,g;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((c=(u=t.source)===null||u===void 0?void 0:u.video)===null||c===void 0)&&c.uri&&(!((g=(m=t.source)===null||m===void 0?void 0:m.video)===null||g===void 0)&&g.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;const u=(t=e.config)===null||t===void 0?void 0:t.tools;if(!u)return e;const c=await Promise.all(u.map(async g=>su(g)?await g.tool():g)),m={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:c})};if(m.config.tools=c,e.config&&e.config.tools&&fw(e.config.tools)){const g=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let p=Object.assign({},g);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),mw(p),m.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return m}async initAfcToolsMap(e){var t,i,r;const u=new Map;for(const c of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(su(c)){const m=c,g=await m.tool();for(const p of(r=g.functionDeclarations)!==null&&r!==void 0?r:[]){if(!p.name)throw new Error("Function declaration name is required.");if(u.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);u.set(p.name,m)}}return u}async processAfcStream(e){var t,i,r;const u=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:JT;let c=!1,m=0;const g=await this.initAfcToolsMap(e);return(function(p,x,A){var b,M;return iu(this,arguments,function*(){for(var K,G,z,W;m<u;){c&&(m++,c=!1);const de=yield Xt(p.processParamsMaybeAddMcpUsage(A)),fe=yield Xt(p.generateContentStreamInternal(de)),V=[],O=[];try{for(var te=!0,Q=(G=void 0,Ac(fe)),me;me=yield Xt(Q.next()),K=me.done,!K;te=!0){W=me.value,te=!1;const U=W;if(yield yield Xt(U),U.candidates&&(!((b=U.candidates[0])===null||b===void 0)&&b.content)){O.push(U.candidates[0].content);for(const H of(M=U.candidates[0].content.parts)!==null&&M!==void 0?M:[])if(m<u&&H.functionCall){if(!H.functionCall.name)throw new Error("Function call name was not returned by the model.");if(x.has(H.functionCall.name)){const F=yield Xt(x.get(H.functionCall.name).callTool([H.functionCall]));V.push(...F)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${x.keys()}, mising tool: ${H.functionCall.name}`)}}}}catch(U){G={error:U}}finally{try{!te&&!K&&(z=Q.return)&&(yield Xt(z.call(Q)))}finally{if(G)throw G.error}}if(V.length>0){c=!0;const U=new yc;U.candidates=[{content:{role:"user",parts:V}}],yield yield Xt(U);const H=[];H.push(...O),H.push({role:"user",parts:V});const F=Ss(A.contents).concat(H);A.contents=F}else break}})})(this,g,e)}async generateContentInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=GT(this.apiClient,e);return m=Pe("{model}:generateContent",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=ZT(x),b=new yc;return Object.assign(b,A),b})}else{const p=HT(this.apiClient,e);return m=Pe("{model}:generateContent",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=jT(x),b=new yc;return Object.assign(b,A),b})}}async generateContentStreamInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=GT(this.apiClient,e);return m=Pe("{model}:streamGenerateContent?alt=sse",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.requestStream({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),c.then(function(A){return iu(this,arguments,function*(){var b,M,K,G;try{for(var z=!0,W=Ac(A),te;te=yield Xt(W.next()),b=te.done,!b;z=!0){G=te.value,z=!1;const Q=G,me=ZT(yield Xt(Q.json()));me.sdkHttpResponse={headers:Q.headers};const de=new yc;Object.assign(de,me),yield yield Xt(de)}}catch(Q){M={error:Q}}finally{try{!z&&!b&&(K=W.return)&&(yield Xt(K.call(W)))}finally{if(M)throw M.error}}})})}else{const p=HT(this.apiClient,e);return m=Pe("{model}:streamGenerateContent?alt=sse",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.requestStream({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}),c.then(function(A){return iu(this,arguments,function*(){var b,M,K,G;try{for(var z=!0,W=Ac(A),te;te=yield Xt(W.next()),b=te.done,!b;z=!0){G=te.value,z=!1;const Q=G,me=jT(yield Xt(Q.json()));me.sdkHttpResponse={headers:Q.headers};const de=new yc;Object.assign(de,me),yield yield Xt(de)}}catch(Q){M={error:Q}}finally{try{!z&&!b&&(K=W.return)&&(yield Xt(K.call(W)))}finally{if(M)throw M.error}}})})}}async embedContent(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=rN(this.apiClient,e);return m=Pe("{model}:predict",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=lN(x),b=new bT;return Object.assign(b,A),b})}else{const p=oN(this.apiClient,e);return m=Pe("{model}:batchEmbedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=aN(x),b=new bT;return Object.assign(b,A),b})}}async generateImagesInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=vN(this.apiClient,e);return m=Pe("{model}:predict",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=EN(x),b=new IT;return Object.assign(b,A),b})}else{const p=yN(this.apiClient,e);return m=Pe("{model}:predict",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=TN(x),b=new IT;return Object.assign(b,A),b})}}async editImageInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=tN(this.apiClient,e);return u=Pe("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>{const p=nN(g),x=new cb;return Object.assign(x,p),x})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=vR(this.apiClient,e);return u=Pe("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>{const p=TR(g),x=new db;return Object.assign(x,p),x})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=eR(this.apiClient,e);return u=Pe("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=tR(g),x=new hb;return Object.assign(x,p),x})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=aR(this.apiClient,e);return u=Pe("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=lR(g),x=new fb;return Object.assign(x,p),x})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=UN(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>Lp(x))}else{const p=ON(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>kp(x))}}async listInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=KN(this.apiClient,e);return m=Pe("{models_url}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=JN(x),b=new NT;return Object.assign(b,A),b})}else{const p=ZN(this.apiClient,e);return m=Pe("{models_url}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=YN(x),b=new NT;return Object.assign(b,A),b})}}async update(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=_R(this.apiClient,e);return m=Pe("{model}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>Lp(x))}else{const p=gR(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>kp(x))}}async delete(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=Q2(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=$2(x),b=new RT;return Object.assign(b,A),b})}else{const p=W2(this.apiClient,e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=X2(x),b=new RT;return Object.assign(b,A),b})}}async countTokens(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=K2(this.apiClient,e);return m=Pe("{model}:countTokens",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=J2(x),b=new MT;return Object.assign(b,A),b})}else{const p=Z2(this.apiClient,e);return m=Pe("{model}:countTokens",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=Y2(x),b=new MT;return Object.assign(b,A),b})}}async computeTokens(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=z2(this.apiClient,e);return u=Pe("{model}:computeTokens",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>{const p=B2(g),x=new mb;return Object.assign(x,p),x})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=bN(this.apiClient,e);return m=Pe("{model}:predictLongRunning",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>{const A=AN(x),b=new Ch;return Object.assign(b,A),b})}else{const p=CN(this.apiClient,e);return m=Pe("{model}:predictLongRunning",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>{const A=SN(x),b=new Ch;return Object.assign(b,A),b})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $R extends rr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let u;i&&"httpOptions"in i&&(u=i.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:u}});return t._fromAPIResponse({apiResponse:c,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let u;i&&"httpOptions"in i&&(u=i.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:u}});return t._fromAPIResponse({apiResponse:c,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=sb(e);return m=Pe("{operationName}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c}else{const p=ib(e);return m=Pe("{operationName}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c}}async fetchPredictVideosOperationInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=WC(e);return u=Pe("{resourceName}:fetchPredictOperation",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eM(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function tM(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(u=>cM(u))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function nM(n,e,t){const i={},r=f(e,["expireTime"]);t!==void 0&&r!=null&&_(t,["expireTime"],r);const u=f(e,["newSessionExpireTime"]);t!==void 0&&u!=null&&_(t,["newSessionExpireTime"],u);const c=f(e,["uses"]);t!==void 0&&c!=null&&_(t,["uses"],c);const m=f(e,["liveConnectConstraints"]);t!==void 0&&m!=null&&_(t,["bidiGenerateContentSetup"],uM(n,m));const g=f(e,["lockAdditionalFields"]);return t!==void 0&&g!=null&&_(t,["fieldMask"],g),i}function iM(n,e){const t={},i=f(e,["config"]);return i!=null&&_(t,["config"],nM(n,i,t)),t}function sM(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function oM(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function rM(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function aM(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function lM(n,e){const t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],i);const r=f(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const u=f(n,["temperature"]);e!==void 0&&u!=null&&_(e,["setup","generationConfig","temperature"],u);const c=f(n,["topP"]);e!==void 0&&c!=null&&_(e,["setup","generationConfig","topP"],c);const m=f(n,["topK"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","topK"],m);const g=f(n,["maxOutputTokens"]);e!==void 0&&g!=null&&_(e,["setup","generationConfig","maxOutputTokens"],g);const p=f(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const x=f(n,["seed"]);e!==void 0&&x!=null&&_(e,["setup","generationConfig","seed"],x);const A=f(n,["speechConfig"]);e!==void 0&&A!=null&&_(e,["setup","generationConfig","speechConfig"],Eg(A));const b=f(n,["thinkingConfig"]);e!==void 0&&b!=null&&_(e,["setup","generationConfig","thinkingConfig"],b);const M=f(n,["enableAffectiveDialog"]);e!==void 0&&M!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],M);const K=f(n,["systemInstruction"]);e!==void 0&&K!=null&&_(e,["setup","systemInstruction"],tM(ri(K)));const G=f(n,["tools"]);if(e!==void 0&&G!=null){let fe=Eu(G);Array.isArray(fe)&&(fe=fe.map(V=>hM(Tu(V)))),_(e,["setup","tools"],fe)}const z=f(n,["sessionResumption"]);e!==void 0&&z!=null&&_(e,["setup","sessionResumption"],dM(z));const W=f(n,["inputAudioTranscription"]);e!==void 0&&W!=null&&_(e,["setup","inputAudioTranscription"],W);const te=f(n,["outputAudioTranscription"]);e!==void 0&&te!=null&&_(e,["setup","outputAudioTranscription"],te);const Q=f(n,["realtimeInputConfig"]);e!==void 0&&Q!=null&&_(e,["setup","realtimeInputConfig"],Q);const me=f(n,["contextWindowCompression"]);e!==void 0&&me!=null&&_(e,["setup","contextWindowCompression"],me);const de=f(n,["proactivity"]);return e!==void 0&&de!=null&&_(e,["setup","proactivity"],de),t}function uM(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["setup","model"],Rt(n,i));const r=f(e,["config"]);return r!=null&&_(t,["config"],lM(r,t)),t}function cM(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const u=f(n,["fileData"]);u!=null&&_(e,["fileData"],sM(u));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],oM(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],eM(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const x=f(n,["thought"]);x!=null&&_(e,["thought"],x);const A=f(n,["thoughtSignature"]);A!=null&&_(e,["thoughtSignature"],A);const b=f(n,["videoMetadata"]);return b!=null&&_(e,["videoMetadata"],b),e}function dM(n){const e={},t=f(n,["handle"]);if(t!=null&&_(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function hM(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(A=>A)),_(e,["functionDeclarations"],x)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const u=f(n,["fileSearch"]);u!=null&&_(e,["fileSearch"],u);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],rM(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],aM(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fM(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(u=>`${t}.${u}`);e.push(...r)}else e.push(t)}return e.join(",")}function mM(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const u=i.setup;typeof u=="object"&&u!==null?(n.bidiGenerateContentSetup=u,t=u):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const u=fM(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)u?n.fieldMask=u:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let m=[];r.length>0&&(m=r.map(p=>c.includes(p)?`generationConfig.${p}`:p));const g=[];u&&g.push(u),m.length>0&&g.push(...m),g.length>0?n.fieldMask=g.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class pM extends rr{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const m=iM(this.apiClient,e);u=Pe("auth_tokens",m._url),c=m._query,delete m.config,delete m._url,delete m._query;const g=mM(m,e.config);return r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gM(n,e){const t={},i=f(n,["displayName"]);return e!==void 0&&i!=null&&_(e,["displayName"],i),t}function _M(n){const e={},t=f(n,["config"]);return t!=null&&gM(t,e),e}function yM(n,e){const t={},i=f(n,["force"]);return e!==void 0&&i!=null&&_(e,["_query","force"],i),t}function vM(n){const e={},t=f(n,["name"]);t!=null&&_(e,["_url","name"],t);const i=f(n,["config"]);return i!=null&&yM(i,e),e}function TM(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","name"],t),e}function EM(n,e){const t={},i=f(n,["customMetadata"]);if(e!==void 0&&i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["customMetadata"],u)}const r=f(n,["chunkingConfig"]);return e!==void 0&&r!=null&&_(e,["chunkingConfig"],r),t}function xM(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response"]);return c!=null&&_(e,["response"],SM(c)),e}function wM(n){const e={},t=f(n,["fileSearchStoreName"]);t!=null&&_(e,["_url","file_search_store_name"],t);const i=f(n,["fileName"]);i!=null&&_(e,["fileName"],i);const r=f(n,["config"]);return r!=null&&EM(r,e),e}function SM(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["parent"]);i!=null&&_(e,["parent"],i);const r=f(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function AM(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function CM(n){const e={},t=f(n,["config"]);return t!=null&&AM(t,e),e}function bM(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["fileSearchStores"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["fileSearchStores"],u)}return e}function IM(n,e){const t={},i=f(n,["mimeType"]);e!==void 0&&i!=null&&_(e,["mimeType"],i);const r=f(n,["displayName"]);e!==void 0&&r!=null&&_(e,["displayName"],r);const u=f(n,["customMetadata"]);if(e!==void 0&&u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>g)),_(e,["customMetadata"],m)}const c=f(n,["chunkingConfig"]);return e!==void 0&&c!=null&&_(e,["chunkingConfig"],c),t}function NM(n){const e={},t=f(n,["fileSearchStoreName"]);t!=null&&_(e,["_url","file_search_store_name"],t);const i=f(n,["config"]);return i!=null&&IM(i,e),e}function RM(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function MM(n,e){const t={},i=f(n,["force"]);return e!==void 0&&i!=null&&_(e,["_query","force"],i),t}function PM(n){const e={},t=f(n,["name"]);t!=null&&_(e,["_url","name"],t);const i=f(n,["config"]);return i!=null&&MM(i,e),e}function DM(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","name"],t),e}function kM(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function LM(n){const e={},t=f(n,["parent"]);t!=null&&_(e,["_url","parent"],t);const i=f(n,["config"]);return i!=null&&kM(i,e),e}function VM(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["documents"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["documents"],u)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class OM extends rr{constructor(e){super(),this.apiClient=e,this.list=async t=>new ll(tr.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=DM(e);return u=Pe("{name}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async delete(e){var t,i;let r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=PM(e);r=Pe("{name}",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=LM(e);return u=Pe("{parent}/documents",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=VM(g),x=new pb;return Object.assign(x,p),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UM extends rr{constructor(e,t=new OM(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new ll(tr.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=_M(e);return u=Pe("fileSearchStores",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async get(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=TM(e);return u=Pe("{name}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async delete(e){var t,i;let r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=vM(e);r=Pe("{name}",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=CM(e);return u=Pe("fileSearchStores",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=bM(g),x=new gb;return Object.assign(x,p),x})}}async uploadToFileSearchStoreInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=NM(e);return u=Pe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=RM(g),x=new _b;return Object.assign(x,p),x})}}async importFile(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=wM(e);return u=Pe("{file_search_store_name}:importFile",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=xM(g),x=new gg;return Object.assign(x,p),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zM(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function BM(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function FM(n,e,t){const i={};if(f(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=f(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&_(e,["displayName"],r),f(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const u=f(n,["epochCount"]);e!==void 0&&u!=null&&_(e,["tuningTask","hyperparameters","epochCount"],u);const c=f(n,["learningRateMultiplier"]);if(c!=null&&_(i,["tuningTask","hyperparameters","learningRateMultiplier"],c),f(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const m=f(n,["batchSize"]);e!==void 0&&m!=null&&_(e,["tuningTask","hyperparameters","batchSize"],m);const g=f(n,["learningRate"]);if(e!==void 0&&g!=null&&_(e,["tuningTask","hyperparameters","learningRate"],g),f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(f(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function qM(n,e,t){const i={};let r=f(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const M=f(n,["validationDataset"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec"],$T(M))}else if(r==="PREFERENCE_TUNING"){const M=f(n,["validationDataset"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec"],$T(M))}const u=f(n,["tunedModelDisplayName"]);e!==void 0&&u!=null&&_(e,["tunedModelDisplayName"],u);const c=f(n,["description"]);e!==void 0&&c!=null&&_(e,["description"],c);let m=f(t,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const M=f(n,["epochCount"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","hyperParameters","epochCount"],M)}else if(m==="PREFERENCE_TUNING"){const M=f(n,["epochCount"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],M)}let g=f(t,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const M=f(n,["learningRateMultiplier"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],M)}else if(g==="PREFERENCE_TUNING"){const M=f(n,["learningRateMultiplier"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],M)}let p=f(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const M=f(n,["exportLastCheckpointOnly"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","exportLastCheckpointOnly"],M)}else if(p==="PREFERENCE_TUNING"){const M=f(n,["exportLastCheckpointOnly"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],M)}let x=f(t,["config","method"]);if(x===void 0&&(x="SUPERVISED_FINE_TUNING"),x==="SUPERVISED_FINE_TUNING"){const M=f(n,["adapterSize"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","hyperParameters","adapterSize"],M)}else if(x==="PREFERENCE_TUNING"){const M=f(n,["adapterSize"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],M)}if(f(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const A=f(n,["labels"]);e!==void 0&&A!=null&&_(e,["labels"],A);const b=f(n,["beta"]);return e!==void 0&&b!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","beta"],b),i}function HM(n,e){const t={},i=f(n,["baseModel"]);i!=null&&_(t,["baseModel"],i);const r=f(n,["preTunedModel"]);r!=null&&_(t,["preTunedModel"],r);const u=f(n,["trainingDataset"]);u!=null&&eP(u);const c=f(n,["config"]);return c!=null&&FM(c,t),t}function GM(n,e){const t={},i=f(n,["baseModel"]);i!=null&&_(t,["baseModel"],i);const r=f(n,["preTunedModel"]);r!=null&&_(t,["preTunedModel"],r);const u=f(n,["trainingDataset"]);u!=null&&tP(u,t,e);const c=f(n,["config"]);return c!=null&&qM(c,t,e),t}function jM(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function ZM(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function KM(n,e,t){const i={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&_(e,["_query","pageSize"],r);const u=f(n,["pageToken"]);e!==void 0&&u!=null&&_(e,["_query","pageToken"],u);const c=f(n,["filter"]);return e!==void 0&&c!=null&&_(e,["_query","filter"],c),i}function YM(n,e,t){const i={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&_(e,["_query","pageSize"],r);const u=f(n,["pageToken"]);e!==void 0&&u!=null&&_(e,["_query","pageToken"],u);const c=f(n,["filter"]);return e!==void 0&&c!=null&&_(e,["_query","filter"],c),i}function JM(n,e){const t={},i=f(n,["config"]);return i!=null&&KM(i,t),t}function WM(n,e){const t={},i=f(n,["config"]);return i!=null&&YM(i,t),t}function QM(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const u=f(n,["tunedModels"]);if(u!=null){let c=u;Array.isArray(c)&&(c=c.map(m=>pw(m))),_(t,["tuningJobs"],c)}return t}function XM(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const u=f(n,["tuningJobs"]);if(u!=null){let c=u;Array.isArray(c)&&(c=c.map(m=>Op(m))),_(t,["tuningJobs"],c)}return t}function $M(n,e){const t={},i=f(n,["name"]);i!=null&&_(t,["model"],i);const r=f(n,["name"]);return r!=null&&_(t,["endpoint"],r),t}function eP(n,e){const t={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=f(n,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(u=>u)),_(t,["examples","examples"],r)}return t}function tP(n,e,t){const i={};let r=f(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const c=f(n,["gcsUri"]);e!==void 0&&c!=null&&_(e,["supervisedTuningSpec","trainingDatasetUri"],c)}else if(r==="PREFERENCE_TUNING"){const c=f(n,["gcsUri"]);e!==void 0&&c!=null&&_(e,["preferenceOptimizationSpec","trainingDatasetUri"],c)}let u=f(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const c=f(n,["vertexDatasetResource"]);e!==void 0&&c!=null&&_(e,["supervisedTuningSpec","trainingDatasetUri"],c)}else if(u==="PREFERENCE_TUNING"){const c=f(n,["vertexDatasetResource"]);e!==void 0&&c!=null&&_(e,["preferenceOptimizationSpec","trainingDatasetUri"],c)}if(f(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function pw(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["name"]);r!=null&&_(t,["name"],r);const u=f(n,["state"]);u!=null&&_(t,["state"],Wx(u));const c=f(n,["createTime"]);c!=null&&_(t,["createTime"],c);const m=f(n,["tuningTask","startTime"]);m!=null&&_(t,["startTime"],m);const g=f(n,["tuningTask","completeTime"]);g!=null&&_(t,["endTime"],g);const p=f(n,["updateTime"]);p!=null&&_(t,["updateTime"],p);const x=f(n,["description"]);x!=null&&_(t,["description"],x);const A=f(n,["baseModel"]);A!=null&&_(t,["baseModel"],A);const b=f(n,["_self"]);return b!=null&&_(t,["tunedModel"],$M(b)),t}function Op(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["name"]);r!=null&&_(t,["name"],r);const u=f(n,["state"]);u!=null&&_(t,["state"],Wx(u));const c=f(n,["createTime"]);c!=null&&_(t,["createTime"],c);const m=f(n,["startTime"]);m!=null&&_(t,["startTime"],m);const g=f(n,["endTime"]);g!=null&&_(t,["endTime"],g);const p=f(n,["updateTime"]);p!=null&&_(t,["updateTime"],p);const x=f(n,["error"]);x!=null&&_(t,["error"],x);const A=f(n,["description"]);A!=null&&_(t,["description"],A);const b=f(n,["baseModel"]);b!=null&&_(t,["baseModel"],b);const M=f(n,["tunedModel"]);M!=null&&_(t,["tunedModel"],M);const K=f(n,["preTunedModel"]);K!=null&&_(t,["preTunedModel"],K);const G=f(n,["supervisedTuningSpec"]);G!=null&&_(t,["supervisedTuningSpec"],G);const z=f(n,["preferenceOptimizationSpec"]);z!=null&&_(t,["preferenceOptimizationSpec"],z);const W=f(n,["tuningDataStats"]);W!=null&&_(t,["tuningDataStats"],W);const te=f(n,["encryptionSpec"]);te!=null&&_(t,["encryptionSpec"],te);const Q=f(n,["partnerModelTuningSpec"]);Q!=null&&_(t,["partnerModelTuningSpec"],Q);const me=f(n,["customBaseModel"]);me!=null&&_(t,["customBaseModel"],me);const de=f(n,["experiment"]);de!=null&&_(t,["experiment"],de);const fe=f(n,["labels"]);fe!=null&&_(t,["labels"],fe);const V=f(n,["outputUri"]);V!=null&&_(t,["outputUri"],V);const O=f(n,["pipelineJob"]);O!=null&&_(t,["pipelineJob"],O);const U=f(n,["serviceAccount"]);U!=null&&_(t,["serviceAccount"],U);const H=f(n,["tunedModelDisplayName"]);H!=null&&_(t,["tunedModelDisplayName"],H);const F=f(n,["veoTuningSpec"]);return F!=null&&_(t,["veoTuningSpec"],F),t}function nP(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["name"]);r!=null&&_(t,["name"],r);const u=f(n,["metadata"]);u!=null&&_(t,["metadata"],u);const c=f(n,["done"]);c!=null&&_(t,["done"],c);const m=f(n,["error"]);return m!=null&&_(t,["error"],m),t}function $T(n,e){const t={},i=f(n,["gcsUri"]);i!=null&&_(t,["validationDatasetUri"],i);const r=f(n,["vertexDatasetResource"]);return r!=null&&_(t,["validationDatasetUri"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iP extends rr{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new ll(tr.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const r={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);const u=Object.assign(Object.assign({},t),{preTunedModel:r});return u.baseModel=void 0,await this.tuneInternal(u)}else{const r=Object.assign({},t);return await this.tuneInternal(r)}else{const r=Object.assign({},t),u=await this.tuneMldevInternal(r);let c="";return u.metadata!==void 0&&u.metadata.tunedModel!==void 0?c=u.metadata.tunedModel:u.name!==void 0&&u.name.includes("/operations/")&&(c=u.name.split("/operations/")[0]),{name:c,state:Rp.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=ZM(e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>Op(x))}else{const p=jM(e);return m=Pe("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>pw(x))}}async listInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=WM(e);return m=Pe("tuningJobs",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=XM(x),b=new PT;return Object.assign(b,A),b})}else{const p=JM(e);return m=Pe("tunedModels",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(A=>{const b=A;return b.sdkHttpResponse={headers:x.headers},b})),c.then(x=>{const A=QM(x),b=new PT;return Object.assign(b,A),b})}}async cancel(e){var t,i,r,u;let c="",m={};if(this.apiClient.isVertexAI()){const g=BM(e);c=Pe("{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=zM(e);c=Pe("{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal})}}async tuneInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=GM(e,e);return u=Pe("tuningJobs",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>Op(g))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=HM(e);return u=Pe("tunedModels",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>nP(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sP{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const oP=1024*1024*8,rP=3,aP=1e3,lP=2,Ih="x-goog-upload-status";async function uP(n,e,t){var i;const r=await gw(n,e,t),u=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Ih])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return u.file}async function cP(n,e,t){var i;const r=await gw(n,e,t),u=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Ih])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const c=Gx(u),m=new _g;return Object.assign(m,c),m}async function gw(n,e,t){var i,r;let u=0,c=0,m=new Mp(new Response),g="upload";for(u=n.size;c<u;){const p=Math.min(oP,u-c),x=n.slice(c,c+p);c+p>=u&&(g+=", finalize");let A=0,b=aP;for(;A<rP&&(m=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":g,"X-Goog-Upload-Offset":String(c),"Content-Length":String(p)}}}),!(!((i=m==null?void 0:m.headers)===null||i===void 0)&&i[Ih]));)A++,await hP(b),b=b*lP;if(c+=p,((r=m==null?void 0:m.headers)===null||r===void 0?void 0:r[Ih])!=="active")break;if(u<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return m}async function dP(n){return{size:n.size,type:n.type}}function hP(n){return new Promise(e=>setTimeout(e,n))}class fP{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await uP(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await cP(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await dP(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mP{create(e,t,i){return new pP(e,t,i)}}class pP{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const eE="x-goog-api-key";class gP{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(eE)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(eE,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _P="gl-node/";class _w{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=YC(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const r=new gP(this.apiKey);this.apiClient=new DR({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:_P+"web",uploader:new fP,downloader:new sP}),this.models=new XR(this.apiClient),this.live=new ZR(this.apiClient,r,new mP),this.batches=new wI(this.apiClient),this.chats=new s2(this.models,this.apiClient),this.caches=new t2(this.apiClient),this.files=new m2(this.apiClient),this.operations=new $R(this.apiClient),this.authTokens=new pM(this.apiClient),this.tunings=new iP(this.apiClient),this.fileSearchStores=new UM(this.apiClient)}}const yP=()=>{try{const n=localStorage.getItem("nomad_user_api_key");return n||""}catch(n){console.warn("Failed to access API key",n)}return""},wo=async n=>{var t;const e=yP();if(e)try{const i=new _w({apiKey:e});return await n(i)}catch(i){if(console.warn("Primary API Key failed",i),(t=i.message)!=null&&t.includes("403")||i.toString().includes("403"))throw new Error("Invalid API Key (403). Please check your key in Settings.")}else throw new Error("API key is missing. Please provide a valid API key in Settings.");throw new Error("AI Service Failed. Please check your API Key.")},ai={"zh-TW":"Traditional Chinese (Taiwan) ()","en-US":"English","ja-JP":"Japanese"},So=n=>{if(typeof n.text=="string")return n.text;if(typeof n.text=="function")return n.text();if(n.candidates&&n.candidates[0]&&n.candidates[0].content&&n.candidates[0].content.parts&&n.candidates[0].content.parts[0].text)return n.candidates[0].content.parts[0].text;throw new Error("No text found in AI response")},Ao="gemini-2.0-flash",yw=async(n,e)=>(console.warn("Image editing is not supported. Returning original image."),n),wg=async n=>{try{const e=`Cinematic travel photography of ${n}, 4k, high quality, sunny day, vibrant colors, wide angle`,t=encodeURIComponent(e),i=Math.floor(Math.random()*1e6);return`https://image.pollinations.ai/prompt/${t}?width=1600&height=900&nologo=true&seed=${i}&model=flux`}catch(e){return console.error("Failed to generate cover image:",e),`https://via.placeholder.com/1600x900/D4A574/FFFFFF?text=${encodeURIComponent(n)}`}},vw=async(n,e="zh-TW")=>{const t=ai[e]||ai["zh-TW"];return wo(async i=>{const r=await i.models.generateContent({model:Ao,contents:`Help me plan a trip. ${n}`,config:{systemInstruction:`You are a professional travel agent AI. 
                Create a detailed itinerary based on the user's request. 
                
                CRITICAL PLANNING RULES:
                1. **Distance & Logic**: Group attractions that are geographically close to each other on the same day.
                2. **Feasibility**: Ensure the schedule is realistic.
                3. **Language**: All content MUST be in ${t}.
                4. **Travel Info**: You MUST estimate the travel mode and duration to the NEXT activity. This is mandatory for all items except the last one of the day.
                5. **Completeness**: You MUST generate a FULL itinerary with at least 3 activities per day. Do not leave the itinerary empty.
                
                FORMAT REQUIREMENTS:
                Return response in valid JSON format. Do not use Markdown code blocks.
                The JSON must strictly follow this structure:
                {
                    "title": "Trip Title",
                    "startDate": "YYYY-MM-DD",
                    "endDate": "YYYY-MM-DD",
                    "itinerary": [
                        {
                            "id": "unique_id",
                            "day": 1,
                            "time": "09:00",
                            "activity": "Activity Name",
                            "location": "Location Address",
                            "notes": "Tips",
                            "travelToNext": {
                                "mode": "WALK/TRAIN/BUS/CAR",
                                "duration": "15 min",
                                "details": "Route details"
                            }
                        }
                    ],
                    "budget": {
                        "total": 10000,
                        "currency": "TWD",
                        "expenses": []
                    },
                    "packingList": [],
                    "weather": [
                        {
                            "date": "YYYY-MM-DD",
                            "condition": "Sunny",
                            "tempLow": 20,
                            "tempHigh": 30,
                            "icon": ""
                        }
                    ]
                }
                `,responseMimeType:"application/json"}}),u=So(r);if(u){const c=u.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(c)}throw new Error("Empty response from AI")})},Tw=async(n,e,t="zh-TW")=>{const i=ai[t]||ai["zh-TW"];return wo(async r=>{const u=await r.models.generateContent({model:Ao,contents:`Help me modify an existing trip plan.
            
            Current Trip JSON:
            ${JSON.stringify(n)}
            
            User Request: "${e}"
            
            INSTRUCTIONS:
            1. Modify the "Current Trip JSON" based on the "User Request".
            2. Keep the same structure and fields.
            3. Update the "itinerary", "bookings", "budget", etc. as needed.
            4. Ensure the response is valid JSON matching the Trip structure.
            5. All content MUST be in ${i}.
            6. Return ONLY the updated JSON.
            `,config:{responseMimeType:"application/json"}}),c=So(u);if(c){const m=c.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(m)}throw new Error("Empty response from AI")})},Ew=async(n,e,t="zh-TW")=>{const i=ai[t]||ai["zh-TW"];return wo(async r=>{const u=await r.models.generateContent({model:Ao,contents:`I hold a ${n} passport and want to travel to ${e}. 
            What are the visa requirements, entry rules, and any vaccination requirements? 
            Provide a concise summary in Markdown format. 
            Include a 'Difficulty Level' (Easy, Moderate, Hard) at the top.
            Response MUST be in ${i}.`});return So(u)})},xw=async(n,e="zh-TW")=>{const t=ai[e]||ai["zh-TW"];return wo(async i=>{const r=await i.models.generateContent({model:Ao,contents:`I am currently in (or planning to go to) ${n}. 
            Give me a quick guide on:
            1. Tipping customs (Restaurants, Taxis, Hotels).
            2. Major cultural taboos (Do's and Don'ts).
            3. Dress code advice.
            Keep it short, fun, and formatted in Markdown.
            Response MUST be in ${t}.`});return So(r)})},ww=async(n,e,t="zh-TW")=>{const i=ai[t]||ai["zh-TW"];return wo(async r=>{try{const u=await r.models.generateContent({model:Ao,contents:`Tell me about "${e}" at "${n}". 
                Provide a very short fun fact, the best photo spot, and one "pro tip" for visiting.
                Format as simple Markdown (bold keys). Keep it under 100 words.
                Response MUST be in ${i}.`});return So(u)}catch(u){return console.error("Error fetching attraction guide:",u),""}})},Sw=async(n,e="zh-TW")=>{const t=ai[e]||ai["zh-TW"];return wo(async i=>{try{const r=await i.models.generateContent({model:Ao,contents:`I am travelling in ${n}. 
                List the emergency phone numbers for: Police, Ambulance, Fire.
                Also list the address and phone number of the nearest major hospital in the capital city.
                Format as a clear list.
                Response MUST be in ${t}.`});return So(r)}catch{return" 112"}})},Aw=async(n,e="zh-TW")=>{const t=ai[e]||ai["zh-TW"];return wo(async i=>{try{const r=await i.models.generateContent({model:Ao,contents:`I am travelling to ${n}. 
                What kind of credit cards are best to use there (Visa, Mastercard, Amex, JCB)?
                Are cash payments preferred?
                Any tips on currency exchange or dynamic currency conversion (DCC)?
                Keep it concise.
                Response MUST be in ${t}.`});return So(r)}catch{return" Visa/Mastercard "}})},Cw=async(n,e="zh-TW")=>wo(async t=>{const i=n.map(c=>({id:c.id,activity:c.activity,location:c.location,time:c.time})),r=await t.models.generateContent({model:Ao,contents:`I have a list of activities for one day. Reorder them to create the most efficient geographical route.
            
            Current Items: ${JSON.stringify(i)}
            
            Return ONLY a JSON array of strings, where each string is the 'id' of the activity in the new order.
            Do not change the time, just the order of visiting.
            Example response: ["id1", "id3", "id2"]`,config:{responseMimeType:"application/json"}}),u=So(r);if(u)return JSON.parse(u);throw new Error("Empty response")}),bw=async(n,e,t="zh-TW")=>wo(async i=>{try{const r=await i.models.generateContent({model:Ao,contents:`Translate the following text to ${e}.
                Text: "${n}"
                
                Only provide the translated text.`});return So(r)}catch(r){return console.error("Translation Error:",r),null}}),Iw=async(n,e,t="zh-TW")=>{const i=ai[t]||ai["zh-TW"];return wo(async r=>{try{const u=n.map(m=>`${m.date}: ${m.condition}, ${m.tempLow}C - ${m.tempHigh}C`).join(`
`),c=await r.models.generateContent({model:Ao,contents:`I am travelling to ${e}. Here is the weather forecast:
                ${u}
                
                Based on this weather, give me a VERY SHORT, ONE-LINE clothing advice summary.
                Example: "It's rainy and cold, so bring a heavy coat and umbrella."
                Keep it under 20 words.
                Response MUST be in ${i}.`});return So(c)}catch(u){return console.error("Clothing Advice Error:",u),""}})},vP=Object.freeze(Object.defineProperty({__proto__:null,editTravelPhoto:yw,generateCoverImage:wg,generateTripPlan:vw,getAttractionGuide:ww,getClothingAdvice:Iw,getCreditCardAdvice:Aw,getCulturalEtiquette:xw,getEmergencyInfo:Sw,getTranslation:bw,getVisaRequirements:Ew,optimizeRoute:Cw,updateTripPlan:Tw},Symbol.toStringTag,{value:"Module"})),TP=({onSave:n,onCancel:e,settings:t})=>{const i=jt[t.language]||jt["zh-TW"],[r,u]=X.useState(""),[c,m]=X.useState(""),[g,p]=X.useState(""),[x,A]=X.useState(null),[b,M]=X.useState(!1),K=X.useRef(null),G=te=>{var me;const Q=(me=te.target.files)==null?void 0:me[0];if(Q){const de=new FileReader;de.onloadend=()=>{A(de.result)},de.readAsDataURL(Q)}},z=async()=>{if(!r){alert("Please enter title");return}M(!0);try{const te=await wg(r);A(te)}catch(te){console.error(te),alert("Error")}finally{M(!1)}},W=async te=>{if(te.preventDefault(),!r||!c)return;let Q=x;if(!Q)try{const de=`Cinematic travel photography of ${r}, 4k, high quality, sunny day`,fe=encodeURIComponent(de),V=Math.floor(Math.random()*1e6);Q=`https://image.pollinations.ai/prompt/${fe}?width=1600&height=900&nologo=true&seed=${V}&model=flux`}catch(de){console.error("Failed to generate default cover",de),Q=`https://via.placeholder.com/1600x900/D4A574/FFFFFF?text=${encodeURIComponent(r)}`}const me={id:Date.now().toString(),title:r,startDate:c,endDate:g,itinerary:[],coverImage:Q};n(me)};return E.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe pt-12",children:[E.jsxs("div",{className:"px-4 py-3 flex items-center gap-2 bg-paper sticky top-0 z-10 border-b border-sand/50",children:[E.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-white text-gray-500 active:scale-90 transition-transform",children:E.jsx(ns,{className:"w-6 h-6"})}),E.jsx("h2",{className:"text-lg font-bold text-ink",children:i.new_trip})]}),E.jsxs("form",{onSubmit:W,className:"p-6 space-y-8 flex-1 overflow-y-auto no-scrollbar pb-32",children:[E.jsxs("div",{className:"space-y-3",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase",children:i.trip_destination_title}),E.jsx("div",{className:"relative",children:E.jsx("input",{type:"text",required:!0,value:r,onChange:te=>u(te.target.value),placeholder:"...",className:"w-full p-5 bg-white rounded-3xl border border-sand focus:border-coral focus:ring-1 focus:ring-coral/50 transition-all text-lg font-bold text-ink outline-none placeholder:text-gray-300 shadow-sm"})})]}),E.jsxs("div",{className:"space-y-3",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase",children:i.cover_photo}),E.jsxs("div",{className:"w-full aspect-video rounded-3xl overflow-hidden bg-white border-2 border-dashed border-sand relative shadow-inner",children:[x?E.jsx("img",{src:x,alt:"Cover",className:"w-full h-full object-cover"}):E.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-300",children:[E.jsx(cu,{className:"w-10 h-10 mb-2 opacity-50"}),E.jsx("span",{className:"text-xs font-bold",children:"Preview"})]}),x&&E.jsx("button",{type:"button",onClick:()=>A(null),className:"absolute top-2 right-2 bg-black/50 text-white p-1.5 rounded-full backdrop-blur-sm",children:E.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),E.jsxs("div",{className:"flex gap-3 mt-2",children:[E.jsxs("button",{type:"button",onClick:()=>{var te;return(te=K.current)==null?void 0:te.click()},className:"flex-1 py-3 bg-white text-gray-600 rounded-2xl font-bold text-sm border border-sand hover:border-coral hover:text-coral transition-colors flex items-center justify-center gap-1.5 shadow-sm",children:[E.jsx(cu,{className:"w-4 h-4"})," ",i.upload_photo]}),E.jsx("input",{type:"file",ref:K,className:"hidden",accept:"image/*",onChange:G}),E.jsx("button",{type:"button",onClick:z,disabled:b||!r,className:"flex-1 py-3 bg-purple-50 text-purple-600 rounded-2xl font-bold text-sm hover:bg-purple-100 transition-colors flex items-center justify-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed border border-purple-100",children:b?E.jsx("span",{className:"animate-pulse",children:"..."}):E.jsxs(E.Fragment,{children:[E.jsx(po,{className:"w-4 h-4"})," ",i.ai_generate_cover]})})]})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E.jsxs("div",{className:"space-y-3",children:[E.jsxs("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase flex items-center gap-1",children:[E.jsx(bp,{className:"w-3 h-3 text-coral"})," ",i.start_date]}),E.jsx("input",{type:"date",required:!0,value:c,onChange:te=>m(te.target.value),className:"w-full p-4 bg-white rounded-2xl border border-sand focus:border-coral outline-none text-sm font-bold text-ink shadow-sm"})]}),E.jsxs("div",{className:"space-y-3",children:[E.jsxs("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase flex items-center gap-1",children:[E.jsx(bp,{className:"w-3 h-3 text-gray-400"})," ",i.end_date]}),E.jsx("input",{type:"date",value:g,onChange:te=>p(te.target.value),className:"w-full p-4 bg-white rounded-2xl border border-sand focus:border-coral outline-none text-sm font-bold text-ink shadow-sm"})]})]}),E.jsxs("div",{className:"pt-4",children:[E.jsxs("button",{type:"submit",className:"w-full py-4 bg-coral text-white rounded-2xl font-bold text-lg shadow-float active:scale-[0.98] transition-all flex items-center justify-center gap-2 hover:bg-coralDark ring-4 ring-white",children:[E.jsx("span",{children:i.create_trip}),E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 text-white/70",children:E.jsx("path",{fillRule:"evenodd",d:"M3 10a.75.75 0 01.75-.75h10.638L10.23 5.29a.75.75 0 111.04-1.08l5.5 5.25a.75.75 0 010 1.08l-5.5 5.25a.75.75 0 11-1.04-1.08l4.158-3.96H3.75A.75.75 0 013 10z",clipRule:"evenodd"})})]}),E.jsx("p",{className:"text-center text-xs text-gray-400 mt-6 font-medium",children:i.add_trip_hint})]})]})]})},EP=({settings:n})=>{const e=(n==null?void 0:n.language)||"zh-TW",t=jt[e]||jt["zh-TW"],[i,r]=X.useState(null),[u,c]=X.useState(null),[m,g]=X.useState(""),[p,x]=X.useState(!1),[A,b]=X.useState(null),M=X.useRef(null),K=z=>{var te;const W=(te=z.target.files)==null?void 0:te[0];if(W){const Q=new FileReader;Q.onloadend=()=>{const me=Q.result;r(me),c(null),b(null)},Q.readAsDataURL(W)}},G=async()=>{if(!(!i||!m)){x(!0),b(null);try{const z=await yw(i,m);c(z)}catch(z){b("Error"),console.error(z)}finally{x(!1)}}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[E.jsxs("div",{className:"px-5 py-4 bg-paper sticky top-0 z-10 flex items-center justify-between",children:[E.jsxs("h2",{className:"text-xl font-extrabold text-ink flex items-center gap-2",children:[E.jsx(po,{className:"w-6 h-6 text-coral"}),t.magic_editor_title]}),E.jsx("span",{className:"text-[10px] font-bold bg-white text-coral border border-coral/20 px-2 py-1 rounded-lg uppercase tracking-wider shadow-sm",children:"Beta"})]}),E.jsx("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 pb-32 no-scrollbar",children:i?E.jsxs("div",{className:"space-y-6 animate-fade-in",children:[E.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-6 snap-x no-scrollbar px-2",children:[E.jsxs("div",{className:"snap-center shrink-0 w-full bg-white p-3 pb-12 rounded-sm shadow-polaroid rotate-1 relative transition-transform hover:rotate-0 duration-300",children:[E.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden mb-2",children:E.jsx("img",{src:i,alt:"Original",className:"w-full h-full object-cover"})}),E.jsx("div",{className:"absolute bottom-4 left-4 font-handwriting text-gray-500 text-sm font-bold",children:"#Original"}),E.jsx("button",{onClick:()=>{r(null),c(null),g("")},className:"absolute -top-2 -right-2 bg-white text-ink p-2 rounded-full shadow-lg border border-sand hover:text-coral",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:E.jsx("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"})})})]}),u&&E.jsxs("div",{className:"snap-center shrink-0 w-full bg-white p-3 pb-12 rounded-sm shadow-polaroid -rotate-1 relative transition-transform hover:rotate-0 duration-300 ring-2 ring-coral/20",children:[E.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden mb-2",children:E.jsx("img",{src:u,alt:"Magic Result",className:"w-full h-full object-cover"})}),E.jsxs("div",{className:"absolute bottom-4 left-4 font-handwriting text-coral font-bold flex items-center gap-1",children:[E.jsx(po,{className:"w-4 h-4"})," #MagicEdit"]})]})]}),E.jsxs("div",{className:"bg-white p-2 rounded-3xl shadow-card border border-sand",children:[E.jsxs("div",{className:"p-4",children:[E.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2 uppercase tracking-wider",children:"Prompt"}),E.jsx("textarea",{value:m,onChange:z=>g(z.target.value),placeholder:t.magic_prompt_placeholder,className:"w-full p-4 rounded-2xl bg-paper border-0 focus:ring-2 focus:ring-coral/50 outline-none text-base resize-none h-24 placeholder:text-gray-300 font-medium text-ink"})]}),A&&E.jsxs("div",{className:"mx-4 mb-2 text-red-500 text-xs bg-red-50 p-3 rounded-xl flex items-center gap-2 font-bold",children:[E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:E.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),A]}),E.jsx("div",{className:"p-2",children:E.jsx("button",{onClick:G,disabled:p||!m.trim(),className:`w-full py-4 rounded-2xl font-bold text-white shadow-lg flex items-center justify-center gap-2 transition-all ${p||!m.trim()?"bg-gray-300 cursor-not-allowed text-gray-500 shadow-none":"bg-coral hover:bg-coralDark hover:shadow-coral/30 active:scale-[0.98]"}`,children:p?E.jsxs(E.Fragment,{children:[E.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[E.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),E.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.generating]}):E.jsxs(E.Fragment,{children:[E.jsx(po,{className:"w-5 h-5 stroke-[2]"}),t.start_magic]})})})]})]}):E.jsxs("div",{onClick:()=>{var z;return(z=M.current)==null?void 0:z.click()},className:"border-2 border-dashed border-sand rounded-3xl h-80 flex flex-col items-center justify-center bg-white cursor-pointer active:scale-[0.98] transition-all hover:border-coral hover:bg-white/80 group shadow-card",children:[E.jsx("div",{className:"w-20 h-20 bg-paper rounded-full shadow-inner flex items-center justify-center mb-5 group-hover:scale-110 transition-transform",children:E.jsx(cu,{className:"w-10 h-10 text-coral"})}),E.jsx("span",{className:"text-ink font-bold text-lg",children:t.upload_hint}),E.jsx("input",{type:"file",ref:M,onChange:K,className:"hidden",accept:"image/*"})]})})]})},xP="modulepreload",wP=function(n){return"/"+n},tE={},$h=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(p){return Promise.all(p.map(x=>Promise.resolve(x).then(A=>({status:"fulfilled",value:A}),A=>({status:"rejected",reason:A}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),g=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));r=c(t.map(p=>{if(p=wP(p),p in tE)return;tE[p]=!0;const x=p.endsWith(".css"),A=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${A}`))return;const b=document.createElement("link");if(b.rel=x?"stylesheet":xP,x||(b.as="script"),b.crossOrigin="",b.href=p,g&&b.setAttribute("nonce",g),document.head.appendChild(b),x)return new Promise((M,K)=>{b.addEventListener("load",M),b.addEventListener("error",()=>K(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(c){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=c,window.dispatchEvent(m),!m.defaultPrevented)throw c}return r.then(c=>{for(const m of c||[])m.status==="rejected"&&u(m.reason);return e().catch(u)})},SP=({items:n,onUpdateItems:e,settings:t})=>{const i=jt[t.language]||jt["zh-TW"],[r,u]=X.useState(""),[c,m]=X.useState(""),[g,p]=X.useState(!1),x=()=>{if(!r.trim())return;const M={id:Date.now().toString(),item:r,bought:!1,notes:c},K=[...n,M];e(K),u(""),m(""),p(!1)},A=M=>{const K=n.map(G=>G.id===M?{...G,bought:!G.bought}:G);e(K)},b=M=>{if(confirm(i.delete_trip_confirm.replace("{title}",i.shopping_list))){const K=n.filter(G=>G.id!==M);e(K)}};return E.jsxs("div",{className:"pb-40",children:[E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-soft text-center mt-2 border border-sand relative overflow-hidden mb-6",children:[E.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-coral"}),E.jsx("h3",{className:"text-gray-400 text-sm font-bold uppercase tracking-widest mb-2",children:i.shopping_list}),E.jsxs("div",{className:"text-5xl font-black text-ink mb-2 tracking-tight",children:[(n==null?void 0:n.filter(M=>M.bought).length)||0,E.jsx("span",{className:"text-2xl text-gray-300 mx-2",children:"/"}),E.jsx("span",{className:"text-3xl text-gray-400",children:(n==null?void 0:n.length)||0})]})]}),(n==null?void 0:n.length)>0?E.jsx("div",{className:"space-y-3",children:n==null?void 0:n.map(M=>E.jsxs("div",{className:`bg-white p-4 rounded-2xl border ${M.bought?"border-green-200 bg-green-50/30":"border-sand"} shadow-card flex items-center justify-between group transition-all`,children:[E.jsxs("div",{className:"flex items-center gap-4 flex-1",onClick:()=>A(M.id),children:[E.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center cursor-pointer transition-colors ${M.bought?"bg-green-500 border-green-500":"border-gray-300 hover:border-coral"}`,children:M.bought&&E.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),E.jsxs("div",{children:[E.jsx("div",{className:`font-bold text-lg ${M.bought?"text-gray-400 line-through":"text-ink"}`,children:M.item}),M.notes&&E.jsx("div",{className:"text-xs text-gray-400 font-medium mt-0.5",children:M.notes})]})]}),E.jsx("button",{onClick:()=>b(M.id),className:"p-2 text-gray-300 hover:text-red-500 transition-colors",children:E.jsx(er,{className:"w-5 h-5"})})]},M.id))}):E.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[E.jsx("div",{className:"w-16 h-16 bg-sand/30 rounded-full flex items-center justify-center text-gray-400",children:E.jsx(Hx,{className:"w-8 h-8"})}),E.jsxs("p",{className:"text-gray-400 font-medium",children:[i.no_itinerary,E.jsx("br",{}),E.jsx("span",{className:"text-xs",children:i.click_add})]})]}),g&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>p(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:M=>M.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_activity}),E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.activity_name}),E.jsx("input",{value:r,onChange:M=>u(M.target.value),placeholder:i.shopping_list,className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal",autoFocus:!0})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.notes}),E.jsx("input",{value:c,onChange:M=>m(M.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-medium border-none shadow-sm outline-none placeholder:font-normal"})]}),E.jsx("button",{onClick:x,disabled:!r.trim(),className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 mt-4 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:i.confirm})]})]})}),E.jsx("button",{onClick:()=>p(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-coral text-white rounded-full shadow-xl shadow-coral/40 flex items-center justify-center z-30 hover:bg-coralDark active:scale-90 transition-all",children:E.jsx(Yh,{className:"w-8 h-8 stroke-[2]"})})]})},AP=({trip:n,settings:e,onUpdateTrip:t,onOpenQuickExpense:i})=>{var Kt;const r=jt[e.language]||jt["zh-TW"],[u,c]=X.useState(null),[m,g]=X.useState(""),[p,x]=X.useState(!1),[A,b]=X.useState(!1),M=X.useRef(null),[K,G]=X.useState(!1),[z,W]=X.useState(null),[te,Q]=X.useState(1),[me,de]=X.useState("09:00"),[fe,V]=X.useState(""),[O,U]=X.useState(""),[H,F]=X.useState(""),[Y,B]=X.useState(null),[Ke,mt]=X.useState("TRAIN"),[oe,Ae]=X.useState(""),[we,Qe]=X.useState(""),[Ne,j]=X.useState(null),[he,Ce]=X.useState(!1),ue=X.useMemo(()=>{const Te=n.itinerary||[],Fe={};return[...Te].sort((Ot,pt)=>Ot.time.localeCompare(pt.time)).forEach(Ot=>{const pt=Ot.day||1;Fe[pt]||(Fe[pt]=[]),Fe[pt].push(Ot)}),Fe},[n.itinerary]),ge=X.useMemo(()=>Object.keys(ue).map(Number).sort((Te,Fe)=>Te-Fe),[ue]);X.useEffect(()=>{u||it()},[u]),X.useEffect(()=>()=>{window.speechSynthesis.cancel()},[]);const Se=async()=>{const Te=[`${n.title} (${n.startDate} - ${n.endDate})`];ge.forEach(Xe=>{Te.push(`
Day ${Xe}:`),ue[Xe].forEach(Ot=>{Te.push(`${Ot.time} ${Ot.activity}`),Ot.travelToNext&&Te.push(`   ${Ot.travelToNext.mode} (${Ot.travelToNext.duration})`)})});const Fe=Te.join(`
`);try{navigator.share?await navigator.share({title:n.title,text:Fe}):(await navigator.clipboard.writeText(Fe),alert(r.share_success))}catch(Xe){console.error("Error sharing:",Xe)}},be=async()=>{if(!(!n.weather||n.weather.length===0)){Ce(!0);try{const Te=await Iw(n.weather,n.title,e.language);j(Te)}catch{j("")}finally{Ce(!1)}}},Me=async(Te,Fe)=>{c({name:Te,location:Fe}),g(""),x(!0);try{const Xe=await ww(Fe,Te);g(Xe||"")}catch{g("")}finally{x(!1)}},ke=()=>{if(A){it();return}if(!m)return;const Te=new SpeechSynthesisUtterance(m);Te.lang=e.language==="en-US"?"en-US":"zh-TW",Te.rate=1,Te.onend=()=>b(!1),M.current=Te,window.speechSynthesis.speak(Te),b(!0)},it=()=>{window.speechSynthesis.cancel(),b(!1)},ut=async Te=>{const Fe=ue[Te];if(!Fe||(Fe==null?void 0:Fe.length)<3){alert(r.optimize_route_min_items||"Need at least 3 items to optimize.");return}B(Te);try{const Ot=(await Cw(Fe,e.language)).map(Rn=>Fe.find(Co=>Co.id===Rn)).filter(Boolean),pt=Fe.map(Rn=>Rn.time).sort(),_n=Ot.map((Rn,Co)=>({...Rn,time:pt[Co]})),Ks=[...(n.itinerary||[]).filter(Rn=>Rn.day!==Te),..._n];t==null||t({...n,itinerary:Ks})}catch(Xe){console.error("Optimization failed",Xe),alert("Route optimization failed.")}finally{B(null)}},je=Te=>{W(Te.id),Q(Te.day),de(Te.time),V(Te.activity),U(Te.location),F(Te.notes||""),Te.travelToNext?(mt(Te.travelToNext.mode),Ae(Te.travelToNext.duration),Qe(Te.travelToNext.details||"")):(Ae(""),Qe("")),G(!0)},Ft=async()=>{var pt;if(!fe)return;let Te=null;if(O)try{const{geocodeAddress:_n}=await $h(async()=>{const{geocodeAddress:is}=await Promise.resolve().then(()=>XP);return{geocodeAddress:is}},void 0);Te=await _n(`${O}, ${n.title}`)}catch(_n){console.error("Auto-geocoding failed",_n)}const Fe=z?(pt=n.itinerary)==null?void 0:pt.find(_n=>_n.id===z):null,Xe={id:z||Date.now().toString(),day:Number(te),time:me,activity:fe,location:O,notes:H,coordinates:Te||(Fe==null?void 0:Fe.coordinates),lat:(Te==null?void 0:Te.lat)||(Fe==null?void 0:Fe.lat),lng:(Te==null?void 0:Te.lng)||(Fe==null?void 0:Fe.lng),attachments:(Fe==null?void 0:Fe.attachments)||[],travelToNext:oe?{mode:Ke,duration:oe,details:we}:void 0};let Ot;z?Ot=(n.itinerary||[]).map(_n=>_n.id===z?Xe:_n):Ot=[...n.itinerary||[],Xe],t==null||t({...n,itinerary:Ot}),W(null),V(""),U(""),F(""),Ae(""),Qe(""),G(!1)},gn=Te=>{if(confirm(r.delete_trip_confirm.replace("{title}",r.itinerary))){const Fe=(n.itinerary||[]).filter(Xe=>Xe.id!==Te);t==null||t({...n,itinerary:Fe})}},Vi=Te=>{Te&&window.open(Te,"_blank")},In=Te=>{switch(Te){case"WALK":return E.jsx(FC,{className:"w-4 h-4"});case"TRAIN":return E.jsx(N0,{className:"w-4 h-4"});case"BUS":return E.jsx(BC,{className:"w-4 h-4"});case"CAR":return E.jsx(NC,{className:"w-4 h-4"});case"FLIGHT":return E.jsx(Ox,{className:"w-4 h-4"});default:return E.jsx(N0,{className:"w-4 h-4"})}},As=()=>{var Te,Fe;return!n.weather||((Te=n.weather)==null?void 0:Te.length)===0?null:E.jsxs("div",{className:"mb-6",children:[E.jsxs("div",{className:"flex items-center justify-between mb-3",children:[E.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1",children:r.weather}),E.jsxs("button",{onClick:be,disabled:he,className:"text-xs font-bold text-coral flex items-center gap-1 hover:bg-coral/10 px-2 py-1 rounded-lg transition-colors",children:[E.jsx(Ip,{className:"w-3 h-3"}),he?"...":""]})]}),E.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar pb-2",children:(Fe=n.weather)==null?void 0:Fe.map((Xe,Ot)=>E.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center justify-center gap-1 bg-white border border-sand p-3 rounded-2xl min-w-[70px] shadow-sm",children:[E.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:Xe.date}),E.jsx("span",{className:"text-2xl drop-shadow-sm",children:Xe.icon}),E.jsxs("span",{className:"text-xs font-bold text-ink",children:[Xe.tempHigh,""]})]},Ot))}),Ne&&E.jsxs("div",{className:"mt-4 bg-white p-5 rounded-3xl shadow-card border border-sand animate-fade-in relative",children:[E.jsx("button",{onClick:()=>j(null),className:"absolute top-3 right-3 text-gray-300 hover:text-gray-500",children:E.jsx(er,{className:"w-4 h-4"})}),E.jsxs("div",{className:"flex items-start gap-3",children:[E.jsx("div",{className:"bg-orange-100 p-2 rounded-full text-orange-500 shrink-0",children:E.jsx(Ip,{className:"w-5 h-5"})}),E.jsxs("div",{children:[E.jsx("h5",{className:"font-bold text-ink mb-2",children:"AI "}),E.jsx("div",{className:"prose prose-sm text-gray-600 leading-relaxed whitespace-pre-line",children:Ne})]})]})]})]})},Nn=e==null?void 0:e.minimalistMode;return E.jsxs("div",{className:"pb-40 relative min-h-full",children:[E.jsxs("div",{className:"sticky top-0 z-20 bg-paper/95 backdrop-blur-md border-b border-sand/50 py-3 mb-6 -mx-5 px-5 flex items-center justify-between shadow-sm",children:[E.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar flex-1 mr-2",children:[E.jsx("span",{className:"text-xs font-bold text-gray-400 shrink-0 mr-1",children:r.nav_quick_jump}),ge.map(Te=>E.jsxs("button",{onClick:()=>{const Fe=document.getElementById(`day-header-${Te}`);Fe&&Fe.scrollIntoView({behavior:"smooth",block:"start"})},className:"flex-shrink-0 px-4 py-1.5 bg-white border border-sand rounded-full font-bold text-ink text-xs hover:border-coral hover:text-coral hover:shadow-md active:bg-coral active:text-white transition-all whitespace-nowrap",children:[r.day," ",Te]},`nav-${Te}`))]}),E.jsx("button",{onClick:Se,className:"p-2 bg-white rounded-full border border-sand text-coral hover:bg-coral hover:text-white transition-colors shadow-sm shrink-0",children:E.jsx(zC,{className:"w-5 h-5"})})]}),!Nn&&As(),((Kt=n.itinerary)==null?void 0:Kt.length)>0?E.jsxs("div",{children:[!Nn&&E.jsx("h4",{className:"text-xs font-bold text-gray-400 mb-4 uppercase tracking-wider ml-1",children:r.itinerary}),ge.map(Te=>{var Fe;return E.jsxs("div",{className:"mb-8 scroll-mt-48",id:`day-header-${Te}`,children:[E.jsxs("div",{className:"flex items-center gap-3 mb-4 sticky top-[60px] bg-paper py-2 z-10 border-b border-sand/50 shadow-sm",children:[E.jsxs("div",{className:"bg-coral text-white px-3 py-1 rounded-lg text-sm font-bold shadow-sm",children:[r.day," ",Te]}),E.jsx("div",{className:"h-px bg-sand flex-1"}),E.jsxs("button",{onClick:()=>ut(Te),disabled:Y===Te,className:"flex items-center gap-1 text-xs font-bold text-coral bg-white border border-coral px-2 py-1 rounded-lg hover:bg-coral hover:text-white transition-colors disabled:opacity-50",children:[Y===Te?E.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"}):E.jsx(po,{className:"w-3 h-3"}),r.optimize_route||"AI Route"]})]}),E.jsx("div",{className:`space-y-0 relative ${Nn?"":"border-l-2 border-sand ml-4"}`,children:(Fe=ue[Te])==null?void 0:Fe.map((Xe,Ot)=>E.jsxs("div",{className:"relative group",children:[E.jsxs("div",{className:`relative ${Nn?"mb-4 border-b border-sand pb-4":"pl-8 pb-10 last:pb-0"}`,children:[!Nn&&E.jsx("div",{className:"absolute -left-[7px] top-1.5 w-3.5 h-3.5 rounded-full border-2 border-paper shadow-sm bg-gray-300 group-hover:bg-coral transition-colors"}),E.jsxs("div",{className:"transition-all opacity-90 group-hover:opacity-100",children:[E.jsxs("div",{className:"flex items-center justify-between mb-2",children:[E.jsx("div",{className:"flex items-center gap-2",children:E.jsx("span",{className:"text-xs font-bold font-mono text-coral bg-coral/10 px-2 py-1 rounded-lg",children:Xe.time})}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("button",{onClick:pt=>{pt.stopPropagation(),i(Xe)},className:"p-1.5 bg-white text-gray-400 rounded-full border border-sand hover:text-green-600 hover:border-green-600 shadow-sm",title:"",children:E.jsx(Ux,{className:"w-3 h-3"})}),E.jsx("button",{onClick:pt=>{pt.stopPropagation(),je(Xe)},className:"p-1.5 bg-white text-gray-400 rounded-full border border-sand hover:text-coral hover:border-coral shadow-sm",title:"",children:E.jsx(qx,{className:"w-3 h-3"})}),E.jsx("button",{onClick:pt=>{pt.stopPropagation(),gn(Xe.id)},className:"p-1.5 bg-white text-red-400 rounded-full border border-red-200 hover:bg-red-50 hover:text-red-600 hover:border-red-500 shadow-sm transition-colors",title:"",children:E.jsx(er,{className:"w-3 h-3"})})]})]}),E.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-card border border-transparent hover:border-sand transition-all relative",children:[E.jsx("button",{onClick:pt=>{pt.stopPropagation(),Me(Xe.activity,Xe.location)},className:"absolute top-4 right-4 text-gray-300 hover:text-coral transition-colors",children:E.jsx(RC,{className:"w-5 h-5"})}),E.jsx("h4",{className:`font-bold text-ink ${Nn?"text-base":"text-lg"} mb-1 pr-6`,children:Xe.activity}),E.jsxs("div",{onClick:()=>Vi(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(Xe.location)}`),className:"flex items-center gap-1.5 text-sm text-gray-500 cursor-pointer hover:text-coral truncate mt-1",children:[E.jsx(Cp,{className:"w-3.5 h-3.5 shrink-0 text-coral"}),Xe.location]}),Xe.notes&&!Nn&&E.jsx("p",{className:"text-sm text-gray-600 mt-3 pt-3 border-t border-gray-50 leading-relaxed",children:Xe.notes})]})]})]}),Xe.travelToNext&&!Nn&&E.jsxs("div",{className:"pl-8 pb-10 relative",children:[E.jsx("div",{className:"absolute left-[0px] top-0 bottom-0 w-0.5 border-l-2 border-dotted border-gray-300 -ml-[1px]"}),E.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-sand rounded-xl p-3 w-fit max-w-[80%]",children:[E.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-sand flex items-center justify-center text-gray-500 shadow-sm shrink-0",children:In(Xe.travelToNext.mode)}),E.jsx("div",{children:E.jsxs("div",{className:"text-xs font-bold text-gray-500 flex items-center gap-1",children:[Xe.travelToNext.duration,Xe.travelToNext.details&&E.jsxs("span",{className:"font-normal text-gray-400",children:[" ",Xe.travelToNext.details]})]})})]})]})]},Xe.id||Ot))})]},Te)})]}):E.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[E.jsx("div",{className:"w-16 h-16 bg-sand/30 rounded-full flex items-center justify-center text-gray-400",children:E.jsx(Fx,{className:"w-8 h-8"})}),E.jsxs("p",{className:"text-gray-400 font-medium",children:[r.no_itinerary,E.jsx("br",{}),E.jsx("span",{className:"text-xs",children:r.click_add})]})]}),u&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>c(null),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[80vh] overflow-y-auto",onClick:Te=>Te.stopPropagation(),children:[E.jsxs("div",{className:"flex items-center justify-between mb-4",children:[E.jsx("h3",{className:"text-xl font-bold text-ink",children:u.name}),E.jsx("button",{onClick:ke,className:`p-2 rounded-full ${A?"bg-coral text-white":"bg-gray-100 text-gray-500"}`,children:E.jsx(CP,{className:"w-5 h-5"})})]}),p?E.jsx("div",{className:"flex justify-center py-10",children:E.jsx("div",{className:"w-8 h-8 border-4 border-coral border-t-transparent rounded-full animate-spin"})}):E.jsx("div",{className:"prose prose-sm text-gray-600 leading-relaxed whitespace-pre-line",children:m})]})}),K&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>G(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",onClick:Te=>Te.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:z?r.edit_activity:r.add_activity}),E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.day}),E.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-sand px-3",children:[E.jsx("span",{className:"text-sm font-bold text-gray-400 mr-2",children:r.day}),E.jsx("input",{type:"number",min:"1",value:te,onChange:Te=>Q(parseInt(Te.target.value)||1),className:"w-full bg-transparent p-3 text-lg font-bold border-none outline-none"})]})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.time}),E.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-sand px-3",children:[E.jsx(IC,{className:"w-5 h-5 text-gray-400 mr-2"}),E.jsx("input",{type:"time",value:me,onChange:Te=>de(Te.target.value),className:"w-full bg-transparent p-3 text-lg font-bold border-none outline-none"})]})]})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.activity_name}),E.jsx("input",{value:fe,onChange:Te=>V(Te.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300",autoFocus:!0})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.location}),E.jsx("input",{value:O,onChange:Te=>U(Te.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300"})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.notes}),E.jsx("textarea",{value:H,onChange:Te=>F(Te.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-medium border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300 min-h-[80px]"})]}),E.jsxs("div",{className:"pt-4 border-t border-sand",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 mb-2 block",children:r.travel_to_next}),E.jsx("div",{className:"flex gap-2 mb-3 overflow-x-auto no-scrollbar",children:["WALK","TRAIN","BUS","CAR","FLIGHT"].map(Te=>E.jsx("button",{onClick:()=>mt(Te),className:`p-2 rounded-lg border ${Ke===Te?"bg-ink text-white border-ink":"bg-white text-gray-400 border-sand"}`,children:In(Te)},Te))}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsx("input",{value:oe,onChange:Te=>Ae(Te.target.value),placeholder:"1h 30m",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"}),E.jsx("input",{value:we,onChange:Te=>Qe(Te.target.value),placeholder:"Details...",className:"w-full bg-white p-3 rounded-xl text-sm font-medium border-none shadow-sm outline-none"})]})]}),E.jsx("div",{className:"sticky bottom-0 bg-paper pt-4 mt-4 border-t border-sand z-10 pb-20",children:E.jsx("button",{onClick:Ft,disabled:!fe,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:z?r.confirm:r.add_activity})})]})]})}),E.jsx("button",{onClick:()=>{W(null),Q(1),de("09:00"),V(""),U(""),F(""),Ae(""),Qe(""),G(!0)},className:"fixed bottom-24 right-6 w-14 h-14 bg-coral text-white rounded-full shadow-xl shadow-coral/40 flex items-center justify-center z-30 hover:bg-coralDark active:scale-90 transition-all",children:E.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})},CP=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:n,children:[E.jsx("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 001.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06zM18.584 5.106a.75.75 0 011.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 11-1.06-1.06 8.25 8.25 0 000-11.668.75.75 0 010-1.06z"}),E.jsx("path",{d:"M15.932 7.757a.75.75 0 011.061 0 6 6 0 010 8.486.75.75 0 01-1.06-1.061 4.5 4.5 0 000-6.364.75.75 0 010-1.06z"})]}),bP=({trip:n,settings:e,onUpdateTrip:t})=>{var Q,me,de,fe,V;const i=jt[e.language]||jt["zh-TW"],[r,u]=X.useState(!1),[c,m]=X.useState(""),[g,p]=X.useState(""),[x,A]=X.useState(""),[b,M]=X.useState("Cash"),K=()=>{var F,Y,B;if(!c||!g)return;const O={id:Date.now().toString(),title:c,amount:parseInt(g),category:"Other",date:new Date().toISOString().split("T")[0],payer:x||"ME",paymentMethod:b},U=((F=n.budget)==null?void 0:F.expenses)||[],H={...n,budget:{...n.budget,total:((Y=n.budget)==null?void 0:Y.total)||0,currency:((B=n.budget)==null?void 0:B.currency)||"TWD",expenses:[O,...U]}};t==null||t(H),u(!1),m(""),p("")},G=O=>{var U,H,F;if(confirm(i.delete_trip_confirm.replace("{title}",i.expense_item))){const B=(((U=n.budget)==null?void 0:U.expenses)||[]).filter(mt=>mt.id!==O),Ke={...n,budget:{...n.budget,total:((H=n.budget)==null?void 0:H.total)||0,currency:((F=n.budget)==null?void 0:F.currency)||"TWD",expenses:B}};t==null||t(Ke)}},z=(((Q=n.budget)==null?void 0:Q.expenses)||[]).reduce((O,U)=>O+U.amount,0),W=((me=n.budget)==null?void 0:me.total)||0,te=W>0?Math.min(z/W*100,100):0;return E.jsxs("div",{className:"pb-32",children:[E.jsxs("div",{className:"bg-ink text-white p-6 rounded-3xl shadow-xl mb-8 relative overflow-hidden",children:[E.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -mr-10 -mt-10 blur-2xl"}),E.jsxs("div",{className:"relative z-10",children:[E.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-1",children:i.budget_total}),E.jsxs("h2",{className:"text-4xl font-black mb-6",children:[E.jsx("span",{className:"text-2xl mr-1",children:""}),W.toLocaleString()]}),E.jsxs("div",{className:"mb-2 flex justify-between text-sm font-bold",children:[E.jsx("span",{className:"text-gray-300",children:i.budget_spent}),E.jsxs("span",{children:["",z.toLocaleString()]})]}),E.jsx("div",{className:"h-3 bg-gray-700 rounded-full overflow-hidden mb-4",children:E.jsx("div",{className:`h-full rounded-full ${te>90?"bg-red-500":"bg-coral"}`,style:{width:`${te}%`}})}),E.jsxs("div",{className:"flex justify-between text-xs text-gray-400 font-medium",children:[E.jsxs("span",{children:[te.toFixed(1),"%"]}),E.jsxs("span",{children:[i.budget_remaining,": ",(W-z).toLocaleString()]})]})]})]}),E.jsxs("div",{className:"space-y-4",children:[E.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1 mb-2",children:i.expense_list}),(fe=(de=n.budget)==null?void 0:de.expenses)==null?void 0:fe.map(O=>E.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-sand flex items-center justify-between group",children:[E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold ${O.payer==="ME"?"bg-coral/10 text-coral":"bg-gray-100 text-gray-500"}`,children:O.payer==="ME"?"":""}),E.jsxs("div",{children:[E.jsx("h4",{className:"font-bold text-ink",children:O.title}),E.jsxs("p",{className:"text-xs text-gray-400",children:[O.date,"  ",O.paymentMethod]}),O.note&&E.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:O.note})]})]}),E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsxs("span",{className:"font-bold text-ink text-lg",children:["",O.amount.toLocaleString()]}),E.jsx("button",{onClick:()=>G(O.id),className:"text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all",children:E.jsx(er,{className:"w-5 h-5"})})]})]},O.id)),(!((V=n.budget)!=null&&V.expenses)||n.budget.expenses.length===0)&&E.jsx("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:i.no_expenses})]}),r&&E.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>u(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up relative",onClick:O=>O.stopPropagation(),children:[E.jsx("button",{onClick:()=>u(!1),className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),E.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_expense}),E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.expense_item}),E.jsx("input",{value:c,onChange:O=>m(O.target.value),placeholder:": ",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal",autoFocus:!0})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.amount}),E.jsxs("div",{className:"flex items-center bg-white rounded-xl border-none shadow-sm px-4",children:[E.jsx("span",{className:"text-gray-400 font-bold mr-2",children:""}),E.jsx("input",{value:g,onChange:O=>p(O.target.value),type:"number",placeholder:"0",className:"w-full bg-transparent py-4 text-xl font-bold border-none outline-none placeholder:font-normal"})]})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{className:"flex bg-white rounded-xl p-1 shadow-sm",children:[E.jsx("button",{onClick:()=>A("ME"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${x==="ME"||x===""?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payer_me}),E.jsx("button",{onClick:()=>A("OTHER"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${x==="OTHER"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payer_other})]}),E.jsxs("div",{className:"flex bg-white rounded-xl p-1 shadow-sm",children:[E.jsx("button",{onClick:()=>M("Cash"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${b==="Cash"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payment_cash}),E.jsx("button",{onClick:()=>M("Card"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${b==="Card"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payment_card})]})]}),E.jsx("div",{className:"space-y-1",children:E.jsxs("select",{className:"w-full bg-white p-3 rounded-xl font-bold text-ink border-none shadow-sm outline-none h-[48px] text-center",children:[E.jsx("option",{value:"Individual",children:i.split_individual}),E.jsx("option",{value:"Shared",children:i.split_shared})]})}),E.jsxs("div",{className:"space-y-3 pt-2",children:[E.jsx("button",{onClick:K,disabled:!c||!g,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:"+ "}),E.jsx("button",{onClick:()=>u(!1),className:"w-full py-3 bg-transparent text-gray-400 font-bold hover:text-gray-600 transition-colors",children:""})]})]})]})}),E.jsx("button",{onClick:()=>u(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-ink text-white rounded-full shadow-xl shadow-ink/40 flex items-center justify-center z-30 hover:scale-105 active:scale-95 transition-all",children:E.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})},IP=({trip:n,settings:e,onUpdateTrip:t})=>{var fe;const i=jt[e.language]||jt["zh-TW"],[r,u]=X.useState(!1),[c,m]=X.useState("FLIGHT"),[g,p]=X.useState(""),[x,A]=X.useState(""),[b,M]=X.useState(""),[K,G]=X.useState(""),[z,W]=X.useState(""),[te,Q]=X.useState(""),me=()=>{if(!g)return;const O=[{id:Date.now().toString(),type:c,airline:g,number:x||"N/A",origin:b||"-",destination:K||"-",departureTime:z?`${z} ${te}`:te||"00:00",arrivalTime:"-",status:"Confirmed",bookingUrl:""},...n.bookings||[]];t==null||t({...n,bookings:O}),p(""),A(""),M(""),G(""),W(""),Q(""),u(!1)},de=V=>{if(confirm(i.delete_trip_confirm.replace("{title}",i.bookings))){const U=(n.bookings||[]).filter(H=>H.id!==V);t==null||t({...n,bookings:U})}};return E.jsxs("div",{className:"pb-32",children:[E.jsxs("div",{className:"space-y-4",children:[(fe=n.bookings)==null?void 0:fe.map(V=>E.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-sand relative group",children:[E.jsxs("div",{className:"flex justify-between items-start mb-4",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"w-10 h-10 bg-blue-50 text-blue-500 rounded-xl flex items-center justify-center",children:V.type==="FLIGHT"?E.jsx(Ox,{className:"w-5 h-5"}):E.jsx(zx,{className:"w-5 h-5"})}),E.jsxs("div",{children:[E.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:V.type}),E.jsx("h4",{className:"font-bold text-ink text-lg",children:V.airline})]})]}),E.jsx("div",{className:"text-right",children:E.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-bold ${V.status==="Confirmed"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-500"}`,children:V.status})})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[E.jsxs("div",{children:[E.jsx("p",{className:"text-xs text-gray-400 font-bold mb-1",children:"DEPARTURE"}),E.jsx("p",{className:"text-ink font-bold text-lg",children:V.origin}),E.jsx("p",{className:"text-sm text-gray-500",children:V.departureTime})]}),E.jsxs("div",{className:"text-right",children:[E.jsx("p",{className:"text-xs text-gray-400 font-bold mb-1",children:"ARRIVAL"}),E.jsx("p",{className:"text-ink font-bold text-lg",children:V.destination}),E.jsx("p",{className:"text-sm text-gray-500",children:V.arrivalTime})]})]}),E.jsxs("div",{className:"pt-4 border-t border-sand flex justify-between items-center",children:[E.jsxs("div",{className:"text-xs text-gray-400 font-mono",children:["REF: ",E.jsx("span",{className:"text-ink font-bold",children:V.number})]}),E.jsx("button",{onClick:()=>de(V.id),className:"text-gray-300 hover:text-red-500 transition-colors",children:E.jsx(er,{className:"w-4 h-4"})})]})]},V.id)),(!n.bookings||n.bookings.length===0)&&E.jsx("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:i.no_bookings})]}),r&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>u(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",onClick:V=>V.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_booking}),E.jsxs("div",{className:"space-y-4",children:[E.jsx("div",{className:"flex bg-white rounded-xl p-1 shadow-sm mb-4",children:["FLIGHT","HOTEL","TRAIN"].map(V=>E.jsx("button",{onClick:()=>m(V),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${c===V?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:V},V))}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.provider}),E.jsx("input",{value:g,onChange:V=>p(V.target.value),placeholder:"Airline / Hotel Name...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none",autoFocus:!0})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.ref_number}),E.jsx("input",{value:x,onChange:V=>A(V.target.value),placeholder:"PNR...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.date}),E.jsx("input",{type:"date",value:z,onChange:V=>W(V.target.value),className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.origin}),E.jsx("input",{value:b,onChange:V=>M(V.target.value),placeholder:"TPE...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.label_destination}),E.jsx("input",{value:K,onChange:V=>G(V.target.value),placeholder:"NRT...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]})]}),E.jsx("button",{onClick:me,disabled:!g,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 mt-4 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:i.confirm})]})]})}),E.jsx("button",{onClick:()=>u(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-blue-500 text-white rounded-full shadow-xl shadow-blue-500/40 flex items-center justify-center z-30 hover:scale-105 active:scale-95 transition-all",children:E.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})};function Nw(n,e){const t=X.useRef(e);X.useEffect(function(){e!==t.current&&n.attributionControl!=null&&(t.current!=null&&n.attributionControl.removeAttribution(t.current),e!=null&&n.attributionControl.addAttribution(e)),t.current=e},[n,e])}var NP=Vx();const RP=1;function MP(n){return Object.freeze({__version:RP,map:n})}function Rw(n,e){return Object.freeze({...n,...e})}const Sg=X.createContext(null);function ef(){const n=X.use(Sg);if(n==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}function Mw(n){function e(t,i){const{instance:r,context:u}=n(t).current;X.useImperativeHandle(i,()=>r);const{children:c}=t;return c==null?null:Sh.createElement(Sg,{value:u},c)}return X.forwardRef(e)}function PP(n){function e(t,i){const[r,u]=X.useState(!1),{instance:c}=n(t,u).current;X.useImperativeHandle(i,()=>c),X.useEffect(function(){r&&c.update()},[c,r,t.children]);const m=c._contentNode;return m?NP.createPortal(t.children,m):null}return X.forwardRef(e)}function DP(n){function e(t,i){const{instance:r}=n(t).current;return X.useImperativeHandle(i,()=>r),null}return X.forwardRef(e)}function Ag(n,e){const t=X.useRef(void 0);X.useEffect(function(){return e!=null&&n.instance.on(e),t.current=e,function(){t.current!=null&&n.instance.off(t.current),t.current=null}},[n,e])}function tf(n,e){const t=n.pane??e.pane;return t?{...n,pane:t}:n}function kP(n,e){return function(i,r){const u=ef(),c=n(tf(i,u),u);return Nw(u.map,i.attribution),Ag(c.current,i.eventHandlers),e(c.current,u,i,r),c}}var Tc={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var LP=Tc.exports,nE;function VP(){return nE||(nE=1,(function(n,e){(function(t,i){i(e)})(LP,(function(t){var i="1.9.4";function r(a){var d,v,S,I;for(v=1,S=arguments.length;v<S;v++){I=arguments[v];for(d in I)a[d]=I[d]}return a}var u=Object.create||(function(){function a(){}return function(d){return a.prototype=d,new a}})();function c(a,d){var v=Array.prototype.slice;if(a.bind)return a.bind.apply(a,v.call(arguments,1));var S=v.call(arguments,2);return function(){return a.apply(d,S.length?S.concat(v.call(arguments)):arguments)}}var m=0;function g(a){return"_leaflet_id"in a||(a._leaflet_id=++m),a._leaflet_id}function p(a,d,v){var S,I,P,q;return q=function(){S=!1,I&&(P.apply(v,I),I=!1)},P=function(){S?I=arguments:(a.apply(v,arguments),setTimeout(q,d),S=!0)},P}function x(a,d,v){var S=d[1],I=d[0],P=S-I;return a===S&&v?a:((a-I)%P+P)%P+I}function A(){return!1}function b(a,d){if(d===!1)return a;var v=Math.pow(10,d===void 0?6:d);return Math.round(a*v)/v}function M(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function K(a){return M(a).split(/\s+/)}function G(a,d){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?u(a.options):{});for(var v in d)a.options[v]=d[v];return a.options}function z(a,d,v){var S=[];for(var I in a)S.push(encodeURIComponent(v?I.toUpperCase():I)+"="+encodeURIComponent(a[I]));return(!d||d.indexOf("?")===-1?"?":"&")+S.join("&")}var W=/\{ *([\w_ -]+) *\}/g;function te(a,d){return a.replace(W,function(v,S){var I=d[S];if(I===void 0)throw new Error("No value provided for variable "+v);return typeof I=="function"&&(I=I(d)),I})}var Q=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function me(a,d){for(var v=0;v<a.length;v++)if(a[v]===d)return v;return-1}var de="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function fe(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var V=0;function O(a){var d=+new Date,v=Math.max(0,16-(d-V));return V=d+v,window.setTimeout(a,v)}var U=window.requestAnimationFrame||fe("RequestAnimationFrame")||O,H=window.cancelAnimationFrame||fe("CancelAnimationFrame")||fe("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function F(a,d,v){if(v&&U===O)a.call(d);else return U.call(window,c(a,d))}function Y(a){a&&H.call(window,a)}var B={__proto__:null,extend:r,create:u,bind:c,get lastId(){return m},stamp:g,throttle:p,wrapNum:x,falseFn:A,formatNum:b,trim:M,splitWords:K,setOptions:G,getParamString:z,template:te,isArray:Q,indexOf:me,emptyImageUrl:de,requestFn:U,cancelFn:H,requestAnimFrame:F,cancelAnimFrame:Y};function Ke(){}Ke.extend=function(a){var d=function(){G(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=d.__super__=this.prototype,S=u(v);S.constructor=d,d.prototype=S;for(var I in this)Object.prototype.hasOwnProperty.call(this,I)&&I!=="prototype"&&I!=="__super__"&&(d[I]=this[I]);return a.statics&&r(d,a.statics),a.includes&&(mt(a.includes),r.apply(null,[S].concat(a.includes))),r(S,a),delete S.statics,delete S.includes,S.options&&(S.options=v.options?u(v.options):{},r(S.options,a.options)),S._initHooks=[],S.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var P=0,q=S._initHooks.length;P<q;P++)S._initHooks[P].call(this)}},d},Ke.include=function(a){var d=this.prototype.options;return r(this.prototype,a),a.options&&(this.prototype.options=d,this.mergeOptions(a.options)),this},Ke.mergeOptions=function(a){return r(this.prototype.options,a),this},Ke.addInitHook=function(a){var d=Array.prototype.slice.call(arguments,1),v=typeof a=="function"?a:function(){this[a].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function mt(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=Q(a)?a:[a];for(var d=0;d<a.length;d++)a[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var oe={on:function(a,d,v){if(typeof a=="object")for(var S in a)this._on(S,a[S],d);else{a=K(a);for(var I=0,P=a.length;I<P;I++)this._on(a[I],d,v)}return this},off:function(a,d,v){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var S in a)this._off(S,a[S],d);else{a=K(a);for(var I=arguments.length===1,P=0,q=a.length;P<q;P++)I?this._off(a[P]):this._off(a[P],d,v)}return this},_on:function(a,d,v,S){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(a,d,v)===!1){v===this&&(v=void 0);var I={fn:d,ctx:v};S&&(I.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(I)}},_off:function(a,d,v){var S,I,P;if(this._events&&(S=this._events[a],!!S)){if(arguments.length===1){if(this._firingCount)for(I=0,P=S.length;I<P;I++)S[I].fn=A;delete this._events[a];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var q=this._listens(a,d,v);if(q!==!1){var ee=S[q];this._firingCount&&(ee.fn=A,this._events[a]=S=S.slice()),S.splice(q,1)}}},fire:function(a,d,v){if(!this.listens(a,v))return this;var S=r({},d,{type:a,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var I=this._events[a];if(I){this._firingCount=this._firingCount+1||1;for(var P=0,q=I.length;P<q;P++){var ee=I[P],re=ee.fn;ee.once&&this.off(a,re,ee.ctx),re.call(ee.ctx||this,S)}this._firingCount--}}return v&&this._propagateEvent(S),this},listens:function(a,d,v,S){typeof a!="string"&&console.warn('"string" type argument expected');var I=d;typeof d!="function"&&(S=!!d,I=void 0,v=void 0);var P=this._events&&this._events[a];if(P&&P.length&&this._listens(a,I,v)!==!1)return!0;if(S){for(var q in this._eventParents)if(this._eventParents[q].listens(a,d,v,S))return!0}return!1},_listens:function(a,d,v){if(!this._events)return!1;var S=this._events[a]||[];if(!d)return!!S.length;v===this&&(v=void 0);for(var I=0,P=S.length;I<P;I++)if(S[I].fn===d&&S[I].ctx===v)return I;return!1},once:function(a,d,v){if(typeof a=="object")for(var S in a)this._on(S,a[S],d,!0);else{a=K(a);for(var I=0,P=a.length;I<P;I++)this._on(a[I],d,v,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[g(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[g(a)],this},_propagateEvent:function(a){for(var d in this._eventParents)this._eventParents[d].fire(a.type,r({layer:a.target,propagatedFrom:a.target},a),!0)}};oe.addEventListener=oe.on,oe.removeEventListener=oe.clearAllEventListeners=oe.off,oe.addOneTimeEventListener=oe.once,oe.fireEvent=oe.fire,oe.hasEventListeners=oe.listens;var Ae=Ke.extend(oe);function we(a,d,v){this.x=v?Math.round(a):a,this.y=v?Math.round(d):d}var Qe=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};we.prototype={clone:function(){return new we(this.x,this.y)},add:function(a){return this.clone()._add(Ne(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(Ne(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new we(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new we(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Qe(this.x),this.y=Qe(this.y),this},distanceTo:function(a){a=Ne(a);var d=a.x-this.x,v=a.y-this.y;return Math.sqrt(d*d+v*v)},equals:function(a){return a=Ne(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=Ne(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}};function Ne(a,d,v){return a instanceof we?a:Q(a)?new we(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new we(a.x,a.y):new we(a,d,v)}function j(a,d){if(a)for(var v=d?[a,d]:a,S=0,I=v.length;S<I;S++)this.extend(v[S])}j.prototype={extend:function(a){var d,v;if(!a)return this;if(a instanceof we||typeof a[0]=="number"||"x"in a)d=v=Ne(a);else if(a=he(a),d=a.min,v=a.max,!d||!v)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=v.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(a){return Ne((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return Ne(this.min.x,this.max.y)},getTopRight:function(){return Ne(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var d,v;return typeof a[0]=="number"||a instanceof we?a=Ne(a):a=he(a),a instanceof j?(d=a.min,v=a.max):d=v=a,d.x>=this.min.x&&v.x<=this.max.x&&d.y>=this.min.y&&v.y<=this.max.y},intersects:function(a){a=he(a);var d=this.min,v=this.max,S=a.min,I=a.max,P=I.x>=d.x&&S.x<=v.x,q=I.y>=d.y&&S.y<=v.y;return P&&q},overlaps:function(a){a=he(a);var d=this.min,v=this.max,S=a.min,I=a.max,P=I.x>d.x&&S.x<v.x,q=I.y>d.y&&S.y<v.y;return P&&q},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var d=this.min,v=this.max,S=Math.abs(d.x-v.x)*a,I=Math.abs(d.y-v.y)*a;return he(Ne(d.x-S,d.y-I),Ne(v.x+S,v.y+I))},equals:function(a){return a?(a=he(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function he(a,d){return!a||a instanceof j?a:new j(a,d)}function Ce(a,d){if(a)for(var v=d?[a,d]:a,S=0,I=v.length;S<I;S++)this.extend(v[S])}Ce.prototype={extend:function(a){var d=this._southWest,v=this._northEast,S,I;if(a instanceof ge)S=a,I=a;else if(a instanceof Ce){if(S=a._southWest,I=a._northEast,!S||!I)return this}else return a?this.extend(Se(a)||ue(a)):this;return!d&&!v?(this._southWest=new ge(S.lat,S.lng),this._northEast=new ge(I.lat,I.lng)):(d.lat=Math.min(S.lat,d.lat),d.lng=Math.min(S.lng,d.lng),v.lat=Math.max(I.lat,v.lat),v.lng=Math.max(I.lng,v.lng)),this},pad:function(a){var d=this._southWest,v=this._northEast,S=Math.abs(d.lat-v.lat)*a,I=Math.abs(d.lng-v.lng)*a;return new Ce(new ge(d.lat-S,d.lng-I),new ge(v.lat+S,v.lng+I))},getCenter:function(){return new ge((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ge(this.getNorth(),this.getWest())},getSouthEast:function(){return new ge(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof ge||"lat"in a?a=Se(a):a=ue(a);var d=this._southWest,v=this._northEast,S,I;return a instanceof Ce?(S=a.getSouthWest(),I=a.getNorthEast()):S=I=a,S.lat>=d.lat&&I.lat<=v.lat&&S.lng>=d.lng&&I.lng<=v.lng},intersects:function(a){a=ue(a);var d=this._southWest,v=this._northEast,S=a.getSouthWest(),I=a.getNorthEast(),P=I.lat>=d.lat&&S.lat<=v.lat,q=I.lng>=d.lng&&S.lng<=v.lng;return P&&q},overlaps:function(a){a=ue(a);var d=this._southWest,v=this._northEast,S=a.getSouthWest(),I=a.getNorthEast(),P=I.lat>d.lat&&S.lat<v.lat,q=I.lng>d.lng&&S.lng<v.lng;return P&&q},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,d){return a?(a=ue(a),this._southWest.equals(a.getSouthWest(),d)&&this._northEast.equals(a.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ue(a,d){return a instanceof Ce?a:new Ce(a,d)}function ge(a,d,v){if(isNaN(a)||isNaN(d))throw new Error("Invalid LatLng object: ("+a+", "+d+")");this.lat=+a,this.lng=+d,v!==void 0&&(this.alt=+v)}ge.prototype={equals:function(a,d){if(!a)return!1;a=Se(a);var v=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return v<=(d===void 0?1e-9:d)},toString:function(a){return"LatLng("+b(this.lat,a)+", "+b(this.lng,a)+")"},distanceTo:function(a){return Me.distance(this,Se(a))},wrap:function(){return Me.wrapLatLng(this)},toBounds:function(a){var d=180*a/40075017,v=d/Math.cos(Math.PI/180*this.lat);return ue([this.lat-d,this.lng-v],[this.lat+d,this.lng+v])},clone:function(){return new ge(this.lat,this.lng,this.alt)}};function Se(a,d,v){return a instanceof ge?a:Q(a)&&typeof a[0]!="object"?a.length===3?new ge(a[0],a[1],a[2]):a.length===2?new ge(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new ge(a.lat,"lng"in a?a.lng:a.lon,a.alt):d===void 0?null:new ge(a,d,v)}var be={latLngToPoint:function(a,d){var v=this.projection.project(a),S=this.scale(d);return this.transformation._transform(v,S)},pointToLatLng:function(a,d){var v=this.scale(d),S=this.transformation.untransform(a,v);return this.projection.unproject(S)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var d=this.projection.bounds,v=this.scale(a),S=this.transformation.transform(d.min,v),I=this.transformation.transform(d.max,v);return new j(S,I)},infinite:!1,wrapLatLng:function(a){var d=this.wrapLng?x(a.lng,this.wrapLng,!0):a.lng,v=this.wrapLat?x(a.lat,this.wrapLat,!0):a.lat,S=a.alt;return new ge(v,d,S)},wrapLatLngBounds:function(a){var d=a.getCenter(),v=this.wrapLatLng(d),S=d.lat-v.lat,I=d.lng-v.lng;if(S===0&&I===0)return a;var P=a.getSouthWest(),q=a.getNorthEast(),ee=new ge(P.lat-S,P.lng-I),re=new ge(q.lat-S,q.lng-I);return new Ce(ee,re)}},Me=r({},be,{wrapLng:[-180,180],R:6371e3,distance:function(a,d){var v=Math.PI/180,S=a.lat*v,I=d.lat*v,P=Math.sin((d.lat-a.lat)*v/2),q=Math.sin((d.lng-a.lng)*v/2),ee=P*P+Math.cos(S)*Math.cos(I)*q*q,re=2*Math.atan2(Math.sqrt(ee),Math.sqrt(1-ee));return this.R*re}}),ke=6378137,it={R:ke,MAX_LATITUDE:85.0511287798,project:function(a){var d=Math.PI/180,v=this.MAX_LATITUDE,S=Math.max(Math.min(v,a.lat),-v),I=Math.sin(S*d);return new we(this.R*a.lng*d,this.R*Math.log((1+I)/(1-I))/2)},unproject:function(a){var d=180/Math.PI;return new ge((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*d,a.x*d/this.R)},bounds:(function(){var a=ke*Math.PI;return new j([-a,-a],[a,a])})()};function ut(a,d,v,S){if(Q(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=d,this._c=v,this._d=S}ut.prototype={transform:function(a,d){return this._transform(a.clone(),d)},_transform:function(a,d){return d=d||1,a.x=d*(this._a*a.x+this._b),a.y=d*(this._c*a.y+this._d),a},untransform:function(a,d){return d=d||1,new we((a.x/d-this._b)/this._a,(a.y/d-this._d)/this._c)}};function je(a,d,v,S){return new ut(a,d,v,S)}var Ft=r({},Me,{code:"EPSG:3857",projection:it,transformation:(function(){var a=.5/(Math.PI*it.R);return je(a,.5,-a,.5)})()}),gn=r({},Ft,{code:"EPSG:900913"});function Vi(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function In(a,d){var v="",S,I,P,q,ee,re;for(S=0,P=a.length;S<P;S++){for(ee=a[S],I=0,q=ee.length;I<q;I++)re=ee[I],v+=(I?"L":"M")+re.x+" "+re.y;v+=d?Oe.svg?"z":"x":""}return v||"M0 0"}var As=document.documentElement.style,Nn="ActiveXObject"in window,Kt=Nn&&!document.addEventListener,Te="msLaunchUri"in navigator&&!("documentMode"in document),Fe=kn("webkit"),Xe=kn("android"),Ot=kn("android 2")||kn("android 3"),pt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),_n=Xe&&kn("Google")&&pt<537&&!("AudioNode"in window),is=!!window.opera,Ks=!Te&&kn("chrome"),Rn=kn("gecko")&&!Fe&&!is&&!Nn,Co=!Ks&&kn("safari"),ma=kn("phantom"),pa="OTransition"in As,dl=navigator.platform.indexOf("Win")===0,gi=Nn&&"transition"in As,hn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ot,ui="MozPerspective"in As,tn=!window.L_DISABLE_3D&&(gi||hn||ui)&&!pa&&!ma,Ys=typeof orientation<"u"||kn("mobile"),ur=Ys&&Fe,hl=Ys&&hn,Oi=!window.PointerEvent&&window.MSPointerEvent,Js=!!(window.PointerEvent||Oi),nn="ontouchstart"in window||!!window.TouchEvent,ss=!window.L_NO_TOUCH&&(nn||Js),os=Ys&&is,Ui=Ys&&Rn,Pu=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,fl=(function(){var a=!1;try{var d=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",A,d),window.removeEventListener("testPassiveEventSupport",A,d)}catch{}return a})(),rs=(function(){return!!document.createElement("canvas").getContext})(),Cs=!!(document.createElementNS&&Vi("svg").createSVGRect),Du=!!Cs&&(function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),bo=!Cs&&(function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var d=a.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch{return!1}})(),ga=navigator.platform.indexOf("Mac")===0,_a=navigator.platform.indexOf("Linux")===0;function kn(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var Oe={ie:Nn,ielt9:Kt,edge:Te,webkit:Fe,android:Xe,android23:Ot,androidStock:_n,opera:is,chrome:Ks,gecko:Rn,safari:Co,phantom:ma,opera12:pa,win:dl,ie3d:gi,webkit3d:hn,gecko3d:ui,any3d:tn,mobile:Ys,mobileWebkit:ur,mobileWebkit3d:hl,msPointer:Oi,pointer:Js,touch:ss,touchNative:nn,mobileOpera:os,mobileGecko:Ui,retina:Pu,passiveEvents:fl,canvas:rs,svg:Cs,vml:bo,inlineSvg:Du,mac:ga,linux:_a},ya=Oe.msPointer?"MSPointerDown":"pointerdown",_i=Oe.msPointer?"MSPointerMove":"pointermove",yi=Oe.msPointer?"MSPointerUp":"pointerup",sn=Oe.msPointer?"MSPointerCancel":"pointercancel",an={touchstart:ya,touchmove:_i,touchend:yi,touchcancel:sn},zi={touchstart:ls,touchmove:Ln,touchend:Ln,touchcancel:Ln},Bi={},ml=!1;function pl(a,d,v){return d==="touchstart"&&vi(),zi[d]?(v=zi[d].bind(this,v),a.addEventListener(an[d],v,!1),v):(console.warn("wrong event specified:",d),A)}function gl(a,d,v){if(!an[d]){console.warn("wrong event specified:",d);return}a.removeEventListener(an[d],v,!1)}function as(a){Bi[a.pointerId]=a}function cr(a){Bi[a.pointerId]&&(Bi[a.pointerId]=a)}function Fi(a){delete Bi[a.pointerId]}function vi(){ml||(document.addEventListener(ya,as,!0),document.addEventListener(_i,cr,!0),document.addEventListener(yi,Fi,!0),document.addEventListener(sn,Fi,!0),ml=!0)}function Ln(a,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var v in Bi)d.touches.push(Bi[v]);d.changedTouches=[d],a(d)}}function ls(a,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&Wt(d),Ln(a,d)}function ln(a){var d={},v,S;for(S in a)v=a[S],d[S]=v&&v.bind?v.bind(a):v;return a=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var va=200;function Ta(a,d){a.addEventListener("dblclick",d);var v=0,S;function I(P){if(P.detail!==1){S=P.detail;return}if(!(P.pointerType==="mouse"||P.sourceCapabilities&&!P.sourceCapabilities.firesTouchEvents)){var q=eo(P);if(!(q.some(function(re){return re instanceof HTMLLabelElement&&re.attributes.for})&&!q.some(function(re){return re instanceof HTMLInputElement||re instanceof HTMLSelectElement}))){var ee=Date.now();ee-v<=va?(S++,S===2&&d(ln(P))):S=1,v=ee}}}return a.addEventListener("click",I),{dblclick:d,simDblclick:I}}function us(a,d){a.removeEventListener("dblclick",d.dblclick),a.removeEventListener("click",d.simDblclick)}var Ti=No(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),bs=No(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),dr=bs==="webkitTransition"||bs==="OTransition"?bs+"End":"transitionend";function hr(a){return typeof a=="string"?document.getElementById(a):a}function Ws(a,d){var v=a.style[d]||a.currentStyle&&a.currentStyle[d];if((!v||v==="auto")&&document.defaultView){var S=document.defaultView.getComputedStyle(a,null);v=S?S[d]:null}return v==="auto"?null:v}function lt(a,d,v){var S=document.createElement(a);return S.className=d||"",v&&v.appendChild(S),S}function ct(a){var d=a.parentNode;d&&d.removeChild(a)}function Yt(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function Jt(a){var d=a.parentNode;d&&d.lastChild!==a&&d.appendChild(a)}function ci(a){var d=a.parentNode;d&&d.firstChild!==a&&d.insertBefore(a,d.firstChild)}function Io(a,d){if(a.classList!==void 0)return a.classList.contains(d);var v=cs(a);return v.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(v)}function De(a,d){if(a.classList!==void 0)for(var v=K(d),S=0,I=v.length;S<I;S++)a.classList.add(v[S]);else if(!Io(a,d)){var P=cs(a);Ei(a,(P?P+" ":"")+d)}}function Dt(a,d){a.classList!==void 0?a.classList.remove(d):Ei(a,M((" "+cs(a)+" ").replace(" "+d+" "," ")))}function Ei(a,d){a.className.baseVal===void 0?a.className=d:a.className.baseVal=d}function cs(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function qt(a,d){"opacity"in a.style?a.style.opacity=d:"filter"in a.style&&fr(a,d)}function fr(a,d){var v=!1,S="DXImageTransform.Microsoft.Alpha";try{v=a.filters.item(S)}catch{if(d===1)return}d=Math.round(d*100),v?(v.Enabled=d!==100,v.Opacity=d):a.style.filter+=" progid:"+S+"(opacity="+d+")"}function No(a){for(var d=document.documentElement.style,v=0;v<a.length;v++)if(a[v]in d)return a[v];return!1}function qi(a,d,v){var S=d||new we(0,0);a.style[Ti]=(Oe.ie3d?"translate("+S.x+"px,"+S.y+"px)":"translate3d("+S.x+"px,"+S.y+"px,0)")+(v?" scale("+v+")":"")}function kt(a,d){a._leaflet_pos=d,Oe.any3d?qi(a,d):(a.style.left=d.x+"px",a.style.top=d.y+"px")}function ds(a){return a._leaflet_pos||new we(0,0)}var xi,yn,mr;if("onselectstart"in document)xi=function(){Ge(window,"selectstart",Wt)},yn=function(){At(window,"selectstart",Wt)};else{var Is=No(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);xi=function(){if(Is){var a=document.documentElement.style;mr=a[Is],a[Is]="none"}},yn=function(){Is&&(document.documentElement.style[Is]=mr,mr=void 0)}}function Ro(){Ge(window,"dragstart",Wt)}function Qs(){At(window,"dragstart",Wt)}var Mo,hs;function Xs(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(Wn(),Mo=a,hs=a.style.outlineStyle,a.style.outlineStyle="none",Ge(window,"keydown",Wn))}function Wn(){Mo&&(Mo.style.outlineStyle=hs,Mo=void 0,hs=void 0,At(window,"keydown",Wn))}function pr(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function Qn(a){var d=a.getBoundingClientRect();return{x:d.width/a.offsetWidth||1,y:d.height/a.offsetHeight||1,boundingClientRect:d}}var $s={__proto__:null,TRANSFORM:Ti,TRANSITION:bs,TRANSITION_END:dr,get:hr,getStyle:Ws,create:lt,remove:ct,empty:Yt,toFront:Jt,toBack:ci,hasClass:Io,addClass:De,removeClass:Dt,setClass:Ei,getClass:cs,setOpacity:qt,testProp:No,setTransform:qi,setPosition:kt,getPosition:ds,get disableTextSelection(){return xi},get enableTextSelection(){return yn},disableImageDrag:Ro,enableImageDrag:Qs,preventOutline:Xs,restoreOutline:Wn,getSizedParentNode:pr,getScale:Qn};function Ge(a,d,v,S){if(d&&typeof d=="object")for(var I in d)Xn(a,I,d[I],v);else{d=K(d);for(var P=0,q=d.length;P<q;P++)Xn(a,d[P],v,S)}return this}var Vn="_leaflet_events";function At(a,d,v,S){if(arguments.length===1)Ns(a),delete a[Vn];else if(d&&typeof d=="object")for(var I in d)Rs(a,I,d[I],v);else if(d=K(d),arguments.length===2)Ns(a,function(ee){return me(d,ee)!==-1});else for(var P=0,q=d.length;P<q;P++)Rs(a,d[P],v,S);return this}function Ns(a,d){for(var v in a[Vn]){var S=v.split(/\d/)[0];(!d||d(S))&&Rs(a,S,null,null,v)}}var di={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Xn(a,d,v,S){var I=d+g(v)+(S?"_"+g(S):"");if(a[Vn]&&a[Vn][I])return this;var P=function(ee){return v.call(S||a,ee||window.event)},q=P;!Oe.touchNative&&Oe.pointer&&d.indexOf("touch")===0?P=pl(a,d,P):Oe.touch&&d==="dblclick"?P=Ta(a,P):"addEventListener"in a?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?a.addEventListener(di[d]||d,P,Oe.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(P=function(ee){ee=ee||window.event,ji(a,ee)&&q(ee)},a.addEventListener(di[d],P,!1)):a.addEventListener(d,q,!1):a.attachEvent("on"+d,P),a[Vn]=a[Vn]||{},a[Vn][I]=P}function Rs(a,d,v,S,I){I=I||d+g(v)+(S?"_"+g(S):"");var P=a[Vn]&&a[Vn][I];if(!P)return this;!Oe.touchNative&&Oe.pointer&&d.indexOf("touch")===0?gl(a,d,P):Oe.touch&&d==="dblclick"?us(a,P):"removeEventListener"in a?a.removeEventListener(di[d]||d,P,!1):a.detachEvent("on"+d,P),a[Vn][I]=null}function gt(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function wi(a){return Xn(a,"wheel",gt),this}function Ms(a){return Ge(a,"mousedown touchstart dblclick contextmenu",gt),a._leaflet_disable_click=!0,this}function Wt(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function Hi(a){return Wt(a),gt(a),this}function eo(a){if(a.composedPath)return a.composedPath();for(var d=[],v=a.target;v;)d.push(v),v=v.parentNode;return d}function fs(a,d){if(!d)return new we(a.clientX,a.clientY);var v=Qn(d),S=v.boundingClientRect;return new we((a.clientX-S.left)/v.x-d.clientLeft,(a.clientY-S.top)/v.y-d.clientTop)}var Gi=Oe.linux&&Oe.chrome?window.devicePixelRatio:Oe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function vn(a){return Oe.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/Gi:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function ji(a,d){var v=d.relatedTarget;if(!v)return!0;try{for(;v&&v!==a;)v=v.parentNode}catch{return!1}return v!==a}var ms={__proto__:null,on:Ge,off:At,stopPropagation:gt,disableScrollPropagation:wi,disableClickPropagation:Ms,preventDefault:Wt,stop:Hi,getPropagationPath:eo,getMousePosition:fs,getWheelDelta:vn,isExternalTarget:ji,addListener:Ge,removeListener:At},Ps=Ae.extend({run:function(a,d,v,S){this.stop(),this._el=a,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(S||.5,.2),this._startPos=ds(a),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(a){var d=+new Date-this._startTime,v=this._duration*1e3;d<v?this._runFrame(this._easeOut(d/v),a):(this._runFrame(1),this._complete())},_runFrame:function(a,d){var v=this._startPos.add(this._offset.multiplyBy(a));d&&v._round(),kt(this._el,v),this.fire("step")},_complete:function(){Y(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),at=Ae.extend({options:{crs:Ft,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,d){d=G(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(Se(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=bs&&Oe.any3d&&!Oe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ge(this._proxy,dr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,d,v){if(d=d===void 0?this._zoom:this._limitZoom(d),a=this._limitCenter(Se(a),d,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=r({animate:v.animate},v.zoom),v.pan=r({animate:v.animate,duration:v.duration},v.pan));var S=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,d,v.zoom):this._tryAnimatedPan(a,v.pan);if(S)return clearTimeout(this._sizeTimer),this}return this._resetView(a,d,v.pan&&v.pan.noMoveStart),this},setZoom:function(a,d){return this._loaded?this.setView(this.getCenter(),a,{zoom:d}):(this._zoom=a,this)},zoomIn:function(a,d){return a=a||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,d)},zoomOut:function(a,d){return a=a||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,d)},setZoomAround:function(a,d,v){var S=this.getZoomScale(d),I=this.getSize().divideBy(2),P=a instanceof we?a:this.latLngToContainerPoint(a),q=P.subtract(I).multiplyBy(1-1/S),ee=this.containerPointToLatLng(I.add(q));return this.setView(ee,d,{zoom:v})},_getBoundsCenterZoom:function(a,d){d=d||{},a=a.getBounds?a.getBounds():ue(a);var v=Ne(d.paddingTopLeft||d.padding||[0,0]),S=Ne(d.paddingBottomRight||d.padding||[0,0]),I=this.getBoundsZoom(a,!1,v.add(S));if(I=typeof d.maxZoom=="number"?Math.min(d.maxZoom,I):I,I===1/0)return{center:a.getCenter(),zoom:I};var P=S.subtract(v).divideBy(2),q=this.project(a.getSouthWest(),I),ee=this.project(a.getNorthEast(),I),re=this.unproject(q.add(ee).divideBy(2).add(P),I);return{center:re,zoom:I}},fitBounds:function(a,d){if(a=ue(a),!a.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(a,d);return this.setView(v.center,v.zoom,d)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,d){return this.setView(a,this._zoom,{pan:d})},panBy:function(a,d){if(a=Ne(a).round(),d=d||{},!a.x&&!a.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ps,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){De(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,v,d.duration||.25,d.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,d,v){if(v=v||{},v.animate===!1||!Oe.any3d)return this.setView(a,d,v);this._stop();var S=this.project(this.getCenter()),I=this.project(a),P=this.getSize(),q=this._zoom;a=Se(a),d=d===void 0?q:d;var ee=Math.max(P.x,P.y),re=ee*this.getZoomScale(q,d),ye=I.distanceTo(S)||1,Re=1.42,Be=Re*Re;function ot(on){var Os=on?-1:1,Uo=on?re:ee,zu=re*re-ee*ee+Os*Be*Be*ye*ye,Ba=2*Uo*Be*ye,Fa=zu/Ba,co=Math.sqrt(Fa*Fa+1)-Fa,Us=co<1e-9?-18:Math.log(co);return Us}function Mn(on){return(Math.exp(on)-Math.exp(-on))/2}function un(on){return(Math.exp(on)+Math.exp(-on))/2}function mi(on){return Mn(on)/un(on)}var Ct=ot(0);function bt(on){return ee*(un(Ct)/un(Ct+Re*on))}function dt(on){return ee*(un(Ct)*mi(Ct+Re*on)-Mn(Ct))/Be}function lo(on){return 1-Math.pow(1-on,1.5)}var Ii=Date.now(),Nl=(ot(1)-Ct)/Re,uo=v.duration?1e3*v.duration:1e3*Nl*.8;function Uu(){var on=(Date.now()-Ii)/uo,Os=lo(on)*Nl;on<=1?(this._flyToFrame=F(Uu,this),this._move(this.unproject(S.add(I.subtract(S).multiplyBy(dt(Os)/ye)),q),this.getScaleZoom(ee/bt(Os),q),{flyTo:!0})):this._move(a,d)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),Uu.call(this),this},flyToBounds:function(a,d){var v=this._getBoundsCenterZoom(a,d);return this.flyTo(v.center,v.zoom,d)},setMaxBounds:function(a){return a=ue(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var d=this.options.minZoom;return this.options.minZoom=a,this._loaded&&d!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var d=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&d!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,d){this._enforcingBounds=!0;var v=this.getCenter(),S=this._limitCenter(v,this._zoom,ue(a));return v.equals(S)||this.panTo(S,d),this._enforcingBounds=!1,this},panInside:function(a,d){d=d||{};var v=Ne(d.paddingTopLeft||d.padding||[0,0]),S=Ne(d.paddingBottomRight||d.padding||[0,0]),I=this.project(this.getCenter()),P=this.project(a),q=this.getPixelBounds(),ee=he([q.min.add(v),q.max.subtract(S)]),re=ee.getSize();if(!ee.contains(P)){this._enforcingBounds=!0;var ye=P.subtract(ee.getCenter()),Re=ee.extend(P).getSize().subtract(re);I.x+=ye.x<0?-Re.x:Re.x,I.y+=ye.y<0?-Re.y:Re.y,this.panTo(this.unproject(I),d),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=r({animate:!1,pan:!0},a===!0?{animate:!0}:a);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),S=d.divideBy(2).round(),I=v.divideBy(2).round(),P=S.subtract(I);return!P.x&&!P.y?this:(a.animate&&a.pan?this.panBy(P):(a.pan&&this._rawPanBy(P),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=r({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=c(this._handleGeolocationResponse,this),v=c(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,v,a):navigator.geolocation.getCurrentPosition(d,v,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var d=a.code,v=a.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var d=a.coords.latitude,v=a.coords.longitude,S=new ge(d,v),I=S.toBounds(a.coords.accuracy*2),P=this._locateOptions;if(P.setView){var q=this.getBoundsZoom(I);this.setView(S,P.maxZoom?Math.min(q,P.maxZoom):q)}var ee={latlng:S,bounds:I,timestamp:a.timestamp};for(var re in a.coords)typeof a.coords[re]=="number"&&(ee[re]=a.coords[re]);this.fire("locationfound",ee)}},addHandler:function(a,d){if(!d)return this;var v=this[a]=new d(this);return this._handlers.push(v),this.options[a]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ct(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Y(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)ct(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,d){var v="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),S=lt("div",v,d||this._mapPane);return a&&(this._panes[a]=S),S},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),d=this.unproject(a.getBottomLeft()),v=this.unproject(a.getTopRight());return new Ce(d,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,d,v){a=ue(a),v=Ne(v||[0,0]);var S=this.getZoom()||0,I=this.getMinZoom(),P=this.getMaxZoom(),q=a.getNorthWest(),ee=a.getSouthEast(),re=this.getSize().subtract(v),ye=he(this.project(ee,S),this.project(q,S)).getSize(),Re=Oe.any3d?this.options.zoomSnap:1,Be=re.x/ye.x,ot=re.y/ye.y,Mn=d?Math.max(Be,ot):Math.min(Be,ot);return S=this.getScaleZoom(Mn,S),Re&&(S=Math.round(S/(Re/100))*(Re/100),S=d?Math.ceil(S/Re)*Re:Math.floor(S/Re)*Re),Math.max(I,Math.min(P,S))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new we(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,d){var v=this._getTopLeftPoint(a,d);return new j(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,d){var v=this.options.crs;return d=d===void 0?this._zoom:d,v.scale(a)/v.scale(d)},getScaleZoom:function(a,d){var v=this.options.crs;d=d===void 0?this._zoom:d;var S=v.zoom(a*v.scale(d));return isNaN(S)?1/0:S},project:function(a,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(Se(a),d)},unproject:function(a,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(Ne(a),d)},layerPointToLatLng:function(a){var d=Ne(a).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(a){var d=this.project(Se(a))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(Se(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(ue(a))},distance:function(a,d){return this.options.crs.distance(Se(a),Se(d))},containerPointToLayerPoint:function(a){return Ne(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return Ne(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var d=this.containerPointToLayerPoint(Ne(a));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Se(a)))},mouseEventToContainerPoint:function(a){return fs(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var d=this._container=hr(a);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ge(d,"scroll",this._onScroll,this),this._containerId=g(d)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&Oe.any3d,De(a,"leaflet-container"+(Oe.touch?" leaflet-touch":"")+(Oe.retina?" leaflet-retina":"")+(Oe.ielt9?" leaflet-oldie":"")+(Oe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=Ws(a,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),kt(this._mapPane,new we(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(De(a.markerPane,"leaflet-zoom-hide"),De(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,d,v){kt(this._mapPane,new we(0,0));var S=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var I=this._zoom!==d;this._moveStart(I,v)._move(a,d)._moveEnd(I),this.fire("viewreset"),S&&this.fire("load")},_moveStart:function(a,d){return a&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(a,d,v,S){d===void 0&&(d=this._zoom);var I=this._zoom!==d;return this._zoom=d,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),S?v&&v.pinch&&this.fire("zoom",v):((I||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Y(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){kt(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[g(this._container)]=this;var d=a?At:Ge;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),Oe.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Y(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,d){for(var v=[],S,I=d==="mouseout"||d==="mouseover",P=a.target||a.srcElement,q=!1;P;){if(S=this._targets[g(P)],S&&(d==="click"||d==="preclick")&&this._draggableMoved(S)){q=!0;break}if(S&&S.listens(d,!0)&&(I&&!ji(P,a)||(v.push(S),I))||P===this._container)break;P=P.parentNode}return!v.length&&!q&&!I&&this.listens(d,!0)&&(v=[this]),v},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var d=a.target||a.srcElement;if(!(!this._loaded||d._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(d))){var v=a.type;v==="mousedown"&&Xs(d),this._fireDOMEvent(a,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,d,v){if(a.type==="click"){var S=r({},a);S.type="preclick",this._fireDOMEvent(S,S.type,v)}var I=this._findEventTargets(a,d);if(v){for(var P=[],q=0;q<v.length;q++)v[q].listens(d,!0)&&P.push(v[q]);I=P.concat(I)}if(I.length){d==="contextmenu"&&Wt(a);var ee=I[0],re={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var ye=ee.getLatLng&&(!ee._radius||ee._radius<=10);re.containerPoint=ye?this.latLngToContainerPoint(ee.getLatLng()):this.mouseEventToContainerPoint(a),re.layerPoint=this.containerPointToLayerPoint(re.containerPoint),re.latlng=ye?ee.getLatLng():this.layerPointToLatLng(re.layerPoint)}for(q=0;q<I.length;q++)if(I[q].fire(d,re,!0),re.originalEvent._stopped||I[q].options.bubblingMouseEvents===!1&&me(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,d=this._handlers.length;a<d;a++)this._handlers[a].disable()},whenReady:function(a,d){return this._loaded?a.call(d||this,{target:this}):this.on("load",a,d),this},_getMapPanePos:function(){return ds(this._mapPane)||new we(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,d){var v=a&&d!==void 0?this._getNewPixelOrigin(a,d):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,d){var v=this.getSize()._divideBy(2);return this.project(a,d)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,d,v){var S=this._getNewPixelOrigin(v,d);return this.project(a,d)._subtract(S)},_latLngBoundsToNewLayerBounds:function(a,d,v){var S=this._getNewPixelOrigin(v,d);return he([this.project(a.getSouthWest(),d)._subtract(S),this.project(a.getNorthWest(),d)._subtract(S),this.project(a.getSouthEast(),d)._subtract(S),this.project(a.getNorthEast(),d)._subtract(S)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,d,v){if(!v)return a;var S=this.project(a,d),I=this.getSize().divideBy(2),P=new j(S.subtract(I),S.add(I)),q=this._getBoundsOffset(P,v,d);return Math.abs(q.x)<=1&&Math.abs(q.y)<=1?a:this.unproject(S.add(q),d)},_limitOffset:function(a,d){if(!d)return a;var v=this.getPixelBounds(),S=new j(v.min.add(a),v.max.add(a));return a.add(this._getBoundsOffset(S,d))},_getBoundsOffset:function(a,d,v){var S=he(this.project(d.getNorthEast(),v),this.project(d.getSouthWest(),v)),I=S.min.subtract(a.min),P=S.max.subtract(a.max),q=this._rebound(I.x,-P.x),ee=this._rebound(I.y,-P.y);return new we(q,ee)},_rebound:function(a,d){return a+d>0?Math.round(a-d)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(d))},_limitZoom:function(a){var d=this.getMinZoom(),v=this.getMaxZoom(),S=Oe.any3d?this.options.zoomSnap:1;return S&&(a=Math.round(a/S)*S),Math.max(d,Math.min(v,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Dt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,d){var v=this._getCenterOffset(a)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,d),!0)},_createAnimProxy:function(){var a=this._proxy=lt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(d){var v=Ti,S=this._proxy.style[v];qi(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),S===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ct(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),d=this.getZoom();qi(this._proxy,this.project(a,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,d,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var S=this.getZoomScale(d),I=this._getCenterOffset(a)._divideBy(1-1/S);return v.animate!==!0&&!this.getSize().contains(I)?!1:(F(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(a,d,!0)},this),!0)},_animateZoom:function(a,d,v,S){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=d,De(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:d,noUpdate:S}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Dt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function to(a,d){return new at(a,d)}var On=Ke.extend({options:{position:"topright"},initialize:function(a){G(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var d=this._map;return d&&d.removeControl(this),this.options.position=a,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var d=this._container=this.onAdd(a),v=this.getPosition(),S=a._controlCorners[v];return De(d,"leaflet-control"),v.indexOf("bottom")!==-1?S.insertBefore(d,S.firstChild):S.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ct(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),$n=function(a){return new On(a)};at.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},d="leaflet-",v=this._controlContainer=lt("div",d+"control-container",this._container);function S(I,P){var q=d+I+" "+d+P;a[I+P]=lt("div",q,v)}S("top","left"),S("top","right"),S("bottom","left"),S("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)ct(this._controlCorners[a]);ct(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Po=On.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,d,v,S){return v<S?-1:S<v?1:0}},initialize:function(a,d,v){G(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var S in a)this._addLayer(a[S],S);for(S in d)this._addLayer(d[S],S,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return On.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,d){return this._addLayer(a,d),this._map?this._update():this},addOverlay:function(a,d){return this._addLayer(a,d,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var d=this._getLayer(g(a));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){De(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(De(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):Dt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Dt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",d=this._container=lt("div",a),v=this.options.collapsed;d.setAttribute("aria-haspopup",!0),Ms(d),wi(d);var S=this._section=lt("section",a+"-list");v&&(this._map.on("click",this.collapse,this),Ge(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var I=this._layersLink=lt("a",a+"-toggle",d);I.href="#",I.title="Layers",I.setAttribute("role","button"),Ge(I,{keydown:function(P){P.keyCode===13&&this._expandSafely()},click:function(P){Wt(P),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=lt("div",a+"-base",S),this._separator=lt("div",a+"-separator",S),this._overlaysList=lt("div",a+"-overlays",S),d.appendChild(S)},_getLayer:function(a){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&g(this._layers[d].layer)===a)return this._layers[d]},_addLayer:function(a,d,v){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:d,overlay:v}),this.options.sortLayers&&this._layers.sort(c(function(S,I){return this.options.sortFunction(S.layer,I.layer,S.name,I.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Yt(this._baseLayersList),Yt(this._overlaysList),this._layerControlInputs=[];var a,d,v,S,I=0;for(v=0;v<this._layers.length;v++)S=this._layers[v],this._addItem(S),d=d||S.overlay,a=a||!S.overlay,I+=S.overlay?0:1;return this.options.hideSingleBase&&(a=a&&I>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=d&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var d=this._getLayer(g(a.target)),v=d.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;v&&this._map.fire(v,d)},_createRadioElement:function(a,d){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(d?' checked="checked"':"")+"/>",S=document.createElement("div");return S.innerHTML=v,S.firstChild},_addItem:function(a){var d=document.createElement("label"),v=this._map.hasLayer(a.layer),S;a.overlay?(S=document.createElement("input"),S.type="checkbox",S.className="leaflet-control-layers-selector",S.defaultChecked=v):S=this._createRadioElement("leaflet-base-layers_"+g(this),v),this._layerControlInputs.push(S),S.layerId=g(a.layer),Ge(S,"click",this._onInputClick,this);var I=document.createElement("span");I.innerHTML=" "+a.name;var P=document.createElement("span");d.appendChild(P),P.appendChild(S),P.appendChild(I);var q=a.overlay?this._overlaysList:this._baseLayersList;return q.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,d,v,S=[],I=[];this._handlingClick=!0;for(var P=a.length-1;P>=0;P--)d=a[P],v=this._getLayer(d.layerId).layer,d.checked?S.push(v):d.checked||I.push(v);for(P=0;P<I.length;P++)this._map.hasLayer(I[P])&&this._map.removeLayer(I[P]);for(P=0;P<S.length;P++)this._map.hasLayer(S[P])||this._map.addLayer(S[P]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,d,v,S=this._map.getZoom(),I=a.length-1;I>=0;I--)d=a[I],v=this._getLayer(d.layerId).layer,d.disabled=v.options.minZoom!==void 0&&S<v.options.minZoom||v.options.maxZoom!==void 0&&S>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,Ge(a,"click",Wt),this.expand();var d=this;setTimeout(function(){At(a,"click",Wt),d._preventClick=!1})}}),Ea=function(a,d,v){return new Po(a,d,v)},Ds=On.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var d="leaflet-control-zoom",v=lt("div",d+" leaflet-bar"),S=this.options;return this._zoomInButton=this._createButton(S.zoomInText,S.zoomInTitle,d+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(S.zoomOutText,S.zoomOutTitle,d+"-out",v,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,d,v,S,I){var P=lt("a",v,S);return P.innerHTML=a,P.href="#",P.title=d,P.setAttribute("role","button"),P.setAttribute("aria-label",d),Ms(P),Ge(P,"click",Hi),Ge(P,"click",I,this),Ge(P,"click",this._refocusOnMap,this),P},_updateDisabled:function(){var a=this._map,d="leaflet-disabled";Dt(this._zoomInButton,d),Dt(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(De(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(De(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});at.mergeOptions({zoomControl:!0}),at.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ds,this.addControl(this.zoomControl))});var _l=function(a){return new Ds(a)},xa=On.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var d="leaflet-control-scale",v=lt("div",d),S=this.options;return this._addScales(S,d+"-line",v),a.on(S.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),v},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,d,v){a.metric&&(this._mScale=lt("div",d,v)),a.imperial&&(this._iScale=lt("div",d,v))},_update:function(){var a=this._map,d=a.getSize().y/2,v=a.distance(a.containerPointToLatLng([0,d]),a.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(v)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var d=this._getRoundNum(a),v=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,v,d/a)},_updateImperial:function(a){var d=a*3.2808399,v,S,I;d>5280?(v=d/5280,S=this._getRoundNum(v),this._updateScale(this._iScale,S+" mi",S/v)):(I=this._getRoundNum(d),this._updateScale(this._iScale,I+" ft",I/d))},_updateScale:function(a,d,v){a.style.width=Math.round(this.options.maxWidth*v)+"px",a.innerHTML=d},_getRoundNum:function(a){var d=Math.pow(10,(Math.floor(a)+"").length-1),v=a/d;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,d*v}}),Do=function(a){return new xa(a)},wa='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',gr=On.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Oe.inlineSvg?wa+" ":"")+"Leaflet</a>"},initialize:function(a){G(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=lt("div","leaflet-control-attribution"),Ms(this._container);for(var d in a._layers)a._layers[d].getAttribution&&this.addAttribution(a._layers[d].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var d in this._attributions)this._attributions[d]&&a.push(d);var v=[];this.options.prefix&&v.push(this.options.prefix),a.length&&v.push(a.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});at.mergeOptions({attributionControl:!0}),at.addInitHook(function(){this.options.attributionControl&&new gr().addTo(this)});var _r=function(a){return new gr(a)};On.Layers=Po,On.Zoom=Ds,On.Scale=xa,On.Attribution=gr,$n.layers=Ea,$n.zoom=_l,$n.scale=Do,$n.attribution=_r;var hi=Ke.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});hi.addTo=function(a,d){return a.addHandler(d,this),this};var yl={Events:oe},Zi=Oe.touch?"touchstart mousedown":"mousedown",Ki=Ae.extend({options:{clickTolerance:3},initialize:function(a,d,v,S){G(this,S),this._element=a,this._dragStartTarget=d||a,this._preventOutline=v},enable:function(){this._enabled||(Ge(this._dragStartTarget,Zi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ki._dragging===this&&this.finishDrag(!0),At(this._dragStartTarget,Zi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!Io(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){Ki._dragging===this&&this.finishDrag();return}if(!(Ki._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(Ki._dragging=this,this._preventOutline&&Xs(this._element),Ro(),xi(),!this._moving)){this.fire("down");var d=a.touches?a.touches[0]:a,v=pr(this._element);this._startPoint=new we(d.clientX,d.clientY),this._startPos=ds(this._element),this._parentScale=Qn(v);var S=a.type==="mousedown";Ge(document,S?"mousemove":"touchmove",this._onMove,this),Ge(document,S?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var d=a.touches&&a.touches.length===1?a.touches[0]:a,v=new we(d.clientX,d.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,Wt(a),this._moved||(this.fire("dragstart"),this._moved=!0,De(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),De(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),kt(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){Dt(document.body,"leaflet-dragging"),this._lastTarget&&(Dt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),At(document,"mousemove touchmove",this._onMove,this),At(document,"mouseup touchend touchcancel",this._onUp,this),Qs(),yn();var d=this._moved&&this._moving;this._moving=!1,Ki._dragging=!1,d&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function Sa(a,d,v){var S,I=[1,4,2,8],P,q,ee,re,ye,Re,Be,ot;for(P=0,Re=a.length;P<Re;P++)a[P]._code=le(a[P],d);for(ee=0;ee<4;ee++){for(Be=I[ee],S=[],P=0,Re=a.length,q=Re-1;P<Re;q=P++)re=a[P],ye=a[q],re._code&Be?ye._code&Be||(ot=ne(ye,re,Be,d,v),ot._code=le(ot,d),S.push(ot)):(ye._code&Be&&(ot=ne(ye,re,Be,d,v),ot._code=le(ot,d),S.push(ot)),S.push(re));a=S}return a}function Aa(a,d){var v,S,I,P,q,ee,re,ye,Re;if(!a||a.length===0)throw new Error("latlngs not passed");xt(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var Be=Se([0,0]),ot=ue(a),Mn=ot.getNorthWest().distanceTo(ot.getSouthWest())*ot.getNorthEast().distanceTo(ot.getNorthWest());Mn<1700&&(Be=yr(a));var un=a.length,mi=[];for(v=0;v<un;v++){var Ct=Se(a[v]);mi.push(d.project(Se([Ct.lat-Be.lat,Ct.lng-Be.lng])))}for(ee=re=ye=0,v=0,S=un-1;v<un;S=v++)I=mi[v],P=mi[S],q=I.y*P.x-P.y*I.x,re+=(I.x+P.x)*q,ye+=(I.y+P.y)*q,ee+=q*3;ee===0?Re=mi[0]:Re=[re/ee,ye/ee];var bt=d.unproject(Ne(Re));return Se([bt.lat+Be.lat,bt.lng+Be.lng])}function yr(a){for(var d=0,v=0,S=0,I=0;I<a.length;I++){var P=Se(a[I]);d+=P.lat,v+=P.lng,S++}return Se([d/S,v/S])}var no={__proto__:null,clipPolygon:Sa,polygonCenter:Aa,centroid:yr};function Un(a,d){if(!d||!a.length)return a.slice();var v=d*d;return a=C(a,v),a=ks(a,v),a}function Ca(a,d,v){return Math.sqrt(Je(a,d,v,!0))}function vl(a,d,v){return Je(a,d,v)}function ks(a,d){var v=a.length,S=typeof Uint8Array<"u"?Uint8Array:Array,I=new S(v);I[0]=I[v-1]=1,y(a,I,d,0,v-1);var P,q=[];for(P=0;P<v;P++)I[P]&&q.push(a[P]);return q}function y(a,d,v,S,I){var P=0,q,ee,re;for(ee=S+1;ee<=I-1;ee++)re=Je(a[ee],a[S],a[I],!0),re>P&&(q=ee,P=re);P>v&&(d[q]=1,y(a,d,v,S,q),y(a,d,v,q,I))}function C(a,d){for(var v=[a[0]],S=1,I=0,P=a.length;S<P;S++)Ie(a[S],a[I])>d&&(v.push(a[S]),I=S);return I<P-1&&v.push(a[P-1]),v}var R;function k(a,d,v,S,I){var P=S?R:le(a,v),q=le(d,v),ee,re,ye;for(R=q;;){if(!(P|q))return[a,d];if(P&q)return!1;ee=P||q,re=ne(a,d,ee,v,I),ye=le(re,v),ee===P?(a=re,P=ye):(d=re,q=ye)}}function ne(a,d,v,S,I){var P=d.x-a.x,q=d.y-a.y,ee=S.min,re=S.max,ye,Re;return v&8?(ye=a.x+P*(re.y-a.y)/q,Re=re.y):v&4?(ye=a.x+P*(ee.y-a.y)/q,Re=ee.y):v&2?(ye=re.x,Re=a.y+q*(re.x-a.x)/P):v&1&&(ye=ee.x,Re=a.y+q*(ee.x-a.x)/P),new we(ye,Re,I)}function le(a,d){var v=0;return a.x<d.min.x?v|=1:a.x>d.max.x&&(v|=2),a.y<d.min.y?v|=4:a.y>d.max.y&&(v|=8),v}function Ie(a,d){var v=d.x-a.x,S=d.y-a.y;return v*v+S*S}function Je(a,d,v,S){var I=d.x,P=d.y,q=v.x-I,ee=v.y-P,re=q*q+ee*ee,ye;return re>0&&(ye=((a.x-I)*q+(a.y-P)*ee)/re,ye>1?(I=v.x,P=v.y):ye>0&&(I+=q*ye,P+=ee*ye)),q=a.x-I,ee=a.y-P,S?q*q+ee*ee:new we(I,P)}function xt(a){return!Q(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function wt(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),xt(a)}function Ht(a,d){var v,S,I,P,q,ee,re,ye;if(!a||a.length===0)throw new Error("latlngs not passed");xt(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var Re=Se([0,0]),Be=ue(a),ot=Be.getNorthWest().distanceTo(Be.getSouthWest())*Be.getNorthEast().distanceTo(Be.getNorthWest());ot<1700&&(Re=yr(a));var Mn=a.length,un=[];for(v=0;v<Mn;v++){var mi=Se(a[v]);un.push(d.project(Se([mi.lat-Re.lat,mi.lng-Re.lng])))}for(v=0,S=0;v<Mn-1;v++)S+=un[v].distanceTo(un[v+1])/2;if(S===0)ye=un[0];else for(v=0,P=0;v<Mn-1;v++)if(q=un[v],ee=un[v+1],I=q.distanceTo(ee),P+=I,P>S){re=(P-S)/I,ye=[ee.x-re*(ee.x-q.x),ee.y-re*(ee.y-q.y)];break}var Ct=d.unproject(Ne(ye));return Se([Ct.lat+Re.lat,Ct.lng+Re.lng])}var Si={__proto__:null,simplify:Un,pointToSegmentDistance:Ca,closestPointOnSegment:vl,clipSegment:k,_getEdgeIntersection:ne,_getBitCode:le,_sqClosestPointOnSegment:Je,isFlat:xt,_flat:wt,polylineCenter:Ht},Ai={project:function(a){return new we(a.lng,a.lat)},unproject:function(a){return new ge(a.y,a.x)},bounds:new j([-180,-90],[180,90])},fi={R:6378137,R_MINOR:6356752314245179e-9,bounds:new j([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var d=Math.PI/180,v=this.R,S=a.lat*d,I=this.R_MINOR/v,P=Math.sqrt(1-I*I),q=P*Math.sin(S),ee=Math.tan(Math.PI/4-S/2)/Math.pow((1-q)/(1+q),P/2);return S=-v*Math.log(Math.max(ee,1e-10)),new we(a.lng*d*v,S)},unproject:function(a){for(var d=180/Math.PI,v=this.R,S=this.R_MINOR/v,I=Math.sqrt(1-S*S),P=Math.exp(-a.y/v),q=Math.PI/2-2*Math.atan(P),ee=0,re=.1,ye;ee<15&&Math.abs(re)>1e-7;ee++)ye=I*Math.sin(q),ye=Math.pow((1-ye)/(1+ye),I/2),re=Math.PI/2-2*Math.atan(P*ye)-q,q+=re;return new ge(q*d,a.x*d/v)}},Yi={__proto__:null,LonLat:Ai,Mercator:fi,SphericalMercator:it},ko=r({},Me,{code:"EPSG:3395",projection:fi,transformation:(function(){var a=.5/(Math.PI*fi.R);return je(a,.5,-a,.5)})()}),Lo=r({},Me,{code:"EPSG:4326",projection:Ai,transformation:je(1/180,1,-1/180,.5)}),vr=r({},be,{projection:Ai,transformation:je(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,d){var v=d.lng-a.lng,S=d.lat-a.lat;return Math.sqrt(v*v+S*S)},infinite:!0});be.Earth=Me,be.EPSG3395=ko,be.EPSG3857=Ft,be.EPSG900913=gn,be.EPSG4326=Lo,be.Simple=vr;var Ji=Ae.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[g(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[g(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var d=a.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var v=this.getEvents();d.on(v,this),this.once("remove",function(){d.off(v,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});at.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var d=g(a);return this._layers[d]?this:(this._layers[d]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var d=g(a);return this._layers[d]?(this._loaded&&a.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return g(a)in this._layers},eachLayer:function(a,d){for(var v in this._layers)a.call(d,this._layers[v]);return this},_addLayers:function(a){a=a?Q(a)?a:[a]:[];for(var d=0,v=a.length;d<v;d++)this.addLayer(a[d])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[g(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var d=g(a);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,d=-1/0,v=this._getZoomSpan();for(var S in this._zoomBoundLayers){var I=this._zoomBoundLayers[S].options;a=I.minZoom===void 0?a:Math.min(a,I.minZoom),d=I.maxZoom===void 0?d:Math.max(d,I.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=a===1/0?void 0:a,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Tr=Ji.extend({initialize:function(a,d){G(this,d),this._layers={};var v,S;if(a)for(v=0,S=a.length;v<S;v++)this.addLayer(a[v])},addLayer:function(a){var d=this.getLayerId(a);return this._layers[d]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var d=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(a){var d=typeof a=="number"?a:this.getLayerId(a);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var d=Array.prototype.slice.call(arguments,1),v,S;for(v in this._layers)S=this._layers[v],S[a]&&S[a].apply(S,d);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,d){for(var v in this._layers)a.call(d,this._layers[v]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return g(a)}}),Cf=function(a,d){return new Tr(a,d)},ps=Tr.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),Tr.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),Tr.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new Ce;for(var d in this._layers){var v=this._layers[d];a.extend(v.getBounds?v.getBounds():v.getLatLng())}return a}}),$c=function(a,d){return new ps(a,d)},gs=Ke.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){G(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,d){var v=this._getIconUrl(a);if(!v){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var S=this._createImg(v,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(S,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),S},_setIconStyles:function(a,d){var v=this.options,S=v[d+"Size"];typeof S=="number"&&(S=[S,S]);var I=Ne(S),P=Ne(d==="shadow"&&v.shadowAnchor||v.iconAnchor||I&&I.divideBy(2,!0));a.className="leaflet-marker-"+d+" "+(v.className||""),P&&(a.style.marginLeft=-P.x+"px",a.style.marginTop=-P.y+"px"),I&&(a.style.width=I.x+"px",a.style.height=I.y+"px")},_createImg:function(a,d){return d=d||document.createElement("img"),d.src=a,d},_getIconUrl:function(a){return Oe.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function ba(a){return new gs(a)}var Ia=gs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof Ia.imagePath!="string"&&(Ia.imagePath=this._detectIconPath()),(this.options.imagePath||Ia.imagePath)+gs.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var d=function(v,S,I){var P=S.exec(v);return P&&P[I]};return a=d(a,/^url\((['"])?(.+)\1\)$/,2),a&&d(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=lt("div","leaflet-default-icon-path",document.body),d=Ws(a,"background-image")||Ws(a,"backgroundImage");if(document.body.removeChild(a),d=this._stripUrl(d),d)return d;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),Na=hi.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Ki(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),De(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Dt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var d=this._marker,v=d._map,S=this._marker.options.autoPanSpeed,I=this._marker.options.autoPanPadding,P=ds(d._icon),q=v.getPixelBounds(),ee=v.getPixelOrigin(),re=he(q.min._subtract(ee).add(I),q.max._subtract(ee).subtract(I));if(!re.contains(P)){var ye=Ne((Math.max(re.max.x,P.x)-re.max.x)/(q.max.x-re.max.x)-(Math.min(re.min.x,P.x)-re.min.x)/(q.min.x-re.min.x),(Math.max(re.max.y,P.y)-re.max.y)/(q.max.y-re.max.y)-(Math.min(re.min.y,P.y)-re.min.y)/(q.min.y-re.min.y)).multiplyBy(S);v.panBy(ye,{animate:!1}),this._draggable._newPos._add(ye),this._draggable._startPos._add(ye),kt(d._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=F(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(Y(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,a)))},_onDrag:function(a){var d=this._marker,v=d._shadow,S=ds(d._icon),I=d._map.layerPointToLatLng(S);v&&kt(v,S),d._latlng=I,a.latlng=I,a.oldLatLng=this._oldLatLng,d.fire("move",a).fire("drag",a)},_onDragEnd:function(a){Y(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),Ra=Ji.extend({options:{icon:new Ia,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,d){G(this,d),this._latlng=Se(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var d=this._latlng;return this._latlng=Se(a),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=a.icon.createIcon(this._icon),S=!1;v!==this._icon&&(this._icon&&this._removeIcon(),S=!0,a.title&&(v.title=a.title),v.tagName==="IMG"&&(v.alt=a.alt||"")),De(v,d),a.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ge(v,"focus",this._panOnFocus,this);var I=a.icon.createShadow(this._shadow),P=!1;I!==this._shadow&&(this._removeShadow(),P=!0),I&&(De(I,d),I.alt=""),this._shadow=I,a.opacity<1&&this._updateOpacity(),S&&this.getPane().appendChild(this._icon),this._initInteraction(),I&&P&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&At(this._icon,"focus",this._panOnFocus,this),ct(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ct(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&kt(this._icon,a),this._shadow&&kt(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(De(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Na)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Na(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&qt(this._icon,a),this._shadow&&qt(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var d=this.options.icon.options,v=d.iconSize?Ne(d.iconSize):Ne(0,0),S=d.iconAnchor?Ne(d.iconAnchor):Ne(0,0);a.panInside(this._latlng,{paddingTopLeft:S,paddingBottomRight:v.subtract(S)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function ed(a,d){return new Ra(a,d)}var _s=Ji.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return G(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Er=_s.extend({options:{fill:!0,radius:10},initialize:function(a,d){G(this,d),this._latlng=Se(a),this._radius=this.options.radius},setLatLng:function(a){var d=this._latlng;return this._latlng=Se(a),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var d=a&&a.radius||this._radius;return _s.prototype.setStyle.call(this,a),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,d=this._radiusY||a,v=this._clickTolerance(),S=[a+v,d+v];this._pxBounds=new j(this._point.subtract(S),this._point.add(S))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function td(a,d){return new Er(a,d)}var Tl=Er.extend({initialize:function(a,d,v){if(typeof d=="number"&&(d=r({},v,{radius:d})),G(this,d),this._latlng=Se(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new Ce(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:_s.prototype.setStyle,_project:function(){var a=this._latlng.lng,d=this._latlng.lat,v=this._map,S=v.options.crs;if(S.distance===Me.distance){var I=Math.PI/180,P=this._mRadius/Me.R/I,q=v.project([d+P,a]),ee=v.project([d-P,a]),re=q.add(ee).divideBy(2),ye=v.unproject(re).lat,Re=Math.acos((Math.cos(P*I)-Math.sin(d*I)*Math.sin(ye*I))/(Math.cos(d*I)*Math.cos(ye*I)))/I;(isNaN(Re)||Re===0)&&(Re=P/Math.cos(Math.PI/180*d)),this._point=re.subtract(v.getPixelOrigin()),this._radius=isNaN(Re)?0:re.x-v.project([ye,a-Re]).x,this._radiusY=re.y-q.y}else{var Be=S.unproject(S.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(Be).x}this._updateBounds()}});function nd(a,d,v){return new Tl(a,d,v)}var Ls=_s.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,d){G(this,d),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var d=1/0,v=null,S=Je,I,P,q=0,ee=this._parts.length;q<ee;q++)for(var re=this._parts[q],ye=1,Re=re.length;ye<Re;ye++){I=re[ye-1],P=re[ye];var Be=S(a,I,P,!0);Be<d&&(d=Be,v=S(a,I,P))}return v&&(v.distance=Math.sqrt(d)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ht(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,d){return d=d||this._defaultShape(),a=Se(a),d.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new Ce,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return xt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var d=[],v=xt(a),S=0,I=a.length;S<I;S++)v?(d[S]=Se(a[S]),this._bounds.extend(d[S])):d[S]=this._convertLatLngs(a[S]);return d},_project:function(){var a=new j;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),d=new we(a,a);this._rawPxBounds&&(this._pxBounds=new j([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(a,d,v){var S=a[0]instanceof ge,I=a.length,P,q;if(S){for(q=[],P=0;P<I;P++)q[P]=this._map.latLngToLayerPoint(a[P]),v.extend(q[P]);d.push(q)}else for(P=0;P<I;P++)this._projectLatlngs(a[P],d,v)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,v,S,I,P,q,ee,re;for(v=0,I=0,P=this._rings.length;v<P;v++)for(re=this._rings[v],S=0,q=re.length;S<q-1;S++)ee=k(re[S],re[S+1],a,S,!0),ee&&(d[I]=d[I]||[],d[I].push(ee[0]),(ee[1]!==re[S+1]||S===q-2)&&(d[I].push(ee[1]),I++))}},_simplifyPoints:function(){for(var a=this._parts,d=this.options.smoothFactor,v=0,S=a.length;v<S;v++)a[v]=Un(a[v],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,d){var v,S,I,P,q,ee,re=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(v=0,P=this._parts.length;v<P;v++)for(ee=this._parts[v],S=0,q=ee.length,I=q-1;S<q;I=S++)if(!(!d&&S===0)&&Ca(a,ee[I],ee[S])<=re)return!0;return!1}});function bf(a,d){return new Ls(a,d)}Ls._flat=wt;var xr=Ls.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Aa(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var d=Ls.prototype._convertLatLngs.call(this,a),v=d.length;return v>=2&&d[0]instanceof ge&&d[0].equals(d[v-1])&&d.pop(),d},_setLatLngs:function(a){Ls.prototype._setLatLngs.call(this,a),xt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return xt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,d=this.options.weight,v=new we(d,d);if(a=new j(a.min.subtract(v),a.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var S=0,I=this._rings.length,P;S<I;S++)P=Sa(this._rings[S],a,!0),P.length&&this._parts.push(P)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var d=!1,v,S,I,P,q,ee,re,ye;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(P=0,re=this._parts.length;P<re;P++)for(v=this._parts[P],q=0,ye=v.length,ee=ye-1;q<ye;ee=q++)S=v[q],I=v[ee],S.y>a.y!=I.y>a.y&&a.x<(I.x-S.x)*(a.y-S.y)/(I.y-S.y)+S.x&&(d=!d);return d||Ls.prototype._containsPoint.call(this,a,!0)}});function If(a,d){return new xr(a,d)}var Vs=ps.extend({initialize:function(a,d){G(this,d),this._layers={},a&&this.addData(a)},addData:function(a){var d=Q(a)?a:a.features,v,S,I;if(d){for(v=0,S=d.length;v<S;v++)I=d[v],(I.geometries||I.geometry||I.features||I.coordinates)&&this.addData(I);return this}var P=this.options;if(P.filter&&!P.filter(a))return this;var q=zn(a,P);return q?(q.feature=wl(a),q.defaultOptions=q.options,this.resetStyle(q),P.onEachFeature&&P.onEachFeature(a,q),this.addLayer(q)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=r({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(d){this._setLayerStyle(d,a)},this)},_setLayerStyle:function(a,d){a.setStyle&&(typeof d=="function"&&(d=d(a.feature)),a.setStyle(d))}});function zn(a,d){var v=a.type==="Feature"?a.geometry:a,S=v?v.coordinates:null,I=[],P=d&&d.pointToLayer,q=d&&d.coordsToLatLng||El,ee,re,ye,Re;if(!S&&!v)return null;switch(v.type){case"Point":return ee=q(S),wr(P,a,ee,d);case"MultiPoint":for(ye=0,Re=S.length;ye<Re;ye++)ee=q(S[ye]),I.push(wr(P,a,ee,d));return new ps(I);case"LineString":case"MultiLineString":return re=Ma(S,v.type==="LineString"?0:1,q),new Ls(re,d);case"Polygon":case"MultiPolygon":return re=Ma(S,v.type==="Polygon"?1:2,q),new xr(re,d);case"GeometryCollection":for(ye=0,Re=v.geometries.length;ye<Re;ye++){var Be=zn({geometry:v.geometries[ye],type:"Feature",properties:a.properties},d);Be&&I.push(Be)}return new ps(I);case"FeatureCollection":for(ye=0,Re=v.features.length;ye<Re;ye++){var ot=zn(v.features[ye],d);ot&&I.push(ot)}return new ps(I);default:throw new Error("Invalid GeoJSON object.")}}function wr(a,d,v,S){return a?a(d,v):new Ra(v,S&&S.markersInheritOptions&&S)}function El(a){return new ge(a[1],a[0],a[2])}function Ma(a,d,v){for(var S=[],I=0,P=a.length,q;I<P;I++)q=d?Ma(a[I],d-1,v):(v||El)(a[I]),S.push(q);return S}function xl(a,d){return a=Se(a),a.alt!==void 0?[b(a.lng,d),b(a.lat,d),b(a.alt,d)]:[b(a.lng,d),b(a.lat,d)]}function Pa(a,d,v,S){for(var I=[],P=0,q=a.length;P<q;P++)I.push(d?Pa(a[P],xt(a[P])?0:d-1,v,S):xl(a[P],S));return!d&&v&&I.length>0&&I.push(I[0].slice()),I}function io(a,d){return a.feature?r({},a.feature,{geometry:d}):wl(d)}function wl(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var so={toGeoJSON:function(a){return io(this,{type:"Point",coordinates:xl(this.getLatLng(),a)})}};Ra.include(so),Tl.include(so),Er.include(so),Ls.include({toGeoJSON:function(a){var d=!xt(this._latlngs),v=Pa(this._latlngs,d?1:0,!1,a);return io(this,{type:(d?"Multi":"")+"LineString",coordinates:v})}}),xr.include({toGeoJSON:function(a){var d=!xt(this._latlngs),v=d&&!xt(this._latlngs[0]),S=Pa(this._latlngs,v?2:d?1:0,!0,a);return d||(S=[S]),io(this,{type:(v?"Multi":"")+"Polygon",coordinates:S})}}),Tr.include({toMultiPoint:function(a){var d=[];return this.eachLayer(function(v){d.push(v.toGeoJSON(a).geometry.coordinates)}),io(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(a){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(a);var v=d==="GeometryCollection",S=[];return this.eachLayer(function(I){if(I.toGeoJSON){var P=I.toGeoJSON(a);if(v)S.push(P.geometry);else{var q=wl(P);q.type==="FeatureCollection"?S.push.apply(S,q.features):S.push(q)}}}),v?io(this,{geometries:S,type:"GeometryCollection"}):{type:"FeatureCollection",features:S}}});function Sl(a,d){return new Vs(a,d)}var Da=Sl,Sr=Ji.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,d,v){this._url=a,this._bounds=ue(d),G(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(De(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ct(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&Jt(this._image),this},bringToBack:function(){return this._map&&ci(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=ue(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",d=this._image=a?this._url:lt("img");if(De(d,"leaflet-image-layer"),this._zoomAnimated&&De(d,"leaflet-zoom-animated"),this.options.className&&De(d,this.options.className),d.onselectstart=A,d.onmousemove=A,d.onload=c(this.fire,this,"load"),d.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(a){var d=this._map.getZoomScale(a.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;qi(this._image,v,d)},_reset:function(){var a=this._image,d=new j(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=d.getSize();kt(a,d.min),a.style.width=v.x+"px",a.style.height=v.y+"px"},_updateOpacity:function(){qt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),id=function(a,d,v){return new Sr(a,d,v)},oo=Sr.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",d=this._image=a?this._url:lt("video");if(De(d,"leaflet-image-layer"),this._zoomAnimated&&De(d,"leaflet-zoom-animated"),this.options.className&&De(d,this.options.className),d.onselectstart=A,d.onmousemove=A,d.onloadeddata=c(this.fire,this,"load"),a){for(var v=d.getElementsByTagName("source"),S=[],I=0;I<v.length;I++)S.push(v[I].src);this._url=v.length>0?S:[d.src];return}Q(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var P=0;P<this._url.length;P++){var q=lt("source");q.src=this._url[P],d.appendChild(q)}}});function Ar(a,d,v){return new oo(a,d,v)}var Al=Sr.extend({_initImage:function(){var a=this._image=this._url;De(a,"leaflet-image-layer"),this._zoomAnimated&&De(a,"leaflet-zoom-animated"),this.options.className&&De(a,this.options.className),a.onselectstart=A,a.onmousemove=A}});function sd(a,d,v){return new Al(a,d,v)}var Bn=Ji.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,d){a&&(a instanceof ge||Q(a))?(this._latlng=Se(a),G(this,d)):(G(this,a),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&qt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&qt(this._container,1),this.bringToFront(),this.options.interactive&&(De(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(qt(this._container,0),this._removeTimeout=setTimeout(c(ct,void 0,this._container),200)):ct(this._container),this.options.interactive&&(Dt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=Se(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Jt(this._container),this},bringToBack:function(){return this._map&&ci(this._container),this},_prepareOpen:function(a){var d=this._source;if(!d._map)return!1;if(d instanceof ps){d=null;var v=this._source._layers;for(var S in v)if(v[S]._map){d=v[S];break}if(!d)return!1;this._source=d}if(!a)if(d.getCenter)a=d.getCenter();else if(d.getLatLng)a=d.getLatLng();else if(d.getBounds)a=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")a.innerHTML=d;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),d=Ne(this.options.offset),v=this._getAnchor();this._zoomAnimated?kt(this._container,a.add(v)):d=d.add(a).add(v);var S=this._containerBottom=-d.y,I=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=S+"px",this._container.style.left=I+"px"}},_getAnchor:function(){return[0,0]}});at.include({_initOverlay:function(a,d,v,S){var I=d;return I instanceof a||(I=new a(S).setContent(d)),v&&I.setLatLng(v),I}}),Ji.include({_initOverlay:function(a,d,v,S){var I=v;return I instanceof a?(G(I,S),I._source=this):(I=d&&!S?d:new a(S,this),I.setContent(v)),I}});var ka=Bn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,Bn.prototype.openOn.call(this,a)},onAdd:function(a){Bn.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof _s||this._source.on("preclick",gt))},onRemove:function(a){Bn.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof _s||this._source.off("preclick",gt))},getEvents:function(){var a=Bn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",d=this._container=lt("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=lt("div",a+"-content-wrapper",d);if(this._contentNode=lt("div",a+"-content",v),Ms(d),wi(this._contentNode),Ge(d,"contextmenu",gt),this._tipContainer=lt("div",a+"-tip-container",d),this._tip=lt("div",a+"-tip",this._tipContainer),this.options.closeButton){var S=this._closeButton=lt("a",a+"-close-button",d);S.setAttribute("role","button"),S.setAttribute("aria-label","Close popup"),S.href="#close",S.innerHTML='<span aria-hidden="true">&#215;</span>',Ge(S,"click",function(I){Wt(I),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,d=a.style;d.width="",d.whiteSpace="nowrap";var v=a.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),d.width=v+1+"px",d.whiteSpace="",d.height="";var S=a.offsetHeight,I=this.options.maxHeight,P="leaflet-popup-scrolled";I&&S>I?(d.height=I+"px",De(a,P)):Dt(a,P),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),v=this._getAnchor();kt(this._container,d.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,d=parseInt(Ws(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+d,S=this._containerWidth,I=new we(this._containerLeft,-v-this._containerBottom);I._add(ds(this._container));var P=a.layerPointToContainerPoint(I),q=Ne(this.options.autoPanPadding),ee=Ne(this.options.autoPanPaddingTopLeft||q),re=Ne(this.options.autoPanPaddingBottomRight||q),ye=a.getSize(),Re=0,Be=0;P.x+S+re.x>ye.x&&(Re=P.x+S-ye.x+re.x),P.x-Re-ee.x<0&&(Re=P.x-ee.x),P.y+v+re.y>ye.y&&(Be=P.y+v-ye.y+re.y),P.y-Be-ee.y<0&&(Be=P.y-ee.y),(Re||Be)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([Re,Be]))}},_getAnchor:function(){return Ne(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),od=function(a,d){return new ka(a,d)};at.mergeOptions({closePopupOnClick:!0}),at.include({openPopup:function(a,d,v){return this._initOverlay(ka,a,d,v).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),Ji.include({bindPopup:function(a,d){return this._popup=this._initOverlay(ka,this._popup,a,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof ps||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){Hi(a);var d=a.layer||a.target;if(this._popup._source===d&&!(d instanceof _s)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=d,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var La=Bn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){Bn.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){Bn.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=Bn.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",d=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=lt("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+g(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var d,v,S=this._map,I=this._container,P=S.latLngToContainerPoint(S.getCenter()),q=S.layerPointToContainerPoint(a),ee=this.options.direction,re=I.offsetWidth,ye=I.offsetHeight,Re=Ne(this.options.offset),Be=this._getAnchor();ee==="top"?(d=re/2,v=ye):ee==="bottom"?(d=re/2,v=0):ee==="center"?(d=re/2,v=ye/2):ee==="right"?(d=0,v=ye/2):ee==="left"?(d=re,v=ye/2):q.x<P.x?(ee="right",d=0,v=ye/2):(ee="left",d=re+(Re.x+Be.x)*2,v=ye/2),a=a.subtract(Ne(d,v,!0)).add(Re).add(Be),Dt(I,"leaflet-tooltip-right"),Dt(I,"leaflet-tooltip-left"),Dt(I,"leaflet-tooltip-top"),Dt(I,"leaflet-tooltip-bottom"),De(I,"leaflet-tooltip-"+ee),kt(I,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&qt(this._container,a)},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(d)},_getAnchor:function(){return Ne(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Nf=function(a,d){return new La(a,d)};at.include({openTooltip:function(a,d,v){return this._initOverlay(La,a,d,v).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),Ji.include({bindTooltip:function(a,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(La,this._tooltip,a,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var d=a?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[d](v),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof ps||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var d=typeof a.getElement=="function"&&a.getElement();d&&(Ge(d,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),Ge(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var d=typeof a.getElement=="function"&&a.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var d=a.latlng,v,S;this._tooltip.options.sticky&&a.originalEvent&&(v=this._map.mouseEventToContainerPoint(a.originalEvent),S=this._map.containerPointToLayerPoint(v),d=this._map.layerPointToLatLng(S)),this._tooltip.setLatLng(d)}});var rd=gs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var d=a&&a.tagName==="DIV"?a:document.createElement("div"),v=this.options;if(v.html instanceof Element?(Yt(d),d.appendChild(v.html)):d.innerHTML=v.html!==!1?v.html:"",v.bgPos){var S=Ne(v.bgPos);d.style.backgroundPosition=-S.x+"px "+-S.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function Rf(a){return new rd(a)}gs.Default=Ia;var Cr=Ji.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Oe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){G(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),ct(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Jt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ci(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof we?a:new we(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var d=this.getPane().children,v=-a(-1/0,1/0),S=0,I=d.length,P;S<I;S++)P=d[S].style.zIndex,d[S]!==this._container&&P&&(v=a(v,+P));isFinite(v)&&(this.options.zIndex=v+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Oe.ielt9){qt(this._container,this.options.opacity);var a=+new Date,d=!1,v=!1;for(var S in this._tiles){var I=this._tiles[S];if(!(!I.current||!I.loaded)){var P=Math.min(1,(a-I.loaded)/200);qt(I.el,P),P<1?d=!0:(I.active?v=!0:this._onOpaqueTile(I),I.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),d&&(Y(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:A,_initContainer:function(){this._container||(this._container=lt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,d=this.options.maxZoom;if(a!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===a?(this._levels[v].el.style.zIndex=d-Math.abs(a-v),this._onUpdateLevel(v)):(ct(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var S=this._levels[a],I=this._map;return S||(S=this._levels[a]={},S.el=lt("div","leaflet-tile-container leaflet-zoom-animated",this._container),S.el.style.zIndex=d,S.origin=I.project(I.unproject(I.getPixelOrigin()),a).round(),S.zoom=a,this._setZoomTransform(S,I.getCenter(),I.getZoom()),A(S.el.offsetWidth),this._onCreateLevel(S)),this._level=S,S}},_onUpdateLevel:A,_onRemoveLevel:A,_onCreateLevel:A,_pruneTiles:function(){if(this._map){var a,d,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)d=this._tiles[a],d.retain=d.current;for(a in this._tiles)if(d=this._tiles[a],d.current&&!d.active){var S=d.coords;this._retainParent(S.x,S.y,S.z,S.z-5)||this._retainChildren(S.x,S.y,S.z,S.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var d in this._tiles)this._tiles[d].coords.z===a&&this._removeTile(d)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)ct(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,d,v,S){var I=Math.floor(a/2),P=Math.floor(d/2),q=v-1,ee=new we(+I,+P);ee.z=+q;var re=this._tileCoordsToKey(ee),ye=this._tiles[re];return ye&&ye.active?(ye.retain=!0,!0):(ye&&ye.loaded&&(ye.retain=!0),q>S?this._retainParent(I,P,q,S):!1)},_retainChildren:function(a,d,v,S){for(var I=2*a;I<2*a+2;I++)for(var P=2*d;P<2*d+2;P++){var q=new we(I,P);q.z=v+1;var ee=this._tileCoordsToKey(q),re=this._tiles[ee];if(re&&re.active){re.retain=!0;continue}else re&&re.loaded&&(re.retain=!0);v+1<S&&this._retainChildren(I,P,v+1,S)}},_resetView:function(a){var d=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var d=this.options;return d.minNativeZoom!==void 0&&a<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<a?d.maxNativeZoom:a},_setView:function(a,d,v,S){var I=Math.round(d);this.options.maxZoom!==void 0&&I>this.options.maxZoom||this.options.minZoom!==void 0&&I<this.options.minZoom?I=void 0:I=this._clampZoom(I);var P=this.options.updateWhenZooming&&I!==this._tileZoom;(!S||P)&&(this._tileZoom=I,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),I!==void 0&&this._update(a),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(a,d)},_setZoomTransforms:function(a,d){for(var v in this._levels)this._setZoomTransform(this._levels[v],a,d)},_setZoomTransform:function(a,d,v){var S=this._map.getZoomScale(v,a.zoom),I=a.origin.multiplyBy(S).subtract(this._map._getNewPixelOrigin(d,v)).round();Oe.any3d?qi(a.el,I,S):kt(a.el,I)},_resetGrid:function(){var a=this._map,d=a.options.crs,v=this._tileSize=this.getTileSize(),S=this._tileZoom,I=this._map.getPixelWorldBounds(this._tileZoom);I&&(this._globalTileRange=this._pxBoundsToTileRange(I)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,d.wrapLng[0]],S).x/v.x),Math.ceil(a.project([0,d.wrapLng[1]],S).x/v.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([d.wrapLat[0],0],S).y/v.x),Math.ceil(a.project([d.wrapLat[1],0],S).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var d=this._map,v=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),S=d.getZoomScale(v,this._tileZoom),I=d.project(a,this._tileZoom).floor(),P=d.getSize().divideBy(S*2);return new j(I.subtract(P),I.add(P))},_update:function(a){var d=this._map;if(d){var v=this._clampZoom(d.getZoom());if(a===void 0&&(a=d.getCenter()),this._tileZoom!==void 0){var S=this._getTiledPixelBounds(a),I=this._pxBoundsToTileRange(S),P=I.getCenter(),q=[],ee=this.options.keepBuffer,re=new j(I.getBottomLeft().subtract([ee,-ee]),I.getTopRight().add([ee,-ee]));if(!(isFinite(I.min.x)&&isFinite(I.min.y)&&isFinite(I.max.x)&&isFinite(I.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ye in this._tiles){var Re=this._tiles[ye].coords;(Re.z!==this._tileZoom||!re.contains(new we(Re.x,Re.y)))&&(this._tiles[ye].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(a,v);return}for(var Be=I.min.y;Be<=I.max.y;Be++)for(var ot=I.min.x;ot<=I.max.x;ot++){var Mn=new we(ot,Be);if(Mn.z=this._tileZoom,!!this._isValidTile(Mn)){var un=this._tiles[this._tileCoordsToKey(Mn)];un?un.current=!0:q.push(Mn)}}if(q.sort(function(Ct,bt){return Ct.distanceTo(P)-bt.distanceTo(P)}),q.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var mi=document.createDocumentFragment();for(ot=0;ot<q.length;ot++)this._addTile(q[ot],mi);this._level.el.appendChild(mi)}}}},_isValidTile:function(a){var d=this._map.options.crs;if(!d.infinite){var v=this._globalTileRange;if(!d.wrapLng&&(a.x<v.min.x||a.x>v.max.x)||!d.wrapLat&&(a.y<v.min.y||a.y>v.max.y))return!1}if(!this.options.bounds)return!0;var S=this._tileCoordsToBounds(a);return ue(this.options.bounds).overlaps(S)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var d=this._map,v=this.getTileSize(),S=a.scaleBy(v),I=S.add(v),P=d.unproject(S,a.z),q=d.unproject(I,a.z);return[P,q]},_tileCoordsToBounds:function(a){var d=this._tileCoordsToNwSe(a),v=new Ce(d[0],d[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var d=a.split(":"),v=new we(+d[0],+d[1]);return v.z=+d[2],v},_removeTile:function(a){var d=this._tiles[a];d&&(ct(d.el),delete this._tiles[a],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){De(a,"leaflet-tile");var d=this.getTileSize();a.style.width=d.x+"px",a.style.height=d.y+"px",a.onselectstart=A,a.onmousemove=A,Oe.ielt9&&this.options.opacity<1&&qt(a,this.options.opacity)},_addTile:function(a,d){var v=this._getTilePos(a),S=this._tileCoordsToKey(a),I=this.createTile(this._wrapCoords(a),c(this._tileReady,this,a));this._initTile(I),this.createTile.length<2&&F(c(this._tileReady,this,a,null,I)),kt(I,v),this._tiles[S]={el:I,coords:a,current:!0},d.appendChild(I),this.fire("tileloadstart",{tile:I,coords:a})},_tileReady:function(a,d,v){d&&this.fire("tileerror",{error:d,tile:v,coords:a});var S=this._tileCoordsToKey(a);v=this._tiles[S],v&&(v.loaded=+new Date,this._map._fadeAnimated?(qt(v.el,0),Y(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),d||(De(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Oe.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var d=new we(this._wrapX?x(a.x,this._wrapX):a.x,this._wrapY?x(a.y,this._wrapY):a.y);return d.z=a.z,d},_pxBoundsToTileRange:function(a){var d=this.getTileSize();return new j(a.min.unscaleBy(d).floor(),a.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function ad(a){return new Cr(a)}var ro=Cr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,d){this._url=a,d=G(this,d),d.detectRetina&&Oe.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,d){return this._url===a&&d===void 0&&(d=!0),this._url=a,d||this.redraw(),this},createTile:function(a,d){var v=document.createElement("img");return Ge(v,"load",c(this._tileOnLoad,this,d,v)),Ge(v,"error",c(this._tileOnError,this,d,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(a),v},getTileUrl:function(a){var d={r:Oe.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-a.y;this.options.tms&&(d.y=v),d["-y"]=v}return te(this._url,r(d,this.options))},_tileOnLoad:function(a,d){Oe.ielt9?setTimeout(c(a,this,null,d),0):a(null,d)},_tileOnError:function(a,d,v){var S=this.options.errorTileUrl;S&&d.getAttribute("src")!==S&&(d.src=S),a(v,d)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,d=this.options.maxZoom,v=this.options.zoomReverse,S=this.options.zoomOffset;return v&&(a=d-a),a+S},_getSubdomain:function(a){var d=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var a,d;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(d=this._tiles[a].el,d.onload=A,d.onerror=A,!d.complete)){d.src=de;var v=this._tiles[a].coords;ct(d),delete this._tiles[a],this.fire("tileabort",{tile:d,coords:v})}},_removeTile:function(a){var d=this._tiles[a];if(d)return d.el.setAttribute("src",de),Cr.prototype._removeTile.call(this,a)},_tileReady:function(a,d,v){if(!(!this._map||v&&v.getAttribute("src")===de))return Cr.prototype._tileReady.call(this,a,d,v)}});function Ci(a,d){return new ro(a,d)}var Va=ro.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,d){this._url=a;var v=r({},this.defaultWmsParams);for(var S in d)S in this.options||(v[S]=d[S]);d=G(this,d);var I=d.detectRetina&&Oe.retina?2:1,P=this.getTileSize();v.width=P.x*I,v.height=P.y*I,this.wmsParams=v},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,ro.prototype.onAdd.call(this,a)},getTileUrl:function(a){var d=this._tileCoordsToNwSe(a),v=this._crs,S=he(v.project(d[0]),v.project(d[1])),I=S.min,P=S.max,q=(this._wmsVersion>=1.3&&this._crs===Lo?[I.y,I.x,P.y,P.x]:[I.x,I.y,P.x,P.y]).join(","),ee=ro.prototype.getTileUrl.call(this,a);return ee+z(this.wmsParams,ee,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+q},setParams:function(a,d){return r(this.wmsParams,a),d||this.redraw(),this}});function bi(a,d){return new Va(a,d)}ro.WMS=Va,Ci.wms=bi;var ei=Ji.extend({options:{padding:.1},initialize:function(a){G(this,a),g(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),De(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,d){var v=this._map.getZoomScale(d,this._zoom),S=this._map.getSize().multiplyBy(.5+this.options.padding),I=this._map.project(this._center,d),P=S.multiplyBy(-v).add(I).subtract(this._map._getNewPixelOrigin(a,d));Oe.any3d?qi(this._container,P,v):kt(this._container,P)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,d=this._map.getSize(),v=this._map.containerPointToLayerPoint(d.multiplyBy(-a)).round();this._bounds=new j(v,v.add(d.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Cl=ei.extend({options:{tolerance:0},getEvents:function(){var a=ei.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ei.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");Ge(a,"mousemove",this._onMouseMove,this),Ge(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ge(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){Y(this._redrawRequest),delete this._ctx,ct(this._container),At(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var d in this._layers)a=this._layers[d],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ei.prototype._update.call(this);var a=this._bounds,d=this._container,v=a.getSize(),S=Oe.retina?2:1;kt(d,a.min),d.width=S*v.x,d.height=S*v.y,d.style.width=v.x+"px",d.style.height=v.y+"px",Oe.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){ei.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[g(a)]=a;var d=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var d=a._order,v=d.next,S=d.prev;v?v.prev=S:this._drawLast=S,S?S.next=v:this._drawFirst=v,delete a._order,delete this._layers[g(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var d=a.options.dashArray.split(/[, ]+/),v=[],S,I;for(I=0;I<d.length;I++){if(S=Number(d[I]),isNaN(S))return;v.push(S)}a.options._dashArray=v}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var d=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new j,this._redrawBounds.extend(a._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(a._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var d=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,d=this._redrawBounds;if(this._ctx.save(),d){var v=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var S=this._drawFirst;S;S=S.next)a=S.layer,(!d||a._pxBounds&&a._pxBounds.intersects(d))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,d){if(this._drawing){var v,S,I,P,q=a._parts,ee=q.length,re=this._ctx;if(ee){for(re.beginPath(),v=0;v<ee;v++){for(S=0,I=q[v].length;S<I;S++)P=q[v][S],re[S?"lineTo":"moveTo"](P.x,P.y);d&&re.closePath()}this._fillStroke(re,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var d=a._point,v=this._ctx,S=Math.max(Math.round(a._radius),1),I=(Math.max(Math.round(a._radiusY),1)||S)/S;I!==1&&(v.save(),v.scale(1,I)),v.beginPath(),v.arc(d.x,d.y/I,S,0,Math.PI*2,!1),I!==1&&v.restore(),this._fillStroke(v,a)}},_fillStroke:function(a,d){var v=d.options;v.fill&&(a.globalAlpha=v.fillOpacity,a.fillStyle=v.fillColor||v.color,a.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(a.setLineDash&&a.setLineDash(d.options&&d.options._dashArray||[]),a.globalAlpha=v.opacity,a.lineWidth=v.weight,a.strokeStyle=v.color,a.lineCap=v.lineCap,a.lineJoin=v.lineJoin,a.stroke())},_onClick:function(a){for(var d=this._map.mouseEventToLayerPoint(a),v,S,I=this._drawFirst;I;I=I.next)v=I.layer,v.options.interactive&&v._containsPoint(d)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(v))&&(S=v);this._fireEvent(S?[S]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,d)}},_handleMouseOut:function(a){var d=this._hoveredLayer;d&&(Dt(this._container,"leaflet-interactive"),this._fireEvent([d],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,d){if(!this._mouseHoverThrottled){for(var v,S,I=this._drawFirst;I;I=I.next)v=I.layer,v.options.interactive&&v._containsPoint(d)&&(S=v);S!==this._hoveredLayer&&(this._handleMouseOut(a),S&&(De(this._container,"leaflet-interactive"),this._fireEvent([S],a,"mouseover"),this._hoveredLayer=S)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,d,v){this._map._fireDOMEvent(d,v||d.type,a)},_bringToFront:function(a){var d=a._order;if(d){var v=d.next,S=d.prev;if(v)v.prev=S;else return;S?S.next=v:v&&(this._drawFirst=v),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(a)}},_bringToBack:function(a){var d=a._order;if(d){var v=d.next,S=d.prev;if(S)S.next=v;else return;v?v.prev=S:S&&(this._drawLast=S),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(a)}}});function Oa(a){return Oe.canvas?new Cl(a):null}var ao=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),ku={_initContainer:function(){this._container=lt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ei.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var d=a._container=ao("shape");De(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",a._path=ao("path"),d.appendChild(a._path),this._updateStyle(a),this._layers[g(a)]=a},_addPath:function(a){var d=a._container;this._container.appendChild(d),a.options.interactive&&a.addInteractiveTarget(d)},_removePath:function(a){var d=a._container;ct(d),a.removeInteractiveTarget(d),delete this._layers[g(a)]},_updateStyle:function(a){var d=a._stroke,v=a._fill,S=a.options,I=a._container;I.stroked=!!S.stroke,I.filled=!!S.fill,S.stroke?(d||(d=a._stroke=ao("stroke")),I.appendChild(d),d.weight=S.weight+"px",d.color=S.color,d.opacity=S.opacity,S.dashArray?d.dashStyle=Q(S.dashArray)?S.dashArray.join(" "):S.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=S.lineCap.replace("butt","flat"),d.joinstyle=S.lineJoin):d&&(I.removeChild(d),a._stroke=null),S.fill?(v||(v=a._fill=ao("fill")),I.appendChild(v),v.color=S.fillColor||S.color,v.opacity=S.fillOpacity):v&&(I.removeChild(v),a._fill=null)},_updateCircle:function(a){var d=a._point.round(),v=Math.round(a._radius),S=Math.round(a._radiusY||v);this._setPath(a,a._empty()?"M0 0":"AL "+d.x+","+d.y+" "+v+","+S+" 0,"+65535*360)},_setPath:function(a,d){a._path.v=d},_bringToFront:function(a){Jt(a._container)},_bringToBack:function(a){ci(a._container)}},ys=Oe.vml?ao:Vi,br=ei.extend({_initContainer:function(){this._container=ys("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ys("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ct(this._container),At(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ei.prototype._update.call(this);var a=this._bounds,d=a.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,v.setAttribute("width",d.x),v.setAttribute("height",d.y)),kt(v,a.min),v.setAttribute("viewBox",[a.min.x,a.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(a){var d=a._path=ys("path");a.options.className&&De(d,a.options.className),a.options.interactive&&De(d,"leaflet-interactive"),this._updateStyle(a),this._layers[g(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){ct(a._path),a.removeInteractiveTarget(a._path),delete this._layers[g(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var d=a._path,v=a.options;d&&(v.stroke?(d.setAttribute("stroke",v.color),d.setAttribute("stroke-opacity",v.opacity),d.setAttribute("stroke-width",v.weight),d.setAttribute("stroke-linecap",v.lineCap),d.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?d.setAttribute("stroke-dasharray",v.dashArray):d.removeAttribute("stroke-dasharray"),v.dashOffset?d.setAttribute("stroke-dashoffset",v.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),v.fill?(d.setAttribute("fill",v.fillColor||v.color),d.setAttribute("fill-opacity",v.fillOpacity),d.setAttribute("fill-rule",v.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(a,d){this._setPath(a,In(a._parts,d))},_updateCircle:function(a){var d=a._point,v=Math.max(Math.round(a._radius),1),S=Math.max(Math.round(a._radiusY),1)||v,I="a"+v+","+S+" 0 1,0 ",P=a._empty()?"M0 0":"M"+(d.x-v)+","+d.y+I+v*2+",0 "+I+-v*2+",0 ";this._setPath(a,P)},_setPath:function(a,d){a._path.setAttribute("d",d)},_bringToFront:function(a){Jt(a._path)},_bringToBack:function(a){ci(a._path)}});Oe.vml&&br.include(ku);function Ua(a){return Oe.svg||Oe.vml?new br(a):null}at.include({getRenderer:function(a){var d=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var d=this._paneRenderers[a];return d===void 0&&(d=this._createRenderer({pane:a}),this._paneRenderers[a]=d),d},_createRenderer:function(a){return this.options.preferCanvas&&Oa(a)||Ua(a)}});var Vo=xr.extend({initialize:function(a,d){xr.prototype.initialize.call(this,this._boundsToLatLngs(a),d)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=ue(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function Mf(a,d){return new Vo(a,d)}br.create=ys,br.pointsToPath=In,Vs.geometryToLayer=zn,Vs.coordsToLatLng=El,Vs.coordsToLatLngs=Ma,Vs.latLngToCoords=xl,Vs.latLngsToCoords=Pa,Vs.getFeature=io,Vs.asFeature=wl,at.mergeOptions({boxZoom:!0});var ti=hi.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){Ge(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){At(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ct(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),xi(),Ro(),this._startPoint=this._map.mouseEventToContainerPoint(a),Ge(document,{contextmenu:Hi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=lt("div","leaflet-zoom-box",this._container),De(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var d=new j(this._point,this._startPoint),v=d.getSize();kt(this._box,d.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(ct(this._box),Dt(this._container,"leaflet-crosshair")),yn(),Qs(),At(document,{contextmenu:Hi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var d=new Ce(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});at.addInitHook("addHandler","boxZoom",ti),at.mergeOptions({doubleClickZoom:!0});var bl=hi.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var d=this._map,v=d.getZoom(),S=d.options.zoomDelta,I=a.originalEvent.shiftKey?v-S:v+S;d.options.doubleClickZoom==="center"?d.setZoom(I):d.setZoomAround(a.containerPoint,I)}});at.addInitHook("addHandler","doubleClickZoom",bl),at.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var vs=hi.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Ki(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}De(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Dt(this._map._container,"leaflet-grab"),Dt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=ue(this._map.options.maxBounds);this._offsetLimit=he(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var d=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(d),this._prunePositions(d)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,d){return a-(a-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;a.x<d.min.x&&(a.x=this._viscousLimit(a.x,d.min.x)),a.y<d.min.y&&(a.y=this._viscousLimit(a.y,d.min.y)),a.x>d.max.x&&(a.x=this._viscousLimit(a.x,d.max.x)),a.y>d.max.y&&(a.y=this._viscousLimit(a.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,d=Math.round(a/2),v=this._initialWorldOffset,S=this._draggable._newPos.x,I=(S-d+v)%a+d-v,P=(S+d+v)%a-d-v,q=Math.abs(I+v)<Math.abs(P+v)?I:P;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=q},_onDragEnd:function(a){var d=this._map,v=d.options,S=!v.inertia||a.noInertia||this._times.length<2;if(d.fire("dragend",a),S)d.fire("moveend");else{this._prunePositions(+new Date);var I=this._lastPos.subtract(this._positions[0]),P=(this._lastTime-this._times[0])/1e3,q=v.easeLinearity,ee=I.multiplyBy(q/P),re=ee.distanceTo([0,0]),ye=Math.min(v.inertiaMaxSpeed,re),Re=ee.multiplyBy(ye/re),Be=ye/(v.inertiaDeceleration*q),ot=Re.multiplyBy(-Be/2).round();!ot.x&&!ot.y?d.fire("moveend"):(ot=d._limitOffset(ot,d.options.maxBounds),F(function(){d.panBy(ot,{duration:Be,easeLinearity:q,noMoveStart:!0,animate:!0})}))}}});at.addInitHook("addHandler","dragging",vs),at.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Lu=hi.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),Ge(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),At(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,d=document.documentElement,v=a.scrollTop||d.scrollTop,S=a.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(S,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var d=this._panKeys={},v=this.keyCodes,S,I;for(S=0,I=v.left.length;S<I;S++)d[v.left[S]]=[-1*a,0];for(S=0,I=v.right.length;S<I;S++)d[v.right[S]]=[a,0];for(S=0,I=v.down.length;S<I;S++)d[v.down[S]]=[0,a];for(S=0,I=v.up.length;S<I;S++)d[v.up[S]]=[0,-1*a]},_setZoomDelta:function(a){var d=this._zoomKeys={},v=this.keyCodes,S,I;for(S=0,I=v.zoomIn.length;S<I;S++)d[v.zoomIn[S]]=a;for(S=0,I=v.zoomOut.length;S<I;S++)d[v.zoomOut[S]]=-a},_addHooks:function(){Ge(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){At(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var d=a.keyCode,v=this._map,S;if(d in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(S=this._panKeys[d],a.shiftKey&&(S=Ne(S).multiplyBy(3)),v.options.maxBounds&&(S=v._limitOffset(Ne(S),v.options.maxBounds)),v.options.worldCopyJump){var I=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(S)));v.panTo(I)}else v.panBy(S)}else if(d in this._zoomKeys)v.setZoom(v.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;Hi(a)}}});at.addInitHook("addHandler","keyboard",Lu),at.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var za=hi.extend({addHooks:function(){Ge(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){At(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var d=vn(a),v=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var S=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),S),Hi(a)},_performZoom:function(){var a=this._map,d=a.getZoom(),v=this._map.options.zoomSnap||0;a._stop();var S=this._delta/(this._map.options.wheelPxPerZoomLevel*4),I=4*Math.log(2/(1+Math.exp(-Math.abs(S))))/Math.LN2,P=v?Math.ceil(I/v)*v:I,q=a._limitZoom(d+(this._delta>0?P:-P))-d;this._delta=0,this._startTime=null,q&&(a.options.scrollWheelZoom==="center"?a.setZoom(d+q):a.setZoomAround(this._lastMousePos,d+q))}});at.addInitHook("addHandler","scrollWheelZoom",za);var Oo=600;at.mergeOptions({tapHold:Oe.touchNative&&Oe.safari&&Oe.mobile,tapTolerance:15});var Il=hi.extend({addHooks:function(){Ge(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){At(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var d=a.touches[0];this._startPos=this._newPos=new we(d.clientX,d.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(Ge(document,"touchend",Wt),Ge(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),Oo),Ge(document,"touchend touchcancel contextmenu",this._cancel,this),Ge(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){At(document,"touchend",Wt),At(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),At(document,"touchend touchcancel contextmenu",this._cancel,this),At(document,"touchmove",this._onMove,this)},_onMove:function(a){var d=a.touches[0];this._newPos=new we(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,d){var v=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});v._simulated=!0,d.target.dispatchEvent(v)}});at.addInitHook("addHandler","tapHold",Il),at.mergeOptions({touchZoom:Oe.touch,bounceAtZoomLimits:!0});var Vu=hi.extend({addHooks:function(){De(this._map._container,"leaflet-touch-zoom"),Ge(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Dt(this._map._container,"leaflet-touch-zoom"),At(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var d=this._map;if(!(!a.touches||a.touches.length!==2||d._animatingZoom||this._zooming)){var v=d.mouseEventToContainerPoint(a.touches[0]),S=d.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(v.add(S)._divideBy(2))),this._startDist=v.distanceTo(S),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),Ge(document,"touchmove",this._onTouchMove,this),Ge(document,"touchend touchcancel",this._onTouchEnd,this),Wt(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var d=this._map,v=d.mouseEventToContainerPoint(a.touches[0]),S=d.mouseEventToContainerPoint(a.touches[1]),I=v.distanceTo(S)/this._startDist;if(this._zoom=d.getScaleZoom(I,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&I<1||this._zoom>d.getMaxZoom()&&I>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,I===1)return}else{var P=v._add(S)._divideBy(2)._subtract(this._centerPoint);if(I===1&&P.x===0&&P.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(P),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),Y(this._animRequest);var q=c(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(q,this,!0),Wt(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Y(this._animRequest),At(document,"touchmove",this._onTouchMove,this),At(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});at.addInitHook("addHandler","touchZoom",Vu),at.BoxZoom=ti,at.DoubleClickZoom=bl,at.Drag=vs,at.Keyboard=Lu,at.ScrollWheelZoom=za,at.TapHold=Il,at.TouchZoom=Vu,t.Bounds=j,t.Browser=Oe,t.CRS=be,t.Canvas=Cl,t.Circle=Tl,t.CircleMarker=Er,t.Class=Ke,t.Control=On,t.DivIcon=rd,t.DivOverlay=Bn,t.DomEvent=ms,t.DomUtil=$s,t.Draggable=Ki,t.Evented=Ae,t.FeatureGroup=ps,t.GeoJSON=Vs,t.GridLayer=Cr,t.Handler=hi,t.Icon=gs,t.ImageOverlay=Sr,t.LatLng=ge,t.LatLngBounds=Ce,t.Layer=Ji,t.LayerGroup=Tr,t.LineUtil=Si,t.Map=at,t.Marker=Ra,t.Mixin=yl,t.Path=_s,t.Point=we,t.PolyUtil=no,t.Polygon=xr,t.Polyline=Ls,t.Popup=ka,t.PosAnimation=Ps,t.Projection=Yi,t.Rectangle=Vo,t.Renderer=ei,t.SVG=br,t.SVGOverlay=Al,t.TileLayer=ro,t.Tooltip=La,t.Transformation=ut,t.Util=B,t.VideoOverlay=oo,t.bind=c,t.bounds=he,t.canvas=Oa,t.circle=nd,t.circleMarker=td,t.control=$n,t.divIcon=Rf,t.extend=r,t.featureGroup=$c,t.geoJSON=Sl,t.geoJson=Da,t.gridLayer=ad,t.icon=ba,t.imageOverlay=id,t.latLng=Se,t.latLngBounds=ue,t.layerGroup=Cf,t.map=to,t.marker=ed,t.point=Ne,t.polygon=If,t.polyline=bf,t.popup=od,t.rectangle=Mf,t.setOptions=G,t.stamp=g,t.svg=Ua,t.svgOverlay=sd,t.tileLayer=Ci,t.tooltip=Nf,t.transformation=je,t.version=i,t.videoOverlay=Ar;var Ou=window.L;t.noConflict=function(){return window.L=Ou,this},window.L=t}))})(Tc,Tc.exports)),Tc.exports}var wu=VP();const Cg=hg(wu);function nf(n,e,t){return Object.freeze({instance:n,context:e,container:t})}function sf(n,e){return e==null?function(i,r){const u=X.useRef(void 0);return u.current||(u.current=n(i,r)),u}:function(i,r){const u=X.useRef(void 0);u.current||(u.current=n(i,r));const c=X.useRef(i),{instance:m}=u.current;return X.useEffect(function(){c.current!==i&&(e(m,i,c.current),c.current=i)},[m,i,e]),u}}function Pw(n,e){X.useEffect(function(){return(e.layerContainer??e.map).addLayer(n.instance),function(){var u;(u=e.layerContainer)==null||u.removeLayer(n.instance),e.map.removeLayer(n.instance)}},[e,n])}function Dw(n){return function(t){const i=ef(),r=n(tf(t,i),i);return Nw(i.map,t.attribution),Ag(r.current,t.eventHandlers),Pw(r.current,i),r}}function OP(n,e){const t=X.useRef(void 0);X.useEffect(function(){if(e.pathOptions!==t.current){const r=e.pathOptions??{};n.instance.setStyle(r),t.current=r}},[n,e])}function UP(n){return function(t){const i=ef(),r=n(tf(t,i),i);return Ag(r.current,t.eventHandlers),Pw(r.current,i),OP(r.current,t),r}}function zP(n,e){const t=sf(n,e),i=Dw(t);return Mw(i)}function BP(n,e){const t=sf(n),i=kP(t,e);return PP(i)}function FP(n,e){const t=sf(n,e),i=UP(t);return Mw(i)}function qP(n,e){const t=sf(n,e),i=Dw(t);return DP(i)}function HP(n,e,t){const{opacity:i,zIndex:r}=e;i!=null&&i!==t.opacity&&n.setOpacity(i),r!=null&&r!==t.zIndex&&n.setZIndex(r)}function bg(){return ef().map}function GP({bounds:n,boundsOptions:e,center:t,children:i,className:r,id:u,placeholder:c,style:m,whenReady:g,zoom:p,...x},A){const[b]=X.useState({className:r,id:u,style:m}),[M,K]=X.useState(null),G=X.useRef(void 0);X.useImperativeHandle(A,()=>(M==null?void 0:M.map)??null,[M]);const z=X.useCallback(te=>{if(te!==null&&!G.current){const Q=new wu.Map(te,x);G.current=Q,t!=null&&p!=null?Q.setView(t,p):n!=null&&Q.fitBounds(n,e),g!=null&&Q.whenReady(g),K(MP(Q))}},[]);X.useEffect(()=>()=>{M==null||M.map.remove()},[M]);const W=M?Sh.createElement(Sg,{value:M},i):c??null;return Sh.createElement("div",{...b,ref:z},W)}const jP=X.forwardRef(GP),ZP=zP(function({position:e,...t},i){const r=new wu.Marker(e,t);return nf(r,Rw(i,{overlayContainer:r}))},function(e,t,i){t.position!==i.position&&e.setLatLng(t.position),t.icon!=null&&t.icon!==i.icon&&e.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==i.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==i.opacity&&e.setOpacity(t.opacity),e.dragging!=null&&t.draggable!==i.draggable&&(t.draggable===!0?e.dragging.enable():e.dragging.disable())}),KP=FP(function({positions:e,...t},i){const r=new wu.Polyline(e,t);return nf(r,Rw(i,{overlayContainer:r}))},function(e,t,i){t.positions!==i.positions&&e.setLatLngs(t.positions)}),YP=BP(function(e,t){const i=new wu.Popup(e,t.overlayContainer);return nf(i,t)},function(e,t,{position:i},r){X.useEffect(function(){const{instance:c}=e;function m(p){p.popup===c&&(c.update(),r(!0))}function g(p){p.popup===c&&r(!1)}return t.map.on({popupopen:m,popupclose:g}),t.overlayContainer==null?(i!=null&&c.setLatLng(i),c.openOn(t.map)):t.overlayContainer.bindPopup(c),function(){var x;t.map.off({popupopen:m,popupclose:g}),(x=t.overlayContainer)==null||x.unbindPopup(),t.map.removeLayer(c)}},[e,t,r,i])}),JP=qP(function({url:e,...t},i){const r=new wu.TileLayer(e,tf(t,i));return nf(r,i)},function(e,t,i){HP(e,t,i);const{url:r}=t;r!=null&&r!==i.url&&e.setUrl(r)}),WP="AIzaSyBu2o-gj4Mo1qVg-I7lnsTqbymn49EQUEY",QP=n=>{var e,t,i,r;if(typeof n.text=="string")return n.text;if(typeof n.text=="function")return n.text();if(n.candidates&&((r=(i=(t=(e=n.candidates[0])==null?void 0:e.content)==null?void 0:t.parts)==null?void 0:i[0])!=null&&r.text))return n.candidates[0].content.parts[0].text;throw new Error("No text found in AI response")},iE={1:{lat:25.033,lng:121.5654},2:{lat:25.0421,lng:121.5082},3:{lat:25.1024,lng:121.5486},test:{lat:25.033,lng:121.5654},kyoto:{lat:35.0116,lng:135.7681},osaka:{lat:34.6937,lng:135.5023},tokyo:{lat:35.6762,lng:139.6503}},kw=async(n,e)=>{const t=n.toLowerCase().trim();if(iE[t])return console.log(`Using Test Location for: ${n}`),iE[t];const i=async c=>{if(!c)return null;try{const g=await new _w({apiKey:c}).models.generateContent({model:"gemini-2.0-flash",contents:`Convert this address to latitude and longitude coordinates: "${n}". 
                
                IMPORTANT: Return ONLY a JSON object in this exact format:
                {"lat": 25.0330, "lng": 121.5654}
                
                Do not include any explanations, just the JSON object.`,config:{responseMimeType:"application/json"}}),p=QP(g),x=JSON.parse(p);if(x.lat&&x.lng)return{lat:parseFloat(x.lat),lng:parseFloat(x.lng)}}catch(m){return console.warn(`Geocoding failed with key ${c.substring(0,5)}...`,m),null}return null},r=async c=>{if(!c)return null;try{console.log(`Trying Google Maps Geocoding API with key ${c.substring(0,5)}...`);const m=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(n)}&key=${c}`,p=await(await fetch(m)).json();if(p.status==="OK"&&p.results&&p.results.length>0){const x=p.results[0].geometry.location;return{lat:x.lat,lng:x.lng}}else console.warn("Google Maps Geocoding API error:",p.status,p.error_message),window.localStorage.setItem("last_geocode_error",`${p.status}: ${p.error_message||"Unknown error"}`)}catch(m){console.warn("Google Maps Geocoding API request failed:",m),window.localStorage.setItem("last_geocode_error",`Network Error: ${m}`)}return null},u=async()=>{try{console.log("Trying Open-Meteo Geocoding...");const c=`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(n)}&count=1&language=zh&format=json`,m=await fetch(c);if(!m.ok)throw new Error(`Open-Meteo status: ${m.status}`);const g=await m.json();if(g&&g.results&&g.results.length>0){const p=g.results[0];return{lat:p.latitude,lng:p.longitude}}else console.warn("Open-Meteo found no results."),window.localStorage.setItem("last_geocode_error","Open-Meteo: No results found")}catch(c){console.warn("Open-Meteo request failed:",c),window.localStorage.setItem("last_geocode_error",`Open-Meteo Error: ${c}`)}return null};if(e){let c=await i(e);if(c||(c=await r(e),c))return c;console.log("User key failed, trying environment key...")}{console.log("Trying Backup Key with Gemini...");const c=await i(WP);if(c)return c}return console.log("Falling back to Open-Meteo (Free Service)..."),await u()},XP=Object.freeze(Object.defineProperty({__proto__:null,geocodeAddress:kw},Symbol.toStringTag,{value:"Module"})),$P="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",e5="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";let t5=Cg.icon({iconUrl:$P,shadowUrl:e5,iconSize:[25,41],iconAnchor:[12,41]});Cg.Marker.prototype.options.icon=t5;const n5=({bounds:n})=>{const e=bg();return X.useEffect(()=>{n&&n.length>0&&e.fitBounds(n,{padding:[80,80]})},[n,e]),null},i5=()=>{const n=bg();return X.useEffect(()=>{const e=setTimeout(()=>{n.invalidateSize()},250);return()=>clearTimeout(e)},[n]),null},s5=({selectedLocation:n})=>{const e=bg();return X.useEffect(()=>{n&&e.flyTo([n.lat,n.lng],16,{animate:!0,duration:1.5})},[n,e]),null},o5=({trip:n,settings:e,onUpdateTrip:t})=>{jt[e.language]||jt["zh-TW"];const[i,r]=X.useState(!1),[u,c]=X.useState("ALL"),[m,g]=X.useState(null),p=X.useMemo(()=>{const z=n.itinerary||[];return u==="ALL"?z:z.filter(W=>W.day===u)},[n.itinerary,u]),x=X.useMemo(()=>{const z={};return(n.itinerary||[]).forEach(W=>{z[W.day]||(z[W.day]=[]),z[W.day].push(W)}),Object.keys(z).forEach(W=>{z[Number(W)].sort((te,Q)=>te.time.localeCompare(Q.time))}),z},[n.itinerary]),A=X.useMemo(()=>{const z=p.filter(W=>W.coordinates||W.lat&&W.lng).map(W=>{var te,Q;return[((te=W.coordinates)==null?void 0:te.lat)||W.lat,((Q=W.coordinates)==null?void 0:Q.lng)||W.lng]});return z.length===0?null:z},[p]),b=X.useMemo(()=>{var W,te,Q;if(!m)return null;const z=(W=n.itinerary)==null?void 0:W.find(me=>me.id===m);return z&&(z.coordinates||z.lat&&z.lng)?{lat:((te=z.coordinates)==null?void 0:te.lat)||z.lat,lng:((Q=z.coordinates)==null?void 0:Q.lng)||z.lng}:null},[m,n.itinerary]),M=async()=>{r(!0);const z=[...n.itinerary||[]];let W=!1;try{for(let te=0;te<z.length;te++){const Q=z[te];if(!Q.coordinates&&!Q.lat){const me=Q.location;console.log(`Geocoding: ${me}`),window.localStorage.setItem("last_geocode_query",me);const de=await kw(me,e.apiKey);window.localStorage.setItem("last_geocode_result",de?JSON.stringify(de):"Failed"),de&&(z[te]={...Q,coordinates:de,lat:de.lat,lng:de.lng},W=!0,await new Promise(fe=>setTimeout(fe,500)))}}W&&t?(t({...n,itinerary:z}),alert("Coordinates updated!")):alert("No new coordinates found.")}catch(te){console.error("Geocoding error",te),alert("Error updating coordinates.")}finally{r(!1)}};X.useEffect(()=>{n.itinerary&&n.itinerary.length>0&&g(n.itinerary[0].id)},[n.id]),X.useEffect(()=>{var W,te;window.localStorage.removeItem("last_geocode_error");const z=((W=n.itinerary)==null?void 0:W.filter(Q=>Q.location&&(!Q.lat||!Q.lng)))||[];console.log("Auto-Sync Check:",{hasItems:((te=n.itinerary)==null?void 0:te.length)>0,hasMissingCoords:z.length>0,itinerary:n.itinerary}),z.length>0&&(console.log("Triggering auto-sync..."),M())},[]);const K=Object.keys(x).map(Number).sort((z,W)=>z-W),G=["#FF5733","#33FF57","#3357FF","#FF33F5","#33FFF5","#F5FF33"];return E.jsxs("div",{className:"h-full flex flex-col pb-24",children:[E.jsxs("div",{className:"mb-4 flex gap-2 overflow-x-auto no-scrollbar py-1 shrink-0",children:[E.jsx("button",{onClick:()=>{c("ALL"),g(null)},className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${u==="ALL"?"bg-ink text-white":"bg-white text-gray-500 border border-sand"}`,children:"ALL"}),K.map(z=>E.jsxs("button",{onClick:()=>{c(z),g(null)},className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${u===z?"bg-coral text-white":"bg-white text-gray-500 border border-sand"}`,children:["Day ",z]},z)),E.jsxs("button",{onClick:M,disabled:i,className:"ml-auto px-3 py-1.5 bg-white border border-coral text-coral rounded-full text-xs font-bold flex items-center gap-1 hover:bg-coral hover:text-white transition-colors disabled:opacity-50",children:[i?E.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"}):E.jsx(po,{className:"w-3 h-3"}),"Sync Map"]})]}),E.jsx("div",{className:"h-[35vh] shrink-0 bg-gray-100 rounded-3xl overflow-hidden shadow-inner border border-sand relative z-0 mb-4",children:E.jsxs(jP,{center:[25.033,121.5654],zoom:13,style:{height:"100%",width:"100%"},children:[E.jsx(JP,{attribution:' <a href="https://www.google.com/maps">Google Maps</a>',url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"}),E.jsx(i5,{}),A&&!b&&E.jsx(n5,{bounds:A}),E.jsx(s5,{selectedLocation:b}),p.map((z,W)=>{var de,fe;const te=((de=z.coordinates)==null?void 0:de.lat)||z.lat,Q=((fe=z.coordinates)==null?void 0:fe.lng)||z.lng;if(!te||!Q)return null;const me=m===z.id;return E.jsx(ZP,{position:[te,Q],icon:Cg.divIcon({className:"custom-div-icon",html:`<div style="background-color: ${me?"#C5A059":G[(z.day-1)%G.length]}; width: ${me?"32px":"24px"}; height: ${me?"32px":"24px"}; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: ${me?"14px":"12px"}; transition: all 0.3s ease;">${W+1}</div>`,iconSize:[me?32:24,me?32:24],iconAnchor:[me?16:12,me?16:12]}),eventHandlers:{click:()=>g(z.id)},children:E.jsx(YP,{children:E.jsxs("div",{className:"text-center",children:[E.jsxs("div",{className:"font-bold text-ink",children:[W+1,". ",z.activity]}),E.jsx("div",{className:"text-xs text-gray-500",children:z.time}),E.jsxs("div",{className:"text-xs text-coral mt-1",children:["Day ",z.day]})]})})},z.id||W)}),K.map((z,W)=>{if(u!=="ALL"&&u!==z)return null;const Q=x[z].filter(me=>{var de,fe;return(((de=me.coordinates)==null?void 0:de.lat)||me.lat)&&(((fe=me.coordinates)==null?void 0:fe.lng)||me.lng)}).map(me=>{var de,fe;return[((de=me.coordinates)==null?void 0:de.lat)||me.lat,((fe=me.coordinates)==null?void 0:fe.lng)||me.lng]});return Q.length<2?null:E.jsx(KP,{positions:Q,color:G[W%G.length],weight:4,opacity:.7,dashArray:"10, 10"},z)})]})}),E.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-3 px-1",children:p.map((z,W)=>E.jsxs("div",{onClick:()=>g(z.id),className:`p-4 rounded-2xl border transition-all cursor-pointer flex items-center gap-4 ${m===z.id?"bg-coral/10 border-coral shadow-md":"bg-white border-sand hover:border-coral/50"}`,children:[E.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold shrink-0",style:{backgroundColor:G[(z.day-1)%G.length]},children:W+1}),E.jsxs("div",{className:"flex-1 min-w-0",children:[E.jsxs("div",{className:"flex justify-between items-start",children:[E.jsx("h3",{className:"font-bold text-ink truncate",children:z.activity}),E.jsxs("span",{className:"text-xs font-bold text-coral bg-coral/10 px-2 py-0.5 rounded-full whitespace-nowrap",children:["Day ",z.day]})]}),E.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[E.jsx("span",{className:"font-mono bg-gray-100 px-1.5 py-0.5 rounded",children:z.time}),E.jsx("span",{className:"truncate",children:z.location})]})]})]},z.id||W))})]})},r5=({trip:n,onBack:e,onDelete:t,onUpdateTrip:i,onOpenAI:r,settings:u})=>{const c=jt[u.language]||jt["zh-TW"],[m,g]=X.useState("ITINERARY"),[p,x]=X.useState(!1),[A,b]=X.useState(!1),[M,K]=X.useState(!1),[G,z]=X.useState(null),[W,te]=X.useState(""),[Q,me]=X.useState(""),[de,fe]=X.useState([{name:"",price:""}]),[V,O]=X.useState(!1),[U,H]=X.useState(!1),[F,Y]=X.useState(n.title),[B,Ke]=X.useState(!1),[mt,oe]=X.useState(""),[Ae,we]=X.useState(!1),Qe=()=>{x(!0)},Ne=()=>{t==null||t(n.id)},j=()=>{F.trim()&&F!==n.title&&(i==null||i({...n,title:F})),H(!1)},he=async be=>{if(be==="upload"){const Me=document.createElement("input");Me.type="file",Me.accept="image/*",Me.onchange=ke=>{var ut,je;const it=(je=(ut=ke.target)==null?void 0:ut.files)==null?void 0:je[0];if(it){const Ft=new FileReader;Ft.onload=()=>{const gn=Ft.result;i==null||i({...n,coverImage:gn}),Ke(!1)},Ft.readAsDataURL(it)}},Me.click()}else if(be==="url")mt.trim()&&(i==null||i({...n,coverImage:mt}),oe(""),Ke(!1));else if(be==="ai"){we(!0);try{const{generateCoverImage:Me}=await $h(async()=>{const{generateCoverImage:it}=await Promise.resolve().then(()=>vP);return{generateCoverImage:it}},void 0),ke=await Me(n.title);i==null||i({...n,coverImage:ke}),Ke(!1)}catch(Me){console.error("Failed to generate cover:",Me),alert("AI ")}finally{we(!1)}}},Ce=be=>{z(be),te(""),me(""),fe([{name:"",price:""}]),K(!0)},ue=()=>{var Ft,gn,Vi;if(!G||!W)return;const be=parseInt(W),Me=de.filter(In=>In.name&&In.price).map(In=>`${In.name}: ${In.price}`).join(", "),ke=Q?Me?`${Q} (${Me})`:Q:Me,it={id:Date.now().toString(),title:G.activity,amount:be,category:"Shopping",date:n.startDate?new Date(n.startDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],payer:"ME",paymentMethod:"Cash",note:ke},ut=((Ft=n.budget)==null?void 0:Ft.expenses)||[],je={...n,budget:{...n.budget,total:((gn=n.budget)==null?void 0:gn.total)||0,currency:((Vi=n.budget)==null?void 0:Vi.currency)||"TWD",expenses:[it,...ut]}};i==null||i(je),K(!1)},ge=(be,Me,ke)=>{const it=[...de];if(it[be][Me]=ke,fe(it),Me==="price"){const ut=it.reduce((je,Ft)=>je+(parseInt(Ft.price)||0),0);ut>0&&te(ut.toString())}},Se=()=>{fe([...de,{name:"",price:""}])};return E.jsxs("div",{className:"flex flex-col h-full bg-paper animate-fade-in relative",children:[E.jsxs("div",{className:"relative h-64 shrink-0 group",children:[E.jsxs("div",{className:"absolute inset-0 bg-gray-200",children:[n.coverImage?E.jsx("img",{src:n.coverImage,alt:n.title,className:`w-full h-full object-cover transition-opacity duration-700 ${A?"opacity-100":"opacity-0"}`,onLoad:()=>b(!0)}):E.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-coral/20 to-sand/30",children:E.jsx(I0,{className:"w-16 h-16 text-coral/40"})}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"})]}),E.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe pt-4 flex justify-between items-start z-10",children:[E.jsx("button",{onClick:e,className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-black/50 transition-colors",children:E.jsx(ns,{className:"w-6 h-6"})}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("button",{onClick:()=>Ke(!0),className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-black/50 transition-colors opacity-0 group-hover:opacity-100",children:E.jsx(po,{className:"w-5 h-5"})}),E.jsx("button",{onClick:()=>r==null?void 0:r(n.id),className:"p-2 bg-white/20 backdrop-blur-md rounded-full text-white hover:bg-white/30 transition-colors",title:"AI Assistant",children:E.jsx(po,{className:"w-5 h-5"})}),E.jsx("button",{onClick:Qe,className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-red-500/80 transition-colors",children:E.jsx(er,{className:"w-5 h-5"})})]})]}),E.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 text-white z-10",children:[U?E.jsx("div",{className:"flex items-center gap-2 mb-2",children:E.jsx("input",{value:F,onChange:be=>Y(be.target.value),className:"bg-white/20 backdrop-blur-md text-white text-3xl font-black px-2 py-1 rounded-lg outline-none w-full",autoFocus:!0,onBlur:j,onKeyDown:be=>be.key==="Enter"&&j()})}):E.jsxs("h1",{className:"text-3xl font-black mb-2 leading-tight drop-shadow-md cursor-pointer hover:text-coral/90 transition-colors flex items-center gap-2",onClick:()=>{H(!0),Y(n.title)},children:[n.title,E.jsx(qx,{className:"w-5 h-5 opacity-50"})]}),E.jsxs("div",{className:"flex items-center gap-3 text-sm font-bold text-gray-200",children:[E.jsxs("span",{className:"bg-white/20 backdrop-blur-md px-2 py-0.5 rounded text-xs",children:[n.days," Days"]}),E.jsxs("span",{children:[n.startDate," - ",n.endDate]})]})]})]}),E.jsx("div",{className:"flex-1 overflow-y-auto bg-paper relative rounded-t-3xl -mt-6 z-20 shadow-[0_-4px_20px_rgba(0,0,0,0.1)]",children:E.jsxs("div",{className:"p-5 min-h-full",children:[m==="ITINERARY"&&E.jsx(AP,{trip:n,settings:u,onUpdateTrip:i,onOpenQuickExpense:Ce}),m==="MAP"&&E.jsx(o5,{trip:n,settings:u}),m==="BUDGET"&&E.jsx(bP,{trip:n,settings:u,onUpdateTrip:i}),m==="BOOKINGS"&&E.jsx(IP,{trip:n,settings:u,onUpdateTrip:i}),m==="SHOPPING"&&E.jsx(SP,{items:n.shoppingList||[],onUpdateItems:be=>i==null?void 0:i({...n,shoppingList:be}),settings:u})]})}),E.jsx("div",{className:"absolute bottom-6 left-6 right-6 bg-white/90 backdrop-blur-xl rounded-full shadow-2xl border border-white/50 p-1.5 flex justify-between items-center z-30",children:[{id:"ITINERARY",icon:Fx,label:c.itinerary},{id:"MAP",icon:I0,label:c.map},{id:"BUDGET",icon:Ux,label:c.budget},{id:"BOOKINGS",icon:zx,label:c.bookings},{id:"SHOPPING",icon:Hx,label:c.shopping}].map(be=>E.jsxs("button",{onClick:()=>g(be.id),className:`flex-1 flex flex-col items-center justify-center py-2 rounded-full transition-all duration-300 ${m===be.id?"bg-ink text-white shadow-lg scale-105":"text-gray-400 hover:text-ink hover:bg-gray-100"}`,children:[E.jsx(be.icon,{className:`w-5 h-5 ${m===be.id?"stroke-2":"stroke-[1.5]"}`}),m===be.id&&E.jsx("span",{className:"text-[10px] font-bold mt-0.5",children:be.label})]},be.id))}),p&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",children:E.jsxs("div",{className:"bg-white rounded-3xl p-6 w-full max-w-xs shadow-2xl animate-scale-in text-center",children:[E.jsx("div",{className:"w-16 h-16 bg-red-100 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:E.jsx(er,{className:"w-8 h-8"})}),E.jsx("h3",{className:"text-xl font-bold text-ink mb-2",children:c.delete_trip}),E.jsx("p",{className:"text-gray-500 mb-6",children:c.delete_trip_confirm.replace("{title}",n.title)}),E.jsxs("div",{className:"flex gap-3",children:[E.jsx("button",{onClick:()=>x(!1),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:c.cancel}),E.jsx("button",{onClick:Ne,className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 shadow-lg shadow-red-500/30 transition-colors",children:c.delete})]})]})}),B&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>Ke(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:be=>be.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:""}),E.jsxs("div",{className:"space-y-3",children:[E.jsxs("button",{onClick:()=>he("upload"),className:"w-full py-4 bg-white border border-sand rounded-xl font-bold text-ink hover:bg-gray-50 flex items-center justify-center gap-2",children:[E.jsx("span",{children:""})," "]}),E.jsx("button",{onClick:()=>he("ai"),disabled:Ae,className:"w-full py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:Ae?E.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):E.jsxs(E.Fragment,{children:[E.jsx("span",{children:""})," AI "]})}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute inset-0 flex items-center",children:E.jsx("div",{className:"w-full border-t border-sand"})}),E.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:E.jsx("span",{className:"bg-paper px-2 text-gray-400",children:"OR"})})]}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("input",{value:mt,onChange:be=>oe(be.target.value),placeholder:"...",className:"flex-1 bg-white p-3 rounded-xl border border-sand outline-none"}),E.jsx("button",{onClick:()=>he("url"),disabled:!mt,className:"bg-ink text-white px-4 rounded-xl font-bold disabled:opacity-50",children:"OK"})]})]})]})}),M&&E.jsx("div",{className:"fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>K(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:be=>be.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-ink mb-2 text-center",children:""}),E.jsx("p",{className:"text-center text-gray-400 text-sm mb-6",children:G==null?void 0:G.activity}),E.jsxs("div",{className:"space-y-4",children:[de.map((be,Me)=>E.jsxs("div",{className:"flex gap-2",children:[E.jsx("input",{value:be.name,onChange:ke=>ge(Me,"name",ke.target.value),placeholder:" (: )",className:"flex-1 bg-white p-3 rounded-xl font-bold border-none shadow-sm outline-none",autoFocus:Me===0}),E.jsx("input",{type:"number",value:be.price,onChange:ke=>ge(Me,"price",ke.target.value),placeholder:"",className:"w-24 bg-white p-3 rounded-xl font-bold border-none shadow-sm outline-none text-center"})]},Me)),E.jsx("button",{onClick:Se,className:"text-xs font-bold text-coral flex items-center gap-1 mx-auto hover:bg-coral/10 px-3 py-1 rounded-lg transition-colors",children:"+ "}),E.jsxs("div",{className:"pt-4 border-t border-sand",children:[E.jsxs("div",{className:"flex justify-between items-center mb-4",children:[E.jsx("span",{className:"font-bold text-gray-400",children:""}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"font-bold text-ink text-2xl",children:""}),E.jsx("input",{type:"number",value:W,onChange:be=>te(be.target.value),className:"w-32 bg-transparent text-right text-3xl font-black border-none outline-none p-0",placeholder:"0"})]})]}),E.jsx("textarea",{value:Q,onChange:be=>me(be.target.value),placeholder:"...",className:"w-full bg-white p-3 rounded-xl text-sm font-medium border-none shadow-sm outline-none min-h-[60px]"})]}),E.jsx("button",{onClick:ue,disabled:!W,className:"w-full bg-ink text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-ink/30 mt-2 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:""})]})]})})]})},a5=({onStartGeneration:n,onCancel:e,settings:t,sessions:i,currentSessionId:r,onCreateSession:u,onUpdateSession:c,onDeleteSession:m,onSelectSession:g})=>{const p=jt[t.language]||jt["zh-TW"],[x,A]=X.useState(""),[b,M]=X.useState(!1),[K,G]=X.useState(!1),z=X.useRef(null),W=i.find(fe=>fe.id===r),te=(W==null?void 0:W.messages)||[],Q=()=>{var fe;(fe=z.current)==null||fe.scrollIntoView({behavior:"smooth"})};X.useEffect(Q,[te]),X.useEffect(()=>{r&&te.length===0?c(r,[{role:"ai",content:p.ai_planner_intro,timestamp:Date.now()}]):!r&&i.length===0?u():!r&&i.length>0&&g(i[0].id)},[r,i.length]);const me=()=>{u(),G(!1)},de=async()=>{if(!x.trim()||!r)return;const fe={role:"user",content:x,timestamp:Date.now()},V=[...te,fe];c(r,V),A(""),M(!0);const O={role:"ai",content:p.ai_planning,timestamp:Date.now()};c(r,[...V,O]),n(x,W==null?void 0:W.tripId).then(U=>{const H={role:"ai",content:p.ai_done,timestamp:Date.now()};U?c(r,[...V,H],U.title,U.tripId):c(r,[...V,H]),M(!1)})};return E.jsxs("div",{className:"flex h-full bg-paper pt-safe relative overflow-hidden",children:[K&&E.jsx("div",{className:"absolute inset-0 bg-black/20 z-20 backdrop-blur-sm",onClick:()=>G(!1)}),E.jsxs("div",{className:`absolute top-0 left-0 bottom-0 w-64 bg-white shadow-2xl z-30 transform transition-transform duration-300 ease-in-out ${K?"translate-x-0":"-translate-x-full"}`,children:[E.jsxs("div",{className:"p-4 border-b border-sand flex justify-between items-center pt-12",children:[E.jsx("h3",{className:"font-bold text-lg text-ink",children:t.language==="zh-TW"?"":"Chat History"}),E.jsx("button",{onClick:me,className:"p-2 bg-coral/10 rounded-full text-coral hover:bg-coral/20",children:E.jsx(mg,{className:"w-5 h-5"})})]}),E.jsxs("div",{className:"overflow-y-auto h-full pb-20",children:[i.map(fe=>E.jsxs("div",{onClick:()=>{g(fe.id),G(!1)},className:`p-4 border-b border-sand/50 cursor-pointer hover:bg-sand/30 transition-colors ${r===fe.id?"bg-sand/50 border-l-4 border-l-coral":""}`,children:[E.jsx("div",{className:"font-medium text-ink truncate",children:fe.title}),E.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(fe.updatedAt).toLocaleDateString()})]},fe.id)),i.length===0&&E.jsx("div",{className:"p-8 text-center text-gray-400 text-sm",children:t.language==="zh-TW"?"":"No chat history"})]})]}),E.jsxs("div",{className:"flex-1 flex flex-col h-full w-full",children:[E.jsxs("div",{className:"px-4 py-3 border-b border-sand/50 flex items-center justify-between bg-paper sticky top-0 z-10 pt-safe pt-4",children:[E.jsxs("div",{className:"flex items-center",children:[E.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-white text-gray-500 transition-colors",children:E.jsx(ns,{className:"w-6 h-6"})}),E.jsx("button",{onClick:()=>G(!0),className:"ml-2 p-2 rounded-full hover:bg-white text-gray-500 transition-colors",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})}),E.jsxs("h2",{className:"text-lg font-bold text-ink ml-2 flex items-center gap-2 truncate max-w-[150px]",children:[E.jsx(Bx,{className:"w-5 h-5 text-coral"}),(W==null?void 0:W.title)||p.ai_planner_title]})]}),E.jsx("button",{onClick:me,className:"text-xs font-bold text-coral border border-coral/30 px-3 py-1.5 rounded-full hover:bg-coral/10 transition-colors",children:t.language==="zh-TW"?"":"New Chat"})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24",children:[te.map((fe,V)=>E.jsx("div",{className:`flex ${fe.role==="user"?"justify-end":"justify-start"} animate-slide-up`,children:E.jsx("div",{className:`max-w-[85%] p-4 rounded-2xl text-sm font-medium leading-relaxed shadow-sm whitespace-pre-line ${fe.role==="user"?"bg-coral text-white rounded-tr-none":"bg-white text-ink border border-sand rounded-tl-none"}`,children:fe.content})},V)),b&&E.jsx("div",{className:"flex justify-start",children:E.jsxs("div",{className:"bg-white p-4 rounded-2xl rounded-tl-none border border-sand flex items-center gap-2",children:[E.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce"}),E.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce delay-100"}),E.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce delay-200"}),E.jsx("span",{className:"text-xs text-gray-400 font-bold ml-1",children:p.planning_process})]})}),E.jsx("div",{ref:z})]}),E.jsxs("div",{className:"p-4 bg-white/90 backdrop-blur border-t border-sand pb-32",children:[E.jsxs("div",{className:"flex gap-2",children:[E.jsx("textarea",{value:x,onChange:fe=>A(fe.target.value),onKeyDown:fe=>{fe.key==="Enter"&&!fe.shiftKey&&(fe.preventDefault(),de())},placeholder:p.input_placeholder,className:"flex-1 bg-paper rounded-2xl px-5 py-3.5 outline-none focus:ring-2 focus:ring-coral/50 transition-all font-medium text-ink placeholder:text-gray-400 border border-sand resize-none min-h-[50px] max-h-[120px]",disabled:b,rows:1}),E.jsx("button",{onClick:de,disabled:!x.trim()||b,className:"bg-coral text-white p-3.5 rounded-2xl disabled:opacity-50 active:scale-95 transition-transform shadow-lg shadow-coral/20",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:E.jsx("path",{d:"M3.105 2.289a.75.75 0 0 0-.826.95l1.414 4.925A1.5 1.5 0 0 0 5.135 9.25h6.115a.75.75 0 0 1 0 1.5H5.135a1.5 1.5 0 0 0-1.442 1.086l-1.414 4.926a.75.75 0 0 0 .826.95 28.896 28.896 0 0 0 15.293-7.154.75.75 0 0 0 0-1.115A28.897 28.897 0 0 0 3.105 2.289Z"})})})]}),E.jsx("div",{className:"flex gap-2 mt-3 overflow-x-auto no-scrollbar pb-2",children:[p.prompt_tokyo,p.prompt_bangkok,p.prompt_paris].map(fe=>E.jsx("button",{onClick:()=>A(fe),className:"whitespace-nowrap px-4 py-2 bg-white text-gray-500 text-xs font-bold rounded-xl border border-sand hover:text-coral hover:border-coral transition-colors",disabled:b,children:fe},fe))})]})]})]})},l5="https://api.exchangerate-api.com/v4/latest/TWD";let vc=null,sE=0;const u5=1440*60*1e3,c5=async()=>{const n=Date.now();if(vc&&n-sE<u5)return vc;try{const t=await(await fetch(l5)).json();return vc=t,sE=n,t}catch(e){return console.error("Failed to fetch exchange rates:",e),vc||{base:"TWD",rates:{TWD:1,JPY:.22,KRW:.043,USD:31.5,EUR:34.2}}}},d5=async(n,e)=>{if(e==="TWD")return n;const i=(await c5()).rates[e];return i?n/i:(console.warn(`Unknown currency: ${e}`),n)},h5=(n,e="TWD")=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:e==="TWD"?"TWD":e,minimumFractionDigits:0,maximumFractionDigits:0}).format(n),Lw=()=>"webkitSpeechRecognition"in window||"SpeechRecognition"in window,Ig=()=>"speechSynthesis"in window,f5=(n="zh-TW",e,t)=>{if(!Lw())return t==null||t(""),null;const i=window.webkitSpeechRecognition||window.SpeechRecognition,r=new i;return r.continuous=!1,r.interimResults=!1,r.lang=n,r.onresult=u=>{const c=u.results[0][0].transcript;e(c)},r.onerror=u=>{t==null||t(u.error)},r.start(),r},Vw=(n,e="zh-TW",t)=>{if(!Ig()){console.error("");return}window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(n);i.lang=e,i.rate=1,i.pitch=1,i.volume=1,t&&(i.onend=t),window.speechSynthesis.speak(i)},m5=()=>{Ig()&&window.speechSynthesis.cancel()},p5=async(n,e,t,i,r)=>new Promise((u,c)=>{f5(n,async g=>{t==null||t(g);try{const p=await bw(g,e,n);p?(i==null||i(p),Vw(p,e,()=>{u()})):(r==null||r(""),c("Translation failed"))}catch(p){r==null||r(p),c(p)}},g=>{r==null||r(g),c(g)})||c("Speech recognition not supported")}),sh={recognition:Lw(),synthesis:Ig()};function g5({title:n,titleId:e,...t},i){return X.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?X.createElement("title",{id:e},n):null,X.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"}))}const _5=X.forwardRef(g5);function y5({title:n,titleId:e,...t},i){return X.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?X.createElement("title",{id:e},n):null,X.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"}))}const v5=X.forwardRef(y5);function T5({title:n,titleId:e,...t},i){return X.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?X.createElement("title",{id:e},n):null,X.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const oE=X.forwardRef(T5);function E5({title:n,titleId:e,...t},i){return X.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?X.createElement("title",{id:e},n):null,X.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),X.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"}))}const x5=X.forwardRef(E5),w5=({defaultSourceLang:n="zh-TW",defaultTargetLang:e="en-US"})=>{const[t,i]=X.useState(n),[r,u]=X.useState(e),[c,m]=X.useState(""),[g,p]=X.useState(""),[x,A]=X.useState(!1),[b,M]=X.useState(!1),[K,G]=X.useState(""),z=[{code:"zh-TW",name:""},{code:"en-US",name:"English"},{code:"ja-JP",name:""},{code:"ko-KR",name:""},{code:"th-TH",name:""}],W=async()=>{if(!sh.recognition){G("");return}G(""),A(!0),m(""),p("");try{await p5(t,r,de=>{m(de)},de=>{p(de),M(!0)},de=>{G(`${de}`)})}catch(de){console.error(de)}finally{A(!1),M(!1)}},te=()=>{i(r),u(t),m(""),p("")},Q=(de,fe)=>{if(!sh.synthesis){G("");return}Vw(de,fe)},me=()=>{m5(),M(!1)};return E.jsxs("div",{className:"max-w-4xl mx-auto p-6 pt-12 bg-paper rounded-3xl shadow-float",children:[E.jsx("h2",{className:"text-2xl font-bold text-ink mb-6 text-center",children:" "}),E.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[E.jsx("select",{value:t,onChange:de=>i(de.target.value),className:"flex-1 p-3 rounded-xl border-2 border-sand bg-white text-ink font-medium focus:border-coral outline-none",children:z.map(de=>E.jsx("option",{value:de.code,children:de.name},de.code))}),E.jsx("button",{onClick:te,className:"p-3 rounded-full bg-coral text-white hover:bg-coralDark active:scale-95 transition-all",children:E.jsx(_5,{className:"w-5 h-5"})}),E.jsx("select",{value:r,onChange:de=>u(de.target.value),className:"flex-1 p-3 rounded-xl border-2 border-sand bg-white text-ink font-medium focus:border-coral outline-none",children:z.map(de=>E.jsx("option",{value:de.code,children:de.name},de.code))})]}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[E.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-sand min-h-[120px] flex flex-col",children:[E.jsxs("div",{className:"flex items-center justify-between mb-2",children:[E.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:" ()"}),c&&E.jsx("button",{onClick:()=>Q(c,t),className:"p-1 text-coral hover:text-coralDark",children:E.jsx(oE,{className:"w-4 h-4"})})]}),E.jsx("textarea",{value:c,onChange:de=>m(de.target.value),placeholder:"...",className:"w-full flex-1 resize-none outline-none text-ink bg-transparent placeholder:text-gray-300"})]}),E.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-sand min-h-[120px]",children:[E.jsxs("div",{className:"flex items-center justify-between mb-2",children:[E.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),g&&E.jsx("button",{onClick:()=>Q(g,r),className:"p-1 text-coral hover:text-coralDark",children:E.jsx(oE,{className:"w-4 h-4"})})]}),E.jsx("p",{className:"text-ink whitespace-pre-wrap",children:g||"..."})]})]}),K&&E.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm",children:K}),E.jsxs("div",{className:"flex gap-3",children:[E.jsxs("button",{onClick:W,disabled:x||b,className:`flex-1 py-4 rounded-2xl font-bold text-lg flex items-center justify-center gap-2 transition-all ${x?"bg-red-500 text-white animate-pulse":"bg-coral text-white hover:bg-coralDark active:scale-95"}`,children:[E.jsx(v5,{className:"w-6 h-6"}),x?"...":""]}),(x||b)&&E.jsxs("button",{onClick:me,className:"px-6 py-4 rounded-2xl font-bold bg-gray-500 text-white hover:bg-gray-600 active:scale-95 transition-all flex items-center gap-2",children:[E.jsx(x5,{className:"w-6 h-6"}),""]})]}),(!sh.recognition||!sh.synthesis)&&E.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-xl text-yellow-800 text-sm",children:"  ChromeEdge  Safari "})]})},S5=({onBack:n})=>E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(ns,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:""})]}),E.jsx("div",{className:"p-5 flex items-center justify-center h-full text-gray-400 text-center font-medium",children:E.jsx("p",{children:""})})]}),A5=({onBack:n,t:e,language:t})=>{const[i,r]=X.useState("Taiwan (ROC)"),[u,c]=X.useState(""),[m,g]=X.useState(null),[p,x]=X.useState(!1),A=async()=>{if(u){x(!0);try{const b=await Ew(i,u,t);g(b||"")}catch{g("")}finally{x(!1)}}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(ns,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_visa})]}),E.jsxs("div",{className:"p-5 space-y-4 overflow-y-auto flex-1 pb-32",children:[E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card space-y-5 border border-sand",children:[E.jsxs("div",{children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),E.jsxs("select",{value:i,onChange:b=>r(b.target.value),className:"w-full mt-2 p-3 bg-paper rounded-xl text-ink font-medium border-none outline-none",children:[E.jsx("option",{value:"Taiwan (ROC)",children:" (Taiwan)"}),E.jsx("option",{value:"Japan",children:" (Japan)"}),E.jsx("option",{value:"USA",children:" (USA)"}),E.jsx("option",{value:"Hong Kong",children:" (Hong Kong)"})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),E.jsx("input",{value:u,onChange:b=>c(b.target.value),placeholder:"...",className:"w-full mt-2 p-3 bg-paper rounded-xl text-ink font-medium border-none outline-none"})]}),E.jsx("button",{onClick:A,disabled:p||!u,className:"w-full bg-coral text-white py-3.5 rounded-xl font-bold shadow-lg shadow-coral/30 disabled:opacity-50",children:p?e.loading:e.confirm})]}),m&&E.jsx("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand animate-fade-in",children:E.jsx("div",{className:"prose prose-sm max-w-none text-ink leading-relaxed whitespace-pre-line",children:m})})]})]})},C5=({onBack:n,t:e,language:t})=>{const[i,r]=X.useState(""),[u,c]=X.useState(null),[m,g]=X.useState(!1),p=async()=>{g(!0);try{const A=await xw(i||"Kyoto, Japan",t);c(A||"")}catch{c("")}finally{g(!1)}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(ns,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_culture})]}),E.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[E.jsx("div",{className:"mb-4",children:E.jsx("input",{value:i,onChange:x=>r(x.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl shadow-sm border border-sand font-medium text-ink outline-none"})}),E.jsx("button",{onClick:p,disabled:m,className:"w-full bg-orange-400 text-white px-4 py-3.5 rounded-2xl font-bold text-sm shadow-md mb-6",children:m?e.loading:e.confirm}),u&&E.jsx("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand animate-fade-in",children:E.jsx("div",{className:"prose prose-sm text-ink whitespace-pre-line leading-relaxed",children:u})})]})]})},b5=({onBack:n,t:e})=>E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(ns,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_restroom})]}),E.jsx("div",{className:"flex-1 relative rounded-t-3xl overflow-hidden shadow-inner border-t border-sand",children:E.jsx("iframe",{width:"100%",height:"100%",style:{border:0},loading:"lazy",allowFullScreen:!0,src:"https://maps.google.com/maps?q=public+restroom&output=embed"})})]}),I5=({onBack:n,t:e,language:t})=>{const[i,r]=X.useState(""),[u,c]=X.useState(null),[m,g]=X.useState(!1),p=async()=>{if(i){g(!0);try{const x=await Sw(i,t);c(x)}catch{c("")}finally{g(!1)}}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(ns,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_emergency})]}),E.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[E.jsxs("div",{className:"bg-red-500 text-white p-6 rounded-3xl shadow-lg shadow-red-500/20 mb-6",children:[E.jsx("h2",{className:"text-xl font-bold mb-2",children:"SOS?"}),E.jsxs("p",{className:"opacity-90 text-sm",children:[": ",E.jsx("span",{className:"font-black text-2xl ml-1",children:"112"})]})]}),E.jsxs("div",{className:"space-y-3",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:""}),E.jsx("input",{value:i,onChange:x=>r(x.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl border border-sand shadow-sm outline-none"}),E.jsx("button",{onClick:p,disabled:m||!i,className:"w-full py-3.5 bg-ink text-white rounded-2xl font-bold shadow-lg",children:m?e.loading:e.confirm})]}),u&&E.jsx("div",{className:"mt-6 bg-white p-6 rounded-3xl shadow-card border border-sand whitespace-pre-line leading-relaxed text-ink",children:u})]})]})},N5=({onBack:n,t:e,language:t})=>{const[i,r]=X.useState(""),[u,c]=X.useState(null),[m,g]=X.useState(!1),p=async()=>{if(i){g(!0);try{const x=await Aw(i,t);c(x)}catch{c("")}finally{g(!1)}}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(ns,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_card})]}),E.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[E.jsxs("div",{className:"space-y-3",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:""}),E.jsx("input",{value:i,onChange:x=>r(x.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl border border-sand shadow-sm outline-none"}),E.jsx("button",{onClick:p,disabled:m||!i,className:"w-full py-3.5 bg-indigo-500 text-white rounded-2xl font-bold shadow-lg shadow-indigo-200",children:m?e.loading:e.confirm})]}),u&&E.jsx("div",{className:"mt-6 bg-white p-6 rounded-3xl shadow-card border border-sand whitespace-pre-line leading-relaxed text-ink",children:u})]})]})},R5=({onBack:n,trips:e,t})=>{const[i,r]=X.useState(new Set(["Japan","Thailand","Taiwan"])),[u,c]=X.useState("");X.useEffect(()=>{if(e){const p=new Set(i);e.forEach(x=>{(x.title.includes("")||x.title.includes("Japan")||x.title.includes("")||x.title.includes("")||x.title.includes("Tokyo"))&&p.add("Japan"),(x.title.includes("")||x.title.includes("Thailand")||x.title.includes(""))&&p.add("Thailand"),(x.title.includes("")||x.title.includes("Taiwan")||x.title.includes(""))&&p.add("Taiwan"),(x.title.includes("")||x.title.includes("USA"))&&p.add("USA"),(x.title.includes("")||x.title.includes("France")||x.title.includes("Paris"))&&p.add("France")}),r(p)}},[e]);const m=()=>{u.trim()&&(r(p=>new Set(p).add(u.trim())),c(""))},g=p=>{const x=new Set(i);x.delete(p),r(x)};return E.jsxs("div",{className:"flex flex-col h-full bg-[#111827] text-white",children:[E.jsx("div",{className:"bg-[#111827] p-4 flex items-center justify-between sticky top-0 z-10 border-b border-gray-800",children:E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("button",{onClick:n,children:E.jsx(ns,{className:"w-6 h-6 text-gray-300"})}),E.jsx("h3",{className:"font-bold text-lg",children:t.tool_map})]})}),E.jsxs("div",{className:"p-6 flex-1 overflow-y-auto pb-32",children:[E.jsxs("div",{className:"relative w-full aspect-[1.6] bg-[#1F2937] rounded-3xl overflow-hidden mb-8 shadow-2xl border border-gray-700 flex items-center justify-center",children:[E.jsx("div",{className:"absolute inset-0 opacity-30 flex items-center justify-center",children:E.jsxs("svg",{viewBox:"0 0 100 50",className:"w-full h-full text-coral fill-current",children:[E.jsx("path",{d:"M20 10 Q30 5 40 15 T60 15 T80 10 V40 H20 Z",opacity:"0.5"}),E.jsx("circle",{cx:"25",cy:"15",r:"5"}),E.jsx("circle",{cx:"75",cy:"15",r:"6"}),E.jsx("circle",{cx:"50",cy:"30",r:"4"})]})}),E.jsx("h1",{className:"relative text-5xl font-black text-coral tracking-tighter opacity-80 mix-blend-overlay",children:"WORLD"}),E.jsx("div",{className:"absolute bottom-4 text-xs text-gray-500 font-mono tracking-widest",children:"[  ]"})]}),E.jsxs("div",{className:"bg-[#1F2937] rounded-3xl p-6 shadow-lg border border-gray-700 mb-6",children:[E.jsxs("div",{className:"flex justify-between items-center mb-5",children:[E.jsxs("h4",{className:"font-bold text-gray-200",children:[" (",i.size,")"]}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("input",{value:u,onChange:p=>c(p.target.value),placeholder:"...",className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-1.5 text-sm text-white focus:outline-none focus:border-coral w-32"}),E.jsx("button",{onClick:m,className:"bg-coral p-1.5 rounded-lg text-white hover:bg-coralDark",children:E.jsx(Yh,{className:"w-4 h-4"})})]})]}),E.jsx("div",{className:"flex flex-wrap gap-3",children:Array.from(i).map(p=>E.jsxs("div",{className:"group relative px-4 py-2 bg-coral/10 text-coral rounded-xl text-sm font-bold border border-coral/20 flex items-center gap-2",children:[p," ",E.jsx("button",{onClick:()=>g(p),className:"opacity-0 group-hover:opacity-100 absolute -top-2 -right-2 bg-white text-coral rounded-full p-0.5 transition-opacity",children:E.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},p))})]})]})]})},M5=({onBack:n,t:e})=>{const[t,i]=X.useState(""),[r,u]=X.useState("USD"),[c,m]=X.useState(null),[g,p]=X.useState(!1),x=[{code:"USD",name:" (USD)"},{code:"JPY",name:" (JPY)"},{code:"KRW",name:" (KRW)"},{code:"EUR",name:" (EUR)"},{code:"CNY",name:" (CNY)"},{code:"THB",name:" (THB)"},{code:"VND",name:" (VND)"}],A=async()=>{if(t){p(!0);try{const b=parseFloat(t),M=await d5(b,r);m(h5(M))}catch{m("")}finally{p(!1)}}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(ns,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:""})]}),E.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand space-y-5",children:[E.jsxs("div",{children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),E.jsx("input",{type:"number",value:t,onChange:b=>i(b.target.value),placeholder:"...",className:"w-full mt-2 p-4 bg-paper rounded-2xl text-xl font-bold text-ink border-none outline-none"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),E.jsx("select",{value:r,onChange:b=>u(b.target.value),className:"w-full mt-2 p-4 bg-paper rounded-2xl text-ink font-medium border-none outline-none",children:x.map(b=>E.jsx("option",{value:b.code,children:b.name},b.code))})]}),E.jsx("button",{onClick:A,disabled:g||!t,className:"w-full bg-green-500 text-white py-4 rounded-2xl font-bold shadow-lg shadow-green-500/30 disabled:opacity-50 active:scale-95 transition-all",children:g?"...":" (TWD)"})]}),c&&E.jsxs("div",{className:"mt-6 bg-white p-6 rounded-3xl shadow-card border border-sand text-center animate-fade-in",children:[E.jsx("p",{className:"text-gray-400 text-sm font-medium mb-1",children:""}),E.jsx("p",{className:"text-3xl font-black text-ink",children:c})]})]})]})},P5=({onBack:n,t:e,language:t})=>E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(ns,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_translation||"Translation"})]}),E.jsx("div",{className:"flex-1 overflow-y-auto pb-32",children:E.jsx(w5,{defaultSourceLang:t})})]}),D5=({onBack:n,trips:e,settings:t,onMagicEditor:i})=>{const[r,u]=X.useState("MENU"),c=jt[t.language]||jt["zh-TW"];if(r==="EXPENSE")return E.jsx(S5,{onBack:()=>u("MENU")});if(r==="VISA")return E.jsx(A5,{onBack:()=>u("MENU"),t:c,language:t.language});if(r==="CULTURE")return E.jsx(C5,{onBack:()=>u("MENU"),t:c,language:t.language});if(r==="RESTROOM")return E.jsx(b5,{onBack:()=>u("MENU"),t:c});if(r==="SCRATCH_MAP")return E.jsx(R5,{onBack:()=>u("MENU"),trips:e,t:c});if(r==="EMERGENCY")return E.jsx(I5,{onBack:()=>u("MENU"),t:c,language:t.language});if(r==="CARD_ADVICE")return E.jsx(N5,{onBack:()=>u("MENU"),t:c,language:t.language});if(r==="TIME_CAPSULE")return E.jsx("div",{onClick:()=>u("MENU"),children:"Coming Soon"});if(r==="TRANSLATION")return E.jsx(P5,{onBack:()=>u("MENU"),t:c,language:t.language});if(r==="CURRENCY")return E.jsx(M5,{onBack:()=>u("MENU"),t:c});const m=[{id:"MAGIC_EDITOR",name:"",icon:po,color:"text-pink-500",bg:"bg-pink-50",desc:"AI ",action:i},{id:"CURRENCY",name:"",icon:MC,color:"text-green-500",bg:"bg-green-50",desc:""},{id:"TRANSLATION",name:c.tool_translation,icon:UC,color:"text-purple-500",bg:"bg-purple-50",desc:c.desc_translator},{id:"EMERGENCY",name:c.tool_emergency,icon:VC,color:"text-red-500",bg:"bg-red-50",desc:c.desc_emergency},{id:"CARD_ADVICE",name:c.tool_card,icon:OC,color:"text-indigo-500",bg:"bg-indigo-50",desc:c.desc_card},{id:"SCRATCH_MAP",name:c.tool_map,icon:kC,color:"text-teal-500",bg:"bg-teal-50",desc:c.desc_map},{id:"RESTROOM",name:c.tool_restroom,icon:DC,color:"text-cyan-500",bg:"bg-cyan-50",desc:c.desc_restroom},{id:"VISA",name:c.tool_visa,icon:PC,color:"text-blue-500",bg:"bg-blue-50",desc:c.desc_visa},{id:"CULTURE",name:c.tool_culture,icon:Ip,color:"text-orange-500",bg:"bg-orange-50",desc:c.desc_culture}];return E.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[E.jsx("div",{className:"px-5 py-4 bg-paper sticky top-0 z-10 flex items-center justify-between border-b border-sand/50",children:E.jsxs("h2",{className:"text-xl font-extrabold text-ink flex items-center gap-2",children:[E.jsx(mg,{className:"w-6 h-6 text-coral"}),c.tools_title]})}),E.jsx("div",{className:"p-5 grid grid-cols-2 gap-4 pb-32 overflow-y-auto",children:m.map(g=>E.jsxs("div",{onClick:()=>g.action?g.action():u(g.id),className:"bg-white p-5 rounded-3xl shadow-card border border-sand active:scale-95 transition-all cursor-pointer hover:shadow-soft hover:border-coral group",children:[E.jsx("div",{className:`w-12 h-12 ${g.bg} ${g.color} rounded-2xl flex items-center justify-center mb-4 transition-transform group-hover:scale-110`,children:E.jsx(g.icon,{className:"w-6 h-6 stroke-2"})}),E.jsx("h3",{className:"font-bold text-ink mb-1",children:g.name}),E.jsx("p",{className:"text-xs text-gray-400 font-medium",children:g.desc})]},g.id))})]})},k5=({onBack:n,settings:e,onUpdateSettings:t,onResetApp:i,user:r,onLogout:u})=>{const[c,m]=X.useState(!1),[g,p]=X.useState(!1),x=jt[e.language]||jt["zh-TW"];X.useEffect(()=>{const M=localStorage.getItem("nomad_user_api_key");M&&!e.apiKey&&(t({apiKey:M}),localStorage.removeItem("nomad_user_api_key"))},[]);const A=M=>{t({apiKey:M}),M&&(p(!0),setTimeout(()=>p(!1),2e3))},b=[{name:"",value:"#FF6B6B"},{name:"",value:"#4ECDC4"},{name:"",value:"#FFE66D"},{name:"",value:"#A06CD5"},{name:"",value:"#6BCB77"}];return E.jsxs("div",{className:"h-full flex flex-col bg-paper animate-slide-in",children:[E.jsxs("div",{className:"px-6 py-6 flex items-center justify-between bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-sand",children:[E.jsx("button",{onClick:n,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 transition-colors",children:E.jsx(ns,{className:"w-6 h-6 text-ink"})}),E.jsx("h1",{className:"text-xl font-bold text-ink",children:""}),E.jsx("div",{className:"w-10"})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[r&&E.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[E.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{children:[E.jsx("p",{className:"text-lg font-bold text-ink",children:r.username}),E.jsxs("p",{className:"text-xs text-gray-400",children:["ID: ",r.id]})]}),E.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-xl transition-colors text-sm font-medium",children:[E.jsx(qC,{className:"w-4 h-4"}),""]})]})]}),E.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[E.jsxs("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider flex items-center gap-2",children:[E.jsx(HC,{className:"w-4 h-4"}),x.api_settings||"API "]}),E.jsxs("div",{className:"space-y-3",children:[E.jsx("label",{className:"text-sm font-bold text-ink",children:x.api_key_label||"Gemini API Key"}),E.jsxs("div",{className:"relative",children:[E.jsx("input",{type:"password",value:e.apiKey||"",onChange:M=>A(M.target.value),placeholder:x.api_key_placeholder||" API Key",className:"w-full p-4 pr-20 bg-gray-50 rounded-xl border border-gray-200 focus:border-coral focus:ring-2 focus:ring-coral/20 outline-none transition-all font-mono text-sm"}),g&&E.jsx("div",{className:"text-right mt-1",children:E.jsx("span",{className:"text-green-500 text-xs font-bold animate-fade-in",children:x.api_key_saved||""})})]}),E.jsxs("p",{className:"text-xs text-gray-400 leading-relaxed",children:[x.api_key_help||" Key ",E.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-coral hover:underline ml-1",children:" Key"})]})]})]}),E.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[E.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),E.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:[b.map(M=>E.jsx("button",{onClick:()=>t({themeColor:M.value}),className:`w-10 h-10 rounded-full flex-shrink-0 transition-transform ${e.themeColor===M.value?"scale-110 ring-2 ring-offset-2 ring-gray-300":"hover:scale-105"}`,style:{backgroundColor:M.value},"aria-label":M.name},M.value)),E.jsx("button",{onClick:()=>t({themeColor:void 0}),className:`w-10 h-10 rounded-full flex-shrink-0 bg-coral flex items-center justify-center text-white text-xs font-bold transition-transform ${e.themeColor?"hover:scale-105":"scale-110 ring-2 ring-offset-2 ring-gray-300"}`,children:""})]})]}),E.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[E.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),E.jsx("div",{className:"space-y-2",children:[{code:"zh-TW",label:""},{code:"en-US",label:"English"},{code:"ja-JP",label:""}].map(M=>E.jsxs("button",{onClick:()=>t({language:M.code}),className:`w-full flex items-center justify-between p-3 rounded-xl transition-colors ${e.language===M.code?"bg-coral/10 text-coral font-bold":"hover:bg-gray-50 text-ink"}`,children:[E.jsx("span",{children:M.label}),e.language===M.code&&E.jsx("div",{className:"w-2 h-2 rounded-full bg-coral"})]},M.code))})]}),E.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[E.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),c?E.jsxs("div",{className:"space-y-3 animate-fade-in",children:[E.jsx("p",{className:"text-center text-sm text-red-500 font-medium",children:""}),E.jsxs("div",{className:"flex gap-3",children:[E.jsx("button",{onClick:()=>m(!1),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold",children:""}),E.jsx("button",{onClick:()=>{i(),m(!1)},className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg shadow-red-500/30",children:""})]})]}):E.jsxs("button",{onClick:()=>m(!0),className:"w-full flex items-center justify-center gap-2 p-4 border-2 border-red-100 text-red-500 rounded-xl hover:bg-red-50 transition-colors font-bold",children:[E.jsx(er,{className:"w-5 h-5"}),""]})]}),E.jsxs("div",{className:"text-center text-xs text-gray-400 py-4",children:[E.jsx("p",{children:"NomadAI Travel Journal v1.0.0"}),E.jsx("p",{className:"mt-1",children:"Made with  by NomadAI Team"})]})]})]})},L5=()=>{};var rE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},V5=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const u=n[t++];e[i++]=String.fromCharCode((r&31)<<6|u&63)}else if(r>239&&r<365){const u=n[t++],c=n[t++],m=n[t++],g=((r&7)<<18|(u&63)<<12|(c&63)<<6|m&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],c=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(u&63)<<6|c&63)}}return e.join("")},Uw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const u=n[r],c=r+1<n.length,m=c?n[r+1]:0,g=r+2<n.length,p=g?n[r+2]:0,x=u>>2,A=(u&3)<<4|m>>4;let b=(m&15)<<2|p>>6,M=p&63;g||(M=64,c||(b=64)),i.push(t[x],t[A],t[b],t[M])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Ow(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):V5(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const u=t[n.charAt(r++)],m=r<n.length?t[n.charAt(r)]:0;++r;const p=r<n.length?t[n.charAt(r)]:64;++r;const A=r<n.length?t[n.charAt(r)]:64;if(++r,u==null||m==null||p==null||A==null)throw new O5;const b=u<<2|m>>4;if(i.push(b),p!==64){const M=m<<4&240|p>>2;if(i.push(M),A!==64){const K=p<<6&192|A;i.push(K)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class O5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const U5=function(n){const e=Ow(n);return Uw.encodeByteArray(e,!0)},Nh=function(n){return U5(n).replace(/\./g,"")},zw=function(n){try{return Uw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B5=()=>z5().__FIREBASE_DEFAULTS__,F5=()=>{if(typeof process>"u"||typeof rE>"u")return;const n=rE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},q5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&zw(n[1]);return e&&JSON.parse(e)},of=()=>{try{return L5()||B5()||F5()||q5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Bw=n=>{var e,t;return(t=(e=of())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},H5=n=>{const e=Bw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Fw=()=>{var n;return(n=of())==null?void 0:n.config},qw=n=>{var e;return(e=of())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Hw(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j5(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Nh(JSON.stringify(t)),Nh(JSON.stringify(c)),""].join(".")}const Cc={};function Z5(){const n={prod:[],emulator:[]};for(const e of Object.keys(Cc))Cc[e]?n.emulator.push(e):n.prod.push(e);return n}function K5(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let aE=!1;function Gw(n,e){if(typeof window>"u"||typeof document>"u"||!Su(window.location.host)||Cc[n]===e||Cc[n]||aE)return;Cc[n]=e;function t(b){return`__firebase__banner__${b}`}const i="__firebase__banner",u=Z5().prod.length>0;function c(){const b=document.getElementById(i);b&&b.remove()}function m(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function g(b,M){b.setAttribute("width","24"),b.setAttribute("id",M),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function p(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{aE=!0,c()},b}function x(b,M){b.setAttribute("id",M),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function A(){const b=K5(i),M=t("text"),K=document.getElementById(M)||document.createElement("span"),G=t("learnmore"),z=document.getElementById(G)||document.createElement("a"),W=t("preprendIcon"),te=document.getElementById(W)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const Q=b.element;m(Q),x(z,G);const me=p();g(te,W),Q.append(te,K,z,me),document.body.appendChild(Q)}u?(K.innerText="Preview backend disconnected.",te.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(te.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,K.innerText="Preview backend running in this workspace."),K.setAttribute("id",M)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",A):A()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Y5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(li())}function J5(){var e;const n=(e=of())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function W5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Q5(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function X5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $5(){const n=li();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function eD(){return!J5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function tD(){try{return typeof indexedDB=="object"}catch{return!1}}function nD(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var u;e(((u=r.error)==null?void 0:u.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD="FirebaseError";class lr extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=iD,Object.setPrototypeOf(this,lr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fc.prototype.create)}}class Fc{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,u=this.errors[e],c=u?sD(u,i):"Error",m=`${this.serviceName}: ${c} (${r}).`;return new lr(r,m,i)}}function sD(n,e){return n.replace(oD,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const oD=/\{\$([^}]+)}/g;function rD(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function il(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const u=n[r],c=e[r];if(lE(u)&&lE(c)){if(!il(u,c))return!1}else if(u!==c)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function lE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qc(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function aD(n,e){const t=new lD(n,e);return t.subscribe.bind(t)}class lD{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");uD(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=mp),r.error===void 0&&(r.error=mp),r.complete===void 0&&(r.complete=mp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uD(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function mp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hn(n){return n&&n._delegate?n._delegate:n}class sl{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new G5;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hD(e))try{this.getOrInitializeService({instanceIdentifier:Qa})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:r});i.resolve(u)}catch{}}}}clearInstance(e=Qa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Qa){return this.instances.has(e)}getOptions(e=Qa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,c]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(u);i===m&&c.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const u=this.instances.get(i);return u&&e(u,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:dD(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Qa){return this.component?this.component.multipleInstances?e:Qa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function dD(n){return n===Qa?void 0:n}function hD(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new cD(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(vt||(vt={}));const mD={debug:vt.DEBUG,verbose:vt.VERBOSE,info:vt.INFO,warn:vt.WARN,error:vt.ERROR,silent:vt.SILENT},pD=vt.INFO,gD={[vt.DEBUG]:"log",[vt.VERBOSE]:"log",[vt.INFO]:"info",[vt.WARN]:"warn",[vt.ERROR]:"error"},_D=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=gD[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ng{constructor(e){this.name=e,this._logLevel=pD,this._logHandler=_D,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mD[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,vt.DEBUG,...e),this._logHandler(this,vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,vt.VERBOSE,...e),this._logHandler(this,vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,vt.INFO,...e),this._logHandler(this,vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,vt.WARN,...e),this._logHandler(this,vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,vt.ERROR,...e),this._logHandler(this,vt.ERROR,...e)}}const yD=(n,e)=>e.some(t=>n instanceof t);let uE,cE;function vD(){return uE||(uE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function TD(){return cE||(cE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const jw=new WeakMap,Up=new WeakMap,Zw=new WeakMap,pp=new WeakMap,Rg=new WeakMap;function ED(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",u),n.removeEventListener("error",c)},u=()=>{t($r(n.result)),r()},c=()=>{i(n.error),r()};n.addEventListener("success",u),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&jw.set(t,n)}).catch(()=>{}),Rg.set(e,n),e}function xD(n){if(Up.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",c),n.removeEventListener("abort",c)},u=()=>{t(),r()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",u),n.addEventListener("error",c),n.addEventListener("abort",c)});Up.set(n,e)}let zp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Up.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Zw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return $r(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function wD(n){zp=n(zp)}function SD(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(gp(this),e,...t);return Zw.set(i,e.sort?e.sort():[e]),$r(i)}:TD().includes(n)?function(...e){return n.apply(gp(this),e),$r(jw.get(this))}:function(...e){return $r(n.apply(gp(this),e))}}function AD(n){return typeof n=="function"?SD(n):(n instanceof IDBTransaction&&xD(n),yD(n,vD())?new Proxy(n,zp):n)}function $r(n){if(n instanceof IDBRequest)return ED(n);if(pp.has(n))return pp.get(n);const e=AD(n);return e!==n&&(pp.set(n,e),Rg.set(e,n)),e}const gp=n=>Rg.get(n);function CD(n,e,{blocked:t,upgrade:i,blocking:r,terminated:u}={}){const c=indexedDB.open(n,e),m=$r(c);return i&&c.addEventListener("upgradeneeded",g=>{i($r(c.result),g.oldVersion,g.newVersion,$r(c.transaction),g)}),t&&c.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),m.then(g=>{u&&g.addEventListener("close",()=>u()),r&&g.addEventListener("versionchange",p=>r(p.oldVersion,p.newVersion,p))}).catch(()=>{}),m}const bD=["get","getKey","getAll","getAllKeys","count"],ID=["put","add","delete","clear"],_p=new Map;function dE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(_p.get(e))return _p.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=ID.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||bD.includes(t)))return;const u=async function(c,...m){const g=this.transaction(c,r?"readwrite":"readonly");let p=g.store;return i&&(p=p.index(m.shift())),(await Promise.all([p[t](...m),r&&g.done]))[0]};return _p.set(e,u),u}wD(n=>({...n,get:(e,t,i)=>dE(e,t)||n.get(e,t,i),has:(e,t)=>!!dE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(RD(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function RD(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bp="@firebase/app",hE="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr=new Ng("@firebase/app"),MD="@firebase/app-compat",PD="@firebase/analytics-compat",DD="@firebase/analytics",kD="@firebase/app-check-compat",LD="@firebase/app-check",VD="@firebase/auth",OD="@firebase/auth-compat",UD="@firebase/database",zD="@firebase/data-connect",BD="@firebase/database-compat",FD="@firebase/functions",qD="@firebase/functions-compat",HD="@firebase/installations",GD="@firebase/installations-compat",jD="@firebase/messaging",ZD="@firebase/messaging-compat",KD="@firebase/performance",YD="@firebase/performance-compat",JD="@firebase/remote-config",WD="@firebase/remote-config-compat",QD="@firebase/storage",XD="@firebase/storage-compat",$D="@firebase/firestore",ek="@firebase/ai",tk="@firebase/firestore-compat",nk="firebase",ik="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fp="[DEFAULT]",sk={[Bp]:"fire-core",[MD]:"fire-core-compat",[DD]:"fire-analytics",[PD]:"fire-analytics-compat",[LD]:"fire-app-check",[kD]:"fire-app-check-compat",[VD]:"fire-auth",[OD]:"fire-auth-compat",[UD]:"fire-rtdb",[zD]:"fire-data-connect",[BD]:"fire-rtdb-compat",[FD]:"fire-fn",[qD]:"fire-fn-compat",[HD]:"fire-iid",[GD]:"fire-iid-compat",[jD]:"fire-fcm",[ZD]:"fire-fcm-compat",[KD]:"fire-perf",[YD]:"fire-perf-compat",[JD]:"fire-rc",[WD]:"fire-rc-compat",[QD]:"fire-gcs",[XD]:"fire-gcs-compat",[$D]:"fire-fst",[tk]:"fire-fst-compat",[ek]:"fire-vertex","fire-js":"fire-js",[nk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rh=new Map,ok=new Map,qp=new Map;function fE(n,e){try{n.container.addComponent(e)}catch(t){nr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function du(n){const e=n.name;if(qp.has(e))return nr.debug(`There were multiple attempts to register component ${e}.`),!1;qp.set(e,n);for(const t of Rh.values())fE(t,n);for(const t of ok.values())fE(t,n);return!0}function Mg(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Fs(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ea=new Fc("app","Firebase",rk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new sl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ea.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Au=ik;function Kw(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Fp,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw ea.create("bad-app-name",{appName:String(r)});if(t||(t=Fw()),!t)throw ea.create("no-options");const u=Rh.get(r);if(u){if(il(t,u.options)&&il(i,u.config))return u;throw ea.create("duplicate-app",{appName:r})}const c=new fD(r);for(const g of qp.values())c.addComponent(g);const m=new ak(t,i,c);return Rh.set(r,m),m}function Yw(n=Fp){const e=Rh.get(n);if(!e&&n===Fp&&Fw())return Kw();if(!e)throw ea.create("no-app",{appName:n});return e}function ta(n,e,t){let i=sk[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),u=e.match(/\s|\//);if(r||u){const c=[`Unable to register library "${i}" with version "${e}":`];r&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&u&&c.push("and"),u&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),nr.warn(c.join(" "));return}du(new sl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk="firebase-heartbeat-database",uk=1,Pc="firebase-heartbeat-store";let yp=null;function Jw(){return yp||(yp=CD(lk,uk,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Pc)}catch(t){console.warn(t)}}}}).catch(n=>{throw ea.create("idb-open",{originalErrorMessage:n.message})})),yp}async function ck(n){try{const t=(await Jw()).transaction(Pc),i=await t.objectStore(Pc).get(Ww(n));return await t.done,i}catch(e){if(e instanceof lr)nr.warn(e.message);else{const t=ea.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});nr.warn(t.message)}}}async function mE(n,e){try{const i=(await Jw()).transaction(Pc,"readwrite");await i.objectStore(Pc).put(e,Ww(n)),await i.done}catch(t){if(t instanceof lr)nr.warn(t.message);else{const i=ea.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});nr.warn(i.message)}}}function Ww(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk=1024,hk=30;class fk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new pk(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),u=pE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===u||this._heartbeatsCache.heartbeats.some(c=>c.date===u))return;if(this._heartbeatsCache.heartbeats.push({date:u,agent:r}),this._heartbeatsCache.heartbeats.length>hk){const c=gk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){nr.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=pE(),{heartbeatsToSend:i,unsentEntries:r}=mk(this._heartbeatsCache.heartbeats),u=Nh(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),u}catch(t){return nr.warn(t),""}}}function pE(){return new Date().toISOString().substring(0,10)}function mk(n,e=dk){const t=[];let i=n.slice();for(const r of n){const u=t.find(c=>c.agent===r.agent);if(u){if(u.dates.push(r.date),gE(t)>e){u.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),gE(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class pk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return tD()?nD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await ck(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return mE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return mE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function gE(n){return Nh(JSON.stringify({version:2,heartbeats:n})).length}function gk(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(n){du(new sl("platform-logger",e=>new ND(e),"PRIVATE")),du(new sl("heartbeat",e=>new fk(e),"PRIVATE")),ta(Bp,hE,n),ta(Bp,hE,"esm2020"),ta("fire-js","")}_k("");function Qw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yk=Qw,Xw=new Fc("auth","Firebase",Qw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mh=new Ng("@firebase/auth");function vk(n,...e){Mh.logLevel<=vt.WARN&&Mh.warn(`Auth (${Au}): ${n}`,...e)}function mh(n,...e){Mh.logLevel<=vt.ERROR&&Mh.error(`Auth (${Au}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eo(n,...e){throw Dg(n,...e)}function Hs(n,...e){return Dg(n,...e)}function Pg(n,e,t){const i={...yk(),[e]:t};return new Fc("auth","Firebase",i).create(e,{appName:n.name})}function el(n){return Pg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Tk(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Eo(n,"argument-error"),Pg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Dg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Xw.create(n,...e)}function We(n,e,...t){if(!n)throw Dg(e,...t)}function Xo(n){const e="INTERNAL ASSERTION FAILED: "+n;throw mh(e),new Error(e)}function ir(n,e){n||Xo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hp(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function Ek(){return _E()==="http:"||_E()==="https:"}function _E(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ek()||Q5()||"connection"in navigator)?navigator.onLine:!0}function wk(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(e,t){this.shortDelay=e,this.longDelay=t,ir(t>e,"Short delay should be less than long delay!"),this.isMobile=Y5()||X5()}get(){return xk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(n,e){ir(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Xo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Xo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Xo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Ck=new Hc(3e4,6e4);function Lg(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Cu(n,e,t,i,r={}){return eS(n,r,async()=>{let u={},c={};i&&(e==="GET"?c=i:u={body:JSON.stringify(i)});const m=qc({key:n.config.apiKey,...c}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:g,...u};return W5()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Su(n.emulatorConfig.host)&&(p.credentials="include"),$w.fetch()(await tS(n,n.config.apiHost,t,m),p)})}async function eS(n,e,t){n._canInitEmulator=!1;const i={...Sk,...e};try{const r=new Ik(n),u=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const c=await u.json();if("needConfirmation"in c)throw oh(n,"account-exists-with-different-credential",c);if(u.ok&&!("errorMessage"in c))return c;{const m=u.ok?c.errorMessage:c.error.message,[g,p]=m.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw oh(n,"credential-already-in-use",c);if(g==="EMAIL_EXISTS")throw oh(n,"email-already-in-use",c);if(g==="USER_DISABLED")throw oh(n,"user-disabled",c);const x=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Pg(n,x,p);Eo(n,x)}}catch(r){if(r instanceof lr)throw r;Eo(n,"network-request-failed",{message:String(r)})}}async function bk(n,e,t,i,r={}){const u=await Cu(n,e,t,i,r);return"mfaPendingCredential"in u&&Eo(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function tS(n,e,t,i){const r=`${e}${t}?${i}`,u=n,c=u.config.emulator?kg(n.config,r):`${n.config.apiScheme}://${r}`;return Ak.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(c).toString():c}class Ik{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Hs(this.auth,"network-request-failed")),Ck.get())})}}function oh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Hs(n,e,i);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nk(n,e){return Cu(n,"POST","/v1/accounts:delete",e)}async function Ph(n,e){return Cu(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Rk(n,e=!1){const t=Hn(n),i=await t.getIdToken(e),r=Vg(i);We(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const u=typeof r.firebase=="object"?r.firebase:void 0,c=u==null?void 0:u.sign_in_provider;return{claims:r,token:i,authTime:bc(vp(r.auth_time)),issuedAtTime:bc(vp(r.iat)),expirationTime:bc(vp(r.exp)),signInProvider:c||null,signInSecondFactor:(u==null?void 0:u.sign_in_second_factor)||null}}function vp(n){return Number(n)*1e3}function Vg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return mh("JWT malformed, contained fewer than 3 sections"),null;try{const r=zw(t);return r?JSON.parse(r):(mh("Failed to decode base64 JWT payload"),null)}catch(r){return mh("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function yE(n){const e=Vg(n);return We(e,"internal-error"),We(typeof e.exp<"u","internal-error"),We(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dc(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof lr&&Mk(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function Mk({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=bc(this.lastLoginAt),this.creationTime=bc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dh(n){var A;const e=n.auth,t=await n.getIdToken(),i=await Dc(n,Ph(e,{idToken:t}));We(i==null?void 0:i.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const u=(A=r.providerUserInfo)!=null&&A.length?nS(r.providerUserInfo):[],c=kk(n.providerData,u),m=n.isAnonymous,g=!(n.email&&r.passwordHash)&&!(c!=null&&c.length),p=m?g:!1,x={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:c,metadata:new Gp(r.createdAt,r.lastLoginAt),isAnonymous:p};Object.assign(n,x)}async function Dk(n){const e=Hn(n);await Dh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function kk(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function nS(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lk(n,e){const t=await eS(n,{},async()=>{const i=qc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:u}=n.config,c=await tS(n,r,"/v1/token",`key=${u}`),m=await n._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:m,body:i};return n.emulatorConfig&&Su(n.emulatorConfig.host)&&(g.credentials="include"),$w.fetch()(c,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Vk(n,e){return Cu(n,"POST","/v2/accounts:revokeToken",Lg(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){We(e.idToken,"internal-error"),We(typeof e.idToken<"u","internal-error"),We(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):yE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){We(e.length!==0,"internal-error");const t=yE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(We(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:u}=await Lk(e,t);this.updateTokensAndExpiration(i,r,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:u}=t,c=new ou;return i&&(We(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),r&&(We(typeof r=="string","internal-error",{appName:e}),c.accessToken=r),u&&(We(typeof u=="number","internal-error",{appName:e}),c.expirationTime=u),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ou,this.toJSON())}_performRefresh(){return Xo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(n,e){We(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class qs{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new Pk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Gp(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Dc(this,this.stsTokenManager.getToken(this.auth,e));return We(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Rk(this,e)}reload(){return Dk(this)}_assign(e){this!==e&&(We(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new qs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){We(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Dh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fs(this.auth.app))return Promise.reject(el(this.auth));const e=await this.getIdToken();return await Dc(this,Nk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,u=t.phoneNumber??void 0,c=t.photoURL??void 0,m=t.tenantId??void 0,g=t._redirectEventId??void 0,p=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:A,emailVerified:b,isAnonymous:M,providerData:K,stsTokenManager:G}=t;We(A&&G,e,"internal-error");const z=ou.fromJSON(this.name,G);We(typeof A=="string",e,"internal-error"),Kr(i,e.name),Kr(r,e.name),We(typeof b=="boolean",e,"internal-error"),We(typeof M=="boolean",e,"internal-error"),Kr(u,e.name),Kr(c,e.name),Kr(m,e.name),Kr(g,e.name),Kr(p,e.name),Kr(x,e.name);const W=new qs({uid:A,auth:e,email:r,emailVerified:b,displayName:i,isAnonymous:M,photoURL:c,phoneNumber:u,tenantId:m,stsTokenManager:z,createdAt:p,lastLoginAt:x});return K&&Array.isArray(K)&&(W.providerData=K.map(te=>({...te}))),g&&(W._redirectEventId=g),W}static async _fromIdTokenResponse(e,t,i=!1){const r=new ou;r.updateFromServerResponse(t);const u=new qs({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Dh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];We(r.localId!==void 0,"internal-error");const u=r.providerUserInfo!==void 0?nS(r.providerUserInfo):[],c=!(r.email&&r.passwordHash)&&!(u!=null&&u.length),m=new ou;m.updateFromIdToken(i);const g=new qs({uid:r.localId,auth:e,stsTokenManager:m,isAnonymous:c}),p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:u,metadata:new Gp(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(u!=null&&u.length)};return Object.assign(g,p),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vE=new Map;function $o(n){ir(n instanceof Function,"Expected a class definition");let e=vE.get(n);return e?(ir(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,vE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}iS.type="NONE";const TE=iS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ph(n,e,t){return`firebase:${n}:${e}:${t}`}class ru{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:u}=this.auth;this.fullUserKey=ph(this.userKey,r.apiKey,u),this.fullPersistenceKey=ph("persistence",r.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ph(this.auth,{idToken:e}).catch(()=>{});return t?qs._fromGetAccountInfoResponse(this.auth,t,e):null}return qs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new ru($o(TE),e,i);const r=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let u=r[0]||$o(TE);const c=ph(i,e.config.apiKey,e.name);let m=null;for(const p of t)try{const x=await p._get(c);if(x){let A;if(typeof x=="string"){const b=await Ph(e,{idToken:x}).catch(()=>{});if(!b)break;A=await qs._fromGetAccountInfoResponse(e,b,x)}else A=qs._fromJSON(e,x);p!==u&&(m=A),u=p;break}}catch{}const g=r.filter(p=>p._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new ru(u,e,i):(u=g[0],m&&await u._set(c,m.toJSON()),await Promise.all(t.map(async p=>{if(p!==u)try{await p._remove(c)}catch{}})),new ru(u,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(aS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uS(e))return"Blackberry";if(cS(e))return"Webos";if(oS(e))return"Safari";if((e.includes("chrome/")||rS(e))&&!e.includes("edge/"))return"Chrome";if(lS(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function sS(n=li()){return/firefox\//i.test(n)}function oS(n=li()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rS(n=li()){return/crios\//i.test(n)}function aS(n=li()){return/iemobile/i.test(n)}function lS(n=li()){return/android/i.test(n)}function uS(n=li()){return/blackberry/i.test(n)}function cS(n=li()){return/webos/i.test(n)}function Og(n=li()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Ok(n=li()){var e;return Og(n)&&!!((e=window.navigator)!=null&&e.standalone)}function Uk(){return $5()&&document.documentMode===10}function dS(n=li()){return Og(n)||lS(n)||cS(n)||uS(n)||/windows phone/i.test(n)||aS(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hS(n,e=[]){let t;switch(n){case"Browser":t=EE(li());break;case"Worker":t=`${EE(li())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Au}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((c,m)=>{try{const g=e(u);c(g)}catch(g){m(g)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bk(n,e={}){return Cu(n,"GET","/v2/passwordPolicy",Lg(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk=6;class qk{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Fk,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new xE(this),this.idTokenSubscription=new xE(this),this.beforeStateQueue=new zk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$o(t)),this._initializationPromise=this.queue(async()=>{var i,r,u;if(!this._deleted&&(this.persistenceManager=await ru.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((u=this.currentUser)==null?void 0:u.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ph(this,{idToken:e}),i=await qs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var u;if(Fs(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(m=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(m,m))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(u=this.redirectUser)==null?void 0:u._redirectEventId,m=i==null?void 0:i._redirectEventId,g=await this.tryRedirectSignIn(e);(!c||c===m)&&(g!=null&&g.user)&&(i=g.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return We(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Dh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=wk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fs(this.app))return Promise.reject(el(this));const t=e?Hn(e):null;return t&&We(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&We(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fs(this.app)?Promise.reject(el(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fs(this.app)?Promise.reject(el(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($o(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Bk(this),t=new qk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Fc("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await Vk(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&$o(e)||this._popupRedirectResolver;We(t,this,"argument-error"),this.redirectPersistenceManager=await ru.create(this,[$o(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let c=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(We(m,this,"internal-error"),m.then(()=>{c||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,r);return()=>{c=!0,g()}}else{const g=e.addObserver(t);return()=>{c=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return We(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(Fs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&vk(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function rf(n){return Hn(n)}class xE{constructor(e){this.auth=e,this.observer=null,this.addObserver=aD(t=>this.observer=t)}get next(){return We(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ug={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Gk(n){Ug=n}function jk(n){return Ug.loadJS(n)}function Zk(){return Ug.gapiScript}function Kk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yk(n,e){const t=Mg(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),u=t.getOptions();if(il(u,e??{}))return r;Eo(r,"already-initialized")}return t.initialize({options:e})}function Jk(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map($o);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function Wk(n,e,t){const i=rf(n);We(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,u=fS(e),{host:c,port:m}=Qk(e),g=m===null?"":`:${m}`,p={url:`${u}//${c}${g}/`},x=Object.freeze({host:c,port:m,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){We(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),We(il(p,i.config.emulator)&&il(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,Su(c)?(Hw(`${u}//${c}${g}`),Gw("Auth",!0)):Xk()}function fS(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Qk(n){const e=fS(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const u=r[1];return{host:u,port:wE(i.substr(u.length+1))}}else{const[u,c]=i.split(":");return{host:u,port:wE(c)}}}function wE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Xk(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mS{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Xo("not implemented")}_getIdTokenResponse(e){return Xo("not implemented")}_linkToIdToken(e,t){return Xo("not implemented")}_getReauthenticationResolver(e){return Xo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function au(n,e){return bk(n,"POST","/v1/accounts:signInWithIdp",Lg(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $k="http://localhost";class ol extends mS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ol(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Eo("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...u}=t;if(!i||!r)return null;const c=new ol(i,r);return c.idToken=u.idToken||void 0,c.accessToken=u.accessToken||void 0,c.secret=u.secret,c.nonce=u.nonce,c.pendingToken=u.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return au(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,au(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,au(e,t)}buildRequest(){const e={requestUri:$k,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=qc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc extends zg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr extends Gc{constructor(){super("facebook.com")}static credential(e){return ol._fromParams({providerId:Yr.PROVIDER_ID,signInMethod:Yr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yr.credentialFromTaggedObject(e)}static credentialFromError(e){return Yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yr.credential(e.oauthAccessToken)}catch{return null}}}Yr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Yr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo extends Gc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ol._fromParams({providerId:Qo.PROVIDER_ID,signInMethod:Qo.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Qo.credentialFromTaggedObject(e)}static credentialFromError(e){return Qo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Qo.credential(t,i)}catch{return null}}}Qo.GOOGLE_SIGN_IN_METHOD="google.com";Qo.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends Gc{constructor(){super("github.com")}static credential(e){return ol._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Jr.credential(e.oauthAccessToken)}catch{return null}}}Jr.GITHUB_SIGN_IN_METHOD="github.com";Jr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends Gc{constructor(){super("twitter.com")}static credential(e,t){return ol._fromParams({providerId:Wr.PROVIDER_ID,signInMethod:Wr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wr.credentialFromTaggedObject(e)}static credentialFromError(e){return Wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Wr.credential(t,i)}catch{return null}}}Wr.TWITTER_SIGN_IN_METHOD="twitter.com";Wr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const u=await qs._fromIdTokenResponse(e,i,r),c=SE(i);return new hu({user:u,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=SE(i);return new hu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function SE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh extends lr{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,kh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new kh(e,t,i,r)}}function pS(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?kh._fromErrorAndOperation(n,u,e,i):u})}async function eL(n,e,t=!1){const i=await Dc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return hu._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tL(n,e,t=!1){const{auth:i}=n;if(Fs(i.app))return Promise.reject(el(i));const r="reauthenticate";try{const u=await Dc(n,pS(i,r,e,n),t);We(u.idToken,i,"internal-error");const c=Vg(u.idToken);We(c,i,"internal-error");const{sub:m}=c;return We(n.uid===m,i,"user-mismatch"),hu._forOperation(n,r,u)}catch(u){throw(u==null?void 0:u.code)==="auth/user-not-found"&&Eo(i,"user-mismatch"),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nL(n,e,t=!1){if(Fs(n.app))return Promise.reject(el(n));const i="signIn",r=await pS(n,i,e),u=await hu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(u.user),u}function iL(n,e,t,i){return Hn(n).onIdTokenChanged(e,t,i)}function sL(n,e,t){return Hn(n).beforeAuthStateChanged(e,t)}function oL(n,e,t,i){return Hn(n).onAuthStateChanged(e,t,i)}function rL(n){return Hn(n).signOut()}const Lh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Lh,"1"),this.storage.removeItem(Lh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL=1e3,lL=10;class _S extends gS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,m,g)=>{this.notifyListeners(c,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},u=this.storage.getItem(i);Uk()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,lL):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},aL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}_S.type="LOCAL";const uL=_S;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS extends gS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}yS.type="SESSION";const vS=yS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cL(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new af(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:u}=t.data,c=this.handlersMap[r];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const m=Array.from(c).map(async p=>p(t.origin,u)),g=await cL(m);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}af.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let u,c;return new Promise((m,g)=>{const p=Bg("",20);r.port1.start();const x=setTimeout(()=>{g(new Error("unsupported_event"))},i);c={messageChannel:r,onMessage(A){const b=A;if(b.data.eventId===p)switch(b.data.status){case"ack":clearTimeout(x),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),m(b.data.response);break;default:clearTimeout(x),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(c),r.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[r.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function go(){return window}function hL(n){go().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TS(){return typeof go().WorkerGlobalScope<"u"&&typeof go().importScripts=="function"}async function fL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function mL(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function pL(){return TS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES="firebaseLocalStorageDb",gL=1,Vh="firebaseLocalStorage",xS="fbase_key";class jc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function lf(n,e){return n.transaction([Vh],e?"readwrite":"readonly").objectStore(Vh)}function _L(){const n=indexedDB.deleteDatabase(ES);return new jc(n).toPromise()}function jp(){const n=indexedDB.open(ES,gL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Vh,{keyPath:xS})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Vh)?e(i):(i.close(),await _L(),e(await jp()))})})}async function AE(n,e,t){const i=lf(n,!0).put({[xS]:e,value:t});return new jc(i).toPromise()}async function yL(n,e){const t=lf(n,!1).get(e),i=await new jc(t).toPromise();return i===void 0?null:i.value}function CE(n,e){const t=lf(n,!0).delete(e);return new jc(t).toPromise()}const vL=800,TL=3;class wS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await jp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>TL)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return TS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=af._getInstance(pL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await fL(),!this.activeServiceWorker)return;this.sender=new dL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||mL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jp();return await AE(e,Lh,"1"),await CE(e,Lh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>AE(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>yL(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>CE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const u=lf(r,!1).getAll();return new jc(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:u}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(u)&&(this.notifyListeners(r,u),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),vL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wS.type="LOCAL";const EL=wS;new Hc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(n,e){return e?$o(e):(We(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg extends mS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return au(e,this._buildIdpRequest())}_linkToIdToken(e,t){return au(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return au(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function xL(n){return nL(n.auth,new Fg(n),n.bypassAuthState)}function wL(n){const{auth:e,user:t}=n;return We(t,e,"internal-error"),tL(t,new Fg(n),n.bypassAuthState)}async function SL(n){const{auth:e,user:t}=n;return We(t,e,"internal-error"),eL(t,new Fg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,t,i,r,u=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:u,error:c,type:m}=e;if(c){this.reject(c);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(g))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return xL;case"linkViaPopup":case"linkViaRedirect":return SL;case"reauthViaPopup":case"reauthViaRedirect":return wL;default:Eo(this.auth,"internal-error")}}resolve(e){ir(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ir(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AL=new Hc(2e3,1e4);async function CL(n,e,t){if(Fs(n.app))return Promise.reject(Hs(n,"operation-not-supported-in-this-environment"));const i=rf(n);Tk(n,e,zg);const r=SS(i,t);return new Xa(i,"signInViaPopup",e,r).executeNotNull()}class Xa extends AS{constructor(e,t,i,r,u){super(e,t,r,u),this.provider=i,this.authWindow=null,this.pollId=null,Xa.currentPopupAction&&Xa.currentPopupAction.cancel(),Xa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return We(e,this.auth,"internal-error"),e}async onExecution(){ir(this.filter.length===1,"Popup operations only handle one event");const e=Bg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Hs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Hs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Xa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Hs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,AL.get())};e()}}Xa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL="pendingRedirect",gh=new Map;class IL extends AS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=gh.get(this.auth._key());if(!e){try{const i=await NL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}gh.set(this.auth._key(),e)}return this.bypassAuthState||gh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function NL(n,e){const t=PL(e),i=ML(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function RL(n,e){gh.set(n._key(),e)}function ML(n){return $o(n._redirectPersistence)}function PL(n){return ph(bL,n.config.apiKey,n.name)}async function DL(n,e,t=!1){if(Fs(n.app))return Promise.reject(el(n));const i=rf(n),r=SS(i,e),c=await new IL(i,r,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kL=600*1e3;class LL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!VL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!CS(e)){const r=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Hs(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=kL&&this.cachedEventUids.clear(),this.cachedEventUids.has(bE(e))}saveEventToCache(e){this.cachedEventUids.add(bE(e)),this.lastProcessedEventTime=Date.now()}}function bE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function CS({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function VL(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return CS(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OL(n,e={}){return Cu(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zL=/^https?/;async function BL(n){if(n.config.emulator)return;const{authorizedDomains:e}=await OL(n);for(const t of e)try{if(FL(t))return}catch{}Eo(n,"unauthorized-domain")}function FL(n){const e=Hp(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!zL.test(t))return!1;if(UL.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL=new Hc(3e4,6e4);function IE(){const n=go().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function HL(n){return new Promise((e,t)=>{var r,u,c;function i(){IE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{IE(),t(Hs(n,"network-request-failed"))},timeout:qL.get()})}if((u=(r=go().gapi)==null?void 0:r.iframes)!=null&&u.Iframe)e(gapi.iframes.getContext());else if((c=go().gapi)!=null&&c.load)i();else{const m=Kk("iframefcb");return go()[m]=()=>{gapi.load?i():t(Hs(n,"network-request-failed"))},jk(`${Zk()}?onload=${m}`).catch(g=>t(g))}}).catch(e=>{throw _h=null,e})}let _h=null;function GL(n){return _h=_h||HL(n),_h}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL=new Hc(5e3,15e3),ZL="__/auth/iframe",KL="emulator/auth/iframe",YL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},JL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function WL(n){const e=n.config;We(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?kg(e,KL):`https://${n.config.authDomain}/${ZL}`,i={apiKey:e.apiKey,appName:n.name,v:Au},r=JL.get(n.config.apiHost);r&&(i.eid=r);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${qc(i).slice(1)}`}async function QL(n){const e=await GL(n),t=go().gapi;return We(t,n,"internal-error"),e.open({where:document.body,url:WL(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:YL,dontclear:!0},i=>new Promise(async(r,u)=>{await i.restyle({setHideOnLeave:!1});const c=Hs(n,"network-request-failed"),m=go().setTimeout(()=>{u(c)},jL.get());function g(){go().clearTimeout(m),r(i)}i.ping(g).then(g,()=>{u(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$L=500,e4=600,t4="_blank",n4="http://localhost";class NE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function i4(n,e,t,i=$L,r=e4){const u=Math.max((window.screen.availHeight-r)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let m="";const g={...XL,width:i.toString(),height:r.toString(),top:u,left:c},p=li().toLowerCase();t&&(m=rS(p)?t4:t),sS(p)&&(e=e||n4,g.scrollbars="yes");const x=Object.entries(g).reduce((b,[M,K])=>`${b}${M}=${K},`,"");if(Ok(p)&&m!=="_self")return s4(e||"",m),new NE(null);const A=window.open(e||"",m,x);We(A,n,"popup-blocked");try{A.focus()}catch{}return new NE(A)}function s4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4="__/auth/handler",r4="emulator/auth/handler",a4=encodeURIComponent("fac");async function RE(n,e,t,i,r,u){We(n.config.authDomain,n,"auth-domain-config-required"),We(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Au,eventId:r};if(e instanceof zg){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",rD(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,A]of Object.entries({}))c[x]=A}if(e instanceof Gc){const x=e.getScopes().filter(A=>A!=="");x.length>0&&(c.scopes=x.join(","))}n.tenantId&&(c.tid=n.tenantId);const m=c;for(const x of Object.keys(m))m[x]===void 0&&delete m[x];const g=await n._getAppCheckToken(),p=g?`#${a4}=${encodeURIComponent(g)}`:"";return`${l4(n)}?${qc(m).slice(1)}${p}`}function l4({config:n}){return n.emulator?kg(n,r4):`https://${n.authDomain}/${o4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp="webStorageSupport";class u4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vS,this._completeRedirectFn=DL,this._overrideRedirectResult=RL}async _openPopup(e,t,i,r){var c;ir((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const u=await RE(e,t,i,Hp(),r);return i4(e,u,Bg())}async _openRedirect(e,t,i,r){await this._originValidation(e);const u=await RE(e,t,i,Hp(),r);return hL(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:u}=this.eventManagers[t];return r?Promise.resolve(r):(ir(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await QL(e),i=new LL(e);return t.register("authEvent",r=>(We(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Tp,{type:Tp},r=>{var c;const u=(c=r==null?void 0:r[0])==null?void 0:c[Tp];u!==void 0&&t(!!u),Eo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=BL(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return dS()||oS()||Og()}}const c4=u4;var ME="@firebase/auth",PE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){We(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function f4(n){du(new sl("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:c,authDomain:m}=i.options;We(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:c,authDomain:m,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hS(n)},p=new Hk(i,r,u,g);return Jk(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),du(new sl("auth-internal",e=>{const t=rf(e.getProvider("auth").getImmediate());return(i=>new d4(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ta(ME,PE,h4(n)),ta(ME,PE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=300,p4=qw("authIdTokenMaxAge")||m4;let DE=null;const g4=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>p4)return;const r=t==null?void 0:t.token;DE!==r&&(DE=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function _4(n=Yw()){const e=Mg(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Yk(n,{popupRedirectResolver:c4,persistence:[EL,uL,vS]}),i=qw("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const c=g4(u.toString());sL(t,c,()=>c(t.currentUser)),iL(t,m=>c(m))}}const r=Bw("auth");return r&&Wk(t,`http://${r}`),t}function y4(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}Gk({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const u=Hs("internal-error");u.customData=r,t(u)},i.type="text/javascript",i.charset="UTF-8",y4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});f4("Browser");var v4="firebase",T4="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ta(v4,T4,"app");var kE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var na,bS;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(V,O){function U(){}U.prototype=O.prototype,V.F=O.prototype,V.prototype=new U,V.prototype.constructor=V,V.D=function(H,F,Y){for(var B=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)B[Ke-2]=arguments[Ke];return O.prototype[F].apply(H,B)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(V,O,U){U||(U=0);const H=Array(16);if(typeof O=="string")for(var F=0;F<16;++F)H[F]=O.charCodeAt(U++)|O.charCodeAt(U++)<<8|O.charCodeAt(U++)<<16|O.charCodeAt(U++)<<24;else for(F=0;F<16;++F)H[F]=O[U++]|O[U++]<<8|O[U++]<<16|O[U++]<<24;O=V.g[0],U=V.g[1],F=V.g[2];let Y=V.g[3],B;B=O+(Y^U&(F^Y))+H[0]+3614090360&4294967295,O=U+(B<<7&4294967295|B>>>25),B=Y+(F^O&(U^F))+H[1]+3905402710&4294967295,Y=O+(B<<12&4294967295|B>>>20),B=F+(U^Y&(O^U))+H[2]+606105819&4294967295,F=Y+(B<<17&4294967295|B>>>15),B=U+(O^F&(Y^O))+H[3]+3250441966&4294967295,U=F+(B<<22&4294967295|B>>>10),B=O+(Y^U&(F^Y))+H[4]+4118548399&4294967295,O=U+(B<<7&4294967295|B>>>25),B=Y+(F^O&(U^F))+H[5]+1200080426&4294967295,Y=O+(B<<12&4294967295|B>>>20),B=F+(U^Y&(O^U))+H[6]+2821735955&4294967295,F=Y+(B<<17&4294967295|B>>>15),B=U+(O^F&(Y^O))+H[7]+4249261313&4294967295,U=F+(B<<22&4294967295|B>>>10),B=O+(Y^U&(F^Y))+H[8]+1770035416&4294967295,O=U+(B<<7&4294967295|B>>>25),B=Y+(F^O&(U^F))+H[9]+2336552879&4294967295,Y=O+(B<<12&4294967295|B>>>20),B=F+(U^Y&(O^U))+H[10]+4294925233&4294967295,F=Y+(B<<17&4294967295|B>>>15),B=U+(O^F&(Y^O))+H[11]+2304563134&4294967295,U=F+(B<<22&4294967295|B>>>10),B=O+(Y^U&(F^Y))+H[12]+1804603682&4294967295,O=U+(B<<7&4294967295|B>>>25),B=Y+(F^O&(U^F))+H[13]+4254626195&4294967295,Y=O+(B<<12&4294967295|B>>>20),B=F+(U^Y&(O^U))+H[14]+2792965006&4294967295,F=Y+(B<<17&4294967295|B>>>15),B=U+(O^F&(Y^O))+H[15]+1236535329&4294967295,U=F+(B<<22&4294967295|B>>>10),B=O+(F^Y&(U^F))+H[1]+4129170786&4294967295,O=U+(B<<5&4294967295|B>>>27),B=Y+(U^F&(O^U))+H[6]+3225465664&4294967295,Y=O+(B<<9&4294967295|B>>>23),B=F+(O^U&(Y^O))+H[11]+643717713&4294967295,F=Y+(B<<14&4294967295|B>>>18),B=U+(Y^O&(F^Y))+H[0]+3921069994&4294967295,U=F+(B<<20&4294967295|B>>>12),B=O+(F^Y&(U^F))+H[5]+3593408605&4294967295,O=U+(B<<5&4294967295|B>>>27),B=Y+(U^F&(O^U))+H[10]+38016083&4294967295,Y=O+(B<<9&4294967295|B>>>23),B=F+(O^U&(Y^O))+H[15]+3634488961&4294967295,F=Y+(B<<14&4294967295|B>>>18),B=U+(Y^O&(F^Y))+H[4]+3889429448&4294967295,U=F+(B<<20&4294967295|B>>>12),B=O+(F^Y&(U^F))+H[9]+568446438&4294967295,O=U+(B<<5&4294967295|B>>>27),B=Y+(U^F&(O^U))+H[14]+3275163606&4294967295,Y=O+(B<<9&4294967295|B>>>23),B=F+(O^U&(Y^O))+H[3]+4107603335&4294967295,F=Y+(B<<14&4294967295|B>>>18),B=U+(Y^O&(F^Y))+H[8]+1163531501&4294967295,U=F+(B<<20&4294967295|B>>>12),B=O+(F^Y&(U^F))+H[13]+2850285829&4294967295,O=U+(B<<5&4294967295|B>>>27),B=Y+(U^F&(O^U))+H[2]+4243563512&4294967295,Y=O+(B<<9&4294967295|B>>>23),B=F+(O^U&(Y^O))+H[7]+1735328473&4294967295,F=Y+(B<<14&4294967295|B>>>18),B=U+(Y^O&(F^Y))+H[12]+2368359562&4294967295,U=F+(B<<20&4294967295|B>>>12),B=O+(U^F^Y)+H[5]+4294588738&4294967295,O=U+(B<<4&4294967295|B>>>28),B=Y+(O^U^F)+H[8]+2272392833&4294967295,Y=O+(B<<11&4294967295|B>>>21),B=F+(Y^O^U)+H[11]+1839030562&4294967295,F=Y+(B<<16&4294967295|B>>>16),B=U+(F^Y^O)+H[14]+4259657740&4294967295,U=F+(B<<23&4294967295|B>>>9),B=O+(U^F^Y)+H[1]+2763975236&4294967295,O=U+(B<<4&4294967295|B>>>28),B=Y+(O^U^F)+H[4]+1272893353&4294967295,Y=O+(B<<11&4294967295|B>>>21),B=F+(Y^O^U)+H[7]+4139469664&4294967295,F=Y+(B<<16&4294967295|B>>>16),B=U+(F^Y^O)+H[10]+3200236656&4294967295,U=F+(B<<23&4294967295|B>>>9),B=O+(U^F^Y)+H[13]+681279174&4294967295,O=U+(B<<4&4294967295|B>>>28),B=Y+(O^U^F)+H[0]+3936430074&4294967295,Y=O+(B<<11&4294967295|B>>>21),B=F+(Y^O^U)+H[3]+3572445317&4294967295,F=Y+(B<<16&4294967295|B>>>16),B=U+(F^Y^O)+H[6]+76029189&4294967295,U=F+(B<<23&4294967295|B>>>9),B=O+(U^F^Y)+H[9]+3654602809&4294967295,O=U+(B<<4&4294967295|B>>>28),B=Y+(O^U^F)+H[12]+3873151461&4294967295,Y=O+(B<<11&4294967295|B>>>21),B=F+(Y^O^U)+H[15]+530742520&4294967295,F=Y+(B<<16&4294967295|B>>>16),B=U+(F^Y^O)+H[2]+3299628645&4294967295,U=F+(B<<23&4294967295|B>>>9),B=O+(F^(U|~Y))+H[0]+4096336452&4294967295,O=U+(B<<6&4294967295|B>>>26),B=Y+(U^(O|~F))+H[7]+1126891415&4294967295,Y=O+(B<<10&4294967295|B>>>22),B=F+(O^(Y|~U))+H[14]+2878612391&4294967295,F=Y+(B<<15&4294967295|B>>>17),B=U+(Y^(F|~O))+H[5]+4237533241&4294967295,U=F+(B<<21&4294967295|B>>>11),B=O+(F^(U|~Y))+H[12]+1700485571&4294967295,O=U+(B<<6&4294967295|B>>>26),B=Y+(U^(O|~F))+H[3]+2399980690&4294967295,Y=O+(B<<10&4294967295|B>>>22),B=F+(O^(Y|~U))+H[10]+4293915773&4294967295,F=Y+(B<<15&4294967295|B>>>17),B=U+(Y^(F|~O))+H[1]+2240044497&4294967295,U=F+(B<<21&4294967295|B>>>11),B=O+(F^(U|~Y))+H[8]+1873313359&4294967295,O=U+(B<<6&4294967295|B>>>26),B=Y+(U^(O|~F))+H[15]+4264355552&4294967295,Y=O+(B<<10&4294967295|B>>>22),B=F+(O^(Y|~U))+H[6]+2734768916&4294967295,F=Y+(B<<15&4294967295|B>>>17),B=U+(Y^(F|~O))+H[13]+1309151649&4294967295,U=F+(B<<21&4294967295|B>>>11),B=O+(F^(U|~Y))+H[4]+4149444226&4294967295,O=U+(B<<6&4294967295|B>>>26),B=Y+(U^(O|~F))+H[11]+3174756917&4294967295,Y=O+(B<<10&4294967295|B>>>22),B=F+(O^(Y|~U))+H[2]+718787259&4294967295,F=Y+(B<<15&4294967295|B>>>17),B=U+(Y^(F|~O))+H[9]+3951481745&4294967295,V.g[0]=V.g[0]+O&4294967295,V.g[1]=V.g[1]+(F+(B<<21&4294967295|B>>>11))&4294967295,V.g[2]=V.g[2]+F&4294967295,V.g[3]=V.g[3]+Y&4294967295}i.prototype.v=function(V,O){O===void 0&&(O=V.length);const U=O-this.blockSize,H=this.C;let F=this.h,Y=0;for(;Y<O;){if(F==0)for(;Y<=U;)r(this,V,Y),Y+=this.blockSize;if(typeof V=="string"){for(;Y<O;)if(H[F++]=V.charCodeAt(Y++),F==this.blockSize){r(this,H),F=0;break}}else for(;Y<O;)if(H[F++]=V[Y++],F==this.blockSize){r(this,H),F=0;break}}this.h=F,this.o+=O},i.prototype.A=function(){var V=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);V[0]=128;for(var O=1;O<V.length-8;++O)V[O]=0;O=this.o*8;for(var U=V.length-8;U<V.length;++U)V[U]=O&255,O/=256;for(this.v(V),V=Array(16),O=0,U=0;U<4;++U)for(let H=0;H<32;H+=8)V[O++]=this.g[U]>>>H&255;return V};function u(V,O){var U=m;return Object.prototype.hasOwnProperty.call(U,V)?U[V]:U[V]=O(V)}function c(V,O){this.h=O;const U=[];let H=!0;for(let F=V.length-1;F>=0;F--){const Y=V[F]|0;H&&Y==O||(U[F]=Y,H=!1)}this.g=U}var m={};function g(V){return-128<=V&&V<128?u(V,function(O){return new c([O|0],O<0?-1:0)}):new c([V|0],V<0?-1:0)}function p(V){if(isNaN(V)||!isFinite(V))return A;if(V<0)return z(p(-V));const O=[];let U=1;for(let H=0;V>=U;H++)O[H]=V/U|0,U*=4294967296;return new c(O,0)}function x(V,O){if(V.length==0)throw Error("number format error: empty string");if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(V.charAt(0)=="-")return z(x(V.substring(1),O));if(V.indexOf("-")>=0)throw Error('number format error: interior "-" character');const U=p(Math.pow(O,8));let H=A;for(let Y=0;Y<V.length;Y+=8){var F=Math.min(8,V.length-Y);const B=parseInt(V.substring(Y,Y+F),O);F<8?(F=p(Math.pow(O,F)),H=H.j(F).add(p(B))):(H=H.j(U),H=H.add(p(B)))}return H}var A=g(0),b=g(1),M=g(16777216);n=c.prototype,n.m=function(){if(G(this))return-z(this).m();let V=0,O=1;for(let U=0;U<this.g.length;U++){const H=this.i(U);V+=(H>=0?H:4294967296+H)*O,O*=4294967296}return V},n.toString=function(V){if(V=V||10,V<2||36<V)throw Error("radix out of range: "+V);if(K(this))return"0";if(G(this))return"-"+z(this).toString(V);const O=p(Math.pow(V,6));var U=this;let H="";for(;;){const F=me(U,O).g;U=W(U,F.j(O));let Y=((U.g.length>0?U.g[0]:U.h)>>>0).toString(V);if(U=F,K(U))return Y+H;for(;Y.length<6;)Y="0"+Y;H=Y+H}},n.i=function(V){return V<0?0:V<this.g.length?this.g[V]:this.h};function K(V){if(V.h!=0)return!1;for(let O=0;O<V.g.length;O++)if(V.g[O]!=0)return!1;return!0}function G(V){return V.h==-1}n.l=function(V){return V=W(this,V),G(V)?-1:K(V)?0:1};function z(V){const O=V.g.length,U=[];for(let H=0;H<O;H++)U[H]=~V.g[H];return new c(U,~V.h).add(b)}n.abs=function(){return G(this)?z(this):this},n.add=function(V){const O=Math.max(this.g.length,V.g.length),U=[];let H=0;for(let F=0;F<=O;F++){let Y=H+(this.i(F)&65535)+(V.i(F)&65535),B=(Y>>>16)+(this.i(F)>>>16)+(V.i(F)>>>16);H=B>>>16,Y&=65535,B&=65535,U[F]=B<<16|Y}return new c(U,U[U.length-1]&-2147483648?-1:0)};function W(V,O){return V.add(z(O))}n.j=function(V){if(K(this)||K(V))return A;if(G(this))return G(V)?z(this).j(z(V)):z(z(this).j(V));if(G(V))return z(this.j(z(V)));if(this.l(M)<0&&V.l(M)<0)return p(this.m()*V.m());const O=this.g.length+V.g.length,U=[];for(var H=0;H<2*O;H++)U[H]=0;for(H=0;H<this.g.length;H++)for(let F=0;F<V.g.length;F++){const Y=this.i(H)>>>16,B=this.i(H)&65535,Ke=V.i(F)>>>16,mt=V.i(F)&65535;U[2*H+2*F]+=B*mt,te(U,2*H+2*F),U[2*H+2*F+1]+=Y*mt,te(U,2*H+2*F+1),U[2*H+2*F+1]+=B*Ke,te(U,2*H+2*F+1),U[2*H+2*F+2]+=Y*Ke,te(U,2*H+2*F+2)}for(V=0;V<O;V++)U[V]=U[2*V+1]<<16|U[2*V];for(V=O;V<2*O;V++)U[V]=0;return new c(U,0)};function te(V,O){for(;(V[O]&65535)!=V[O];)V[O+1]+=V[O]>>>16,V[O]&=65535,O++}function Q(V,O){this.g=V,this.h=O}function me(V,O){if(K(O))throw Error("division by zero");if(K(V))return new Q(A,A);if(G(V))return O=me(z(V),O),new Q(z(O.g),z(O.h));if(G(O))return O=me(V,z(O)),new Q(z(O.g),O.h);if(V.g.length>30){if(G(V)||G(O))throw Error("slowDivide_ only works with positive integers.");for(var U=b,H=O;H.l(V)<=0;)U=de(U),H=de(H);var F=fe(U,1),Y=fe(H,1);for(H=fe(H,2),U=fe(U,2);!K(H);){var B=Y.add(H);B.l(V)<=0&&(F=F.add(U),Y=B),H=fe(H,1),U=fe(U,1)}return O=W(V,F.j(O)),new Q(F,O)}for(F=A;V.l(O)>=0;){for(U=Math.max(1,Math.floor(V.m()/O.m())),H=Math.ceil(Math.log(U)/Math.LN2),H=H<=48?1:Math.pow(2,H-48),Y=p(U),B=Y.j(O);G(B)||B.l(V)>0;)U-=H,Y=p(U),B=Y.j(O);K(Y)&&(Y=b),F=F.add(Y),V=W(V,B)}return new Q(F,V)}n.B=function(V){return me(this,V).h},n.and=function(V){const O=Math.max(this.g.length,V.g.length),U=[];for(let H=0;H<O;H++)U[H]=this.i(H)&V.i(H);return new c(U,this.h&V.h)},n.or=function(V){const O=Math.max(this.g.length,V.g.length),U=[];for(let H=0;H<O;H++)U[H]=this.i(H)|V.i(H);return new c(U,this.h|V.h)},n.xor=function(V){const O=Math.max(this.g.length,V.g.length),U=[];for(let H=0;H<O;H++)U[H]=this.i(H)^V.i(H);return new c(U,this.h^V.h)};function de(V){const O=V.g.length+1,U=[];for(let H=0;H<O;H++)U[H]=V.i(H)<<1|V.i(H-1)>>>31;return new c(U,V.h)}function fe(V,O){const U=O>>5;O%=32;const H=V.g.length-U,F=[];for(let Y=0;Y<H;Y++)F[Y]=O>0?V.i(Y+U)>>>O|V.i(Y+U+1)<<32-O:V.i(Y+U);return new c(F,V.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,bS=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=x,na=c}).apply(typeof kE<"u"?kE:typeof self<"u"?self:typeof window<"u"?window:{});var rh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var IS,Ec,NS,yh,Zp,RS,MS,PS;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof rh=="object"&&rh];for(var C=0;C<y.length;++C){var R=y[C];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var i=t(this);function r(y,C){if(C)e:{var R=i;y=y.split(".");for(var k=0;k<y.length-1;k++){var ne=y[k];if(!(ne in R))break e;R=R[ne]}y=y[y.length-1],k=R[y],C=C(k),C!=k&&C!=null&&e(R,y,{configurable:!0,writable:!0,value:C})}}r("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(y){return y||function(C){var R=[],k;for(k in C)Object.prototype.hasOwnProperty.call(C,k)&&R.push([k,C[k]]);return R}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},c=this||self;function m(y){var C=typeof y;return C=="object"&&y!=null||C=="function"}function g(y,C,R){return y.call.apply(y.bind,arguments)}function p(y,C,R){return p=g,p.apply(null,arguments)}function x(y,C){var R=Array.prototype.slice.call(arguments,1);return function(){var k=R.slice();return k.push.apply(k,arguments),y.apply(this,k)}}function A(y,C){function R(){}R.prototype=C.prototype,y.Z=C.prototype,y.prototype=new R,y.prototype.constructor=y,y.Ob=function(k,ne,le){for(var Ie=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)Ie[Je-2]=arguments[Je];return C.prototype[ne].apply(k,Ie)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function M(y){const C=y.length;if(C>0){const R=Array(C);for(let k=0;k<C;k++)R[k]=y[k];return R}return[]}function K(y,C){for(let k=1;k<arguments.length;k++){const ne=arguments[k];var R=typeof ne;if(R=R!="object"?R:ne?Array.isArray(ne)?"array":R:"null",R=="array"||R=="object"&&typeof ne.length=="number"){R=y.length||0;const le=ne.length||0;y.length=R+le;for(let Ie=0;Ie<le;Ie++)y[R+Ie]=ne[Ie]}else y.push(ne)}}class G{constructor(C,R){this.i=C,this.j=R,this.h=0,this.g=null}get(){let C;return this.h>0?(this.h--,C=this.g,this.g=C.next,C.next=null):C=this.i(),C}}function z(y){c.setTimeout(()=>{throw y},0)}function W(){var y=V;let C=null;return y.g&&(C=y.g,y.g=y.g.next,y.g||(y.h=null),C.next=null),C}class te{constructor(){this.h=this.g=null}add(C,R){const k=Q.get();k.set(C,R),this.h?this.h.next=k:this.g=k,this.h=k}}var Q=new G(()=>new me,y=>y.reset());class me{constructor(){this.next=this.g=this.h=null}set(C,R){this.h=C,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let de,fe=!1,V=new te,O=()=>{const y=Promise.resolve(void 0);de=()=>{y.then(U)}};function U(){for(var y;y=W();){try{y.h.call(y.g)}catch(R){z(R)}var C=Q;C.j(y),C.h<100&&(C.h++,y.next=C.g,C.g=y)}fe=!1}function H(){this.u=this.u,this.C=this.C}H.prototype.u=!1,H.prototype.dispose=function(){this.u||(this.u=!0,this.N())},H.prototype[Symbol.dispose]=function(){this.dispose()},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(y,C){this.type=y,this.g=this.target=C,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var Y=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var y=!1,C=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const R=()=>{};c.addEventListener("test",R,C),c.removeEventListener("test",R,C)}catch{}return y})();function B(y){return/^[\s\xa0]*$/.test(y)}function Ke(y,C){F.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,C)}A(Ke,F),Ke.prototype.init=function(y,C){const R=this.type=y.type,k=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=C,C=y.relatedTarget,C||(R=="mouseover"?C=y.fromElement:R=="mouseout"&&(C=y.toElement)),this.relatedTarget=C,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&Ke.Z.h.call(this)},Ke.prototype.h=function(){Ke.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var mt="closure_listenable_"+(Math.random()*1e6|0),oe=0;function Ae(y,C,R,k,ne){this.listener=y,this.proxy=null,this.src=C,this.type=R,this.capture=!!k,this.ha=ne,this.key=++oe,this.da=this.fa=!1}function we(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function Qe(y,C,R){for(const k in y)C.call(R,y[k],k,y)}function Ne(y,C){for(const R in y)C.call(void 0,y[R],R,y)}function j(y){const C={};for(const R in y)C[R]=y[R];return C}const he="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ce(y,C){let R,k;for(let ne=1;ne<arguments.length;ne++){k=arguments[ne];for(R in k)y[R]=k[R];for(let le=0;le<he.length;le++)R=he[le],Object.prototype.hasOwnProperty.call(k,R)&&(y[R]=k[R])}}function ue(y){this.src=y,this.g={},this.h=0}ue.prototype.add=function(y,C,R,k,ne){const le=y.toString();y=this.g[le],y||(y=this.g[le]=[],this.h++);const Ie=Se(y,C,k,ne);return Ie>-1?(C=y[Ie],R||(C.fa=!1)):(C=new Ae(C,this.src,le,!!k,ne),C.fa=R,y.push(C)),C};function ge(y,C){const R=C.type;if(R in y.g){var k=y.g[R],ne=Array.prototype.indexOf.call(k,C,void 0),le;(le=ne>=0)&&Array.prototype.splice.call(k,ne,1),le&&(we(C),y.g[R].length==0&&(delete y.g[R],y.h--))}}function Se(y,C,R,k){for(let ne=0;ne<y.length;++ne){const le=y[ne];if(!le.da&&le.listener==C&&le.capture==!!R&&le.ha==k)return ne}return-1}var be="closure_lm_"+(Math.random()*1e6|0),Me={};function ke(y,C,R,k,ne){if(Array.isArray(C)){for(let le=0;le<C.length;le++)ke(y,C[le],R,k,ne);return null}return R=Nn(R),y&&y[mt]?y.J(C,R,m(k)?!!k.capture:!1,ne):it(y,C,R,!1,k,ne)}function it(y,C,R,k,ne,le){if(!C)throw Error("Invalid event type");const Ie=m(ne)?!!ne.capture:!!ne;let Je=In(y);if(Je||(y[be]=Je=new ue(y)),R=Je.add(C,R,k,Ie,le),R.proxy)return R;if(k=ut(),R.proxy=k,k.src=y,k.listener=R,y.addEventListener)Y||(ne=Ie),ne===void 0&&(ne=!1),y.addEventListener(C.toString(),k,ne);else if(y.attachEvent)y.attachEvent(gn(C.toString()),k);else if(y.addListener&&y.removeListener)y.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return R}function ut(){function y(R){return C.call(y.src,y.listener,R)}const C=Vi;return y}function je(y,C,R,k,ne){if(Array.isArray(C))for(var le=0;le<C.length;le++)je(y,C[le],R,k,ne);else k=m(k)?!!k.capture:!!k,R=Nn(R),y&&y[mt]?(y=y.i,le=String(C).toString(),le in y.g&&(C=y.g[le],R=Se(C,R,k,ne),R>-1&&(we(C[R]),Array.prototype.splice.call(C,R,1),C.length==0&&(delete y.g[le],y.h--)))):y&&(y=In(y))&&(C=y.g[C.toString()],y=-1,C&&(y=Se(C,R,k,ne)),(R=y>-1?C[y]:null)&&Ft(R))}function Ft(y){if(typeof y!="number"&&y&&!y.da){var C=y.src;if(C&&C[mt])ge(C.i,y);else{var R=y.type,k=y.proxy;C.removeEventListener?C.removeEventListener(R,k,y.capture):C.detachEvent?C.detachEvent(gn(R),k):C.addListener&&C.removeListener&&C.removeListener(k),(R=In(C))?(ge(R,y),R.h==0&&(R.src=null,C[be]=null)):we(y)}}}function gn(y){return y in Me?Me[y]:Me[y]="on"+y}function Vi(y,C){if(y.da)y=!0;else{C=new Ke(C,this);const R=y.listener,k=y.ha||y.src;y.fa&&Ft(y),y=R.call(k,C)}return y}function In(y){return y=y[be],y instanceof ue?y:null}var As="__closure_events_fn_"+(Math.random()*1e9>>>0);function Nn(y){return typeof y=="function"?y:(y[As]||(y[As]=function(C){return y.handleEvent(C)}),y[As])}function Kt(){H.call(this),this.i=new ue(this),this.M=this,this.G=null}A(Kt,H),Kt.prototype[mt]=!0,Kt.prototype.removeEventListener=function(y,C,R,k){je(this,y,C,R,k)};function Te(y,C){var R,k=y.G;if(k)for(R=[];k;k=k.G)R.push(k);if(y=y.M,k=C.type||C,typeof C=="string")C=new F(C,y);else if(C instanceof F)C.target=C.target||y;else{var ne=C;C=new F(k,y),Ce(C,ne)}ne=!0;let le,Ie;if(R)for(Ie=R.length-1;Ie>=0;Ie--)le=C.g=R[Ie],ne=Fe(le,k,!0,C)&&ne;if(le=C.g=y,ne=Fe(le,k,!0,C)&&ne,ne=Fe(le,k,!1,C)&&ne,R)for(Ie=0;Ie<R.length;Ie++)le=C.g=R[Ie],ne=Fe(le,k,!1,C)&&ne}Kt.prototype.N=function(){if(Kt.Z.N.call(this),this.i){var y=this.i;for(const C in y.g){const R=y.g[C];for(let k=0;k<R.length;k++)we(R[k]);delete y.g[C],y.h--}}this.G=null},Kt.prototype.J=function(y,C,R,k){return this.i.add(String(y),C,!1,R,k)},Kt.prototype.K=function(y,C,R,k){return this.i.add(String(y),C,!0,R,k)};function Fe(y,C,R,k){if(C=y.i.g[String(C)],!C)return!0;C=C.concat();let ne=!0;for(let le=0;le<C.length;++le){const Ie=C[le];if(Ie&&!Ie.da&&Ie.capture==R){const Je=Ie.listener,xt=Ie.ha||Ie.src;Ie.fa&&ge(y.i,Ie),ne=Je.call(xt,k)!==!1&&ne}}return ne&&!k.defaultPrevented}function Xe(y,C){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=p(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(C)>2147483647?-1:c.setTimeout(y,C||0)}function Ot(y){y.g=Xe(()=>{y.g=null,y.i&&(y.i=!1,Ot(y))},y.l);const C=y.h;y.h=null,y.m.apply(null,C)}class pt extends H{constructor(C,R){super(),this.m=C,this.l=R,this.h=null,this.i=!1,this.g=null}j(C){this.h=arguments,this.g?this.i=!0:Ot(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _n(y){H.call(this),this.h=y,this.g={}}A(_n,H);var is=[];function Ks(y){Qe(y.g,function(C,R){this.g.hasOwnProperty(R)&&Ft(C)},y),y.g={}}_n.prototype.N=function(){_n.Z.N.call(this),Ks(this)},_n.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Rn=c.JSON.stringify,Co=c.JSON.parse,ma=class{stringify(y){return c.JSON.stringify(y,void 0)}parse(y){return c.JSON.parse(y,void 0)}};function pa(){}function dl(){}var gi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function hn(){F.call(this,"d")}A(hn,F);function ui(){F.call(this,"c")}A(ui,F);var tn={},Ys=null;function ur(){return Ys=Ys||new Kt}tn.Ia="serverreachability";function hl(y){F.call(this,tn.Ia,y)}A(hl,F);function Oi(y){const C=ur();Te(C,new hl(C))}tn.STAT_EVENT="statevent";function Js(y,C){F.call(this,tn.STAT_EVENT,y),this.stat=C}A(Js,F);function nn(y){const C=ur();Te(C,new Js(C,y))}tn.Ja="timingevent";function ss(y,C){F.call(this,tn.Ja,y),this.size=C}A(ss,F);function os(y,C){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){y()},C)}function Ui(){this.g=!0}Ui.prototype.ua=function(){this.g=!1};function Pu(y,C,R,k,ne,le){y.info(function(){if(y.g)if(le){var Ie="",Je=le.split("&");for(let wt=0;wt<Je.length;wt++){var xt=Je[wt].split("=");if(xt.length>1){const Ht=xt[0];xt=xt[1];const Si=Ht.split("_");Ie=Si.length>=2&&Si[1]=="type"?Ie+(Ht+"="+xt+"&"):Ie+(Ht+"=redacted&")}}}else Ie=null;else Ie=le;return"XMLHTTP REQ ("+k+") [attempt "+ne+"]: "+C+`
`+R+`
`+Ie})}function fl(y,C,R,k,ne,le,Ie){y.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+ne+"]: "+C+`
`+R+`
`+le+" "+Ie})}function rs(y,C,R,k){y.info(function(){return"XMLHTTP TEXT ("+C+"): "+Du(y,R)+(k?" "+k:"")})}function Cs(y,C){y.info(function(){return"TIMEOUT: "+C})}Ui.prototype.info=function(){};function Du(y,C){if(!y.g)return C;if(!C)return null;try{const le=JSON.parse(C);if(le){for(y=0;y<le.length;y++)if(Array.isArray(le[y])){var R=le[y];if(!(R.length<2)){var k=R[1];if(Array.isArray(k)&&!(k.length<1)){var ne=k[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(let Ie=1;Ie<k.length;Ie++)k[Ie]=""}}}}return Rn(le)}catch{return C}}var bo={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ga={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},_a;function kn(){}A(kn,pa),kn.prototype.g=function(){return new XMLHttpRequest},_a=new kn;function Oe(y){return encodeURIComponent(String(y))}function ya(y){var C=1;y=y.split(":");const R=[];for(;C>0&&y.length;)R.push(y.shift()),C--;return y.length&&R.push(y.join(":")),R}function _i(y,C,R,k){this.j=y,this.i=C,this.l=R,this.S=k||1,this.V=new _n(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new yi}function yi(){this.i=null,this.g="",this.h=!1}var sn={},an={};function zi(y,C,R){y.M=1,y.A=Dt(Yt(C)),y.u=R,y.R=!0,Bi(y,null)}function Bi(y,C){y.F=Date.now(),as(y),y.B=Yt(y.A);var R=y.B,k=y.S;Array.isArray(k)||(k=[String(k)]),Qs(R.i,"t",k),y.C=0,R=y.j.L,y.h=new yi,y.g=Aa(y.j,R?C:null,!y.u),y.P>0&&(y.O=new pt(p(y.Y,y,y.g),y.P)),C=y.V,R=y.g,k=y.ba;var ne="readystatechange";Array.isArray(ne)||(ne&&(is[0]=ne.toString()),ne=is);for(let le=0;le<ne.length;le++){const Ie=ke(R,ne[le],k||C.handleEvent,!1,C.h||C);if(!Ie)break;C.g[Ie.key]=Ie}C=y.J?j(y.J):{},y.u?(y.v||(y.v="POST"),C["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,C)):(y.v="GET",y.g.ea(y.B,y.v,null,C)),Oi(),Pu(y.i,y.v,y.B,y.l,y.S,y.u)}_i.prototype.ba=function(y){y=y.target;const C=this.O;C&&Gi(y)==3?C.j():this.Y(y)},_i.prototype.Y=function(y){try{if(y==this.g)e:{const Je=Gi(this.g),xt=this.g.ya(),wt=this.g.ca();if(!(Je<3)&&(Je!=3||this.g&&(this.h.h||this.g.la()||vn(this.g)))){this.K||Je!=4||xt==7||(xt==8||wt<=0?Oi(3):Oi(2)),Fi(this);var C=this.g.ca();this.X=C;var R=ml(this);if(this.o=C==200,fl(this.i,this.v,this.B,this.l,this.S,Je,C),this.o){if(this.U&&!this.L){t:{if(this.g){var k,ne=this.g;if((k=ne.g?ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(k)){var le=k;break t}}le=null}if(y=le)rs(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ls(this,y);else{this.o=!1,this.m=3,nn(12),Ln(this),vi(this);break e}}if(this.R){y=!0;let Ht;for(;!this.K&&this.C<R.length;)if(Ht=gl(this,R),Ht==an){Je==4&&(this.m=4,nn(14),y=!1),rs(this.i,this.l,null,"[Incomplete Response]");break}else if(Ht==sn){this.m=4,nn(15),rs(this.i,this.l,R,"[Invalid Chunk]"),y=!1;break}else rs(this.i,this.l,Ht,null),ls(this,Ht);if(pl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Je!=4||R.length!=0||this.h.h||(this.m=1,nn(16),y=!1),this.o=this.o&&y,!y)rs(this.i,this.l,R,"[Invalid Chunked Response]"),Ln(this),vi(this);else if(R.length>0&&!this.W){this.W=!0;var Ie=this.j;Ie.g==this&&Ie.aa&&!Ie.P&&(Ie.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),wa(Ie),Ie.P=!0,nn(11))}}else rs(this.i,this.l,R,null),ls(this,R);Je==4&&Ln(this),this.o&&!this.K&&(Je==4?hi(this.j,this):(this.o=!1,as(this)))}else ji(this.g),C==400&&R.indexOf("Unknown SID")>0?(this.m=3,nn(12)):(this.m=0,nn(13)),Ln(this),vi(this)}}}catch{}finally{}};function ml(y){if(!pl(y))return y.g.la();const C=vn(y.g);if(C==="")return"";let R="";const k=C.length,ne=Gi(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return Ln(y),vi(y),"";y.h.i=new c.TextDecoder}for(let le=0;le<k;le++)y.h.h=!0,R+=y.h.i.decode(C[le],{stream:!(ne&&le==k-1)});return C.length=0,y.h.g+=R,y.C=0,y.h.g}function pl(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function gl(y,C){var R=y.C,k=C.indexOf(`
`,R);return k==-1?an:(R=Number(C.substring(R,k)),isNaN(R)?sn:(k+=1,k+R>C.length?an:(C=C.slice(k,k+R),y.C=k+R,C)))}_i.prototype.cancel=function(){this.K=!0,Ln(this)};function as(y){y.T=Date.now()+y.H,cr(y,y.H)}function cr(y,C){if(y.D!=null)throw Error("WatchDog timer not null");y.D=os(p(y.aa,y),C)}function Fi(y){y.D&&(c.clearTimeout(y.D),y.D=null)}_i.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(Cs(this.i,this.B),this.M!=2&&(Oi(),nn(17)),Ln(this),this.m=2,vi(this)):cr(this,this.T-y)};function vi(y){y.j.I==0||y.K||hi(y.j,y)}function Ln(y){Fi(y);var C=y.O;C&&typeof C.dispose=="function"&&C.dispose(),y.O=null,Ks(y.V),y.g&&(C=y.g,y.g=null,C.abort(),C.dispose())}function ls(y,C){try{var R=y.j;if(R.I!=0&&(R.g==y||Ti(R.h,y))){if(!y.L&&Ti(R.h,y)&&R.I==3){try{var k=R.Ba.g.parse(C)}catch{k=null}if(Array.isArray(k)&&k.length==3){var ne=k;if(ne[0]==0){e:if(!R.v){if(R.g)if(R.g.F+3e3<y.F)_r(R),to(R);else break e;Do(R),nn(18)}}else R.xa=ne[1],0<R.xa-R.K&&ne[2]<37500&&R.F&&R.A==0&&!R.C&&(R.C=os(p(R.Va,R),6e3));us(R.h)<=1&&R.ta&&(R.ta=void 0)}else Zi(R,11)}else if((y.L||R.g==y)&&_r(R),!B(C))for(ne=R.Ba.g.parse(C),C=0;C<ne.length;C++){let wt=ne[C];const Ht=wt[0];if(!(Ht<=R.K))if(R.K=Ht,wt=wt[1],R.I==2)if(wt[0]=="c"){R.M=wt[1],R.ba=wt[2];const Si=wt[3];Si!=null&&(R.ka=Si,R.j.info("VER="+R.ka));const Ai=wt[4];Ai!=null&&(R.za=Ai,R.j.info("SVER="+R.za));const fi=wt[5];fi!=null&&typeof fi=="number"&&fi>0&&(k=1.5*fi,R.O=k,R.j.info("backChannelRequestTimeoutMs_="+k)),k=R;const Yi=y.g;if(Yi){const ko=Yi.g?Yi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ko){var le=k.h;le.g||ko.indexOf("spdy")==-1&&ko.indexOf("quic")==-1&&ko.indexOf("h2")==-1||(le.j=le.l,le.g=new Set,le.h&&(bs(le,le.h),le.h=null))}if(k.G){const Lo=Yi.g?Yi.g.getResponseHeader("X-HTTP-Session-Id"):null;Lo&&(k.wa=Lo,De(k.J,k.G,Lo))}}R.I=3,R.l&&R.l.ra(),R.aa&&(R.T=Date.now()-y.F,R.j.info("Handshake RTT: "+R.T+"ms")),k=R;var Ie=y;if(k.na=Sa(k,k.L?k.ba:null,k.W),Ie.L){dr(k.h,Ie);var Je=Ie,xt=k.O;xt&&(Je.H=xt),Je.D&&(Fi(Je),as(Je)),k.g=Ie}else xa(k);R.i.length>0&&$n(R)}else wt[0]!="stop"&&wt[0]!="close"||Zi(R,7);else R.I==3&&(wt[0]=="stop"||wt[0]=="close"?wt[0]=="stop"?Zi(R,7):at(R):wt[0]!="noop"&&R.l&&R.l.qa(wt),R.A=0)}}Oi(4)}catch{}}var ln=class{constructor(y,C){this.g=y,this.map=C}};function va(y){this.l=y||10,c.PerformanceNavigationTiming?(y=c.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ta(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function us(y){return y.h?1:y.g?y.g.size:0}function Ti(y,C){return y.h?y.h==C:y.g?y.g.has(C):!1}function bs(y,C){y.g?y.g.add(C):y.h=C}function dr(y,C){y.h&&y.h==C?y.h=null:y.g&&y.g.has(C)&&y.g.delete(C)}va.prototype.cancel=function(){if(this.i=hr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function hr(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let C=y.i;for(const R of y.g.values())C=C.concat(R.G);return C}return M(y.i)}var Ws=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lt(y,C){if(y){y=y.split("&");for(let R=0;R<y.length;R++){const k=y[R].indexOf("=");let ne,le=null;k>=0?(ne=y[R].substring(0,k),le=y[R].substring(k+1)):ne=y[R],C(ne,le?decodeURIComponent(le.replace(/\+/g," ")):"")}}}function ct(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let C;y instanceof ct?(this.l=y.l,Jt(this,y.j),this.o=y.o,this.g=y.g,ci(this,y.u),this.h=y.h,Io(this,Mo(y.i)),this.m=y.m):y&&(C=String(y).match(Ws))?(this.l=!1,Jt(this,C[1]||"",!0),this.o=Ei(C[2]||""),this.g=Ei(C[3]||"",!0),ci(this,C[4]),this.h=Ei(C[5]||"",!0),Io(this,C[6]||"",!0),this.m=Ei(C[7]||"")):(this.l=!1,this.i=new xi(null,this.l))}ct.prototype.toString=function(){const y=[];var C=this.j;C&&y.push(cs(C,fr,!0),":");var R=this.g;return(R||C=="file")&&(y.push("//"),(C=this.o)&&y.push(cs(C,fr,!0),"@"),y.push(Oe(R).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.u,R!=null&&y.push(":",String(R))),(R=this.h)&&(this.g&&R.charAt(0)!="/"&&y.push("/"),y.push(cs(R,R.charAt(0)=="/"?qi:No,!0))),(R=this.i.toString())&&y.push("?",R),(R=this.m)&&y.push("#",cs(R,ds)),y.join("")},ct.prototype.resolve=function(y){const C=Yt(this);let R=!!y.j;R?Jt(C,y.j):R=!!y.o,R?C.o=y.o:R=!!y.g,R?C.g=y.g:R=y.u!=null;var k=y.h;if(R)ci(C,y.u);else if(R=!!y.h){if(k.charAt(0)!="/")if(this.g&&!this.h)k="/"+k;else{var ne=C.h.lastIndexOf("/");ne!=-1&&(k=C.h.slice(0,ne+1)+k)}if(ne=k,ne==".."||ne==".")k="";else if(ne.indexOf("./")!=-1||ne.indexOf("/.")!=-1){k=ne.lastIndexOf("/",0)==0,ne=ne.split("/");const le=[];for(let Ie=0;Ie<ne.length;){const Je=ne[Ie++];Je=="."?k&&Ie==ne.length&&le.push(""):Je==".."?((le.length>1||le.length==1&&le[0]!="")&&le.pop(),k&&Ie==ne.length&&le.push("")):(le.push(Je),k=!0)}k=le.join("/")}else k=ne}return R?C.h=k:R=y.i.toString()!=="",R?Io(C,Mo(y.i)):R=!!y.m,R&&(C.m=y.m),C};function Yt(y){return new ct(y)}function Jt(y,C,R){y.j=R?Ei(C,!0):C,y.j&&(y.j=y.j.replace(/:$/,""))}function ci(y,C){if(C){if(C=Number(C),isNaN(C)||C<0)throw Error("Bad port number "+C);y.u=C}else y.u=null}function Io(y,C,R){C instanceof xi?(y.i=C,Xs(y.i,y.l)):(R||(C=cs(C,kt)),y.i=new xi(C,y.l))}function De(y,C,R){y.i.set(C,R)}function Dt(y){return De(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function Ei(y,C){return y?C?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function cs(y,C,R){return typeof y=="string"?(y=encodeURI(y).replace(C,qt),R&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function qt(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var fr=/[#\/\?@]/g,No=/[#\?:]/g,qi=/[#\?]/g,kt=/[#\?@]/g,ds=/#/g;function xi(y,C){this.h=this.g=null,this.i=y||null,this.j=!!C}function yn(y){y.g||(y.g=new Map,y.h=0,y.i&&lt(y.i,function(C,R){y.add(decodeURIComponent(C.replace(/\+/g," ")),R)}))}n=xi.prototype,n.add=function(y,C){yn(this),this.i=null,y=hs(this,y);let R=this.g.get(y);return R||this.g.set(y,R=[]),R.push(C),this.h+=1,this};function mr(y,C){yn(y),C=hs(y,C),y.g.has(C)&&(y.i=null,y.h-=y.g.get(C).length,y.g.delete(C))}function Is(y,C){return yn(y),C=hs(y,C),y.g.has(C)}n.forEach=function(y,C){yn(this),this.g.forEach(function(R,k){R.forEach(function(ne){y.call(C,ne,k,this)},this)},this)};function Ro(y,C){yn(y);let R=[];if(typeof C=="string")Is(y,C)&&(R=R.concat(y.g.get(hs(y,C))));else for(y=Array.from(y.g.values()),C=0;C<y.length;C++)R=R.concat(y[C]);return R}n.set=function(y,C){return yn(this),this.i=null,y=hs(this,y),Is(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[C]),this.h+=1,this},n.get=function(y,C){return y?(y=Ro(this,y),y.length>0?String(y[0]):C):C};function Qs(y,C,R){mr(y,C),R.length>0&&(y.i=null,y.g.set(hs(y,C),M(R)),y.h+=R.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],C=Array.from(this.g.keys());for(let k=0;k<C.length;k++){var R=C[k];const ne=Oe(R);R=Ro(this,R);for(let le=0;le<R.length;le++){let Ie=ne;R[le]!==""&&(Ie+="="+Oe(R[le])),y.push(Ie)}}return this.i=y.join("&")};function Mo(y){const C=new xi;return C.i=y.i,y.g&&(C.g=new Map(y.g),C.h=y.h),C}function hs(y,C){return C=String(C),y.j&&(C=C.toLowerCase()),C}function Xs(y,C){C&&!y.j&&(yn(y),y.i=null,y.g.forEach(function(R,k){const ne=k.toLowerCase();k!=ne&&(mr(this,k),Qs(this,ne,R))},y)),y.j=C}function Wn(y,C){const R=new Ui;if(c.Image){const k=new Image;k.onload=x(Qn,R,"TestLoadImage: loaded",!0,C,k),k.onerror=x(Qn,R,"TestLoadImage: error",!1,C,k),k.onabort=x(Qn,R,"TestLoadImage: abort",!1,C,k),k.ontimeout=x(Qn,R,"TestLoadImage: timeout",!1,C,k),c.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=y}else C(!1)}function pr(y,C){const R=new Ui,k=new AbortController,ne=setTimeout(()=>{k.abort(),Qn(R,"TestPingServer: timeout",!1,C)},1e4);fetch(y,{signal:k.signal}).then(le=>{clearTimeout(ne),le.ok?Qn(R,"TestPingServer: ok",!0,C):Qn(R,"TestPingServer: server error",!1,C)}).catch(()=>{clearTimeout(ne),Qn(R,"TestPingServer: error",!1,C)})}function Qn(y,C,R,k,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),k(R)}catch{}}function $s(){this.g=new ma}function Ge(y){this.i=y.Sb||null,this.h=y.ab||!1}A(Ge,pa),Ge.prototype.g=function(){return new Vn(this.i,this.h)};function Vn(y,C){Kt.call(this),this.H=y,this.o=C,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}A(Vn,Kt),n=Vn.prototype,n.open=function(y,C){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=C,this.readyState=1,di(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const C={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(C.body=y),(this.H||c).fetch(new Request(this.D,C)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ns(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,di(this)),this.g&&(this.readyState=3,di(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;At(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function At(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var C=y.value?y.value:new Uint8Array(0);(C=this.B.decode(C,{stream:!y.done}))&&(this.response=this.responseText+=C)}y.done?Ns(this):di(this),this.readyState==3&&At(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,Ns(this))},n.Na=function(y){this.g&&(this.response=y,Ns(this))},n.ga=function(){this.g&&Ns(this)};function Ns(y){y.readyState=4,y.l=null,y.j=null,y.B=null,di(y)}n.setRequestHeader=function(y,C){this.A.append(y,C)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],C=this.h.entries();for(var R=C.next();!R.done;)R=R.value,y.push(R[0]+": "+R[1]),R=C.next();return y.join(`\r
`)};function di(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Vn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Xn(y){let C="";return Qe(y,function(R,k){C+=k,C+=":",C+=R,C+=`\r
`}),C}function Rs(y,C,R){e:{for(k in R){var k=!1;break e}k=!0}k||(R=Xn(R),typeof y=="string"?R!=null&&Oe(R):De(y,C,R))}function gt(y){Kt.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}A(gt,Kt);var wi=/^https?$/i,Ms=["POST","PUT"];n=gt.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,C,R,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);C=C?C.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():_a.g(),this.g.onreadystatechange=b(p(this.Ca,this));try{this.B=!0,this.g.open(C,String(y),!0),this.B=!1}catch(le){Wt(this,le);return}if(y=R||"",R=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var ne in k)R.set(ne,k[ne]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const le of k.keys())R.set(le,k.get(le));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(R.keys()).find(le=>le.toLowerCase()=="content-type"),ne=c.FormData&&y instanceof c.FormData,!(Array.prototype.indexOf.call(Ms,C,void 0)>=0)||k||ne||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[le,Ie]of R)this.g.setRequestHeader(le,Ie);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(le){Wt(this,le)}};function Wt(y,C){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=C,y.o=5,Hi(y),fs(y)}function Hi(y){y.A||(y.A=!0,Te(y,"complete"),Te(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,Te(this,"complete"),Te(this,"abort"),fs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fs(this,!0)),gt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?eo(this):this.Xa())},n.Xa=function(){eo(this)};function eo(y){if(y.h&&typeof u<"u"){if(y.v&&Gi(y)==4)setTimeout(y.Ca.bind(y),0);else if(Te(y,"readystatechange"),Gi(y)==4){y.h=!1;try{const le=y.ca();e:switch(le){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var C=!0;break e;default:C=!1}var R;if(!(R=C)){var k;if(k=le===0){let Ie=String(y.D).match(Ws)[1]||null;!Ie&&c.self&&c.self.location&&(Ie=c.self.location.protocol.slice(0,-1)),k=!wi.test(Ie?Ie.toLowerCase():"")}R=k}if(R)Te(y,"complete"),Te(y,"success");else{y.o=6;try{var ne=Gi(y)>2?y.g.statusText:""}catch{ne=""}y.l=ne+" ["+y.ca()+"]",Hi(y)}}finally{fs(y)}}}}function fs(y,C){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const R=y.g;y.g=null,C||Te(y,"ready");try{R.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Gi(y){return y.g?y.g.readyState:0}n.ca=function(){try{return Gi(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var C=this.g.responseText;return y&&C.indexOf(y)==0&&(C=C.substring(y.length)),Co(C)}};function vn(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function ji(y){const C={};y=(y.g&&Gi(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<y.length;k++){if(B(y[k]))continue;var R=ya(y[k]);const ne=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const le=C[ne]||[];C[ne]=le,le.push(R)}Ne(C,function(k){return k.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ms(y,C,R){return R&&R.internalChannelParams&&R.internalChannelParams[y]||C}function Ps(y){this.za=0,this.i=[],this.j=new Ui,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ms("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ms("baseRetryDelayMs",5e3,y),this.Za=ms("retryDelaySeedMs",1e4,y),this.Ta=ms("forwardChannelMaxRetries",2,y),this.va=ms("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new va(y&&y.concurrentRequestLimit),this.Ba=new $s,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ps.prototype,n.ka=8,n.I=1,n.connect=function(y,C,R,k){nn(0),this.W=y,this.H=C||{},R&&k!==void 0&&(this.H.OSID=R,this.H.OAID=k),this.F=this.X,this.J=Sa(this,null,this.W),$n(this)};function at(y){if(On(y),y.I==3){var C=y.V++,R=Yt(y.J);if(De(R,"SID",y.M),De(R,"RID",C),De(R,"TYPE","terminate"),Ds(y,R),C=new _i(y,y.j,C),C.M=2,C.A=Dt(Yt(R)),R=!1,c.navigator&&c.navigator.sendBeacon)try{R=c.navigator.sendBeacon(C.A.toString(),"")}catch{}!R&&c.Image&&(new Image().src=C.A,R=!0),R||(C.g=Aa(C.j,null),C.g.ea(C.A)),C.F=Date.now(),as(C)}Ki(y)}function to(y){y.g&&(wa(y),y.g.cancel(),y.g=null)}function On(y){to(y),y.v&&(c.clearTimeout(y.v),y.v=null),_r(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&c.clearTimeout(y.m),y.m=null)}function $n(y){if(!Ta(y.h)&&!y.m){y.m=!0;var C=y.Ea;de||O(),fe||(de(),fe=!0),V.add(C,y),y.D=0}}function Po(y,C){return us(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=C.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=os(p(y.Ea,y,C),yl(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const ne=new _i(this,this.j,y);let le=this.o;if(this.U&&(le?(le=j(le),Ce(le,this.U)):le=this.U),this.u!==null||this.R||(ne.J=le,le=null),this.S)e:{for(var C=0,R=0;R<this.i.length;R++){t:{var k=this.i[R];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(C+=k,C>4096){C=R;break e}if(C===4096||R===this.i.length-1){C=R+1;break e}}C=1e3}else C=1e3;C=_l(this,ne,C),R=Yt(this.J),De(R,"RID",y),De(R,"CVER",22),this.G&&De(R,"X-HTTP-Session-Id",this.G),Ds(this,R),le&&(this.R?C="headers="+Oe(Xn(le))+"&"+C:this.u&&Rs(R,this.u,le)),bs(this.h,ne),this.Ra&&De(R,"TYPE","init"),this.S?(De(R,"$req",C),De(R,"SID","null"),ne.U=!0,zi(ne,R,null)):zi(ne,R,C),this.I=2}}else this.I==3&&(y?Ea(this,y):this.i.length==0||Ta(this.h)||Ea(this))};function Ea(y,C){var R;C?R=C.l:R=y.V++;const k=Yt(y.J);De(k,"SID",y.M),De(k,"RID",R),De(k,"AID",y.K),Ds(y,k),y.u&&y.o&&Rs(k,y.u,y.o),R=new _i(y,y.j,R,y.D+1),y.u===null&&(R.J=y.o),C&&(y.i=C.G.concat(y.i)),C=_l(y,R,1e3),R.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),bs(y.h,R),zi(R,k,C)}function Ds(y,C){y.H&&Qe(y.H,function(R,k){De(C,k,R)}),y.l&&Qe({},function(R,k){De(C,k,R)})}function _l(y,C,R){R=Math.min(y.i.length,R);const k=y.l?p(y.l.Ka,y.l,y):null;e:{var ne=y.i;let Je=-1;for(;;){const xt=["count="+R];Je==-1?R>0?(Je=ne[0].g,xt.push("ofs="+Je)):Je=0:xt.push("ofs="+Je);let wt=!0;for(let Ht=0;Ht<R;Ht++){var le=ne[Ht].g;const Si=ne[Ht].map;if(le-=Je,le<0)Je=Math.max(0,ne[Ht].g-100),wt=!1;else try{le="req"+le+"_"||"";try{var Ie=Si instanceof Map?Si:Object.entries(Si);for(const[Ai,fi]of Ie){let Yi=fi;m(fi)&&(Yi=Rn(fi)),xt.push(le+Ai+"="+encodeURIComponent(Yi))}}catch(Ai){throw xt.push(le+"type="+encodeURIComponent("_badmap")),Ai}}catch{k&&k(Si)}}if(wt){Ie=xt.join("&");break e}}Ie=void 0}return y=y.i.splice(0,R),C.G=y,Ie}function xa(y){if(!y.g&&!y.v){y.Y=1;var C=y.Da;de||O(),fe||(de(),fe=!0),V.add(C,y),y.A=0}}function Do(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=os(p(y.Da,y),yl(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,gr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=os(p(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,nn(10),to(this),gr(this))};function wa(y){y.B!=null&&(c.clearTimeout(y.B),y.B=null)}function gr(y){y.g=new _i(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var C=Yt(y.na);De(C,"RID","rpc"),De(C,"SID",y.M),De(C,"AID",y.K),De(C,"CI",y.F?"0":"1"),!y.F&&y.ia&&De(C,"TO",y.ia),De(C,"TYPE","xmlhttp"),Ds(y,C),y.u&&y.o&&Rs(C,y.u,y.o),y.O&&(y.g.H=y.O);var R=y.g;y=y.ba,R.M=1,R.A=Dt(Yt(C)),R.u=null,R.R=!0,Bi(R,y)}n.Va=function(){this.C!=null&&(this.C=null,to(this),Do(this),nn(19))};function _r(y){y.C!=null&&(c.clearTimeout(y.C),y.C=null)}function hi(y,C){var R=null;if(y.g==C){_r(y),wa(y),y.g=null;var k=2}else if(Ti(y.h,C))R=C.G,dr(y.h,C),k=1;else return;if(y.I!=0){if(C.o)if(k==1){R=C.u?C.u.length:0,C=Date.now()-C.F;var ne=y.D;k=ur(),Te(k,new ss(k,R)),$n(y)}else xa(y);else if(ne=C.m,ne==3||ne==0&&C.X>0||!(k==1&&Po(y,C)||k==2&&Do(y)))switch(R&&R.length>0&&(C=y.h,C.i=C.i.concat(R)),ne){case 1:Zi(y,5);break;case 4:Zi(y,10);break;case 3:Zi(y,6);break;default:Zi(y,2)}}}function yl(y,C){let R=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(R*=2),R*C}function Zi(y,C){if(y.j.info("Error code "+C),C==2){var R=p(y.bb,y),k=y.Ua;const ne=!k;k=new ct(k||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Jt(k,"https"),Dt(k),ne?Wn(k.toString(),R):pr(k.toString(),R)}else nn(2);y.I=0,y.l&&y.l.pa(C),Ki(y),On(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),nn(2)):(this.j.info("Failed to ping google.com"),nn(1))};function Ki(y){if(y.I=0,y.ja=[],y.l){const C=hr(y.h);(C.length!=0||y.i.length!=0)&&(K(y.ja,C),K(y.ja,y.i),y.h.i.length=0,M(y.i),y.i.length=0),y.l.oa()}}function Sa(y,C,R){var k=R instanceof ct?Yt(R):new ct(R);if(k.g!="")C&&(k.g=C+"."+k.g),ci(k,k.u);else{var ne=c.location;k=ne.protocol,C=C?C+"."+ne.hostname:ne.hostname,ne=+ne.port;const le=new ct(null);k&&Jt(le,k),C&&(le.g=C),ne&&ci(le,ne),R&&(le.h=R),k=le}return R=y.G,C=y.wa,R&&C&&De(k,R,C),De(k,"VER",y.ka),Ds(y,k),k}function Aa(y,C,R){if(C&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return C=y.Aa&&!y.ma?new gt(new Ge({ab:R})):new gt(y.ma),C.Fa(y.L),C}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function yr(){}n=yr.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function no(){}no.prototype.g=function(y,C){return new Un(y,C)};function Un(y,C){Kt.call(this),this.g=new Ps(C),this.l=y,this.h=C&&C.messageUrlParams||null,y=C&&C.messageHeaders||null,C&&C.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=C&&C.initMessageHeaders||null,C&&C.messageContentType&&(y?y["X-WebChannel-Content-Type"]=C.messageContentType:y={"X-WebChannel-Content-Type":C.messageContentType}),C&&C.sa&&(y?y["X-WebChannel-Client-Profile"]=C.sa:y={"X-WebChannel-Client-Profile":C.sa}),this.g.U=y,(y=C&&C.Qb)&&!B(y)&&(this.g.u=y),this.A=C&&C.supportsCrossDomainXhr||!1,this.v=C&&C.sendRawJson||!1,(C=C&&C.httpSessionIdParam)&&!B(C)&&(this.g.G=C,y=this.h,y!==null&&C in y&&(y=this.h,C in y&&delete y[C])),this.j=new ks(this)}A(Un,Kt),Un.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Un.prototype.close=function(){at(this.g)},Un.prototype.o=function(y){var C=this.g;if(typeof y=="string"){var R={};R.__data__=y,y=R}else this.v&&(R={},R.__data__=Rn(y),y=R);C.i.push(new ln(C.Ya++,y)),C.I==3&&$n(C)},Un.prototype.N=function(){this.g.l=null,delete this.j,at(this.g),delete this.g,Un.Z.N.call(this)};function Ca(y){hn.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var C=y.__sm__;if(C){e:{for(const R in C){y=R;break e}y=void 0}(this.i=y)&&(y=this.i,C=C!==null&&y in C?C[y]:void 0),this.data=C}else this.data=y}A(Ca,hn);function vl(){ui.call(this),this.status=1}A(vl,ui);function ks(y){this.g=y}A(ks,yr),ks.prototype.ra=function(){Te(this.g,"a")},ks.prototype.qa=function(y){Te(this.g,new Ca(y))},ks.prototype.pa=function(y){Te(this.g,new vl)},ks.prototype.oa=function(){Te(this.g,"b")},no.prototype.createWebChannel=no.prototype.g,Un.prototype.send=Un.prototype.o,Un.prototype.open=Un.prototype.m,Un.prototype.close=Un.prototype.close,PS=function(){return new no},MS=function(){return ur()},RS=tn,Zp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},bo.NO_ERROR=0,bo.TIMEOUT=8,bo.HTTP_ERROR=6,yh=bo,ga.COMPLETE="complete",NS=ga,dl.EventType=gi,gi.OPEN="a",gi.CLOSE="b",gi.ERROR="c",gi.MESSAGE="d",Kt.prototype.listen=Kt.prototype.J,Ec=dl,gt.prototype.listenOnce=gt.prototype.K,gt.prototype.getLastError=gt.prototype.Ha,gt.prototype.getLastErrorCode=gt.prototype.ya,gt.prototype.getStatus=gt.prototype.ca,gt.prototype.getResponseJson=gt.prototype.La,gt.prototype.getResponseText=gt.prototype.la,gt.prototype.send=gt.prototype.ea,gt.prototype.setWithCredentials=gt.prototype.Fa,IS=gt}).apply(typeof rh<"u"?rh:typeof self<"u"?self:typeof window<"u"?window:{});const LE="@firebase/firestore",VE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}si.UNAUTHENTICATED=new si(null),si.GOOGLE_CREDENTIALS=new si("google-credentials-uid"),si.FIRST_PARTY=new si("first-party-uid"),si.MOCK_USER=new si("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bu="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rl=new Ng("@firebase/firestore");function Ql(){return rl.logLevel}function Le(n,...e){if(rl.logLevel<=vt.DEBUG){const t=e.map(qg);rl.debug(`Firestore (${bu}): ${n}`,...t)}}function sr(n,...e){if(rl.logLevel<=vt.ERROR){const t=e.map(qg);rl.error(`Firestore (${bu}): ${n}`,...t)}}function fu(n,...e){if(rl.logLevel<=vt.WARN){const t=e.map(qg);rl.warn(`Firestore (${bu}): ${n}`,...t)}}function qg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,DS(n,i,t)}function DS(n,e,t){let i=`FIRESTORE (${bu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw sr(i),new Error(i)}function Pt(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||DS(e,r,i)}function nt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends lr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class E4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(si.UNAUTHENTICATED)))}shutdown(){}}class x4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class w4{constructor(e){this.t=e,this.currentUser=si.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Pt(this.o===void 0,42304);let i=this.i;const r=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new tl;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new tl,e.enqueueRetryable((()=>r(this.currentUser)))};const c=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await r(this.currentUser)}))},m=g=>{Le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((g=>m(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?m(g):(Le("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new tl)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Pt(typeof i.accessToken=="string",31837,{l:i}),new kS(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pt(e===null||typeof e=="string",2055,{h:e}),new si(e)}}class S4{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=si.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class A4{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new S4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(si.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class OE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class C4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Fs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Pt(this.o===void 0,3512);const i=u=>{u.error!=null&&Le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const c=u.token!==this.m;return this.m=u.token,Le("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const r=u=>{Le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>r(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?r(u):Le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new OE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Pt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new OE(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=b4(40);for(let u=0;u<r.length;++u)i.length<20&&r[u]<t&&(i+=e.charAt(r[u]%62))}return i}}function Tt(n,e){return n<e?-1:n>e?1:0}function Kp(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),u=e.charAt(i);if(r!==u)return Ep(r)===Ep(u)?Tt(r,u):Ep(r)?1:-1}return Tt(n.length,e.length)}const I4=55296,N4=57343;function Ep(n){const e=n.charCodeAt(0);return e>=I4&&e<=N4}function mu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UE="__name__";class mo{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ye(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ye(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return mo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof mo?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const u=mo.compareSegments(e.get(r),t.get(r));if(u!==0)return u}return Tt(e.length,t.length)}static compareSegments(e,t){const i=mo.isNumericId(e),r=mo.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?mo.extractNumericId(e).compare(mo.extractNumericId(t)):Kp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return na.fromString(e.substring(4,e.length-2))}}class Zt extends mo{construct(e,t,i){return new Zt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ve(Ee.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Zt(t)}static emptyPath(){return new Zt([])}}const R4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Yn extends mo{construct(e,t,i){return new Yn(e,t,i)}static isValidIdentifier(e){return R4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Yn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===UE}static keyField(){return new Yn([UE])}static fromServerFormat(e){const t=[];let i="",r=0;const u=()=>{if(i.length===0)throw new Ve(Ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;r<e.length;){const m=e[r];if(m==="\\"){if(r+1===e.length)throw new Ve(Ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[r+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ve(Ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,r+=2}else m==="`"?(c=!c,r++):m!=="."||c?(i+=m,r++):(u(),r++)}if(u(),c)throw new Ve(Ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Yn(t)}static emptyPath(){return new Yn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e){this.path=e}static fromPath(e){return new He(Zt.fromString(e))}static fromName(e){return new He(Zt.fromString(e).popFirst(5))}static empty(){return new He(Zt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Zt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Zt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new He(new Zt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(n,e,t){if(!t)throw new Ve(Ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function M4(n,e,t,i){if(e===!0&&i===!0)throw new Ve(Ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function zE(n){if(!He.isDocumentKey(n))throw new Ve(Ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function BE(n){if(He.isDocumentKey(n))throw new Ve(Ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function VS(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function uf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ye(12329,{type:typeof n})}function ia(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ve(Ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=uf(n);throw new Ve(Ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Zc(n,e){if(!VS(n))throw new Ve(Ee.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const c=n[i];if(r&&typeof c!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(u!==void 0&&c!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new Ve(Ee.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FE=-62135596800,qE=1e6;class $t{static now(){return $t.fromMillis(Date.now())}static fromDate(e){return $t.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*qE);return new $t(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ve(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ve(Ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<FE)throw new Ve(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(Ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/qE}_compareTo(e){return this.seconds===e.seconds?Tt(this.nanoseconds,e.nanoseconds):Tt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Zc(e,$t._jsonSchema))return new $t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-FE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$t._jsonSchemaVersion="firestore/timestamp/1.0",$t._jsonSchema={type:Cn("string",$t._jsonSchemaVersion),seconds:Cn("number"),nanoseconds:Cn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{static fromTimestamp(e){return new et(e)}static min(){return new et(new $t(0,0))}static max(){return new et(new $t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kc=-1;function P4(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=et.fromTimestamp(i===1e9?new $t(t+1,0):new $t(t,i));return new oa(r,He.empty(),e)}function D4(n){return new oa(n.readTime,n.key,kc)}class oa{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new oa(et.min(),He.empty(),kc)}static max(){return new oa(et.max(),He.empty(),kc)}}function k4(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=He.comparator(n.documentKey,e.documentKey),t!==0?t:Tt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class V4{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Iu(n){if(n.code!==Ee.FAILED_PRECONDITION||n.message!==L4)throw n;Le("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new xe(((i,r)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,r)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof xe?t:xe.resolve(t)}catch(t){return xe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):xe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):xe.reject(t)}static resolve(e){return new xe(((t,i)=>{t(e)}))}static reject(e){return new xe(((t,i)=>{i(e)}))}static waitFor(e){return new xe(((t,i)=>{let r=0,u=0,c=!1;e.forEach((m=>{++r,m.next((()=>{++u,c&&u===r&&t()}),(g=>i(g)))})),c=!0,u===r&&t()}))}static or(e){let t=xe.resolve(!1);for(const i of e)t=t.next((r=>r?xe.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,u)=>{i.push(t.call(this,r,u))})),this.waitFor(i)}static mapArray(e,t){return new xe(((i,r)=>{const u=e.length,c=new Array(u);let m=0;for(let g=0;g<u;g++){const p=g;t(e[p]).next((x=>{c[p]=x,++m,m===u&&i(c)}),(x=>r(x)))}}))}static doWhile(e,t){return new xe(((i,r)=>{const u=()=>{e()===!0?t().next((()=>{u()}),r):i()};u()}))}}function O4(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Nu(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}cf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg=-1;function df(n){return n==null}function Oh(n){return n===0&&1/n==-1/0}function U4(n){return typeof n=="number"&&Number.isInteger(n)&&!Oh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS="";function z4(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=HE(e)),e=B4(n.get(t),e);return HE(e)}function B4(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const u=n.charAt(r);switch(u){case"\0":t+="";break;case OS:t+="";break;default:t+=u}}return t}function HE(n){return n+OS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ha(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function US(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,t){this.comparator=e,this.root=t||Kn.EMPTY}insert(e,t){return new rn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Kn.BLACK,null,null))}remove(e){return new rn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Kn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ah(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ah(this.root,e,this.comparator,!1)}getReverseIterator(){return new ah(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ah(this.root,e,this.comparator,!0)}}class ah{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&r&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Kn{constructor(e,t,i,r,u){this.key=e,this.value=t,this.color=i??Kn.RED,this.left=r??Kn.EMPTY,this.right=u??Kn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,u){return new Kn(e??this.key,t??this.value,i??this.color,r??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const u=i(e,r.key);return r=u<0?r.copy(null,null,null,r.left.insert(e,t,i),null):u===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Kn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Kn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Kn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Kn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ye(27949);return e+(this.isRed()?0:1)}}Kn.EMPTY=null,Kn.RED=!0,Kn.BLACK=!1;Kn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ye(57766)}get value(){throw Ye(16141)}get color(){throw Ye(16727)}get left(){throw Ye(29726)}get right(){throw Ye(36894)}copy(e,t,i,r,u){return this}insert(e,t,i){return new Kn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.comparator=e,this.data=new rn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new jE(this.data.getIterator())}getIteratorFrom(e){return new jE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof Dn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,u=i.getNext().key;if(this.comparator(r,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Dn(this.comparator);return t.data=e,t}}class jE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e){this.fields=e,e.sort(Yn.comparator)}static empty(){return new ts([])}unionWith(e){let t=new Dn(Yn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new ts(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return mu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new zS("Invalid base64 string: "+u):u}})(e);return new Jn(t)}static fromUint8Array(e){const t=(function(r){let u="";for(let c=0;c<r.length;++c)u+=String.fromCharCode(r[c]);return u})(e);return new Jn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Tt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jn.EMPTY_BYTE_STRING=new Jn("");const F4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ra(n){if(Pt(!!n,39018),typeof n=="string"){let e=0;const t=F4.exec(n);if(Pt(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:pn(n.seconds),nanos:pn(n.nanos)}}function pn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function aa(n){return typeof n=="string"?Jn.fromBase64String(n):Jn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS="server_timestamp",FS="__type__",qS="__previous_value__",HS="__local_write_time__";function jg(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[FS])==null?void 0:i.stringValue)===BS}function hf(n){const e=n.mapValue.fields[qS];return jg(e)?hf(e):e}function Lc(n){const e=ra(n.mapValue.fields[HS].timestampValue);return new $t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e,t,i,r,u,c,m,g,p,x){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=u,this.forceLongPolling=c,this.autoDetectLongPolling=m,this.longPollingOptions=g,this.useFetchStreams=p,this.isUsingEmulator=x}}const Uh="(default)";class Vc{constructor(e,t){this.projectId=e,this.database=t||Uh}static empty(){return new Vc("","")}get isDefaultDatabase(){return this.database===Uh}isEqual(e){return e instanceof Vc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="__type__",H4="__max__",lh={mapValue:{}},jS="__vector__",zh="value";function la(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?jg(n)?4:j4(n)?9007199254740991:G4(n)?10:11:Ye(28295,{value:n})}function xo(n,e){if(n===e)return!0;const t=la(n);if(t!==la(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Lc(n).isEqual(Lc(e));case 3:return(function(r,u){if(typeof r.timestampValue=="string"&&typeof u.timestampValue=="string"&&r.timestampValue.length===u.timestampValue.length)return r.timestampValue===u.timestampValue;const c=ra(r.timestampValue),m=ra(u.timestampValue);return c.seconds===m.seconds&&c.nanos===m.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,u){return aa(r.bytesValue).isEqual(aa(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,u){return pn(r.geoPointValue.latitude)===pn(u.geoPointValue.latitude)&&pn(r.geoPointValue.longitude)===pn(u.geoPointValue.longitude)})(n,e);case 2:return(function(r,u){if("integerValue"in r&&"integerValue"in u)return pn(r.integerValue)===pn(u.integerValue);if("doubleValue"in r&&"doubleValue"in u){const c=pn(r.doubleValue),m=pn(u.doubleValue);return c===m?Oh(c)===Oh(m):isNaN(c)&&isNaN(m)}return!1})(n,e);case 9:return mu(n.arrayValue.values||[],e.arrayValue.values||[],xo);case 10:case 11:return(function(r,u){const c=r.mapValue.fields||{},m=u.mapValue.fields||{};if(GE(c)!==GE(m))return!1;for(const g in c)if(c.hasOwnProperty(g)&&(m[g]===void 0||!xo(c[g],m[g])))return!1;return!0})(n,e);default:return Ye(52216,{left:n})}}function Oc(n,e){return(n.values||[]).find((t=>xo(t,e)))!==void 0}function pu(n,e){if(n===e)return 0;const t=la(n),i=la(e);if(t!==i)return Tt(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Tt(n.booleanValue,e.booleanValue);case 2:return(function(u,c){const m=pn(u.integerValue||u.doubleValue),g=pn(c.integerValue||c.doubleValue);return m<g?-1:m>g?1:m===g?0:isNaN(m)?isNaN(g)?0:-1:1})(n,e);case 3:return ZE(n.timestampValue,e.timestampValue);case 4:return ZE(Lc(n),Lc(e));case 5:return Kp(n.stringValue,e.stringValue);case 6:return(function(u,c){const m=aa(u),g=aa(c);return m.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,c){const m=u.split("/"),g=c.split("/");for(let p=0;p<m.length&&p<g.length;p++){const x=Tt(m[p],g[p]);if(x!==0)return x}return Tt(m.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,c){const m=Tt(pn(u.latitude),pn(c.latitude));return m!==0?m:Tt(pn(u.longitude),pn(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return KE(n.arrayValue,e.arrayValue);case 10:return(function(u,c){var b,M,K,G;const m=u.fields||{},g=c.fields||{},p=(b=m[zh])==null?void 0:b.arrayValue,x=(M=g[zh])==null?void 0:M.arrayValue,A=Tt(((K=p==null?void 0:p.values)==null?void 0:K.length)||0,((G=x==null?void 0:x.values)==null?void 0:G.length)||0);return A!==0?A:KE(p,x)})(n.mapValue,e.mapValue);case 11:return(function(u,c){if(u===lh.mapValue&&c===lh.mapValue)return 0;if(u===lh.mapValue)return 1;if(c===lh.mapValue)return-1;const m=u.fields||{},g=Object.keys(m),p=c.fields||{},x=Object.keys(p);g.sort(),x.sort();for(let A=0;A<g.length&&A<x.length;++A){const b=Kp(g[A],x[A]);if(b!==0)return b;const M=pu(m[g[A]],p[x[A]]);if(M!==0)return M}return Tt(g.length,x.length)})(n.mapValue,e.mapValue);default:throw Ye(23264,{he:t})}}function ZE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Tt(n,e);const t=ra(n),i=ra(e),r=Tt(t.seconds,i.seconds);return r!==0?r:Tt(t.nanos,i.nanos)}function KE(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const u=pu(t[r],i[r]);if(u)return u}return Tt(t.length,i.length)}function gu(n){return Yp(n)}function Yp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ra(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return aa(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return He.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const u of t.values||[])r?r=!1:i+=",",i+=Yp(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",u=!0;for(const c of i)u?u=!1:r+=",",r+=`${c}:${Yp(t.fields[c])}`;return r+"}"})(n.mapValue):Ye(61005,{value:n})}function vh(n){switch(la(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hf(n);return e?16+vh(e):16;case 5:return 2*n.stringValue.length;case 6:return aa(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,u)=>r+vh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return ha(i.fields,((u,c)=>{r+=u.length+vh(c)})),r})(n.mapValue);default:throw Ye(13486,{value:n})}}function YE(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Jp(n){return!!n&&"integerValue"in n}function Zg(n){return!!n&&"arrayValue"in n}function JE(n){return!!n&&"nullValue"in n}function WE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Th(n){return!!n&&"mapValue"in n}function G4(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[GS])==null?void 0:i.stringValue)===jS}function Ic(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ha(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Ic(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ic(n.arrayValue.values[t]);return e}return{...n}}function j4(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===H4}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e){this.value=e}static empty(){return new Li({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Th(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ic(t)}setAll(e){let t=Yn.emptyPath(),i={},r=[];e.forEach(((c,m)=>{if(!t.isImmediateParentOf(m)){const g=this.getFieldsMap(t);this.applyChanges(g,i,r),i={},r=[],t=m.popLast()}c?i[m.lastSegment()]=Ic(c):r.push(m.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,r)}delete(e){const t=this.field(e.popLast());Th(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return xo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Th(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){ha(t,((r,u)=>e[r]=u));for(const r of i)delete e[r]}clone(){return new Li(Ic(this.value))}}function ZS(n){const e=[];return ha(n.fields,((t,i)=>{const r=new Yn([t]);if(Th(i)){const u=ZS(i.mapValue).fields;if(u.length===0)e.push(r);else for(const c of u)e.push(r.child(c))}else e.push(r)})),new ts(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,t,i,r,u,c,m){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=u,this.data=c,this.documentState=m}static newInvalidDocument(e){return new oi(e,0,et.min(),et.min(),et.min(),Li.empty(),0)}static newFoundDocument(e,t,i,r){return new oi(e,1,t,et.min(),i,r,0)}static newNoDocument(e,t){return new oi(e,2,t,et.min(),et.min(),Li.empty(),0)}static newUnknownDocument(e,t){return new oi(e,3,t,et.min(),et.min(),Li.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(et.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Li.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Li.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof oi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new oi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e,t){this.position=e,this.inclusive=t}}function QE(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const u=e[r],c=n.position[r];if(u.field.isKeyField()?i=He.comparator(He.fromName(c.referenceValue),t.key):i=pu(c,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function XE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!xo(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t="asc"){this.field=e,this.dir=t}}function Z4(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{}class An extends KS{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Y4(e,t,i):t==="array-contains"?new Q4(e,i):t==="in"?new X4(e,i):t==="not-in"?new $4(e,i):t==="array-contains-any"?new e3(e,i):new An(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new J4(e,i):new W4(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(pu(t,this.value)):t!==null&&la(this.value)===la(t)&&this.matchesComparison(pu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class js extends KS{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new js(e,t)}matches(e){return YS(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function YS(n){return n.op==="and"}function JS(n){return K4(n)&&YS(n)}function K4(n){for(const e of n.filters)if(e instanceof js)return!1;return!0}function Wp(n){if(n instanceof An)return n.field.canonicalString()+n.op.toString()+gu(n.value);if(JS(n))return n.filters.map((e=>Wp(e))).join(",");{const e=n.filters.map((t=>Wp(t))).join(",");return`${n.op}(${e})`}}function WS(n,e){return n instanceof An?(function(i,r){return r instanceof An&&i.op===r.op&&i.field.isEqual(r.field)&&xo(i.value,r.value)})(n,e):n instanceof js?(function(i,r){return r instanceof js&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((u,c,m)=>u&&WS(c,r.filters[m])),!0):!1})(n,e):void Ye(19439)}function QS(n){return n instanceof An?(function(t){return`${t.field.canonicalString()} ${t.op} ${gu(t.value)}`})(n):n instanceof js?(function(t){return t.op.toString()+" {"+t.getFilters().map(QS).join(" ,")+"}"})(n):"Filter"}class Y4 extends An{constructor(e,t,i){super(e,t,i),this.key=He.fromName(i.referenceValue)}matches(e){const t=He.comparator(e.key,this.key);return this.matchesComparison(t)}}class J4 extends An{constructor(e,t){super(e,"in",t),this.keys=XS("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class W4 extends An{constructor(e,t){super(e,"not-in",t),this.keys=XS("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function XS(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>He.fromName(i.referenceValue)))}class Q4 extends An{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zg(t)&&Oc(t.arrayValue,this.value)}}class X4 extends An{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Oc(this.value.arrayValue,t)}}class $4 extends An{constructor(e,t){super(e,"not-in",t)}matches(e){if(Oc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Oc(this.value.arrayValue,t)}}class e3 extends An{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Oc(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(e,t=null,i=[],r=[],u=null,c=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=u,this.startAt=c,this.endAt=m,this.Te=null}}function $E(n,e=null,t=[],i=[],r=null,u=null,c=null){return new t3(n,e,t,i,r,u,c)}function Kg(n){const e=nt(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Wp(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),df(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>gu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>gu(i))).join(",")),e.Te=t}return e.Te}function Yg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Z4(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!WS(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!XE(n.startAt,e.startAt)&&XE(n.endAt,e.endAt)}function Qp(n){return He.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kc{constructor(e,t=null,i=[],r=[],u=null,c="F",m=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=u,this.limitType=c,this.startAt=m,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function n3(n,e,t,i,r,u,c,m){return new Kc(n,e,t,i,r,u,c,m)}function Jg(n){return new Kc(n)}function ex(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function $S(n){return n.collectionGroup!==null}function Nc(n){const e=nt(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let m=new Dn(Yn.comparator);return c.filters.forEach((g=>{g.getFlattenedFilters().forEach((p=>{p.isInequality()&&(m=m.add(p.field))}))})),m})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Fh(u,i))})),t.has(Yn.keyField().canonicalString())||e.Ie.push(new Fh(Yn.keyField(),i))}return e.Ie}function _o(n){const e=nt(n);return e.Ee||(e.Ee=i3(e,Nc(n))),e.Ee}function i3(n,e){if(n.limitType==="F")return $E(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const u=r.dir==="desc"?"asc":"desc";return new Fh(r.field,u)}));const t=n.endAt?new Bh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Bh(n.startAt.position,n.startAt.inclusive):null;return $E(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Xp(n,e){const t=n.filters.concat([e]);return new Kc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function $p(n,e,t){return new Kc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ff(n,e){return Yg(_o(n),_o(e))&&n.limitType===e.limitType}function eA(n){return`${Kg(_o(n))}|lt:${n.limitType}`}function Xl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>QS(r))).join(", ")}]`),df(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>gu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>gu(r))).join(",")),`Target(${i})`})(_o(n))}; limitType=${n.limitType})`}function mf(n,e){return e.isFoundDocument()&&(function(i,r){const u=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):He.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,r){for(const u of Nc(i))if(!u.field.isKeyField()&&r.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const u of i.filters)if(!u.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(c,m,g){const p=QE(c,m,g);return c.inclusive?p<=0:p<0})(i.startAt,Nc(i),r)||i.endAt&&!(function(c,m,g){const p=QE(c,m,g);return c.inclusive?p>=0:p>0})(i.endAt,Nc(i),r))})(n,e)}function s3(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function tA(n){return(e,t)=>{let i=!1;for(const r of Nc(n)){const u=o3(r,e,t);if(u!==0)return u;i=i||r.field.isKeyField()}return 0}}function o3(n,e,t){const i=n.field.isKeyField()?He.comparator(e.key,t.key):(function(u,c,m){const g=c.data.field(u),p=m.data.field(u);return g!==null&&p!==null?pu(g,p):Ye(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ye(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ul{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,u]of i)if(this.equalsFn(r,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<r.length;u++)if(this.equalsFn(r[u][0],e))return void(r[u]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ha(this.inner,((t,i)=>{for(const[r,u]of i)e(r,u)}))}isEmpty(){return US(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3=new rn(He.comparator);function or(){return r3}const nA=new rn(He.comparator);function xc(...n){let e=nA;for(const t of n)e=e.insert(t.key,t);return e}function iA(n){let e=nA;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function $a(){return Rc()}function sA(){return Rc()}function Rc(){return new ul((n=>n.toString()),((n,e)=>n.isEqual(e)))}const a3=new rn(He.comparator),l3=new Dn(He.comparator);function Et(...n){let e=l3;for(const t of n)e=e.add(t);return e}const u3=new Dn(Tt);function c3(){return u3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Oh(e)?"-0":e}}function oA(n){return{integerValue:""+n}}function d3(n,e){return U4(e)?oA(e):Wg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(){this._=void 0}}function h3(n,e,t){return n instanceof Uc?(function(r,u){const c={fields:{[FS]:{stringValue:BS},[HS]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return u&&jg(u)&&(u=hf(u)),u&&(c.fields[qS]=u),{mapValue:c}})(t,e):n instanceof zc?aA(n,e):n instanceof Bc?lA(n,e):(function(r,u){const c=rA(r,u),m=tx(c)+tx(r.Ae);return Jp(c)&&Jp(r.Ae)?oA(m):Wg(r.serializer,m)})(n,e)}function f3(n,e,t){return n instanceof zc?aA(n,e):n instanceof Bc?lA(n,e):t}function rA(n,e){return n instanceof qh?(function(i){return Jp(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class Uc extends pf{}class zc extends pf{constructor(e){super(),this.elements=e}}function aA(n,e){const t=uA(e);for(const i of n.elements)t.some((r=>xo(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Bc extends pf{constructor(e){super(),this.elements=e}}function lA(n,e){let t=uA(e);for(const i of n.elements)t=t.filter((r=>!xo(r,i)));return{arrayValue:{values:t}}}class qh extends pf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function tx(n){return pn(n.integerValue||n.doubleValue)}function uA(n){return Zg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m3{constructor(e,t){this.field=e,this.transform=t}}function p3(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof zc&&r instanceof zc||i instanceof Bc&&r instanceof Bc?mu(i.elements,r.elements,xo):i instanceof qh&&r instanceof qh?xo(i.Ae,r.Ae):i instanceof Uc&&r instanceof Uc})(n.transform,e.transform)}class g3{constructor(e,t){this.version=e,this.transformResults=t}}class Gs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Gs}static exists(e){return new Gs(void 0,e)}static updateTime(e){return new Gs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Eh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class gf{}function cA(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qg(n.key,Gs.none()):new Yc(n.key,n.data,Gs.none());{const t=n.data,i=Li.empty();let r=new Dn(Yn.comparator);for(let u of e.fields)if(!r.has(u)){let c=t.field(u);c===null&&u.length>1&&(u=u.popLast(),c=t.field(u)),c===null?i.delete(u):i.set(u,c),r=r.add(u)}return new fa(n.key,i,new ts(r.toArray()),Gs.none())}}function _3(n,e,t){n instanceof Yc?(function(r,u,c){const m=r.value.clone(),g=ix(r.fieldTransforms,u,c.transformResults);m.setAll(g),u.convertToFoundDocument(c.version,m).setHasCommittedMutations()})(n,e,t):n instanceof fa?(function(r,u,c){if(!Eh(r.precondition,u))return void u.convertToUnknownDocument(c.version);const m=ix(r.fieldTransforms,u,c.transformResults),g=u.data;g.setAll(dA(r)),g.setAll(m),u.convertToFoundDocument(c.version,g).setHasCommittedMutations()})(n,e,t):(function(r,u,c){u.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Mc(n,e,t,i){return n instanceof Yc?(function(u,c,m,g){if(!Eh(u.precondition,c))return m;const p=u.value.clone(),x=sx(u.fieldTransforms,g,c);return p.setAll(x),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof fa?(function(u,c,m,g){if(!Eh(u.precondition,c))return m;const p=sx(u.fieldTransforms,g,c),x=c.data;return x.setAll(dA(u)),x.setAll(p),c.convertToFoundDocument(c.version,x).setHasLocalMutations(),m===null?null:m.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((A=>A.field)))})(n,e,t,i):(function(u,c,m){return Eh(u.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):m})(n,e,t)}function y3(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),u=rA(i.transform,r||null);u!=null&&(t===null&&(t=Li.empty()),t.set(i.field,u))}return t||null}function nx(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&mu(i,r,((u,c)=>p3(u,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Yc extends gf{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class fa extends gf{constructor(e,t,i,r,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function dA(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function ix(n,e,t){const i=new Map;Pt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const u=n[r],c=u.transform,m=e.data.field(u.field);i.set(u.field,f3(c,m,t[r]))}return i}function sx(n,e,t){const i=new Map;for(const r of n){const u=r.transform,c=t.data.field(r.field);i.set(r.field,h3(u,c,e))}return i}class Qg extends gf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class v3 extends gf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const u=this.mutations[r];u.key.isEqual(e.key)&&_3(u,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Mc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Mc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=sA();return this.mutations.forEach((r=>{const u=e.get(r.key),c=u.overlayedDocument;let m=this.applyToLocalView(c,u.mutatedFields);m=t.has(r.key)?null:m;const g=cA(c,m);g!==null&&i.set(r.key,g),c.isValidDocument()||c.convertToNoDocument(et.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Et())}isEqual(e){return this.batchId===e.batchId&&mu(this.mutations,e.mutations,((t,i)=>nx(t,i)))&&mu(this.baseMutations,e.baseMutations,((t,i)=>nx(t,i)))}}class Xg{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Pt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return a3})();const u=e.mutations;for(let c=0;c<u.length;c++)r=r.insert(u[c].key,i[c].version);return new Xg(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E3{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x3{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sn,St;function w3(n){switch(n){case Ee.OK:return Ye(64938);case Ee.CANCELLED:case Ee.UNKNOWN:case Ee.DEADLINE_EXCEEDED:case Ee.RESOURCE_EXHAUSTED:case Ee.INTERNAL:case Ee.UNAVAILABLE:case Ee.UNAUTHENTICATED:return!1;case Ee.INVALID_ARGUMENT:case Ee.NOT_FOUND:case Ee.ALREADY_EXISTS:case Ee.PERMISSION_DENIED:case Ee.FAILED_PRECONDITION:case Ee.ABORTED:case Ee.OUT_OF_RANGE:case Ee.UNIMPLEMENTED:case Ee.DATA_LOSS:return!0;default:return Ye(15467,{code:n})}}function hA(n){if(n===void 0)return sr("GRPC error has no .code"),Ee.UNKNOWN;switch(n){case Sn.OK:return Ee.OK;case Sn.CANCELLED:return Ee.CANCELLED;case Sn.UNKNOWN:return Ee.UNKNOWN;case Sn.DEADLINE_EXCEEDED:return Ee.DEADLINE_EXCEEDED;case Sn.RESOURCE_EXHAUSTED:return Ee.RESOURCE_EXHAUSTED;case Sn.INTERNAL:return Ee.INTERNAL;case Sn.UNAVAILABLE:return Ee.UNAVAILABLE;case Sn.UNAUTHENTICATED:return Ee.UNAUTHENTICATED;case Sn.INVALID_ARGUMENT:return Ee.INVALID_ARGUMENT;case Sn.NOT_FOUND:return Ee.NOT_FOUND;case Sn.ALREADY_EXISTS:return Ee.ALREADY_EXISTS;case Sn.PERMISSION_DENIED:return Ee.PERMISSION_DENIED;case Sn.FAILED_PRECONDITION:return Ee.FAILED_PRECONDITION;case Sn.ABORTED:return Ee.ABORTED;case Sn.OUT_OF_RANGE:return Ee.OUT_OF_RANGE;case Sn.UNIMPLEMENTED:return Ee.UNIMPLEMENTED;case Sn.DATA_LOSS:return Ee.DATA_LOSS;default:return Ye(39323,{code:n})}}(St=Sn||(Sn={}))[St.OK=0]="OK",St[St.CANCELLED=1]="CANCELLED",St[St.UNKNOWN=2]="UNKNOWN",St[St.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",St[St.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",St[St.NOT_FOUND=5]="NOT_FOUND",St[St.ALREADY_EXISTS=6]="ALREADY_EXISTS",St[St.PERMISSION_DENIED=7]="PERMISSION_DENIED",St[St.UNAUTHENTICATED=16]="UNAUTHENTICATED",St[St.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",St[St.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",St[St.ABORTED=10]="ABORTED",St[St.OUT_OF_RANGE=11]="OUT_OF_RANGE",St[St.UNIMPLEMENTED=12]="UNIMPLEMENTED",St[St.INTERNAL=13]="INTERNAL",St[St.UNAVAILABLE=14]="UNAVAILABLE",St[St.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A3=new na([4294967295,4294967295],0);function ox(n){const e=S3().encode(n),t=new bS;return t.update(e),new Uint8Array(t.digest())}function rx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new na([t,i],0),new na([r,u],0)]}class $g{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new wc(`Invalid padding: ${t}`);if(i<0)throw new wc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new wc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new wc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=na.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(na.fromNumber(i)));return r.compare(A3)===1&&(r=new na([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=ox(e),[i,r]=rx(t);for(let u=0;u<this.hashCount;u++){const c=this.ye(i,r,u);if(!this.we(c))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),c=new $g(u,r,t);return i.forEach((m=>c.insert(m))),c}insert(e){if(this.ge===0)return;const t=ox(e),[i,r]=rx(t);for(let u=0;u<this.hashCount;u++){const c=this.ye(i,r,u);this.Se(c)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class wc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e,t,i,r,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Jc.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new _f(et.min(),r,new rn(Tt),or(),Et())}}class Jc{constructor(e,t,i,r,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Jc(i,t,Et(),Et(),Et())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,t,i,r){this.be=e,this.removedTargetIds=t,this.key=i,this.De=r}}class fA{constructor(e,t){this.targetId=e,this.Ce=t}}class mA{constructor(e,t,i=Jn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class ax{constructor(){this.ve=0,this.Fe=lx(),this.Me=Jn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Et(),t=Et(),i=Et();return this.Fe.forEach(((r,u)=>{switch(u){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:Ye(38017,{changeType:u})}})),new Jc(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=lx()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Pt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class C3{constructor(e){this.Ge=e,this.ze=new Map,this.je=or(),this.Je=uh(),this.He=uh(),this.Ye=new rn(Tt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Ye(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const u=r.target;if(Qp(u))if(i===0){const c=new He(u.path);this.et(t,c,oi.newNoDocument(c,et.min()))}else Pt(i===1,20013,{expectedCount:i});else{const c=this._t(t);if(c!==i){const m=this.ut(e),g=m?this.ct(m,e,c):1;if(g!==0){this.it(t);const p=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:u=0}=t;let c,m;try{c=aa(i).toUint8Array()}catch(g){if(g instanceof zS)return fu("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{m=new $g(c,r,u)}catch(g){return fu(g instanceof wc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return m.ge===0?null:m}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((u=>{const c=this.Ge.ht(),m=`projects/${c.projectId}/databases/${c.database}/documents/${u.path.canonicalString()}`;e.mightContain(m)||(this.et(t,u,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((u,c)=>{const m=this.ot(c);if(m){if(u.current&&Qp(m.target)){const g=new He(m.target.path);this.It(g).has(c)||this.Et(c,g)||this.et(c,g,oi.newNoDocument(g,e))}u.Be&&(t.set(c,u.ke()),u.qe())}}));let i=Et();this.He.forEach(((u,c)=>{let m=!0;c.forEachWhile((g=>{const p=this.ot(g);return!p||p.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(i=i.add(u))})),this.je.forEach(((u,c)=>c.setReadTime(e)));const r=new _f(e,t,this.Ye,this.je,i);return this.je=or(),this.Je=uh(),this.He=uh(),this.Ye=new rn(Tt),r}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new ax,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Dn(Tt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Dn(Tt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Le("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ax),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function uh(){return new rn(He.comparator)}function lx(){return new rn(He.comparator)}const b3={asc:"ASCENDING",desc:"DESCENDING"},I3={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},N3={and:"AND",or:"OR"};class R3{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function eg(n,e){return n.useProto3Json||df(e)?e:{value:e}}function Hh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pA(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function M3(n,e){return Hh(n,e.toTimestamp())}function yo(n){return Pt(!!n,49232),et.fromTimestamp((function(t){const i=ra(t);return new $t(i.seconds,i.nanos)})(n))}function e_(n,e){return tg(n,e).canonicalString()}function tg(n,e){const t=(function(r){return new Zt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function gA(n){const e=Zt.fromString(n);return Pt(EA(e),10190,{key:e.toString()}),e}function ng(n,e){return e_(n.databaseId,e.path)}function xp(n,e){const t=gA(e);if(t.get(1)!==n.databaseId.projectId)throw new Ve(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ve(Ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new He(yA(t))}function _A(n,e){return e_(n.databaseId,e)}function P3(n){const e=gA(n);return e.length===4?Zt.emptyPath():yA(e)}function ig(n){return new Zt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yA(n){return Pt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function ux(n,e,t){return{name:ng(n,e),fields:t.value.mapValue.fields}}function D3(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Ye(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],u=(function(p,x){return p.useProto3Json?(Pt(x===void 0||typeof x=="string",58123),Jn.fromBase64String(x||"")):(Pt(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),Jn.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,m=c&&(function(p){const x=p.code===void 0?Ee.UNKNOWN:hA(p.code);return new Ve(x,p.message||"")})(c);t=new mA(i,r,u,m||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=xp(n,i.document.name),u=yo(i.document.updateTime),c=i.document.createTime?yo(i.document.createTime):et.min(),m=new Li({mapValue:{fields:i.document.fields}}),g=oi.newFoundDocument(r,u,c,m),p=i.targetIds||[],x=i.removedTargetIds||[];t=new xh(p,x,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=xp(n,i.document),u=i.readTime?yo(i.readTime):et.min(),c=oi.newNoDocument(r,u),m=i.removedTargetIds||[];t=new xh([],m,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=xp(n,i.document),u=i.removedTargetIds||[];t=new xh([],u,r,null)}else{if(!("filter"in e))return Ye(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:u}=i,c=new x3(r,u),m=i.targetId;t=new fA(m,c)}}return t}function k3(n,e){let t;if(e instanceof Yc)t={update:ux(n,e.key,e.value)};else if(e instanceof Qg)t={delete:ng(n,e.key)};else if(e instanceof fa)t={update:ux(n,e.key,e.data),updateMask:H3(e.fieldMask)};else{if(!(e instanceof v3))return Ye(16599,{Vt:e.type});t={verify:ng(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,c){const m=c.transform;if(m instanceof Uc)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof zc)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Bc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof qh)return{fieldPath:c.field.canonicalString(),increment:m.Ae};throw Ye(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,u){return u.updateTime!==void 0?{updateTime:M3(r,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:Ye(27497)})(n,e.precondition)),t}function L3(n,e){return n&&n.length>0?(Pt(e!==void 0,14353),n.map((t=>(function(r,u){let c=r.updateTime?yo(r.updateTime):yo(u);return c.isEqual(et.min())&&(c=yo(u)),new g3(c,r.transformResults||[])})(t,e)))):[]}function V3(n,e){return{documents:[_A(n,e.path)]}}function O3(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=_A(n,r);const u=(function(p){if(p.length!==0)return TA(js.create(p,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const c=(function(p){if(p.length!==0)return p.map((x=>(function(b){return{field:$l(b.field),direction:B3(b.dir)}})(x)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const m=eg(n,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:r}}function U3(n){let e=P3(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Pt(i===1,65062);const x=t.from[0];x.allDescendants?r=x.collectionId:e=e.child(x.collectionId)}let u=[];t.where&&(u=(function(A){const b=vA(A);return b instanceof js&&JS(b)?b.getFilters():[b]})(t.where));let c=[];t.orderBy&&(c=(function(A){return A.map((b=>(function(K){return new Fh(eu(K.field),(function(z){switch(z){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(K.direction))})(b)))})(t.orderBy));let m=null;t.limit&&(m=(function(A){let b;return b=typeof A=="object"?A.value:A,df(b)?null:b})(t.limit));let g=null;t.startAt&&(g=(function(A){const b=!!A.before,M=A.values||[];return new Bh(M,b)})(t.startAt));let p=null;return t.endAt&&(p=(function(A){const b=!A.before,M=A.values||[];return new Bh(M,b)})(t.endAt)),n3(e,r,c,u,m,"F",g,p)}function z3(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ye(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function vA(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=eu(t.unaryFilter.field);return An.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=eu(t.unaryFilter.field);return An.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=eu(t.unaryFilter.field);return An.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=eu(t.unaryFilter.field);return An.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ye(61313);default:return Ye(60726)}})(n):n.fieldFilter!==void 0?(function(t){return An.create(eu(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ye(58110);default:return Ye(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return js.create(t.compositeFilter.filters.map((i=>vA(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return Ye(1026)}})(t.compositeFilter.op))})(n):Ye(30097,{filter:n})}function B3(n){return b3[n]}function F3(n){return I3[n]}function q3(n){return N3[n]}function $l(n){return{fieldPath:n.canonicalString()}}function eu(n){return Yn.fromServerFormat(n.fieldPath)}function TA(n){return n instanceof An?(function(t){if(t.op==="=="){if(WE(t.value))return{unaryFilter:{field:$l(t.field),op:"IS_NAN"}};if(JE(t.value))return{unaryFilter:{field:$l(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(WE(t.value))return{unaryFilter:{field:$l(t.field),op:"IS_NOT_NAN"}};if(JE(t.value))return{unaryFilter:{field:$l(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$l(t.field),op:F3(t.op),value:t.value}}})(n):n instanceof js?(function(t){const i=t.getFilters().map((r=>TA(r)));return i.length===1?i[0]:{compositeFilter:{op:q3(t.op),filters:i}}})(n):Ye(54877,{filter:n})}function H3(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function EA(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,t,i,r,u=et.min(),c=et.min(),m=Jn.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=m,this.expectedCount=g}withSequenceNumber(e){return new Xr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(e){this.yt=e}}function j3(n){const e=U3({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?$p(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(){this.Cn=new K3}addToCollectionParentIndex(e,t){return this.Cn.add(t),xe.resolve()}getCollectionParents(e,t){return xe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return xe.resolve()}deleteFieldIndex(e,t){return xe.resolve()}deleteAllFieldIndexes(e){return xe.resolve()}createTargetIndexes(e,t){return xe.resolve()}getDocumentsMatchingTarget(e,t){return xe.resolve(null)}getIndexType(e,t){return xe.resolve(0)}getFieldIndexes(e,t){return xe.resolve([])}getNextCollectionGroupToUpdate(e){return xe.resolve(null)}getMinOffset(e,t){return xe.resolve(oa.min())}getMinOffsetFromCollectionGroup(e,t){return xe.resolve(oa.min())}updateCollectionGroup(e,t,i){return xe.resolve()}updateIndexEntries(e,t){return xe.resolve()}}class K3{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Dn(Zt.comparator),u=!r.has(i);return this.index[t]=r.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Dn(Zt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},xA=41943040;class ki{static withCacheSize(e){return new ki(e,ki.DEFAULT_COLLECTION_PERCENTILE,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ki.DEFAULT_COLLECTION_PERCENTILE=10,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ki.DEFAULT=new ki(xA,ki.DEFAULT_COLLECTION_PERCENTILE,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ki.DISABLED=new ki(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new _u(0)}static cr(){return new _u(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dx="LruGarbageCollector",Y3=1048576;function hx([n,e],[t,i]){const r=Tt(n,t);return r===0?Tt(e,i):r}class J3{constructor(e){this.Ir=e,this.buffer=new Dn(hx),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();hx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class W3{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Le(dx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Nu(t)?Le(dx,"Ignoring IndexedDB error during garbage collection: ",t):await Iu(t)}await this.Vr(3e5)}))}}class Q3{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return xe.resolve(cf.ce);const i=new J3(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Le("LruGarbageCollector","Garbage collection skipped; disabled"),xe.resolve(cx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Le("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cx):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,u,c,m,g,p;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((A=>(A>this.params.maximumSequenceNumbersToCollect?(Le("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${A}`),r=this.params.maximumSequenceNumbersToCollect):r=A,c=Date.now(),this.nthSequenceNumber(e,r)))).next((A=>(i=A,m=Date.now(),this.removeTargets(e,i,t)))).next((A=>(u=A,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((A=>(p=Date.now(),Ql()<=vt.DEBUG&&Le("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-x}ms
	Determined least recently used ${r} in `+(m-c)+`ms
	Removed ${u} targets in `+(g-m)+`ms
	Removed ${A} documents in `+(p-g)+`ms
Total Duration: ${p-x}ms`),xe.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:u,documentsRemoved:A}))))}}function X3(n,e){return new Q3(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $3{constructor(){this.changes=new ul((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,oi.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?xe.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&Mc(i.mutation,r,ts.empty(),$t.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Et()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Et()){const r=$a();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((u=>{let c=xc();return u.forEach(((m,g)=>{c=c.insert(m,g.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=$a();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Et())))}populateOverlays(e,t,i){const r=[];return i.forEach((u=>{t.has(u)||r.push(u)})),this.documentOverlayCache.getOverlays(e,r).next((u=>{u.forEach(((c,m)=>{t.set(c,m)}))}))}computeViews(e,t,i,r){let u=or();const c=Rc(),m=(function(){return Rc()})();return t.forEach(((g,p)=>{const x=i.get(p.key);r.has(p.key)&&(x===void 0||x.mutation instanceof fa)?u=u.insert(p.key,p):x!==void 0?(c.set(p.key,x.mutation.getFieldMask()),Mc(x.mutation,p,x.mutation.getFieldMask(),$t.now())):c.set(p.key,ts.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((p,x)=>c.set(p,x))),t.forEach(((p,x)=>m.set(p,new eV(x,c.get(p)??null)))),m)))}recalculateAndSaveOverlays(e,t){const i=Rc();let r=new rn(((c,m)=>c-m)),u=Et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const m of c)m.keys().forEach((g=>{const p=t.get(g);if(p===null)return;let x=i.get(g)||ts.empty();x=m.applyToLocalView(p,x),i.set(g,x);const A=(r.get(m.batchId)||Et()).add(g);r=r.insert(m.batchId,A)}))})).next((()=>{const c=[],m=r.getReverseIterator();for(;m.hasNext();){const g=m.getNext(),p=g.key,x=g.value,A=sA();x.forEach((b=>{if(!u.has(b)){const M=cA(t.get(b),i.get(b));M!==null&&A.set(b,M),u=u.add(b)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,A))}return xe.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(c){return He.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):$S(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((u=>{const c=r-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-u.size):xe.resolve($a());let m=kc,g=u;return c.next((p=>xe.forEach(p,((x,A)=>(m<A.largestBatchId&&(m=A.largestBatchId),u.get(x)?xe.resolve():this.remoteDocumentCache.getEntry(e,x).next((b=>{g=g.insert(x,b)}))))).next((()=>this.populateOverlays(e,p,u))).next((()=>this.computeViews(e,g,p,Et()))).next((x=>({batchId:m,changes:iA(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new He(t)).next((i=>{let r=xc();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const u=t.collectionGroup;let c=xc();return this.indexManager.getCollectionParents(e,u).next((m=>xe.forEach(m,(g=>{const p=(function(A,b){return new Kc(b,null,A.explicitOrderBy.slice(),A.filters.slice(),A.limit,A.limitType,A.startAt,A.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,p,i,r).next((x=>{x.forEach(((A,b)=>{c=c.insert(A,b)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(u=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,r)))).next((c=>{u.forEach(((g,p)=>{const x=p.getKey();c.get(x)===null&&(c=c.insert(x,oi.newInvalidDocument(x)))}));let m=xc();return c.forEach(((g,p)=>{const x=u.get(g);x!==void 0&&Mc(x.mutation,p,ts.empty(),$t.now()),mf(t,p)&&(m=m.insert(g,p))})),m}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return xe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:yo(r.createTime)}})(t)),xe.resolve()}getNamedQuery(e,t){return xe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:j3(r.bundledQuery),readTime:yo(r.readTime)}})(t)),xe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(){this.overlays=new rn(He.comparator),this.qr=new Map}getOverlay(e,t){return xe.resolve(this.overlays.get(t))}getOverlays(e,t){const i=$a();return xe.forEach(t,(r=>this.getOverlay(e,r).next((u=>{u!==null&&i.set(r,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,u)=>{this.St(e,t,u)})),xe.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((u=>this.overlays=this.overlays.remove(u))),this.qr.delete(i)),xe.resolve()}getOverlaysForCollection(e,t,i){const r=$a(),u=t.length+1,c=new He(t.child("")),m=this.overlays.getIteratorFrom(c);for(;m.hasNext();){const g=m.getNext().value,p=g.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===u&&g.largestBatchId>i&&r.set(g.getKey(),g)}return xe.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let u=new rn(((p,x)=>p-x));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let x=u.get(p.largestBatchId);x===null&&(x=$a(),u=u.insert(p.largestBatchId,x)),x.set(p.getKey(),p)}}const m=$a(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((p,x)=>m.set(p,x))),!(m.size()>=r)););return xe.resolve(m)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const c=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new E3(t,i));let u=this.qr.get(t);u===void 0&&(u=Et(),this.qr.set(t,u)),this.qr.set(t,u.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sV{constructor(){this.sessionToken=Jn.EMPTY_BYTE_STRING}getSessionToken(e){return xe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,xe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(){this.Qr=new Dn(qn.$r),this.Ur=new Dn(qn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new qn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new qn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new He(new Zt([])),i=new qn(t,e),r=new qn(t,e+1),u=[];return this.Ur.forEachInRange([i,r],(c=>{this.Gr(c),u.push(c.key)})),u}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new He(new Zt([])),i=new qn(t,e),r=new qn(t,e+1);let u=Et();return this.Ur.forEachInRange([i,r],(c=>{u=u.add(c.key)})),u}containsKey(e){const t=new qn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class qn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return He.comparator(e.key,t.key)||Tt(e.Yr,t.Yr)}static Kr(e,t){return Tt(e.Yr,t.Yr)||He.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Dn(qn.$r)}checkEmpty(e){return xe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const u=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new T3(u,t,i,r);this.mutationQueue.push(c);for(const m of r)this.Zr=this.Zr.add(new qn(m.key,u)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return xe.resolve(c)}lookupMutationBatch(e,t){return xe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),u=r<0?0:r;return xe.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return xe.resolve(this.mutationQueue.length===0?Gg:this.tr-1)}getAllMutationBatches(e){return xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new qn(t,0),r=new qn(t,Number.POSITIVE_INFINITY),u=[];return this.Zr.forEachInRange([i,r],(c=>{const m=this.Xr(c.Yr);u.push(m)})),xe.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Dn(Tt);return t.forEach((r=>{const u=new qn(r,0),c=new qn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([u,c],(m=>{i=i.add(m.Yr)}))})),xe.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let u=i;He.isDocumentKey(u)||(u=u.child(""));const c=new qn(new He(u),0);let m=new Dn(Tt);return this.Zr.forEachWhile((g=>{const p=g.key.path;return!!i.isPrefixOf(p)&&(p.length===r&&(m=m.add(g.Yr)),!0)}),c),xe.resolve(this.ti(m))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Pt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return xe.forEach(t.mutations,(r=>{const u=new qn(r.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new qn(t,0),r=this.Zr.firstAfterOrEqual(i);return xe.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,xe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e){this.ri=e,this.docs=(function(){return new rn(He.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),u=r?r.size:0,c=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return xe.resolve(i?i.document.mutableCopy():oi.newInvalidDocument(t))}getEntries(e,t){let i=or();return t.forEach((r=>{const u=this.docs.get(r);i=i.insert(r,u?u.document.mutableCopy():oi.newInvalidDocument(r))})),xe.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let u=or();const c=t.path,m=new He(c.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(m);for(;g.hasNext();){const{key:p,value:{document:x}}=g.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||k4(D4(x),i)<=0||(r.has(x.key)||mf(t,x))&&(u=u.insert(x.key,x.mutableCopy()))}return xe.resolve(u)}getAllFromCollectionGroup(e,t,i,r){Ye(9500)}ii(e,t){return xe.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new aV(this)}getSize(e){return xe.resolve(this.size)}}class aV extends $3{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),xe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lV{constructor(e){this.persistence=e,this.si=new ul((t=>Kg(t)),Yg),this.lastRemoteSnapshotVersion=et.min(),this.highestTargetId=0,this.oi=0,this._i=new t_,this.targetCount=0,this.ai=_u.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),xe.resolve()}getLastRemoteSnapshotVersion(e){return xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return xe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),xe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),xe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new _u(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,xe.resolve()}updateTargetData(e,t){return this.Pr(t),xe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,xe.resolve()}removeTargets(e,t,i){let r=0;const u=[];return this.si.forEach(((c,m)=>{m.sequenceNumber<=t&&i.get(m.targetId)===null&&(this.si.delete(c),u.push(this.removeMatchingKeysForTargetId(e,m.targetId)),r++)})),xe.waitFor(u).next((()=>r))}getTargetCount(e){return xe.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return xe.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),xe.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,u=[];return r&&t.forEach((c=>{u.push(r.markPotentiallyOrphaned(e,c))})),xe.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),xe.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return xe.resolve(i)}containsKey(e,t){return xe.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,t){this.ui={},this.overlays={},this.ci=new cf(0),this.li=!1,this.li=!0,this.hi=new sV,this.referenceDelegate=e(this),this.Pi=new lV(this),this.indexManager=new Z3,this.remoteDocumentCache=(function(r){return new rV(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new G3(t),this.Ii=new nV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new iV,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new oV(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){Le("MemoryPersistence","Starting transaction:",e);const r=new uV(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((u=>this.referenceDelegate.di(r).next((()=>u)))).toPromise().then((u=>(r.raiseOnCommittedEvent(),u)))}Ai(e,t){return xe.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class uV extends V4{constructor(e){super(),this.currentSequenceNumber=e}}class n_{constructor(e){this.persistence=e,this.Ri=new t_,this.Vi=null}static mi(e){return new n_(e)}get fi(){if(this.Vi)return this.Vi;throw Ye(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),xe.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),xe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),xe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((u=>this.fi.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xe.forEach(this.fi,(i=>{const r=He.fromPath(i);return this.gi(e,r).next((u=>{u||t.removeEntry(r,et.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return xe.or([()=>xe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Gh{constructor(e,t){this.persistence=e,this.pi=new ul((i=>z4(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=X3(this,t)}static mi(e,t){return new Gh(e,t)}Ei(){}di(e){return xe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return xe.forEach(this.pi,((i,r)=>this.br(e,i,r).next((u=>u?xe.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),u=r.newChangeBuffer();return r.ii(e,(c=>this.br(e,c,t).next((m=>{m||(i++,u.removeEntry(c,et.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),xe.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),xe.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),xe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),xe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=vh(e.data.value)),t}br(e,t,i){return xe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return xe.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=Et(),r=Et();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:r=r.add(u.doc.key)}return new i_(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return eD()?8:O4(li())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const u={result:null};return this.ys(e,t).next((c=>{u.result=c})).next((()=>{if(!u.result)return this.ws(e,t,r,i).next((c=>{u.result=c}))})).next((()=>{if(u.result)return;const c=new cV;return this.Ss(e,t,c).next((m=>{if(u.result=m,this.Vs)return this.bs(e,t,c,m.size)}))})).next((()=>u.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Ql()<=vt.DEBUG&&Le("QueryEngine","SDK will not create cache indexes for query:",Xl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),xe.resolve()):(Ql()<=vt.DEBUG&&Le("QueryEngine","Query:",Xl(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Ql()<=vt.DEBUG&&Le("QueryEngine","The SDK decides to create cache indexes for query:",Xl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_o(t))):xe.resolve())}ys(e,t){if(ex(t))return xe.resolve(null);let i=_o(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=$p(t,null,"F"),i=_o(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const c=Et(...u);return this.ps.getDocuments(e,c).next((m=>this.indexManager.getMinOffset(e,i).next((g=>{const p=this.Ds(t,m);return this.Cs(t,p,c,g.readTime)?this.ys(e,$p(t,null,"F")):this.vs(e,p,t,g)}))))})))))}ws(e,t,i,r){return ex(t)||r.isEqual(et.min())?xe.resolve(null):this.ps.getDocuments(e,i).next((u=>{const c=this.Ds(t,u);return this.Cs(t,c,i,r)?xe.resolve(null):(Ql()<=vt.DEBUG&&Le("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Xl(t)),this.vs(e,c,t,P4(r,kc)).next((m=>m)))}))}Ds(e,t){let i=new Dn(tA(e));return t.forEach(((r,u)=>{mf(e,u)&&(i=i.add(u))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(r)>0)}Ss(e,t,i){return Ql()<=vt.DEBUG&&Le("QueryEngine","Using full collection scan to execute query:",Xl(t)),this.ps.getDocumentsMatchingQuery(e,t,oa.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((u=>(t.forEach((c=>{u=u.insert(c.key,c)})),u)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_="LocalStore",hV=3e8;class fV{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new rn(Tt),this.xs=new ul((u=>Kg(u)),Yg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tV(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function mV(n,e,t,i){return new fV(n,e,t,i)}async function SA(n,e){const t=nt(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((u=>(r=u,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const c=[],m=[];let g=Et();for(const p of r){c.push(p.batchId);for(const x of p.mutations)g=g.add(x.key)}for(const p of u){m.push(p.batchId);for(const x of p.mutations)g=g.add(x.key)}return t.localDocuments.getDocuments(i,g).next((p=>({Ls:p,removedBatchIds:c,addedBatchIds:m})))}))}))}function pV(n,e){const t=nt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),u=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(m,g,p,x){const A=p.batch,b=A.keys();let M=xe.resolve();return b.forEach((K=>{M=M.next((()=>x.getEntry(g,K))).next((G=>{const z=p.docVersions.get(K);Pt(z!==null,48541),G.version.compareTo(z)<0&&(A.applyToRemoteDocument(G,p),G.isValidDocument()&&(G.setReadTime(p.commitVersion),x.addEntry(G)))}))})),M.next((()=>m.mutationQueue.removeMutationBatch(g,A)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(m){let g=Et();for(let p=0;p<m.mutationResults.length;++p)m.mutationResults[p].transformResults.length>0&&(g=g.add(m.batch.mutations[p].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function AA(n){const e=nt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function gV(n,e){const t=nt(n),i=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const c=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const m=[];e.targetChanges.forEach(((x,A)=>{const b=r.get(A);if(!b)return;m.push(t.Pi.removeMatchingKeys(u,x.removedDocuments,A).next((()=>t.Pi.addMatchingKeys(u,x.addedDocuments,A))));let M=b.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(A)!==null?M=M.withResumeToken(Jn.EMPTY_BYTE_STRING,et.min()).withLastLimboFreeSnapshotVersion(et.min()):x.resumeToken.approximateByteSize()>0&&(M=M.withResumeToken(x.resumeToken,i)),r=r.insert(A,M),(function(G,z,W){return G.resumeToken.approximateByteSize()===0||z.snapshotVersion.toMicroseconds()-G.snapshotVersion.toMicroseconds()>=hV?!0:W.addedDocuments.size+W.modifiedDocuments.size+W.removedDocuments.size>0})(b,M,x)&&m.push(t.Pi.updateTargetData(u,M))}));let g=or(),p=Et();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(u,x))})),m.push(_V(u,c,e.documentUpdates).next((x=>{g=x.ks,p=x.qs}))),!i.isEqual(et.min())){const x=t.Pi.getLastRemoteSnapshotVersion(u).next((A=>t.Pi.setTargetsMetadata(u,u.currentSequenceNumber,i)));m.push(x)}return xe.waitFor(m).next((()=>c.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,p))).next((()=>g))})).then((u=>(t.Ms=r,u)))}function _V(n,e,t){let i=Et(),r=Et();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let c=or();return t.forEach(((m,g)=>{const p=u.get(m);g.isFoundDocument()!==p.isFoundDocument()&&(r=r.add(m)),g.isNoDocument()&&g.version.isEqual(et.min())?(e.removeEntry(m,g.readTime),c=c.insert(m,g)):!p.isValidDocument()||g.version.compareTo(p.version)>0||g.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(g),c=c.insert(m,g)):Le(s_,"Ignoring outdated watch update for ",m,". Current version:",p.version," Watch version:",g.version)})),{ks:c,qs:r}}))}function yV(n,e){const t=nt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Gg),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function vV(n,e){const t=nt(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Pi.getTargetData(i,e).next((u=>u?(r=u,xe.resolve(r)):t.Pi.allocateTargetId(i).next((c=>(r=new Xr(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function sg(n,e,t){const i=nt(n),r=i.Ms.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(c=>i.persistence.referenceDelegate.removeTarget(c,r)))}catch(c){if(!Nu(c))throw c;Le(s_,`Failed to update sequence numbers for target ${e}: ${c}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function fx(n,e,t){const i=nt(n);let r=et.min(),u=Et();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(g,p,x){const A=nt(g),b=A.xs.get(x);return b!==void 0?xe.resolve(A.Ms.get(b)):A.Pi.getTargetData(p,x)})(i,c,_o(e)).next((m=>{if(m)return r=m.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(c,m.targetId).next((g=>{u=g}))})).next((()=>i.Fs.getDocumentsMatchingQuery(c,e,t?r:et.min(),t?u:Et()))).next((m=>(TV(i,s3(e),m),{documents:m,Qs:u})))))}function TV(n,e,t){let i=n.Os.get(e)||et.min();t.forEach(((r,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Os.set(e,i)}class mx{constructor(){this.activeTargetIds=c3()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class EV{constructor(){this.Mo=new mx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new mx,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xV{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const px="ConnectivityMonitor";class gx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Le(px,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Le(px,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ch=null;function og(){return ch===null?ch=(function(){return 268435456+Math.round(2147483648*Math.random())})():ch++,"0x"+ch.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp="RestConnection",wV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class SV{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===Uh?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,u){const c=og(),m=this.zo(e,t.toUriEncodedString());Le(wp,`Sending RPC '${e}' ${c}:`,m,i);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,r,u);const{host:p}=new URL(m),x=Su(p);return this.Jo(e,m,g,i,x).then((A=>(Le(wp,`Received RPC '${e}' ${c}: `,A),A)),(A=>{throw fu(wp,`RPC '${e}' ${c} failed with error: `,A,"url: ",m,"request:",i),A}))}Ho(e,t,i,r,u,c){return this.Go(e,t,i,r,u)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+bu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,u)=>e[u]=r)),i&&i.headers.forEach(((r,u)=>e[u]=r))}zo(e,t){const i=wV[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AV{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ii="WebChannelConnection";class CV extends SV{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,u){const c=og();return new Promise(((m,g)=>{const p=new IS;p.setWithCredentials(!0),p.listenOnce(NS.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case yh.NO_ERROR:const A=p.getResponseJson();Le(ii,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(A)),m(A);break;case yh.TIMEOUT:Le(ii,`RPC '${e}' ${c} timed out`),g(new Ve(Ee.DEADLINE_EXCEEDED,"Request time out"));break;case yh.HTTP_ERROR:const b=p.getStatus();if(Le(ii,`RPC '${e}' ${c} failed with status:`,b,"response text:",p.getResponseText()),b>0){let M=p.getResponseJson();Array.isArray(M)&&(M=M[0]);const K=M==null?void 0:M.error;if(K&&K.status&&K.message){const G=(function(W){const te=W.toLowerCase().replace(/_/g,"-");return Object.values(Ee).indexOf(te)>=0?te:Ee.UNKNOWN})(K.status);g(new Ve(G,K.message))}else g(new Ve(Ee.UNKNOWN,"Server responded with status "+p.getStatus()))}else g(new Ve(Ee.UNAVAILABLE,"Connection failed."));break;default:Ye(9055,{l_:e,streamId:c,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Le(ii,`RPC '${e}' ${c} completed.`)}}));const x=JSON.stringify(r);Le(ii,`RPC '${e}' ${c} sending request:`,r),p.send(t,"POST",x,i,15)}))}T_(e,t,i){const r=og(),u=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=PS(),m=MS(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(g.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const x=u.join("");Le(ii,`Creating RPC '${e}' stream ${r}: ${x}`,g);const A=c.createWebChannel(x,g);this.I_(A);let b=!1,M=!1;const K=new AV({Yo:z=>{M?Le(ii,`Not sending because RPC '${e}' stream ${r} is closed:`,z):(b||(Le(ii,`Opening RPC '${e}' stream ${r} transport.`),A.open(),b=!0),Le(ii,`RPC '${e}' stream ${r} sending:`,z),A.send(z))},Zo:()=>A.close()}),G=(z,W,te)=>{z.listen(W,(Q=>{try{te(Q)}catch(me){setTimeout((()=>{throw me}),0)}}))};return G(A,Ec.EventType.OPEN,(()=>{M||(Le(ii,`RPC '${e}' stream ${r} transport opened.`),K.o_())})),G(A,Ec.EventType.CLOSE,(()=>{M||(M=!0,Le(ii,`RPC '${e}' stream ${r} transport closed`),K.a_(),this.E_(A))})),G(A,Ec.EventType.ERROR,(z=>{M||(M=!0,fu(ii,`RPC '${e}' stream ${r} transport errored. Name:`,z.name,"Message:",z.message),K.a_(new Ve(Ee.UNAVAILABLE,"The operation could not be completed")))})),G(A,Ec.EventType.MESSAGE,(z=>{var W;if(!M){const te=z.data[0];Pt(!!te,16349);const Q=te,me=(Q==null?void 0:Q.error)||((W=Q[0])==null?void 0:W.error);if(me){Le(ii,`RPC '${e}' stream ${r} received error:`,me);const de=me.status;let fe=(function(U){const H=Sn[U];if(H!==void 0)return hA(H)})(de),V=me.message;fe===void 0&&(fe=Ee.INTERNAL,V="Unknown error status: "+de+" with message "+me.message),M=!0,K.a_(new Ve(fe,V)),A.close()}else Le(ii,`RPC '${e}' stream ${r} received:`,te),K.u_(te)}})),G(m,RS.STAT_EVENT,(z=>{z.stat===Zp.PROXY?Le(ii,`RPC '${e}' stream ${r} detected buffering proxy`):z.stat===Zp.NOPROXY&&Le(ii,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{K.__()}),0),K}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Sp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(n){return new R3(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{constructor(e,t,i=1e3,r=1.5,u=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=u,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&Le("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x="PersistentStream";class bA{constructor(e,t,i,r,u,c,m,g){this.Mi=e,this.S_=i,this.b_=r,this.connection=u,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=m,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new CA(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Ee.RESOURCE_EXHAUSTED?(sr(t.toString()),sr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Ve(Ee.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Le(_x,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Le(_x,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class bV extends bA{constructor(e,t,i,r,u,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,c),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=D3(this.serializer,e),i=(function(u){if(!("targetChange"in u))return et.min();const c=u.targetChange;return c.targetIds&&c.targetIds.length?et.min():c.readTime?yo(c.readTime):et.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=ig(this.serializer),t.addTarget=(function(u,c){let m;const g=c.target;if(m=Qp(g)?{documents:V3(u,g)}:{query:O3(u,g).ft},m.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){m.resumeToken=pA(u,c.resumeToken);const p=eg(u,c.expectedCount);p!==null&&(m.expectedCount=p)}else if(c.snapshotVersion.compareTo(et.min())>0){m.readTime=Hh(u,c.snapshotVersion.toTimestamp());const p=eg(u,c.expectedCount);p!==null&&(m.expectedCount=p)}return m})(this.serializer,e);const i=z3(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=ig(this.serializer),t.removeTarget=e,this.q_(t)}}class IV extends bA{constructor(e,t,i,r,u,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,c),this.serializer=u}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Pt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Pt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Pt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=L3(e.writeResults,e.commitTime),i=yo(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=ig(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>k3(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NV{}class RV extends NV{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ve(Ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,c])=>this.connection.Go(e,tg(t,i),r,u,c))).catch((u=>{throw u.name==="FirebaseError"?(u.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ve(Ee.UNKNOWN,u.toString())}))}Ho(e,t,i,r,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,m])=>this.connection.Ho(e,tg(t,i),r,c,m,u))).catch((c=>{throw c.name==="FirebaseError"?(c.code===Ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Ve(Ee.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class MV{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(sr(t),this.aa=!1):Le("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const al="RemoteStore";class PV{constructor(e,t,i,r,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=u,this.Aa.Oo((c=>{i.enqueueAndForget((async()=>{cl(this)&&(Le(al,"Restarting streams for network reachability change."),await(async function(g){const p=nt(g);p.Ea.add(4),await Wc(p),p.Ra.set("Unknown"),p.Ea.delete(4),await vf(p)})(this))}))})),this.Ra=new MV(i,r)}}async function vf(n){if(cl(n))for(const e of n.da)await e(!0)}async function Wc(n){for(const e of n.da)await e(!1)}function IA(n,e){const t=nt(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),l_(t)?a_(t):Ru(t).O_()&&r_(t,e))}function o_(n,e){const t=nt(n),i=Ru(t);t.Ia.delete(e),i.O_()&&NA(t,e),t.Ia.size===0&&(i.O_()?i.L_():cl(t)&&t.Ra.set("Unknown"))}function r_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(et.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ru(n).Y_(e)}function NA(n,e){n.Va.Ue(e),Ru(n).Z_(e)}function a_(n){n.Va=new C3({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ru(n).start(),n.Ra.ua()}function l_(n){return cl(n)&&!Ru(n).x_()&&n.Ia.size>0}function cl(n){return nt(n).Ea.size===0}function RA(n){n.Va=void 0}async function DV(n){n.Ra.set("Online")}async function kV(n){n.Ia.forEach(((e,t)=>{r_(n,e)}))}async function LV(n,e){RA(n),l_(n)?(n.Ra.ha(e),a_(n)):n.Ra.set("Unknown")}async function VV(n,e,t){if(n.Ra.set("Online"),e instanceof mA&&e.state===2&&e.cause)try{await(async function(r,u){const c=u.cause;for(const m of u.targetIds)r.Ia.has(m)&&(await r.remoteSyncer.rejectListen(m,c),r.Ia.delete(m),r.Va.removeTarget(m))})(n,e)}catch(i){Le(al,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await jh(n,i)}else if(e instanceof xh?n.Va.Ze(e):e instanceof fA?n.Va.st(e):n.Va.tt(e),!t.isEqual(et.min()))try{const i=await AA(n.localStore);t.compareTo(i)>=0&&await(function(u,c){const m=u.Va.Tt(c);return m.targetChanges.forEach(((g,p)=>{if(g.resumeToken.approximateByteSize()>0){const x=u.Ia.get(p);x&&u.Ia.set(p,x.withResumeToken(g.resumeToken,c))}})),m.targetMismatches.forEach(((g,p)=>{const x=u.Ia.get(g);if(!x)return;u.Ia.set(g,x.withResumeToken(Jn.EMPTY_BYTE_STRING,x.snapshotVersion)),NA(u,g);const A=new Xr(x.target,g,p,x.sequenceNumber);r_(u,A)})),u.remoteSyncer.applyRemoteEvent(m)})(n,t)}catch(i){Le(al,"Failed to raise snapshot:",i),await jh(n,i)}}async function jh(n,e,t){if(!Nu(e))throw e;n.Ea.add(1),await Wc(n),n.Ra.set("Offline"),t||(t=()=>AA(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Le(al,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await vf(n)}))}function MA(n,e){return e().catch((t=>jh(n,t,e)))}async function Tf(n){const e=nt(n),t=ua(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Gg;for(;OV(e);)try{const r=await yV(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,UV(e,r)}catch(r){await jh(e,r)}PA(e)&&DA(e)}function OV(n){return cl(n)&&n.Ta.length<10}function UV(n,e){n.Ta.push(e);const t=ua(n);t.O_()&&t.X_&&t.ea(e.mutations)}function PA(n){return cl(n)&&!ua(n).x_()&&n.Ta.length>0}function DA(n){ua(n).start()}async function zV(n){ua(n).ra()}async function BV(n){const e=ua(n);for(const t of n.Ta)e.ea(t.mutations)}async function FV(n,e,t){const i=n.Ta.shift(),r=Xg.from(i,e,t);await MA(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Tf(n)}async function qV(n,e){e&&ua(n).X_&&await(async function(i,r){if((function(c){return w3(c)&&c!==Ee.ABORTED})(r.code)){const u=i.Ta.shift();ua(i).B_(),await MA(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,r))),await Tf(i)}})(n,e),PA(n)&&DA(n)}async function yx(n,e){const t=nt(n);t.asyncQueue.verifyOperationInProgress(),Le(al,"RemoteStore received new credentials");const i=cl(t);t.Ea.add(3),await Wc(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await vf(t)}async function HV(n,e){const t=nt(n);e?(t.Ea.delete(2),await vf(t)):e||(t.Ea.add(2),await Wc(t),t.Ra.set("Unknown"))}function Ru(n){return n.ma||(n.ma=(function(t,i,r){const u=nt(t);return u.sa(),new bV(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,r)})(n.datastore,n.asyncQueue,{Xo:DV.bind(null,n),t_:kV.bind(null,n),r_:LV.bind(null,n),H_:VV.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),l_(n)?a_(n):n.Ra.set("Unknown")):(await n.ma.stop(),RA(n))}))),n.ma}function ua(n){return n.fa||(n.fa=(function(t,i,r){const u=nt(t);return u.sa(),new IV(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:zV.bind(null,n),r_:qV.bind(null,n),ta:BV.bind(null,n),na:FV.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Tf(n)):(await n.fa.stop(),n.Ta.length>0&&(Le(al,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e,t,i,r,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=u,this.deferred=new tl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,u){const c=Date.now()+i,m=new u_(e,t,c,r,u);return m.start(i),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ve(Ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function c_(n,e){if(sr("AsyncQueue",`${e}: ${n}`),Nu(n))return new Ve(Ee.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{static emptySet(e){return new lu(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||He.comparator(t.key,i.key):(t,i)=>He.comparator(t.key,i.key),this.keyedMap=xc(),this.sortedSet=new rn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof lu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,u=i.getNext().key;if(!r.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new lu;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(){this.ga=new rn(He.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Ye(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class yu{constructor(e,t,i,r,u,c,m,g,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=u,this.fromCache=c,this.syncStateChanged=m,this.excludesMetadataChanges=g,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,r,u){const c=[];return t.forEach((m=>{c.push({type:0,doc:m})})),new yu(e,t,lu.emptySet(t),c,i,r,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ff(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class jV{constructor(){this.queries=Tx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=nt(t),u=r.queries;r.queries=Tx(),u.forEach(((c,m)=>{for(const g of m.Sa)g.onError(i)}))})(this,new Ve(Ee.ABORTED,"Firestore shutting down"))}}function Tx(){return new ul((n=>eA(n)),ff)}async function ZV(n,e){const t=nt(n);let i=3;const r=e.query;let u=t.queries.get(r);u?!u.ba()&&e.Da()&&(i=2):(u=new GV,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(r,!0);break;case 1:u.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(c){const m=c_(c,`Initialization of query '${Xl(e.query)}' failed`);return void e.onError(m)}t.queries.set(r,u),u.Sa.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&d_(t)}async function KV(n,e){const t=nt(n),i=e.query;let r=3;const u=t.queries.get(i);if(u){const c=u.Sa.indexOf(e);c>=0&&(u.Sa.splice(c,1),u.Sa.length===0?r=e.Da()?0:1:!u.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function YV(n,e){const t=nt(n);let i=!1;for(const r of e){const u=r.query,c=t.queries.get(u);if(c){for(const m of c.Sa)m.Fa(r)&&(i=!0);c.wa=r}}i&&d_(t)}function JV(n,e,t){const i=nt(n),r=i.queries.get(e);if(r)for(const u of r.Sa)u.onError(t);i.queries.delete(e)}function d_(n){n.Ca.forEach((e=>{e.next()}))}var rg,Ex;(Ex=rg||(rg={})).Ma="default",Ex.Cache="cache";class WV{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new yu(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=yu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==rg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e){this.key=e}}class LA{constructor(e){this.key=e}}class QV{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Et(),this.mutatedKeys=Et(),this.eu=tA(e),this.tu=new lu(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new vx,r=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,c=r,m=!1;const g=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,p=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((x,A)=>{const b=r.get(x),M=mf(this.query,A)?A:null,K=!!b&&this.mutatedKeys.has(b.key),G=!!M&&(M.hasLocalMutations||this.mutatedKeys.has(M.key)&&M.hasCommittedMutations);let z=!1;b&&M?b.data.isEqual(M.data)?K!==G&&(i.track({type:3,doc:M}),z=!0):this.su(b,M)||(i.track({type:2,doc:M}),z=!0,(g&&this.eu(M,g)>0||p&&this.eu(M,p)<0)&&(m=!0)):!b&&M?(i.track({type:0,doc:M}),z=!0):b&&!M&&(i.track({type:1,doc:b}),z=!0,(g||p)&&(m=!0)),z&&(M?(c=c.add(M),u=G?u.add(x):u.delete(x)):(c=c.delete(x),u=u.delete(x)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const x=this.query.limitType==="F"?c.last():c.first();c=c.delete(x.key),u=u.delete(x.key),i.track({type:1,doc:x})}return{tu:c,iu:i,Cs:m,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((x,A)=>(function(M,K){const G=z=>{switch(z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ye(20277,{Rt:z})}};return G(M)-G(K)})(x.type,A.type)||this.eu(x.doc,A.doc))),this.ou(i),r=r??!1;const m=t&&!r?this._u():[],g=this.Xa.size===0&&this.current&&!r?1:0,p=g!==this.Za;return this.Za=g,c.length!==0||p?{snapshot:new yu(this.query,e.tu,u,c,e.mutatedKeys,g===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new vx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Et(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new LA(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new kA(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=Et();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return yu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const h_="SyncEngine";class XV{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class $V{constructor(e){this.key=e,this.hu=!1}}class e6{constructor(e,t,i,r,u,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=u,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new ul((m=>eA(m)),ff),this.Iu=new Map,this.Eu=new Set,this.du=new rn(He.comparator),this.Au=new Map,this.Ru=new t_,this.Vu={},this.mu=new Map,this.fu=_u.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function t6(n,e,t=!0){const i=FA(n);let r;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),r=u.view.lu()):r=await VA(i,e,t,!0),r}async function n6(n,e){const t=FA(n);await VA(t,e,!0,!1)}async function VA(n,e,t,i){const r=await vV(n.localStore,_o(e)),u=r.targetId,c=n.sharedClientState.addLocalQueryTarget(u,t);let m;return i&&(m=await i6(n,e,u,c==="current",r.resumeToken)),n.isPrimaryClient&&t&&IA(n.remoteStore,r),m}async function i6(n,e,t,i,r){n.pu=(A,b,M)=>(async function(G,z,W,te){let Q=z.view.ru(W);Q.Cs&&(Q=await fx(G.localStore,z.query,!1).then((({documents:V})=>z.view.ru(V,Q))));const me=te&&te.targetChanges.get(z.targetId),de=te&&te.targetMismatches.get(z.targetId)!=null,fe=z.view.applyChanges(Q,G.isPrimaryClient,me,de);return wx(G,z.targetId,fe.au),fe.snapshot})(n,A,b,M);const u=await fx(n.localStore,e,!0),c=new QV(e,u.Qs),m=c.ru(u.documents),g=Jc.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),p=c.applyChanges(m,n.isPrimaryClient,g);wx(n,t,p.au);const x=new XV(e,t,c);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function s6(n,e,t){const i=nt(n),r=i.Tu.get(e),u=i.Iu.get(r.targetId);if(u.length>1)return i.Iu.set(r.targetId,u.filter((c=>!ff(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await sg(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&o_(i.remoteStore,r.targetId),ag(i,r.targetId)})).catch(Iu)):(ag(i,r.targetId),await sg(i.localStore,r.targetId,!0))}async function o6(n,e){const t=nt(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),o_(t.remoteStore,i.targetId))}async function r6(n,e,t){const i=f6(n);try{const r=await(function(c,m){const g=nt(c),p=$t.now(),x=m.reduce(((M,K)=>M.add(K.key)),Et());let A,b;return g.persistence.runTransaction("Locally write mutations","readwrite",(M=>{let K=or(),G=Et();return g.Ns.getEntries(M,x).next((z=>{K=z,K.forEach(((W,te)=>{te.isValidDocument()||(G=G.add(W))}))})).next((()=>g.localDocuments.getOverlayedDocuments(M,K))).next((z=>{A=z;const W=[];for(const te of m){const Q=y3(te,A.get(te.key).overlayedDocument);Q!=null&&W.push(new fa(te.key,Q,ZS(Q.value.mapValue),Gs.exists(!0)))}return g.mutationQueue.addMutationBatch(M,p,W,m)})).next((z=>{b=z;const W=z.applyToLocalDocumentSet(A,G);return g.documentOverlayCache.saveOverlays(M,z.batchId,W)}))})).then((()=>({batchId:b.batchId,changes:iA(A)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(c,m,g){let p=c.Vu[c.currentUser.toKey()];p||(p=new rn(Tt)),p=p.insert(m,g),c.Vu[c.currentUser.toKey()]=p})(i,r.batchId,t),await Qc(i,r.changes),await Tf(i.remoteStore)}catch(r){const u=c_(r,"Failed to persist write");t.reject(u)}}async function OA(n,e){const t=nt(n);try{const i=await gV(t.localStore,e);e.targetChanges.forEach(((r,u)=>{const c=t.Au.get(u);c&&(Pt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?c.hu=!0:r.modifiedDocuments.size>0?Pt(c.hu,14607):r.removedDocuments.size>0&&(Pt(c.hu,42227),c.hu=!1))})),await Qc(t,i,e)}catch(i){await Iu(i)}}function xx(n,e,t){const i=nt(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((u,c)=>{const m=c.view.va(e);m.snapshot&&r.push(m.snapshot)})),(function(c,m){const g=nt(c);g.onlineState=m;let p=!1;g.queries.forEach(((x,A)=>{for(const b of A.Sa)b.va(m)&&(p=!0)})),p&&d_(g)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function a6(n,e,t){const i=nt(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),u=r&&r.key;if(u){let c=new rn(He.comparator);c=c.insert(u,oi.newNoDocument(u,et.min()));const m=Et().add(u),g=new _f(et.min(),new Map,new rn(Tt),c,m);await OA(i,g),i.du=i.du.remove(u),i.Au.delete(e),f_(i)}else await sg(i.localStore,e,!1).then((()=>ag(i,e,t))).catch(Iu)}async function l6(n,e){const t=nt(n),i=e.batch.batchId;try{const r=await pV(t.localStore,e);zA(t,i,null),UA(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Qc(t,r)}catch(r){await Iu(r)}}async function u6(n,e,t){const i=nt(n);try{const r=await(function(c,m){const g=nt(c);return g.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let x;return g.mutationQueue.lookupMutationBatch(p,m).next((A=>(Pt(A!==null,37113),x=A.keys(),g.mutationQueue.removeMutationBatch(p,A)))).next((()=>g.mutationQueue.performConsistencyCheck(p))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(p,x,m))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,x))).next((()=>g.localDocuments.getDocuments(p,x)))}))})(i.localStore,e);zA(i,e,t),UA(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Qc(i,r)}catch(r){await Iu(r)}}function UA(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function zA(n,e,t){const i=nt(n);let r=i.Vu[i.currentUser.toKey()];if(r){const u=r.get(e);u&&(t?u.reject(t):u.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function ag(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||BA(n,i)}))}function BA(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(o_(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),f_(n))}function wx(n,e,t){for(const i of t)i instanceof kA?(n.Ru.addReference(i.key,e),c6(n,i)):i instanceof LA?(Le(h_,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||BA(n,i.key)):Ye(19791,{wu:i})}function c6(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(Le(h_,"New document in limbo: "+t),n.Eu.add(i),f_(n))}function f_(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new He(Zt.fromString(e)),i=n.fu.next();n.Au.set(i,new $V(t)),n.du=n.du.insert(t,i),IA(n.remoteStore,new Xr(_o(Jg(t.path)),i,"TargetPurposeLimboResolution",cf.ce))}}async function Qc(n,e,t){const i=nt(n),r=[],u=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((m,g)=>{c.push(i.pu(g,e,t).then((p=>{var x;if((p||t)&&i.isPrimaryClient){const A=p?!p.fromCache:(x=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:x.current;i.sharedClientState.updateQueryState(g.targetId,A?"current":"not-current")}if(p){r.push(p);const A=i_.As(g.targetId,p);u.push(A)}})))})),await Promise.all(c),i.Pu.H_(r),await(async function(g,p){const x=nt(g);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(A=>xe.forEach(p,(b=>xe.forEach(b.Es,(M=>x.persistence.referenceDelegate.addReference(A,b.targetId,M))).next((()=>xe.forEach(b.ds,(M=>x.persistence.referenceDelegate.removeReference(A,b.targetId,M)))))))))}catch(A){if(!Nu(A))throw A;Le(s_,"Failed to update sequence numbers: "+A)}for(const A of p){const b=A.targetId;if(!A.fromCache){const M=x.Ms.get(b),K=M.snapshotVersion,G=M.withLastLimboFreeSnapshotVersion(K);x.Ms=x.Ms.insert(b,G)}}})(i.localStore,u))}async function d6(n,e){const t=nt(n);if(!t.currentUser.isEqual(e)){Le(h_,"User change. New user:",e.toKey());const i=await SA(t.localStore,e);t.currentUser=e,(function(u,c){u.mu.forEach((m=>{m.forEach((g=>{g.reject(new Ve(Ee.CANCELLED,c))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Qc(t,i.Ls)}}function h6(n,e){const t=nt(n),i=t.Au.get(e);if(i&&i.hu)return Et().add(i.key);{let r=Et();const u=t.Iu.get(e);if(!u)return r;for(const c of u){const m=t.Tu.get(c);r=r.unionWith(m.view.nu)}return r}}function FA(n){const e=nt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=OA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=h6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=a6.bind(null,e),e.Pu.H_=YV.bind(null,e.eventManager),e.Pu.yu=JV.bind(null,e.eventManager),e}function f6(n){const e=nt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=l6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=u6.bind(null,e),e}class Zh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return mV(this.persistence,new dV,e.initialUser,this.serializer)}Cu(e){return new wA(n_.mi,this.serializer)}Du(e){return new EV}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zh.provider={build:()=>new Zh};class m6 extends Zh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Pt(this.persistence.referenceDelegate instanceof Gh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new W3(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ki.withCacheSize(this.cacheSizeBytes):ki.DEFAULT;return new wA((i=>Gh.mi(i,t)),this.serializer)}}class lg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>xx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=d6.bind(null,this.syncEngine),await HV(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new jV})()}createDatastore(e){const t=yf(e.databaseInfo.databaseId),i=(function(u){return new CV(u)})(e.databaseInfo);return(function(u,c,m,g){return new RV(u,c,m,g)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,u,c,m){return new PV(i,r,u,c,m)})(this.localStore,this.datastore,e.asyncQueue,(t=>xx(this.syncEngine,t,0)),(function(){return gx.v()?new gx:new xV})())}createSyncEngine(e,t){return(function(r,u,c,m,g,p,x){const A=new e6(r,u,c,m,g,p);return x&&(A.gu=!0),A})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const u=nt(r);Le(al,"RemoteStore shutting down."),u.Ea.add(5),await Wc(u),u.Aa.shutdown(),u.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}lg.provider={build:()=>new lg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):sr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca="FirestoreClient";class g6{constructor(e,t,i,r,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=si.UNAUTHENTICATED,this.clientId=Hg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async c=>{Le(ca,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Le(ca,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new tl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=c_(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Ap(n,e){n.asyncQueue.verifyOperationInProgress(),Le(ca,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await SA(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Sx(n,e){n.asyncQueue.verifyOperationInProgress();const t=await _6(n);Le(ca,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>yx(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>yx(e.remoteStore,r))),n._onlineComponents=e}async function _6(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Le(ca,"Using user provided OfflineComponentProvider");try{await Ap(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===Ee.FAILED_PRECONDITION||r.code===Ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;fu("Error using user provided cache. Falling back to memory cache: "+t),await Ap(n,new Zh)}}else Le(ca,"Using default OfflineComponentProvider"),await Ap(n,new m6(void 0));return n._offlineComponents}async function qA(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Le(ca,"Using user provided OnlineComponentProvider"),await Sx(n,n._uninitializedComponentsProvider._online)):(Le(ca,"Using default OnlineComponentProvider"),await Sx(n,new lg))),n._onlineComponents}function y6(n){return qA(n).then((e=>e.syncEngine))}async function Ax(n){const e=await qA(n),t=e.eventManager;return t.onListen=t6.bind(null,e.syncEngine),t.onUnlisten=s6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=n6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=o6.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GA="firestore.googleapis.com",bx=!0;class Ix{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ve(Ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=GA,this.ssl=bx}else this.host=e.host,this.ssl=e.ssl??bx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=xA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Y3)throw new Ve(Ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}M4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=HA(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ve(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ve(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ve(Ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ef{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ix({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ve(Ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ve(Ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ix(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new E4;switch(i.type){case"firstParty":return new A4(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ve(Ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=Cx.get(t);i&&(Le("ComponentProvider","Removing Datastore"),Cx.delete(t),i.terminate())})(this),Promise.resolve()}}function v6(n,e,t,i={}){var p;n=ia(n,Ef);const r=Su(e),u=n._getSettings(),c={...u,emulatorOptions:n._getEmulatorOptions()},m=`${e}:${t}`;r&&(Hw(`https://${m}`),Gw("Firestore",!0)),u.host!==GA&&u.host!==m&&fu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:m,ssl:r,emulatorOptions:i};if(!il(g,c)&&(n._setSettings(g),i.mockUserToken)){let x,A;if(typeof i.mockUserToken=="string")x=i.mockUserToken,A=si.MOCK_USER;else{x=j5(i.mockUserToken,(p=n._app)==null?void 0:p.options.projectId);const b=i.mockUserToken.sub||i.mockUserToken.user_id;if(!b)throw new Ve(Ee.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");A=new si(b)}n._authCredentials=new x4(new kS(x,A))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Mu(this.firestore,e,this._query)}}class bn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bn(this.firestore,e,this._key)}toJSON(){return{type:bn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Zc(t,bn._jsonSchema))return new bn(e,i||null,new He(Zt.fromString(t.referencePath)))}}bn._jsonSchemaVersion="firestore/documentReference/1.0",bn._jsonSchema={type:Cn("string",bn._jsonSchemaVersion),referencePath:Cn("string")};class sa extends Mu{constructor(e,t,i){super(e,t,Jg(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bn(this.firestore,null,new He(e))}withConverter(e){return new sa(this.firestore,e,this._path)}}function Nx(n,e,...t){if(n=Hn(n),LS("collection","path",e),n instanceof Ef){const i=Zt.fromString(e,...t);return BE(i),new sa(n,null,i)}{if(!(n instanceof bn||n instanceof sa))throw new Ve(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Zt.fromString(e,...t));return BE(i),new sa(n.firestore,null,i)}}function ug(n,e,...t){if(n=Hn(n),arguments.length===1&&(e=Hg.newId()),LS("doc","path",e),n instanceof Ef){const i=Zt.fromString(e,...t);return zE(i),new bn(n,null,new He(i))}{if(!(n instanceof bn||n instanceof sa))throw new Ve(Ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Zt.fromString(e,...t));return zE(i),new bn(n.firestore,n instanceof sa?n.converter:null,new He(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rx="AsyncQueue";class Mx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new CA(this,"async_queue_retry"),this._c=()=>{const i=Sp();i&&Le(Rx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Sp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Sp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new tl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Nu(e))throw e;Le(Rx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,sr("INTERNAL UNHANDLED ERROR: ",Px(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=u_.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(r),r}uc(){this.nc&&Ye(47125,{Pc:Px(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Px(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const u of i)if(u in r&&typeof r[u]=="function")return!0;return!1})(n,["next","error","complete"])}class vu extends Ef{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Mx,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Mx(e),this._firestoreClient=void 0,await e}}}function T6(n,e){const t=typeof n=="object"?n:Yw(),i=typeof n=="string"?n:Uh,r=Mg(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const u=H5("firestore");u&&v6(r,...u)}return r}function jA(n){if(n._terminated)throw new Ve(Ee.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||E6(n),n._firestoreClient}function E6(n){var i,r,u;const e=n._freezeSettings(),t=(function(m,g,p,x){return new q4(m,g,p,x.host,x.ssl,x.experimentalForceLongPolling,x.experimentalAutoDetectLongPolling,HA(x.experimentalLongPollingOptions),x.useFetchStreams,x.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((u=e.localCache)!=null&&u._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new g6(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(m){const g=m==null?void 0:m._online.build();return{_offline:m==null?void 0:m._offline.build(g),_online:g}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ws(Jn.fromBase64String(e))}catch(t){throw new Ve(Ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ws(Jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ws._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Zc(e,ws._jsonSchema))return ws.fromBase64String(e.bytes)}}ws._jsonSchemaVersion="firestore/bytes/1.0",ws._jsonSchema={type:Cn("string",ws._jsonSchemaVersion),bytes:Cn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ve(Ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Yn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ve(Ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ve(Ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Tt(this._lat,e._lat)||Tt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:vo._jsonSchemaVersion}}static fromJSON(e){if(Zc(e,vo._jsonSchema))return new vo(e.latitude,e.longitude)}}vo._jsonSchemaVersion="firestore/geoPoint/1.0",vo._jsonSchema={type:Cn("string",vo._jsonSchemaVersion),latitude:Cn("number"),longitude:Cn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==r[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:To._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Zc(e,To._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new To(e.vectorValues);throw new Ve(Ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}To._jsonSchemaVersion="firestore/vectorValue/1.0",To._jsonSchema={type:Cn("string",To._jsonSchemaVersion),vectorValues:Cn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x6=/^__.*__$/;class w6{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new fa(e,this.data,this.fieldMask,t,this.fieldTransforms):new Yc(e,this.data,t,this.fieldTransforms)}}class ZA{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new fa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function KA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ye(40011,{Ac:n})}}class m_{constructor(e,t,i,r,u,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,u===void 0&&this.Rc(),this.fieldTransforms=u||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new m_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Kh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(KA(this.Ac)&&x6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class S6{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||yf(e)}Cc(e,t,i,r=!1){return new m_({Ac:e,methodName:t,Dc:i,path:Yn.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function p_(n){const e=n._freezeSettings(),t=yf(n._databaseId);return new S6(n._databaseId,!!e.ignoreUndefinedProperties,t)}function A6(n,e,t,i,r,u={}){const c=n.Cc(u.merge||u.mergeFields?2:0,e,t,r);__("Data must be an object, but it was:",c,i);const m=YA(i,c);let g,p;if(u.merge)g=new ts(c.fieldMask),p=c.fieldTransforms;else if(u.mergeFields){const x=[];for(const A of u.mergeFields){const b=cg(e,A,t);if(!c.contains(b))throw new Ve(Ee.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);WA(x,b)||x.push(b)}g=new ts(x),p=c.fieldTransforms.filter((A=>g.covers(A.field)))}else g=null,p=c.fieldTransforms;return new w6(new Li(m),g,p)}class Sf extends wf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sf}}class g_ extends wf{_toFieldTransform(e){return new m3(e.path,new Uc)}isEqual(e){return e instanceof g_}}function C6(n,e,t,i){const r=n.Cc(1,e,t);__("Data must be an object, but it was:",r,i);const u=[],c=Li.empty();ha(i,((g,p)=>{const x=y_(e,g,t);p=Hn(p);const A=r.yc(x);if(p instanceof Sf)u.push(x);else{const b=Xc(p,A);b!=null&&(u.push(x),c.set(x,b))}}));const m=new ts(u);return new ZA(c,m,r.fieldTransforms)}function b6(n,e,t,i,r,u){const c=n.Cc(1,e,t),m=[cg(e,i,t)],g=[r];if(u.length%2!=0)throw new Ve(Ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<u.length;b+=2)m.push(cg(e,u[b])),g.push(u[b+1]);const p=[],x=Li.empty();for(let b=m.length-1;b>=0;--b)if(!WA(p,m[b])){const M=m[b];let K=g[b];K=Hn(K);const G=c.yc(M);if(K instanceof Sf)p.push(M);else{const z=Xc(K,G);z!=null&&(p.push(M),x.set(M,z))}}const A=new ts(p);return new ZA(x,A,c.fieldTransforms)}function I6(n,e,t,i=!1){return Xc(t,n.Cc(i?4:3,e))}function Xc(n,e){if(JA(n=Hn(n)))return __("Unsupported field value:",e,n),YA(n,e);if(n instanceof wf)return(function(i,r){if(!KA(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(r);u&&r.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,r){const u=[];let c=0;for(const m of i){let g=Xc(m,r.wc(c));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),c++}return{arrayValue:{values:u}}})(n,e)}return(function(i,r){if((i=Hn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return d3(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=$t.fromDate(i);return{timestampValue:Hh(r.serializer,u)}}if(i instanceof $t){const u=new $t(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Hh(r.serializer,u)}}if(i instanceof vo)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ws)return{bytesValue:pA(r.serializer,i._byteString)};if(i instanceof bn){const u=r.databaseId,c=i.firestore._databaseId;if(!c.isEqual(u))throw r.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:e_(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof To)return(function(c,m){return{mapValue:{fields:{[GS]:{stringValue:jS},[zh]:{arrayValue:{values:c.toArray().map((p=>{if(typeof p!="number")throw m.Sc("VectorValues must only contain numeric values.");return Wg(m.serializer,p)}))}}}}}})(i,r);throw r.Sc(`Unsupported field value: ${uf(i)}`)})(n,e)}function YA(n,e){const t={};return US(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ha(n,((i,r)=>{const u=Xc(r,e.mc(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function JA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof $t||n instanceof vo||n instanceof ws||n instanceof bn||n instanceof wf||n instanceof To)}function __(n,e,t){if(!JA(t)||!VS(t)){const i=uf(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function cg(n,e,t){if((e=Hn(e))instanceof xf)return e._internalPath;if(typeof e=="string")return y_(n,e);throw Kh("Field path arguments must be of type string or ",n,!1,void 0,t)}const N6=new RegExp("[~\\*/\\[\\]]");function y_(n,e,t){if(e.search(N6)>=0)throw Kh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new xf(...e.split("."))._internalPath}catch{throw Kh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Kh(n,e,t,i,r){const u=i&&!i.isEmpty(),c=r!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let g="";return(u||c)&&(g+=" (found",u&&(g+=` in field ${i}`),c&&(g+=` in document ${r}`),g+=")"),new Ve(Ee.INVALID_ARGUMENT,m+n+g)}function WA(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(e,t,i,r,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new R6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(v_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class R6 extends QA{data(){return super.data()}}function v_(n,e){return typeof e=="string"?y_(n,e):e instanceof xf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M6(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ve(Ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class T_{}class P6 extends T_{}function D6(n,e,...t){let i=[];e instanceof T_&&i.push(e),i=i.concat(t),(function(u){const c=u.filter((g=>g instanceof E_)).length,m=u.filter((g=>g instanceof Af)).length;if(c>1||c>0&&m>0)throw new Ve(Ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class Af extends P6{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Af(e,t,i)}_apply(e){const t=this._parse(e);return XA(e._query,t),new Mu(e.firestore,e.converter,Xp(e._query,t))}_parse(e){const t=p_(e.firestore);return(function(u,c,m,g,p,x,A){let b;if(p.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new Ve(Ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){Lx(A,x);const K=[];for(const G of A)K.push(kx(g,u,G));b={arrayValue:{values:K}}}else b=kx(g,u,A)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||Lx(A,x),b=I6(m,c,A,x==="in"||x==="not-in");return An.create(p,x,b)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function k6(n,e,t){const i=e,r=v_("where",n);return Af._create(r,i,t)}class E_ extends T_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new E_(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:js.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,u){let c=r;const m=u.getFlattenedFilters();for(const g of m)XA(c,g),c=Xp(c,g)})(e._query,t),new Mu(e.firestore,e.converter,Xp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function kx(n,e,t){if(typeof(t=Hn(t))=="string"){if(t==="")throw new Ve(Ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$S(e)&&t.indexOf("/")!==-1)throw new Ve(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(Zt.fromString(t));if(!He.isDocumentKey(i))throw new Ve(Ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return YE(n,new He(i))}if(t instanceof bn)return YE(n,t._key);throw new Ve(Ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uf(t)}.`)}function Lx(n,e){if(!Array.isArray(n)||n.length===0)throw new Ve(Ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XA(n,e){const t=(function(r,u){for(const c of r)for(const m of c.getFlattenedFilters())if(u.indexOf(m.op)>=0)return m.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ve(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ve(Ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class L6{convertValue(e,t="none"){switch(la(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(aa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ye(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return ha(e,((r,u)=>{i[r]=this.convertValue(u,t)})),i}convertVectorValue(e){var i,r,u;const t=(u=(r=(i=e.fields)==null?void 0:i[zh].arrayValue)==null?void 0:r.values)==null?void 0:u.map((c=>pn(c.doubleValue)));return new To(t)}convertGeoPoint(e){return new vo(pn(e.latitude),pn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=hf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Lc(e));default:return null}}convertTimestamp(e){const t=ra(e);return new $t(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Zt.fromString(e);Pt(EA(i),9688,{name:e});const r=new Vc(i.get(1),i.get(3)),u=new He(i.popFirst(5));return r.isEqual(t)||sr(`Document ${u} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V6(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class Sc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nl extends QA{constructor(e,t,i,r,u,c){super(e,t,i,r,c),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(v_("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(Ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=nl._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}nl._jsonSchemaVersion="firestore/documentSnapshot/1.0",nl._jsonSchema={type:Cn("string",nl._jsonSchemaVersion),bundleSource:Cn("string","DocumentSnapshot"),bundleName:Cn("string"),bundle:Cn("string")};class wh extends nl{data(e={}){return super.data(e)}}class uu{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Sc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new wh(this._firestore,this._userDataWriter,i.key,i,new Sc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ve(Ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,u){if(r._snapshot.oldDocs.isEmpty()){let c=0;return r._snapshot.docChanges.map((m=>{const g=new wh(r._firestore,r._userDataWriter,m.doc.key,m.doc,new Sc(r._snapshot.mutatedKeys.has(m.doc.key),r._snapshot.fromCache),r.query.converter);return m.doc,{type:"added",doc:g,oldIndex:-1,newIndex:c++}}))}{let c=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((m=>u||m.type!==3)).map((m=>{const g=new wh(r._firestore,r._userDataWriter,m.doc.key,m.doc,new Sc(r._snapshot.mutatedKeys.has(m.doc.key),r._snapshot.fromCache),r.query.converter);let p=-1,x=-1;return m.type!==0&&(p=c.indexOf(m.doc.key),c=c.delete(m.doc.key)),m.type!==1&&(c=c.add(m.doc),x=c.indexOf(m.doc.key)),{type:O6(m.type),doc:g,oldIndex:p,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(Ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=uu._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Hg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),r.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function O6(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ye(61501,{type:n})}}uu._jsonSchemaVersion="firestore/querySnapshot/1.0",uu._jsonSchema={type:Cn("string",uu._jsonSchemaVersion),bundleSource:Cn("string","QuerySnapshot"),bundleName:Cn("string"),bundle:Cn("string")};class $A extends L6{constructor(e){super(),this.firestore=e}convertBytes(e){return new ws(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new bn(this.firestore,null,t)}}function U6(n,e,t,...i){n=ia(n,bn);const r=ia(n.firestore,vu),u=p_(r);let c;return c=typeof(e=Hn(e))=="string"||e instanceof xf?b6(u,"updateDoc",n._key,e,t,i):C6(u,"updateDoc",n._key,e),x_(r,[c.toMutation(n._key,Gs.exists(!0))])}function z6(n){return x_(ia(n.firestore,vu),[new Qg(n._key,Gs.none())])}function B6(n,e){const t=ia(n.firestore,vu),i=ug(n),r=V6(n.converter,e);return x_(t,[A6(p_(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Gs.exists(!1))]).then((()=>i))}function F6(n,...e){var g,p,x;n=Hn(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Dx(e[i])||(t=e[i++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Dx(e[i])){const A=e[i];e[i]=(g=A.next)==null?void 0:g.bind(A),e[i+1]=(p=A.error)==null?void 0:p.bind(A),e[i+2]=(x=A.complete)==null?void 0:x.bind(A)}let u,c,m;if(n instanceof bn)c=ia(n.firestore,vu),m=Jg(n._key.path),u={next:A=>{e[i]&&e[i](q6(c,n,A))},error:e[i+1],complete:e[i+2]};else{const A=ia(n,Mu);c=ia(A.firestore,vu),m=A._query;const b=new $A(c);u={next:M=>{e[i]&&e[i](new uu(c,b,A,M))},error:e[i+1],complete:e[i+2]},M6(n._query)}return(function(b,M,K,G){const z=new p6(G),W=new WV(M,z,K);return b.asyncQueue.enqueueAndForget((async()=>ZV(await Ax(b),W))),()=>{z.Nu(),b.asyncQueue.enqueueAndForget((async()=>KV(await Ax(b),W)))}})(jA(c),m,r,u)}function x_(n,e){return(function(i,r){const u=new tl;return i.asyncQueue.enqueueAndForget((async()=>r6(await y6(i),r,u))),u.promise})(jA(n),e)}function q6(n,e,t){const i=t.docs.get(e._key),r=new $A(n);return new nl(n,r,e._key,i,new Sc(t.hasPendingWrites,t.fromCache),e.converter)}function H6(){return new g_("serverTimestamp")}(function(e,t=!0){(function(r){bu=r})(Au),du(new sl("firestore",((i,{instanceIdentifier:r,options:u})=>{const c=i.getProvider("app").getImmediate(),m=new vu(new w4(i.getProvider("auth-internal")),new C4(c,i.getProvider("app-check-internal")),(function(p,x){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Ve(Ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vc(p.options.projectId,x)})(c,r),c);return u={useFetchStreams:t,...u},m._setSettings(u),m}),"PUBLIC").setMultipleInstances(!0)),ta(LE,VE,e),ta(LE,VE,"esm2020")})();const G6={apiKey:"AIzaSyBCnLlCaVWh9iKhclzPWJcEPDuyH0OHPUM",authDomain:"ques-trip.firebaseapp.com",projectId:"ques-trip",storageBucket:"ques-trip.firebasestorage.app",messagingSenderId:"765263595886",appId:"1:765263595886:web:3e501d362abe47bfb8597f",measurementId:"G-R1NF9EVRHY"},w_=Kw(G6);console.log("Firebase App Initialized:",w_.name);const dg=_4(w_),j6=new Qo,dh=T6(w_),Z6=({onLogin:n})=>{const[e,t]=X.useState(""),[i,r]=X.useState(!1),u=async()=>{console.log("Attempting Google Login..."),r(!0),t("");try{const c=await CL(dg,j6);console.log("Google Login Success:",c.user.uid)}catch(c){console.error("Login failed",c),t(c.message||"")}finally{r(!1)}};return E.jsx("div",{className:"h-full flex flex-col items-center justify-center p-6 bg-paper",children:E.jsxs("div",{className:"w-full max-w-sm bg-white rounded-3xl shadow-card p-8 border border-sand text-center",children:[E.jsxs("div",{className:"flex flex-col items-center mb-8",children:[E.jsx("div",{className:"w-16 h-16 bg-coral rounded-2xl flex items-center justify-center mb-4 shadow-lg shadow-coral/30",children:E.jsx(po,{className:"w-8 h-8 text-white"})}),E.jsx("h1",{className:"text-2xl font-bold text-ink",children:"Ques-trip"}),E.jsx("p",{className:"text-gray-400 text-sm mt-2",children:""})]}),E.jsxs("div",{className:"space-y-4",children:[E.jsxs("button",{id:"google-login-btn",onClick:u,disabled:i,className:"w-full bg-white border border-gray-300 text-gray-700 py-3.5 rounded-xl font-bold shadow-sm hover:bg-gray-50 active:scale-95 transition-all flex items-center justify-center gap-3",children:[i?E.jsx("div",{className:"w-5 h-5 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}):E.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[E.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),E.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),E.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.84z",fill:"#FBBC05"}),E.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]})," Google "]}),e&&E.jsx("div",{className:"text-red-500 text-sm font-medium bg-red-50 p-2 rounded-lg",children:e})]})]})})},K6=({memories:n,onAddMemory:e,onDeleteMemory:t,settings:i})=>{const[r,u]=X.useState(""),[c,m]=X.useState(null),g=X.useRef(null),p=async A=>{var M;const b=(M=A.target.files)==null?void 0:M[0];if(b)try{const{compressImage:K}=await $h(async()=>{const{compressImage:z}=await import("./image-CYcWJ_KT.js");return{compressImage:z}},[]),G=await K(b);m(G)}catch(K){console.error("Image compression failed",K),alert("")}},x=A=>{if(A.preventDefault(),!c)return;const b={id:Date.now().toString(),userId:"",imageUrl:c,caption:r,date:new Date().toISOString()};e(b),u(""),m(null),g.current&&(g.current.value="")};return E.jsxs("div",{className:"h-full flex flex-col bg-paper animate-slide-in pb-24",children:[E.jsxs("div",{className:"px-6 py-6 bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-sand pt-safe pt-12",children:[E.jsxs("h1",{className:"text-2xl font-bold text-ink flex items-center gap-2",children:[E.jsx(cu,{className:"w-8 h-8 text-coral"}),""]}),E.jsx("p",{className:"text-sm text-gray-400 mt-1",children:""})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[E.jsx("div",{className:"bg-white rounded-3xl p-6 shadow-card border border-sand",children:E.jsxs("form",{onSubmit:x,className:"space-y-4",children:[E.jsxs("div",{onClick:()=>{var A;return(A=g.current)==null?void 0:A.click()},className:`relative w-full aspect-video rounded-2xl border-2 border-dashed border-sand flex flex-col items-center justify-center cursor-pointer transition-all hover:bg-gray-50 ${c?"border-none p-0 overflow-hidden":""}`,children:[c?E.jsx("img",{src:c,alt:"Preview",className:"w-full h-full object-cover"}):E.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[E.jsx(cu,{className:"w-12 h-12 mb-2"}),E.jsx("span",{className:"font-medium",children:""})]}),E.jsx("input",{type:"file",ref:g,onChange:p,accept:"image/*",className:"hidden"})]}),E.jsx("textarea",{value:r,onChange:A=>u(A.target.value),placeholder:"...",className:"w-full bg-paper rounded-xl p-4 text-ink font-medium outline-none focus:ring-2 focus:ring-coral/50 transition-all border border-sand resize-none h-24"}),E.jsxs("button",{type:"submit",disabled:!c,className:`w-full py-3.5 rounded-xl font-bold shadow-lg transition-all flex items-center justify-center gap-2 ${c?"bg-coral text-white shadow-coral/30 active:scale-95":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[E.jsx(Yh,{className:"w-5 h-5"}),""]})]})}),E.jsx("div",{className:"grid grid-cols-1 gap-6",children:n.length===0?E.jsxs("div",{className:"text-center py-12 text-gray-400",children:[E.jsx("p",{children:""}),E.jsx("p",{className:"text-sm mt-2",children:""})]}):n.map(A=>E.jsxs("div",{className:"bg-white rounded-3xl overflow-hidden shadow-card border border-sand group",children:[E.jsxs("div",{className:"relative aspect-video",children:[E.jsx("img",{src:A.imageUrl,alt:A.caption,className:"w-full h-full object-cover"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-end p-4",children:E.jsx("button",{onClick:()=>t(A.id),className:"p-2 bg-white/20 backdrop-blur-md text-white rounded-full hover:bg-red-500 transition-colors",children:E.jsx(er,{className:"w-5 h-5"})})})]}),E.jsxs("div",{className:"p-5",children:[E.jsx("p",{className:"text-ink font-medium whitespace-pre-wrap",children:A.caption}),E.jsx("p",{className:"text-xs text-gray-400 mt-3",children:new Date(A.date).toLocaleDateString()})]})]},A.id))})]})]})};function Y6(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:i,onRegistered:r,onRegisteredSW:u,onRegisterError:c}=n;let m,g;const p=async(A=!0)=>{await g};async function x(){if("serviceWorker"in navigator){if(m=await $h(async()=>{const{Workbox:A}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:A}},[]).then(({Workbox:A})=>new A("/sw.js",{scope:"/",type:"classic"})).catch(A=>{c==null||c(A)}),!m)return;m.addEventListener("activated",A=>{(A.isUpdate||A.isExternal)&&window.location.reload()}),m.addEventListener("installed",A=>{A.isUpdate||i==null||i()}),m.register({immediate:e}).then(A=>{u?u("/sw.js",A):r==null||r(A)}).catch(A=>{c==null||c(A)})}}return g=x(),p}function J6(n={}){const{immediate:e=!0,onNeedRefresh:t,onOfflineReady:i,onRegistered:r,onRegisteredSW:u,onRegisterError:c}=n,[m,g]=X.useState(!1),[p,x]=X.useState(!1),[A]=X.useState(()=>Y6({immediate:e,onOfflineReady(){x(!0),i==null||i()},onNeedRefresh(){g(!0),t==null||t()},onRegistered:r,onRegisteredSW:u,onRegisterError:c}));return{needRefresh:[m,g],offlineReady:[p,x],updateServiceWorker:A}}const W6=({settings:n})=>{n&&jt[n.language]||jt["zh-TW"];const{offlineReady:[e,t],needRefresh:[i,r],updateServiceWorker:u}=J6({onRegistered(m){console.log("SW Registered: "+m)},onRegisterError(m){console.log("SW registration error",m)}}),c=()=>{t(!1),r(!1)};return!e&&!i?null:E.jsxs("div",{className:"fixed bottom-6 right-6 z-[1000] p-4 bg-ink text-white rounded-xl shadow-2xl animate-slide-up max-w-xs border border-white/10",children:[E.jsx("div",{className:"mb-3 font-bold",children:e?E.jsx("span",{children:"App ready to work offline"}):E.jsx("span",{children:"New content available, click on reload button to update."})}),E.jsxs("div",{className:"flex gap-2",children:[i&&E.jsx("button",{className:"flex-1 px-3 py-2 bg-coral text-white rounded-lg font-bold text-sm hover:bg-coralDark transition-colors",onClick:()=>u(!0),children:"Reload"}),E.jsx("button",{className:"flex-1 px-3 py-2 bg-white/10 text-white rounded-lg font-bold text-sm hover:bg-white/20 transition-colors",onClick:c,children:"Close"})]})]})},Q6={USERS:"nomad_app_users_v1",CURRENT_USER:"nomad_app_current_user_v1",getTripsKey:n=>`nomad_app_trips_${n} `,getSettingsKey:n=>`nomad_app_settings_${n} `,getMemoriesKey:n=>`nomad_app_memories_${n} `,getChatSessionsKey:n=>`nomad_app_chat_sessions_${n} `},X6=()=>{console.log("App Component Rendering...");const[n,e]=X.useState({id:"test-user-id",username:"Test User",password:"",createdAt:new Date().toISOString()}),[t,i]=X.useState([]),[r,u]=X.useState([]),[c,m]=X.useState([]),[g,p]=X.useState(null),[x,A]=X.useState({language:"zh-TW",minimalistMode:!1}),[b,M]=X.useState(!0),[K,G]=X.useState(null),[z,W]=X.useState($e.HOME),[te,Q]=X.useState(null),[me,de]=X.useState([]);X.useEffect(()=>{console.log("Setting up Auth Listener...");const ue=oL(dg,ge=>{if(console.log("Auth State Changed:",ge?"User Logged In":"User Logged Out",ge==null?void 0:ge.uid),ge){const Se={id:ge.uid,username:ge.displayName||"Traveler",password:"",createdAt:ge.metadata.creationTime||new Date().toISOString()};e(Se),console.log("Listening to trips for user:",ge.uid);const be=D6(Nx(dh,"itineraries"),k6("uid","==",ge.uid)),Me=F6(be,ke=>{const it=[];ke.forEach(ut=>{const je=ut.data();it.push({id:ut.id,...je})}),it.sort((ut,je)=>{const Ft=ut.createdAt?typeof ut.createdAt=="string"?new Date(ut.createdAt).getTime():ut.createdAt.toMillis?ut.createdAt.toMillis():0:0;return(je.createdAt?typeof je.createdAt=="string"?new Date(je.createdAt).getTime():je.createdAt.toMillis?je.createdAt.toMillis():0:0)-Ft}),i(it),M(!0),G(null)},ke=>{console.error("Error fetching trips:",ke),G(`Fetch Trips Error: ${ke.message}`),M(!0)});return()=>Me()}else e(null),i([]),M(!0)});return()=>ue()},[]);const fe=async ue=>{if(n)try{const{id:ge,...Se}=ue;await B6(Nx(dh,"itineraries"),{...Se,uid:n.id,createdAt:H6()}),z===$e.AI_PLANNER&&W($e.HOME)}catch(ge){console.error("Error adding trip",ge),G(`Add Trip Error: ${ge.message}`),alert(": "+ge.message)}},V=async ue=>{if(!(!n||!ue.id))try{const ge=ug(dh,"itineraries",ue.id),{id:Se,...be}=ue;await U6(ge,be),(te==null?void 0:te.id)===ue.id&&Q(ue)}catch(ge){console.error("Error updating trip",ge),alert("")}},O=async ue=>{try{await z6(ug(dh,"itineraries",ue)),(te==null?void 0:te.id)===ue&&(Q(null),W($e.HOME))}catch(ge){console.error("Error deleting trip",ge),alert("")}},U=X.useCallback(async(ue,ge)=>{var be;console.log("Starting background generation...",{userPrompt:ue,tripId:ge});const Se=Date.now().toString();de(Me=>[...Me,Se]);try{let Me,ke=null;ge&&(ke=t.find(je=>je.id===ge)),ke?(console.log("Updating existing trip:",ke.title),Me=await Tw(ke,ue,x.language),console.log("Updated Trip Plan:",Me)):(console.log("Generating new trip..."),Me=await vw(ue,x.language),console.log("New Trip Plan:",Me));let it=Me.coverImage||(ke==null?void 0:ke.coverImage);if(!it)try{const je=Me.title||ue;it=await wg(je)}catch(je){console.error("Failed to generate cover image:",je),it=`https://placehold.co/800x600/e2e8f0/475569?text=${encodeURIComponent(((be=Me.title)==null?void 0:be.split(" ")[0])||"Travel")}`}!Me.itinerary||Me.itinerary.length===0?console.warn("AI returned empty itinerary:",Me):Me.itinerary=Me.itinerary.map(je=>({...je,day:Number(je.day)||1,id:je.id||Math.random().toString(36).substr(2,9),time:je.time||"09:00",activity:je.activity||"New Activity",location:je.location||"",notes:je.notes||""}));let ut;return ke?(ut={...ke,...Me,id:ke.id,coverImage:it},V(ut)):(ut={...Me,id:Se,coverImage:it,bookings:[],budget:Me.budget||{total:0,currency:"TWD",expenses:[]},weather:Me.weather||[]},fe(ut)),de(je=>je.filter(Ft=>Ft!==Se)),{title:ut.title,tripId:ut.id}}catch(Me){return console.error("Background generation failed",Me),de(ke=>ke.filter(it=>it!==Se)),null}},[t,x.language]),H=ue=>{A(ge=>({...ge,...ue}))},F=()=>{n&&Y()},Y=async()=>{try{await rL(dg),W($e.HOME),Q(null)}catch(ue){console.error("Logout failed",ue)}},B=()=>{},Ke=()=>{},mt=ue=>{u([ue,...r])},oe=ue=>{u(r.filter(ge=>ge.id!==ue))},Ae=()=>{const ue={id:Date.now().toString(),title:x.language==="zh-TW"?"":"New Chat",messages:[],createdAt:Date.now(),updatedAt:Date.now()};return m(ge=>[ue,...ge]),p(ue.id),ue.id},we=(ue,ge,Se,be)=>{m(Me=>Me.map(ke=>{if(ke.id===ue){let it=ke.title;if(Se)it=Se;else if(!ke.messages.some(je=>je.role==="user")){const je=ge.find(Ft=>Ft.role==="user");je&&(it=je.content.slice(0,20)+(je.content.length>20?"...":""))}return{...ke,messages:ge,title:it,tripId:be||ke.tripId,updatedAt:Date.now()}}return ke}))},Qe=ue=>{m(ge=>ge.filter(Se=>Se.id!==ue)),g===ue&&p(null)},Ne=ue=>{p(ue)};if(X.useEffect(()=>{const ue=document.getElementById("loading-screen");ue?(console.log("Removing loading screen..."),ue.style.opacity="0",setTimeout(()=>ue.remove(),500)):console.log("Loading screen not found (already removed?)")},[]),X.useEffect(()=>{if(n&&b)try{localStorage.setItem(Q6.getSettingsKey(n.id),JSON.stringify(x))}catch(ue){console.error("Failed to save settings",ue)}x.themeColor?document.documentElement.style.setProperty("--color-coral",x.themeColor):document.documentElement.style.removeProperty("--color-coral")},[x,n,b]),!n)return E.jsx(Z6,{onLogin:B,onRegister:Ke});const j=ue=>{const ge=c.find(Se=>Se.tripId===ue);if(ge)p(ge.id);else{const Se=Ae();m(be=>be.map(Me=>{var ke;return Me.id===Se?{...Me,tripId:ue,title:`${((ke=t.find(it=>it.id===ue))==null?void 0:ke.title)||"Trip"} Planning`}:Me}))}W($e.AI_PLANNER)},he=()=>{switch(z){case $e.HOME:return E.jsx(GC,{trips:t,onSelectTrip:ue=>{Q(ue),W($e.TRIP_DETAILS)},onAddTrip:()=>W($e.ADD_TRIP),onOpenSettings:()=>W($e.SETTINGS),settings:x});case $e.ADD_TRIP:return E.jsx(TP,{onSave:ue=>{fe(ue),W($e.HOME)},onCancel:()=>W($e.HOME),settings:x});case $e.MAGIC_EDITOR:return E.jsx(EP,{settings:x});case $e.TRIP_MEMORY:return E.jsx(K6,{memories:r,onAddMemory:mt,onDeleteMemory:oe,settings:x});case $e.AI_PLANNER:return E.jsx(a5,{onStartGeneration:U,onCancel:()=>W($e.HOME),settings:x,sessions:c,currentSessionId:g,onCreateSession:Ae,onUpdateSession:we,onDeleteSession:Qe,onSelectSession:Ne});case $e.TOOLS:return E.jsx(D5,{onBack:()=>W($e.HOME),trips:t,settings:x,onMagicEditor:()=>W($e.MAGIC_EDITOR)});case $e.TRIP_DETAILS:return te?E.jsx(r5,{trip:te,onBack:()=>W($e.HOME),onDelete:O,onUpdateTrip:V,onOpenAI:j,settings:x}):null;case $e.SETTINGS:return E.jsx(k5,{onBack:()=>W($e.HOME),settings:x,onUpdateSettings:H,onResetApp:F,user:n,onLogout:Y});default:return null}},Ce=[$e.HOME,$e.TRIP_MEMORY,$e.TOOLS,$e.AI_PLANNER].includes(z);return E.jsxs("div",{className:"h-full w-full max-w-md mx-auto bg-paper shadow-2xl relative overflow-hidden flex flex-col font-sans text-ink",children:[K&&E.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 relative",role:"alert",children:[E.jsx("strong",{className:"font-bold",children:"Error: "}),E.jsx("span",{className:"block sm:inline",children:K}),E.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>G(null),children:E.jsxs("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[E.jsx("title",{children:"Close"}),E.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]}),E.jsx("div",{className:"flex-1 overflow-hidden relative bg-paper",children:he()}),Ce&&E.jsx("div",{className:"absolute bottom-6 left-4 right-4 z-40",children:E.jsxs("div",{className:"bg-white/90 backdrop-blur-xl border border-white/50 shadow-float rounded-3xl px-2 py-3 flex justify-around items-center",children:[E.jsxs("button",{onClick:()=>W($e.HOME),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${z===$e.HOME?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[E.jsx(bC,{className:`w-6 h-6 ${z===$e.HOME?"stroke-2":"stroke-[1.5]"}`}),z===$e.HOME&&E.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),E.jsxs("button",{onClick:()=>W($e.AI_PLANNER),className:`relative flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${z===$e.AI_PLANNER?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[E.jsxs("div",{className:"relative",children:[E.jsx(Bx,{className:`w-6 h-6 ${z===$e.AI_PLANNER?"stroke-2":"stroke-[1.5]"}`}),(me==null?void 0:me.length)>0&&E.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-coral rounded-full animate-ping"}),(me==null?void 0:me.length)>0&&E.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-coral rounded-full border-2 border-white"})]}),z===$e.AI_PLANNER&&E.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),E.jsxs("button",{onClick:()=>W($e.TRIP_MEMORY),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${z===$e.TRIP_MEMORY?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[E.jsx(cu,{className:`w-6 h-6 ${z===$e.TRIP_MEMORY?"stroke-2":"stroke-[1.5]"}`}),z===$e.TRIP_MEMORY&&E.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),E.jsxs("button",{onClick:()=>W($e.TOOLS),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${z===$e.TOOLS?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[E.jsx(mg,{className:`w-6 h-6 ${z===$e.TOOLS?"stroke-2":"stroke-[1.5]"}`}),z===$e.TOOLS&&E.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]})]})}),E.jsx(W6,{settings:x})]})};console.log("NomadAI App Starting...");const e1=document.getElementById("root");if(!e1)throw new Error("Could not find root element to mount to");const $6=CC.createRoot(e1);try{$6.render(E.jsx(Sh.StrictMode,{children:E.jsx(X6,{})})),setTimeout(()=>{const n=document.getElementById("loading-screen");n&&(console.warn("Force removing loader after timeout"),n.style.opacity="0",setTimeout(()=>n.remove(),500))},3e3)}catch(n){console.error("React Render Error:",n)}
