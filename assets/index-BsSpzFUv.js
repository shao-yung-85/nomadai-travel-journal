(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const u of r)if(u.type==="childList")for(const c of u.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const u={};return r.integrity&&(u.integrity=r.integrity),r.referrerPolicy&&(u.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?u.credentials="include":r.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(r){if(r.ep)return;r.ep=!0;const u=t(r);fetch(r.href,u)}})();function gg(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hp={exports:{}},yc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S0;function bC(){if(S0)return yc;S0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,u){var c=null;if(u!==void 0&&(c=""+u),r.key!==void 0&&(c=""+r.key),"key"in r){u={};for(var m in r)m!=="key"&&(u[m]=r[m])}else u=r;return r=u.ref,{$$typeof:n,type:i,key:c,ref:r!==void 0?r:null,props:u}}return yc.Fragment=e,yc.jsx=t,yc.jsxs=t,yc}var A0;function IC(){return A0||(A0=1,hp.exports=bC()),hp.exports}var E=IC(),fp={exports:{}},st={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C0;function NC(){if(C0)return st;C0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),u=Symbol.for("react.consumer"),c=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),C=Symbol.iterator;function M(j){return j===null||typeof j!="object"?null:(j=C&&j[C]||j["@@iterator"],typeof j=="function"?j:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H=Object.assign,Y={};function ie(j,he,be){this.props=j,this.context=he,this.refs=Y,this.updater=be||F}ie.prototype.isReactComponent={},ie.prototype.setState=function(j,he){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,he,"setState")},ie.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function re(){}re.prototype=ie.prototype;function ee(j,he,be){this.props=j,this.context=he,this.refs=Y,this.updater=be||F}var Ee=ee.prototype=new re;Ee.constructor=ee,H(Ee,ie.prototype),Ee.isPureReactComponent=!0;var pe=Array.isArray;function J(){}var k={H:null,A:null,T:null,S:null},U=Object.prototype.hasOwnProperty;function V(j,he,be){var ce=be.ref;return{$$typeof:n,type:j,key:he,ref:ce!==void 0?ce:null,props:be}}function B(j,he){return V(j.type,he,j.props)}function q(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function K(j){var he={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(be){return he[be]})}var z=/\/+/g;function Le(j,he){return typeof j=="object"&&j!==null&&j.key!=null?K(""+j.key):he.toString(36)}function Xe(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(J,J):(j.status="pending",j.then(function(he){j.status==="pending"&&(j.status="fulfilled",j.value=he)},function(he){j.status==="pending"&&(j.status="rejected",j.reason=he)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function te(j,he,be,ce,me){var Ce=typeof j;(Ce==="undefined"||Ce==="boolean")&&(j=null);var _e=!1;if(j===null)_e=!0;else switch(Ce){case"bigint":case"string":case"number":_e=!0;break;case"object":switch(j.$$typeof){case n:case e:_e=!0;break;case x:return _e=j._init,te(_e(j._payload),he,be,ce,me)}}if(_e)return me=me(j),_e=ce===""?"."+Le(j,0):ce,pe(me)?(be="",_e!=null&&(be=_e.replace(z,"$&/")+"/"),te(me,he,be,"",function(Je){return Je})):me!=null&&(q(me)&&(me=B(me,be+(me.key==null||j&&j.key===me.key?"":(""+me.key).replace(z,"$&/")+"/")+_e)),he.push(me)),1;_e=0;var Pe=ce===""?".":ce+":";if(pe(j))for(var ke=0;ke<j.length;ke++)ce=j[ke],Ce=Pe+Le(ce,ke),_e+=te(ce,he,be,Ce,me);else if(ke=M(j),typeof ke=="function")for(j=ke.call(j),ke=0;!(ce=j.next()).done;)ce=ce.value,Ce=Pe+Le(ce,ke++),_e+=te(ce,he,be,Ce,me);else if(Ce==="object"){if(typeof j.then=="function")return te(Xe(j),he,be,ce,me);throw he=String(j),Error("Objects are not valid as a React child (found: "+(he==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":he)+"). If you meant to render a collection of children, use an array instead.")}return _e}function Se(j,he,be){if(j==null)return j;var ce=[],me=0;return te(j,ce,"","",function(Ce){return he.call(be,Ce,me++)}),ce}function Ae(j){if(j._status===-1){var he=j._result;he=he(),he.then(function(be){(j._status===0||j._status===-1)&&(j._status=1,j._result=be)},function(be){(j._status===0||j._status===-1)&&(j._status=2,j._result=be)}),j._status===-1&&(j._status=0,j._result=he)}if(j._status===1)return j._result.default;throw j._result}var We=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var he=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(he))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)},Ne={map:Se,forEach:function(j,he,be){Se(j,function(){he.apply(this,arguments)},be)},count:function(j){var he=0;return Se(j,function(){he++}),he},toArray:function(j){return Se(j,function(he){return he})||[]},only:function(j){if(!q(j))throw Error("React.Children.only expected to receive a single React element child.");return j}};return st.Activity=S,st.Children=Ne,st.Component=ie,st.Fragment=t,st.Profiler=r,st.PureComponent=ee,st.StrictMode=i,st.Suspense=g,st.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,st.__COMPILER_RUNTIME={__proto__:null,c:function(j){return k.H.useMemoCache(j)}},st.cache=function(j){return function(){return j.apply(null,arguments)}},st.cacheSignal=function(){return null},st.cloneElement=function(j,he,be){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var ce=H({},j.props),me=j.key;if(he!=null)for(Ce in he.key!==void 0&&(me=""+he.key),he)!U.call(he,Ce)||Ce==="key"||Ce==="__self"||Ce==="__source"||Ce==="ref"&&he.ref===void 0||(ce[Ce]=he[Ce]);var Ce=arguments.length-2;if(Ce===1)ce.children=be;else if(1<Ce){for(var _e=Array(Ce),Pe=0;Pe<Ce;Pe++)_e[Pe]=arguments[Pe+2];ce.children=_e}return V(j.type,me,ce)},st.createContext=function(j){return j={$$typeof:c,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:u,_context:j},j},st.createElement=function(j,he,be){var ce,me={},Ce=null;if(he!=null)for(ce in he.key!==void 0&&(Ce=""+he.key),he)U.call(he,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(me[ce]=he[ce]);var _e=arguments.length-2;if(_e===1)me.children=be;else if(1<_e){for(var Pe=Array(_e),ke=0;ke<_e;ke++)Pe[ke]=arguments[ke+2];me.children=Pe}if(j&&j.defaultProps)for(ce in _e=j.defaultProps,_e)me[ce]===void 0&&(me[ce]=_e[ce]);return V(j,Ce,me)},st.createRef=function(){return{current:null}},st.forwardRef=function(j){return{$$typeof:m,render:j}},st.isValidElement=q,st.lazy=function(j){return{$$typeof:x,_payload:{_status:-1,_result:j},_init:Ae}},st.memo=function(j,he){return{$$typeof:p,type:j,compare:he===void 0?null:he}},st.startTransition=function(j){var he=k.T,be={};k.T=be;try{var ce=j(),me=k.S;me!==null&&me(be,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(J,We)}catch(Ce){We(Ce)}finally{he!==null&&be.types!==null&&(he.types=be.types),k.T=he}},st.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},st.use=function(j){return k.H.use(j)},st.useActionState=function(j,he,be){return k.H.useActionState(j,he,be)},st.useCallback=function(j,he){return k.H.useCallback(j,he)},st.useContext=function(j){return k.H.useContext(j)},st.useDebugValue=function(){},st.useDeferredValue=function(j,he){return k.H.useDeferredValue(j,he)},st.useEffect=function(j,he){return k.H.useEffect(j,he)},st.useEffectEvent=function(j){return k.H.useEffectEvent(j)},st.useId=function(){return k.H.useId()},st.useImperativeHandle=function(j,he,be){return k.H.useImperativeHandle(j,he,be)},st.useInsertionEffect=function(j,he){return k.H.useInsertionEffect(j,he)},st.useLayoutEffect=function(j,he){return k.H.useLayoutEffect(j,he)},st.useMemo=function(j,he){return k.H.useMemo(j,he)},st.useOptimistic=function(j,he){return k.H.useOptimistic(j,he)},st.useReducer=function(j,he,be){return k.H.useReducer(j,he,be)},st.useRef=function(j){return k.H.useRef(j)},st.useState=function(j){return k.H.useState(j)},st.useSyncExternalStore=function(j,he,be){return k.H.useSyncExternalStore(j,he,be)},st.useTransition=function(){return k.H.useTransition()},st.version="19.2.0",st}var b0;function _g(){return b0||(b0=1,fp.exports=NC()),fp.exports}var W=_g();const Lc=gg(W);var mp={exports:{}},vc={},pp={exports:{}},gp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I0;function RC(){return I0||(I0=1,(function(n){function e(te,Se){var Ae=te.length;te.push(Se);e:for(;0<Ae;){var We=Ae-1>>>1,Ne=te[We];if(0<r(Ne,Se))te[We]=Se,te[Ae]=Ne,Ae=We;else break e}}function t(te){return te.length===0?null:te[0]}function i(te){if(te.length===0)return null;var Se=te[0],Ae=te.pop();if(Ae!==Se){te[0]=Ae;e:for(var We=0,Ne=te.length,j=Ne>>>1;We<j;){var he=2*(We+1)-1,be=te[he],ce=he+1,me=te[ce];if(0>r(be,Ae))ce<Ne&&0>r(me,be)?(te[We]=me,te[ce]=Ae,We=ce):(te[We]=be,te[he]=Ae,We=he);else if(ce<Ne&&0>r(me,Ae))te[We]=me,te[ce]=Ae,We=ce;else break e}}return Se}function r(te,Se){var Ae=te.sortIndex-Se.sortIndex;return Ae!==0?Ae:te.id-Se.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;n.unstable_now=function(){return u.now()}}else{var c=Date,m=c.now();n.unstable_now=function(){return c.now()-m}}var g=[],p=[],x=1,S=null,C=3,M=!1,F=!1,H=!1,Y=!1,ie=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;function Ee(te){for(var Se=t(p);Se!==null;){if(Se.callback===null)i(p);else if(Se.startTime<=te)i(p),Se.sortIndex=Se.expirationTime,e(g,Se);else break;Se=t(p)}}function pe(te){if(H=!1,Ee(te),!F)if(t(g)!==null)F=!0,J||(J=!0,K());else{var Se=t(p);Se!==null&&Xe(pe,Se.startTime-te)}}var J=!1,k=-1,U=5,V=-1;function B(){return Y?!0:!(n.unstable_now()-V<U)}function q(){if(Y=!1,J){var te=n.unstable_now();V=te;var Se=!0;try{e:{F=!1,H&&(H=!1,re(k),k=-1),M=!0;var Ae=C;try{t:{for(Ee(te),S=t(g);S!==null&&!(S.expirationTime>te&&B());){var We=S.callback;if(typeof We=="function"){S.callback=null,C=S.priorityLevel;var Ne=We(S.expirationTime<=te);if(te=n.unstable_now(),typeof Ne=="function"){S.callback=Ne,Ee(te),Se=!0;break t}S===t(g)&&i(g),Ee(te)}else i(g);S=t(g)}if(S!==null)Se=!0;else{var j=t(p);j!==null&&Xe(pe,j.startTime-te),Se=!1}}break e}finally{S=null,C=Ae,M=!1}Se=void 0}}finally{Se?K():J=!1}}}var K;if(typeof ee=="function")K=function(){ee(q)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,Le=z.port2;z.port1.onmessage=q,K=function(){Le.postMessage(null)}}else K=function(){ie(q,0)};function Xe(te,Se){k=ie(function(){te(n.unstable_now())},Se)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(te){te.callback=null},n.unstable_forceFrameRate=function(te){0>te||125<te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<te?Math.floor(1e3/te):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_next=function(te){switch(C){case 1:case 2:case 3:var Se=3;break;default:Se=C}var Ae=C;C=Se;try{return te()}finally{C=Ae}},n.unstable_requestPaint=function(){Y=!0},n.unstable_runWithPriority=function(te,Se){switch(te){case 1:case 2:case 3:case 4:case 5:break;default:te=3}var Ae=C;C=te;try{return Se()}finally{C=Ae}},n.unstable_scheduleCallback=function(te,Se,Ae){var We=n.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?We+Ae:We):Ae=We,te){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=Ae+Ne,te={id:x++,callback:Se,priorityLevel:te,startTime:Ae,expirationTime:Ne,sortIndex:-1},Ae>We?(te.sortIndex=Ae,e(p,te),t(g)===null&&te===t(p)&&(H?(re(k),k=-1):H=!0,Xe(pe,Ae-We))):(te.sortIndex=Ne,e(g,te),F||M||(F=!0,J||(J=!0,K()))),te},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(te){var Se=C;return function(){var Ae=C;C=Se;try{return te.apply(this,arguments)}finally{C=Ae}}}})(gp)),gp}var N0;function MC(){return N0||(N0=1,pp.exports=RC()),pp.exports}var _p={exports:{}},ai={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R0;function PC(){if(R0)return ai;R0=1;var n=_g();function e(g){var p="https://react.dev/errors/"+g;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)p+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+g+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function u(g,p,x){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:S==null?null:""+S,children:g,containerInfo:p,implementation:x}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(g,p){if(g==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return ai.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,ai.createPortal=function(g,p){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return u(g,p,null,x)},ai.flushSync=function(g){var p=c.T,x=i.p;try{if(c.T=null,i.p=2,g)return g()}finally{c.T=p,i.p=x,i.d.f()}},ai.preconnect=function(g,p){typeof g=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(g,p))},ai.prefetchDNS=function(g){typeof g=="string"&&i.d.D(g)},ai.preinit=function(g,p){if(typeof g=="string"&&p&&typeof p.as=="string"){var x=p.as,S=m(x,p.crossOrigin),C=typeof p.integrity=="string"?p.integrity:void 0,M=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;x==="style"?i.d.S(g,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:S,integrity:C,fetchPriority:M}):x==="script"&&i.d.X(g,{crossOrigin:S,integrity:C,fetchPriority:M,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},ai.preinitModule=function(g,p){if(typeof g=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var x=m(p.as,p.crossOrigin);i.d.M(g,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(g)},ai.preload=function(g,p){if(typeof g=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var x=p.as,S=m(x,p.crossOrigin);i.d.L(g,x,{crossOrigin:S,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},ai.preloadModule=function(g,p){if(typeof g=="string")if(p){var x=m(p.as,p.crossOrigin);i.d.m(g,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(g)},ai.requestFormReset=function(g){i.d.r(g)},ai.unstable_batchedUpdates=function(g,p){return g(p)},ai.useFormState=function(g,p,x){return c.H.useFormState(g,p,x)},ai.useFormStatus=function(){return c.H.useHostTransitionStatus()},ai.version="19.2.0",ai}var M0;function Hx(){if(M0)return _p.exports;M0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),_p.exports=PC(),_p.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P0;function kC(){if(P0)return vc;P0=1;var n=MC(),e=_g(),t=Hx();function i(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function u(s){var o=s,l=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(l=o.return),s=o.return;while(s)}return o.tag===3?l:null}function c(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function m(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function g(s){if(u(s)!==s)throw Error(i(188))}function p(s){var o=s.alternate;if(!o){if(o=u(s),o===null)throw Error(i(188));return o!==s?null:s}for(var l=s,h=o;;){var T=l.return;if(T===null)break;var w=T.alternate;if(w===null){if(h=T.return,h!==null){l=h;continue}break}if(T.child===w.child){for(w=T.child;w;){if(w===l)return g(T),s;if(w===h)return g(T),o;w=w.sibling}throw Error(i(188))}if(l.return!==h.return)l=T,h=w;else{for(var N=!1,D=T.child;D;){if(D===l){N=!0,l=T,h=w;break}if(D===h){N=!0,h=T,l=w;break}D=D.sibling}if(!N){for(D=w.child;D;){if(D===l){N=!0,l=w,h=T;break}if(D===h){N=!0,h=w,l=T;break}D=D.sibling}if(!N)throw Error(i(189))}}if(l.alternate!==h)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:o}function x(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=x(s),o!==null)return o;s=s.sibling}return null}var S=Object.assign,C=Symbol.for("react.element"),M=Symbol.for("react.transitional.element"),F=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),Y=Symbol.for("react.strict_mode"),ie=Symbol.for("react.profiler"),re=Symbol.for("react.consumer"),ee=Symbol.for("react.context"),Ee=Symbol.for("react.forward_ref"),pe=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function K(s){return s===null||typeof s!="object"?null:(s=q&&s[q]||s["@@iterator"],typeof s=="function"?s:null)}var z=Symbol.for("react.client.reference");function Le(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===z?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case H:return"Fragment";case ie:return"Profiler";case Y:return"StrictMode";case pe:return"Suspense";case J:return"SuspenseList";case V:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case F:return"Portal";case ee:return s.displayName||"Context";case re:return(s._context.displayName||"Context")+".Consumer";case Ee:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case k:return o=s.displayName||null,o!==null?o:Le(s.type)||"Memo";case U:o=s._payload,s=s._init;try{return Le(s(o))}catch{}}return null}var Xe=Array.isArray,te=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ae={pending:!1,data:null,method:null,action:null},We=[],Ne=-1;function j(s){return{current:s}}function he(s){0>Ne||(s.current=We[Ne],We[Ne]=null,Ne--)}function be(s,o){Ne++,We[Ne]=s.current,s.current=o}var ce=j(null),me=j(null),Ce=j(null),_e=j(null);function Pe(s,o){switch(be(Ce,o),be(me,s),be(ce,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?Zv(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=Zv(o),s=Yv(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}he(ce),be(ce,s)}function ke(){he(ce),he(me),he(Ce)}function Je(s){s.memoizedState!==null&&be(_e,s);var o=ce.current,l=Yv(o,s.type);o!==l&&(be(me,s),be(ce,l))}function wt(s){me.current===s&&(he(ce),he(me)),_e.current===s&&(he(_e),mc._currentValue=Ae)}var Ze,Jt;function fn(s){if(Ze===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);Ze=o&&o[1]||"",Jt=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ze+s+Jt}var mi=!1;function ei(s,o){if(!s||mi)return"";mi=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var Te=function(){throw Error()};if(Object.defineProperty(Te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Te,[])}catch(de){var le=de}Reflect.construct(s,[],Te)}else{try{Te.call()}catch(de){le=de}s.call(Te.prototype)}}else{try{throw Error()}catch(de){le=de}(Te=s())&&typeof Te.catch=="function"&&Te.catch(function(){})}}catch(de){if(de&&le&&typeof de.stack=="string")return[de.stack,le.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var T=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");T&&T.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=h.DetermineComponentFrameRoot(),N=w[0],D=w[1];if(N&&D){var Z=N.split(`
`),oe=D.split(`
`);for(T=h=0;h<Z.length&&!Z[h].includes("DetermineComponentFrameRoot");)h++;for(;T<oe.length&&!oe[T].includes("DetermineComponentFrameRoot");)T++;if(h===Z.length||T===oe.length)for(h=Z.length-1,T=oe.length-1;1<=h&&0<=T&&Z[h]!==oe[T];)T--;for(;1<=h&&0<=T;h--,T--)if(Z[h]!==oe[T]){if(h!==1||T!==1)do if(h--,T--,0>T||Z[h]!==oe[T]){var fe=`
`+Z[h].replace(" at new "," at ");return s.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",s.displayName)),fe}while(1<=h&&0<=T);break}}}finally{mi=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?fn(l):""}function pi(s,o){switch(s.tag){case 26:case 27:case 5:return fn(s.type);case 16:return fn("Lazy");case 13:return s.child!==o&&o!==null?fn("Suspense Fallback"):fn("Suspense");case 19:return fn("SuspenseList");case 0:case 15:return ei(s.type,!1);case 11:return ei(s.type.render,!1);case 1:return ei(s.type,!0);case 31:return fn("Activity");default:return""}}function vn(s){try{var o="",l=null;do o+=pi(s,l),l=s,s=s.return;while(s);return o}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var jt=Object.prototype.hasOwnProperty,ye=n.unstable_scheduleCallback,qe=n.unstable_cancelCallback,Qe=n.unstable_shouldYield,Dt=n.unstable_requestPaint,dt=n.unstable_now,an=n.unstable_getCurrentPriorityLevel,gi=n.unstable_ImmediatePriority,_i=n.unstable_UserBlockingPriority,Ie=n.unstable_NormalPriority,ut=n.unstable_LowPriority,Vt=n.unstable_IdlePriority,ln=n.log,Si=n.unstable_setDisableYieldValue,Tn=null,Ot=null;function Dn(s){if(typeof ln=="function"&&Si(s),Ot&&typeof Ot.setStrictMode=="function")try{Ot.setStrictMode(Tn,s)}catch{}}var Qt=Math.clz32?Math.clz32:ds,Gi=Math.log,ks=Math.LN2;function ds(s){return s>>>=0,s===0?32:31-(Gi(s)/ks|0)|0}var ji=256,so=262144,un=4194304;function hs(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function fs(s,o,l){var h=s.pendingLanes;if(h===0)return 0;var T=0,w=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var D=h&134217727;return D!==0?(h=D&~w,h!==0?T=hs(h):(N&=D,N!==0?T=hs(N):l||(l=D&~s,l!==0&&(T=hs(l))))):(D=h&~w,D!==0?T=hs(D):N!==0?T=hs(N):l||(l=h&~s,l!==0&&(T=hs(l)))),T===0?0:o!==0&&o!==T&&(o&w)===0&&(w=T&-T,l=o&-o,w>=l||w===32&&(l&4194048)!==0)?o:T}function Ki(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Du(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pl(){var s=un;return un<<=1,(un&62914560)===0&&(un=4194304),s}function ms(s){for(var o=[],l=0;31>l;l++)o.push(s);return o}function Ds(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Lu(s,o,l,h,T,w){var N=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var D=s.entanglements,Z=s.expirationTimes,oe=s.hiddenUpdates;for(l=N&~l;0<l;){var fe=31-Qt(l),Te=1<<fe;D[fe]=0,Z[fe]=-1;var le=oe[fe];if(le!==null)for(oe[fe]=null,fe=0;fe<le.length;fe++){var de=le[fe];de!==null&&(de.lane&=-536870913)}l&=~Te}h!==0&&Mo(s,h,0),w!==0&&T===0&&s.tag!==0&&(s.suspendedLanes|=w&~(N&~o))}function Mo(s,o,l){s.pendingLanes|=o,s.suspendedLanes&=~o;var h=31-Qt(o);s.entangledLanes|=o,s.entanglements[h]=s.entanglements[h]|1073741824|l&261930}function ya(s,o){var l=s.entangledLanes|=o;for(s=s.entanglements;l;){var h=31-Qt(l),T=1<<h;T&o|s[h]&o&&(s[h]|=o),l&=~T}}function va(s,o){var l=o&-o;return l=(l&42)!==0?1:Un(l),(l&(s.suspendedLanes|o))!==0?0:l}function Un(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ze(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Ta(){var s=Se.p;return s!==0?s:(s=window.event,s===void 0?32:_0(s.type))}function Ai(s,o){var l=Se.p;try{return Se.p=s,o()}finally{Se.p=l}}var Ci=Math.random().toString(36).slice(2),cn="__reactFiber$"+Ci,mn="__reactProps$"+Ci,Zi="__reactContainer$"+Ci,Yi="__reactEvents$"+Ci,gl="__reactListeners$"+Ci,_l="__reactHandles$"+Ci,yl="__reactResources$"+Ci,ps="__reactMarker$"+Ci;function mr(s){delete s[cn],delete s[mn],delete s[Yi],delete s[gl],delete s[_l]}function Wi(s){var o=s[cn];if(o)return o;for(var l=s.parentNode;l;){if(o=l[Zi]||l[cn]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(s=t0(s);s!==null;){if(l=s[cn])return l;s=t0(s)}return o}s=l,l=s.parentNode}return null}function bi(s){if(s=s[cn]||s[Zi]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function zn(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(i(33))}function gs(s){var o=s[yl];return o||(o=s[yl]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function pn(s){s[ps]=!0}var Ea=new Set,xa={};function _s(s,o){Ii(s,o),Ii(s+"Capture",o)}function Ii(s,o){for(xa[s]=o,s=0;s<o.length;s++)Ea.add(o[s])}var Ls=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),pr={},gr={};function oo(s){return jt.call(gr,s)?!0:jt.call(pr,s)?!1:Ls.test(s)?gr[s]=!0:(pr[s]=!0,!1)}function ht(s,o,l){if(oo(o))if(l===null)s.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+l)}}function ft(s,o,l){if(l===null)s.removeAttribute(o);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+l)}}function Xt(s,o,l,h){if(h===null)s.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(o,l,""+h)}}function en(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function yi(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Po(s,o,l){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var T=h.get,w=h.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return T.call(this)},set:function(N){l=""+N,w.call(this,N)}}),Object.defineProperty(s,o,{enumerable:h.enumerable}),{getValue:function(){return l},setValue:function(N){l=""+N},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Ve(s){if(!s._valueTracker){var o=yi(s)?"checked":"value";s._valueTracker=Po(s,o,""+s[o])}}function Ut(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var l=o.getValue(),h="";return s&&(h=yi(s)?s.checked?"true":"false":s.value),s=h,s!==l?(o.setValue(s),!0):!1}function Ni(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ys=/[\n"\\]/g;function Kt(s){return s.replace(ys,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function _r(s,o,l,h,T,w,N,D){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),o!=null?N==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+en(o)):s.value!==""+en(o)&&(s.value=""+en(o)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),o!=null?Ji(s,N,en(o)):l!=null?Ji(s,N,en(l)):h!=null&&s.removeAttribute("value"),T==null&&w!=null&&(s.defaultChecked=!!w),T!=null&&(s.checked=T&&typeof T!="function"&&typeof T!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.name=""+en(D):s.removeAttribute("name")}function ko(s,o,l,h,T,w,N,D){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.type=w),o!=null||l!=null){if(!(w!=="submit"&&w!=="reset"||o!=null)){Ve(s);return}l=l!=null?""+en(l):"",o=o!=null?""+en(o):l,D||o===s.value||(s.value=o),s.defaultValue=o}h=h??T,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=D?s.checked:!!h,s.defaultChecked=!!h,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),Ve(s)}function Ji(s,o,l){o==="number"&&Ni(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function zt(s,o,l,h){if(s=s.options,o){o={};for(var T=0;T<l.length;T++)o["$"+l[T]]=!0;for(l=0;l<s.length;l++)T=o.hasOwnProperty("$"+s[l].value),s[l].selected!==T&&(s[l].selected=T),T&&h&&(s[l].defaultSelected=!0)}else{for(l=""+en(l),o=null,T=0;T<s.length;T++){if(s[T].value===l){s[T].selected=!0,h&&(s[T].defaultSelected=!0);return}o!==null||s[T].disabled||(o=s[T])}o!==null&&(o.selected=!0)}}function vs(s,o,l){if(o!=null&&(o=""+en(o),o!==s.value&&(s.value=o),l==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=l!=null?""+en(l):""}function Ri(s,o,l,h){if(o==null){if(h!=null){if(l!=null)throw Error(i(92));if(Xe(h)){if(1<h.length)throw Error(i(93));h=h[0]}l=h}l==null&&(l=""),o=l}l=en(o),s.defaultValue=l,h=s.textContent,h===l&&h!==""&&h!==null&&(s.value=h),Ve(s)}function Sn(s,o){if(o){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=o;return}}s.textContent=o}var yr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vs(s,o,l){var h=o.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?h?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":h?s.setProperty(o,l):typeof l!="number"||l===0||yr.has(o)?o==="float"?s.cssFloat=l:s[o]=(""+l).trim():s[o]=l+"px"}function Do(s,o,l){if(o!=null&&typeof o!="object")throw Error(i(62));if(s=s.style,l!=null){for(var h in l)!l.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var T in o)h=o[T],o.hasOwnProperty(T)&&l[T]!==h&&Vs(s,T,h)}else for(var w in o)o.hasOwnProperty(w)&&Vs(s,w,o[w])}function ro(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ts=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ao(s){return Ts.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ti(){}var vr=null;function ni(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var lo=null,Ke=null;function Bn(s){var o=bi(s);if(o&&(s=o.stateNode)){var l=s[mn]||null;e:switch(s=o.stateNode,o.type){case"input":if(_r(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),o=l.name,l.type==="radio"&&o!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Kt(""+o)+'"][type="radio"]'),o=0;o<l.length;o++){var h=l[o];if(h!==s&&h.form===s.form){var T=h[mn]||null;if(!T)throw Error(i(90));_r(h,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name)}}for(o=0;o<l.length;o++)h=l[o],h.form===s.form&&Ut(h)}break e;case"textarea":vs(s,l.value,l.defaultValue);break e;case"select":o=l.value,o!=null&&zt(s,!!l.multiple,o,!1)}}}var bt=!1;function Os(s,o,l){if(bt)return s(o,l);bt=!0;try{var h=s(o);return h}finally{if(bt=!1,(lo!==null||Ke!==null)&&(Bd(),lo&&(o=lo,s=Ke,Ke=lo=null,Bn(o),s)))for(o=0;o<s.length;o++)Bn(s[o])}}function vi(s,o){var l=s.stateNode;if(l===null)return null;var h=l[mn]||null;if(h===null)return null;l=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,o,typeof l));return l}var ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Us=!1;if(ii)try{var _t={};Object.defineProperty(_t,"passive",{get:function(){Us=!0}}),window.addEventListener("test",_t,_t),window.removeEventListener("test",_t,_t)}catch{Us=!1}var Mi=null,zs=null,tn=null;function Qi(){if(tn)return tn;var s,o=zs,l=o.length,h,T="value"in Mi?Mi.value:Mi.textContent,w=T.length;for(s=0;s<l&&o[s]===T[s];s++);var N=l-s;for(h=1;h<=N&&o[l-h]===T[w-h];h++);return tn=T.slice(s,1<h?1-h:void 0)}function uo(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Es(){return!0}function $i(){return!1}function An(s){function o(l,h,T,w,N){this._reactName=l,this._targetInst=T,this.type=h,this.nativeEvent=w,this.target=N,this.currentTarget=null;for(var D in s)s.hasOwnProperty(D)&&(l=s[D],this[D]=l?l(w):w[D]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Es:$i,this.isPropagationStopped=$i,this}return S(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Es)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Es)},persist:function(){},isPersistent:Es}),o}var Xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xs=An(Xi),Bs=S({},Xi,{view:0,detail:0}),ct=An(Bs),co,Fn,si,Vo=S({},Bs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ho,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==si&&(si&&s.type==="mousemove"?(co=s.screenX-si.screenX,Fn=s.screenY-si.screenY):Fn=co=0,si=s),co)},movementY:function(s){return"movementY"in s?s.movementY:Fn}}),wa=An(Vo),Fs=S({},Vo,{dataTransfer:0}),vl=An(Fs),Sa=S({},Bs,{relatedTarget:0}),Oo=An(Sa),Aa=S({},Xi,{animationName:0,elapsedTime:0,pseudoElement:0}),Tr=An(Aa),Er=S({},Xi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Ti=An(Er),Tl=S({},Xi,{data:0}),es=An(Tl),ts={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ca={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ba={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xr(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=ba[s])?!!o[s]:!1}function ho(){return xr}var qn=S({},Bs,{key:function(s){if(s.key){var o=ts[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=uo(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Ca[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ho,charCode:function(s){return s.type==="keypress"?uo(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?uo(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Ia=An(qn),El=S({},Vo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qs=An(El),y=S({},Bs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ho}),b=An(y),R=S({},Xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),O=An(R),ne=S({},Vo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),ue=An(ne),Re=S({},Xi,{newState:0,oldState:0}),et=An(Re),St=[9,13,27,32],At=ii&&"CompositionEvent"in window,Zt=null;ii&&"documentMode"in document&&(Zt=document.documentMode);var Pi=ii&&"TextEvent"in window&&!Zt,ki=ii&&(!At||Zt&&8<Zt&&11>=Zt),Ei=" ",ns=!1;function Uo(s,o){switch(s){case"keyup":return St.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zo(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var wr=!1;function is(s,o){switch(s){case"compositionend":return zo(o);case"keypress":return o.which!==32?null:(ns=!0,Ei);case"textInput":return s=o.data,s===Ei&&ns?null:s;default:return null}}function Sr(s,o){if(wr)return s==="compositionend"||!At&&Uo(s,o)?(s=Qi(),tn=zs=Mi=null,wr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return ki&&o.locale!=="ko"?null:o.data;default:return null}}var Rf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ws(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!Rf[s.type]:o==="textarea"}function id(s,o,l,h){lo?Ke?Ke.push(h):Ke=[h]:lo=h,o=Zd(o,"onChange"),0<o.length&&(l=new xs("onChange","change",null,l,h),s.push({event:l,listeners:o}))}var Ss=null,Na=null;function Ra(s){Fv(s,0)}function Ma(s){var o=zn(s);if(Ut(o))return s}function Pa(s,o){if(s==="change")return o}var sd=!1;if(ii){var As;if(ii){var Ar="oninput"in document;if(!Ar){var od=document.createElement("div");od.setAttribute("oninput","return;"),Ar=typeof od.oninput=="function"}As=Ar}else As=!1;sd=As&&(!document.documentMode||9<document.documentMode)}function xl(){Ss&&(Ss.detachEvent("onpropertychange",rd),Na=Ss=null)}function rd(s){if(s.propertyName==="value"&&Ma(Na)){var o=[];id(o,Na,s,ni(s)),Os(Ra,o)}}function Hs(s,o,l){s==="focusin"?(xl(),Ss=o,Na=l,Ss.attachEvent("onpropertychange",rd)):s==="focusout"&&xl()}function Mf(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ma(Na)}function Cr(s,o){if(s==="click")return Ma(o)}function Pf(s,o){if(s==="input"||s==="change")return Ma(o)}function Gs(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Hn=typeof Object.is=="function"?Object.is:Gs;function br(s,o){if(Hn(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var l=Object.keys(s),h=Object.keys(o);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var T=l[h];if(!jt.call(o,T)||!Hn(s[T],o[T]))return!1}return!0}function wl(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ka(s,o){var l=wl(s);s=0;for(var h;l;){if(l.nodeType===3){if(h=s+l.textContent.length,s<=o&&h>=o)return{node:l,offset:o-s};s=h}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=wl(l)}}function Sl(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Sl(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Da(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Ni(s.document);o instanceof s.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)s=o.contentWindow;else break;o=Ni(s.document)}return o}function fo(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var Al=ii&&"documentMode"in document&&11>=document.documentMode,mo=null,Cl=null,La=null,Ir=!1;function ad(s,o,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Ir||mo==null||mo!==Ni(h)||(h=mo,"selectionStart"in h&&fo(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),La&&br(La,h)||(La=h,h=Zd(Cl,"onSelect"),0<h.length&&(o=new xs("onSelect","select",null,o,l),s.push({event:o,listeners:h}),o.target=mo)))}function po(s,o){var l={};return l[s.toLowerCase()]=o.toLowerCase(),l["Webkit"+s]="webkit"+o,l["Moz"+s]="moz"+o,l}var Nr={animationend:po("Animation","AnimationEnd"),animationiteration:po("Animation","AnimationIteration"),animationstart:po("Animation","AnimationStart"),transitionrun:po("Transition","TransitionRun"),transitionstart:po("Transition","TransitionStart"),transitioncancel:po("Transition","TransitionCancel"),transitionend:po("Transition","TransitionEnd")},bl={},ld={};ii&&(ld=document.createElement("div").style,"AnimationEvent"in window||(delete Nr.animationend.animation,delete Nr.animationiteration.animation,delete Nr.animationstart.animation),"TransitionEvent"in window||delete Nr.transitionend.transition);function Gn(s){if(bl[s])return bl[s];if(!Nr[s])return s;var o=Nr[s],l;for(l in o)if(o.hasOwnProperty(l)&&l in ld)return bl[s]=o[l];return s}var Va=Gn("animationend"),ud=Gn("animationiteration"),Oa=Gn("animationstart"),kf=Gn("transitionrun"),cd=Gn("transitionstart"),Df=Gn("transitioncancel"),Rr=Gn("transitionend"),dd=new Map,go="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");go.push("scrollEnd");function Di(s,o){dd.set(s,o),_s(o,[s])}var Ua=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Li=[],oi=0,Il=0;function za(){for(var s=oi,o=Il=oi=0;o<s;){var l=Li[o];Li[o++]=null;var h=Li[o];Li[o++]=null;var T=Li[o];Li[o++]=null;var w=Li[o];if(Li[o++]=null,h!==null&&T!==null){var N=h.pending;N===null?T.next=T:(T.next=N.next,N.next=T),h.pending=T}w!==0&&Mr(l,T,w)}}function _o(s,o,l,h){Li[oi++]=s,Li[oi++]=o,Li[oi++]=l,Li[oi++]=h,Il|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Vu(s,o,l,h){return _o(s,o,l,h),Ba(s)}function Cs(s,o){return _o(s,null,null,o),Ba(s)}function Mr(s,o,l){s.lanes|=l;var h=s.alternate;h!==null&&(h.lanes|=l);for(var T=!1,w=s.return;w!==null;)w.childLanes|=l,h=w.alternate,h!==null&&(h.childLanes|=l),w.tag===22&&(s=w.stateNode,s===null||s._visibility&1||(T=!0)),s=w,w=w.return;return s.tag===3?(w=s.stateNode,T&&o!==null&&(T=31-Qt(l),s=w.hiddenUpdates,h=s[T],h===null?s[T]=[o]:h.push(o),o.lane=l|536870912),w):null}function Ba(s){if(50<ac)throw ac=0,Vm=null,Error(i(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var Bo={};function Lf(s,o,l,h){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ri(s,o,l,h){return new Lf(s,o,l,h)}function Nl(s){return s=s.prototype,!(!s||!s.isReactComponent)}function bs(s,o){var l=s.alternate;return l===null?(l=ri(s.tag,o,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=o,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,o=s.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Ou(s,o){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,o=l.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function Fa(s,o,l,h,T,w){var N=0;if(h=s,typeof s=="function")Nl(s)&&(N=1);else if(typeof s=="string")N=pC(s,l,ce.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case V:return s=ri(31,l,o,T),s.elementType=V,s.lanes=w,s;case H:return Fo(l.children,T,w,o);case Y:N=8,T|=24;break;case ie:return s=ri(12,l,o,T|2),s.elementType=ie,s.lanes=w,s;case pe:return s=ri(13,l,o,T),s.elementType=pe,s.lanes=w,s;case J:return s=ri(19,l,o,T),s.elementType=J,s.lanes=w,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ee:N=10;break e;case re:N=9;break e;case Ee:N=11;break e;case k:N=14;break e;case U:N=16,h=null;break e}N=29,l=Error(i(130,s===null?"null":typeof s,"")),h=null}return o=ri(N,l,o,T),o.elementType=s,o.type=h,o.lanes=w,o}function Fo(s,o,l,h){return s=ri(7,s,h,o),s.lanes=l,s}function Rl(s,o,l){return s=ri(6,s,null,o),s.lanes=l,s}function Uu(s){var o=ri(18,null,null,0);return o.stateNode=s,o}function zu(s,o,l){return o=ri(4,s.children!==null?s.children:[],s.key,o),o.lanes=l,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var a=new WeakMap;function d(s,o){if(typeof s=="object"&&s!==null){var l=a.get(s);return l!==void 0?l:(o={value:s,source:o,stack:vn(o)},a.set(s,o),o)}return{value:s,source:o,stack:vn(o)}}var v=[],A=0,I=null,P=0,G=[],X=0,ae=null,ve=1,Me="";function He(s,o){v[A++]=P,v[A++]=I,I=s,P=o}function at(s,o,l){G[X++]=ve,G[X++]=Me,G[X++]=ae,ae=s;var h=ve;s=Me;var T=32-Qt(h)-1;h&=~(1<<T),l+=1;var w=32-Qt(o)+T;if(30<w){var N=T-T%5;w=(h&(1<<N)-1).toString(32),h>>=N,T-=N,ve=1<<32-Qt(o)+T|l<<T|h,Me=w+s}else ve=1<<w|l<<T|h,Me=s}function Ln(s){s.return!==null&&(He(s,1),at(s,1,0))}function gn(s){for(;s===I;)I=v[--A],v[A]=null,P=v[--A],v[A]=null;for(;s===ae;)ae=G[--X],G[X]=null,Me=G[--X],G[X]=null,ve=G[--X],G[X]=null}function xi(s,o){G[X++]=ve,G[X++]=Me,G[X++]=ae,ve=o.id,Me=o.overflow,ae=s}var It=null,Nt=null,mt=!1,yo=null,Vi=!1,Ml=Error(i(519));function vo(s){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw qa(d(o,s)),Ml}function Bu(s){var o=s.stateNode,l=s.type,h=s.memoizedProps;switch(o[cn]=s,o[mn]=h,l){case"dialog":gt("cancel",o),gt("close",o);break;case"iframe":case"object":case"embed":gt("load",o);break;case"video":case"audio":for(l=0;l<uc.length;l++)gt(uc[l],o);break;case"source":gt("error",o);break;case"img":case"image":case"link":gt("error",o),gt("load",o);break;case"details":gt("toggle",o);break;case"input":gt("invalid",o),ko(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":gt("invalid",o);break;case"textarea":gt("invalid",o),Ri(o,h.value,h.defaultValue,h.children)}l=h.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||o.textContent===""+l||h.suppressHydrationWarning===!0||jv(o.textContent,l)?(h.popover!=null&&(gt("beforetoggle",o),gt("toggle",o)),h.onScroll!=null&&gt("scroll",o),h.onScrollEnd!=null&&gt("scrollend",o),h.onClick!=null&&(o.onclick=ti),o=!0):o=!1,o||vo(s,!0)}function dn(s){for(It=s.return;It;)switch(It.tag){case 5:case 31:case 13:Vi=!1;return;case 27:case 3:Vi=!0;return;default:It=It.return}}function js(s){if(s!==It)return!1;if(!mt)return dn(s),mt=!0,!1;var o=s.tag,l;if((l=o!==3&&o!==27)&&((l=o===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||Qm(s.type,s.memoizedProps)),l=!l),l&&Nt&&vo(s),dn(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Nt=e0(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Nt=e0(s)}else o===27?(o=Nt,jr(s.type)?(s=np,np=null,Nt=s):Nt=o):Nt=It?Ns(s.stateNode.nextSibling):null;return!0}function qo(){Nt=It=null,mt=!1}function Fu(){var s=yo;return s!==null&&(Bi===null?Bi=s:Bi.push.apply(Bi,s),yo=null),s}function qa(s){yo===null?yo=[s]:yo.push(s)}var Ha=j(null),To=null,Ks=null;function Pr(s,o,l){be(Ha,o._currentValue),o._currentValue=l}function Ho(s){s._currentValue=Ha.current,he(Ha)}function Vf(s,o,l){for(;s!==null;){var h=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),s===l)break;s=s.return}}function Of(s,o,l,h){var T=s.child;for(T!==null&&(T.return=s);T!==null;){var w=T.dependencies;if(w!==null){var N=T.child;w=w.firstContext;e:for(;w!==null;){var D=w;w=T;for(var Z=0;Z<o.length;Z++)if(D.context===o[Z]){w.lanes|=l,D=w.alternate,D!==null&&(D.lanes|=l),Vf(w.return,l,s),h||(N=null);break e}w=D.next}}else if(T.tag===18){if(N=T.return,N===null)throw Error(i(341));N.lanes|=l,w=N.alternate,w!==null&&(w.lanes|=l),Vf(N,l,s),N=null}else N=T.child;if(N!==null)N.return=T;else for(N=T;N!==null;){if(N===s){N=null;break}if(T=N.sibling,T!==null){T.return=N.return,N=T;break}N=N.return}T=N}}function Pl(s,o,l,h){s=null;for(var T=o,w=!1;T!==null;){if(!w){if((T.flags&524288)!==0)w=!0;else if((T.flags&262144)!==0)break}if(T.tag===10){var N=T.alternate;if(N===null)throw Error(i(387));if(N=N.memoizedProps,N!==null){var D=T.type;Hn(T.pendingProps.value,N.value)||(s!==null?s.push(D):s=[D])}}else if(T===_e.current){if(N=T.alternate,N===null)throw Error(i(387));N.memoizedState.memoizedState!==T.memoizedState.memoizedState&&(s!==null?s.push(mc):s=[mc])}T=T.return}s!==null&&Of(o,s,l,h),o.flags|=262144}function hd(s){for(s=s.firstContext;s!==null;){if(!Hn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ga(s){To=s,Ks=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Yn(s){return R_(To,s)}function fd(s,o){return To===null&&Ga(s),R_(s,o)}function R_(s,o){var l=o._currentValue;if(o={context:o,memoizedValue:l,next:null},Ks===null){if(s===null)throw Error(i(308));Ks=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Ks=Ks.next=o;return l}var dA=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(l,h){s.push(h)}};this.abort=function(){o.aborted=!0,s.forEach(function(l){return l()})}},hA=n.unstable_scheduleCallback,fA=n.unstable_NormalPriority,Cn={$$typeof:ee,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uf(){return{controller:new dA,data:new Map,refCount:0}}function qu(s){s.refCount--,s.refCount===0&&hA(fA,function(){s.controller.abort()})}var Hu=null,zf=0,kl=0,Dl=null;function mA(s,o){if(Hu===null){var l=Hu=[];zf=0,kl=qm(),Dl={status:"pending",value:void 0,then:function(h){l.push(h)}}}return zf++,o.then(M_,M_),o}function M_(){if(--zf===0&&Hu!==null){Dl!==null&&(Dl.status="fulfilled");var s=Hu;Hu=null,kl=0,Dl=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function pA(s,o){var l=[],h={status:"pending",value:null,reason:null,then:function(T){l.push(T)}};return s.then(function(){h.status="fulfilled",h.value=o;for(var T=0;T<l.length;T++)(0,l[T])(o)},function(T){for(h.status="rejected",h.reason=T,T=0;T<l.length;T++)(0,l[T])(void 0)}),h}var P_=te.S;te.S=function(s,o){pv=dt(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&mA(s,o),P_!==null&&P_(s,o)};var ja=j(null);function Bf(){var s=ja.current;return s!==null?s:Yt.pooledCache}function md(s,o){o===null?be(ja,ja.current):be(ja,o.pool)}function k_(){var s=Bf();return s===null?null:{parent:Cn._currentValue,pool:s}}var Ll=Error(i(460)),Ff=Error(i(474)),pd=Error(i(542)),gd={then:function(){}};function D_(s){return s=s.status,s==="fulfilled"||s==="rejected"}function L_(s,o,l){switch(l=s[l],l===void 0?s.push(o):l!==o&&(o.then(ti,ti),o=l),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,O_(s),s;default:if(typeof o.status=="string")o.then(ti,ti);else{if(s=Yt,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=o,s.status="pending",s.then(function(h){if(o.status==="pending"){var T=o;T.status="fulfilled",T.value=h}},function(h){if(o.status==="pending"){var T=o;T.status="rejected",T.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,O_(s),s}throw Za=o,Ll}}function Ka(s){try{var o=s._init;return o(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Za=l,Ll):l}}var Za=null;function V_(){if(Za===null)throw Error(i(459));var s=Za;return Za=null,s}function O_(s){if(s===Ll||s===pd)throw Error(i(483))}var Vl=null,Gu=0;function _d(s){var o=Gu;return Gu+=1,Vl===null&&(Vl=[]),L_(Vl,s,o)}function ju(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function yd(s,o){throw o.$$typeof===C?Error(i(525)):(s=Object.prototype.toString.call(o),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function U_(s){function o($,Q){if(s){var se=$.deletions;se===null?($.deletions=[Q],$.flags|=16):se.push(Q)}}function l($,Q){if(!s)return null;for(;Q!==null;)o($,Q),Q=Q.sibling;return null}function h($){for(var Q=new Map;$!==null;)$.key!==null?Q.set($.key,$):Q.set($.index,$),$=$.sibling;return Q}function T($,Q){return $=bs($,Q),$.index=0,$.sibling=null,$}function w($,Q,se){return $.index=se,s?(se=$.alternate,se!==null?(se=se.index,se<Q?($.flags|=67108866,Q):se):($.flags|=67108866,Q)):($.flags|=1048576,Q)}function N($){return s&&$.alternate===null&&($.flags|=67108866),$}function D($,Q,se,ge){return Q===null||Q.tag!==6?(Q=Rl(se,$.mode,ge),Q.return=$,Q):(Q=T(Q,se),Q.return=$,Q)}function Z($,Q,se,ge){var Ge=se.type;return Ge===H?fe($,Q,se.props.children,ge,se.key):Q!==null&&(Q.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===U&&Ka(Ge)===Q.type)?(Q=T(Q,se.props),ju(Q,se),Q.return=$,Q):(Q=Fa(se.type,se.key,se.props,null,$.mode,ge),ju(Q,se),Q.return=$,Q)}function oe($,Q,se,ge){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==se.containerInfo||Q.stateNode.implementation!==se.implementation?(Q=zu(se,$.mode,ge),Q.return=$,Q):(Q=T(Q,se.children||[]),Q.return=$,Q)}function fe($,Q,se,ge,Ge){return Q===null||Q.tag!==7?(Q=Fo(se,$.mode,ge,Ge),Q.return=$,Q):(Q=T(Q,se),Q.return=$,Q)}function Te($,Q,se){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Rl(""+Q,$.mode,se),Q.return=$,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case M:return se=Fa(Q.type,Q.key,Q.props,null,$.mode,se),ju(se,Q),se.return=$,se;case F:return Q=zu(Q,$.mode,se),Q.return=$,Q;case U:return Q=Ka(Q),Te($,Q,se)}if(Xe(Q)||K(Q))return Q=Fo(Q,$.mode,se,null),Q.return=$,Q;if(typeof Q.then=="function")return Te($,_d(Q),se);if(Q.$$typeof===ee)return Te($,fd($,Q),se);yd($,Q)}return null}function le($,Q,se,ge){var Ge=Q!==null?Q.key:null;if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return Ge!==null?null:D($,Q,""+se,ge);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case M:return se.key===Ge?Z($,Q,se,ge):null;case F:return se.key===Ge?oe($,Q,se,ge):null;case U:return se=Ka(se),le($,Q,se,ge)}if(Xe(se)||K(se))return Ge!==null?null:fe($,Q,se,ge,null);if(typeof se.then=="function")return le($,Q,_d(se),ge);if(se.$$typeof===ee)return le($,Q,fd($,se),ge);yd($,se)}return null}function de($,Q,se,ge,Ge){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return $=$.get(se)||null,D(Q,$,""+ge,Ge);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case M:return $=$.get(ge.key===null?se:ge.key)||null,Z(Q,$,ge,Ge);case F:return $=$.get(ge.key===null?se:ge.key)||null,oe(Q,$,ge,Ge);case U:return ge=Ka(ge),de($,Q,se,ge,Ge)}if(Xe(ge)||K(ge))return $=$.get(se)||null,fe(Q,$,ge,Ge,null);if(typeof ge.then=="function")return de($,Q,se,_d(ge),Ge);if(ge.$$typeof===ee)return de($,Q,se,fd(Q,ge),Ge);yd(Q,ge)}return null}function Be($,Q,se,ge){for(var Ge=null,Rt=null,Fe=Q,lt=Q=0,vt=null;Fe!==null&&lt<se.length;lt++){Fe.index>lt?(vt=Fe,Fe=null):vt=Fe.sibling;var Mt=le($,Fe,se[lt],ge);if(Mt===null){Fe===null&&(Fe=vt);break}s&&Fe&&Mt.alternate===null&&o($,Fe),Q=w(Mt,Q,lt),Rt===null?Ge=Mt:Rt.sibling=Mt,Rt=Mt,Fe=vt}if(lt===se.length)return l($,Fe),mt&&He($,lt),Ge;if(Fe===null){for(;lt<se.length;lt++)Fe=Te($,se[lt],ge),Fe!==null&&(Q=w(Fe,Q,lt),Rt===null?Ge=Fe:Rt.sibling=Fe,Rt=Fe);return mt&&He($,lt),Ge}for(Fe=h(Fe);lt<se.length;lt++)vt=de(Fe,$,lt,se[lt],ge),vt!==null&&(s&&vt.alternate!==null&&Fe.delete(vt.key===null?lt:vt.key),Q=w(vt,Q,lt),Rt===null?Ge=vt:Rt.sibling=vt,Rt=vt);return s&&Fe.forEach(function(Jr){return o($,Jr)}),mt&&He($,lt),Ge}function Ye($,Q,se,ge){if(se==null)throw Error(i(151));for(var Ge=null,Rt=null,Fe=Q,lt=Q=0,vt=null,Mt=se.next();Fe!==null&&!Mt.done;lt++,Mt=se.next()){Fe.index>lt?(vt=Fe,Fe=null):vt=Fe.sibling;var Jr=le($,Fe,Mt.value,ge);if(Jr===null){Fe===null&&(Fe=vt);break}s&&Fe&&Jr.alternate===null&&o($,Fe),Q=w(Jr,Q,lt),Rt===null?Ge=Jr:Rt.sibling=Jr,Rt=Jr,Fe=vt}if(Mt.done)return l($,Fe),mt&&He($,lt),Ge;if(Fe===null){for(;!Mt.done;lt++,Mt=se.next())Mt=Te($,Mt.value,ge),Mt!==null&&(Q=w(Mt,Q,lt),Rt===null?Ge=Mt:Rt.sibling=Mt,Rt=Mt);return mt&&He($,lt),Ge}for(Fe=h(Fe);!Mt.done;lt++,Mt=se.next())Mt=de(Fe,$,lt,Mt.value,ge),Mt!==null&&(s&&Mt.alternate!==null&&Fe.delete(Mt.key===null?lt:Mt.key),Q=w(Mt,Q,lt),Rt===null?Ge=Mt:Rt.sibling=Mt,Rt=Mt);return s&&Fe.forEach(function(CC){return o($,CC)}),mt&&He($,lt),Ge}function Gt($,Q,se,ge){if(typeof se=="object"&&se!==null&&se.type===H&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case M:e:{for(var Ge=se.key;Q!==null;){if(Q.key===Ge){if(Ge=se.type,Ge===H){if(Q.tag===7){l($,Q.sibling),ge=T(Q,se.props.children),ge.return=$,$=ge;break e}}else if(Q.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===U&&Ka(Ge)===Q.type){l($,Q.sibling),ge=T(Q,se.props),ju(ge,se),ge.return=$,$=ge;break e}l($,Q);break}else o($,Q);Q=Q.sibling}se.type===H?(ge=Fo(se.props.children,$.mode,ge,se.key),ge.return=$,$=ge):(ge=Fa(se.type,se.key,se.props,null,$.mode,ge),ju(ge,se),ge.return=$,$=ge)}return N($);case F:e:{for(Ge=se.key;Q!==null;){if(Q.key===Ge)if(Q.tag===4&&Q.stateNode.containerInfo===se.containerInfo&&Q.stateNode.implementation===se.implementation){l($,Q.sibling),ge=T(Q,se.children||[]),ge.return=$,$=ge;break e}else{l($,Q);break}else o($,Q);Q=Q.sibling}ge=zu(se,$.mode,ge),ge.return=$,$=ge}return N($);case U:return se=Ka(se),Gt($,Q,se,ge)}if(Xe(se))return Be($,Q,se,ge);if(K(se)){if(Ge=K(se),typeof Ge!="function")throw Error(i(150));return se=Ge.call(se),Ye($,Q,se,ge)}if(typeof se.then=="function")return Gt($,Q,_d(se),ge);if(se.$$typeof===ee)return Gt($,Q,fd($,se),ge);yd($,se)}return typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint"?(se=""+se,Q!==null&&Q.tag===6?(l($,Q.sibling),ge=T(Q,se),ge.return=$,$=ge):(l($,Q),ge=Rl(se,$.mode,ge),ge.return=$,$=ge),N($)):l($,Q)}return function($,Q,se,ge){try{Gu=0;var Ge=Gt($,Q,se,ge);return Vl=null,Ge}catch(Fe){if(Fe===Ll||Fe===pd)throw Fe;var Rt=ri(29,Fe,null,$.mode);return Rt.lanes=ge,Rt.return=$,Rt}finally{}}}var Ya=U_(!0),z_=U_(!1),kr=!1;function qf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hf(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Dr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Lr(s,o,l){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(kt&2)!==0){var T=h.pending;return T===null?o.next=o:(o.next=T.next,T.next=o),h.pending=o,o=Ba(s),Mr(s,null,l),o}return _o(s,h,o,l),Ba(s)}function Ku(s,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194048)!==0)){var h=o.lanes;h&=s.pendingLanes,l|=h,o.lanes=l,ya(s,l)}}function Gf(s,o){var l=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var T=null,w=null;if(l=l.firstBaseUpdate,l!==null){do{var N={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};w===null?T=w=N:w=w.next=N,l=l.next}while(l!==null);w===null?T=w=o:w=w.next=o}else T=w=o;l={baseState:h.baseState,firstBaseUpdate:T,lastBaseUpdate:w,shared:h.shared,callbacks:h.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=o:s.next=o,l.lastBaseUpdate=o}var jf=!1;function Zu(){if(jf){var s=Dl;if(s!==null)throw s}}function Yu(s,o,l,h){jf=!1;var T=s.updateQueue;kr=!1;var w=T.firstBaseUpdate,N=T.lastBaseUpdate,D=T.shared.pending;if(D!==null){T.shared.pending=null;var Z=D,oe=Z.next;Z.next=null,N===null?w=oe:N.next=oe,N=Z;var fe=s.alternate;fe!==null&&(fe=fe.updateQueue,D=fe.lastBaseUpdate,D!==N&&(D===null?fe.firstBaseUpdate=oe:D.next=oe,fe.lastBaseUpdate=Z))}if(w!==null){var Te=T.baseState;N=0,fe=oe=Z=null,D=w;do{var le=D.lane&-536870913,de=le!==D.lane;if(de?(yt&le)===le:(h&le)===le){le!==0&&le===kl&&(jf=!0),fe!==null&&(fe=fe.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Be=s,Ye=D;le=o;var Gt=l;switch(Ye.tag){case 1:if(Be=Ye.payload,typeof Be=="function"){Te=Be.call(Gt,Te,le);break e}Te=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=Ye.payload,le=typeof Be=="function"?Be.call(Gt,Te,le):Be,le==null)break e;Te=S({},Te,le);break e;case 2:kr=!0}}le=D.callback,le!==null&&(s.flags|=64,de&&(s.flags|=8192),de=T.callbacks,de===null?T.callbacks=[le]:de.push(le))}else de={lane:le,tag:D.tag,payload:D.payload,callback:D.callback,next:null},fe===null?(oe=fe=de,Z=Te):fe=fe.next=de,N|=le;if(D=D.next,D===null){if(D=T.shared.pending,D===null)break;de=D,D=de.next,de.next=null,T.lastBaseUpdate=de,T.shared.pending=null}}while(!0);fe===null&&(Z=Te),T.baseState=Z,T.firstBaseUpdate=oe,T.lastBaseUpdate=fe,w===null&&(T.shared.lanes=0),Br|=N,s.lanes=N,s.memoizedState=Te}}function B_(s,o){if(typeof s!="function")throw Error(i(191,s));s.call(o)}function F_(s,o){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)B_(l[s],o)}var Ol=j(null),vd=j(0);function q_(s,o){s=$o,be(vd,s),be(Ol,o),$o=s|o.baseLanes}function Kf(){be(vd,$o),be(Ol,Ol.current)}function Zf(){$o=vd.current,he(Ol),he(vd)}var ss=j(null),Is=null;function Vr(s){var o=s.alternate;be(En,En.current&1),be(ss,s),Is===null&&(o===null||Ol.current!==null||o.memoizedState!==null)&&(Is=s)}function Yf(s){be(En,En.current),be(ss,s),Is===null&&(Is=s)}function H_(s){s.tag===22?(be(En,En.current),be(ss,s),Is===null&&(Is=s)):Or()}function Or(){be(En,En.current),be(ss,ss.current)}function os(s){he(ss),Is===s&&(Is=null),he(En)}var En=j(0);function Td(s){for(var o=s;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||ep(l)||tp(l)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Go=0,rt=null,qt=null,bn=null,Ed=!1,Ul=!1,Wa=!1,xd=0,Wu=0,zl=null,gA=0;function _n(){throw Error(i(321))}function Wf(s,o){if(o===null)return!1;for(var l=0;l<o.length&&l<s.length;l++)if(!Hn(s[l],o[l]))return!1;return!0}function Jf(s,o,l,h,T,w){return Go=w,rt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,te.H=s===null||s.memoizedState===null?Cy:dm,Wa=!1,w=l(h,T),Wa=!1,Ul&&(w=j_(o,l,h,T)),G_(s),w}function G_(s){te.H=$u;var o=qt!==null&&qt.next!==null;if(Go=0,bn=qt=rt=null,Ed=!1,Wu=0,zl=null,o)throw Error(i(300));s===null||In||(s=s.dependencies,s!==null&&hd(s)&&(In=!0))}function j_(s,o,l,h){rt=s;var T=0;do{if(Ul&&(zl=null),Wu=0,Ul=!1,25<=T)throw Error(i(301));if(T+=1,bn=qt=null,s.updateQueue!=null){var w=s.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}te.H=by,w=o(l,h)}while(Ul);return w}function _A(){var s=te.H,o=s.useState()[0];return o=typeof o.then=="function"?Ju(o):o,s=s.useState()[0],(qt!==null?qt.memoizedState:null)!==s&&(rt.flags|=1024),o}function Qf(){var s=xd!==0;return xd=0,s}function $f(s,o,l){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~l}function Xf(s){if(Ed){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}Ed=!1}Go=0,bn=qt=rt=null,Ul=!1,Wu=xd=0,zl=null}function wi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bn===null?rt.memoizedState=bn=s:bn=bn.next=s,bn}function xn(){if(qt===null){var s=rt.alternate;s=s!==null?s.memoizedState:null}else s=qt.next;var o=bn===null?rt.memoizedState:bn.next;if(o!==null)bn=o,qt=s;else{if(s===null)throw rt.alternate===null?Error(i(467)):Error(i(310));qt=s,s={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},bn===null?rt.memoizedState=bn=s:bn=bn.next=s}return bn}function wd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ju(s){var o=Wu;return Wu+=1,zl===null&&(zl=[]),s=L_(zl,s,o),o=rt,(bn===null?o.memoizedState:bn.next)===null&&(o=o.alternate,te.H=o===null||o.memoizedState===null?Cy:dm),s}function Sd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ju(s);if(s.$$typeof===ee)return Yn(s)}throw Error(i(438,String(s)))}function em(s){var o=null,l=rt.updateQueue;if(l!==null&&(o=l.memoCache),o==null){var h=rt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(T){return T.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),l===null&&(l=wd(),rt.updateQueue=l),l.memoCache=o,l=o.data[o.index],l===void 0)for(l=o.data[o.index]=Array(s),h=0;h<s;h++)l[h]=B;return o.index++,l}function jo(s,o){return typeof o=="function"?o(s):o}function Ad(s){var o=xn();return tm(o,qt,s)}function tm(s,o,l){var h=s.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=l;var T=s.baseQueue,w=h.pending;if(w!==null){if(T!==null){var N=T.next;T.next=w.next,w.next=N}o.baseQueue=T=w,h.pending=null}if(w=s.baseState,T===null)s.memoizedState=w;else{o=T.next;var D=N=null,Z=null,oe=o,fe=!1;do{var Te=oe.lane&-536870913;if(Te!==oe.lane?(yt&Te)===Te:(Go&Te)===Te){var le=oe.revertLane;if(le===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),Te===kl&&(fe=!0);else if((Go&le)===le){oe=oe.next,le===kl&&(fe=!0);continue}else Te={lane:0,revertLane:oe.revertLane,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},Z===null?(D=Z=Te,N=w):Z=Z.next=Te,rt.lanes|=le,Br|=le;Te=oe.action,Wa&&l(w,Te),w=oe.hasEagerState?oe.eagerState:l(w,Te)}else le={lane:Te,revertLane:oe.revertLane,gesture:oe.gesture,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},Z===null?(D=Z=le,N=w):Z=Z.next=le,rt.lanes|=Te,Br|=Te;oe=oe.next}while(oe!==null&&oe!==o);if(Z===null?N=w:Z.next=D,!Hn(w,s.memoizedState)&&(In=!0,fe&&(l=Dl,l!==null)))throw l;s.memoizedState=w,s.baseState=N,s.baseQueue=Z,h.lastRenderedState=w}return T===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function nm(s){var o=xn(),l=o.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var h=l.dispatch,T=l.pending,w=o.memoizedState;if(T!==null){l.pending=null;var N=T=T.next;do w=s(w,N.action),N=N.next;while(N!==T);Hn(w,o.memoizedState)||(In=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),l.lastRenderedState=w}return[w,h]}function K_(s,o,l){var h=rt,T=xn(),w=mt;if(w){if(l===void 0)throw Error(i(407));l=l()}else l=o();var N=!Hn((qt||T).memoizedState,l);if(N&&(T.memoizedState=l,In=!0),T=T.queue,om(W_.bind(null,h,T,s),[s]),T.getSnapshot!==o||N||bn!==null&&bn.memoizedState.tag&1){if(h.flags|=2048,Bl(9,{destroy:void 0},Y_.bind(null,h,T,l,o),null),Yt===null)throw Error(i(349));w||(Go&127)!==0||Z_(h,o,l)}return l}function Z_(s,o,l){s.flags|=16384,s={getSnapshot:o,value:l},o=rt.updateQueue,o===null?(o=wd(),rt.updateQueue=o,o.stores=[s]):(l=o.stores,l===null?o.stores=[s]:l.push(s))}function Y_(s,o,l,h){o.value=l,o.getSnapshot=h,J_(o)&&Q_(s)}function W_(s,o,l){return l(function(){J_(o)&&Q_(s)})}function J_(s){var o=s.getSnapshot;s=s.value;try{var l=o();return!Hn(s,l)}catch{return!0}}function Q_(s){var o=Cs(s,2);o!==null&&Fi(o,s,2)}function im(s){var o=wi();if(typeof s=="function"){var l=s;if(s=l(),Wa){Dn(!0);try{l()}finally{Dn(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:s},o}function $_(s,o,l,h){return s.baseState=l,tm(s,qt,typeof h=="function"?h:jo)}function yA(s,o,l,h,T){if(Id(s))throw Error(i(485));if(s=o.action,s!==null){var w={payload:T,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){w.listeners.push(N)}};te.T!==null?l(!0):w.isTransition=!1,h(w),l=o.pending,l===null?(w.next=o.pending=w,X_(o,w)):(w.next=l.next,o.pending=l.next=w)}}function X_(s,o){var l=o.action,h=o.payload,T=s.state;if(o.isTransition){var w=te.T,N={};te.T=N;try{var D=l(T,h),Z=te.S;Z!==null&&Z(N,D),ey(s,o,D)}catch(oe){sm(s,o,oe)}finally{w!==null&&N.types!==null&&(w.types=N.types),te.T=w}}else try{w=l(T,h),ey(s,o,w)}catch(oe){sm(s,o,oe)}}function ey(s,o,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(h){ty(s,o,h)},function(h){return sm(s,o,h)}):ty(s,o,l)}function ty(s,o,l){o.status="fulfilled",o.value=l,ny(o),s.state=l,o=s.pending,o!==null&&(l=o.next,l===o?s.pending=null:(l=l.next,o.next=l,X_(s,l)))}function sm(s,o,l){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=l,ny(o),o=o.next;while(o!==h)}s.action=null}function ny(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function iy(s,o){return o}function sy(s,o){if(mt){var l=Yt.formState;if(l!==null){e:{var h=rt;if(mt){if(Nt){t:{for(var T=Nt,w=Vi;T.nodeType!==8;){if(!w){T=null;break t}if(T=Ns(T.nextSibling),T===null){T=null;break t}}w=T.data,T=w==="F!"||w==="F"?T:null}if(T){Nt=Ns(T.nextSibling),h=T.data==="F!";break e}}vo(h)}h=!1}h&&(o=l[0])}}return l=wi(),l.memoizedState=l.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:iy,lastRenderedState:o},l.queue=h,l=wy.bind(null,rt,h),h.dispatch=l,h=im(!1),w=cm.bind(null,rt,!1,h.queue),h=wi(),T={state:o,dispatch:null,action:s,pending:null},h.queue=T,l=yA.bind(null,rt,T,w,l),T.dispatch=l,h.memoizedState=s,[o,l,!1]}function oy(s){var o=xn();return ry(o,qt,s)}function ry(s,o,l){if(o=tm(s,o,iy)[0],s=Ad(jo)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=Ju(o)}catch(N){throw N===Ll?pd:N}else h=o;o=xn();var T=o.queue,w=T.dispatch;return l!==o.memoizedState&&(rt.flags|=2048,Bl(9,{destroy:void 0},vA.bind(null,T,l),null)),[h,w,s]}function vA(s,o){s.action=o}function ay(s){var o=xn(),l=qt;if(l!==null)return ry(o,l,s);xn(),o=o.memoizedState,l=xn();var h=l.queue.dispatch;return l.memoizedState=s,[o,h,!1]}function Bl(s,o,l,h){return s={tag:s,create:l,deps:h,inst:o,next:null},o=rt.updateQueue,o===null&&(o=wd(),rt.updateQueue=o),l=o.lastEffect,l===null?o.lastEffect=s.next=s:(h=l.next,l.next=s,s.next=h,o.lastEffect=s),s}function ly(){return xn().memoizedState}function Cd(s,o,l,h){var T=wi();rt.flags|=s,T.memoizedState=Bl(1|o,{destroy:void 0},l,h===void 0?null:h)}function bd(s,o,l,h){var T=xn();h=h===void 0?null:h;var w=T.memoizedState.inst;qt!==null&&h!==null&&Wf(h,qt.memoizedState.deps)?T.memoizedState=Bl(o,w,l,h):(rt.flags|=s,T.memoizedState=Bl(1|o,w,l,h))}function uy(s,o){Cd(8390656,8,s,o)}function om(s,o){bd(2048,8,s,o)}function TA(s){rt.flags|=4;var o=rt.updateQueue;if(o===null)o=wd(),rt.updateQueue=o,o.events=[s];else{var l=o.events;l===null?o.events=[s]:l.push(s)}}function cy(s){var o=xn().memoizedState;return TA({ref:o,nextImpl:s}),function(){if((kt&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function dy(s,o){return bd(4,2,s,o)}function hy(s,o){return bd(4,4,s,o)}function fy(s,o){if(typeof o=="function"){s=s();var l=o(s);return function(){typeof l=="function"?l():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function my(s,o,l){l=l!=null?l.concat([s]):null,bd(4,4,fy.bind(null,o,s),l)}function rm(){}function py(s,o){var l=xn();o=o===void 0?null:o;var h=l.memoizedState;return o!==null&&Wf(o,h[1])?h[0]:(l.memoizedState=[s,o],s)}function gy(s,o){var l=xn();o=o===void 0?null:o;var h=l.memoizedState;if(o!==null&&Wf(o,h[1]))return h[0];if(h=s(),Wa){Dn(!0);try{s()}finally{Dn(!1)}}return l.memoizedState=[h,o],h}function am(s,o,l){return l===void 0||(Go&1073741824)!==0&&(yt&261930)===0?s.memoizedState=o:(s.memoizedState=l,s=_v(),rt.lanes|=s,Br|=s,l)}function _y(s,o,l,h){return Hn(l,o)?l:Ol.current!==null?(s=am(s,l,h),Hn(s,o)||(In=!0),s):(Go&42)===0||(Go&1073741824)!==0&&(yt&261930)===0?(In=!0,s.memoizedState=l):(s=_v(),rt.lanes|=s,Br|=s,o)}function yy(s,o,l,h,T){var w=Se.p;Se.p=w!==0&&8>w?w:8;var N=te.T,D={};te.T=D,cm(s,!1,o,l);try{var Z=T(),oe=te.S;if(oe!==null&&oe(D,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var fe=pA(Z,h);Qu(s,o,fe,ls(s))}else Qu(s,o,h,ls(s))}catch(Te){Qu(s,o,{then:function(){},status:"rejected",reason:Te},ls())}finally{Se.p=w,N!==null&&D.types!==null&&(N.types=D.types),te.T=N}}function EA(){}function lm(s,o,l,h){if(s.tag!==5)throw Error(i(476));var T=vy(s).queue;yy(s,T,o,Ae,l===null?EA:function(){return Ty(s),l(h)})}function vy(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:Ae,baseState:Ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:Ae},next:null};var l={};return o.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:l},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Ty(s){var o=vy(s);o.next===null&&(o=s.alternate.memoizedState),Qu(s,o.next.queue,{},ls())}function um(){return Yn(mc)}function Ey(){return xn().memoizedState}function xy(){return xn().memoizedState}function xA(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var l=ls();s=Dr(l);var h=Lr(o,s,l);h!==null&&(Fi(h,o,l),Ku(h,o,l)),o={cache:Uf()},s.payload=o;return}o=o.return}}function wA(s,o,l){var h=ls();l={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Id(s)?Sy(o,l):(l=Vu(s,o,l,h),l!==null&&(Fi(l,s,h),Ay(l,o,h)))}function wy(s,o,l){var h=ls();Qu(s,o,l,h)}function Qu(s,o,l,h){var T={lane:h,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Id(s))Sy(o,T);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var N=o.lastRenderedState,D=w(N,l);if(T.hasEagerState=!0,T.eagerState=D,Hn(D,N))return _o(s,o,T,0),Yt===null&&za(),!1}catch{}finally{}if(l=Vu(s,o,T,h),l!==null)return Fi(l,s,h),Ay(l,o,h),!0}return!1}function cm(s,o,l,h){if(h={lane:2,revertLane:qm(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Id(s)){if(o)throw Error(i(479))}else o=Vu(s,l,h,2),o!==null&&Fi(o,s,2)}function Id(s){var o=s.alternate;return s===rt||o!==null&&o===rt}function Sy(s,o){Ul=Ed=!0;var l=s.pending;l===null?o.next=o:(o.next=l.next,l.next=o),s.pending=o}function Ay(s,o,l){if((l&4194048)!==0){var h=o.lanes;h&=s.pendingLanes,l|=h,o.lanes=l,ya(s,l)}}var $u={readContext:Yn,use:Sd,useCallback:_n,useContext:_n,useEffect:_n,useImperativeHandle:_n,useLayoutEffect:_n,useInsertionEffect:_n,useMemo:_n,useReducer:_n,useRef:_n,useState:_n,useDebugValue:_n,useDeferredValue:_n,useTransition:_n,useSyncExternalStore:_n,useId:_n,useHostTransitionStatus:_n,useFormState:_n,useActionState:_n,useOptimistic:_n,useMemoCache:_n,useCacheRefresh:_n};$u.useEffectEvent=_n;var Cy={readContext:Yn,use:Sd,useCallback:function(s,o){return wi().memoizedState=[s,o===void 0?null:o],s},useContext:Yn,useEffect:uy,useImperativeHandle:function(s,o,l){l=l!=null?l.concat([s]):null,Cd(4194308,4,fy.bind(null,o,s),l)},useLayoutEffect:function(s,o){return Cd(4194308,4,s,o)},useInsertionEffect:function(s,o){Cd(4,2,s,o)},useMemo:function(s,o){var l=wi();o=o===void 0?null:o;var h=s();if(Wa){Dn(!0);try{s()}finally{Dn(!1)}}return l.memoizedState=[h,o],h},useReducer:function(s,o,l){var h=wi();if(l!==void 0){var T=l(o);if(Wa){Dn(!0);try{l(o)}finally{Dn(!1)}}}else T=o;return h.memoizedState=h.baseState=T,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:T},h.queue=s,s=s.dispatch=wA.bind(null,rt,s),[h.memoizedState,s]},useRef:function(s){var o=wi();return s={current:s},o.memoizedState=s},useState:function(s){s=im(s);var o=s.queue,l=wy.bind(null,rt,o);return o.dispatch=l,[s.memoizedState,l]},useDebugValue:rm,useDeferredValue:function(s,o){var l=wi();return am(l,s,o)},useTransition:function(){var s=im(!1);return s=yy.bind(null,rt,s.queue,!0,!1),wi().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,l){var h=rt,T=wi();if(mt){if(l===void 0)throw Error(i(407));l=l()}else{if(l=o(),Yt===null)throw Error(i(349));(yt&127)!==0||Z_(h,o,l)}T.memoizedState=l;var w={value:l,getSnapshot:o};return T.queue=w,uy(W_.bind(null,h,w,s),[s]),h.flags|=2048,Bl(9,{destroy:void 0},Y_.bind(null,h,w,l,o),null),l},useId:function(){var s=wi(),o=Yt.identifierPrefix;if(mt){var l=Me,h=ve;l=(h&~(1<<32-Qt(h)-1)).toString(32)+l,o="_"+o+"R_"+l,l=xd++,0<l&&(o+="H"+l.toString(32)),o+="_"}else l=gA++,o="_"+o+"r_"+l.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:um,useFormState:sy,useActionState:sy,useOptimistic:function(s){var o=wi();o.memoizedState=o.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=l,o=cm.bind(null,rt,!0,l),l.dispatch=o,[s,o]},useMemoCache:em,useCacheRefresh:function(){return wi().memoizedState=xA.bind(null,rt)},useEffectEvent:function(s){var o=wi(),l={impl:s};return o.memoizedState=l,function(){if((kt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},dm={readContext:Yn,use:Sd,useCallback:py,useContext:Yn,useEffect:om,useImperativeHandle:my,useInsertionEffect:dy,useLayoutEffect:hy,useMemo:gy,useReducer:Ad,useRef:ly,useState:function(){return Ad(jo)},useDebugValue:rm,useDeferredValue:function(s,o){var l=xn();return _y(l,qt.memoizedState,s,o)},useTransition:function(){var s=Ad(jo)[0],o=xn().memoizedState;return[typeof s=="boolean"?s:Ju(s),o]},useSyncExternalStore:K_,useId:Ey,useHostTransitionStatus:um,useFormState:oy,useActionState:oy,useOptimistic:function(s,o){var l=xn();return $_(l,qt,s,o)},useMemoCache:em,useCacheRefresh:xy};dm.useEffectEvent=cy;var by={readContext:Yn,use:Sd,useCallback:py,useContext:Yn,useEffect:om,useImperativeHandle:my,useInsertionEffect:dy,useLayoutEffect:hy,useMemo:gy,useReducer:nm,useRef:ly,useState:function(){return nm(jo)},useDebugValue:rm,useDeferredValue:function(s,o){var l=xn();return qt===null?am(l,s,o):_y(l,qt.memoizedState,s,o)},useTransition:function(){var s=nm(jo)[0],o=xn().memoizedState;return[typeof s=="boolean"?s:Ju(s),o]},useSyncExternalStore:K_,useId:Ey,useHostTransitionStatus:um,useFormState:ay,useActionState:ay,useOptimistic:function(s,o){var l=xn();return qt!==null?$_(l,qt,s,o):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:em,useCacheRefresh:xy};by.useEffectEvent=cy;function hm(s,o,l,h){o=s.memoizedState,l=l(h,o),l=l==null?o:S({},o,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var fm={enqueueSetState:function(s,o,l){s=s._reactInternals;var h=ls(),T=Dr(h);T.payload=o,l!=null&&(T.callback=l),o=Lr(s,T,h),o!==null&&(Fi(o,s,h),Ku(o,s,h))},enqueueReplaceState:function(s,o,l){s=s._reactInternals;var h=ls(),T=Dr(h);T.tag=1,T.payload=o,l!=null&&(T.callback=l),o=Lr(s,T,h),o!==null&&(Fi(o,s,h),Ku(o,s,h))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var l=ls(),h=Dr(l);h.tag=2,o!=null&&(h.callback=o),o=Lr(s,h,l),o!==null&&(Fi(o,s,l),Ku(o,s,l))}};function Iy(s,o,l,h,T,w,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,w,N):o.prototype&&o.prototype.isPureReactComponent?!br(l,h)||!br(T,w):!0}function Ny(s,o,l,h){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,h),o.state!==s&&fm.enqueueReplaceState(o,o.state,null)}function Ja(s,o){var l=o;if("ref"in o){l={};for(var h in o)h!=="ref"&&(l[h]=o[h])}if(s=s.defaultProps){l===o&&(l=S({},l));for(var T in s)l[T]===void 0&&(l[T]=s[T])}return l}function Ry(s){Ua(s)}function My(s){console.error(s)}function Py(s){Ua(s)}function Nd(s,o){try{var l=s.onUncaughtError;l(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function ky(s,o,l){try{var h=s.onCaughtError;h(l.value,{componentStack:l.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(T){setTimeout(function(){throw T})}}function mm(s,o,l){return l=Dr(l),l.tag=3,l.payload={element:null},l.callback=function(){Nd(s,o)},l}function Dy(s){return s=Dr(s),s.tag=3,s}function Ly(s,o,l,h){var T=l.type.getDerivedStateFromError;if(typeof T=="function"){var w=h.value;s.payload=function(){return T(w)},s.callback=function(){ky(o,l,h)}}var N=l.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){ky(o,l,h),typeof T!="function"&&(Fr===null?Fr=new Set([this]):Fr.add(this));var D=h.stack;this.componentDidCatch(h.value,{componentStack:D!==null?D:""})})}function SA(s,o,l,h,T){if(l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=l.alternate,o!==null&&Pl(o,l,T,!0),l=ss.current,l!==null){switch(l.tag){case 31:case 13:return Is===null?Fd():l.alternate===null&&yn===0&&(yn=3),l.flags&=-257,l.flags|=65536,l.lanes=T,h===gd?l.flags|=16384:(o=l.updateQueue,o===null?l.updateQueue=new Set([h]):o.add(h),zm(s,h,T)),!1;case 22:return l.flags|=65536,h===gd?l.flags|=16384:(o=l.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},l.updateQueue=o):(l=o.retryQueue,l===null?o.retryQueue=new Set([h]):l.add(h)),zm(s,h,T)),!1}throw Error(i(435,l.tag))}return zm(s,h,T),Fd(),!1}if(mt)return o=ss.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=T,h!==Ml&&(s=Error(i(422),{cause:h}),qa(d(s,l)))):(h!==Ml&&(o=Error(i(423),{cause:h}),qa(d(o,l))),s=s.current.alternate,s.flags|=65536,T&=-T,s.lanes|=T,h=d(h,l),T=mm(s.stateNode,h,T),Gf(s,T),yn!==4&&(yn=2)),!1;var w=Error(i(520),{cause:h});if(w=d(w,l),rc===null?rc=[w]:rc.push(w),yn!==4&&(yn=2),o===null)return!0;h=d(h,l),l=o;do{switch(l.tag){case 3:return l.flags|=65536,s=T&-T,l.lanes|=s,s=mm(l.stateNode,h,s),Gf(l,s),!1;case 1:if(o=l.type,w=l.stateNode,(l.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Fr===null||!Fr.has(w))))return l.flags|=65536,T&=-T,l.lanes|=T,T=Dy(T),Ly(T,s,l,h),Gf(l,T),!1}l=l.return}while(l!==null);return!1}var pm=Error(i(461)),In=!1;function Wn(s,o,l,h){o.child=s===null?z_(o,null,l,h):Ya(o,s.child,l,h)}function Vy(s,o,l,h,T){l=l.render;var w=o.ref;if("ref"in h){var N={};for(var D in h)D!=="ref"&&(N[D]=h[D])}else N=h;return Ga(o),h=Jf(s,o,l,N,w,T),D=Qf(),s!==null&&!In?($f(s,o,T),Ko(s,o,T)):(mt&&D&&Ln(o),o.flags|=1,Wn(s,o,h,T),o.child)}function Oy(s,o,l,h,T){if(s===null){var w=l.type;return typeof w=="function"&&!Nl(w)&&w.defaultProps===void 0&&l.compare===null?(o.tag=15,o.type=w,Uy(s,o,w,h,T)):(s=Fa(l.type,null,h,o,o.mode,T),s.ref=o.ref,s.return=o,o.child=s)}if(w=s.child,!wm(s,T)){var N=w.memoizedProps;if(l=l.compare,l=l!==null?l:br,l(N,h)&&s.ref===o.ref)return Ko(s,o,T)}return o.flags|=1,s=bs(w,h),s.ref=o.ref,s.return=o,o.child=s}function Uy(s,o,l,h,T){if(s!==null){var w=s.memoizedProps;if(br(w,h)&&s.ref===o.ref)if(In=!1,o.pendingProps=h=w,wm(s,T))(s.flags&131072)!==0&&(In=!0);else return o.lanes=s.lanes,Ko(s,o,T)}return gm(s,o,l,h,T)}function zy(s,o,l,h){var T=h.children,w=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((o.flags&128)!==0){if(w=w!==null?w.baseLanes|l:l,s!==null){for(h=o.child=s.child,T=0;h!==null;)T=T|h.lanes|h.childLanes,h=h.sibling;h=T&~w}else h=0,o.child=null;return By(s,o,w,l,h)}if((l&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&md(o,w!==null?w.cachePool:null),w!==null?q_(o,w):Kf(),H_(o);else return h=o.lanes=536870912,By(s,o,w!==null?w.baseLanes|l:l,l,h)}else w!==null?(md(o,w.cachePool),q_(o,w),Or(),o.memoizedState=null):(s!==null&&md(o,null),Kf(),Or());return Wn(s,o,T,l),o.child}function Xu(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function By(s,o,l,h,T){var w=Bf();return w=w===null?null:{parent:Cn._currentValue,pool:w},o.memoizedState={baseLanes:l,cachePool:w},s!==null&&md(o,null),Kf(),H_(o),s!==null&&Pl(s,o,h,!0),o.childLanes=T,null}function Rd(s,o){return o=Pd({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function Fy(s,o,l){return Ya(o,s.child,null,l),s=Rd(o,o.pendingProps),s.flags|=2,os(o),o.memoizedState=null,s}function AA(s,o,l){var h=o.pendingProps,T=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(mt){if(h.mode==="hidden")return s=Rd(o,h),o.lanes=536870912,Xu(null,s);if(Yf(o),(s=Nt)?(s=Xv(s,Vi),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:ae!==null?{id:ve,overflow:Me}:null,retryLane:536870912,hydrationErrors:null},l=Uu(s),l.return=o,o.child=l,It=o,Nt=null)):s=null,s===null)throw vo(o);return o.lanes=536870912,null}return Rd(o,h)}var w=s.memoizedState;if(w!==null){var N=w.dehydrated;if(Yf(o),T)if(o.flags&256)o.flags&=-257,o=Fy(s,o,l);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(i(558));else if(In||Pl(s,o,l,!1),T=(l&s.childLanes)!==0,In||T){if(h=Yt,h!==null&&(N=va(h,l),N!==0&&N!==w.retryLane))throw w.retryLane=N,Cs(s,N),Fi(h,s,N),pm;Fd(),o=Fy(s,o,l)}else s=w.treeContext,Nt=Ns(N.nextSibling),It=o,mt=!0,yo=null,Vi=!1,s!==null&&xi(o,s),o=Rd(o,h),o.flags|=4096;return o}return s=bs(s.child,{mode:h.mode,children:h.children}),s.ref=o.ref,o.child=s,s.return=o,s}function Md(s,o){var l=o.ref;if(l===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(o.flags|=4194816)}}function gm(s,o,l,h,T){return Ga(o),l=Jf(s,o,l,h,void 0,T),h=Qf(),s!==null&&!In?($f(s,o,T),Ko(s,o,T)):(mt&&h&&Ln(o),o.flags|=1,Wn(s,o,l,T),o.child)}function qy(s,o,l,h,T,w){return Ga(o),o.updateQueue=null,l=j_(o,h,l,T),G_(s),h=Qf(),s!==null&&!In?($f(s,o,w),Ko(s,o,w)):(mt&&h&&Ln(o),o.flags|=1,Wn(s,o,l,w),o.child)}function Hy(s,o,l,h,T){if(Ga(o),o.stateNode===null){var w=Bo,N=l.contextType;typeof N=="object"&&N!==null&&(w=Yn(N)),w=new l(h,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=fm,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=h,w.state=o.memoizedState,w.refs={},qf(o),N=l.contextType,w.context=typeof N=="object"&&N!==null?Yn(N):Bo,w.state=o.memoizedState,N=l.getDerivedStateFromProps,typeof N=="function"&&(hm(o,l,N,h),w.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(N=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),N!==w.state&&fm.enqueueReplaceState(w,w.state,null),Yu(o,h,w,T),Zu(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(s===null){w=o.stateNode;var D=o.memoizedProps,Z=Ja(l,D);w.props=Z;var oe=w.context,fe=l.contextType;N=Bo,typeof fe=="object"&&fe!==null&&(N=Yn(fe));var Te=l.getDerivedStateFromProps;fe=typeof Te=="function"||typeof w.getSnapshotBeforeUpdate=="function",D=o.pendingProps!==D,fe||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(D||oe!==N)&&Ny(o,w,h,N),kr=!1;var le=o.memoizedState;w.state=le,Yu(o,h,w,T),Zu(),oe=o.memoizedState,D||le!==oe||kr?(typeof Te=="function"&&(hm(o,l,Te,h),oe=o.memoizedState),(Z=kr||Iy(o,l,Z,h,le,oe,N))?(fe||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=oe),w.props=h,w.state=oe,w.context=N,h=Z):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{w=o.stateNode,Hf(s,o),N=o.memoizedProps,fe=Ja(l,N),w.props=fe,Te=o.pendingProps,le=w.context,oe=l.contextType,Z=Bo,typeof oe=="object"&&oe!==null&&(Z=Yn(oe)),D=l.getDerivedStateFromProps,(oe=typeof D=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(N!==Te||le!==Z)&&Ny(o,w,h,Z),kr=!1,le=o.memoizedState,w.state=le,Yu(o,h,w,T),Zu();var de=o.memoizedState;N!==Te||le!==de||kr||s!==null&&s.dependencies!==null&&hd(s.dependencies)?(typeof D=="function"&&(hm(o,l,D,h),de=o.memoizedState),(fe=kr||Iy(o,l,fe,h,le,de,Z)||s!==null&&s.dependencies!==null&&hd(s.dependencies))?(oe||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(h,de,Z),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(h,de,Z)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&le===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&le===s.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=de),w.props=h,w.state=de,w.context=Z,h=fe):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&le===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&le===s.memoizedState||(o.flags|=1024),h=!1)}return w=h,Md(s,o),h=(o.flags&128)!==0,w||h?(w=o.stateNode,l=h&&typeof l.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,s!==null&&h?(o.child=Ya(o,s.child,null,T),o.child=Ya(o,null,l,T)):Wn(s,o,l,T),o.memoizedState=w.state,s=o.child):s=Ko(s,o,T),s}function Gy(s,o,l,h){return qo(),o.flags|=256,Wn(s,o,l,h),o.child}var _m={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ym(s){return{baseLanes:s,cachePool:k_()}}function vm(s,o,l){return s=s!==null?s.childLanes&~l:0,o&&(s|=as),s}function jy(s,o,l){var h=o.pendingProps,T=!1,w=(o.flags&128)!==0,N;if((N=w)||(N=s!==null&&s.memoizedState===null?!1:(En.current&2)!==0),N&&(T=!0,o.flags&=-129),N=(o.flags&32)!==0,o.flags&=-33,s===null){if(mt){if(T?Vr(o):Or(),(s=Nt)?(s=Xv(s,Vi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:ae!==null?{id:ve,overflow:Me}:null,retryLane:536870912,hydrationErrors:null},l=Uu(s),l.return=o,o.child=l,It=o,Nt=null)):s=null,s===null)throw vo(o);return tp(s)?o.lanes=32:o.lanes=536870912,null}var D=h.children;return h=h.fallback,T?(Or(),T=o.mode,D=Pd({mode:"hidden",children:D},T),h=Fo(h,T,l,null),D.return=o,h.return=o,D.sibling=h,o.child=D,h=o.child,h.memoizedState=ym(l),h.childLanes=vm(s,N,l),o.memoizedState=_m,Xu(null,h)):(Vr(o),Tm(o,D))}var Z=s.memoizedState;if(Z!==null&&(D=Z.dehydrated,D!==null)){if(w)o.flags&256?(Vr(o),o.flags&=-257,o=Em(s,o,l)):o.memoizedState!==null?(Or(),o.child=s.child,o.flags|=128,o=null):(Or(),D=h.fallback,T=o.mode,h=Pd({mode:"visible",children:h.children},T),D=Fo(D,T,l,null),D.flags|=2,h.return=o,D.return=o,h.sibling=D,o.child=h,Ya(o,s.child,null,l),h=o.child,h.memoizedState=ym(l),h.childLanes=vm(s,N,l),o.memoizedState=_m,o=Xu(null,h));else if(Vr(o),tp(D)){if(N=D.nextSibling&&D.nextSibling.dataset,N)var oe=N.dgst;N=oe,h=Error(i(419)),h.stack="",h.digest=N,qa({value:h,source:null,stack:null}),o=Em(s,o,l)}else if(In||Pl(s,o,l,!1),N=(l&s.childLanes)!==0,In||N){if(N=Yt,N!==null&&(h=va(N,l),h!==0&&h!==Z.retryLane))throw Z.retryLane=h,Cs(s,h),Fi(N,s,h),pm;ep(D)||Fd(),o=Em(s,o,l)}else ep(D)?(o.flags|=192,o.child=s.child,o=null):(s=Z.treeContext,Nt=Ns(D.nextSibling),It=o,mt=!0,yo=null,Vi=!1,s!==null&&xi(o,s),o=Tm(o,h.children),o.flags|=4096);return o}return T?(Or(),D=h.fallback,T=o.mode,Z=s.child,oe=Z.sibling,h=bs(Z,{mode:"hidden",children:h.children}),h.subtreeFlags=Z.subtreeFlags&65011712,oe!==null?D=bs(oe,D):(D=Fo(D,T,l,null),D.flags|=2),D.return=o,h.return=o,h.sibling=D,o.child=h,Xu(null,h),h=o.child,D=s.child.memoizedState,D===null?D=ym(l):(T=D.cachePool,T!==null?(Z=Cn._currentValue,T=T.parent!==Z?{parent:Z,pool:Z}:T):T=k_(),D={baseLanes:D.baseLanes|l,cachePool:T}),h.memoizedState=D,h.childLanes=vm(s,N,l),o.memoizedState=_m,Xu(s.child,h)):(Vr(o),l=s.child,s=l.sibling,l=bs(l,{mode:"visible",children:h.children}),l.return=o,l.sibling=null,s!==null&&(N=o.deletions,N===null?(o.deletions=[s],o.flags|=16):N.push(s)),o.child=l,o.memoizedState=null,l)}function Tm(s,o){return o=Pd({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Pd(s,o){return s=ri(22,s,null,o),s.lanes=0,s}function Em(s,o,l){return Ya(o,s.child,null,l),s=Tm(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function Ky(s,o,l){s.lanes|=o;var h=s.alternate;h!==null&&(h.lanes|=o),Vf(s.return,o,l)}function xm(s,o,l,h,T,w){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:T,treeForkCount:w}:(N.isBackwards=o,N.rendering=null,N.renderingStartTime=0,N.last=h,N.tail=l,N.tailMode=T,N.treeForkCount=w)}function Zy(s,o,l){var h=o.pendingProps,T=h.revealOrder,w=h.tail;h=h.children;var N=En.current,D=(N&2)!==0;if(D?(N=N&1|2,o.flags|=128):N&=1,be(En,N),Wn(s,o,h,l),h=mt?P:0,!D&&s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Ky(s,l,o);else if(s.tag===19)Ky(s,l,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(T){case"forwards":for(l=o.child,T=null;l!==null;)s=l.alternate,s!==null&&Td(s)===null&&(T=l),l=l.sibling;l=T,l===null?(T=o.child,o.child=null):(T=l.sibling,l.sibling=null),xm(o,!1,T,l,w,h);break;case"backwards":case"unstable_legacy-backwards":for(l=null,T=o.child,o.child=null;T!==null;){if(s=T.alternate,s!==null&&Td(s)===null){o.child=T;break}s=T.sibling,T.sibling=l,l=T,T=s}xm(o,!0,l,null,w,h);break;case"together":xm(o,!1,null,null,void 0,h);break;default:o.memoizedState=null}return o.child}function Ko(s,o,l){if(s!==null&&(o.dependencies=s.dependencies),Br|=o.lanes,(l&o.childLanes)===0)if(s!==null){if(Pl(s,o,l,!1),(l&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(i(153));if(o.child!==null){for(s=o.child,l=bs(s,s.pendingProps),o.child=l,l.return=o;s.sibling!==null;)s=s.sibling,l=l.sibling=bs(s,s.pendingProps),l.return=o;l.sibling=null}return o.child}function wm(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&hd(s)))}function CA(s,o,l){switch(o.tag){case 3:Pe(o,o.stateNode.containerInfo),Pr(o,Cn,s.memoizedState.cache),qo();break;case 27:case 5:Je(o);break;case 4:Pe(o,o.stateNode.containerInfo);break;case 10:Pr(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Yf(o),null;break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(Vr(o),o.flags|=128,null):(l&o.child.childLanes)!==0?jy(s,o,l):(Vr(o),s=Ko(s,o,l),s!==null?s.sibling:null);Vr(o);break;case 19:var T=(s.flags&128)!==0;if(h=(l&o.childLanes)!==0,h||(Pl(s,o,l,!1),h=(l&o.childLanes)!==0),T){if(h)return Zy(s,o,l);o.flags|=128}if(T=o.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),be(En,En.current),h)break;return null;case 22:return o.lanes=0,zy(s,o,l,o.pendingProps);case 24:Pr(o,Cn,s.memoizedState.cache)}return Ko(s,o,l)}function Yy(s,o,l){if(s!==null)if(s.memoizedProps!==o.pendingProps)In=!0;else{if(!wm(s,l)&&(o.flags&128)===0)return In=!1,CA(s,o,l);In=(s.flags&131072)!==0}else In=!1,mt&&(o.flags&1048576)!==0&&at(o,P,o.index);switch(o.lanes=0,o.tag){case 16:e:{var h=o.pendingProps;if(s=Ka(o.elementType),o.type=s,typeof s=="function")Nl(s)?(h=Ja(s,h),o.tag=1,o=Hy(null,o,s,h,l)):(o.tag=0,o=gm(null,o,s,h,l));else{if(s!=null){var T=s.$$typeof;if(T===Ee){o.tag=11,o=Vy(null,o,s,h,l);break e}else if(T===k){o.tag=14,o=Oy(null,o,s,h,l);break e}}throw o=Le(s)||s,Error(i(306,o,""))}}return o;case 0:return gm(s,o,o.type,o.pendingProps,l);case 1:return h=o.type,T=Ja(h,o.pendingProps),Hy(s,o,h,T,l);case 3:e:{if(Pe(o,o.stateNode.containerInfo),s===null)throw Error(i(387));h=o.pendingProps;var w=o.memoizedState;T=w.element,Hf(s,o),Yu(o,h,null,l);var N=o.memoizedState;if(h=N.cache,Pr(o,Cn,h),h!==w.cache&&Of(o,[Cn],l,!0),Zu(),h=N.element,w.isDehydrated)if(w={element:h,isDehydrated:!1,cache:N.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=Gy(s,o,h,l);break e}else if(h!==T){T=d(Error(i(424)),o),qa(T),o=Gy(s,o,h,l);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Nt=Ns(s.firstChild),It=o,mt=!0,yo=null,Vi=!0,l=z_(o,null,h,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(qo(),h===T){o=Ko(s,o,l);break e}Wn(s,o,h,l)}o=o.child}return o;case 26:return Md(s,o),s===null?(l=o0(o.type,null,o.pendingProps,null))?o.memoizedState=l:mt||(l=o.type,s=o.pendingProps,h=Yd(Ce.current).createElement(l),h[cn]=o,h[mn]=s,Jn(h,l,s),pn(h),o.stateNode=h):o.memoizedState=o0(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Je(o),s===null&&mt&&(h=o.stateNode=n0(o.type,o.pendingProps,Ce.current),It=o,Vi=!0,T=Nt,jr(o.type)?(np=T,Nt=Ns(h.firstChild)):Nt=T),Wn(s,o,o.pendingProps.children,l),Md(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&mt&&((T=h=Nt)&&(h=nC(h,o.type,o.pendingProps,Vi),h!==null?(o.stateNode=h,It=o,Nt=Ns(h.firstChild),Vi=!1,T=!0):T=!1),T||vo(o)),Je(o),T=o.type,w=o.pendingProps,N=s!==null?s.memoizedProps:null,h=w.children,Qm(T,w)?h=null:N!==null&&Qm(T,N)&&(o.flags|=32),o.memoizedState!==null&&(T=Jf(s,o,_A,null,null,l),mc._currentValue=T),Md(s,o),Wn(s,o,h,l),o.child;case 6:return s===null&&mt&&((s=l=Nt)&&(l=iC(l,o.pendingProps,Vi),l!==null?(o.stateNode=l,It=o,Nt=null,s=!0):s=!1),s||vo(o)),null;case 13:return jy(s,o,l);case 4:return Pe(o,o.stateNode.containerInfo),h=o.pendingProps,s===null?o.child=Ya(o,null,h,l):Wn(s,o,h,l),o.child;case 11:return Vy(s,o,o.type,o.pendingProps,l);case 7:return Wn(s,o,o.pendingProps,l),o.child;case 8:return Wn(s,o,o.pendingProps.children,l),o.child;case 12:return Wn(s,o,o.pendingProps.children,l),o.child;case 10:return h=o.pendingProps,Pr(o,o.type,h.value),Wn(s,o,h.children,l),o.child;case 9:return T=o.type._context,h=o.pendingProps.children,Ga(o),T=Yn(T),h=h(T),o.flags|=1,Wn(s,o,h,l),o.child;case 14:return Oy(s,o,o.type,o.pendingProps,l);case 15:return Uy(s,o,o.type,o.pendingProps,l);case 19:return Zy(s,o,l);case 31:return AA(s,o,l);case 22:return zy(s,o,l,o.pendingProps);case 24:return Ga(o),h=Yn(Cn),s===null?(T=Bf(),T===null&&(T=Yt,w=Uf(),T.pooledCache=w,w.refCount++,w!==null&&(T.pooledCacheLanes|=l),T=w),o.memoizedState={parent:h,cache:T},qf(o),Pr(o,Cn,T)):((s.lanes&l)!==0&&(Hf(s,o),Yu(o,null,null,l),Zu()),T=s.memoizedState,w=o.memoizedState,T.parent!==h?(T={parent:h,cache:h},o.memoizedState=T,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=T),Pr(o,Cn,h)):(h=w.cache,Pr(o,Cn,h),h!==T.cache&&Of(o,[Cn],l,!0))),Wn(s,o,o.pendingProps.children,l),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function Zo(s){s.flags|=4}function Sm(s,o,l,h,T){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(T&335544128)===T)if(s.stateNode.complete)s.flags|=8192;else if(Ev())s.flags|=8192;else throw Za=gd,Ff}else s.flags&=-16777217}function Wy(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!c0(o))if(Ev())s.flags|=8192;else throw Za=gd,Ff}function kd(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?pl():536870912,s.lanes|=o,Gl|=o)}function ec(s,o){if(!mt)switch(s.tailMode){case"hidden":o=s.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function nn(s){var o=s.alternate!==null&&s.alternate.child===s.child,l=0,h=0;if(o)for(var T=s.child;T!==null;)l|=T.lanes|T.childLanes,h|=T.subtreeFlags&65011712,h|=T.flags&65011712,T.return=s,T=T.sibling;else for(T=s.child;T!==null;)l|=T.lanes|T.childLanes,h|=T.subtreeFlags,h|=T.flags,T.return=s,T=T.sibling;return s.subtreeFlags|=h,s.childLanes=l,o}function bA(s,o,l){var h=o.pendingProps;switch(gn(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(o),null;case 1:return nn(o),null;case 3:return l=o.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),Ho(Cn),ke(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(js(o)?Zo(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Fu())),nn(o),null;case 26:var T=o.type,w=o.memoizedState;return s===null?(Zo(o),w!==null?(nn(o),Wy(o,w)):(nn(o),Sm(o,T,null,h,l))):w?w!==s.memoizedState?(Zo(o),nn(o),Wy(o,w)):(nn(o),o.flags&=-16777217):(s=s.memoizedProps,s!==h&&Zo(o),nn(o),Sm(o,T,s,h,l)),null;case 27:if(wt(o),l=Ce.current,T=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==h&&Zo(o);else{if(!h){if(o.stateNode===null)throw Error(i(166));return nn(o),null}s=ce.current,js(o)?Bu(o):(s=n0(T,h,l),o.stateNode=s,Zo(o))}return nn(o),null;case 5:if(wt(o),T=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==h&&Zo(o);else{if(!h){if(o.stateNode===null)throw Error(i(166));return nn(o),null}if(w=ce.current,js(o))Bu(o);else{var N=Yd(Ce.current);switch(w){case 1:w=N.createElementNS("http://www.w3.org/2000/svg",T);break;case 2:w=N.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;default:switch(T){case"svg":w=N.createElementNS("http://www.w3.org/2000/svg",T);break;case"math":w=N.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;case"script":w=N.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof h.is=="string"?N.createElement("select",{is:h.is}):N.createElement("select"),h.multiple?w.multiple=!0:h.size&&(w.size=h.size);break;default:w=typeof h.is=="string"?N.createElement(T,{is:h.is}):N.createElement(T)}}w[cn]=o,w[mn]=h;e:for(N=o.child;N!==null;){if(N.tag===5||N.tag===6)w.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===o)break e;for(;N.sibling===null;){if(N.return===null||N.return===o)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}o.stateNode=w;e:switch(Jn(w,T,h),T){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Zo(o)}}return nn(o),Sm(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,l),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==h&&Zo(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(i(166));if(s=Ce.current,js(o)){if(s=o.stateNode,l=o.memoizedProps,h=null,T=It,T!==null)switch(T.tag){case 27:case 5:h=T.memoizedProps}s[cn]=o,s=!!(s.nodeValue===l||h!==null&&h.suppressHydrationWarning===!0||jv(s.nodeValue,l)),s||vo(o,!0)}else s=Yd(s).createTextNode(h),s[cn]=o,o.stateNode=s}return nn(o),null;case 31:if(l=o.memoizedState,s===null||s.memoizedState!==null){if(h=js(o),l!==null){if(s===null){if(!h)throw Error(i(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[cn]=o}else qo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;nn(o),s=!1}else l=Fu(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return o.flags&256?(os(o),o):(os(o),null);if((o.flags&128)!==0)throw Error(i(558))}return nn(o),null;case 13:if(h=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(T=js(o),h!==null&&h.dehydrated!==null){if(s===null){if(!T)throw Error(i(318));if(T=o.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(i(317));T[cn]=o}else qo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;nn(o),T=!1}else T=Fu(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=T),T=!0;if(!T)return o.flags&256?(os(o),o):(os(o),null)}return os(o),(o.flags&128)!==0?(o.lanes=l,o):(l=h!==null,s=s!==null&&s.memoizedState!==null,l&&(h=o.child,T=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(T=h.alternate.memoizedState.cachePool.pool),w=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(w=h.memoizedState.cachePool.pool),w!==T&&(h.flags|=2048)),l!==s&&l&&(o.child.flags|=8192),kd(o,o.updateQueue),nn(o),null);case 4:return ke(),s===null&&Km(o.stateNode.containerInfo),nn(o),null;case 10:return Ho(o.type),nn(o),null;case 19:if(he(En),h=o.memoizedState,h===null)return nn(o),null;if(T=(o.flags&128)!==0,w=h.rendering,w===null)if(T)ec(h,!1);else{if(yn!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(w=Td(s),w!==null){for(o.flags|=128,ec(h,!1),s=w.updateQueue,o.updateQueue=s,kd(o,s),o.subtreeFlags=0,s=l,l=o.child;l!==null;)Ou(l,s),l=l.sibling;return be(En,En.current&1|2),mt&&He(o,h.treeForkCount),o.child}s=s.sibling}h.tail!==null&&dt()>Ud&&(o.flags|=128,T=!0,ec(h,!1),o.lanes=4194304)}else{if(!T)if(s=Td(w),s!==null){if(o.flags|=128,T=!0,s=s.updateQueue,o.updateQueue=s,kd(o,s),ec(h,!0),h.tail===null&&h.tailMode==="hidden"&&!w.alternate&&!mt)return nn(o),null}else 2*dt()-h.renderingStartTime>Ud&&l!==536870912&&(o.flags|=128,T=!0,ec(h,!1),o.lanes=4194304);h.isBackwards?(w.sibling=o.child,o.child=w):(s=h.last,s!==null?s.sibling=w:o.child=w,h.last=w)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=dt(),s.sibling=null,l=En.current,be(En,T?l&1|2:l&1),mt&&He(o,h.treeForkCount),s):(nn(o),null);case 22:case 23:return os(o),Zf(),h=o.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(l&536870912)!==0&&(o.flags&128)===0&&(nn(o),o.subtreeFlags&6&&(o.flags|=8192)):nn(o),l=o.updateQueue,l!==null&&kd(o,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==l&&(o.flags|=2048),s!==null&&he(ja),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),o.memoizedState.cache!==l&&(o.flags|=2048),Ho(Cn),nn(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function IA(s,o){switch(gn(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Ho(Cn),ke(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return wt(o),null;case 31:if(o.memoizedState!==null){if(os(o),o.alternate===null)throw Error(i(340));qo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(os(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(i(340));qo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return he(En),null;case 4:return ke(),null;case 10:return Ho(o.type),null;case 22:case 23:return os(o),Zf(),s!==null&&he(ja),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return Ho(Cn),null;case 25:return null;default:return null}}function Jy(s,o){switch(gn(o),o.tag){case 3:Ho(Cn),ke();break;case 26:case 27:case 5:wt(o);break;case 4:ke();break;case 31:o.memoizedState!==null&&os(o);break;case 13:os(o);break;case 19:he(En);break;case 10:Ho(o.type);break;case 22:case 23:os(o),Zf(),s!==null&&he(ja);break;case 24:Ho(Cn)}}function tc(s,o){try{var l=o.updateQueue,h=l!==null?l.lastEffect:null;if(h!==null){var T=h.next;l=T;do{if((l.tag&s)===s){h=void 0;var w=l.create,N=l.inst;h=w(),N.destroy=h}l=l.next}while(l!==T)}}catch(D){Ft(o,o.return,D)}}function Ur(s,o,l){try{var h=o.updateQueue,T=h!==null?h.lastEffect:null;if(T!==null){var w=T.next;h=w;do{if((h.tag&s)===s){var N=h.inst,D=N.destroy;if(D!==void 0){N.destroy=void 0,T=o;var Z=l,oe=D;try{oe()}catch(fe){Ft(T,Z,fe)}}}h=h.next}while(h!==w)}}catch(fe){Ft(o,o.return,fe)}}function Qy(s){var o=s.updateQueue;if(o!==null){var l=s.stateNode;try{F_(o,l)}catch(h){Ft(s,s.return,h)}}}function $y(s,o,l){l.props=Ja(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(h){Ft(s,o,h)}}function nc(s,o){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof l=="function"?s.refCleanup=l(h):l.current=h}}catch(T){Ft(s,o,T)}}function Eo(s,o){var l=s.ref,h=s.refCleanup;if(l!==null)if(typeof h=="function")try{h()}catch(T){Ft(s,o,T)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(T){Ft(s,o,T)}else l.current=null}function Xy(s){var o=s.type,l=s.memoizedProps,h=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":l.autoFocus&&h.focus();break e;case"img":l.src?h.src=l.src:l.srcSet&&(h.srcset=l.srcSet)}}catch(T){Ft(s,s.return,T)}}function Am(s,o,l){try{var h=s.stateNode;JA(h,s.type,l,o),h[mn]=o}catch(T){Ft(s,s.return,T)}}function ev(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&jr(s.type)||s.tag===4}function Cm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||ev(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&jr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function bm(s,o,l){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,o):(o=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,o.appendChild(s),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=ti));else if(h!==4&&(h===27&&jr(s.type)&&(l=s.stateNode,o=null),s=s.child,s!==null))for(bm(s,o,l),s=s.sibling;s!==null;)bm(s,o,l),s=s.sibling}function Dd(s,o,l){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?l.insertBefore(s,o):l.appendChild(s);else if(h!==4&&(h===27&&jr(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Dd(s,o,l),s=s.sibling;s!==null;)Dd(s,o,l),s=s.sibling}function tv(s){var o=s.stateNode,l=s.memoizedProps;try{for(var h=s.type,T=o.attributes;T.length;)o.removeAttributeNode(T[0]);Jn(o,h,l),o[cn]=s,o[mn]=l}catch(w){Ft(s,s.return,w)}}var Yo=!1,Nn=!1,Im=!1,nv=typeof WeakSet=="function"?WeakSet:Set,jn=null;function NA(s,o){if(s=s.containerInfo,Wm=th,s=Da(s),fo(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var T=h.anchorOffset,w=h.focusNode;h=h.focusOffset;try{l.nodeType,w.nodeType}catch{l=null;break e}var N=0,D=-1,Z=-1,oe=0,fe=0,Te=s,le=null;t:for(;;){for(var de;Te!==l||T!==0&&Te.nodeType!==3||(D=N+T),Te!==w||h!==0&&Te.nodeType!==3||(Z=N+h),Te.nodeType===3&&(N+=Te.nodeValue.length),(de=Te.firstChild)!==null;)le=Te,Te=de;for(;;){if(Te===s)break t;if(le===l&&++oe===T&&(D=N),le===w&&++fe===h&&(Z=N),(de=Te.nextSibling)!==null)break;Te=le,le=Te.parentNode}Te=de}l=D===-1||Z===-1?null:{start:D,end:Z}}else l=null}l=l||{start:0,end:0}}else l=null;for(Jm={focusedElem:s,selectionRange:l},th=!1,jn=o;jn!==null;)if(o=jn,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,jn=s;else for(;jn!==null;){switch(o=jn,w=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)T=s[l],T.ref.impl=T.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&w!==null){s=void 0,l=o,T=w.memoizedProps,w=w.memoizedState,h=l.stateNode;try{var Be=Ja(l.type,T);s=h.getSnapshotBeforeUpdate(Be,w),h.__reactInternalSnapshotBeforeUpdate=s}catch(Ye){Ft(l,l.return,Ye)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,l=s.nodeType,l===9)Xm(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Xm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=o.sibling,s!==null){s.return=o.return,jn=s;break}jn=o.return}}function iv(s,o,l){var h=l.flags;switch(l.tag){case 0:case 11:case 15:Jo(s,l),h&4&&tc(5,l);break;case 1:if(Jo(s,l),h&4)if(s=l.stateNode,o===null)try{s.componentDidMount()}catch(N){Ft(l,l.return,N)}else{var T=Ja(l.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(T,o,s.__reactInternalSnapshotBeforeUpdate)}catch(N){Ft(l,l.return,N)}}h&64&&Qy(l),h&512&&nc(l,l.return);break;case 3:if(Jo(s,l),h&64&&(s=l.updateQueue,s!==null)){if(o=null,l.child!==null)switch(l.child.tag){case 27:case 5:o=l.child.stateNode;break;case 1:o=l.child.stateNode}try{F_(s,o)}catch(N){Ft(l,l.return,N)}}break;case 27:o===null&&h&4&&tv(l);case 26:case 5:Jo(s,l),o===null&&h&4&&Xy(l),h&512&&nc(l,l.return);break;case 12:Jo(s,l);break;case 31:Jo(s,l),h&4&&rv(s,l);break;case 13:Jo(s,l),h&4&&av(s,l),h&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=UA.bind(null,l),sC(s,l))));break;case 22:if(h=l.memoizedState!==null||Yo,!h){o=o!==null&&o.memoizedState!==null||Nn,T=Yo;var w=Nn;Yo=h,(Nn=o)&&!w?Qo(s,l,(l.subtreeFlags&8772)!==0):Jo(s,l),Yo=T,Nn=w}break;case 30:break;default:Jo(s,l)}}function sv(s){var o=s.alternate;o!==null&&(s.alternate=null,sv(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&mr(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var rn=null,Oi=!1;function Wo(s,o,l){for(l=l.child;l!==null;)ov(s,o,l),l=l.sibling}function ov(s,o,l){if(Ot&&typeof Ot.onCommitFiberUnmount=="function")try{Ot.onCommitFiberUnmount(Tn,l)}catch{}switch(l.tag){case 26:Nn||Eo(l,o),Wo(s,o,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Nn||Eo(l,o);var h=rn,T=Oi;jr(l.type)&&(rn=l.stateNode,Oi=!1),Wo(s,o,l),dc(l.stateNode),rn=h,Oi=T;break;case 5:Nn||Eo(l,o);case 6:if(h=rn,T=Oi,rn=null,Wo(s,o,l),rn=h,Oi=T,rn!==null)if(Oi)try{(rn.nodeType===9?rn.body:rn.nodeName==="HTML"?rn.ownerDocument.body:rn).removeChild(l.stateNode)}catch(w){Ft(l,o,w)}else try{rn.removeChild(l.stateNode)}catch(w){Ft(l,o,w)}break;case 18:rn!==null&&(Oi?(s=rn,Qv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),$l(s)):Qv(rn,l.stateNode));break;case 4:h=rn,T=Oi,rn=l.stateNode.containerInfo,Oi=!0,Wo(s,o,l),rn=h,Oi=T;break;case 0:case 11:case 14:case 15:Ur(2,l,o),Nn||Ur(4,l,o),Wo(s,o,l);break;case 1:Nn||(Eo(l,o),h=l.stateNode,typeof h.componentWillUnmount=="function"&&$y(l,o,h)),Wo(s,o,l);break;case 21:Wo(s,o,l);break;case 22:Nn=(h=Nn)||l.memoizedState!==null,Wo(s,o,l),Nn=h;break;default:Wo(s,o,l)}}function rv(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{$l(s)}catch(l){Ft(o,o.return,l)}}}function av(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{$l(s)}catch(l){Ft(o,o.return,l)}}function RA(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new nv),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new nv),o;default:throw Error(i(435,s.tag))}}function Ld(s,o){var l=RA(s);o.forEach(function(h){if(!l.has(h)){l.add(h);var T=zA.bind(null,s,h);h.then(T,T)}})}function Ui(s,o){var l=o.deletions;if(l!==null)for(var h=0;h<l.length;h++){var T=l[h],w=s,N=o,D=N;e:for(;D!==null;){switch(D.tag){case 27:if(jr(D.type)){rn=D.stateNode,Oi=!1;break e}break;case 5:rn=D.stateNode,Oi=!1;break e;case 3:case 4:rn=D.stateNode.containerInfo,Oi=!0;break e}D=D.return}if(rn===null)throw Error(i(160));ov(w,N,T),rn=null,Oi=!1,w=T.alternate,w!==null&&(w.return=null),T.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)lv(o,s),o=o.sibling}var Zs=null;function lv(s,o){var l=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Ui(o,s),zi(s),h&4&&(Ur(3,s,s.return),tc(3,s),Ur(5,s,s.return));break;case 1:Ui(o,s),zi(s),h&512&&(Nn||l===null||Eo(l,l.return)),h&64&&Yo&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?h:l.concat(h))));break;case 26:var T=Zs;if(Ui(o,s),zi(s),h&512&&(Nn||l===null||Eo(l,l.return)),h&4){var w=l!==null?l.memoizedState:null;if(h=s.memoizedState,l===null)if(h===null)if(s.stateNode===null){e:{h=s.type,l=s.memoizedProps,T=T.ownerDocument||T;t:switch(h){case"title":w=T.getElementsByTagName("title")[0],(!w||w[ps]||w[cn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=T.createElement(h),T.head.insertBefore(w,T.querySelector("head > title"))),Jn(w,h,l),w[cn]=s,pn(w),h=w;break e;case"link":var N=l0("link","href",T).get(h+(l.href||""));if(N){for(var D=0;D<N.length;D++)if(w=N[D],w.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&w.getAttribute("rel")===(l.rel==null?null:l.rel)&&w.getAttribute("title")===(l.title==null?null:l.title)&&w.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){N.splice(D,1);break t}}w=T.createElement(h),Jn(w,h,l),T.head.appendChild(w);break;case"meta":if(N=l0("meta","content",T).get(h+(l.content||""))){for(D=0;D<N.length;D++)if(w=N[D],w.getAttribute("content")===(l.content==null?null:""+l.content)&&w.getAttribute("name")===(l.name==null?null:l.name)&&w.getAttribute("property")===(l.property==null?null:l.property)&&w.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&w.getAttribute("charset")===(l.charSet==null?null:l.charSet)){N.splice(D,1);break t}}w=T.createElement(h),Jn(w,h,l),T.head.appendChild(w);break;default:throw Error(i(468,h))}w[cn]=s,pn(w),h=w}s.stateNode=h}else u0(T,s.type,s.stateNode);else s.stateNode=a0(T,h,s.memoizedProps);else w!==h?(w===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):w.count--,h===null?u0(T,s.type,s.stateNode):a0(T,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Am(s,s.memoizedProps,l.memoizedProps)}break;case 27:Ui(o,s),zi(s),h&512&&(Nn||l===null||Eo(l,l.return)),l!==null&&h&4&&Am(s,s.memoizedProps,l.memoizedProps);break;case 5:if(Ui(o,s),zi(s),h&512&&(Nn||l===null||Eo(l,l.return)),s.flags&32){T=s.stateNode;try{Sn(T,"")}catch(Be){Ft(s,s.return,Be)}}h&4&&s.stateNode!=null&&(T=s.memoizedProps,Am(s,T,l!==null?l.memoizedProps:T)),h&1024&&(Im=!0);break;case 6:if(Ui(o,s),zi(s),h&4){if(s.stateNode===null)throw Error(i(162));h=s.memoizedProps,l=s.stateNode;try{l.nodeValue=h}catch(Be){Ft(s,s.return,Be)}}break;case 3:if(Qd=null,T=Zs,Zs=Wd(o.containerInfo),Ui(o,s),Zs=T,zi(s),h&4&&l!==null&&l.memoizedState.isDehydrated)try{$l(o.containerInfo)}catch(Be){Ft(s,s.return,Be)}Im&&(Im=!1,uv(s));break;case 4:h=Zs,Zs=Wd(s.stateNode.containerInfo),Ui(o,s),zi(s),Zs=h;break;case 12:Ui(o,s),zi(s);break;case 31:Ui(o,s),zi(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Ld(s,h)));break;case 13:Ui(o,s),zi(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Od=dt()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Ld(s,h)));break;case 22:T=s.memoizedState!==null;var Z=l!==null&&l.memoizedState!==null,oe=Yo,fe=Nn;if(Yo=oe||T,Nn=fe||Z,Ui(o,s),Nn=fe,Yo=oe,zi(s),h&8192)e:for(o=s.stateNode,o._visibility=T?o._visibility&-2:o._visibility|1,T&&(l===null||Z||Yo||Nn||Qa(s)),l=null,o=s;;){if(o.tag===5||o.tag===26){if(l===null){Z=l=o;try{if(w=Z.stateNode,T)N=w.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{D=Z.stateNode;var Te=Z.memoizedProps.style,le=Te!=null&&Te.hasOwnProperty("display")?Te.display:null;D.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(Be){Ft(Z,Z.return,Be)}}}else if(o.tag===6){if(l===null){Z=o;try{Z.stateNode.nodeValue=T?"":Z.memoizedProps}catch(Be){Ft(Z,Z.return,Be)}}}else if(o.tag===18){if(l===null){Z=o;try{var de=Z.stateNode;T?$v(de,!0):$v(Z.stateNode,!1)}catch(Be){Ft(Z,Z.return,Be)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;l===o&&(l=null),o=o.return}l===o&&(l=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=s.updateQueue,h!==null&&(l=h.retryQueue,l!==null&&(h.retryQueue=null,Ld(s,l))));break;case 19:Ui(o,s),zi(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Ld(s,h)));break;case 30:break;case 21:break;default:Ui(o,s),zi(s)}}function zi(s){var o=s.flags;if(o&2){try{for(var l,h=s.return;h!==null;){if(ev(h)){l=h;break}h=h.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var T=l.stateNode,w=Cm(s);Dd(s,w,T);break;case 5:var N=l.stateNode;l.flags&32&&(Sn(N,""),l.flags&=-33);var D=Cm(s);Dd(s,D,N);break;case 3:case 4:var Z=l.stateNode.containerInfo,oe=Cm(s);bm(s,oe,Z);break;default:throw Error(i(161))}}catch(fe){Ft(s,s.return,fe)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function uv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;uv(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Jo(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)iv(s,o.alternate,o),o=o.sibling}function Qa(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Ur(4,o,o.return),Qa(o);break;case 1:Eo(o,o.return);var l=o.stateNode;typeof l.componentWillUnmount=="function"&&$y(o,o.return,l),Qa(o);break;case 27:dc(o.stateNode);case 26:case 5:Eo(o,o.return),Qa(o);break;case 22:o.memoizedState===null&&Qa(o);break;case 30:Qa(o);break;default:Qa(o)}s=s.sibling}}function Qo(s,o,l){for(l=l&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,T=s,w=o,N=w.flags;switch(w.tag){case 0:case 11:case 15:Qo(T,w,l),tc(4,w);break;case 1:if(Qo(T,w,l),h=w,T=h.stateNode,typeof T.componentDidMount=="function")try{T.componentDidMount()}catch(oe){Ft(h,h.return,oe)}if(h=w,T=h.updateQueue,T!==null){var D=h.stateNode;try{var Z=T.shared.hiddenCallbacks;if(Z!==null)for(T.shared.hiddenCallbacks=null,T=0;T<Z.length;T++)B_(Z[T],D)}catch(oe){Ft(h,h.return,oe)}}l&&N&64&&Qy(w),nc(w,w.return);break;case 27:tv(w);case 26:case 5:Qo(T,w,l),l&&h===null&&N&4&&Xy(w),nc(w,w.return);break;case 12:Qo(T,w,l);break;case 31:Qo(T,w,l),l&&N&4&&rv(T,w);break;case 13:Qo(T,w,l),l&&N&4&&av(T,w);break;case 22:w.memoizedState===null&&Qo(T,w,l),nc(w,w.return);break;case 30:break;default:Qo(T,w,l)}o=o.sibling}}function Nm(s,o){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&qu(l))}function Rm(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&qu(s))}function Ys(s,o,l,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)cv(s,o,l,h),o=o.sibling}function cv(s,o,l,h){var T=o.flags;switch(o.tag){case 0:case 11:case 15:Ys(s,o,l,h),T&2048&&tc(9,o);break;case 1:Ys(s,o,l,h);break;case 3:Ys(s,o,l,h),T&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&qu(s)));break;case 12:if(T&2048){Ys(s,o,l,h),s=o.stateNode;try{var w=o.memoizedProps,N=w.id,D=w.onPostCommit;typeof D=="function"&&D(N,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(Z){Ft(o,o.return,Z)}}else Ys(s,o,l,h);break;case 31:Ys(s,o,l,h);break;case 13:Ys(s,o,l,h);break;case 23:break;case 22:w=o.stateNode,N=o.alternate,o.memoizedState!==null?w._visibility&2?Ys(s,o,l,h):ic(s,o):w._visibility&2?Ys(s,o,l,h):(w._visibility|=2,Fl(s,o,l,h,(o.subtreeFlags&10256)!==0||!1)),T&2048&&Nm(N,o);break;case 24:Ys(s,o,l,h),T&2048&&Rm(o.alternate,o);break;default:Ys(s,o,l,h)}}function Fl(s,o,l,h,T){for(T=T&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var w=s,N=o,D=l,Z=h,oe=N.flags;switch(N.tag){case 0:case 11:case 15:Fl(w,N,D,Z,T),tc(8,N);break;case 23:break;case 22:var fe=N.stateNode;N.memoizedState!==null?fe._visibility&2?Fl(w,N,D,Z,T):ic(w,N):(fe._visibility|=2,Fl(w,N,D,Z,T)),T&&oe&2048&&Nm(N.alternate,N);break;case 24:Fl(w,N,D,Z,T),T&&oe&2048&&Rm(N.alternate,N);break;default:Fl(w,N,D,Z,T)}o=o.sibling}}function ic(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var l=s,h=o,T=h.flags;switch(h.tag){case 22:ic(l,h),T&2048&&Nm(h.alternate,h);break;case 24:ic(l,h),T&2048&&Rm(h.alternate,h);break;default:ic(l,h)}o=o.sibling}}var sc=8192;function ql(s,o,l){if(s.subtreeFlags&sc)for(s=s.child;s!==null;)dv(s,o,l),s=s.sibling}function dv(s,o,l){switch(s.tag){case 26:ql(s,o,l),s.flags&sc&&s.memoizedState!==null&&gC(l,Zs,s.memoizedState,s.memoizedProps);break;case 5:ql(s,o,l);break;case 3:case 4:var h=Zs;Zs=Wd(s.stateNode.containerInfo),ql(s,o,l),Zs=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=sc,sc=16777216,ql(s,o,l),sc=h):ql(s,o,l));break;default:ql(s,o,l)}}function hv(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function oc(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var l=0;l<o.length;l++){var h=o[l];jn=h,mv(h,s)}hv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)fv(s),s=s.sibling}function fv(s){switch(s.tag){case 0:case 11:case 15:oc(s),s.flags&2048&&Ur(9,s,s.return);break;case 3:oc(s);break;case 12:oc(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Vd(s)):oc(s);break;default:oc(s)}}function Vd(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var l=0;l<o.length;l++){var h=o[l];jn=h,mv(h,s)}hv(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Ur(8,o,o.return),Vd(o);break;case 22:l=o.stateNode,l._visibility&2&&(l._visibility&=-3,Vd(o));break;default:Vd(o)}s=s.sibling}}function mv(s,o){for(;jn!==null;){var l=jn;switch(l.tag){case 0:case 11:case 15:Ur(8,l,o);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var h=l.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:qu(l.memoizedState.cache)}if(h=l.child,h!==null)h.return=l,jn=h;else e:for(l=s;jn!==null;){h=jn;var T=h.sibling,w=h.return;if(sv(h),h===l){jn=null;break e}if(T!==null){T.return=w,jn=T;break e}jn=w}}}var MA={getCacheForType:function(s){var o=Yn(Cn),l=o.data.get(s);return l===void 0&&(l=s(),o.data.set(s,l)),l},cacheSignal:function(){return Yn(Cn).controller.signal}},PA=typeof WeakMap=="function"?WeakMap:Map,kt=0,Yt=null,pt=null,yt=0,Bt=0,rs=null,zr=!1,Hl=!1,Mm=!1,$o=0,yn=0,Br=0,$a=0,Pm=0,as=0,Gl=0,rc=null,Bi=null,km=!1,Od=0,pv=0,Ud=1/0,zd=null,Fr=null,Vn=0,qr=null,jl=null,Xo=0,Dm=0,Lm=null,gv=null,ac=0,Vm=null;function ls(){return(kt&2)!==0&&yt!==0?yt&-yt:te.T!==null?qm():Ta()}function _v(){if(as===0)if((yt&536870912)===0||mt){var s=so;so<<=1,(so&3932160)===0&&(so=262144),as=s}else as=536870912;return s=ss.current,s!==null&&(s.flags|=32),as}function Fi(s,o,l){(s===Yt&&(Bt===2||Bt===9)||s.cancelPendingCommit!==null)&&(Kl(s,0),Hr(s,yt,as,!1)),Ds(s,l),((kt&2)===0||s!==Yt)&&(s===Yt&&((kt&2)===0&&($a|=l),yn===4&&Hr(s,yt,as,!1)),xo(s))}function yv(s,o,l){if((kt&6)!==0)throw Error(i(327));var h=!l&&(o&127)===0&&(o&s.expiredLanes)===0||Ki(s,o),T=h?LA(s,o):Um(s,o,!0),w=h;do{if(T===0){Hl&&!h&&Hr(s,o,0,!1);break}else{if(l=s.current.alternate,w&&!kA(l)){T=Um(s,o,!1),w=!1;continue}if(T===2){if(w=o,s.errorRecoveryDisabledLanes&w)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){o=N;e:{var D=s;T=rc;var Z=D.current.memoizedState.isDehydrated;if(Z&&(Kl(D,N).flags|=256),N=Um(D,N,!1),N!==2){if(Mm&&!Z){D.errorRecoveryDisabledLanes|=w,$a|=w,T=4;break e}w=Bi,Bi=T,w!==null&&(Bi===null?Bi=w:Bi.push.apply(Bi,w))}T=N}if(w=!1,T!==2)continue}}if(T===1){Kl(s,0),Hr(s,o,0,!0);break}e:{switch(h=s,w=T,w){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:Hr(h,o,as,!zr);break e;case 2:Bi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(T=Od+300-dt(),10<T)){if(Hr(h,o,as,!zr),fs(h,0,!0)!==0)break e;Xo=o,h.timeoutHandle=Wv(vv.bind(null,h,l,Bi,zd,km,o,as,$a,Gl,zr,w,"Throttled",-0,0),T);break e}vv(h,l,Bi,zd,km,o,as,$a,Gl,zr,w,null,-0,0)}}break}while(!0);xo(s)}function vv(s,o,l,h,T,w,N,D,Z,oe,fe,Te,le,de){if(s.timeoutHandle=-1,Te=o.subtreeFlags,Te&8192||(Te&16785408)===16785408){Te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ti},dv(o,w,Te);var Be=(w&62914560)===w?Od-dt():(w&4194048)===w?pv-dt():0;if(Be=_C(Te,Be),Be!==null){Xo=w,s.cancelPendingCommit=Be(bv.bind(null,s,o,w,l,h,T,N,D,Z,fe,Te,null,le,de)),Hr(s,w,N,!oe);return}}bv(s,o,w,l,h,T,N,D,Z)}function kA(s){for(var o=s;;){var l=o.tag;if((l===0||l===11||l===15)&&o.flags&16384&&(l=o.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var h=0;h<l.length;h++){var T=l[h],w=T.getSnapshot;T=T.value;try{if(!Hn(w(),T))return!1}catch{return!1}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Hr(s,o,l,h){o&=~Pm,o&=~$a,s.suspendedLanes|=o,s.pingedLanes&=~o,h&&(s.warmLanes|=o),h=s.expirationTimes;for(var T=o;0<T;){var w=31-Qt(T),N=1<<w;h[w]=-1,T&=~N}l!==0&&Mo(s,l,o)}function Bd(){return(kt&6)===0?(lc(0),!1):!0}function Om(){if(pt!==null){if(Bt===0)var s=pt.return;else s=pt,Ks=To=null,Xf(s),Vl=null,Gu=0,s=pt;for(;s!==null;)Jy(s.alternate,s),s=s.return;pt=null}}function Kl(s,o){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,XA(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),Xo=0,Om(),Yt=s,pt=l=bs(s.current,null),yt=o,Bt=0,rs=null,zr=!1,Hl=Ki(s,o),Mm=!1,Gl=as=Pm=$a=Br=yn=0,Bi=rc=null,km=!1,(o&8)!==0&&(o|=o&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=o;0<h;){var T=31-Qt(h),w=1<<T;o|=s[T],h&=~w}return $o=o,za(),l}function Tv(s,o){rt=null,te.H=$u,o===Ll||o===pd?(o=V_(),Bt=3):o===Ff?(o=V_(),Bt=4):Bt=o===pm?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,rs=o,pt===null&&(yn=1,Nd(s,d(o,s.current)))}function Ev(){var s=ss.current;return s===null?!0:(yt&4194048)===yt?Is===null:(yt&62914560)===yt||(yt&536870912)!==0?s===Is:!1}function xv(){var s=te.H;return te.H=$u,s===null?$u:s}function wv(){var s=te.A;return te.A=MA,s}function Fd(){yn=4,zr||(yt&4194048)!==yt&&ss.current!==null||(Hl=!0),(Br&134217727)===0&&($a&134217727)===0||Yt===null||Hr(Yt,yt,as,!1)}function Um(s,o,l){var h=kt;kt|=2;var T=xv(),w=wv();(Yt!==s||yt!==o)&&(zd=null,Kl(s,o)),o=!1;var N=yn;e:do try{if(Bt!==0&&pt!==null){var D=pt,Z=rs;switch(Bt){case 8:Om(),N=6;break e;case 3:case 2:case 9:case 6:ss.current===null&&(o=!0);var oe=Bt;if(Bt=0,rs=null,Zl(s,D,Z,oe),l&&Hl){N=0;break e}break;default:oe=Bt,Bt=0,rs=null,Zl(s,D,Z,oe)}}DA(),N=yn;break}catch(fe){Tv(s,fe)}while(!0);return o&&s.shellSuspendCounter++,Ks=To=null,kt=h,te.H=T,te.A=w,pt===null&&(Yt=null,yt=0,za()),N}function DA(){for(;pt!==null;)Sv(pt)}function LA(s,o){var l=kt;kt|=2;var h=xv(),T=wv();Yt!==s||yt!==o?(zd=null,Ud=dt()+500,Kl(s,o)):Hl=Ki(s,o);e:do try{if(Bt!==0&&pt!==null){o=pt;var w=rs;t:switch(Bt){case 1:Bt=0,rs=null,Zl(s,o,w,1);break;case 2:case 9:if(D_(w)){Bt=0,rs=null,Av(o);break}o=function(){Bt!==2&&Bt!==9||Yt!==s||(Bt=7),xo(s)},w.then(o,o);break e;case 3:Bt=7;break e;case 4:Bt=5;break e;case 7:D_(w)?(Bt=0,rs=null,Av(o)):(Bt=0,rs=null,Zl(s,o,w,7));break;case 5:var N=null;switch(pt.tag){case 26:N=pt.memoizedState;case 5:case 27:var D=pt;if(N?c0(N):D.stateNode.complete){Bt=0,rs=null;var Z=D.sibling;if(Z!==null)pt=Z;else{var oe=D.return;oe!==null?(pt=oe,qd(oe)):pt=null}break t}}Bt=0,rs=null,Zl(s,o,w,5);break;case 6:Bt=0,rs=null,Zl(s,o,w,6);break;case 8:Om(),yn=6;break e;default:throw Error(i(462))}}VA();break}catch(fe){Tv(s,fe)}while(!0);return Ks=To=null,te.H=h,te.A=T,kt=l,pt!==null?0:(Yt=null,yt=0,za(),yn)}function VA(){for(;pt!==null&&!Qe();)Sv(pt)}function Sv(s){var o=Yy(s.alternate,s,$o);s.memoizedProps=s.pendingProps,o===null?qd(s):pt=o}function Av(s){var o=s,l=o.alternate;switch(o.tag){case 15:case 0:o=qy(l,o,o.pendingProps,o.type,void 0,yt);break;case 11:o=qy(l,o,o.pendingProps,o.type.render,o.ref,yt);break;case 5:Xf(o);default:Jy(l,o),o=pt=Ou(o,$o),o=Yy(l,o,$o)}s.memoizedProps=s.pendingProps,o===null?qd(s):pt=o}function Zl(s,o,l,h){Ks=To=null,Xf(o),Vl=null,Gu=0;var T=o.return;try{if(SA(s,T,o,l,yt)){yn=1,Nd(s,d(l,s.current)),pt=null;return}}catch(w){if(T!==null)throw pt=T,w;yn=1,Nd(s,d(l,s.current)),pt=null;return}o.flags&32768?(mt||h===1?s=!0:Hl||(yt&536870912)!==0?s=!1:(zr=s=!0,(h===2||h===9||h===3||h===6)&&(h=ss.current,h!==null&&h.tag===13&&(h.flags|=16384))),Cv(o,s)):qd(o)}function qd(s){var o=s;do{if((o.flags&32768)!==0){Cv(o,zr);return}s=o.return;var l=bA(o.alternate,o,$o);if(l!==null){pt=l;return}if(o=o.sibling,o!==null){pt=o;return}pt=o=s}while(o!==null);yn===0&&(yn=5)}function Cv(s,o){do{var l=IA(s.alternate,s);if(l!==null){l.flags&=32767,pt=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!o&&(s=s.sibling,s!==null)){pt=s;return}pt=s=l}while(s!==null);yn=6,pt=null}function bv(s,o,l,h,T,w,N,D,Z){s.cancelPendingCommit=null;do Hd();while(Vn!==0);if((kt&6)!==0)throw Error(i(327));if(o!==null){if(o===s.current)throw Error(i(177));if(w=o.lanes|o.childLanes,w|=Il,Lu(s,l,w,N,D,Z),s===Yt&&(pt=Yt=null,yt=0),jl=o,qr=s,Xo=l,Dm=w,Lm=T,gv=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,BA(Ie,function(){return Pv(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=te.T,te.T=null,T=Se.p,Se.p=2,N=kt,kt|=4;try{NA(s,o,l)}finally{kt=N,Se.p=T,te.T=h}}Vn=1,Iv(),Nv(),Rv()}}function Iv(){if(Vn===1){Vn=0;var s=qr,o=jl,l=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||l){l=te.T,te.T=null;var h=Se.p;Se.p=2;var T=kt;kt|=4;try{lv(o,s);var w=Jm,N=Da(s.containerInfo),D=w.focusedElem,Z=w.selectionRange;if(N!==D&&D&&D.ownerDocument&&Sl(D.ownerDocument.documentElement,D)){if(Z!==null&&fo(D)){var oe=Z.start,fe=Z.end;if(fe===void 0&&(fe=oe),"selectionStart"in D)D.selectionStart=oe,D.selectionEnd=Math.min(fe,D.value.length);else{var Te=D.ownerDocument||document,le=Te&&Te.defaultView||window;if(le.getSelection){var de=le.getSelection(),Be=D.textContent.length,Ye=Math.min(Z.start,Be),Gt=Z.end===void 0?Ye:Math.min(Z.end,Be);!de.extend&&Ye>Gt&&(N=Gt,Gt=Ye,Ye=N);var $=ka(D,Ye),Q=ka(D,Gt);if($&&Q&&(de.rangeCount!==1||de.anchorNode!==$.node||de.anchorOffset!==$.offset||de.focusNode!==Q.node||de.focusOffset!==Q.offset)){var se=Te.createRange();se.setStart($.node,$.offset),de.removeAllRanges(),Ye>Gt?(de.addRange(se),de.extend(Q.node,Q.offset)):(se.setEnd(Q.node,Q.offset),de.addRange(se))}}}}for(Te=[],de=D;de=de.parentNode;)de.nodeType===1&&Te.push({element:de,left:de.scrollLeft,top:de.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<Te.length;D++){var ge=Te[D];ge.element.scrollLeft=ge.left,ge.element.scrollTop=ge.top}}th=!!Wm,Jm=Wm=null}finally{kt=T,Se.p=h,te.T=l}}s.current=o,Vn=2}}function Nv(){if(Vn===2){Vn=0;var s=qr,o=jl,l=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||l){l=te.T,te.T=null;var h=Se.p;Se.p=2;var T=kt;kt|=4;try{iv(s,o.alternate,o)}finally{kt=T,Se.p=h,te.T=l}}Vn=3}}function Rv(){if(Vn===4||Vn===3){Vn=0,Dt();var s=qr,o=jl,l=Xo,h=gv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Vn=5:(Vn=0,jl=qr=null,Mv(s,s.pendingLanes));var T=s.pendingLanes;if(T===0&&(Fr=null),ze(l),o=o.stateNode,Ot&&typeof Ot.onCommitFiberRoot=="function")try{Ot.onCommitFiberRoot(Tn,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=te.T,T=Se.p,Se.p=2,te.T=null;try{for(var w=s.onRecoverableError,N=0;N<h.length;N++){var D=h[N];w(D.value,{componentStack:D.stack})}}finally{te.T=o,Se.p=T}}(Xo&3)!==0&&Hd(),xo(s),T=s.pendingLanes,(l&261930)!==0&&(T&42)!==0?s===Vm?ac++:(ac=0,Vm=s):ac=0,lc(0)}}function Mv(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,qu(o)))}function Hd(){return Iv(),Nv(),Rv(),Pv()}function Pv(){if(Vn!==5)return!1;var s=qr,o=Dm;Dm=0;var l=ze(Xo),h=te.T,T=Se.p;try{Se.p=32>l?32:l,te.T=null,l=Lm,Lm=null;var w=qr,N=Xo;if(Vn=0,jl=qr=null,Xo=0,(kt&6)!==0)throw Error(i(331));var D=kt;if(kt|=4,fv(w.current),cv(w,w.current,N,l),kt=D,lc(0,!1),Ot&&typeof Ot.onPostCommitFiberRoot=="function")try{Ot.onPostCommitFiberRoot(Tn,w)}catch{}return!0}finally{Se.p=T,te.T=h,Mv(s,o)}}function kv(s,o,l){o=d(l,o),o=mm(s.stateNode,o,2),s=Lr(s,o,2),s!==null&&(Ds(s,2),xo(s))}function Ft(s,o,l){if(s.tag===3)kv(s,s,l);else for(;o!==null;){if(o.tag===3){kv(o,s,l);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Fr===null||!Fr.has(h))){s=d(l,s),l=Dy(2),h=Lr(o,l,2),h!==null&&(Ly(l,h,o,s),Ds(h,2),xo(h));break}}o=o.return}}function zm(s,o,l){var h=s.pingCache;if(h===null){h=s.pingCache=new PA;var T=new Set;h.set(o,T)}else T=h.get(o),T===void 0&&(T=new Set,h.set(o,T));T.has(l)||(Mm=!0,T.add(l),s=OA.bind(null,s,o,l),o.then(s,s))}function OA(s,o,l){var h=s.pingCache;h!==null&&h.delete(o),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Yt===s&&(yt&l)===l&&(yn===4||yn===3&&(yt&62914560)===yt&&300>dt()-Od?(kt&2)===0&&Kl(s,0):Pm|=l,Gl===yt&&(Gl=0)),xo(s)}function Dv(s,o){o===0&&(o=pl()),s=Cs(s,o),s!==null&&(Ds(s,o),xo(s))}function UA(s){var o=s.memoizedState,l=0;o!==null&&(l=o.retryLane),Dv(s,l)}function zA(s,o){var l=0;switch(s.tag){case 31:case 13:var h=s.stateNode,T=s.memoizedState;T!==null&&(l=T.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(o),Dv(s,l)}function BA(s,o){return ye(s,o)}var Gd=null,Yl=null,Bm=!1,jd=!1,Fm=!1,Gr=0;function xo(s){s!==Yl&&s.next===null&&(Yl===null?Gd=Yl=s:Yl=Yl.next=s),jd=!0,Bm||(Bm=!0,qA())}function lc(s,o){if(!Fm&&jd){Fm=!0;do for(var l=!1,h=Gd;h!==null;){if(s!==0){var T=h.pendingLanes;if(T===0)var w=0;else{var N=h.suspendedLanes,D=h.pingedLanes;w=(1<<31-Qt(42|s)+1)-1,w&=T&~(N&~D),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(l=!0,Uv(h,w))}else w=yt,w=fs(h,h===Yt?w:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(w&3)===0||Ki(h,w)||(l=!0,Uv(h,w));h=h.next}while(l);Fm=!1}}function FA(){Lv()}function Lv(){jd=Bm=!1;var s=0;Gr!==0&&$A()&&(s=Gr);for(var o=dt(),l=null,h=Gd;h!==null;){var T=h.next,w=Vv(h,o);w===0?(h.next=null,l===null?Gd=T:l.next=T,T===null&&(Yl=l)):(l=h,(s!==0||(w&3)!==0)&&(jd=!0)),h=T}Vn!==0&&Vn!==5||lc(s),Gr!==0&&(Gr=0)}function Vv(s,o){for(var l=s.suspendedLanes,h=s.pingedLanes,T=s.expirationTimes,w=s.pendingLanes&-62914561;0<w;){var N=31-Qt(w),D=1<<N,Z=T[N];Z===-1?((D&l)===0||(D&h)!==0)&&(T[N]=Du(D,o)):Z<=o&&(s.expiredLanes|=D),w&=~D}if(o=Yt,l=yt,l=fs(s,s===o?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,l===0||s===o&&(Bt===2||Bt===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&qe(h),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||Ki(s,l)){if(o=l&-l,o===s.callbackPriority)return o;switch(h!==null&&qe(h),ze(l)){case 2:case 8:l=_i;break;case 32:l=Ie;break;case 268435456:l=Vt;break;default:l=Ie}return h=Ov.bind(null,s),l=ye(l,h),s.callbackPriority=o,s.callbackNode=l,o}return h!==null&&h!==null&&qe(h),s.callbackPriority=2,s.callbackNode=null,2}function Ov(s,o){if(Vn!==0&&Vn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(Hd()&&s.callbackNode!==l)return null;var h=yt;return h=fs(s,s===Yt?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(yv(s,h,o),Vv(s,dt()),s.callbackNode!=null&&s.callbackNode===l?Ov.bind(null,s):null)}function Uv(s,o){if(Hd())return null;yv(s,o,!0)}function qA(){eC(function(){(kt&6)!==0?ye(gi,FA):Lv()})}function qm(){if(Gr===0){var s=kl;s===0&&(s=ji,ji<<=1,(ji&261888)===0&&(ji=256)),Gr=s}return Gr}function zv(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ao(""+s)}function Bv(s,o){var l=o.ownerDocument.createElement("input");return l.name=o.name,l.value=o.value,s.id&&l.setAttribute("form",s.id),o.parentNode.insertBefore(l,o),s=new FormData(s),l.parentNode.removeChild(l),s}function HA(s,o,l,h,T){if(o==="submit"&&l&&l.stateNode===T){var w=zv((T[mn]||null).action),N=h.submitter;N&&(o=(o=N[mn]||null)?zv(o.formAction):N.getAttribute("formAction"),o!==null&&(w=o,N=null));var D=new xs("action","action",null,h,T);s.push({event:D,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Gr!==0){var Z=N?Bv(T,N):new FormData(T);lm(l,{pending:!0,data:Z,method:T.method,action:w},null,Z)}}else typeof w=="function"&&(D.preventDefault(),Z=N?Bv(T,N):new FormData(T),lm(l,{pending:!0,data:Z,method:T.method,action:w},w,Z))},currentTarget:T}]})}}for(var Hm=0;Hm<go.length;Hm++){var Gm=go[Hm],GA=Gm.toLowerCase(),jA=Gm[0].toUpperCase()+Gm.slice(1);Di(GA,"on"+jA)}Di(Va,"onAnimationEnd"),Di(ud,"onAnimationIteration"),Di(Oa,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(kf,"onTransitionRun"),Di(cd,"onTransitionStart"),Di(Df,"onTransitionCancel"),Di(Rr,"onTransitionEnd"),Ii("onMouseEnter",["mouseout","mouseover"]),Ii("onMouseLeave",["mouseout","mouseover"]),Ii("onPointerEnter",["pointerout","pointerover"]),Ii("onPointerLeave",["pointerout","pointerover"]),_s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_s("onBeforeInput",["compositionend","keypress","textInput","paste"]),_s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(uc));function Fv(s,o){o=(o&4)!==0;for(var l=0;l<s.length;l++){var h=s[l],T=h.event;h=h.listeners;e:{var w=void 0;if(o)for(var N=h.length-1;0<=N;N--){var D=h[N],Z=D.instance,oe=D.currentTarget;if(D=D.listener,Z!==w&&T.isPropagationStopped())break e;w=D,T.currentTarget=oe;try{w(T)}catch(fe){Ua(fe)}T.currentTarget=null,w=Z}else for(N=0;N<h.length;N++){if(D=h[N],Z=D.instance,oe=D.currentTarget,D=D.listener,Z!==w&&T.isPropagationStopped())break e;w=D,T.currentTarget=oe;try{w(T)}catch(fe){Ua(fe)}T.currentTarget=null,w=Z}}}}function gt(s,o){var l=o[Yi];l===void 0&&(l=o[Yi]=new Set);var h=s+"__bubble";l.has(h)||(qv(o,s,2,!1),l.add(h))}function jm(s,o,l){var h=0;o&&(h|=4),qv(l,s,h,o)}var Kd="_reactListening"+Math.random().toString(36).slice(2);function Km(s){if(!s[Kd]){s[Kd]=!0,Ea.forEach(function(l){l!=="selectionchange"&&(KA.has(l)||jm(l,!1,s),jm(l,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Kd]||(o[Kd]=!0,jm("selectionchange",!1,o))}}function qv(s,o,l,h){switch(_0(o)){case 2:var T=TC;break;case 8:T=EC;break;default:T=ap}l=T.bind(null,o,l,s),T=void 0,!Us||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(T=!0),h?T!==void 0?s.addEventListener(o,l,{capture:!0,passive:T}):s.addEventListener(o,l,!0):T!==void 0?s.addEventListener(o,l,{passive:T}):s.addEventListener(o,l,!1)}function Zm(s,o,l,h,T){var w=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var N=h.tag;if(N===3||N===4){var D=h.stateNode.containerInfo;if(D===T)break;if(N===4)for(N=h.return;N!==null;){var Z=N.tag;if((Z===3||Z===4)&&N.stateNode.containerInfo===T)return;N=N.return}for(;D!==null;){if(N=Wi(D),N===null)return;if(Z=N.tag,Z===5||Z===6||Z===26||Z===27){h=w=N;continue e}D=D.parentNode}}h=h.return}Os(function(){var oe=w,fe=ni(l),Te=[];e:{var le=dd.get(s);if(le!==void 0){var de=xs,Be=s;switch(s){case"keypress":if(uo(l)===0)break e;case"keydown":case"keyup":de=Ia;break;case"focusin":Be="focus",de=Oo;break;case"focusout":Be="blur",de=Oo;break;case"beforeblur":case"afterblur":de=Oo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=wa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=vl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=b;break;case Va:case ud:case Oa:de=Tr;break;case Rr:de=O;break;case"scroll":case"scrollend":de=ct;break;case"wheel":de=ue;break;case"copy":case"cut":case"paste":de=Ti;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=qs;break;case"toggle":case"beforetoggle":de=et}var Ye=(o&4)!==0,Gt=!Ye&&(s==="scroll"||s==="scrollend"),$=Ye?le!==null?le+"Capture":null:le;Ye=[];for(var Q=oe,se;Q!==null;){var ge=Q;if(se=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||se===null||$===null||(ge=vi(Q,$),ge!=null&&Ye.push(cc(Q,ge,se))),Gt)break;Q=Q.return}0<Ye.length&&(le=new de(le,Be,null,l,fe),Te.push({event:le,listeners:Ye}))}}if((o&7)===0){e:{if(le=s==="mouseover"||s==="pointerover",de=s==="mouseout"||s==="pointerout",le&&l!==vr&&(Be=l.relatedTarget||l.fromElement)&&(Wi(Be)||Be[Zi]))break e;if((de||le)&&(le=fe.window===fe?fe:(le=fe.ownerDocument)?le.defaultView||le.parentWindow:window,de?(Be=l.relatedTarget||l.toElement,de=oe,Be=Be?Wi(Be):null,Be!==null&&(Gt=u(Be),Ye=Be.tag,Be!==Gt||Ye!==5&&Ye!==27&&Ye!==6)&&(Be=null)):(de=null,Be=oe),de!==Be)){if(Ye=wa,ge="onMouseLeave",$="onMouseEnter",Q="mouse",(s==="pointerout"||s==="pointerover")&&(Ye=qs,ge="onPointerLeave",$="onPointerEnter",Q="pointer"),Gt=de==null?le:zn(de),se=Be==null?le:zn(Be),le=new Ye(ge,Q+"leave",de,l,fe),le.target=Gt,le.relatedTarget=se,ge=null,Wi(fe)===oe&&(Ye=new Ye($,Q+"enter",Be,l,fe),Ye.target=se,Ye.relatedTarget=Gt,ge=Ye),Gt=ge,de&&Be)t:{for(Ye=ZA,$=de,Q=Be,se=0,ge=$;ge;ge=Ye(ge))se++;ge=0;for(var Ge=Q;Ge;Ge=Ye(Ge))ge++;for(;0<se-ge;)$=Ye($),se--;for(;0<ge-se;)Q=Ye(Q),ge--;for(;se--;){if($===Q||Q!==null&&$===Q.alternate){Ye=$;break t}$=Ye($),Q=Ye(Q)}Ye=null}else Ye=null;de!==null&&Hv(Te,le,de,Ye,!1),Be!==null&&Gt!==null&&Hv(Te,Gt,Be,Ye,!0)}}e:{if(le=oe?zn(oe):window,de=le.nodeName&&le.nodeName.toLowerCase(),de==="select"||de==="input"&&le.type==="file")var Rt=Pa;else if(ws(le))if(sd)Rt=Pf;else{Rt=Mf;var Fe=Hs}else de=le.nodeName,!de||de.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?oe&&ro(oe.elementType)&&(Rt=Pa):Rt=Cr;if(Rt&&(Rt=Rt(s,oe))){id(Te,Rt,l,fe);break e}Fe&&Fe(s,le,oe),s==="focusout"&&oe&&le.type==="number"&&oe.memoizedProps.value!=null&&Ji(le,"number",le.value)}switch(Fe=oe?zn(oe):window,s){case"focusin":(ws(Fe)||Fe.contentEditable==="true")&&(mo=Fe,Cl=oe,La=null);break;case"focusout":La=Cl=mo=null;break;case"mousedown":Ir=!0;break;case"contextmenu":case"mouseup":case"dragend":Ir=!1,ad(Te,l,fe);break;case"selectionchange":if(Al)break;case"keydown":case"keyup":ad(Te,l,fe)}var lt;if(At)e:{switch(s){case"compositionstart":var vt="onCompositionStart";break e;case"compositionend":vt="onCompositionEnd";break e;case"compositionupdate":vt="onCompositionUpdate";break e}vt=void 0}else wr?Uo(s,l)&&(vt="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(vt="onCompositionStart");vt&&(ki&&l.locale!=="ko"&&(wr||vt!=="onCompositionStart"?vt==="onCompositionEnd"&&wr&&(lt=Qi()):(Mi=fe,zs="value"in Mi?Mi.value:Mi.textContent,wr=!0)),Fe=Zd(oe,vt),0<Fe.length&&(vt=new es(vt,s,null,l,fe),Te.push({event:vt,listeners:Fe}),lt?vt.data=lt:(lt=zo(l),lt!==null&&(vt.data=lt)))),(lt=Pi?is(s,l):Sr(s,l))&&(vt=Zd(oe,"onBeforeInput"),0<vt.length&&(Fe=new es("onBeforeInput","beforeinput",null,l,fe),Te.push({event:Fe,listeners:vt}),Fe.data=lt)),HA(Te,s,oe,l,fe)}Fv(Te,o)})}function cc(s,o,l){return{instance:s,listener:o,currentTarget:l}}function Zd(s,o){for(var l=o+"Capture",h=[];s!==null;){var T=s,w=T.stateNode;if(T=T.tag,T!==5&&T!==26&&T!==27||w===null||(T=vi(s,l),T!=null&&h.unshift(cc(s,T,w)),T=vi(s,o),T!=null&&h.push(cc(s,T,w))),s.tag===3)return h;s=s.return}return[]}function ZA(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Hv(s,o,l,h,T){for(var w=o._reactName,N=[];l!==null&&l!==h;){var D=l,Z=D.alternate,oe=D.stateNode;if(D=D.tag,Z!==null&&Z===h)break;D!==5&&D!==26&&D!==27||oe===null||(Z=oe,T?(oe=vi(l,w),oe!=null&&N.unshift(cc(l,oe,Z))):T||(oe=vi(l,w),oe!=null&&N.push(cc(l,oe,Z)))),l=l.return}N.length!==0&&s.push({event:o,listeners:N})}var YA=/\r\n?/g,WA=/\u0000|\uFFFD/g;function Gv(s){return(typeof s=="string"?s:""+s).replace(YA,`
`).replace(WA,"")}function jv(s,o){return o=Gv(o),Gv(s)===o}function Ht(s,o,l,h,T,w){switch(l){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||Sn(s,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&Sn(s,""+h);break;case"className":ft(s,"class",h);break;case"tabIndex":ft(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ft(s,l,h);break;case"style":Do(s,h,w);break;case"data":if(o!=="object"){ft(s,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||l!=="href")){s.removeAttribute(l);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(l);break}h=ao(""+h),s.setAttribute(l,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(l==="formAction"?(o!=="input"&&Ht(s,o,"name",T.name,T,null),Ht(s,o,"formEncType",T.formEncType,T,null),Ht(s,o,"formMethod",T.formMethod,T,null),Ht(s,o,"formTarget",T.formTarget,T,null)):(Ht(s,o,"encType",T.encType,T,null),Ht(s,o,"method",T.method,T,null),Ht(s,o,"target",T.target,T,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(l);break}h=ao(""+h),s.setAttribute(l,h);break;case"onClick":h!=null&&(s.onclick=ti);break;case"onScroll":h!=null&&gt("scroll",s);break;case"onScrollEnd":h!=null&&gt("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(l=h.__html,l!=null){if(T.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}l=ao(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(l,""+h):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":h===!0?s.setAttribute(l,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(l,h):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(l,h):s.removeAttribute(l);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(l):s.setAttribute(l,h);break;case"popover":gt("beforetoggle",s),gt("toggle",s),ht(s,"popover",h);break;case"xlinkActuate":Xt(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Xt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Xt(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Xt(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Xt(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Xt(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Xt(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Xt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Xt(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":ht(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Lo.get(l)||l,ht(s,l,h))}}function Ym(s,o,l,h,T,w){switch(l){case"style":Do(s,h,w);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(l=h.__html,l!=null){if(T.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof h=="string"?Sn(s,h):(typeof h=="number"||typeof h=="bigint")&&Sn(s,""+h);break;case"onScroll":h!=null&&gt("scroll",s);break;case"onScrollEnd":h!=null&&gt("scrollend",s);break;case"onClick":h!=null&&(s.onclick=ti);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xa.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(T=l.endsWith("Capture"),o=l.slice(2,T?l.length-7:void 0),w=s[mn]||null,w=w!=null?w[l]:null,typeof w=="function"&&s.removeEventListener(o,w,T),typeof h=="function")){typeof w!="function"&&w!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(o,h,T);break e}l in s?s[l]=h:h===!0?s.setAttribute(l,""):ht(s,l,h)}}}function Jn(s,o,l){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":gt("error",s),gt("load",s);var h=!1,T=!1,w;for(w in l)if(l.hasOwnProperty(w)){var N=l[w];if(N!=null)switch(w){case"src":h=!0;break;case"srcSet":T=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Ht(s,o,w,N,l,null)}}T&&Ht(s,o,"srcSet",l.srcSet,l,null),h&&Ht(s,o,"src",l.src,l,null);return;case"input":gt("invalid",s);var D=w=N=T=null,Z=null,oe=null;for(h in l)if(l.hasOwnProperty(h)){var fe=l[h];if(fe!=null)switch(h){case"name":T=fe;break;case"type":N=fe;break;case"checked":Z=fe;break;case"defaultChecked":oe=fe;break;case"value":w=fe;break;case"defaultValue":D=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,o));break;default:Ht(s,o,h,fe,l,null)}}ko(s,w,D,Z,oe,N,T,!1);return;case"select":gt("invalid",s),h=N=w=null;for(T in l)if(l.hasOwnProperty(T)&&(D=l[T],D!=null))switch(T){case"value":w=D;break;case"defaultValue":N=D;break;case"multiple":h=D;default:Ht(s,o,T,D,l,null)}o=w,l=N,s.multiple=!!h,o!=null?zt(s,!!h,o,!1):l!=null&&zt(s,!!h,l,!0);return;case"textarea":gt("invalid",s),w=T=h=null;for(N in l)if(l.hasOwnProperty(N)&&(D=l[N],D!=null))switch(N){case"value":h=D;break;case"defaultValue":T=D;break;case"children":w=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(i(91));break;default:Ht(s,o,N,D,l,null)}Ri(s,h,T,w);return;case"option":for(Z in l)if(l.hasOwnProperty(Z)&&(h=l[Z],h!=null))switch(Z){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Ht(s,o,Z,h,l,null)}return;case"dialog":gt("beforetoggle",s),gt("toggle",s),gt("cancel",s),gt("close",s);break;case"iframe":case"object":gt("load",s);break;case"video":case"audio":for(h=0;h<uc.length;h++)gt(uc[h],s);break;case"image":gt("error",s),gt("load",s);break;case"details":gt("toggle",s);break;case"embed":case"source":case"link":gt("error",s),gt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in l)if(l.hasOwnProperty(oe)&&(h=l[oe],h!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Ht(s,o,oe,h,l,null)}return;default:if(ro(o)){for(fe in l)l.hasOwnProperty(fe)&&(h=l[fe],h!==void 0&&Ym(s,o,fe,h,l,void 0));return}}for(D in l)l.hasOwnProperty(D)&&(h=l[D],h!=null&&Ht(s,o,D,h,l,null))}function JA(s,o,l,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var T=null,w=null,N=null,D=null,Z=null,oe=null,fe=null;for(de in l){var Te=l[de];if(l.hasOwnProperty(de)&&Te!=null)switch(de){case"checked":break;case"value":break;case"defaultValue":Z=Te;default:h.hasOwnProperty(de)||Ht(s,o,de,null,h,Te)}}for(var le in h){var de=h[le];if(Te=l[le],h.hasOwnProperty(le)&&(de!=null||Te!=null))switch(le){case"type":w=de;break;case"name":T=de;break;case"checked":oe=de;break;case"defaultChecked":fe=de;break;case"value":N=de;break;case"defaultValue":D=de;break;case"children":case"dangerouslySetInnerHTML":if(de!=null)throw Error(i(137,o));break;default:de!==Te&&Ht(s,o,le,de,h,Te)}}_r(s,N,D,Z,oe,fe,w,T);return;case"select":de=N=D=le=null;for(w in l)if(Z=l[w],l.hasOwnProperty(w)&&Z!=null)switch(w){case"value":break;case"multiple":de=Z;default:h.hasOwnProperty(w)||Ht(s,o,w,null,h,Z)}for(T in h)if(w=h[T],Z=l[T],h.hasOwnProperty(T)&&(w!=null||Z!=null))switch(T){case"value":le=w;break;case"defaultValue":D=w;break;case"multiple":N=w;default:w!==Z&&Ht(s,o,T,w,h,Z)}o=D,l=N,h=de,le!=null?zt(s,!!l,le,!1):!!h!=!!l&&(o!=null?zt(s,!!l,o,!0):zt(s,!!l,l?[]:"",!1));return;case"textarea":de=le=null;for(D in l)if(T=l[D],l.hasOwnProperty(D)&&T!=null&&!h.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:Ht(s,o,D,null,h,T)}for(N in h)if(T=h[N],w=l[N],h.hasOwnProperty(N)&&(T!=null||w!=null))switch(N){case"value":le=T;break;case"defaultValue":de=T;break;case"children":break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(i(91));break;default:T!==w&&Ht(s,o,N,T,h,w)}vs(s,le,de);return;case"option":for(var Be in l)if(le=l[Be],l.hasOwnProperty(Be)&&le!=null&&!h.hasOwnProperty(Be))switch(Be){case"selected":s.selected=!1;break;default:Ht(s,o,Be,null,h,le)}for(Z in h)if(le=h[Z],de=l[Z],h.hasOwnProperty(Z)&&le!==de&&(le!=null||de!=null))switch(Z){case"selected":s.selected=le&&typeof le!="function"&&typeof le!="symbol";break;default:Ht(s,o,Z,le,h,de)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ye in l)le=l[Ye],l.hasOwnProperty(Ye)&&le!=null&&!h.hasOwnProperty(Ye)&&Ht(s,o,Ye,null,h,le);for(oe in h)if(le=h[oe],de=l[oe],h.hasOwnProperty(oe)&&le!==de&&(le!=null||de!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(i(137,o));break;default:Ht(s,o,oe,le,h,de)}return;default:if(ro(o)){for(var Gt in l)le=l[Gt],l.hasOwnProperty(Gt)&&le!==void 0&&!h.hasOwnProperty(Gt)&&Ym(s,o,Gt,void 0,h,le);for(fe in h)le=h[fe],de=l[fe],!h.hasOwnProperty(fe)||le===de||le===void 0&&de===void 0||Ym(s,o,fe,le,h,de);return}}for(var $ in l)le=l[$],l.hasOwnProperty($)&&le!=null&&!h.hasOwnProperty($)&&Ht(s,o,$,null,h,le);for(Te in h)le=h[Te],de=l[Te],!h.hasOwnProperty(Te)||le===de||le==null&&de==null||Ht(s,o,Te,le,h,de)}function Kv(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function QA(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,l=performance.getEntriesByType("resource"),h=0;h<l.length;h++){var T=l[h],w=T.transferSize,N=T.initiatorType,D=T.duration;if(w&&D&&Kv(N)){for(N=0,D=T.responseEnd,h+=1;h<l.length;h++){var Z=l[h],oe=Z.startTime;if(oe>D)break;var fe=Z.transferSize,Te=Z.initiatorType;fe&&Kv(Te)&&(Z=Z.responseEnd,N+=fe*(Z<D?1:(D-oe)/(Z-oe)))}if(--h,o+=8*(w+N)/(T.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Wm=null,Jm=null;function Yd(s){return s.nodeType===9?s:s.ownerDocument}function Zv(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Yv(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Qm(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var $m=null;function $A(){var s=window.event;return s&&s.type==="popstate"?s===$m?!1:($m=s,!0):($m=null,!1)}var Wv=typeof setTimeout=="function"?setTimeout:void 0,XA=typeof clearTimeout=="function"?clearTimeout:void 0,Jv=typeof Promise=="function"?Promise:void 0,eC=typeof queueMicrotask=="function"?queueMicrotask:typeof Jv<"u"?function(s){return Jv.resolve(null).then(s).catch(tC)}:Wv;function tC(s){setTimeout(function(){throw s})}function jr(s){return s==="head"}function Qv(s,o){var l=o,h=0;do{var T=l.nextSibling;if(s.removeChild(l),T&&T.nodeType===8)if(l=T.data,l==="/$"||l==="/&"){if(h===0){s.removeChild(T),$l(o);return}h--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")h++;else if(l==="html")dc(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,dc(l);for(var w=l.firstChild;w;){var N=w.nextSibling,D=w.nodeName;w[ps]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&w.rel.toLowerCase()==="stylesheet"||l.removeChild(w),w=N}}else l==="body"&&dc(s.ownerDocument.body);l=T}while(l);$l(o)}function $v(s,o){var l=s;s=0;do{var h=l.nextSibling;if(l.nodeType===1?o?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(o?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),h&&h.nodeType===8)if(l=h.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=h}while(l)}function Xm(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var l=o;switch(o=o.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Xm(l),mr(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function nC(s,o,l,h){for(;s.nodeType===1;){var T=l;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[ps])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(w=s.getAttribute("rel"),w==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(w!==T.rel||s.getAttribute("href")!==(T.href==null||T.href===""?null:T.href)||s.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin)||s.getAttribute("title")!==(T.title==null?null:T.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(w=s.getAttribute("src"),(w!==(T.src==null?null:T.src)||s.getAttribute("type")!==(T.type==null?null:T.type)||s.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin))&&w&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var w=T.name==null?null:""+T.name;if(T.type==="hidden"&&s.getAttribute("name")===w)return s}else return s;if(s=Ns(s.nextSibling),s===null)break}return null}function iC(s,o,l){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Ns(s.nextSibling),s===null))return null;return s}function Xv(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Ns(s.nextSibling),s===null))return null;return s}function ep(s){return s.data==="$?"||s.data==="$~"}function tp(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function sC(s,o){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||l.readyState!=="loading")o();else{var h=function(){o(),l.removeEventListener("DOMContentLoaded",h)};l.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function Ns(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var np=null;function e0(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(o===0)return Ns(s.nextSibling);o--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||o++}s=s.nextSibling}return null}function t0(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(o===0)return s;o--}else l!=="/$"&&l!=="/&"||o++}s=s.previousSibling}return null}function n0(s,o,l){switch(o=Yd(l),s){case"html":if(s=o.documentElement,!s)throw Error(i(452));return s;case"head":if(s=o.head,!s)throw Error(i(453));return s;case"body":if(s=o.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function dc(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);mr(s)}var Rs=new Map,i0=new Set;function Wd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var er=Se.d;Se.d={f:oC,r:rC,D:aC,C:lC,L:uC,m:cC,X:hC,S:dC,M:fC};function oC(){var s=er.f(),o=Bd();return s||o}function rC(s){var o=bi(s);o!==null&&o.tag===5&&o.type==="form"?Ty(o):er.r(s)}var Wl=typeof document>"u"?null:document;function s0(s,o,l){var h=Wl;if(h&&typeof o=="string"&&o){var T=Kt(o);T='link[rel="'+s+'"][href="'+T+'"]',typeof l=="string"&&(T+='[crossorigin="'+l+'"]'),i0.has(T)||(i0.add(T),s={rel:s,crossOrigin:l,href:o},h.querySelector(T)===null&&(o=h.createElement("link"),Jn(o,"link",s),pn(o),h.head.appendChild(o)))}}function aC(s){er.D(s),s0("dns-prefetch",s,null)}function lC(s,o){er.C(s,o),s0("preconnect",s,o)}function uC(s,o,l){er.L(s,o,l);var h=Wl;if(h&&s&&o){var T='link[rel="preload"][as="'+Kt(o)+'"]';o==="image"&&l&&l.imageSrcSet?(T+='[imagesrcset="'+Kt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(T+='[imagesizes="'+Kt(l.imageSizes)+'"]')):T+='[href="'+Kt(s)+'"]';var w=T;switch(o){case"style":w=Jl(s);break;case"script":w=Ql(s)}Rs.has(w)||(s=S({rel:"preload",href:o==="image"&&l&&l.imageSrcSet?void 0:s,as:o},l),Rs.set(w,s),h.querySelector(T)!==null||o==="style"&&h.querySelector(hc(w))||o==="script"&&h.querySelector(fc(w))||(o=h.createElement("link"),Jn(o,"link",s),pn(o),h.head.appendChild(o)))}}function cC(s,o){er.m(s,o);var l=Wl;if(l&&s){var h=o&&typeof o.as=="string"?o.as:"script",T='link[rel="modulepreload"][as="'+Kt(h)+'"][href="'+Kt(s)+'"]',w=T;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Ql(s)}if(!Rs.has(w)&&(s=S({rel:"modulepreload",href:s},o),Rs.set(w,s),l.querySelector(T)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(fc(w)))return}h=l.createElement("link"),Jn(h,"link",s),pn(h),l.head.appendChild(h)}}}function dC(s,o,l){er.S(s,o,l);var h=Wl;if(h&&s){var T=gs(h).hoistableStyles,w=Jl(s);o=o||"default";var N=T.get(w);if(!N){var D={loading:0,preload:null};if(N=h.querySelector(hc(w)))D.loading=5;else{s=S({rel:"stylesheet",href:s,"data-precedence":o},l),(l=Rs.get(w))&&ip(s,l);var Z=N=h.createElement("link");pn(Z),Jn(Z,"link",s),Z._p=new Promise(function(oe,fe){Z.onload=oe,Z.onerror=fe}),Z.addEventListener("load",function(){D.loading|=1}),Z.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Jd(N,o,h)}N={type:"stylesheet",instance:N,count:1,state:D},T.set(w,N)}}}function hC(s,o){er.X(s,o);var l=Wl;if(l&&s){var h=gs(l).hoistableScripts,T=Ql(s),w=h.get(T);w||(w=l.querySelector(fc(T)),w||(s=S({src:s,async:!0},o),(o=Rs.get(T))&&sp(s,o),w=l.createElement("script"),pn(w),Jn(w,"link",s),l.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(T,w))}}function fC(s,o){er.M(s,o);var l=Wl;if(l&&s){var h=gs(l).hoistableScripts,T=Ql(s),w=h.get(T);w||(w=l.querySelector(fc(T)),w||(s=S({src:s,async:!0,type:"module"},o),(o=Rs.get(T))&&sp(s,o),w=l.createElement("script"),pn(w),Jn(w,"link",s),l.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},h.set(T,w))}}function o0(s,o,l,h){var T=(T=Ce.current)?Wd(T):null;if(!T)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(o=Jl(l.href),l=gs(T).hoistableStyles,h=l.get(o),h||(h={type:"style",instance:null,count:0,state:null},l.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=Jl(l.href);var w=gs(T).hoistableStyles,N=w.get(s);if(N||(T=T.ownerDocument||T,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(s,N),(w=T.querySelector(hc(s)))&&!w._p&&(N.instance=w,N.state.loading=5),Rs.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Rs.set(s,l),w||mC(T,s,l,N.state))),o&&h===null)throw Error(i(528,""));return N}if(o&&h!==null)throw Error(i(529,""));return null;case"script":return o=l.async,l=l.src,typeof l=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Ql(l),l=gs(T).hoistableScripts,h=l.get(o),h||(h={type:"script",instance:null,count:0,state:null},l.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Jl(s){return'href="'+Kt(s)+'"'}function hc(s){return'link[rel="stylesheet"]['+s+"]"}function r0(s){return S({},s,{"data-precedence":s.precedence,precedence:null})}function mC(s,o,l,h){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=s.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),Jn(o,"link",l),pn(o),s.head.appendChild(o))}function Ql(s){return'[src="'+Kt(s)+'"]'}function fc(s){return"script[async]"+s}function a0(s,o,l){if(o.count++,o.instance===null)switch(o.type){case"style":var h=s.querySelector('style[data-href~="'+Kt(l.href)+'"]');if(h)return o.instance=h,pn(h),h;var T=S({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),pn(h),Jn(h,"style",T),Jd(h,l.precedence,s),o.instance=h;case"stylesheet":T=Jl(l.href);var w=s.querySelector(hc(T));if(w)return o.state.loading|=4,o.instance=w,pn(w),w;h=r0(l),(T=Rs.get(T))&&ip(h,T),w=(s.ownerDocument||s).createElement("link"),pn(w);var N=w;return N._p=new Promise(function(D,Z){N.onload=D,N.onerror=Z}),Jn(w,"link",h),o.state.loading|=4,Jd(w,l.precedence,s),o.instance=w;case"script":return w=Ql(l.src),(T=s.querySelector(fc(w)))?(o.instance=T,pn(T),T):(h=l,(T=Rs.get(w))&&(h=S({},l),sp(h,T)),s=s.ownerDocument||s,T=s.createElement("script"),pn(T),Jn(T,"link",h),s.head.appendChild(T),o.instance=T);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,Jd(h,l.precedence,s));return o.instance}function Jd(s,o,l){for(var h=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),T=h.length?h[h.length-1]:null,w=T,N=0;N<h.length;N++){var D=h[N];if(D.dataset.precedence===o)w=D;else if(w!==T)break}w?w.parentNode.insertBefore(s,w.nextSibling):(o=l.nodeType===9?l.head:l,o.insertBefore(s,o.firstChild))}function ip(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function sp(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Qd=null;function l0(s,o,l){if(Qd===null){var h=new Map,T=Qd=new Map;T.set(l,h)}else T=Qd,h=T.get(l),h||(h=new Map,T.set(l,h));if(h.has(s))return h;for(h.set(s,null),l=l.getElementsByTagName(s),T=0;T<l.length;T++){var w=l[T];if(!(w[ps]||w[cn]||s==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var N=w.getAttribute(o)||"";N=s+N;var D=h.get(N);D?D.push(w):h.set(N,[w])}}return h}function u0(s,o,l){s=s.ownerDocument||s,s.head.insertBefore(l,o==="title"?s.querySelector("head > title"):null)}function pC(s,o,l){if(l===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function c0(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function gC(s,o,l,h){if(l.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var T=Jl(h.href),w=o.querySelector(hc(T));if(w){o=w._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=$d.bind(s),o.then(s,s)),l.state.loading|=4,l.instance=w,pn(w);return}w=o.ownerDocument||o,h=r0(h),(T=Rs.get(T))&&ip(h,T),w=w.createElement("link"),pn(w);var N=w;N._p=new Promise(function(D,Z){N.onload=D,N.onerror=Z}),Jn(w,"link",h),l.instance=w}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,o),(o=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=$d.bind(s),o.addEventListener("load",l),o.addEventListener("error",l))}}var op=0;function _C(s,o){return s.stylesheets&&s.count===0&&eh(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var h=setTimeout(function(){if(s.stylesheets&&eh(s,s.stylesheets),s.unsuspend){var w=s.unsuspend;s.unsuspend=null,w()}},6e4+o);0<s.imgBytes&&op===0&&(op=62500*QA());var T=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&eh(s,s.stylesheets),s.unsuspend)){var w=s.unsuspend;s.unsuspend=null,w()}},(s.imgBytes>op?50:800)+o);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(T)}}:null}function $d(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)eh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Xd=null;function eh(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Xd=new Map,o.forEach(yC,s),Xd=null,$d.call(s))}function yC(s,o){if(!(o.state.loading&4)){var l=Xd.get(s);if(l)var h=l.get(null);else{l=new Map,Xd.set(s,l);for(var T=s.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<T.length;w++){var N=T[w];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(l.set(N.dataset.precedence,N),h=N)}h&&l.set(null,h)}T=o.instance,N=T.getAttribute("data-precedence"),w=l.get(N)||h,w===h&&l.set(null,T),l.set(N,T),this.count++,h=$d.bind(this),T.addEventListener("load",h),T.addEventListener("error",h),w?w.parentNode.insertBefore(T,w.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(T,s.firstChild)),o.state.loading|=4}}var mc={$$typeof:ee,Provider:null,Consumer:null,_currentValue:Ae,_currentValue2:Ae,_threadCount:0};function vC(s,o,l,h,T,w,N,D,Z){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ms(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ms(0),this.hiddenUpdates=ms(null),this.identifierPrefix=h,this.onUncaughtError=T,this.onCaughtError=w,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function d0(s,o,l,h,T,w,N,D,Z,oe,fe,Te){return s=new vC(s,o,l,N,Z,oe,fe,Te,D),o=1,w===!0&&(o|=24),w=ri(3,null,null,o),s.current=w,w.stateNode=s,o=Uf(),o.refCount++,s.pooledCache=o,o.refCount++,w.memoizedState={element:h,isDehydrated:l,cache:o},qf(w),s}function h0(s){return s?(s=Bo,s):Bo}function f0(s,o,l,h,T,w){T=h0(T),h.context===null?h.context=T:h.pendingContext=T,h=Dr(o),h.payload={element:l},w=w===void 0?null:w,w!==null&&(h.callback=w),l=Lr(s,h,o),l!==null&&(Fi(l,s,o),Ku(l,s,o))}function m0(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<o?l:o}}function rp(s,o){m0(s,o),(s=s.alternate)&&m0(s,o)}function p0(s){if(s.tag===13||s.tag===31){var o=Cs(s,67108864);o!==null&&Fi(o,s,67108864),rp(s,67108864)}}function g0(s){if(s.tag===13||s.tag===31){var o=ls();o=Un(o);var l=Cs(s,o);l!==null&&Fi(l,s,o),rp(s,o)}}var th=!0;function TC(s,o,l,h){var T=te.T;te.T=null;var w=Se.p;try{Se.p=2,ap(s,o,l,h)}finally{Se.p=w,te.T=T}}function EC(s,o,l,h){var T=te.T;te.T=null;var w=Se.p;try{Se.p=8,ap(s,o,l,h)}finally{Se.p=w,te.T=T}}function ap(s,o,l,h){if(th){var T=lp(h);if(T===null)Zm(s,o,h,nh,l),y0(s,h);else if(wC(T,s,o,l,h))h.stopPropagation();else if(y0(s,h),o&4&&-1<xC.indexOf(s)){for(;T!==null;){var w=bi(T);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var N=hs(w.pendingLanes);if(N!==0){var D=w;for(D.pendingLanes|=2,D.entangledLanes|=2;N;){var Z=1<<31-Qt(N);D.entanglements[1]|=Z,N&=~Z}xo(w),(kt&6)===0&&(Ud=dt()+500,lc(0))}}break;case 31:case 13:D=Cs(w,2),D!==null&&Fi(D,w,2),Bd(),rp(w,2)}if(w=lp(h),w===null&&Zm(s,o,h,nh,l),w===T)break;T=w}T!==null&&h.stopPropagation()}else Zm(s,o,h,null,l)}}function lp(s){return s=ni(s),up(s)}var nh=null;function up(s){if(nh=null,s=Wi(s),s!==null){var o=u(s);if(o===null)s=null;else{var l=o.tag;if(l===13){if(s=c(o),s!==null)return s;s=null}else if(l===31){if(s=m(o),s!==null)return s;s=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return nh=s,null}function _0(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(an()){case gi:return 2;case _i:return 8;case Ie:case ut:return 32;case Vt:return 268435456;default:return 32}default:return 32}}var cp=!1,Kr=null,Zr=null,Yr=null,pc=new Map,gc=new Map,Wr=[],xC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function y0(s,o){switch(s){case"focusin":case"focusout":Kr=null;break;case"dragenter":case"dragleave":Zr=null;break;case"mouseover":case"mouseout":Yr=null;break;case"pointerover":case"pointerout":pc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":gc.delete(o.pointerId)}}function _c(s,o,l,h,T,w){return s===null||s.nativeEvent!==w?(s={blockedOn:o,domEventName:l,eventSystemFlags:h,nativeEvent:w,targetContainers:[T]},o!==null&&(o=bi(o),o!==null&&p0(o)),s):(s.eventSystemFlags|=h,o=s.targetContainers,T!==null&&o.indexOf(T)===-1&&o.push(T),s)}function wC(s,o,l,h,T){switch(o){case"focusin":return Kr=_c(Kr,s,o,l,h,T),!0;case"dragenter":return Zr=_c(Zr,s,o,l,h,T),!0;case"mouseover":return Yr=_c(Yr,s,o,l,h,T),!0;case"pointerover":var w=T.pointerId;return pc.set(w,_c(pc.get(w)||null,s,o,l,h,T)),!0;case"gotpointercapture":return w=T.pointerId,gc.set(w,_c(gc.get(w)||null,s,o,l,h,T)),!0}return!1}function v0(s){var o=Wi(s.target);if(o!==null){var l=u(o);if(l!==null){if(o=l.tag,o===13){if(o=c(l),o!==null){s.blockedOn=o,Ai(s.priority,function(){g0(l)});return}}else if(o===31){if(o=m(l),o!==null){s.blockedOn=o,Ai(s.priority,function(){g0(l)});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ih(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var l=lp(s.nativeEvent);if(l===null){l=s.nativeEvent;var h=new l.constructor(l.type,l);vr=h,l.target.dispatchEvent(h),vr=null}else return o=bi(l),o!==null&&p0(o),s.blockedOn=l,!1;o.shift()}return!0}function T0(s,o,l){ih(s)&&l.delete(o)}function SC(){cp=!1,Kr!==null&&ih(Kr)&&(Kr=null),Zr!==null&&ih(Zr)&&(Zr=null),Yr!==null&&ih(Yr)&&(Yr=null),pc.forEach(T0),gc.forEach(T0)}function sh(s,o){s.blockedOn===o&&(s.blockedOn=null,cp||(cp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,SC)))}var oh=null;function E0(s){oh!==s&&(oh=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){oh===s&&(oh=null);for(var o=0;o<s.length;o+=3){var l=s[o],h=s[o+1],T=s[o+2];if(typeof h!="function"){if(up(h||l)===null)continue;break}var w=bi(l);w!==null&&(s.splice(o,3),o-=3,lm(w,{pending:!0,data:T,method:l.method,action:h},h,T))}}))}function $l(s){function o(Z){return sh(Z,s)}Kr!==null&&sh(Kr,s),Zr!==null&&sh(Zr,s),Yr!==null&&sh(Yr,s),pc.forEach(o),gc.forEach(o);for(var l=0;l<Wr.length;l++){var h=Wr[l];h.blockedOn===s&&(h.blockedOn=null)}for(;0<Wr.length&&(l=Wr[0],l.blockedOn===null);)v0(l),l.blockedOn===null&&Wr.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(h=0;h<l.length;h+=3){var T=l[h],w=l[h+1],N=T[mn]||null;if(typeof w=="function")N||E0(l);else if(N){var D=null;if(w&&w.hasAttribute("formAction")){if(T=w,N=w[mn]||null)D=N.formAction;else if(up(T)!==null)continue}else D=N.action;typeof D=="function"?l[h+1]=D:(l.splice(h,3),h-=3),E0(l)}}}function x0(){function s(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(N){return T=N})},focusReset:"manual",scroll:"manual"})}function o(){T!==null&&(T(),T=null),h||setTimeout(l,20)}function l(){if(!h&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,T=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(l,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),T!==null&&(T(),T=null)}}}function dp(s){this._internalRoot=s}rh.prototype.render=dp.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(i(409));var l=o.current,h=ls();f0(l,h,s,o,null,null)},rh.prototype.unmount=dp.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;f0(s.current,2,null,s,null,null),Bd(),o[Zi]=null}};function rh(s){this._internalRoot=s}rh.prototype.unstable_scheduleHydration=function(s){if(s){var o=Ta();s={blockedOn:null,target:s,priority:o};for(var l=0;l<Wr.length&&o!==0&&o<Wr[l].priority;l++);Wr.splice(l,0,s),l===0&&v0(s)}};var w0=e.version;if(w0!=="19.2.0")throw Error(i(527,w0,"19.2.0"));Se.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=p(o),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var AC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:te,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ah.isDisabled&&ah.supportsFiber)try{Tn=ah.inject(AC),Ot=ah}catch{}}return vc.createRoot=function(s,o){if(!r(s))throw Error(i(299));var l=!1,h="",T=Ry,w=My,N=Py;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(T=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError)),o=d0(s,1,!1,null,null,l,h,null,T,w,N,x0),s[Zi]=o.current,Km(s),new dp(o)},vc.hydrateRoot=function(s,o,l){if(!r(s))throw Error(i(299));var h=!1,T="",w=Ry,N=My,D=Py,Z=null;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(T=l.identifierPrefix),l.onUncaughtError!==void 0&&(w=l.onUncaughtError),l.onCaughtError!==void 0&&(N=l.onCaughtError),l.onRecoverableError!==void 0&&(D=l.onRecoverableError),l.formState!==void 0&&(Z=l.formState)),o=d0(s,1,!0,o,l??null,h,T,Z,w,N,D,x0),o.context=h0(null),l=o.current,h=ls(),h=Un(h),T=Dr(h),T.callback=null,Lr(l,T,h),l=h,o.current.lanes=l,Ds(o,l),xo(o),s[Zi]=o.current,Km(s),new rh(o)},vc.version="19.2.0",vc}var k0;function DC(){if(k0)return mp.exports;k0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),mp.exports=kC(),mp.exports}var LC=DC();const VC=gg(LC);var nt=(n=>(n.HOME="HOME",n.ADD_TRIP="ADD_TRIP",n.TRIP_DETAILS="TRIP_DETAILS",n.SETTINGS="SETTINGS",n.MAGIC_EDITOR="MAGIC_EDITOR",n.AI_PLANNER="AI_PLANNER",n.TOOLS="TOOLS",n.TRIP_MEMORY="TRIP_MEMORY",n))(nt||{});const OC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"})}),Qh=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),sr=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"})}),hu=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})]}),Rp=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"})]}),cs=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"})}),Mp=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})}),UC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Gx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:E.jsx("path",{d:"M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5Z"})}),jx=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"})]}),Kx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"})}),Zx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 9.75a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 0 1 .778-.332 48.294 48.294 0 0 0 5.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})}),zC=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:[E.jsx("path",{d:"M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.85 7h10.29l1.08 3.11H5.77L6.85 7zM19 17H5v-5h14v5z"}),E.jsx("circle",{cx:"7.5",cy:"14.5",r:"1.5"}),E.jsx("circle",{cx:"16.5",cy:"14.5",r:"1.5"})]}),D0=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z"})}),yg=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 16.875h3.375m0 0h3.375m-3.375 0V13.5m0 3.375v3.375M6 10.5h2.25a2.25 2.25 0 0 0 2.25-2.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v2.25A2.25 2.25 0 0 0 6 10.5Zm0 9.75h2.25A2.25 2.25 0 0 0 10.5 18v-2.25a2.25 2.25 0 0 0-2.25-2.25H6a2.25 2.25 0 0 0-2.25 2.25V18A2.25 2.25 0 0 0 6 20.25Zm9.75-9.75H18a2.25 2.25 0 0 0 2.25-2.25V6A2.25 2.25 0 0 0 18 3.75h-2.25A2.25 2.25 0 0 0 13.5 6v2.25a2.25 2.25 0 0 0 2.25 2.25Z"})}),or=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),BC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"})}),FC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),qC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 0 1-2.25 2.25M16.5 7.5V18a2.25 2.25 0 0 0 2.25 2.25M16.5 7.5V4.875c0-.621-.504-1.125-1.125-1.125H4.125C3.504 3.75 3 4.254 3 4.875V18a2.25 2.25 0 0 0 2.25 2.25h13.5M6 7.5h3v3H6v-3Z"})}),Pp=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-1.94c.955-.13 1.93-.32 2.795-.591 3.615-1.133 4.705-4.884 2.636-7.962-1.373-2.042-3.738-3.257-6.236-3.257-4.14 0-7.5 3.36-7.5 7.5 0 2.053.84 3.942 2.22 5.297.808.796 1.83 1.344 2.923 1.564V18m2.25 0h-4.5m4.5 0a2.25 2.25 0 0 1-2.25 2.25h-1.5A2.25 2.25 0 0 1 7.5 18m9-9h.008v.008H16.5V9Zm-4.5 0h.008v.008H12V9Zm-4.5 0h.008v.008H7.5V9Z"})}),HC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h3.375c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125h-3.375c-.621 0-1.125-.504-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125Zm-3 7.5h10.5a.75.75 0 0 1 .75.75v3.375a3 3 0 0 1-3 3h-6a3 3 0 0 1-3-3V10.5a.75.75 0 0 1 .75-.75Zm9.375 12a1.125 1.125 0 1 0 0-2.25 1.125 1.125 0 0 0 0 2.25Z"})}),GC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"})}),Yx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 17.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),jC=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 0 1 1.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.559.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.894.149c-.424.07-.764.383-.929.78-.165.398-.143.854.107 1.204l-.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 0 1-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 0 1-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 0 1 .12-1.45l.773-.773a1.125 1.125 0 0 1 1.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894Z"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),KC=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:[E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}),E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),ZC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"})}),Wx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),Jx=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 01-1.12-1.243l1.264-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.119 1.007zM8.625 10.5a.375.375 0 11-.75 0 .375.375 0 01.75 0zm7.5 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})}),YC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 21l5.25-11.25L21 21m-9-3h7.5M3 5.621a48.474 48.474 0 016-.371m0 0c1.12 0 2.233.038 3.334.114M9 5.25V3m3.334 2.364C11.176 10.658 7.69 15.08 3 17.502m9.334-12.138c.896.061 1.785.147 2.666.257m-4.589 8.495a18.023 18.023 0 01-3.827-5.802"})}),WC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})}),L0=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0 1 18 16.5h-2.25m-7.5 0h7.5m-7.5 0-1 3m8.5-3 1 3m0 0 .5 1.5m-.5-1.5h-9.5m0 0-.5 1.5M9 11.25v1.5M12 9v3m3-3v3M9 3.75V5.25m3-1.5h3m-3 0v1.5m0-1.5h-3m3 0v1.5M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})}),JC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:E.jsx("path",{d:"M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4S4 2.5 4 6v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z"})}),QC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:n,children:E.jsx("path",{d:"M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"})}),$C=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})}),XC=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})}),eb=({className:n})=>E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:n,children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})}),Wt={"zh-TW":{back:"",cancel:"",confirm:"",save:"",delete:"",edit:"",loading:"...",day:"Day",my_trips:"",start_adventure:"",click_to_add:"",trips_count:"",new_trip:"",trip_destination_title:" / ",cover_photo:"",upload_photo:"",ai_generate_cover:"AI ",start_date:"",end_date:"",create_trip:"",add_trip_hint:"",itinerary:"",map:"",budget:"",bookings:"",shopping_list:"",shopping:"",origin:"",label_destination:"",status_confirmed:"",status_pending:"",status_cancelled:"",ai_guide:"AI ",add_activity:"",edit_activity:"",add_expense:"",add_booking:"",weather:"",nav_quick_jump:"",no_itinerary:"",click_add:"",delete_trip_title:"",delete_trip_confirm:"{title}",confirm_delete:"",activity_name:"",time:"",location:"",notes:" ()",duration:"",details:"",placeholder_duration:"15 ",placeholder_details:"JR ",ai_route:"AI ",optimize_route:"AI ",expense_item:"",amount:"",payer:"",payment_method:"",booking_type:"",provider:" / ",booking_ref:" ()",ai_planner_title:"AI ",ai_planner_intro:" AI ",ai_planning:" 10-20 ",ai_done:"",input_placeholder:"...",planning_process:"...",magic_editor_title:"",upload_hint:"",magic_prompt_placeholder:"...",start_magic:"",generating:"...",settings_title:"",general:"",language:"",appearance:"",minimalist_mode:"",minimalist_desc:"",data_mgmt:"",reset_all:"",reset_confirm:"",tools_title:"",tool_emergency:"",tool_card:"",tool_map:"",tool_restroom:"",tool_visa:"",tool_translation:"",tool_culture:"",api_settings:"API ",api_key_label:"Gemini API Key",api_key_placeholder:" API Key",api_key_help:" Key ",api_key_saved:"API Key ",theme_color:"",payer_me:"",payer_other:"",payment_cash:"",payment_card:"",split_individual:"",split_shared:"",translate_to:"",enter_text:"...",translate_result:"",desc_translator:"AI ",desc_emergency:" / ",desc_card:"",desc_map:"",desc_restroom:"",desc_visa:"",desc_culture:"",prompt_tokyo:"",prompt_bangkok:"",prompt_paris:"",placeholder_item:"",placeholder_payer:"",lang_ja:"",lang_en:"",lang_zh:"",lang_ko:"",lang_th:"",lang_fr:"",lang_es:"",share_trip:"",share_success:"",travel_time:"",travel_mode:"",travel_details:" ( JR )",mode_walk:"",mode_train:"/",mode_bus:"/",mode_car:"/",mode_flight:"",minutes:"",search_placeholder:" (: )",search_location:""},"en-US":{back:"Back",cancel:"Cancel",confirm:"Confirm",save:"Save",delete:"Delete",edit:"Edit",loading:"Loading...",day:"Day",my_trips:"My Trips",start_adventure:"Start New Adventure",click_to_add:"Click button below to add trip",trips_count:"items",new_trip:"New Trip",trip_destination_title:"Destination / Title",cover_photo:"Cover Photo",upload_photo:"Upload",ai_generate_cover:"AI Generate",start_date:"Start Date",end_date:"End Date",create_trip:"Create Trip",add_trip_hint:"You can add detailed itinerary later",itinerary:"Itinerary",map:"Map",budget:"Budget",shopping_list:"Shopping List",shopping:"Shopping",bookings:"Bookings",origin:"Origin",label_destination:"Destination",status_confirmed:"Confirmed",status_pending:"Pending",status_cancelled:"Cancelled",ai_guide:"AI Guide",add_activity:"Add Activity",edit_activity:"Edit Activity",add_expense:"Add Expense",add_booking:"Add Booking",weather:"Weather",nav_quick_jump:"Jump to",no_itinerary:"No itinerary yet",click_add:"Click button to add",delete_trip_title:"Delete Trip?",delete_trip_confirm:'Are you sure you want to delete "{title}"? This cannot be undone.',confirm_delete:"Delete",activity_name:"Activity Name",time:"Time",location:"Location",notes:"Notes (Optional)",duration:"Duration",details:"Details",placeholder_duration:"e.g. 15 min",placeholder_details:"e.g. JR Line",ai_route:"AI Route",optimize_route:"AI Route Optimization",expense_item:"Item Name",amount:"Amount",payer:"Payer",payment_method:"Method",booking_type:"Type",provider:"Provider / Name",booking_ref:"Ref Number (Optional)",ai_planner_title:"AI Planner",ai_planner_intro:"Hi! I am your AI travel assistant. Where do you want to go?",ai_planning:"Sure! I am planning your trip. This takes about 10-20 seconds.",ai_done:"Planning complete! Check your trip list. ",input_placeholder:"Enter your travel ideas...",planning_process:"Processing...",magic_editor_title:"Magic Editor",upload_hint:"Upload Photo",magic_prompt_placeholder:"Make it sunny, add balloons...",start_magic:"Generate",generating:"Processing...",settings_title:"Settings",api_settings:"API Settings",api_key_label:"Gemini API Key",api_key_placeholder:"Paste your API Key here",api_key_help:"Your key is stored locally in your browser.",api_key_saved:"API Key Saved",general:"General",language:"Language",appearance:"Appearance",minimalist_mode:"Minimalist Mode",minimalist_desc:"Hide images, focus on text",data_mgmt:"Data Management",reset_all:"Reset All Data",reset_confirm:"Are you sure? This will delete all trips and settings. This cannot be undone.",tools_title:"Tools",tool_emergency:"Emergency",tool_card:"Card Tips",tool_map:"Scratch Map",tool_restroom:"Restroom",tool_visa:"Visa Check",tool_culture:"Culture",share_trip:"Share Trip",share_success:"Copied to clipboard!",travel_time:"Travel Time",travel_mode:"Travel Mode",travel_details:"Details (e.g. JR Line)",mode_walk:"Walk",mode_train:"Train/Subway",mode_bus:"Bus",mode_car:"Car/Taxi",mode_flight:"Flight",minutes:"min",search_placeholder:"Search location (e.g. Tokyo Tower)",search_location:"Search"},"ja-JP":{back:"",cancel:"",confirm:"",save:"",delete:"",edit:"",loading:"...",day:"Day",my_trips:"",start_adventure:"",click_to_add:"",trips_count:"",new_trip:"",trip_destination_title:" / ",cover_photo:"",upload_photo:"",ai_generate_cover:"AI",start_date:"",end_date:"",create_trip:"",add_trip_hint:"",itinerary:"",map:"",budget:"",shopping_list:"",shopping:"",bookings:"",origin:"",label_destination:"",status_confirmed:"",status_pending:"",status_cancelled:"",ai_guide:"AI",add_activity:"",edit_activity:"",add_expense:"",add_booking:"",weather:"",nav_quick_jump:"",no_itinerary:"",click_add:"",delete_trip_title:"",delete_trip_confirm:"{title}",confirm_delete:"",activity_name:"",time:"",location:"",notes:" ()",duration:"",details:"",placeholder_duration:"15",placeholder_details:"JR",ai_route:"AI",optimize_route:"AI",expense_item:"",amount:"",payer:"",payment_method:"",booking_type:"",provider:" / ",booking_ref:" ()",ai_planner_title:"AI",ai_planner_intro:"AI",ai_planning:"1020",ai_done:"",input_placeholder:"...",planning_process:"...",magic_editor_title:"",upload_hint:"",magic_prompt_placeholder:"...",start_magic:"",generating:"...",settings_title:"",general:"",language:"",appearance:"",minimalist_mode:"",minimalist_desc:"",data_mgmt:"",reset_all:"",reset_confirm:"",tools_title:"",tool_emergency:"",tool_card:"",tool_map:"",tool_restroom:"",tool_visa:"",tool_culture:"",share_trip:"",share_success:"",travel_time:"",travel_mode:"",travel_details:" (: JR)",mode_walk:"",mode_train:"/",mode_bus:"",mode_car:"/",mode_flight:"",minutes:"",search_placeholder:" (: )",search_location:""}},tb=({trips:n,onSelectTrip:e,onAddTrip:t,onOpenSettings:i,settings:r})=>{const[u,c]=W.useState(new Set),[m,g]=W.useState(new Set),p=Wt[r.language]||Wt["zh-TW"],x=S=>{c(C=>{const M=new Set(C);return M.add(S),M})};return E.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[E.jsxs("div",{className:"px-6 py-5 sticky top-0 z-10 flex justify-between items-center bg-paper/90 backdrop-blur-sm",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"w-14 h-14 flex items-center justify-center overflow-hidden",children:E.jsx("img",{src:"/nomadai-travel-journal_app_icon.png",alt:"Icon",className:"w-full h-full object-cover"})}),E.jsx("h1",{className:"text-3xl font-extrabold text-ink tracking-tight",children:p.my_trips})]}),E.jsx("button",{onClick:i,className:"p-2.5 bg-white shadow-card rounded-full text-gray-400 hover:text-coral transition-colors active:scale-95",children:E.jsx(jC,{className:"w-6 h-6"})})]}),E.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-2 space-y-6 pb-32 no-scrollbar",children:n.length===0?E.jsxs("div",{className:"flex flex-col items-center justify-center h-80 text-center animate-fade-in border-2 border-dashed border-sand rounded-3xl m-4",children:[E.jsx("div",{className:"w-16 h-16 bg-white shadow-soft rounded-full flex items-center justify-center mb-4 text-coral",children:E.jsx(Rp,{className:"w-8 h-8"})}),E.jsx("h3",{className:"text-xl font-bold text-ink mb-1",children:p.start_adventure}),E.jsx("p",{className:"text-gray-400 text-sm",children:p.click_to_add})]}):n==null?void 0:n.map(S=>{var C;return E.jsxs("div",{onClick:()=>e(S),className:`group cursor-pointer active:scale-[0.98] transition-all transform bg-white rounded-3xl shadow-card hover:shadow-soft overflow-hidden ${r.minimalistMode?"p-5 border border-sand":"p-3"}`,children:[!r.minimalistMode&&E.jsxs("div",{className:"aspect-[2/1] w-full relative overflow-hidden rounded-2xl bg-gray-100 mb-4 shadow-inner group",children:[S.coverImage&&!u.has(S.id)?E.jsxs(E.Fragment,{children:[E.jsx("div",{className:`absolute inset-0 bg-gray-200 transition-opacity duration-500 ${m.has(S.id)?"opacity-0 pointer-events-none":"opacity-100"}`}),E.jsx("img",{src:S.coverImage,alt:S.title,onLoad:()=>g(M=>new Set(M).add(S.id)),onError:()=>x(S.id),className:`w-full h-full object-cover transition-all duration-700 ${m.has(S.id)?"opacity-100 group-hover:scale-105":"opacity-0"}`})]}):E.jsx("div",{className:"w-full h-full bg-sand/30 flex items-center justify-center",children:E.jsx(Rp,{className:"w-12 h-12 text-gray-300"})}),E.jsxs("div",{className:"absolute top-3 right-3 bg-white/90 backdrop-blur text-ink text-xs font-bold px-3 py-1.5 rounded-full shadow-sm z-10",children:[((C=S.itinerary)==null?void 0:C.length)||0," ",p.trips_count]})]}),E.jsxs("div",{className:`${r.minimalistMode?"flex justify-between items-center":"px-2 pb-2"}`,children:[E.jsxs("div",{children:[E.jsx("h3",{className:`font-bold text-ink leading-tight ${r.minimalistMode?"text-lg":"text-xl mb-1"}`,children:S.title}),E.jsxs("div",{className:"flex items-center text-sm text-gray-400 font-medium",children:[E.jsx(Mp,{className:"w-4 h-4 mr-1.5 text-coral"}),E.jsxs("span",{children:[S.startDate," - ",S.endDate]})]})]}),r.minimalistMode&&E.jsx("div",{className:"w-8 h-8 bg-paper rounded-full flex items-center justify-center text-coral",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-4 h-4",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})})})]})]},S.id)})}),E.jsx("button",{onClick:t,className:"fixed bottom-28 right-6 w-16 h-16 bg-coral text-white rounded-full shadow-float flex items-center justify-center transition-all active:scale-90 hover:bg-coralDark z-50 ring-4 ring-white",children:E.jsx(Qh,{className:"w-8 h-8 stroke-[2]"})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let nb,ib;function sb(){return{geminiUrl:nb,vertexUrl:ib}}function ob(n,e,t,i){var r,u;if(!(n!=null&&n.baseUrl)){const c=sb();return e?(r=c.vertexUrl)!==null&&r!==void 0?r:t:(u=c.geminiUrl)!==null&&u!==void 0?u:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dr{}function De(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const u=e[r];return u!=null?String(u):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function _(n,e,t){for(let u=0;u<e.length-1;u++){const c=e[u];if(c.endsWith("[]")){const m=c.slice(0,-2);if(!(m in n))if(Array.isArray(t))n[m]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(n[m])){const g=n[m];if(Array.isArray(t))for(let p=0;p<g.length;p++){const x=g[p];_(x,e.slice(u+1),t[p])}else for(const p of g)_(p,e.slice(u+1),t)}return}else if(c.endsWith("[0]")){const m=c.slice(0,-3);m in n||(n[m]=[{}]);const g=n[m];_(g[0],e.slice(u+1),t);return}(!n[c]||typeof n[c]!="object")&&(n[c]={}),n=n[c]}const i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function f(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const r=e[i];if(r.endsWith("[]")){const u=r.slice(0,-2);if(u in n){const c=n[u];return Array.isArray(c)?c.map(m=>f(m,e.slice(i+1),t)):t}else return t}else n=n[r]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function rb(n,e){for(const[t,i]of Object.entries(e)){const r=t.split("."),u=i.split("."),c=new Set;let m=-1;for(let g=0;g<r.length;g++)if(r[g]==="*"){m=g;break}if(m!==-1&&u.length>m)for(let g=m;g<u.length;g++){const p=u[g];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&c.add(p)}kp(n,r,u,0,c)}}function kp(n,e,t,i,r){if(i>=e.length||typeof n!="object"||n===null)return;const u=e[i];if(u.endsWith("[]")){const c=u.slice(0,-2),m=n;if(c in m&&Array.isArray(m[c]))for(const g of m[c])kp(g,e,t,i+1,r)}else if(u==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const c=n,m=Object.keys(c).filter(p=>!p.startsWith("_")&&!r.has(p)),g={};for(const p of m)g[p]=c[p];for(const[p,x]of Object.entries(g)){const S=[];for(const C of t.slice(i))C==="*"?S.push(p):S.push(C);_(c,S,x)}for(const p of m)delete c[p]}}else{const c=n;u in c&&kp(c[u],e,t,i+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vg(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ab(n){const e={},t=f(n,["operationName"]);t!=null&&_(e,["operationName"],t);const i=f(n,["resourceName"]);return i!=null&&_(e,["_url","resourceName"],i),e}function lb(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response","generateVideoResponse"]);return c!=null&&_(e,["response"],cb(c)),e}function ub(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response"]);return c!=null&&_(e,["response"],db(c)),e}function cb(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let u=t;Array.isArray(u)&&(u=u.map(c=>hb(c))),_(e,["generatedVideos"],u)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function db(n){const e={},t=f(n,["videos"]);if(t!=null){let u=t;Array.isArray(u)&&(u=u.map(c=>fb(c))),_(e,["generatedVideos"],u)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function hb(n){const e={},t=f(n,["video"]);return t!=null&&_(e,["video"],vb(t)),e}function fb(n){const e={},t=f(n,["_self"]);return t!=null&&_(e,["video"],Tb(t)),e}function mb(n){const e={},t=f(n,["operationName"]);return t!=null&&_(e,["_url","operationName"],t),e}function pb(n){const e={},t=f(n,["operationName"]);return t!=null&&_(e,["_url","operationName"],t),e}function gb(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response"]);return c!=null&&_(e,["response"],_b(c)),e}function _b(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["parent"]);i!=null&&_(e,["parent"],i);const r=f(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function Qx(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response"]);return c!=null&&_(e,["response"],yb(c)),e}function yb(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["parent"]);i!=null&&_(e,["parent"],i);const r=f(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function vb(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["uri"],t);const i=f(n,["encodedVideo"]);i!=null&&_(e,["videoBytes"],vg(i));const r=f(n,["encoding"]);return r!=null&&_(e,["mimeType"],r),e}function Tb(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["uri"],t);const i=f(n,["bytesBase64Encoded"]);i!=null&&_(e,["videoBytes"],vg(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var V0;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(V0||(V0={}));var O0;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(O0||(O0={}));var U0;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(U0||(U0={}));var ta;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(ta||(ta={}));var z0;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(z0||(z0={}));var B0;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(B0||(B0={}));var F0;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(F0||(F0={}));var q0;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(q0||(q0={}));var H0;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(H0||(H0={}));var G0;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(G0||(G0={}));var j0;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(j0||(j0={}));var K0;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(K0||(K0={}));var Z0;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Z0||(Z0={}));var Y0;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(Y0||(Y0={}));var W0;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(W0||(W0={}));var J0;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(J0||(J0={}));var Q0;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Q0||(Q0={}));var $0;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})($0||($0={}));var X0;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(X0||(X0={}));var Ih;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Ih||(Ih={}));var eT;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(eT||(eT={}));var tT;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(tT||(tT={}));var nT;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(nT||(nT={}));var Dp;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Dp||(Dp={}));var iT;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(iT||(iT={}));var sT;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(sT||(sT={}));var oT;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(oT||(oT={}));var rT;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(rT||(rT={}));var aT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(aT||(aT={}));var lT;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(lT||(lT={}));var uT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(uT||(uT={}));var cT;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(cT||(cT={}));var dT;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(dT||(dT={}));var hT;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(hT||(hT={}));var fT;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(fT||(fT={}));var mT;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(mT||(mT={}));var pT;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(pT||(pT={}));var gT;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(gT||(gT={}));var _T;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(_T||(_T={}));var yT;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(yT||(yT={}));var vT;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(vT||(vT={}));var TT;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(TT||(TT={}));var ET;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(ET||(ET={}));var xT;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(xT||(xT={}));var wT;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(wT||(wT={}));var ST;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(ST||(ST={}));var AT;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(AT||(AT={}));var CT;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(CT||(CT={}));var bT;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(bT||(bT={}));var IT;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(IT||(IT={}));var NT;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(NT||(NT={}));var RT;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(RT||(RT={}));var MT;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(MT||(MT={}));var PT;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(PT||(PT={}));var iu;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(iu||(iu={}));class Lp{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Tc{get text(){var e,t,i,r,u,c,m,g;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",x=!1;const S=[];for(const C of(g=(m=(c=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)!==null&&g!==void 0?g:[]){for(const[M,F]of Object.entries(C))M!=="text"&&M!=="thought"&&M!=="thoughtSignature"&&(F!==null||F!==void 0)&&S.push(M);if(typeof C.text=="string"){if(typeof C.thought=="boolean"&&C.thought)continue;x=!0,p+=C.text}}return S.length>0&&console.warn(`there are non-text parts ${S} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),x?p:void 0}get data(){var e,t,i,r,u,c,m,g;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const x=[];for(const S of(g=(m=(c=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)!==null&&g!==void 0?g:[]){for(const[C,M]of Object.entries(S))C!=="inlineData"&&(M!==null||M!==void 0)&&x.push(C);S.inlineData&&typeof S.inlineData.data=="string"&&(p+=atob(S.inlineData.data))}return x.length>0&&console.warn(`there are non-data parts ${x} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,r,u,c,m,g;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(g=(m=(c=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)===null||g===void 0?void 0:g.filter(x=>x.functionCall).map(x=>x.functionCall).filter(x=>x!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,r,u,c,m,g,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const x=(g=(m=(c=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)===null||g===void 0?void 0:g.filter(S=>S.executableCode).map(S=>S.executableCode).filter(S=>S!==void 0);if((x==null?void 0:x.length)!==0)return(p=x==null?void 0:x[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,r,u,c,m,g,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const x=(g=(m=(c=(u=this.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content)===null||m===void 0?void 0:m.parts)===null||g===void 0?void 0:g.filter(S=>S.codeExecutionResult).map(S=>S.codeExecutionResult).filter(S=>S!==void 0);if((x==null?void 0:x.length)!==0)return(p=x==null?void 0:x[0])===null||p===void 0?void 0:p.output}}class kT{}class DT{}class Eb{}class xb{}class wb{}class Sb{}class LT{}class VT{}class OT{}class Ab{}class Nh{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Nh;let r;const u=e;return t?r=ub(u):r=lb(u),Object.assign(i,r),i}}class UT{}class zT{}class BT{}class Cb{}class bb{}class Ib{}class Tg{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Tg,u=gb(e);return Object.assign(i,u),i}}class Nb{}class Rb{}class Mb{}class FT{}class Pb{get text(){var e,t,i;let r="",u=!1;const c=[];for(const m of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[g,p]of Object.entries(m))g!=="text"&&g!=="thought"&&p!==null&&c.push(g);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;u=!0,r+=m.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),u?r:void 0}get data(){var e,t,i;let r="";const u=[];for(const c of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[m,g]of Object.entries(c))m!=="inlineData"&&g!==null&&u.push(m);c.inlineData&&typeof c.inlineData.data=="string"&&(r+=atob(c.inlineData.data))}return u.length>0&&console.warn(`there are non-data parts ${u} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class kb{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Eg{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Eg,u=Qx(e);return Object.assign(i,u),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function $x(n,e){const t=Pt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function Xx(n){return Array.isArray(n)?n.map(e=>Rh(e)):[Rh(n)]}function Rh(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function ew(n){const e=Rh(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function tw(n){const e=Rh(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function qT(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function nw(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>qT(e)):[qT(n)]}function Vp(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function HT(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function GT(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function di(n){if(n==null)throw new Error("ContentUnion is required");return Vp(n)?n:{role:"user",parts:nw(n)}}function xg(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=di(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=di(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>di(t)):[di(e)]}function Ps(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(HT(n)||GT(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[di(n)]}const e=[],t=[],i=Vp(n[0]);for(const r of n){const u=Vp(r);if(u!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(u)e.push(r);else{if(HT(r)||GT(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:nw(t)}),e}function Db(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(ta).includes(t[0].toUpperCase())?t[0].toUpperCase():ta.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(ta).includes(i.toUpperCase())?i.toUpperCase():ta.TYPE_UNSPECIFIED})}}function su(n){const e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const u=n.anyOf;u!=null&&u.length==2&&(u[0].type==="null"?(e.nullable=!0,n=u[1]):u[1].type==="null"&&(e.nullable=!0,n=u[0])),n.type instanceof Array&&Db(n.type,e);for(const[c,m]of Object.entries(n))if(m!=null)if(c=="type"){if(m==="null")throw new Error("type: null can not be the only possible type for the field.");if(m instanceof Array)continue;e.type=Object.values(ta).includes(m.toUpperCase())?m.toUpperCase():ta.TYPE_UNSPECIFIED}else if(t.includes(c))e[c]=su(m);else if(i.includes(c)){const g=[];for(const p of m){if(p.type=="null"){e.nullable=!0;continue}g.push(su(p))}e[c]=g}else if(r.includes(c)){const g={};for(const[p,x]of Object.entries(m))g[p]=su(x);e[c]=g}else{if(c==="additionalProperties")continue;e[c]=m}return e}function wg(n){return su(n)}function Sg(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function Ag(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function xu(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=su(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=su(e.response));return n}function wu(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function Lb(n,e,t,i=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function hr(n,e){if(typeof e!="string")throw new Error("name must be a string");return Lb(n,e,"cachedContents")}function iw(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function pa(n){return vg(n)}function Vb(n){return n!=null&&typeof n=="object"&&"name"in n}function Ob(n){return n!=null&&typeof n=="object"&&"video"in n}function Ub(n){return n!=null&&typeof n=="object"&&"uri"in n}function sw(n){var e;let t;if(Vb(n)&&(t=n.name),!(Ub(n)&&(t=n.uri,t===void 0))&&!(Ob(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function ow(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function rw(n){for(const e of["models","tunedModels","publisherModels"])if(zb(n,e))return n[e];return[]}function zb(n,e){return n!==null&&typeof n=="object"&&e in n}function Bb(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function Fb(n,e={}){const t=[],i=new Set;for(const r of n){const u=r.name;if(i.has(u))throw new Error(`Duplicate function name ${u} found in MCP tools. Please ensure function names are unique.`);i.add(u);const c=Bb(r,e);c.functionDeclarations&&t.push(...c.functionDeclarations)}return{functionDeclarations:t}}function aw(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function qb(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function lw(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let u=!1;for(const c of r){if(typeof c!="object"||c===null)continue;const g=c.response;if(typeof g!="object"||g===null)continue;if(g.embedding!==void 0){u=!0;break}}return u&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Su(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function uw(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Hb(n){const e={},t=f(n,["responsesFile"]);t!=null&&_(e,["fileName"],t);const i=f(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>wI(c))),_(e,["inlinedResponses"],u)}const r=f(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["inlinedEmbedContentResponses"],u)}return e}function Gb(n){const e={},t=f(n,["predictionsFormat"]);t!=null&&_(e,["format"],t);const i=f(n,["gcsDestination","outputUriPrefix"]);i!=null&&_(e,["gcsUri"],i);const r=f(n,["bigqueryDestination","outputUri"]);return r!=null&&_(e,["bigqueryUri"],r),e}function jb(n){const e={},t=f(n,["format"]);t!=null&&_(e,["predictionsFormat"],t);const i=f(n,["gcsUri"]);i!=null&&_(e,["gcsDestination","outputUriPrefix"],i);const r=f(n,["bigqueryUri"]);if(r!=null&&_(e,["bigqueryDestination","outputUri"],r),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function gh(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata","displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["metadata","state"]);r!=null&&_(e,["state"],uw(r));const u=f(n,["metadata","createTime"]);u!=null&&_(e,["createTime"],u);const c=f(n,["metadata","endTime"]);c!=null&&_(e,["endTime"],c);const m=f(n,["metadata","updateTime"]);m!=null&&_(e,["updateTime"],m);const g=f(n,["metadata","model"]);g!=null&&_(e,["model"],g);const p=f(n,["metadata","output"]);return p!=null&&_(e,["dest"],Hb(lw(p))),e}function Op(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["state"]);r!=null&&_(e,["state"],uw(r));const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["createTime"]);c!=null&&_(e,["createTime"],c);const m=f(n,["startTime"]);m!=null&&_(e,["startTime"],m);const g=f(n,["endTime"]);g!=null&&_(e,["endTime"],g);const p=f(n,["updateTime"]);p!=null&&_(e,["updateTime"],p);const x=f(n,["model"]);x!=null&&_(e,["model"],x);const S=f(n,["inputConfig"]);S!=null&&_(e,["src"],Kb(S));const C=f(n,["outputConfig"]);C!=null&&_(e,["dest"],Gb(lw(C)));const M=f(n,["completionStats"]);return M!=null&&_(e,["completionStats"],M),e}function Kb(n){const e={},t=f(n,["instancesFormat"]);t!=null&&_(e,["format"],t);const i=f(n,["gcsSource","uris"]);i!=null&&_(e,["gcsUri"],i);const r=f(n,["bigquerySource","inputUri"]);return r!=null&&_(e,["bigqueryUri"],r),e}function Zb(n,e){const t={};if(f(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=f(e,["fileName"]);i!=null&&_(t,["fileName"],i);const r=f(e,["inlinedRequests"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>xI(n,c))),_(t,["requests","requests"],u)}return t}function Yb(n){const e={},t=f(n,["format"]);t!=null&&_(e,["instancesFormat"],t);const i=f(n,["gcsUri"]);i!=null&&_(e,["gcsSource","uris"],i);const r=f(n,["bigqueryUri"]);if(r!=null&&_(e,["bigquerySource","inputUri"],r),f(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Wb(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function Jb(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Su(n,i)),t}function Qb(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Su(n,i)),t}function $b(n){const e={},t=f(n,["content"]);t!=null&&_(e,["content"],t);const i=f(n,["citationMetadata"]);i!=null&&_(e,["citationMetadata"],Xb(i));const r=f(n,["tokenCount"]);r!=null&&_(e,["tokenCount"],r);const u=f(n,["finishReason"]);u!=null&&_(e,["finishReason"],u);const c=f(n,["avgLogprobs"]);c!=null&&_(e,["avgLogprobs"],c);const m=f(n,["groundingMetadata"]);m!=null&&_(e,["groundingMetadata"],m);const g=f(n,["index"]);g!=null&&_(e,["index"],g);const p=f(n,["logprobsResult"]);p!=null&&_(e,["logprobsResult"],p);const x=f(n,["safetyRatings"]);if(x!=null){let C=x;Array.isArray(C)&&(C=C.map(M=>M)),_(e,["safetyRatings"],C)}const S=f(n,["urlContextMetadata"]);return S!=null&&_(e,["urlContextMetadata"],S),e}function Xb(n){const e={},t=f(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["citations"],i)}return e}function cw(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(u=>RI(u))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function eI(n,e){const t={},i=f(n,["displayName"]);if(e!==void 0&&i!=null&&_(e,["batch","displayName"],i),f(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function tI(n,e){const t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=f(n,["dest"]);return e!==void 0&&r!=null&&_(e,["outputConfig"],jb(qb(r))),t}function jT(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["src"]);r!=null&&_(t,["batch","inputConfig"],Zb(n,aw(n,r)));const u=f(e,["config"]);return u!=null&&eI(u,t),t}function nI(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["model"],Pt(n,i));const r=f(e,["src"]);r!=null&&_(t,["inputConfig"],Yb(aw(n,r)));const u=f(e,["config"]);return u!=null&&tI(u,t),t}function iI(n,e){const t={},i=f(n,["displayName"]);return e!==void 0&&i!=null&&_(e,["batch","displayName"],i),t}function sI(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["src"]);r!=null&&_(t,["batch","inputConfig"],dI(n,r));const u=f(e,["config"]);return u!=null&&iI(u,t),t}function oI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Su(n,i)),t}function rI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Su(n,i)),t}function aI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);return u!=null&&_(e,["error"],u),e}function lI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);return u!=null&&_(e,["error"],u),e}function uI(n,e){const t={},i=f(e,["contents"]);if(i!=null){let u=xg(n,i);Array.isArray(u)&&(u=u.map(c=>c)),_(t,["requests[]","request","content"],u)}const r=f(e,["config"]);return r!=null&&(_(t,["_self"],cI(r,t)),rb(t,{"requests[].*":"requests[].request.*"})),t}function cI(n,e){const t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&_(e,["requests[]","taskType"],i);const r=f(n,["title"]);e!==void 0&&r!=null&&_(e,["requests[]","title"],r);const u=f(n,["outputDimensionality"]);if(e!==void 0&&u!=null&&_(e,["requests[]","outputDimensionality"],u),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function dI(n,e){const t={},i=f(e,["fileName"]);i!=null&&_(t,["file_name"],i);const r=f(e,["inlinedRequests"]);return r!=null&&_(t,["requests"],uI(n,r)),t}function hI(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function fI(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function mI(n){const e={},t=f(n,["mode"]);t!=null&&_(e,["mode"],t);const i=f(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function pI(n,e,t){const i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],cw(di(r)));const u=f(e,["temperature"]);u!=null&&_(i,["temperature"],u);const c=f(e,["topP"]);c!=null&&_(i,["topP"],c);const m=f(e,["topK"]);m!=null&&_(i,["topK"],m);const g=f(e,["candidateCount"]);g!=null&&_(i,["candidateCount"],g);const p=f(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const x=f(e,["stopSequences"]);x!=null&&_(i,["stopSequences"],x);const S=f(e,["responseLogprobs"]);S!=null&&_(i,["responseLogprobs"],S);const C=f(e,["logprobs"]);C!=null&&_(i,["logprobs"],C);const M=f(e,["presencePenalty"]);M!=null&&_(i,["presencePenalty"],M);const F=f(e,["frequencyPenalty"]);F!=null&&_(i,["frequencyPenalty"],F);const H=f(e,["seed"]);H!=null&&_(i,["seed"],H);const Y=f(e,["responseMimeType"]);Y!=null&&_(i,["responseMimeType"],Y);const ie=f(e,["responseSchema"]);ie!=null&&_(i,["responseSchema"],wg(ie));const re=f(e,["responseJsonSchema"]);if(re!=null&&_(i,["responseJsonSchema"],re),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=f(e,["safetySettings"]);if(t!==void 0&&ee!=null){let K=ee;Array.isArray(K)&&(K=K.map(z=>MI(z))),_(t,["safetySettings"],K)}const Ee=f(e,["tools"]);if(t!==void 0&&Ee!=null){let K=wu(Ee);Array.isArray(K)&&(K=K.map(z=>kI(xu(z)))),_(t,["tools"],K)}const pe=f(e,["toolConfig"]);if(t!==void 0&&pe!=null&&_(t,["toolConfig"],PI(pe)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=f(e,["cachedContent"]);t!==void 0&&J!=null&&_(t,["cachedContent"],hr(n,J));const k=f(e,["responseModalities"]);k!=null&&_(i,["responseModalities"],k);const U=f(e,["mediaResolution"]);U!=null&&_(i,["mediaResolution"],U);const V=f(e,["speechConfig"]);if(V!=null&&_(i,["speechConfig"],Sg(V)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=f(e,["thinkingConfig"]);B!=null&&_(i,["thinkingConfig"],B);const q=f(e,["imageConfig"]);return q!=null&&_(i,["imageConfig"],EI(q)),i}function gI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(p=>$b(p))),_(e,["candidates"],g)}const r=f(n,["modelVersion"]);r!=null&&_(e,["modelVersion"],r);const u=f(n,["promptFeedback"]);u!=null&&_(e,["promptFeedback"],u);const c=f(n,["responseId"]);c!=null&&_(e,["responseId"],c);const m=f(n,["usageMetadata"]);return m!=null&&_(e,["usageMetadata"],m),e}function _I(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Su(n,i)),t}function yI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],Su(n,i)),t}function vI(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function TI(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function EI(n){const e={},t=f(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=f(n,["imageSize"]);if(i!=null&&_(e,["imageSize"],i),f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function xI(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["request","model"],Pt(n,i));const r=f(e,["contents"]);if(r!=null){let m=Ps(r);Array.isArray(m)&&(m=m.map(g=>cw(g))),_(t,["request","contents"],m)}const u=f(e,["metadata"]);u!=null&&_(t,["metadata"],u);const c=f(e,["config"]);return c!=null&&_(t,["request","generationConfig"],pI(n,c,f(t,["request"],{}))),t}function wI(n){const e={},t=f(n,["response"]);t!=null&&_(e,["response"],gI(t));const i=f(n,["error"]);return i!=null&&_(e,["error"],i),e}function SI(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);if(e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),f(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function AI(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);e!==void 0&&r!=null&&_(e,["_query","pageToken"],r);const u=f(n,["filter"]);return e!==void 0&&u!=null&&_(e,["_query","filter"],u),t}function CI(n){const e={},t=f(n,["config"]);return t!=null&&SI(t,e),e}function bI(n){const e={},t=f(n,["config"]);return t!=null&&AI(t,e),e}function II(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["operations"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>gh(c))),_(e,["batchJobs"],u)}return e}function NI(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["batchPredictionJobs"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>Op(c))),_(e,["batchJobs"],u)}return e}function RI(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const u=f(n,["fileData"]);u!=null&&_(e,["fileData"],hI(u));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],fI(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],Wb(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const x=f(n,["thought"]);x!=null&&_(e,["thought"],x);const S=f(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const C=f(n,["videoMetadata"]);return C!=null&&_(e,["videoMetadata"],C),e}function MI(n){const e={},t=f(n,["category"]);if(t!=null&&_(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=f(n,["threshold"]);return i!=null&&_(e,["threshold"],i),e}function PI(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],mI(t));const i=f(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function kI(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(S=>S)),_(e,["functionDeclarations"],x)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const u=f(n,["fileSearch"]);u!=null&&_(e,["fileSearch"],u);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],vI(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],TI(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var rr;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(rr||(rr={}));class dl{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,u;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let c={config:{}};!i||Object.keys(i).length===0?c={config:{}}:typeof i=="object"?c=Object.assign({},i):c=i,c.config&&(c.config.pageToken=t.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(u=(r=c.config)===null||r===void 0?void 0:r.pageSize)!==null&&u!==void 0?u:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DI extends dr{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new dl(rr.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=jT(this.apiClient,e),i=t._url,r=De("{model}:batchGenerateContent",i),m=t.batch.inputConfig.requests,g=m.requests,p=[];for(const x of g){const S=Object.assign({},x);if(S.systemInstruction){const C=S.systemInstruction;delete S.systemInstruction;const M=S.request;M.systemInstruction=C,S.request=M}p.push(S)}return m.requests=p,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const u=this.getGcsUri(e),c=this.getBigqueryUri(e);if(u)u.endsWith(".jsonl")?i.dest=`${u.slice(0,-6)}/dest`:i.dest=`${u}_dest_${r}`;else if(c)i.dest=`${c}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=nI(this.apiClient,e);return m=De("batchPredictionJobs",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>Op(x))}else{const p=jT(this.apiClient,e);return m=De("{model}:batchGenerateContent",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>gh(x))}}async createEmbeddingsInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=sI(this.apiClient,e);return u=De("{model}:asyncBatchEmbedContent",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>gh(g))}}async get(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=yI(this.apiClient,e);return m=De("batchPredictionJobs/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>Op(x))}else{const p=_I(this.apiClient,e);return m=De("batches/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>gh(x))}}async cancel(e){var t,i,r,u;let c="",m={};if(this.apiClient.isVertexAI()){const g=Qb(this.apiClient,e);c=De("batchPredictionJobs/{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=Jb(this.apiClient,e);c=De("batches/{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal})}}async listInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=bI(e);return m=De("batchPredictionJobs",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=NI(x),C=new FT;return Object.assign(C,S),C})}else{const p=CI(e);return m=De("batches",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=II(x),C=new FT;return Object.assign(C,S),C})}}async delete(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=rI(this.apiClient,e);return m=De("batchPredictionJobs/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>lI(x))}else{const p=oI(this.apiClient,e);return m=De("batches/{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>aI(x))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LI(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function KT(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(u=>s2(u))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function VI(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);e!==void 0&&r!=null&&_(e,["expireTime"],r);const u=f(n,["displayName"]);e!==void 0&&u!=null&&_(e,["displayName"],u);const c=f(n,["contents"]);if(e!==void 0&&c!=null){let x=Ps(c);Array.isArray(x)&&(x=x.map(S=>KT(S))),_(e,["contents"],x)}const m=f(n,["systemInstruction"]);e!==void 0&&m!=null&&_(e,["systemInstruction"],KT(di(m)));const g=f(n,["tools"]);if(e!==void 0&&g!=null){let x=g;Array.isArray(x)&&(x=x.map(S=>r2(S))),_(e,["tools"],x)}const p=f(n,["toolConfig"]);if(e!==void 0&&p!=null&&_(e,["toolConfig"],o2(p)),f(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function OI(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);e!==void 0&&r!=null&&_(e,["expireTime"],r);const u=f(n,["displayName"]);e!==void 0&&u!=null&&_(e,["displayName"],u);const c=f(n,["contents"]);if(e!==void 0&&c!=null){let S=Ps(c);Array.isArray(S)&&(S=S.map(C=>C)),_(e,["contents"],S)}const m=f(n,["systemInstruction"]);e!==void 0&&m!=null&&_(e,["systemInstruction"],di(m));const g=f(n,["tools"]);if(e!==void 0&&g!=null){let S=g;Array.isArray(S)&&(S=S.map(C=>a2(C))),_(e,["tools"],S)}const p=f(n,["toolConfig"]);e!==void 0&&p!=null&&_(e,["toolConfig"],p);const x=f(n,["kmsKeyName"]);return e!==void 0&&x!=null&&_(e,["encryption_spec","kmsKeyName"],x),t}function UI(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["model"],$x(n,i));const r=f(e,["config"]);return r!=null&&VI(r,t),t}function zI(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["model"],$x(n,i));const r=f(e,["config"]);return r!=null&&OI(r,t),t}function BI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],hr(n,i)),t}function FI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],hr(n,i)),t}function qI(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function HI(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function GI(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function jI(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function KI(n){const e={},t=f(n,["mode"]);t!=null&&_(e,["mode"],t);const i=f(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ZI(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&_(e,["description"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["parameters"]);r!=null&&_(e,["parameters"],r);const u=f(n,["parametersJsonSchema"]);u!=null&&_(e,["parametersJsonSchema"],u);const c=f(n,["response"]);c!=null&&_(e,["response"],c);const m=f(n,["responseJsonSchema"]);return m!=null&&_(e,["responseJsonSchema"],m),e}function YI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],hr(n,i)),t}function WI(n,e){const t={},i=f(e,["name"]);return i!=null&&_(t,["_url","name"],hr(n,i)),t}function JI(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function QI(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function $I(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function XI(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function e2(n){const e={},t=f(n,["config"]);return t!=null&&$I(t,e),e}function t2(n){const e={},t=f(n,["config"]);return t!=null&&XI(t,e),e}function n2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["cachedContents"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["cachedContents"],u)}return e}function i2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["cachedContents"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["cachedContents"],u)}return e}function s2(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const u=f(n,["fileData"]);u!=null&&_(e,["fileData"],GI(u));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],jI(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],LI(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const x=f(n,["thought"]);x!=null&&_(e,["thought"],x);const S=f(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const C=f(n,["videoMetadata"]);return C!=null&&_(e,["videoMetadata"],C),e}function o2(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],KI(t));const i=f(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function r2(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(S=>S)),_(e,["functionDeclarations"],x)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const u=f(n,["fileSearch"]);u!=null&&_(e,["fileSearch"],u);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],JI(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],QI(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function a2(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let S=t;Array.isArray(S)&&(S=S.map(C=>ZI(C))),_(e,["functionDeclarations"],S)}const i=f(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=f(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const u=f(n,["computerUse"]);if(u!=null&&_(e,["computerUse"],u),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=f(n,["codeExecution"]);c!=null&&_(e,["codeExecution"],c);const m=f(n,["enterpriseWebSearch"]);m!=null&&_(e,["enterpriseWebSearch"],m);const g=f(n,["googleMaps"]);g!=null&&_(e,["googleMaps"],g);const p=f(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const x=f(n,["urlContext"]);return x!=null&&_(e,["urlContext"],x),e}function l2(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);return e!==void 0&&r!=null&&_(e,["expireTime"],r),t}function u2(n,e){const t={},i=f(n,["ttl"]);e!==void 0&&i!=null&&_(e,["ttl"],i);const r=f(n,["expireTime"]);return e!==void 0&&r!=null&&_(e,["expireTime"],r),t}function c2(n,e){const t={},i=f(e,["name"]);i!=null&&_(t,["_url","name"],hr(n,i));const r=f(e,["config"]);return r!=null&&l2(r,t),t}function d2(n,e){const t={},i=f(e,["name"]);i!=null&&_(t,["_url","name"],hr(n,i));const r=f(e,["config"]);return r!=null&&u2(r,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class h2 extends dr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new dl(rr.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=zI(this.apiClient,e);return m=De("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>x)}else{const p=UI(this.apiClient,e);return m=De("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>x)}}async get(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=WI(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>x)}else{const p=YI(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>x)}}async delete(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=FI(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=HI(x),C=new zT;return Object.assign(C,S),C})}else{const p=BI(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=qI(x),C=new zT;return Object.assign(C,S),C})}}async update(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=d2(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>x)}else{const p=c2(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>x)}}async listInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=t2(e);return m=De("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=i2(x),C=new BT;return Object.assign(C,S),C})}else{const p=e2(e);return m=De("cachedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=n2(x),C=new BT;return Object.assign(C,S),C})}}}function ZT(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function sn(n){return this instanceof sn?(this.v=n,this):new sn(n)}function ou(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,u=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",c),r[Symbol.asyncIterator]=function(){return this},r;function c(M){return function(F){return Promise.resolve(F).then(M,S)}}function m(M,F){i[M]&&(r[M]=function(H){return new Promise(function(Y,ie){u.push([M,H,Y,ie])>1||g(M,H)})},F&&(r[M]=F(r[M])))}function g(M,F){try{p(i[M](F))}catch(H){C(u[0][3],H)}}function p(M){M.value instanceof sn?Promise.resolve(M.value.v).then(x,S):C(u[0][2],M)}function x(M){g("next",M)}function S(M){g("throw",M)}function C(M,F){M(F),u.shift(),u.length&&g(u[0][0],u[0][1])}}function bc(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ZT=="function"?ZT(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(u){t[u]=n[u]&&function(c){return new Promise(function(m,g){c=n[u](c),r(m,g,c.done,c.value)})}}function r(u,c,m,g){Promise.resolve(g).then(function(p){u({value:p,done:m})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f2(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:dw(t)}function dw(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function m2(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function YT(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const r=[];let u=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),u&&!dw(n[i])&&(u=!1),i++;u?e.push(...r):e.pop()}return e}class p2{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new g2(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class g2{constructor(e,t,i,r={},u=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=u,this.sendPromise=Promise.resolve(),m2(u)}async sendMessage(e){var t;await this.sendPromise;const i=di(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var u,c,m;const g=await r,p=(c=(u=g.candidates)===null||u===void 0?void 0:u[0])===null||c===void 0?void 0:c.content,x=g.automaticFunctionCallingHistory,S=this.getHistory(!0).length;let C=[];x!=null&&(C=(m=x.slice(S))!==null&&m!==void 0?m:[]);const M=p?[p]:[];this.recordHistory(i,M,C)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const i=di(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const u=await r;return this.processStreamResponse(u,i)}getHistory(e=!1){const t=e?YT(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,r;return ou(this,arguments,function*(){var c,m,g,p;const x=[];try{for(var S=!0,C=bc(e),M;M=yield sn(C.next()),c=M.done,!c;S=!0){p=M.value,S=!1;const F=p;if(f2(F)){const H=(r=(i=F.candidates)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.content;H!==void 0&&x.push(H)}yield yield sn(F)}}catch(F){m={error:F}}finally{try{!S&&!c&&(g=C.return)&&(yield sn(g.call(C)))}finally{if(m)throw m.error}}this.recordHistory(t,x)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(u=>u.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...YT(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $h extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,$h.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _2(n){const e={},t=f(n,["file"]);return t!=null&&_(e,["file"],t),e}function y2(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function v2(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","file"],sw(t)),e}function T2(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function E2(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","file"],sw(t)),e}function x2(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function w2(n){const e={},t=f(n,["config"]);return t!=null&&x2(t,e),e}function S2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["files"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["files"],u)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class A2 extends dr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new dl(rr.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=w2(e);return u=De("files",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>{const p=S2(g),x=new Nb;return Object.assign(x,p),x})}}async createInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=_2(e);return u=De("upload/v1beta/files",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=y2(g),x=new Rb;return Object.assign(x,p),x})}}async get(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=E2(e);return u=De("files/{file}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async delete(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=v2(e);return u=De("files/{file}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>{const p=T2(g),x=new Mb;return Object.assign(x,p),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _h(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function C2(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(u=>q2(u))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function b2(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function I2(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function N2(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&_(e,["description"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["parameters"]);r!=null&&_(e,["parameters"],r);const u=f(n,["parametersJsonSchema"]);u!=null&&_(e,["parametersJsonSchema"],u);const c=f(n,["response"]);c!=null&&_(e,["response"],c);const m=f(n,["responseJsonSchema"]);return m!=null&&_(e,["responseJsonSchema"],m),e}function R2(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&_(e,["modelConfig"],t);const i=f(n,["responseJsonSchema"]);i!=null&&_(e,["responseJsonSchema"],i);const r=f(n,["audioTimestamp"]);r!=null&&_(e,["audioTimestamp"],r);const u=f(n,["candidateCount"]);u!=null&&_(e,["candidateCount"],u);const c=f(n,["enableAffectiveDialog"]);c!=null&&_(e,["enableAffectiveDialog"],c);const m=f(n,["frequencyPenalty"]);m!=null&&_(e,["frequencyPenalty"],m);const g=f(n,["logprobs"]);g!=null&&_(e,["logprobs"],g);const p=f(n,["maxOutputTokens"]);p!=null&&_(e,["maxOutputTokens"],p);const x=f(n,["mediaResolution"]);x!=null&&_(e,["mediaResolution"],x);const S=f(n,["presencePenalty"]);S!=null&&_(e,["presencePenalty"],S);const C=f(n,["responseLogprobs"]);C!=null&&_(e,["responseLogprobs"],C);const M=f(n,["responseMimeType"]);M!=null&&_(e,["responseMimeType"],M);const F=f(n,["responseModalities"]);F!=null&&_(e,["responseModalities"],F);const H=f(n,["responseSchema"]);H!=null&&_(e,["responseSchema"],H);const Y=f(n,["routingConfig"]);Y!=null&&_(e,["routingConfig"],Y);const ie=f(n,["seed"]);ie!=null&&_(e,["seed"],ie);const re=f(n,["speechConfig"]);re!=null&&_(e,["speechConfig"],hw(re));const ee=f(n,["stopSequences"]);ee!=null&&_(e,["stopSequences"],ee);const Ee=f(n,["temperature"]);Ee!=null&&_(e,["temperature"],Ee);const pe=f(n,["thinkingConfig"]);pe!=null&&_(e,["thinkingConfig"],pe);const J=f(n,["topK"]);J!=null&&_(e,["topK"],J);const k=f(n,["topP"]);if(k!=null&&_(e,["topP"],k),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function M2(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function P2(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function k2(n,e){const t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],i);const r=f(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const u=f(n,["temperature"]);e!==void 0&&u!=null&&_(e,["setup","generationConfig","temperature"],u);const c=f(n,["topP"]);e!==void 0&&c!=null&&_(e,["setup","generationConfig","topP"],c);const m=f(n,["topK"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","topK"],m);const g=f(n,["maxOutputTokens"]);e!==void 0&&g!=null&&_(e,["setup","generationConfig","maxOutputTokens"],g);const p=f(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const x=f(n,["seed"]);e!==void 0&&x!=null&&_(e,["setup","generationConfig","seed"],x);const S=f(n,["speechConfig"]);e!==void 0&&S!=null&&_(e,["setup","generationConfig","speechConfig"],Ag(S));const C=f(n,["thinkingConfig"]);e!==void 0&&C!=null&&_(e,["setup","generationConfig","thinkingConfig"],C);const M=f(n,["enableAffectiveDialog"]);e!==void 0&&M!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],M);const F=f(n,["systemInstruction"]);e!==void 0&&F!=null&&_(e,["setup","systemInstruction"],C2(di(F)));const H=f(n,["tools"]);if(e!==void 0&&H!=null){let J=wu(H);Array.isArray(J)&&(J=J.map(k=>G2(xu(k)))),_(e,["setup","tools"],J)}const Y=f(n,["sessionResumption"]);e!==void 0&&Y!=null&&_(e,["setup","sessionResumption"],H2(Y));const ie=f(n,["inputAudioTranscription"]);e!==void 0&&ie!=null&&_(e,["setup","inputAudioTranscription"],ie);const re=f(n,["outputAudioTranscription"]);e!==void 0&&re!=null&&_(e,["setup","outputAudioTranscription"],re);const ee=f(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&_(e,["setup","realtimeInputConfig"],ee);const Ee=f(n,["contextWindowCompression"]);e!==void 0&&Ee!=null&&_(e,["setup","contextWindowCompression"],Ee);const pe=f(n,["proactivity"]);return e!==void 0&&pe!=null&&_(e,["setup","proactivity"],pe),t}function D2(n,e){const t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],R2(i));const r=f(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const u=f(n,["temperature"]);e!==void 0&&u!=null&&_(e,["setup","generationConfig","temperature"],u);const c=f(n,["topP"]);e!==void 0&&c!=null&&_(e,["setup","generationConfig","topP"],c);const m=f(n,["topK"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","topK"],m);const g=f(n,["maxOutputTokens"]);e!==void 0&&g!=null&&_(e,["setup","generationConfig","maxOutputTokens"],g);const p=f(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const x=f(n,["seed"]);e!==void 0&&x!=null&&_(e,["setup","generationConfig","seed"],x);const S=f(n,["speechConfig"]);e!==void 0&&S!=null&&_(e,["setup","generationConfig","speechConfig"],hw(Ag(S)));const C=f(n,["thinkingConfig"]);e!==void 0&&C!=null&&_(e,["setup","generationConfig","thinkingConfig"],C);const M=f(n,["enableAffectiveDialog"]);e!==void 0&&M!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],M);const F=f(n,["systemInstruction"]);e!==void 0&&F!=null&&_(e,["setup","systemInstruction"],di(F));const H=f(n,["tools"]);if(e!==void 0&&H!=null){let J=wu(H);Array.isArray(J)&&(J=J.map(k=>j2(xu(k)))),_(e,["setup","tools"],J)}const Y=f(n,["sessionResumption"]);e!==void 0&&Y!=null&&_(e,["setup","sessionResumption"],Y);const ie=f(n,["inputAudioTranscription"]);e!==void 0&&ie!=null&&_(e,["setup","inputAudioTranscription"],ie);const re=f(n,["outputAudioTranscription"]);e!==void 0&&re!=null&&_(e,["setup","outputAudioTranscription"],re);const ee=f(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&_(e,["setup","realtimeInputConfig"],ee);const Ee=f(n,["contextWindowCompression"]);e!==void 0&&Ee!=null&&_(e,["setup","contextWindowCompression"],Ee);const pe=f(n,["proactivity"]);return e!==void 0&&pe!=null&&_(e,["setup","proactivity"],pe),t}function L2(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["setup","model"],Pt(n,i));const r=f(e,["config"]);return r!=null&&_(t,["config"],k2(r,t)),t}function V2(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["setup","model"],Pt(n,i));const r=f(e,["config"]);return r!=null&&_(t,["config"],D2(r,t)),t}function O2(n){const e={},t=f(n,["musicGenerationConfig"]);return t!=null&&_(e,["musicGenerationConfig"],t),e}function U2(n){const e={},t=f(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["weightedPrompts"],i)}return e}function z2(n){const e={},t=f(n,["media"]);if(t!=null){let p=Xx(t);Array.isArray(p)&&(p=p.map(x=>_h(x))),_(e,["mediaChunks"],p)}const i=f(n,["audio"]);i!=null&&_(e,["audio"],_h(tw(i)));const r=f(n,["audioStreamEnd"]);r!=null&&_(e,["audioStreamEnd"],r);const u=f(n,["video"]);u!=null&&_(e,["video"],_h(ew(u)));const c=f(n,["text"]);c!=null&&_(e,["text"],c);const m=f(n,["activityStart"]);m!=null&&_(e,["activityStart"],m);const g=f(n,["activityEnd"]);return g!=null&&_(e,["activityEnd"],g),e}function B2(n){const e={},t=f(n,["media"]);if(t!=null){let p=Xx(t);Array.isArray(p)&&(p=p.map(x=>x)),_(e,["mediaChunks"],p)}const i=f(n,["audio"]);i!=null&&_(e,["audio"],tw(i));const r=f(n,["audioStreamEnd"]);r!=null&&_(e,["audioStreamEnd"],r);const u=f(n,["video"]);u!=null&&_(e,["video"],ew(u));const c=f(n,["text"]);c!=null&&_(e,["text"],c);const m=f(n,["activityStart"]);m!=null&&_(e,["activityStart"],m);const g=f(n,["activityEnd"]);return g!=null&&_(e,["activityEnd"],g),e}function F2(n){const e={},t=f(n,["setupComplete"]);t!=null&&_(e,["setupComplete"],t);const i=f(n,["serverContent"]);i!=null&&_(e,["serverContent"],i);const r=f(n,["toolCall"]);r!=null&&_(e,["toolCall"],r);const u=f(n,["toolCallCancellation"]);u!=null&&_(e,["toolCallCancellation"],u);const c=f(n,["usageMetadata"]);c!=null&&_(e,["usageMetadata"],K2(c));const m=f(n,["goAway"]);m!=null&&_(e,["goAway"],m);const g=f(n,["sessionResumptionUpdate"]);return g!=null&&_(e,["sessionResumptionUpdate"],g),e}function q2(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const u=f(n,["fileData"]);u!=null&&_(e,["fileData"],b2(u));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],I2(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],_h(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const x=f(n,["thought"]);x!=null&&_(e,["thought"],x);const S=f(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const C=f(n,["videoMetadata"]);return C!=null&&_(e,["videoMetadata"],C),e}function H2(n){const e={},t=f(n,["handle"]);if(t!=null&&_(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function hw(n){const e={},t=f(n,["languageCode"]);t!=null&&_(e,["languageCode"],t);const i=f(n,["voiceConfig"]);if(i!=null&&_(e,["voiceConfig"],i),f(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function G2(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(S=>S)),_(e,["functionDeclarations"],x)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const u=f(n,["fileSearch"]);u!=null&&_(e,["fileSearch"],u);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],M2(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],P2(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function j2(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let S=t;Array.isArray(S)&&(S=S.map(C=>N2(C))),_(e,["functionDeclarations"],S)}const i=f(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=f(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const u=f(n,["computerUse"]);if(u!=null&&_(e,["computerUse"],u),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=f(n,["codeExecution"]);c!=null&&_(e,["codeExecution"],c);const m=f(n,["enterpriseWebSearch"]);m!=null&&_(e,["enterpriseWebSearch"],m);const g=f(n,["googleMaps"]);g!=null&&_(e,["googleMaps"],g);const p=f(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const x=f(n,["urlContext"]);return x!=null&&_(e,["urlContext"],x),e}function K2(n){const e={},t=f(n,["promptTokenCount"]);t!=null&&_(e,["promptTokenCount"],t);const i=f(n,["cachedContentTokenCount"]);i!=null&&_(e,["cachedContentTokenCount"],i);const r=f(n,["candidatesTokenCount"]);r!=null&&_(e,["responseTokenCount"],r);const u=f(n,["toolUsePromptTokenCount"]);u!=null&&_(e,["toolUsePromptTokenCount"],u);const c=f(n,["thoughtsTokenCount"]);c!=null&&_(e,["thoughtsTokenCount"],c);const m=f(n,["totalTokenCount"]);m!=null&&_(e,["totalTokenCount"],m);const g=f(n,["promptTokensDetails"]);if(g!=null){let M=g;Array.isArray(M)&&(M=M.map(F=>F)),_(e,["promptTokensDetails"],M)}const p=f(n,["cacheTokensDetails"]);if(p!=null){let M=p;Array.isArray(M)&&(M=M.map(F=>F)),_(e,["cacheTokensDetails"],M)}const x=f(n,["candidatesTokensDetails"]);if(x!=null){let M=x;Array.isArray(M)&&(M=M.map(F=>F)),_(e,["responseTokensDetails"],M)}const S=f(n,["toolUsePromptTokensDetails"]);if(S!=null){let M=S;Array.isArray(M)&&(M=M.map(F=>F)),_(e,["toolUsePromptTokensDetails"],M)}const C=f(n,["trafficType"]);return C!=null&&_(e,["trafficType"],C),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Z2(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function Y2(n){const e={},t=f(n,["content"]);t!=null&&_(e,["content"],t);const i=f(n,["citationMetadata"]);i!=null&&_(e,["citationMetadata"],W2(i));const r=f(n,["tokenCount"]);r!=null&&_(e,["tokenCount"],r);const u=f(n,["finishReason"]);u!=null&&_(e,["finishReason"],u);const c=f(n,["avgLogprobs"]);c!=null&&_(e,["avgLogprobs"],c);const m=f(n,["groundingMetadata"]);m!=null&&_(e,["groundingMetadata"],m);const g=f(n,["index"]);g!=null&&_(e,["index"],g);const p=f(n,["logprobsResult"]);p!=null&&_(e,["logprobsResult"],p);const x=f(n,["safetyRatings"]);if(x!=null){let C=x;Array.isArray(C)&&(C=C.map(M=>M)),_(e,["safetyRatings"],C)}const S=f(n,["urlContextMetadata"]);return S!=null&&_(e,["urlContextMetadata"],S),e}function W2(n){const e={},t=f(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),_(e,["citations"],i)}return e}function J2(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["contents"]);if(r!=null){let u=Ps(r);Array.isArray(u)&&(u=u.map(c=>c)),_(t,["contents"],u)}return t}function Q2(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["tokensInfo"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(u=>u)),_(e,["tokensInfo"],r)}return e}function $2(n){const e={},t=f(n,["values"]);t!=null&&_(e,["values"],t);const i=f(n,["statistics"]);return i!=null&&_(e,["statistics"],X2(i)),e}function X2(n){const e={},t=f(n,["truncated"]);t!=null&&_(e,["truncated"],t);const i=f(n,["token_count"]);return i!=null&&_(e,["tokenCount"],i),e}function Xh(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(u=>lR(u))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function eN(n){const e={},t=f(n,["controlType"]);t!=null&&_(e,["controlType"],t);const i=f(n,["enableControlImageComputation"]);return i!=null&&_(e,["computeControl"],i),e}function tN(n){const e={};if(f(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function nN(n,e){const t={},i=f(n,["systemInstruction"]);e!==void 0&&i!=null&&_(e,["systemInstruction"],di(i));const r=f(n,["tools"]);if(e!==void 0&&r!=null){let c=r;Array.isArray(c)&&(c=c.map(m=>_w(m))),_(e,["tools"],c)}const u=f(n,["generationConfig"]);return e!==void 0&&u!=null&&_(e,["generationConfig"],ZN(u)),t}function iN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ps(r);Array.isArray(c)&&(c=c.map(m=>Xh(m))),_(t,["contents"],c)}const u=f(e,["config"]);return u!=null&&tN(u),t}function sN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ps(r);Array.isArray(c)&&(c=c.map(m=>m)),_(t,["contents"],c)}const u=f(e,["config"]);return u!=null&&nN(u,t),t}function oN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["totalTokens"]);i!=null&&_(e,["totalTokens"],i);const r=f(n,["cachedContentTokenCount"]);return r!=null&&_(e,["cachedContentTokenCount"],r),e}function rN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["totalTokens"]);return i!=null&&_(e,["totalTokens"],i),e}function aN(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Pt(n,i)),t}function lN(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Pt(n,i)),t}function uN(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function cN(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}function dN(n,e){const t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=f(n,["negativePrompt"]);e!==void 0&&r!=null&&_(e,["parameters","negativePrompt"],r);const u=f(n,["numberOfImages"]);e!==void 0&&u!=null&&_(e,["parameters","sampleCount"],u);const c=f(n,["aspectRatio"]);e!==void 0&&c!=null&&_(e,["parameters","aspectRatio"],c);const m=f(n,["guidanceScale"]);e!==void 0&&m!=null&&_(e,["parameters","guidanceScale"],m);const g=f(n,["seed"]);e!==void 0&&g!=null&&_(e,["parameters","seed"],g);const p=f(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&_(e,["parameters","safetySetting"],p);const x=f(n,["personGeneration"]);e!==void 0&&x!=null&&_(e,["parameters","personGeneration"],x);const S=f(n,["includeSafetyAttributes"]);e!==void 0&&S!=null&&_(e,["parameters","includeSafetyAttributes"],S);const C=f(n,["includeRaiReason"]);e!==void 0&&C!=null&&_(e,["parameters","includeRaiReason"],C);const M=f(n,["language"]);e!==void 0&&M!=null&&_(e,["parameters","language"],M);const F=f(n,["outputMimeType"]);e!==void 0&&F!=null&&_(e,["parameters","outputOptions","mimeType"],F);const H=f(n,["outputCompressionQuality"]);e!==void 0&&H!=null&&_(e,["parameters","outputOptions","compressionQuality"],H);const Y=f(n,["addWatermark"]);e!==void 0&&Y!=null&&_(e,["parameters","addWatermark"],Y);const ie=f(n,["labels"]);e!==void 0&&ie!=null&&_(e,["labels"],ie);const re=f(n,["editMode"]);e!==void 0&&re!=null&&_(e,["parameters","editMode"],re);const ee=f(n,["baseSteps"]);return e!==void 0&&ee!=null&&_(e,["parameters","editConfig","baseSteps"],ee),t}function hN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const u=f(e,["referenceImages"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>mR(g))),_(t,["instances[0]","referenceImages"],m)}const c=f(e,["config"]);return c!=null&&dN(c,t),t}function fN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(u=>ef(u))),_(e,["generatedImages"],r)}return e}function mN(n,e){const t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&_(e,["requests[]","taskType"],i);const r=f(n,["title"]);e!==void 0&&r!=null&&_(e,["requests[]","title"],r);const u=f(n,["outputDimensionality"]);if(e!==void 0&&u!=null&&_(e,["requests[]","outputDimensionality"],u),f(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function pN(n,e){const t={},i=f(n,["taskType"]);e!==void 0&&i!=null&&_(e,["instances[]","task_type"],i);const r=f(n,["title"]);e!==void 0&&r!=null&&_(e,["instances[]","title"],r);const u=f(n,["outputDimensionality"]);e!==void 0&&u!=null&&_(e,["parameters","outputDimensionality"],u);const c=f(n,["mimeType"]);e!==void 0&&c!=null&&_(e,["instances[]","mimeType"],c);const m=f(n,["autoTruncate"]);return e!==void 0&&m!=null&&_(e,["parameters","autoTruncate"],m),t}function gN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["contents"]);if(r!=null){let m=xg(n,r);Array.isArray(m)&&(m=m.map(g=>g)),_(t,["requests[]","content"],m)}const u=f(e,["config"]);u!=null&&mN(u,t);const c=f(e,["model"]);return c!==void 0&&_(t,["requests[]","model"],Pt(n,c)),t}function _N(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["contents"]);if(r!=null){let c=xg(n,r);Array.isArray(c)&&(c=c.map(m=>m)),_(t,["instances[]","content"],c)}const u=f(e,["config"]);return u!=null&&pN(u,t),t}function yN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["embeddings"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["embeddings"],u)}const r=f(n,["metadata"]);return r!=null&&_(e,["metadata"],r),e}function vN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions[]","embeddings"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>$2(c))),_(e,["embeddings"],u)}const r=f(n,["metadata"]);return r!=null&&_(e,["metadata"],r),e}function TN(n){const e={},t=f(n,["endpoint"]);t!=null&&_(e,["name"],t);const i=f(n,["deployedModelId"]);return i!=null&&_(e,["deployedModelId"],i),e}function EN(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function xN(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function wN(n){const e={},t=f(n,["mode"]);t!=null&&_(e,["mode"],t);const i=f(n,["allowedFunctionNames"]);if(i!=null&&_(e,["allowedFunctionNames"],i),f(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function SN(n){const e={};if(f(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=f(n,["description"]);t!=null&&_(e,["description"],t);const i=f(n,["name"]);i!=null&&_(e,["name"],i);const r=f(n,["parameters"]);r!=null&&_(e,["parameters"],r);const u=f(n,["parametersJsonSchema"]);u!=null&&_(e,["parametersJsonSchema"],u);const c=f(n,["response"]);c!=null&&_(e,["response"],c);const m=f(n,["responseJsonSchema"]);return m!=null&&_(e,["responseJsonSchema"],m),e}function AN(n,e,t){const i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],Xh(di(r)));const u=f(e,["temperature"]);u!=null&&_(i,["temperature"],u);const c=f(e,["topP"]);c!=null&&_(i,["topP"],c);const m=f(e,["topK"]);m!=null&&_(i,["topK"],m);const g=f(e,["candidateCount"]);g!=null&&_(i,["candidateCount"],g);const p=f(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const x=f(e,["stopSequences"]);x!=null&&_(i,["stopSequences"],x);const S=f(e,["responseLogprobs"]);S!=null&&_(i,["responseLogprobs"],S);const C=f(e,["logprobs"]);C!=null&&_(i,["logprobs"],C);const M=f(e,["presencePenalty"]);M!=null&&_(i,["presencePenalty"],M);const F=f(e,["frequencyPenalty"]);F!=null&&_(i,["frequencyPenalty"],F);const H=f(e,["seed"]);H!=null&&_(i,["seed"],H);const Y=f(e,["responseMimeType"]);Y!=null&&_(i,["responseMimeType"],Y);const ie=f(e,["responseSchema"]);ie!=null&&_(i,["responseSchema"],wg(ie));const re=f(e,["responseJsonSchema"]);if(re!=null&&_(i,["responseJsonSchema"],re),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const ee=f(e,["safetySettings"]);if(t!==void 0&&ee!=null){let K=ee;Array.isArray(K)&&(K=K.map(z=>pR(z))),_(t,["safetySettings"],K)}const Ee=f(e,["tools"]);if(t!==void 0&&Ee!=null){let K=wu(Ee);Array.isArray(K)&&(K=K.map(z=>xR(xu(z)))),_(t,["tools"],K)}const pe=f(e,["toolConfig"]);if(t!==void 0&&pe!=null&&_(t,["toolConfig"],ER(pe)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const J=f(e,["cachedContent"]);t!==void 0&&J!=null&&_(t,["cachedContent"],hr(n,J));const k=f(e,["responseModalities"]);k!=null&&_(i,["responseModalities"],k);const U=f(e,["mediaResolution"]);U!=null&&_(i,["mediaResolution"],U);const V=f(e,["speechConfig"]);if(V!=null&&_(i,["speechConfig"],Sg(V)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=f(e,["thinkingConfig"]);B!=null&&_(i,["thinkingConfig"],B);const q=f(e,["imageConfig"]);return q!=null&&_(i,["imageConfig"],$N(q)),i}function CN(n,e,t){const i={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&_(t,["systemInstruction"],di(r));const u=f(e,["temperature"]);u!=null&&_(i,["temperature"],u);const c=f(e,["topP"]);c!=null&&_(i,["topP"],c);const m=f(e,["topK"]);m!=null&&_(i,["topK"],m);const g=f(e,["candidateCount"]);g!=null&&_(i,["candidateCount"],g);const p=f(e,["maxOutputTokens"]);p!=null&&_(i,["maxOutputTokens"],p);const x=f(e,["stopSequences"]);x!=null&&_(i,["stopSequences"],x);const S=f(e,["responseLogprobs"]);S!=null&&_(i,["responseLogprobs"],S);const C=f(e,["logprobs"]);C!=null&&_(i,["logprobs"],C);const M=f(e,["presencePenalty"]);M!=null&&_(i,["presencePenalty"],M);const F=f(e,["frequencyPenalty"]);F!=null&&_(i,["frequencyPenalty"],F);const H=f(e,["seed"]);H!=null&&_(i,["seed"],H);const Y=f(e,["responseMimeType"]);Y!=null&&_(i,["responseMimeType"],Y);const ie=f(e,["responseSchema"]);ie!=null&&_(i,["responseSchema"],wg(ie));const re=f(e,["responseJsonSchema"]);re!=null&&_(i,["responseJsonSchema"],re);const ee=f(e,["routingConfig"]);ee!=null&&_(i,["routingConfig"],ee);const Ee=f(e,["modelSelectionConfig"]);Ee!=null&&_(i,["modelConfig"],Ee);const pe=f(e,["safetySettings"]);if(t!==void 0&&pe!=null){let te=pe;Array.isArray(te)&&(te=te.map(Se=>Se)),_(t,["safetySettings"],te)}const J=f(e,["tools"]);if(t!==void 0&&J!=null){let te=wu(J);Array.isArray(te)&&(te=te.map(Se=>_w(xu(Se)))),_(t,["tools"],te)}const k=f(e,["toolConfig"]);t!==void 0&&k!=null&&_(t,["toolConfig"],k);const U=f(e,["labels"]);t!==void 0&&U!=null&&_(t,["labels"],U);const V=f(e,["cachedContent"]);t!==void 0&&V!=null&&_(t,["cachedContent"],hr(n,V));const B=f(e,["responseModalities"]);B!=null&&_(i,["responseModalities"],B);const q=f(e,["mediaResolution"]);q!=null&&_(i,["mediaResolution"],q);const K=f(e,["speechConfig"]);K!=null&&_(i,["speechConfig"],gw(Sg(K)));const z=f(e,["audioTimestamp"]);z!=null&&_(i,["audioTimestamp"],z);const Le=f(e,["thinkingConfig"]);Le!=null&&_(i,["thinkingConfig"],Le);const Xe=f(e,["imageConfig"]);return Xe!=null&&_(i,["imageConfig"],XN(Xe)),i}function WT(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ps(r);Array.isArray(c)&&(c=c.map(m=>Xh(m))),_(t,["contents"],c)}const u=f(e,["config"]);return u!=null&&_(t,["generationConfig"],AN(n,u,t)),t}function JT(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["contents"]);if(r!=null){let c=Ps(r);Array.isArray(c)&&(c=c.map(m=>m)),_(t,["contents"],c)}const u=f(e,["config"]);return u!=null&&_(t,["generationConfig"],CN(n,u,t)),t}function QT(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["candidates"]);if(i!=null){let g=i;Array.isArray(g)&&(g=g.map(p=>Y2(p))),_(e,["candidates"],g)}const r=f(n,["modelVersion"]);r!=null&&_(e,["modelVersion"],r);const u=f(n,["promptFeedback"]);u!=null&&_(e,["promptFeedback"],u);const c=f(n,["responseId"]);c!=null&&_(e,["responseId"],c);const m=f(n,["usageMetadata"]);return m!=null&&_(e,["usageMetadata"],m),e}function $T(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(x=>x)),_(e,["candidates"],p)}const r=f(n,["createTime"]);r!=null&&_(e,["createTime"],r);const u=f(n,["modelVersion"]);u!=null&&_(e,["modelVersion"],u);const c=f(n,["promptFeedback"]);c!=null&&_(e,["promptFeedback"],c);const m=f(n,["responseId"]);m!=null&&_(e,["responseId"],m);const g=f(n,["usageMetadata"]);return g!=null&&_(e,["usageMetadata"],g),e}function bN(n,e){const t={};if(f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=f(n,["numberOfImages"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=f(n,["aspectRatio"]);e!==void 0&&r!=null&&_(e,["parameters","aspectRatio"],r);const u=f(n,["guidanceScale"]);if(e!==void 0&&u!=null&&_(e,["parameters","guidanceScale"],u),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=f(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&_(e,["parameters","safetySetting"],c);const m=f(n,["personGeneration"]);e!==void 0&&m!=null&&_(e,["parameters","personGeneration"],m);const g=f(n,["includeSafetyAttributes"]);e!==void 0&&g!=null&&_(e,["parameters","includeSafetyAttributes"],g);const p=f(n,["includeRaiReason"]);e!==void 0&&p!=null&&_(e,["parameters","includeRaiReason"],p);const x=f(n,["language"]);e!==void 0&&x!=null&&_(e,["parameters","language"],x);const S=f(n,["outputMimeType"]);e!==void 0&&S!=null&&_(e,["parameters","outputOptions","mimeType"],S);const C=f(n,["outputCompressionQuality"]);if(e!==void 0&&C!=null&&_(e,["parameters","outputOptions","compressionQuality"],C),f(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=f(n,["imageSize"]);if(e!==void 0&&M!=null&&_(e,["parameters","sampleImageSize"],M),f(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function IN(n,e){const t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=f(n,["negativePrompt"]);e!==void 0&&r!=null&&_(e,["parameters","negativePrompt"],r);const u=f(n,["numberOfImages"]);e!==void 0&&u!=null&&_(e,["parameters","sampleCount"],u);const c=f(n,["aspectRatio"]);e!==void 0&&c!=null&&_(e,["parameters","aspectRatio"],c);const m=f(n,["guidanceScale"]);e!==void 0&&m!=null&&_(e,["parameters","guidanceScale"],m);const g=f(n,["seed"]);e!==void 0&&g!=null&&_(e,["parameters","seed"],g);const p=f(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&_(e,["parameters","safetySetting"],p);const x=f(n,["personGeneration"]);e!==void 0&&x!=null&&_(e,["parameters","personGeneration"],x);const S=f(n,["includeSafetyAttributes"]);e!==void 0&&S!=null&&_(e,["parameters","includeSafetyAttributes"],S);const C=f(n,["includeRaiReason"]);e!==void 0&&C!=null&&_(e,["parameters","includeRaiReason"],C);const M=f(n,["language"]);e!==void 0&&M!=null&&_(e,["parameters","language"],M);const F=f(n,["outputMimeType"]);e!==void 0&&F!=null&&_(e,["parameters","outputOptions","mimeType"],F);const H=f(n,["outputCompressionQuality"]);e!==void 0&&H!=null&&_(e,["parameters","outputOptions","compressionQuality"],H);const Y=f(n,["addWatermark"]);e!==void 0&&Y!=null&&_(e,["parameters","addWatermark"],Y);const ie=f(n,["labels"]);e!==void 0&&ie!=null&&_(e,["labels"],ie);const re=f(n,["imageSize"]);e!==void 0&&re!=null&&_(e,["parameters","sampleImageSize"],re);const ee=f(n,["enhancePrompt"]);return e!==void 0&&ee!=null&&_(e,["parameters","enhancePrompt"],ee),t}function NN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const u=f(e,["config"]);return u!=null&&bN(u,t),t}function RN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const u=f(e,["config"]);return u!=null&&IN(u,t),t}function MN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>HN(c))),_(e,["generatedImages"],u)}const r=f(n,["positivePromptSafetyAttributes"]);return r!=null&&_(e,["positivePromptSafetyAttributes"],mw(r)),e}function PN(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>ef(c))),_(e,["generatedImages"],u)}const r=f(n,["positivePromptSafetyAttributes"]);return r!=null&&_(e,["positivePromptSafetyAttributes"],pw(r)),e}function kN(n,e){const t={},i=f(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i),f(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=f(n,["durationSeconds"]);if(e!==void 0&&r!=null&&_(e,["parameters","durationSeconds"],r),f(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=f(n,["aspectRatio"]);e!==void 0&&u!=null&&_(e,["parameters","aspectRatio"],u);const c=f(n,["resolution"]);e!==void 0&&c!=null&&_(e,["parameters","resolution"],c);const m=f(n,["personGeneration"]);if(e!==void 0&&m!=null&&_(e,["parameters","personGeneration"],m),f(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const g=f(n,["negativePrompt"]);e!==void 0&&g!=null&&_(e,["parameters","negativePrompt"],g);const p=f(n,["enhancePrompt"]);if(e!==void 0&&p!=null&&_(e,["parameters","enhancePrompt"],p),f(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const x=f(n,["lastFrame"]);e!==void 0&&x!=null&&_(e,["instances[0]","lastFrame"],tf(x));const S=f(n,["referenceImages"]);if(e!==void 0&&S!=null){let C=S;Array.isArray(C)&&(C=C.map(M=>LR(M))),_(e,["instances[0]","referenceImages"],C)}if(f(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function DN(n,e){const t={},i=f(n,["numberOfVideos"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=f(n,["outputGcsUri"]);e!==void 0&&r!=null&&_(e,["parameters","storageUri"],r);const u=f(n,["fps"]);e!==void 0&&u!=null&&_(e,["parameters","fps"],u);const c=f(n,["durationSeconds"]);e!==void 0&&c!=null&&_(e,["parameters","durationSeconds"],c);const m=f(n,["seed"]);e!==void 0&&m!=null&&_(e,["parameters","seed"],m);const g=f(n,["aspectRatio"]);e!==void 0&&g!=null&&_(e,["parameters","aspectRatio"],g);const p=f(n,["resolution"]);e!==void 0&&p!=null&&_(e,["parameters","resolution"],p);const x=f(n,["personGeneration"]);e!==void 0&&x!=null&&_(e,["parameters","personGeneration"],x);const S=f(n,["pubsubTopic"]);e!==void 0&&S!=null&&_(e,["parameters","pubsubTopic"],S);const C=f(n,["negativePrompt"]);e!==void 0&&C!=null&&_(e,["parameters","negativePrompt"],C);const M=f(n,["enhancePrompt"]);e!==void 0&&M!=null&&_(e,["parameters","enhancePrompt"],M);const F=f(n,["generateAudio"]);e!==void 0&&F!=null&&_(e,["parameters","generateAudio"],F);const H=f(n,["lastFrame"]);e!==void 0&&H!=null&&_(e,["instances[0]","lastFrame"],eo(H));const Y=f(n,["referenceImages"]);if(e!==void 0&&Y!=null){let ee=Y;Array.isArray(ee)&&(ee=ee.map(Ee=>VR(Ee))),_(e,["instances[0]","referenceImages"],ee)}const ie=f(n,["mask"]);e!==void 0&&ie!=null&&_(e,["instances[0]","mask"],DR(ie));const re=f(n,["compressionQuality"]);return e!==void 0&&re!=null&&_(e,["parameters","compressionQuality"],re),t}function LN(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response","generateVideoResponse"]);return c!=null&&_(e,["response"],zN(c)),e}function VN(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response"]);return c!=null&&_(e,["response"],BN(c)),e}function ON(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const u=f(e,["image"]);u!=null&&_(t,["instances[0]","image"],tf(u));const c=f(e,["video"]);c!=null&&_(t,["instances[0]","video"],yw(c));const m=f(e,["source"]);m!=null&&FN(m,t);const g=f(e,["config"]);return g!=null&&kN(g,t),t}function UN(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["prompt"]);r!=null&&_(t,["instances[0]","prompt"],r);const u=f(e,["image"]);u!=null&&_(t,["instances[0]","image"],eo(u));const c=f(e,["video"]);c!=null&&_(t,["instances[0]","video"],vw(c));const m=f(e,["source"]);m!=null&&qN(m,t);const g=f(e,["config"]);return g!=null&&DN(g,t),t}function zN(n){const e={},t=f(n,["generatedSamples"]);if(t!=null){let u=t;Array.isArray(u)&&(u=u.map(c=>jN(c))),_(e,["generatedVideos"],u)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function BN(n){const e={},t=f(n,["videos"]);if(t!=null){let u=t;Array.isArray(u)&&(u=u.map(c=>KN(c))),_(e,["generatedVideos"],u)}const i=f(n,["raiMediaFilteredCount"]);i!=null&&_(e,["raiMediaFilteredCount"],i);const r=f(n,["raiMediaFilteredReasons"]);return r!=null&&_(e,["raiMediaFilteredReasons"],r),e}function FN(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],tf(r));const u=f(n,["video"]);return e!==void 0&&u!=null&&_(e,["instances[0]","video"],yw(u)),t}function qN(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],eo(r));const u=f(n,["video"]);return e!==void 0&&u!=null&&_(e,["instances[0]","video"],vw(u)),t}function HN(n){const e={},t=f(n,["_self"]);t!=null&&_(e,["image"],eR(t));const i=f(n,["raiFilteredReason"]);i!=null&&_(e,["raiFilteredReason"],i);const r=f(n,["_self"]);return r!=null&&_(e,["safetyAttributes"],mw(r)),e}function ef(n){const e={},t=f(n,["_self"]);t!=null&&_(e,["image"],fw(t));const i=f(n,["raiFilteredReason"]);i!=null&&_(e,["raiFilteredReason"],i);const r=f(n,["_self"]);r!=null&&_(e,["safetyAttributes"],pw(r));const u=f(n,["prompt"]);return u!=null&&_(e,["enhancedPrompt"],u),e}function GN(n){const e={},t=f(n,["_self"]);t!=null&&_(e,["mask"],fw(t));const i=f(n,["labels"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(u=>u)),_(e,["labels"],r)}return e}function jN(n){const e={},t=f(n,["video"]);return t!=null&&_(e,["video"],PR(t)),e}function KN(n){const e={},t=f(n,["_self"]);return t!=null&&_(e,["video"],kR(t)),e}function ZN(n){const e={},t=f(n,["modelSelectionConfig"]);t!=null&&_(e,["modelConfig"],t);const i=f(n,["responseJsonSchema"]);i!=null&&_(e,["responseJsonSchema"],i);const r=f(n,["audioTimestamp"]);r!=null&&_(e,["audioTimestamp"],r);const u=f(n,["candidateCount"]);u!=null&&_(e,["candidateCount"],u);const c=f(n,["enableAffectiveDialog"]);c!=null&&_(e,["enableAffectiveDialog"],c);const m=f(n,["frequencyPenalty"]);m!=null&&_(e,["frequencyPenalty"],m);const g=f(n,["logprobs"]);g!=null&&_(e,["logprobs"],g);const p=f(n,["maxOutputTokens"]);p!=null&&_(e,["maxOutputTokens"],p);const x=f(n,["mediaResolution"]);x!=null&&_(e,["mediaResolution"],x);const S=f(n,["presencePenalty"]);S!=null&&_(e,["presencePenalty"],S);const C=f(n,["responseLogprobs"]);C!=null&&_(e,["responseLogprobs"],C);const M=f(n,["responseMimeType"]);M!=null&&_(e,["responseMimeType"],M);const F=f(n,["responseModalities"]);F!=null&&_(e,["responseModalities"],F);const H=f(n,["responseSchema"]);H!=null&&_(e,["responseSchema"],H);const Y=f(n,["routingConfig"]);Y!=null&&_(e,["routingConfig"],Y);const ie=f(n,["seed"]);ie!=null&&_(e,["seed"],ie);const re=f(n,["speechConfig"]);re!=null&&_(e,["speechConfig"],gw(re));const ee=f(n,["stopSequences"]);ee!=null&&_(e,["stopSequences"],ee);const Ee=f(n,["temperature"]);Ee!=null&&_(e,["temperature"],Ee);const pe=f(n,["thinkingConfig"]);pe!=null&&_(e,["thinkingConfig"],pe);const J=f(n,["topK"]);J!=null&&_(e,["topK"],J);const k=f(n,["topP"]);if(k!=null&&_(e,["topP"],k),f(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function YN(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Pt(n,i)),t}function WN(n,e){const t={},i=f(e,["model"]);return i!=null&&_(t,["_url","name"],Pt(n,i)),t}function JN(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function QN(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function $N(n){const e={},t=f(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=f(n,["imageSize"]);if(i!=null&&_(e,["imageSize"],i),f(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function XN(n){const e={},t=f(n,["aspectRatio"]);t!=null&&_(e,["aspectRatio"],t);const i=f(n,["imageSize"]);i!=null&&_(e,["imageSize"],i);const r=f(n,["outputMimeType"]);r!=null&&_(e,["imageOutputOptions","mimeType"],r);const u=f(n,["outputCompressionQuality"]);return u!=null&&_(e,["imageOutputOptions","compressionQuality"],u),e}function eR(n){const e={},t=f(n,["bytesBase64Encoded"]);t!=null&&_(e,["imageBytes"],pa(t));const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function fw(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["gcsUri"],t);const i=f(n,["bytesBase64Encoded"]);i!=null&&_(e,["imageBytes"],pa(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function tf(n){const e={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=f(n,["imageBytes"]);t!=null&&_(e,["bytesBase64Encoded"],pa(t));const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function eo(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["gcsUri"],t);const i=f(n,["imageBytes"]);i!=null&&_(e,["bytesBase64Encoded"],pa(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function tR(n,e,t){const i={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&_(t,["_query","pageSize"],r);const u=f(e,["pageToken"]);t!==void 0&&u!=null&&_(t,["_query","pageToken"],u);const c=f(e,["filter"]);t!==void 0&&c!=null&&_(t,["_query","filter"],c);const m=f(e,["queryBase"]);return t!==void 0&&m!=null&&_(t,["_url","models_url"],ow(n,m)),i}function nR(n,e,t){const i={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&_(t,["_query","pageSize"],r);const u=f(e,["pageToken"]);t!==void 0&&u!=null&&_(t,["_query","pageToken"],u);const c=f(e,["filter"]);t!==void 0&&c!=null&&_(t,["_query","filter"],c);const m=f(e,["queryBase"]);return t!==void 0&&m!=null&&_(t,["_url","models_url"],ow(n,m)),i}function iR(n,e){const t={},i=f(e,["config"]);return i!=null&&tR(n,i,t),t}function sR(n,e){const t={},i=f(e,["config"]);return i!=null&&nR(n,i,t),t}function oR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["_self"]);if(r!=null){let u=rw(r);Array.isArray(u)&&(u=u.map(c=>Up(c))),_(e,["models"],u)}return e}function rR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["_self"]);if(r!=null){let u=rw(r);Array.isArray(u)&&(u=u.map(c=>zp(c))),_(e,["models"],u)}return e}function aR(n){const e={},t=f(n,["maskMode"]);t!=null&&_(e,["maskMode"],t);const i=f(n,["segmentationClasses"]);i!=null&&_(e,["maskClasses"],i);const r=f(n,["maskDilation"]);return r!=null&&_(e,["dilation"],r),e}function Up(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);r!=null&&_(e,["description"],r);const u=f(n,["version"]);u!=null&&_(e,["version"],u);const c=f(n,["_self"]);c!=null&&_(e,["tunedModelInfo"],wR(c));const m=f(n,["inputTokenLimit"]);m!=null&&_(e,["inputTokenLimit"],m);const g=f(n,["outputTokenLimit"]);g!=null&&_(e,["outputTokenLimit"],g);const p=f(n,["supportedGenerationMethods"]);p!=null&&_(e,["supportedActions"],p);const x=f(n,["temperature"]);x!=null&&_(e,["temperature"],x);const S=f(n,["maxTemperature"]);S!=null&&_(e,["maxTemperature"],S);const C=f(n,["topP"]);C!=null&&_(e,["topP"],C);const M=f(n,["topK"]);M!=null&&_(e,["topK"],M);const F=f(n,["thinking"]);return F!=null&&_(e,["thinking"],F),e}function zp(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["displayName"]);i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);r!=null&&_(e,["description"],r);const u=f(n,["versionId"]);u!=null&&_(e,["version"],u);const c=f(n,["deployedModels"]);if(c!=null){let S=c;Array.isArray(S)&&(S=S.map(C=>TN(C))),_(e,["endpoints"],S)}const m=f(n,["labels"]);m!=null&&_(e,["labels"],m);const g=f(n,["_self"]);g!=null&&_(e,["tunedModelInfo"],SR(g));const p=f(n,["defaultCheckpointId"]);p!=null&&_(e,["defaultCheckpointId"],p);const x=f(n,["checkpoints"]);if(x!=null){let S=x;Array.isArray(S)&&(S=S.map(C=>C)),_(e,["checkpoints"],S)}return e}function lR(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const u=f(n,["fileData"]);u!=null&&_(e,["fileData"],EN(u));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],xN(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],Z2(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const x=f(n,["thought"]);x!=null&&_(e,["thought"],x);const S=f(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const C=f(n,["videoMetadata"]);return C!=null&&_(e,["videoMetadata"],C),e}function uR(n){const e={},t=f(n,["productImage"]);return t!=null&&_(e,["image"],eo(t)),e}function cR(n,e){const t={},i=f(n,["numberOfImages"]);e!==void 0&&i!=null&&_(e,["parameters","sampleCount"],i);const r=f(n,["baseSteps"]);e!==void 0&&r!=null&&_(e,["parameters","baseSteps"],r);const u=f(n,["outputGcsUri"]);e!==void 0&&u!=null&&_(e,["parameters","storageUri"],u);const c=f(n,["seed"]);e!==void 0&&c!=null&&_(e,["parameters","seed"],c);const m=f(n,["safetyFilterLevel"]);e!==void 0&&m!=null&&_(e,["parameters","safetySetting"],m);const g=f(n,["personGeneration"]);e!==void 0&&g!=null&&_(e,["parameters","personGeneration"],g);const p=f(n,["addWatermark"]);e!==void 0&&p!=null&&_(e,["parameters","addWatermark"],p);const x=f(n,["outputMimeType"]);e!==void 0&&x!=null&&_(e,["parameters","outputOptions","mimeType"],x);const S=f(n,["outputCompressionQuality"]);e!==void 0&&S!=null&&_(e,["parameters","outputOptions","compressionQuality"],S);const C=f(n,["enhancePrompt"]);e!==void 0&&C!=null&&_(e,["parameters","enhancePrompt"],C);const M=f(n,["labels"]);return e!==void 0&&M!=null&&_(e,["labels"],M),t}function dR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["source"]);r!=null&&fR(r,t);const u=f(e,["config"]);return u!=null&&cR(u,t),t}function hR(n){const e={},t=f(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>ef(r))),_(e,["generatedImages"],i)}return e}function fR(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["personImage"]);e!==void 0&&r!=null&&_(e,["instances[0]","personImage","image"],eo(r));const u=f(n,["productImages"]);if(e!==void 0&&u!=null){let c=u;Array.isArray(c)&&(c=c.map(m=>uR(m))),_(e,["instances[0]","productImages"],c)}return t}function mR(n){const e={},t=f(n,["referenceImage"]);t!=null&&_(e,["referenceImage"],eo(t));const i=f(n,["referenceId"]);i!=null&&_(e,["referenceId"],i);const r=f(n,["referenceType"]);r!=null&&_(e,["referenceType"],r);const u=f(n,["maskImageConfig"]);u!=null&&_(e,["maskImageConfig"],aR(u));const c=f(n,["controlImageConfig"]);c!=null&&_(e,["controlImageConfig"],eN(c));const m=f(n,["styleImageConfig"]);m!=null&&_(e,["styleImageConfig"],m);const g=f(n,["subjectImageConfig"]);return g!=null&&_(e,["subjectImageConfig"],g),e}function mw(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&_(e,["categories"],t);const i=f(n,["safetyAttributes","scores"]);i!=null&&_(e,["scores"],i);const r=f(n,["contentType"]);return r!=null&&_(e,["contentType"],r),e}function pw(n){const e={},t=f(n,["safetyAttributes","categories"]);t!=null&&_(e,["categories"],t);const i=f(n,["safetyAttributes","scores"]);i!=null&&_(e,["scores"],i);const r=f(n,["contentType"]);return r!=null&&_(e,["contentType"],r),e}function pR(n){const e={},t=f(n,["category"]);if(t!=null&&_(e,["category"],t),f(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=f(n,["threshold"]);return i!=null&&_(e,["threshold"],i),e}function gR(n){const e={},t=f(n,["image"]);return t!=null&&_(e,["image"],eo(t)),e}function _R(n,e){const t={},i=f(n,["mode"]);e!==void 0&&i!=null&&_(e,["parameters","mode"],i);const r=f(n,["maxPredictions"]);e!==void 0&&r!=null&&_(e,["parameters","maxPredictions"],r);const u=f(n,["confidenceThreshold"]);e!==void 0&&u!=null&&_(e,["parameters","confidenceThreshold"],u);const c=f(n,["maskDilation"]);e!==void 0&&c!=null&&_(e,["parameters","maskDilation"],c);const m=f(n,["binaryColorThreshold"]);e!==void 0&&m!=null&&_(e,["parameters","binaryColorThreshold"],m);const g=f(n,["labels"]);return e!==void 0&&g!=null&&_(e,["labels"],g),t}function yR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["source"]);r!=null&&TR(r,t);const u=f(e,["config"]);return u!=null&&_R(u,t),t}function vR(n){const e={},t=f(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>GN(r))),_(e,["generatedMasks"],i)}return e}function TR(n,e){const t={},i=f(n,["prompt"]);e!==void 0&&i!=null&&_(e,["instances[0]","prompt"],i);const r=f(n,["image"]);e!==void 0&&r!=null&&_(e,["instances[0]","image"],eo(r));const u=f(n,["scribbleImage"]);return e!==void 0&&u!=null&&_(e,["instances[0]","scribble"],gR(u)),t}function gw(n){const e={},t=f(n,["languageCode"]);t!=null&&_(e,["languageCode"],t);const i=f(n,["voiceConfig"]);if(i!=null&&_(e,["voiceConfig"],i),f(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function ER(n){const e={},t=f(n,["functionCallingConfig"]);t!=null&&_(e,["functionCallingConfig"],wN(t));const i=f(n,["retrievalConfig"]);return i!=null&&_(e,["retrievalConfig"],i),e}function xR(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(S=>S)),_(e,["functionDeclarations"],x)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const u=f(n,["fileSearch"]);u!=null&&_(e,["fileSearch"],u);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],JN(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],QN(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}function _w(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let S=t;Array.isArray(S)&&(S=S.map(C=>SN(C))),_(e,["functionDeclarations"],S)}const i=f(n,["retrieval"]);i!=null&&_(e,["retrieval"],i);const r=f(n,["googleSearchRetrieval"]);r!=null&&_(e,["googleSearchRetrieval"],r);const u=f(n,["computerUse"]);if(u!=null&&_(e,["computerUse"],u),f(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const c=f(n,["codeExecution"]);c!=null&&_(e,["codeExecution"],c);const m=f(n,["enterpriseWebSearch"]);m!=null&&_(e,["enterpriseWebSearch"],m);const g=f(n,["googleMaps"]);g!=null&&_(e,["googleMaps"],g);const p=f(n,["googleSearch"]);p!=null&&_(e,["googleSearch"],p);const x=f(n,["urlContext"]);return x!=null&&_(e,["urlContext"],x),e}function wR(n){const e={},t=f(n,["baseModel"]);t!=null&&_(e,["baseModel"],t);const i=f(n,["createTime"]);i!=null&&_(e,["createTime"],i);const r=f(n,["updateTime"]);return r!=null&&_(e,["updateTime"],r),e}function SR(n){const e={},t=f(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&_(e,["baseModel"],t);const i=f(n,["createTime"]);i!=null&&_(e,["createTime"],i);const r=f(n,["updateTime"]);return r!=null&&_(e,["updateTime"],r),e}function AR(n,e){const t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);e!==void 0&&r!=null&&_(e,["description"],r);const u=f(n,["defaultCheckpointId"]);return e!==void 0&&u!=null&&_(e,["defaultCheckpointId"],u),t}function CR(n,e){const t={},i=f(n,["displayName"]);e!==void 0&&i!=null&&_(e,["displayName"],i);const r=f(n,["description"]);e!==void 0&&r!=null&&_(e,["description"],r);const u=f(n,["defaultCheckpointId"]);return e!==void 0&&u!=null&&_(e,["defaultCheckpointId"],u),t}function bR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","name"],Pt(n,i));const r=f(e,["config"]);return r!=null&&AR(r,t),t}function IR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["config"]);return r!=null&&CR(r,t),t}function NR(n,e){const t={},i=f(n,["outputGcsUri"]);e!==void 0&&i!=null&&_(e,["parameters","storageUri"],i);const r=f(n,["safetyFilterLevel"]);e!==void 0&&r!=null&&_(e,["parameters","safetySetting"],r);const u=f(n,["personGeneration"]);e!==void 0&&u!=null&&_(e,["parameters","personGeneration"],u);const c=f(n,["includeRaiReason"]);e!==void 0&&c!=null&&_(e,["parameters","includeRaiReason"],c);const m=f(n,["outputMimeType"]);e!==void 0&&m!=null&&_(e,["parameters","outputOptions","mimeType"],m);const g=f(n,["outputCompressionQuality"]);e!==void 0&&g!=null&&_(e,["parameters","outputOptions","compressionQuality"],g);const p=f(n,["enhanceInputImage"]);e!==void 0&&p!=null&&_(e,["parameters","upscaleConfig","enhanceInputImage"],p);const x=f(n,["imagePreservationFactor"]);e!==void 0&&x!=null&&_(e,["parameters","upscaleConfig","imagePreservationFactor"],x);const S=f(n,["labels"]);e!==void 0&&S!=null&&_(e,["labels"],S);const C=f(n,["numberOfImages"]);e!==void 0&&C!=null&&_(e,["parameters","sampleCount"],C);const M=f(n,["mode"]);return e!==void 0&&M!=null&&_(e,["parameters","mode"],M),t}function RR(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["_url","model"],Pt(n,i));const r=f(e,["image"]);r!=null&&_(t,["instances[0]","image"],eo(r));const u=f(e,["upscaleFactor"]);u!=null&&_(t,["parameters","upscaleConfig","upscaleFactor"],u);const c=f(e,["config"]);return c!=null&&NR(c,t),t}function MR(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(u=>ef(u))),_(e,["generatedImages"],r)}return e}function PR(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["uri"],t);const i=f(n,["encodedVideo"]);i!=null&&_(e,["videoBytes"],pa(i));const r=f(n,["encoding"]);return r!=null&&_(e,["mimeType"],r),e}function kR(n){const e={},t=f(n,["gcsUri"]);t!=null&&_(e,["uri"],t);const i=f(n,["bytesBase64Encoded"]);i!=null&&_(e,["videoBytes"],pa(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}function DR(n){const e={},t=f(n,["image"]);t!=null&&_(e,["_self"],eo(t));const i=f(n,["maskMode"]);return i!=null&&_(e,["maskMode"],i),e}function LR(n){const e={},t=f(n,["image"]);t!=null&&_(e,["image"],tf(t));const i=f(n,["referenceType"]);return i!=null&&_(e,["referenceType"],i),e}function VR(n){const e={},t=f(n,["image"]);t!=null&&_(e,["image"],eo(t));const i=f(n,["referenceType"]);return i!=null&&_(e,["referenceType"],i),e}function yw(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["uri"],t);const i=f(n,["videoBytes"]);i!=null&&_(e,["encodedVideo"],pa(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["encoding"],r),e}function vw(n){const e={},t=f(n,["uri"]);t!=null&&_(e,["gcsUri"],t);const i=f(n,["videoBytes"]);i!=null&&_(e,["bytesBase64Encoded"],pa(i));const r=f(n,["mimeType"]);return r!=null&&_(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const OR="Content-Type",UR="X-Server-Timeout",zR="User-Agent",Bp="x-goog-api-client",BR="1.30.0",FR=`google-genai-sdk/${BR}`,qR="v1beta1",HR="v1beta",XT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class GR{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:qR,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:HR,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[c,m]of Object.entries(e.queryParams))r.searchParams.append(c,String(m));let u={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else u.body=e.body;return u=await this.includeExtraHttpOptionsToRequestInit(u,t,r.toString(),e.abortSignal),this.unaryApiCall(r,u,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[r,u]of Object.entries(t))typeof u=="object"?i[r]=Object.assign(Object.assign({},i[r]),u):u!==void 0&&(i[r]=u);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let u={};return u.body=e.body,u=await this.includeExtraHttpOptionsToRequestInit(u,t,r.toString(),e.abortSignal),this.streamApiCall(r,u,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,r){if(t&&t.timeout||r){const u=new AbortController,c=u.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const m=setTimeout(()=>u.abort(),t.timeout);m&&typeof m.unref=="function"&&m.unref()}r&&r.addEventListener("abort",()=>{u.abort()}),e.signal=c}return t&&t.extraBody!==null&&jR(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await eE(r),new Lp(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await eE(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return ou(this,arguments,function*(){const r=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),u=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let c="";for(;;){const{done:m,value:g}=yield sn(r.read());if(m){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=u.decode(g,{stream:!0});try{const S=JSON.parse(p);if("error"in S){const C=JSON.parse(JSON.stringify(S.error)),M=C.status,F=C.code,H=`got status: ${M}. ${JSON.stringify(S)}`;if(F>=400&&F<600)throw new $h({message:H,status:F})}}catch(S){if(S.name==="ApiError")throw S}c+=p;let x=c.match(XT);for(;x;){const S=x[1];try{const C=new Response(S,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield sn(new Lp(C)),c=c.slice(x[0].length),x=c.match(XT)}catch(C){throw new Error(`exception parsing stream chunk ${S}. ${C}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=FR+" "+this.clientOptions.userAgentExtra;return e[zR]=t,e[Bp]=t,e[OR]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[r,u]of Object.entries(e.headers))i.append(r,u);e.timeout&&e.timeout>0&&i.append(UR,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const u=this.clientOptions.uploader,c=await u.stat(e);r.sizeBytes=String(c.size);const m=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:c.type;if(m===void 0||m==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=m;const g={file:r},p=this.getFileName(e),x=De("upload/v1beta/files",g._url),S=await this.fetchUploadUrl(x,r.sizeBytes,r.mimeType,p,g,t==null?void 0:t.httpOptions);return u.upload(e,S,this)}async uploadFileToFileSearchStore(e,t,i){var r;const u=this.clientOptions.uploader,c=await u.stat(t),m=String(c.size),g=(r=i==null?void 0:i.mimeType)!==null&&r!==void 0?r:c.type;if(g===void 0||g==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,x=this.getFileName(t),S={};i!=null&&i.customMetadata&&(S.customMetadata=i.customMetadata),i!=null&&i.chunkingConfig&&(S.chunkingConfig=i.chunkingConfig);const C=await this.fetchUploadUrl(p,m,g,x,S,i==null?void 0:i.httpOptions);return u.uploadToFileSearchStore(t,C,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,r,u,c){var m;let g={};c?g=c:g={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};const p=await this.request({path:e,body:JSON.stringify(u),httpMethod:"POST",httpOptions:g});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const x=(m=p==null?void 0:p.headers)===null||m===void 0?void 0:m["x-goog-upload-url"];if(x===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return x}}async function eE(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(i);throw t>=400&&t<600?new $h({message:r,status:t}):new Error(r)}}function jR(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const u=JSON.parse(n.body);if(typeof u=="object"&&u!==null&&!Array.isArray(u))t=u;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(u,c){const m=Object.assign({},u);for(const g in c)if(Object.prototype.hasOwnProperty.call(c,g)){const p=c[g],x=m[g];p&&typeof p=="object"&&!Array.isArray(p)&&x&&typeof x=="object"&&!Array.isArray(x)?m[g]=i(x,p):(x&&p&&typeof x!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${g}". Original type: ${typeof x}, New type: ${typeof p}. Overwriting.`),m[g]=p)}return m}const r=i(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KR="mcp_used/unknown";let ZR=!1;function Tw(n){for(const e of n)if(YR(e)||typeof e=="object"&&"inputSchema"in e)return!0;return ZR}function Ew(n){var e;const t=(e=n[Bp])!==null&&e!==void 0?e:"";n[Bp]=(t+` ${KR}`).trimStart()}function YR(n){return n!==null&&typeof n=="object"&&n instanceof Cg}function WR(n,e=100){return ou(this,arguments,function*(){let i,r=0;for(;r<e;){const u=yield sn(n.listTools({cursor:i}));for(const c of u.tools)yield yield sn(c),r++;if(!u.nextCursor)break;i=u.nextCursor}})}class Cg{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Cg(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;const u={},c=[];for(const x of this.mcpClients)try{for(var m=!0,g=(t=void 0,bc(WR(x))),p;p=await g.next(),e=p.done,!e;m=!0){r=p.value,m=!1;const S=r;c.push(S);const C=S.name;if(u[C])throw new Error(`Duplicate function name ${C} found in MCP tools. Please ensure function names are unique.`);u[C]=x}}catch(S){t={error:S}}finally{try{!m&&!e&&(i=g.return)&&await i.call(g)}finally{if(t)throw t.error}}this.mcpTools=c,this.functionNameToMcpClient=u}async tool(){return await this.initialize(),Fb(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let u;this.config.timeout&&(u={timeout:this.config.timeout});const c=await r.callTool({name:i.name,arguments:i.args},void 0,u);t.push({functionResponse:{name:i.name,response:c.isError?{error:c}:c}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function JR(n,e,t){const i=new kb;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(i,r),e(i)}class QR{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion(),c=eM(this.apiClient.getDefaultHeaders()),m=this.apiClient.getApiKey(),g=`${r}/ws/google.ai.generativelanguage.${u}.GenerativeService.BidiGenerateMusic?key=${m}`;let p=()=>{};const x=new Promise(ee=>{p=ee}),S=e.callbacks,C=function(){p({})},M=this.apiClient,F={onopen:C,onmessage:ee=>{JR(M,S.onmessage,ee)},onerror:(t=S==null?void 0:S.onerror)!==null&&t!==void 0?t:function(ee){},onclose:(i=S==null?void 0:S.onclose)!==null&&i!==void 0?i:function(ee){}},H=this.webSocketFactory.create(g,XR(c),F);H.connect(),await x;const re={setup:{model:Pt(this.apiClient,e.model)}};return H.send(JSON.stringify(re)),new $R(H,this.apiClient)}}class $R{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=U2(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=O2(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(iu.PLAY)}pause(){this.sendPlaybackControl(iu.PAUSE)}stop(){this.sendPlaybackControl(iu.STOP)}resetContext(){this.sendPlaybackControl(iu.RESET_CONTEXT)}close(){this.conn.close()}}function XR(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function eM(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tM="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function nM(n,e,t){const i=new Pb;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const u=JSON.parse(r);if(n.isVertexAI()){const c=F2(u);Object.assign(i,c)}else Object.assign(i,u);e(i)}class iM{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new QR(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,u,c,m;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const g=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let x;const S=this.apiClient.getHeaders();e.config&&e.config.tools&&Tw(e.config.tools)&&Ew(S);const C=aM(S);if(this.apiClient.isVertexAI())x=`${g}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(C,x);else{const V=this.apiClient.getApiKey();let B="BidiGenerateContent",q="key";V!=null&&V.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),B="BidiGenerateContentConstrained",q="access_token"),x=`${g}/ws/google.ai.generativelanguage.${p}.GenerativeService.${B}?${q}=${V}`}let M=()=>{};const F=new Promise(V=>{M=V}),H=e.callbacks,Y=function(){var V;(V=H==null?void 0:H.onopen)===null||V===void 0||V.call(H),M({})},ie=this.apiClient,re={onopen:Y,onmessage:V=>{nM(ie,H.onmessage,V)},onerror:(t=H==null?void 0:H.onerror)!==null&&t!==void 0?t:function(V){},onclose:(i=H==null?void 0:H.onclose)!==null&&i!==void 0?i:function(V){}},ee=this.webSocketFactory.create(x,rM(C),re);ee.connect(),await F;let Ee=Pt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&Ee.startsWith("publishers/")){const V=this.apiClient.getProject(),B=this.apiClient.getLocation();Ee=`projects/${V}/locations/${B}/`+Ee}let pe={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Ih.AUDIO]}:e.config.responseModalities=[Ih.AUDIO]),!((u=e.config)===null||u===void 0)&&u.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const J=(m=(c=e.config)===null||c===void 0?void 0:c.tools)!==null&&m!==void 0?m:[],k=[];for(const V of J)if(this.isCallableTool(V)){const B=V;k.push(await B.tool())}else k.push(V);k.length>0&&(e.config.tools=k);const U={model:Ee,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?pe=V2(this.apiClient,U):pe=L2(this.apiClient,U),delete pe.config,ee.send(JSON.stringify(pe)),new oM(ee,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const sM={turnComplete:!0};class oM{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Ps(t.turns),e.isVertexAI()||(i=i.map(r=>Xh(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const u of i){if(typeof u!="object"||u===null||!("name"in u)||!("response"in u))throw new Error(`Could not parse function response, type '${typeof u}'.`);if(!e.isVertexAI()&&!("id"in u))throw new Error(tM)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},sM),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:B2(e)}:t={realtimeInput:z2(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function rM(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function aM(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tE=10;function nE(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const c of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(ru(c)){r=!0;break}if(!r)return!0;const u=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return u&&(u<0||!Number.isInteger(u))||u==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",u),!0):!1}function ru(n){return"callTool"in n&&typeof n.callTool=="function"}function lM(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>ru(r)))!==null&&i!==void 0?i:!1}function iE(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,r)=>{if(ru(i))return;const u=i;u.functionDeclarations&&u.functionDeclarations.length>0&&t.push(r)}),t}function sE(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uM extends dr{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,r,u,c,m;const g=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!lM(t)||nE(t.config))return await this.generateContentInternal(g);const p=iE(t);if(p.length>0){const H=p.map(Y=>`tools[${Y}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${H}.`)}let x,S;const C=Ps(g.contents),M=(u=(r=(i=g.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&u!==void 0?u:tE;let F=0;for(;F<M&&(x=await this.generateContentInternal(g),!(!x.functionCalls||x.functionCalls.length===0));){const H=x.candidates[0].content,Y=[];for(const ie of(m=(c=t.config)===null||c===void 0?void 0:c.tools)!==null&&m!==void 0?m:[])if(ru(ie)){const ee=await ie.callTool(x.functionCalls);Y.push(...ee)}F++,S={role:"user",parts:Y},g.contents=Ps(g.contents),g.contents.push(H),g.contents.push(S),sE(g.config)&&(C.push(H),C.push(S))}return sE(g.config)&&(x.automaticFunctionCallingHistory=C),x},this.generateContentStream=async t=>{var i,r,u,c,m;if(this.maybeMoveToResponseJsonSchem(t),nE(t.config)){const S=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(S)}const g=iE(t);if(g.length>0){const S=g.map(C=>`tools[${C}]`).join(", ");throw new Error(`Incompatible tools found at ${S}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(u=(r=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||u===void 0?void 0:u.streamFunctionCallArguments,x=(m=(c=t==null?void 0:t.config)===null||c===void 0?void 0:c.automaticFunctionCalling)===null||m===void 0?void 0:m.disable;if(p&&!x)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let u;const c=[];if(i!=null&&i.generatedImages)for(const g of i.generatedImages)g&&(g!=null&&g.safetyAttributes)&&((r=g==null?void 0:g.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?u=g==null?void 0:g.safetyAttributes:c.push(g);let m;return u?m={generatedImages:c,positivePromptSafetyAttributes:u,sdkHttpResponse:i.sdkHttpResponse}:m={generatedImages:c,sdkHttpResponse:i.sdkHttpResponse},m}),this.list=async t=>{var i;const c={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((i=c.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new dl(rr.PAGED_ITEM_MODELS,m=>this.listInternal(m),await this.listInternal(c),c)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var i,r,u,c,m,g;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((c=(u=t.source)===null||u===void 0?void 0:u.video)===null||c===void 0)&&c.uri&&(!((g=(m=t.source)===null||m===void 0?void 0:m.video)===null||g===void 0)&&g.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;const u=(t=e.config)===null||t===void 0?void 0:t.tools;if(!u)return e;const c=await Promise.all(u.map(async g=>ru(g)?await g.tool():g)),m={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:c})};if(m.config.tools=c,e.config&&e.config.tools&&Tw(e.config.tools)){const g=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let p=Object.assign({},g);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),Ew(p),m.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return m}async initAfcToolsMap(e){var t,i,r;const u=new Map;for(const c of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(ru(c)){const m=c,g=await m.tool();for(const p of(r=g.functionDeclarations)!==null&&r!==void 0?r:[]){if(!p.name)throw new Error("Function declaration name is required.");if(u.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);u.set(p.name,m)}}return u}async processAfcStream(e){var t,i,r;const u=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:tE;let c=!1,m=0;const g=await this.initAfcToolsMap(e);return(function(p,x,S){var C,M;return ou(this,arguments,function*(){for(var F,H,Y,ie;m<u;){c&&(m++,c=!1);const pe=yield sn(p.processParamsMaybeAddMcpUsage(S)),J=yield sn(p.generateContentStreamInternal(pe)),k=[],U=[];try{for(var re=!0,ee=(H=void 0,bc(J)),Ee;Ee=yield sn(ee.next()),F=Ee.done,!F;re=!0){ie=Ee.value,re=!1;const V=ie;if(yield yield sn(V),V.candidates&&(!((C=V.candidates[0])===null||C===void 0)&&C.content)){U.push(V.candidates[0].content);for(const B of(M=V.candidates[0].content.parts)!==null&&M!==void 0?M:[])if(m<u&&B.functionCall){if(!B.functionCall.name)throw new Error("Function call name was not returned by the model.");if(x.has(B.functionCall.name)){const q=yield sn(x.get(B.functionCall.name).callTool([B.functionCall]));k.push(...q)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${x.keys()}, mising tool: ${B.functionCall.name}`)}}}}catch(V){H={error:V}}finally{try{!re&&!F&&(Y=ee.return)&&(yield sn(Y.call(ee)))}finally{if(H)throw H.error}}if(k.length>0){c=!0;const V=new Tc;V.candidates=[{content:{role:"user",parts:k}}],yield yield sn(V);const B=[];B.push(...U),B.push({role:"user",parts:k});const q=Ps(S.contents).concat(B);S.contents=q}else break}})})(this,g,e)}async generateContentInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=JT(this.apiClient,e);return m=De("{model}:generateContent",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=$T(x),C=new Tc;return Object.assign(C,S),C})}else{const p=WT(this.apiClient,e);return m=De("{model}:generateContent",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=QT(x),C=new Tc;return Object.assign(C,S),C})}}async generateContentStreamInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=JT(this.apiClient,e);return m=De("{model}:streamGenerateContent?alt=sse",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.requestStream({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),c.then(function(S){return ou(this,arguments,function*(){var C,M,F,H;try{for(var Y=!0,ie=bc(S),re;re=yield sn(ie.next()),C=re.done,!C;Y=!0){H=re.value,Y=!1;const ee=H,Ee=$T(yield sn(ee.json()));Ee.sdkHttpResponse={headers:ee.headers};const pe=new Tc;Object.assign(pe,Ee),yield yield sn(pe)}}catch(ee){M={error:ee}}finally{try{!Y&&!C&&(F=ie.return)&&(yield sn(F.call(ie)))}finally{if(M)throw M.error}}})})}else{const p=WT(this.apiClient,e);return m=De("{model}:streamGenerateContent?alt=sse",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.requestStream({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}),c.then(function(S){return ou(this,arguments,function*(){var C,M,F,H;try{for(var Y=!0,ie=bc(S),re;re=yield sn(ie.next()),C=re.done,!C;Y=!0){H=re.value,Y=!1;const ee=H,Ee=QT(yield sn(ee.json()));Ee.sdkHttpResponse={headers:ee.headers};const pe=new Tc;Object.assign(pe,Ee),yield yield sn(pe)}}catch(ee){M={error:ee}}finally{try{!Y&&!C&&(F=ie.return)&&(yield sn(F.call(ie)))}finally{if(M)throw M.error}}})})}}async embedContent(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=_N(this.apiClient,e);return m=De("{model}:predict",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=vN(x),C=new kT;return Object.assign(C,S),C})}else{const p=gN(this.apiClient,e);return m=De("{model}:batchEmbedContents",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=yN(x),C=new kT;return Object.assign(C,S),C})}}async generateImagesInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=RN(this.apiClient,e);return m=De("{model}:predict",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=PN(x),C=new DT;return Object.assign(C,S),C})}else{const p=NN(this.apiClient,e);return m=De("{model}:predict",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=MN(x),C=new DT;return Object.assign(C,S),C})}}async editImageInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=hN(this.apiClient,e);return u=De("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>{const p=fN(g),x=new Eb;return Object.assign(x,p),x})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=RR(this.apiClient,e);return u=De("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>{const p=MR(g),x=new xb;return Object.assign(x,p),x})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=dR(this.apiClient,e);return u=De("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=hR(g),x=new wb;return Object.assign(x,p),x})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=yR(this.apiClient,e);return u=De("{model}:predict",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=vR(g),x=new Sb;return Object.assign(x,p),x})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=WN(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>zp(x))}else{const p=YN(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>Up(x))}}async listInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=sR(this.apiClient,e);return m=De("{models_url}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=rR(x),C=new LT;return Object.assign(C,S),C})}else{const p=iR(this.apiClient,e);return m=De("{models_url}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=oR(x),C=new LT;return Object.assign(C,S),C})}}async update(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=IR(this.apiClient,e);return m=De("{model}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>zp(x))}else{const p=bR(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>Up(x))}}async delete(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=lN(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=cN(x),C=new VT;return Object.assign(C,S),C})}else{const p=aN(this.apiClient,e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=uN(x),C=new VT;return Object.assign(C,S),C})}}async countTokens(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=sN(this.apiClient,e);return m=De("{model}:countTokens",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=rN(x),C=new OT;return Object.assign(C,S),C})}else{const p=iN(this.apiClient,e);return m=De("{model}:countTokens",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=oN(x),C=new OT;return Object.assign(C,S),C})}}async computeTokens(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=J2(this.apiClient,e);return u=De("{model}:computeTokens",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>{const p=Q2(g),x=new Ab;return Object.assign(x,p),x})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=UN(this.apiClient,e);return m=De("{model}:predictLongRunning",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>{const S=VN(x),C=new Nh;return Object.assign(C,S),C})}else{const p=ON(this.apiClient,e);return m=De("{model}:predictLongRunning",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c.then(x=>{const S=LN(x),C=new Nh;return Object.assign(C,S),C})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cM extends dr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let u;i&&"httpOptions"in i&&(u=i.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:u}});return t._fromAPIResponse({apiResponse:c,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let u;i&&"httpOptions"in i&&(u=i.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:u}});return t._fromAPIResponse({apiResponse:c,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=pb(e);return m=De("{operationName}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c}else{const p=mb(e);return m=De("{operationName}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json()),c}}async fetchPredictVideosOperationInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=ab(e);return u=De("{resourceName}:fetchPredictOperation",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dM(n){const e={},t=f(n,["data"]);if(t!=null&&_(e,["data"],t),f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function hM(n){const e={},t=f(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(u=>EM(u))),_(e,["parts"],r)}const i=f(n,["role"]);return i!=null&&_(e,["role"],i),e}function fM(n,e,t){const i={},r=f(e,["expireTime"]);t!==void 0&&r!=null&&_(t,["expireTime"],r);const u=f(e,["newSessionExpireTime"]);t!==void 0&&u!=null&&_(t,["newSessionExpireTime"],u);const c=f(e,["uses"]);t!==void 0&&c!=null&&_(t,["uses"],c);const m=f(e,["liveConnectConstraints"]);t!==void 0&&m!=null&&_(t,["bidiGenerateContentSetup"],TM(n,m));const g=f(e,["lockAdditionalFields"]);return t!==void 0&&g!=null&&_(t,["fieldMask"],g),i}function mM(n,e){const t={},i=f(e,["config"]);return i!=null&&_(t,["config"],fM(n,i,t)),t}function pM(n){const e={};if(f(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=f(n,["fileUri"]);t!=null&&_(e,["fileUri"],t);const i=f(n,["mimeType"]);return i!=null&&_(e,["mimeType"],i),e}function gM(n){const e={},t=f(n,["id"]);t!=null&&_(e,["id"],t);const i=f(n,["args"]);i!=null&&_(e,["args"],i);const r=f(n,["name"]);if(r!=null&&_(e,["name"],r),f(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function _M(n){const e={};if(f(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=f(n,["enableWidget"]);return t!=null&&_(e,["enableWidget"],t),e}function yM(n){const e={};if(f(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=f(n,["timeRangeFilter"]);return t!=null&&_(e,["timeRangeFilter"],t),e}function vM(n,e){const t={},i=f(n,["generationConfig"]);e!==void 0&&i!=null&&_(e,["setup","generationConfig"],i);const r=f(n,["responseModalities"]);e!==void 0&&r!=null&&_(e,["setup","generationConfig","responseModalities"],r);const u=f(n,["temperature"]);e!==void 0&&u!=null&&_(e,["setup","generationConfig","temperature"],u);const c=f(n,["topP"]);e!==void 0&&c!=null&&_(e,["setup","generationConfig","topP"],c);const m=f(n,["topK"]);e!==void 0&&m!=null&&_(e,["setup","generationConfig","topK"],m);const g=f(n,["maxOutputTokens"]);e!==void 0&&g!=null&&_(e,["setup","generationConfig","maxOutputTokens"],g);const p=f(n,["mediaResolution"]);e!==void 0&&p!=null&&_(e,["setup","generationConfig","mediaResolution"],p);const x=f(n,["seed"]);e!==void 0&&x!=null&&_(e,["setup","generationConfig","seed"],x);const S=f(n,["speechConfig"]);e!==void 0&&S!=null&&_(e,["setup","generationConfig","speechConfig"],Ag(S));const C=f(n,["thinkingConfig"]);e!==void 0&&C!=null&&_(e,["setup","generationConfig","thinkingConfig"],C);const M=f(n,["enableAffectiveDialog"]);e!==void 0&&M!=null&&_(e,["setup","generationConfig","enableAffectiveDialog"],M);const F=f(n,["systemInstruction"]);e!==void 0&&F!=null&&_(e,["setup","systemInstruction"],hM(di(F)));const H=f(n,["tools"]);if(e!==void 0&&H!=null){let J=wu(H);Array.isArray(J)&&(J=J.map(k=>wM(xu(k)))),_(e,["setup","tools"],J)}const Y=f(n,["sessionResumption"]);e!==void 0&&Y!=null&&_(e,["setup","sessionResumption"],xM(Y));const ie=f(n,["inputAudioTranscription"]);e!==void 0&&ie!=null&&_(e,["setup","inputAudioTranscription"],ie);const re=f(n,["outputAudioTranscription"]);e!==void 0&&re!=null&&_(e,["setup","outputAudioTranscription"],re);const ee=f(n,["realtimeInputConfig"]);e!==void 0&&ee!=null&&_(e,["setup","realtimeInputConfig"],ee);const Ee=f(n,["contextWindowCompression"]);e!==void 0&&Ee!=null&&_(e,["setup","contextWindowCompression"],Ee);const pe=f(n,["proactivity"]);return e!==void 0&&pe!=null&&_(e,["setup","proactivity"],pe),t}function TM(n,e){const t={},i=f(e,["model"]);i!=null&&_(t,["setup","model"],Pt(n,i));const r=f(e,["config"]);return r!=null&&_(t,["config"],vM(r,t)),t}function EM(n){const e={},t=f(n,["mediaResolution"]);t!=null&&_(e,["mediaResolution"],t);const i=f(n,["codeExecutionResult"]);i!=null&&_(e,["codeExecutionResult"],i);const r=f(n,["executableCode"]);r!=null&&_(e,["executableCode"],r);const u=f(n,["fileData"]);u!=null&&_(e,["fileData"],pM(u));const c=f(n,["functionCall"]);c!=null&&_(e,["functionCall"],gM(c));const m=f(n,["functionResponse"]);m!=null&&_(e,["functionResponse"],m);const g=f(n,["inlineData"]);g!=null&&_(e,["inlineData"],dM(g));const p=f(n,["text"]);p!=null&&_(e,["text"],p);const x=f(n,["thought"]);x!=null&&_(e,["thought"],x);const S=f(n,["thoughtSignature"]);S!=null&&_(e,["thoughtSignature"],S);const C=f(n,["videoMetadata"]);return C!=null&&_(e,["videoMetadata"],C),e}function xM(n){const e={},t=f(n,["handle"]);if(t!=null&&_(e,["handle"],t),f(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function wM(n){const e={},t=f(n,["functionDeclarations"]);if(t!=null){let x=t;Array.isArray(x)&&(x=x.map(S=>S)),_(e,["functionDeclarations"],x)}if(f(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=f(n,["googleSearchRetrieval"]);i!=null&&_(e,["googleSearchRetrieval"],i);const r=f(n,["computerUse"]);r!=null&&_(e,["computerUse"],r);const u=f(n,["fileSearch"]);u!=null&&_(e,["fileSearch"],u);const c=f(n,["codeExecution"]);if(c!=null&&_(e,["codeExecution"],c),f(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(n,["googleMaps"]);m!=null&&_(e,["googleMaps"],_M(m));const g=f(n,["googleSearch"]);g!=null&&_(e,["googleSearch"],yM(g));const p=f(n,["urlContext"]);return p!=null&&_(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SM(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(u=>`${t}.${u}`);e.push(...r)}else e.push(t)}return e.join(",")}function AM(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const u=i.setup;typeof u=="object"&&u!==null?(n.bidiGenerateContentSetup=u,t=u):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const u=SM(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)u?n.fieldMask=u:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let m=[];r.length>0&&(m=r.map(p=>c.includes(p)?`generationConfig.${p}`:p));const g=[];u&&g.push(u),m.length>0&&g.push(...m),g.length>0?n.fieldMask=g.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class CM extends dr{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const m=mM(this.apiClient,e);u=De("auth_tokens",m._url),c=m._query,delete m.config,delete m._url,delete m._query;const g=AM(m,e.config);return r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bM(n,e){const t={},i=f(n,["displayName"]);return e!==void 0&&i!=null&&_(e,["displayName"],i),t}function IM(n){const e={},t=f(n,["config"]);return t!=null&&bM(t,e),e}function NM(n,e){const t={},i=f(n,["force"]);return e!==void 0&&i!=null&&_(e,["_query","force"],i),t}function RM(n){const e={},t=f(n,["name"]);t!=null&&_(e,["_url","name"],t);const i=f(n,["config"]);return i!=null&&NM(i,e),e}function MM(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","name"],t),e}function PM(n,e){const t={},i=f(n,["customMetadata"]);if(e!==void 0&&i!=null){let u=i;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["customMetadata"],u)}const r=f(n,["chunkingConfig"]);return e!==void 0&&r!=null&&_(e,["chunkingConfig"],r),t}function kM(n){const e={},t=f(n,["name"]);t!=null&&_(e,["name"],t);const i=f(n,["metadata"]);i!=null&&_(e,["metadata"],i);const r=f(n,["done"]);r!=null&&_(e,["done"],r);const u=f(n,["error"]);u!=null&&_(e,["error"],u);const c=f(n,["response"]);return c!=null&&_(e,["response"],LM(c)),e}function DM(n){const e={},t=f(n,["fileSearchStoreName"]);t!=null&&_(e,["_url","file_search_store_name"],t);const i=f(n,["fileName"]);i!=null&&_(e,["fileName"],i);const r=f(n,["config"]);return r!=null&&PM(r,e),e}function LM(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["parent"]);i!=null&&_(e,["parent"],i);const r=f(n,["documentName"]);return r!=null&&_(e,["documentName"],r),e}function VM(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function OM(n){const e={},t=f(n,["config"]);return t!=null&&VM(t,e),e}function UM(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["fileSearchStores"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["fileSearchStores"],u)}return e}function zM(n,e){const t={},i=f(n,["mimeType"]);e!==void 0&&i!=null&&_(e,["mimeType"],i);const r=f(n,["displayName"]);e!==void 0&&r!=null&&_(e,["displayName"],r);const u=f(n,["customMetadata"]);if(e!==void 0&&u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>g)),_(e,["customMetadata"],m)}const c=f(n,["chunkingConfig"]);return e!==void 0&&c!=null&&_(e,["chunkingConfig"],c),t}function BM(n){const e={},t=f(n,["fileSearchStoreName"]);t!=null&&_(e,["_url","file_search_store_name"],t);const i=f(n,["config"]);return i!=null&&zM(i,e),e}function FM(n){const e={},t=f(n,["sdkHttpResponse"]);return t!=null&&_(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qM(n,e){const t={},i=f(n,["force"]);return e!==void 0&&i!=null&&_(e,["_query","force"],i),t}function HM(n){const e={},t=f(n,["name"]);t!=null&&_(e,["_url","name"],t);const i=f(n,["config"]);return i!=null&&qM(i,e),e}function GM(n){const e={},t=f(n,["name"]);return t!=null&&_(e,["_url","name"],t),e}function jM(n,e){const t={},i=f(n,["pageSize"]);e!==void 0&&i!=null&&_(e,["_query","pageSize"],i);const r=f(n,["pageToken"]);return e!==void 0&&r!=null&&_(e,["_query","pageToken"],r),t}function KM(n){const e={},t=f(n,["parent"]);t!=null&&_(e,["_url","parent"],t);const i=f(n,["config"]);return i!=null&&jM(i,e),e}function ZM(n){const e={},t=f(n,["sdkHttpResponse"]);t!=null&&_(e,["sdkHttpResponse"],t);const i=f(n,["nextPageToken"]);i!=null&&_(e,["nextPageToken"],i);const r=f(n,["documents"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),_(e,["documents"],u)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YM extends dr{constructor(e){super(),this.apiClient=e,this.list=async t=>new dl(rr.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=GM(e);return u=De("{name}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async delete(e){var t,i;let r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=HM(e);r=De("{name}",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=KM(e);return u=De("{parent}/documents",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=ZM(g),x=new Cb;return Object.assign(x,p),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WM extends dr{constructor(e,t=new YM(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new dl(rr.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=IM(e);return u=De("fileSearchStores",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async get(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=MM(e);return u=De("{name}",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>g)}}async delete(e){var t,i;let r="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=RM(e);r=De("{name}",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:r,queryParams:u,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=OM(e);return u=De("fileSearchStores",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=UM(g),x=new bb;return Object.assign(x,p),x})}}async uploadToFileSearchStoreInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=BM(e);return u=De("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=FM(g),x=new Ib;return Object.assign(x,p),x})}}async importFile(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=DM(e);return u=De("{file_search_store_name}:importFile",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),r.then(g=>{const p=kM(g),x=new Tg;return Object.assign(x,p),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JM(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function QM(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function $M(n,e,t){const i={};if(f(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=f(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&_(e,["displayName"],r),f(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const u=f(n,["epochCount"]);e!==void 0&&u!=null&&_(e,["tuningTask","hyperparameters","epochCount"],u);const c=f(n,["learningRateMultiplier"]);if(c!=null&&_(i,["tuningTask","hyperparameters","learningRateMultiplier"],c),f(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const m=f(n,["batchSize"]);e!==void 0&&m!=null&&_(e,["tuningTask","hyperparameters","batchSize"],m);const g=f(n,["learningRate"]);if(e!==void 0&&g!=null&&_(e,["tuningTask","hyperparameters","learningRate"],g),f(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(f(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function XM(n,e,t){const i={};let r=f(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const M=f(n,["validationDataset"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec"],oE(M))}else if(r==="PREFERENCE_TUNING"){const M=f(n,["validationDataset"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec"],oE(M))}const u=f(n,["tunedModelDisplayName"]);e!==void 0&&u!=null&&_(e,["tunedModelDisplayName"],u);const c=f(n,["description"]);e!==void 0&&c!=null&&_(e,["description"],c);let m=f(t,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const M=f(n,["epochCount"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","hyperParameters","epochCount"],M)}else if(m==="PREFERENCE_TUNING"){const M=f(n,["epochCount"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],M)}let g=f(t,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const M=f(n,["learningRateMultiplier"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],M)}else if(g==="PREFERENCE_TUNING"){const M=f(n,["learningRateMultiplier"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],M)}let p=f(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const M=f(n,["exportLastCheckpointOnly"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","exportLastCheckpointOnly"],M)}else if(p==="PREFERENCE_TUNING"){const M=f(n,["exportLastCheckpointOnly"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],M)}let x=f(t,["config","method"]);if(x===void 0&&(x="SUPERVISED_FINE_TUNING"),x==="SUPERVISED_FINE_TUNING"){const M=f(n,["adapterSize"]);e!==void 0&&M!=null&&_(e,["supervisedTuningSpec","hyperParameters","adapterSize"],M)}else if(x==="PREFERENCE_TUNING"){const M=f(n,["adapterSize"]);e!==void 0&&M!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],M)}if(f(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const S=f(n,["labels"]);e!==void 0&&S!=null&&_(e,["labels"],S);const C=f(n,["beta"]);return e!==void 0&&C!=null&&_(e,["preferenceOptimizationSpec","hyperParameters","beta"],C),i}function eP(n,e){const t={},i=f(n,["baseModel"]);i!=null&&_(t,["baseModel"],i);const r=f(n,["preTunedModel"]);r!=null&&_(t,["preTunedModel"],r);const u=f(n,["trainingDataset"]);u!=null&&dP(u);const c=f(n,["config"]);return c!=null&&$M(c,t),t}function tP(n,e){const t={},i=f(n,["baseModel"]);i!=null&&_(t,["baseModel"],i);const r=f(n,["preTunedModel"]);r!=null&&_(t,["preTunedModel"],r);const u=f(n,["trainingDataset"]);u!=null&&hP(u,t,e);const c=f(n,["config"]);return c!=null&&XM(c,t,e),t}function nP(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function iP(n,e){const t={},i=f(n,["name"]);return i!=null&&_(t,["_url","name"],i),t}function sP(n,e,t){const i={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&_(e,["_query","pageSize"],r);const u=f(n,["pageToken"]);e!==void 0&&u!=null&&_(e,["_query","pageToken"],u);const c=f(n,["filter"]);return e!==void 0&&c!=null&&_(e,["_query","filter"],c),i}function oP(n,e,t){const i={},r=f(n,["pageSize"]);e!==void 0&&r!=null&&_(e,["_query","pageSize"],r);const u=f(n,["pageToken"]);e!==void 0&&u!=null&&_(e,["_query","pageToken"],u);const c=f(n,["filter"]);return e!==void 0&&c!=null&&_(e,["_query","filter"],c),i}function rP(n,e){const t={},i=f(n,["config"]);return i!=null&&sP(i,t),t}function aP(n,e){const t={},i=f(n,["config"]);return i!=null&&oP(i,t),t}function lP(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const u=f(n,["tunedModels"]);if(u!=null){let c=u;Array.isArray(c)&&(c=c.map(m=>xw(m))),_(t,["tuningJobs"],c)}return t}function uP(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["nextPageToken"]);r!=null&&_(t,["nextPageToken"],r);const u=f(n,["tuningJobs"]);if(u!=null){let c=u;Array.isArray(c)&&(c=c.map(m=>Fp(m))),_(t,["tuningJobs"],c)}return t}function cP(n,e){const t={},i=f(n,["name"]);i!=null&&_(t,["model"],i);const r=f(n,["name"]);return r!=null&&_(t,["endpoint"],r),t}function dP(n,e){const t={};if(f(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=f(n,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(u=>u)),_(t,["examples","examples"],r)}return t}function hP(n,e,t){const i={};let r=f(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const c=f(n,["gcsUri"]);e!==void 0&&c!=null&&_(e,["supervisedTuningSpec","trainingDatasetUri"],c)}else if(r==="PREFERENCE_TUNING"){const c=f(n,["gcsUri"]);e!==void 0&&c!=null&&_(e,["preferenceOptimizationSpec","trainingDatasetUri"],c)}let u=f(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const c=f(n,["vertexDatasetResource"]);e!==void 0&&c!=null&&_(e,["supervisedTuningSpec","trainingDatasetUri"],c)}else if(u==="PREFERENCE_TUNING"){const c=f(n,["vertexDatasetResource"]);e!==void 0&&c!=null&&_(e,["preferenceOptimizationSpec","trainingDatasetUri"],c)}if(f(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function xw(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["name"]);r!=null&&_(t,["name"],r);const u=f(n,["state"]);u!=null&&_(t,["state"],iw(u));const c=f(n,["createTime"]);c!=null&&_(t,["createTime"],c);const m=f(n,["tuningTask","startTime"]);m!=null&&_(t,["startTime"],m);const g=f(n,["tuningTask","completeTime"]);g!=null&&_(t,["endTime"],g);const p=f(n,["updateTime"]);p!=null&&_(t,["updateTime"],p);const x=f(n,["description"]);x!=null&&_(t,["description"],x);const S=f(n,["baseModel"]);S!=null&&_(t,["baseModel"],S);const C=f(n,["_self"]);return C!=null&&_(t,["tunedModel"],cP(C)),t}function Fp(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["name"]);r!=null&&_(t,["name"],r);const u=f(n,["state"]);u!=null&&_(t,["state"],iw(u));const c=f(n,["createTime"]);c!=null&&_(t,["createTime"],c);const m=f(n,["startTime"]);m!=null&&_(t,["startTime"],m);const g=f(n,["endTime"]);g!=null&&_(t,["endTime"],g);const p=f(n,["updateTime"]);p!=null&&_(t,["updateTime"],p);const x=f(n,["error"]);x!=null&&_(t,["error"],x);const S=f(n,["description"]);S!=null&&_(t,["description"],S);const C=f(n,["baseModel"]);C!=null&&_(t,["baseModel"],C);const M=f(n,["tunedModel"]);M!=null&&_(t,["tunedModel"],M);const F=f(n,["preTunedModel"]);F!=null&&_(t,["preTunedModel"],F);const H=f(n,["supervisedTuningSpec"]);H!=null&&_(t,["supervisedTuningSpec"],H);const Y=f(n,["preferenceOptimizationSpec"]);Y!=null&&_(t,["preferenceOptimizationSpec"],Y);const ie=f(n,["tuningDataStats"]);ie!=null&&_(t,["tuningDataStats"],ie);const re=f(n,["encryptionSpec"]);re!=null&&_(t,["encryptionSpec"],re);const ee=f(n,["partnerModelTuningSpec"]);ee!=null&&_(t,["partnerModelTuningSpec"],ee);const Ee=f(n,["customBaseModel"]);Ee!=null&&_(t,["customBaseModel"],Ee);const pe=f(n,["experiment"]);pe!=null&&_(t,["experiment"],pe);const J=f(n,["labels"]);J!=null&&_(t,["labels"],J);const k=f(n,["outputUri"]);k!=null&&_(t,["outputUri"],k);const U=f(n,["pipelineJob"]);U!=null&&_(t,["pipelineJob"],U);const V=f(n,["serviceAccount"]);V!=null&&_(t,["serviceAccount"],V);const B=f(n,["tunedModelDisplayName"]);B!=null&&_(t,["tunedModelDisplayName"],B);const q=f(n,["veoTuningSpec"]);return q!=null&&_(t,["veoTuningSpec"],q),t}function fP(n,e){const t={},i=f(n,["sdkHttpResponse"]);i!=null&&_(t,["sdkHttpResponse"],i);const r=f(n,["name"]);r!=null&&_(t,["name"],r);const u=f(n,["metadata"]);u!=null&&_(t,["metadata"],u);const c=f(n,["done"]);c!=null&&_(t,["done"],c);const m=f(n,["error"]);return m!=null&&_(t,["error"],m),t}function oE(n,e){const t={},i=f(n,["gcsUri"]);i!=null&&_(t,["validationDatasetUri"],i);const r=f(n,["vertexDatasetResource"]);return r!=null&&_(t,["validationDatasetUri"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mP extends dr{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new dl(rr.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const r={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);const u=Object.assign(Object.assign({},t),{preTunedModel:r});return u.baseModel=void 0,await this.tuneInternal(u)}else{const r=Object.assign({},t);return await this.tuneInternal(r)}else{const r=Object.assign({},t),u=await this.tuneMldevInternal(r);let c="";return u.metadata!==void 0&&u.metadata.tunedModel!==void 0?c=u.metadata.tunedModel:u.name!==void 0&&u.name.includes("/operations/")&&(c=u.name.split("/operations/")[0]),{name:c,state:Dp.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=iP(e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>Fp(x))}else{const p=nP(e);return m=De("{name}",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>xw(x))}}async listInternal(e){var t,i,r,u;let c,m="",g={};if(this.apiClient.isVertexAI()){const p=aP(e);return m=De("tuningJobs",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=uP(x),C=new UT;return Object.assign(C,S),C})}else{const p=rP(e);return m=De("tunedModels",p._url),g=p._query,delete p._url,delete p._query,c=this.apiClient.request({path:m,queryParams:g,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal}).then(x=>x.json().then(S=>{const C=S;return C.sdkHttpResponse={headers:x.headers},C})),c.then(x=>{const S=lP(x),C=new UT;return Object.assign(C,S),C})}}async cancel(e){var t,i,r,u;let c="",m={};if(this.apiClient.isVertexAI()){const g=QM(e);c=De("{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const g=JM(e);c=De("{name}:cancel",g._url),m=g._query,delete g._url,delete g._query,await this.apiClient.request({path:c,queryParams:m,body:JSON.stringify(g),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(u=e.config)===null||u===void 0?void 0:u.abortSignal})}}async tuneInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI()){const m=tP(e,e);return u=De("tuningJobs",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>Fp(g))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,u="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=eP(e);return u=De("tunedModels",m._url),c=m._query,delete m._url,delete m._query,r=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(p=>{const x=p;return x.sdkHttpResponse={headers:g.headers},x})),r.then(g=>fP(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pP{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const gP=1024*1024*8,_P=3,yP=1e3,vP=2,Mh="x-goog-upload-status";async function TP(n,e,t){var i;const r=await ww(n,e,t),u=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Mh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return u.file}async function EP(n,e,t){var i;const r=await ww(n,e,t),u=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Mh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const c=Qx(u),m=new Eg;return Object.assign(m,c),m}async function ww(n,e,t){var i,r;let u=0,c=0,m=new Lp(new Response),g="upload";for(u=n.size;c<u;){const p=Math.min(gP,u-c),x=n.slice(c,c+p);c+p>=u&&(g+=", finalize");let S=0,C=yP;for(;S<_P&&(m=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":g,"X-Goog-Upload-Offset":String(c),"Content-Length":String(p)}}}),!(!((i=m==null?void 0:m.headers)===null||i===void 0)&&i[Mh]));)S++,await wP(C),C=C*vP;if(c+=p,((r=m==null?void 0:m.headers)===null||r===void 0?void 0:r[Mh])!=="active")break;if(u<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return m}async function xP(n){return{size:n.size,type:n.type}}function wP(n){return new Promise(e=>setTimeout(e,n))}class SP{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await TP(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await EP(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await xP(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AP{create(e,t,i){return new CP(e,t,i)}}class CP{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rE="x-goog-api-key";class bP{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(rE)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(rE,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const IP="gl-node/";class Sw{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=ob(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const r=new bP(this.apiKey);this.apiClient=new GR({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:IP+"web",uploader:new SP,downloader:new pP}),this.models=new uM(this.apiClient),this.live=new iM(this.apiClient,r,new AP),this.batches=new DI(this.apiClient),this.chats=new p2(this.models,this.apiClient),this.caches=new h2(this.apiClient),this.files=new A2(this.apiClient),this.operations=new cM(this.apiClient),this.authTokens=new CM(this.apiClient),this.tunings=new mP(this.apiClient),this.fileSearchStores=new WM(this.apiClient)}}const NP=()=>{try{const n=localStorage.getItem("nomad_user_api_key");return n||""}catch(n){console.warn("Failed to access API key",n)}return""},to=async n=>{var t;const e=NP();if(e)try{const i=new Sw({apiKey:e});return await n(i)}catch(i){if(console.warn("Primary API Key failed",i),(t=i.message)!=null&&t.includes("403")||i.toString().includes("403"))throw new Error("Invalid API Key (403). Please check your key in Settings.")}else throw new Error("API key is missing. Please provide a valid API key in Settings.");throw new Error("AI Service Failed. Please check your API Key.")},hi={"zh-TW":"Traditional Chinese (Taiwan) ()","en-US":"English","ja-JP":"Japanese"},no=n=>{if(typeof n.text=="string")return n.text;if(typeof n.text=="function")return n.text();if(n.candidates&&n.candidates[0]&&n.candidates[0].content&&n.candidates[0].content.parts&&n.candidates[0].content.parts[0].text)return n.candidates[0].content.parts[0].text;throw new Error("No text found in AI response")},io="gemini-2.0-flash",Aw=async(n,e)=>(console.warn("Image editing is not supported. Returning original image."),n),bg=async n=>{try{const e=`Cinematic travel photography of ${n}, 4k, high quality, sunny day, vibrant colors, wide angle`,t=encodeURIComponent(e),i=Math.floor(Math.random()*1e6);return`https://image.pollinations.ai/prompt/${t}?width=1600&height=900&nologo=true&seed=${i}&model=flux`}catch(e){return console.error("Failed to generate cover image:",e),`https://via.placeholder.com/1600x900/D4A574/FFFFFF?text=${encodeURIComponent(n)}`}},Cw=async(n,e="zh-TW")=>{const t=hi[e]||hi["zh-TW"];return to(async i=>{const r=await i.models.generateContent({model:io,contents:`Help me plan a trip. ${n}`,config:{systemInstruction:`You are a professional travel agent AI. 
                Create a detailed itinerary based on the user's request. 
                
                CRITICAL PLANNING RULES:
                1. **Distance & Logic**: Group attractions that are geographically close to each other on the same day.
                2. **Feasibility**: Ensure the schedule is realistic.
                3. **Language**: All content MUST be in ${t}.
                4. **Travel Info**: You MUST estimate the travel mode and duration to the NEXT activity. This is mandatory for all items except the last one of the day.
                5. **Completeness**: You MUST generate a FULL itinerary with at least 3 activities per day. Do not leave the itinerary empty.
                
                FORMAT REQUIREMENTS:
                Return response in valid JSON format. Do not use Markdown code blocks.
                The JSON must strictly follow this structure:
                {
                    "title": "Trip Title",
                    "startDate": "YYYY-MM-DD",
                    "endDate": "YYYY-MM-DD",
                    "itinerary": [
                        {
                            "id": "unique_id",
                            "day": 1,
                            "time": "09:00",
                            "activity": "Activity Name",
                            "location": "Location Address",
                            "notes": "Tips",
                            "travelToNext": {
                                "mode": "WALK/TRAIN/BUS/CAR",
                                "duration": "15 min",
                                "details": "Route details"
                            }
                        }
                    ],
                    "budget": {
                        "total": 10000,
                        "currency": "TWD",
                        "expenses": []
                    },
                    "packingList": [],
                    "weather": [
                        {
                            "date": "YYYY-MM-DD",
                            "condition": "Sunny",
                            "tempLow": 20,
                            "tempHigh": 30,
                            "icon": ""
                        }
                    ]
                }
                `,responseMimeType:"application/json"}}),u=no(r);if(u){const c=u.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(c)}throw new Error("Empty response from AI")})},bw=async(n,e,t="zh-TW")=>{const i=hi[t]||hi["zh-TW"];return to(async r=>{const u=await r.models.generateContent({model:io,contents:`Help me modify an existing trip plan.
            
            Current Trip JSON:
            ${JSON.stringify(n)}
            
            User Request: "${e}"
            
            INSTRUCTIONS:
            1. Modify the "Current Trip JSON" based on the "User Request".
            2. Keep the same structure and fields.
            3. Update the "itinerary", "bookings", "budget", etc. as needed.
            4. Ensure the response is valid JSON matching the Trip structure.
            5. All content MUST be in ${i}.
            6. Return ONLY the updated JSON.
            `,config:{responseMimeType:"application/json"}}),c=no(u);if(c){const m=c.replace(/```json/g,"").replace(/```/g,"").trim();return JSON.parse(m)}throw new Error("Empty response from AI")})},Iw=async(n,e,t="zh-TW")=>{const i=hi[t]||hi["zh-TW"];return to(async r=>{const u=await r.models.generateContent({model:io,contents:`I hold a ${n} passport and want to travel to ${e}. 
            What are the visa requirements, entry rules, and any vaccination requirements? 
            Provide a concise summary in Markdown format. 
            Include a 'Difficulty Level' (Easy, Moderate, Hard) at the top.
            Response MUST be in ${i}.`});return no(u)})},Nw=async(n,e="zh-TW")=>{const t=hi[e]||hi["zh-TW"];return to(async i=>{const r=await i.models.generateContent({model:io,contents:`I am currently in (or planning to go to) ${n}. 
            Give me a quick guide on:
            1. Tipping customs (Restaurants, Taxis, Hotels).
            2. Major cultural taboos (Do's and Don'ts).
            3. Dress code advice.
            Keep it short, fun, and formatted in Markdown.
            Response MUST be in ${t}.`});return no(r)})},Rw=async(n,e,t="zh-TW")=>{const i=hi[t]||hi["zh-TW"];return to(async r=>{try{const u=await r.models.generateContent({model:io,contents:`Tell me about "${e}" at "${n}". 
                Provide a very short fun fact, the best photo spot, and one "pro tip" for visiting.
                Format as simple Markdown (bold keys). Keep it under 100 words.
                Response MUST be in ${i}.`});return no(u)}catch(u){return console.error("Error fetching attraction guide:",u),""}})},Mw=async(n,e="zh-TW")=>{const t=hi[e]||hi["zh-TW"];return to(async i=>{try{const r=await i.models.generateContent({model:io,contents:`I am travelling in ${n}. 
                List the emergency phone numbers for: Police, Ambulance, Fire.
                Also list the address and phone number of the nearest major hospital in the capital city.
                Format as a clear list.
                Response MUST be in ${t}.`});return no(r)}catch(r){return`: ${r instanceof Error?r.message:String(r)}`}})},Pw=async(n,e="zh-TW")=>{const t=hi[e]||hi["zh-TW"];return to(async i=>{try{const r=await i.models.generateContent({model:io,contents:`I am travelling to ${n}. 
                What kind of credit cards are best to use there (Visa, Mastercard, Amex, JCB)?
                Are cash payments preferred?
                Any tips on currency exchange or dynamic currency conversion (DCC)?
                Keep it concise.
                Response MUST be in ${t}.`});return no(r)}catch{return" Visa/Mastercard "}})},kw=async(n,e="zh-TW")=>to(async t=>{const i=n.map(c=>({id:c.id,activity:c.activity,location:c.location,time:c.time})),r=await t.models.generateContent({model:io,contents:`I have a list of activities for one day. Reorder them to create the most efficient geographical route.
            
            Current Items: ${JSON.stringify(i)}
            
            Return ONLY a JSON array of strings, where each string is the 'id' of the activity in the new order.
            Do not change the time, just the order of visiting.
            Example response: ["id1", "id3", "id2"]`,config:{responseMimeType:"application/json"}}),u=no(r);if(u)return JSON.parse(u);throw new Error("Empty response")}),Dw=async(n,e,t="zh-TW")=>to(async i=>{try{const r=await i.models.generateContent({model:io,contents:`Translate the following text to ${e}.
                Text: "${n}"
                
                Only provide the translated text.`});return no(r)}catch(r){return console.error("Translation Error:",r),null}}),Lw=async(n,e,t="zh-TW")=>{const i=hi[t]||hi["zh-TW"];return to(async r=>{try{const u=n.map(m=>`${m.date}: ${m.condition}, ${m.tempLow}C - ${m.tempHigh}C`).join(`
`),c=await r.models.generateContent({model:io,contents:`I am travelling to ${e}. Here is the weather forecast:
                ${u}
                
                Based on this weather, give me a VERY SHORT, ONE-LINE clothing advice summary.
                Example: "It's rainy and cold, so bring a heavy coat and umbrella."
                Keep it under 20 words.
                Response MUST be in ${i}.`});return no(c)}catch(u){return console.error("Clothing Advice Error:",u),""}})},Ig=async(n,e)=>to(async t=>{try{const i=await t.models.generateContent({model:io,contents:`What is the current exchange rate from ${n} to ${e}?
                Return ONLY the number. Example: 0.23
                If you are unsure, return "null".`}),r=no(i),u=parseFloat(r);return isNaN(u)?null:u.toString()}catch(i){return console.error("Exchange Rate Error:",i),null}}),RP=Object.freeze(Object.defineProperty({__proto__:null,editTravelPhoto:Aw,generateCoverImage:bg,generateTripPlan:Cw,getAttractionGuide:Rw,getClothingAdvice:Lw,getCreditCardAdvice:Pw,getCulturalEtiquette:Nw,getEmergencyInfo:Mw,getExchangeRate:Ig,getTranslation:Dw,getVisaRequirements:Iw,optimizeRoute:kw,updateTripPlan:bw},Symbol.toStringTag,{value:"Module"})),MP=({onSave:n,onCancel:e,settings:t})=>{const i=Wt[t.language]||Wt["zh-TW"],[r,u]=W.useState(""),[c,m]=W.useState(""),[g,p]=W.useState(""),[x,S]=W.useState(null),[C,M]=W.useState(!1),F=W.useRef(null),H=re=>{var Ee;const ee=(Ee=re.target.files)==null?void 0:Ee[0];if(ee){const pe=new FileReader;pe.onloadend=()=>{S(pe.result)},pe.readAsDataURL(ee)}},Y=async()=>{if(!r){alert("Please enter title");return}M(!0);try{const re=await bg(r);S(re)}catch(re){console.error(re),alert("Error")}finally{M(!1)}},ie=async re=>{if(re.preventDefault(),!r||!c)return;let ee=x;if(!ee)try{const pe=`Cinematic travel photography of ${r}, 4k, high quality, sunny day`,J=encodeURIComponent(pe),k=Math.floor(Math.random()*1e6);ee=`https://image.pollinations.ai/prompt/${J}?width=1600&height=900&nologo=true&seed=${k}&model=flux`}catch(pe){console.error("Failed to generate default cover",pe),ee=`https://via.placeholder.com/1600x900/D4A574/FFFFFF?text=${encodeURIComponent(r)}`}const Ee={id:Date.now().toString(),title:r,startDate:c,endDate:g,itinerary:[],coverImage:ee};n(Ee)};return E.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe pt-12",children:[E.jsxs("div",{className:"px-4 py-3 flex items-center gap-2 bg-paper sticky top-0 z-10 border-b border-sand/50",children:[E.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-white text-gray-500 active:scale-90 transition-transform",children:E.jsx(cs,{className:"w-6 h-6"})}),E.jsx("h2",{className:"text-lg font-bold text-ink",children:i.new_trip})]}),E.jsxs("form",{onSubmit:ie,className:"p-6 space-y-8 flex-1 overflow-y-auto no-scrollbar pb-32",children:[E.jsxs("div",{className:"space-y-3",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase",children:i.trip_destination_title}),E.jsx("div",{className:"relative",children:E.jsx("input",{type:"text",required:!0,value:r,onChange:re=>u(re.target.value),placeholder:"...",className:"w-full p-5 bg-white rounded-3xl border border-sand focus:border-coral focus:ring-1 focus:ring-coral/50 transition-all text-lg font-bold text-ink outline-none placeholder:text-gray-300 shadow-sm"})})]}),E.jsxs("div",{className:"space-y-3",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase",children:i.cover_photo}),E.jsxs("div",{className:"w-full aspect-video rounded-3xl overflow-hidden bg-white border-2 border-dashed border-sand relative shadow-inner",children:[x?E.jsx("img",{src:x,alt:"Cover",className:"w-full h-full object-cover"}):E.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-300",children:[E.jsx(hu,{className:"w-10 h-10 mb-2 opacity-50"}),E.jsx("span",{className:"text-xs font-bold",children:"Preview"})]}),x&&E.jsx("button",{type:"button",onClick:()=>S(null),className:"absolute top-2 right-2 bg-black/50 text-white p-1.5 rounded-full backdrop-blur-sm",children:E.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),E.jsxs("div",{className:"flex gap-3 mt-2",children:[E.jsxs("button",{type:"button",onClick:()=>{var re;return(re=F.current)==null?void 0:re.click()},className:"flex-1 py-3 bg-white text-gray-600 rounded-2xl font-bold text-sm border border-sand hover:border-coral hover:text-coral transition-colors flex items-center justify-center gap-1.5 shadow-sm",children:[E.jsx(hu,{className:"w-4 h-4"})," ",i.upload_photo]}),E.jsx("input",{type:"file",ref:F,className:"hidden",accept:"image/*",onChange:H}),E.jsx("button",{type:"button",onClick:Y,disabled:C||!r,className:"flex-1 py-3 bg-purple-50 text-purple-600 rounded-2xl font-bold text-sm hover:bg-purple-100 transition-colors flex items-center justify-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed border border-purple-100",children:C?E.jsx("span",{className:"animate-pulse",children:"..."}):E.jsxs(E.Fragment,{children:[E.jsx(sr,{className:"w-4 h-4"})," ",i.ai_generate_cover]})})]})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E.jsxs("div",{className:"space-y-3",children:[E.jsxs("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase flex items-center gap-1",children:[E.jsx(Mp,{className:"w-3 h-3 text-coral"})," ",i.start_date]}),E.jsx("input",{type:"date",required:!0,value:c,onChange:re=>m(re.target.value),className:"w-full p-4 bg-white rounded-2xl border border-sand focus:border-coral outline-none text-sm font-bold text-ink shadow-sm"})]}),E.jsxs("div",{className:"space-y-3",children:[E.jsxs("label",{className:"text-xs font-bold text-gray-400 ml-1 uppercase flex items-center gap-1",children:[E.jsx(Mp,{className:"w-3 h-3 text-gray-400"})," ",i.end_date]}),E.jsx("input",{type:"date",value:g,onChange:re=>p(re.target.value),className:"w-full p-4 bg-white rounded-2xl border border-sand focus:border-coral outline-none text-sm font-bold text-ink shadow-sm"})]})]}),E.jsxs("div",{className:"pt-4",children:[E.jsxs("button",{type:"submit",className:"w-full py-4 bg-coral text-white rounded-2xl font-bold text-lg shadow-float active:scale-[0.98] transition-all flex items-center justify-center gap-2 hover:bg-coralDark ring-4 ring-white",children:[E.jsx("span",{children:i.create_trip}),E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5 text-white/70",children:E.jsx("path",{fillRule:"evenodd",d:"M3 10a.75.75 0 01.75-.75h10.638L10.23 5.29a.75.75 0 111.04-1.08l5.5 5.25a.75.75 0 010 1.08l-5.5 5.25a.75.75 0 11-1.04-1.08l4.158-3.96H3.75A.75.75 0 013 10z",clipRule:"evenodd"})})]}),E.jsx("p",{className:"text-center text-xs text-gray-400 mt-6 font-medium",children:i.add_trip_hint})]})]})]})},PP=({settings:n})=>{const e=(n==null?void 0:n.language)||"zh-TW",t=Wt[e]||Wt["zh-TW"],[i,r]=W.useState(null),[u,c]=W.useState(null),[m,g]=W.useState(""),[p,x]=W.useState(!1),[S,C]=W.useState(null),M=W.useRef(null),F=Y=>{var re;const ie=(re=Y.target.files)==null?void 0:re[0];if(ie){const ee=new FileReader;ee.onloadend=()=>{const Ee=ee.result;r(Ee),c(null),C(null)},ee.readAsDataURL(ie)}},H=async()=>{if(!(!i||!m)){x(!0),C(null);try{const Y=await Aw(i,m);c(Y)}catch(Y){C("Error"),console.error(Y)}finally{x(!1)}}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[E.jsxs("div",{className:"px-5 py-4 bg-paper sticky top-0 z-10 flex items-center justify-between",children:[E.jsxs("h2",{className:"text-xl font-extrabold text-ink flex items-center gap-2",children:[E.jsx(sr,{className:"w-6 h-6 text-coral"}),t.magic_editor_title]}),E.jsx("span",{className:"text-[10px] font-bold bg-white text-coral border border-coral/20 px-2 py-1 rounded-lg uppercase tracking-wider shadow-sm",children:"Beta"})]}),E.jsx("div",{className:"flex-1 overflow-y-auto p-5 space-y-6 pb-32 no-scrollbar",children:i?E.jsxs("div",{className:"space-y-6 animate-fade-in",children:[E.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-6 snap-x no-scrollbar px-2",children:[E.jsxs("div",{className:"snap-center shrink-0 w-full bg-white p-3 pb-12 rounded-sm shadow-polaroid rotate-1 relative transition-transform hover:rotate-0 duration-300",children:[E.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden mb-2",children:E.jsx("img",{src:i,alt:"Original",className:"w-full h-full object-cover"})}),E.jsx("div",{className:"absolute bottom-4 left-4 font-handwriting text-gray-500 text-sm font-bold",children:"#Original"}),E.jsx("button",{onClick:()=>{r(null),c(null),g("")},className:"absolute -top-2 -right-2 bg-white text-ink p-2 rounded-full shadow-lg border border-sand hover:text-coral",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:E.jsx("path",{d:"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z"})})})]}),u&&E.jsxs("div",{className:"snap-center shrink-0 w-full bg-white p-3 pb-12 rounded-sm shadow-polaroid -rotate-1 relative transition-transform hover:rotate-0 duration-300 ring-2 ring-coral/20",children:[E.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden mb-2",children:E.jsx("img",{src:u,alt:"Magic Result",className:"w-full h-full object-cover"})}),E.jsxs("div",{className:"absolute bottom-4 left-4 font-handwriting text-coral font-bold flex items-center gap-1",children:[E.jsx(sr,{className:"w-4 h-4"})," #MagicEdit"]})]})]}),E.jsxs("div",{className:"bg-white p-2 rounded-3xl shadow-card border border-sand",children:[E.jsxs("div",{className:"p-4",children:[E.jsx("label",{className:"block text-sm font-bold text-gray-400 mb-2 uppercase tracking-wider",children:"Prompt"}),E.jsx("textarea",{value:m,onChange:Y=>g(Y.target.value),placeholder:t.magic_prompt_placeholder,className:"w-full p-4 rounded-2xl bg-paper border-0 focus:ring-2 focus:ring-coral/50 outline-none text-base resize-none h-24 placeholder:text-gray-300 font-medium text-ink"})]}),S&&E.jsxs("div",{className:"mx-4 mb-2 text-red-500 text-xs bg-red-50 p-3 rounded-xl flex items-center gap-2 font-bold",children:[E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-4 h-4",children:E.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),S]}),E.jsx("div",{className:"p-2",children:E.jsx("button",{onClick:H,disabled:p||!m.trim(),className:`w-full py-4 rounded-2xl font-bold text-white shadow-lg flex items-center justify-center gap-2 transition-all ${p||!m.trim()?"bg-gray-300 cursor-not-allowed text-gray-500 shadow-none":"bg-coral hover:bg-coralDark hover:shadow-coral/30 active:scale-[0.98]"}`,children:p?E.jsxs(E.Fragment,{children:[E.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[E.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),E.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.generating]}):E.jsxs(E.Fragment,{children:[E.jsx(sr,{className:"w-5 h-5 stroke-[2]"}),t.start_magic]})})})]})]}):E.jsxs("div",{onClick:()=>{var Y;return(Y=M.current)==null?void 0:Y.click()},className:"border-2 border-dashed border-sand rounded-3xl h-80 flex flex-col items-center justify-center bg-white cursor-pointer active:scale-[0.98] transition-all hover:border-coral hover:bg-white/80 group shadow-card",children:[E.jsx("div",{className:"w-20 h-20 bg-paper rounded-full shadow-inner flex items-center justify-center mb-5 group-hover:scale-110 transition-transform",children:E.jsx(hu,{className:"w-10 h-10 text-coral"})}),E.jsx("span",{className:"text-ink font-bold text-lg",children:t.upload_hint}),E.jsx("input",{type:"file",ref:M,onChange:F,className:"hidden",accept:"image/*"})]})})]})},kP="modulepreload",DP=function(n){return"/"+n},aE={},nf=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(p){return Promise.all(p.map(x=>Promise.resolve(x).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),g=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));r=c(t.map(p=>{if(p=DP(p),p in aE)return;aE[p]=!0;const x=p.endsWith(".css"),S=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${S}`))return;const C=document.createElement("link");if(C.rel=x?"stylesheet":kP,x||(C.as="script"),C.crossOrigin="",C.href=p,g&&C.setAttribute("nonce",g),document.head.appendChild(C),x)return new Promise((M,F)=>{C.addEventListener("load",M),C.addEventListener("error",()=>F(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(c){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=c,window.dispatchEvent(m),!m.defaultPrevented)throw c}return r.then(c=>{for(const m of c||[])m.status==="rejected"&&u(m.reason);return e().catch(u)})},LP=({items:n,onUpdateItems:e,settings:t})=>{const i=Wt[t.language]||Wt["zh-TW"],[r,u]=W.useState(""),[c,m]=W.useState(""),[g,p]=W.useState(!1),x=()=>{if(!r.trim())return;const M={id:Date.now().toString(),item:r,bought:!1,notes:c},F=[...n,M];e(F),u(""),m(""),p(!1)},S=M=>{const F=n.map(H=>H.id===M?{...H,bought:!H.bought}:H);e(F)},C=M=>{if(confirm(i.delete_trip_confirm.replace("{title}",i.shopping_list))){const F=n.filter(H=>H.id!==M);e(F)}};return E.jsxs("div",{className:"pb-40",children:[E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-soft text-center mt-2 border border-sand relative overflow-hidden mb-6",children:[E.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-coral"}),E.jsx("h3",{className:"text-gray-400 text-sm font-bold uppercase tracking-widest mb-2",children:i.shopping_list}),E.jsxs("div",{className:"text-5xl font-black text-ink mb-2 tracking-tight",children:[(n==null?void 0:n.filter(M=>M.bought).length)||0,E.jsx("span",{className:"text-2xl text-gray-300 mx-2",children:"/"}),E.jsx("span",{className:"text-3xl text-gray-400",children:(n==null?void 0:n.length)||0})]})]}),(n==null?void 0:n.length)>0?E.jsx("div",{className:"space-y-3",children:n==null?void 0:n.map(M=>E.jsxs("div",{className:`bg-white p-4 rounded-2xl border ${M.bought?"border-green-200 bg-green-50/30":"border-sand"} shadow-card flex items-center justify-between group transition-all`,children:[E.jsxs("div",{className:"flex items-center gap-4 flex-1",onClick:()=>S(M.id),children:[E.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center cursor-pointer transition-colors ${M.bought?"bg-green-500 border-green-500":"border-gray-300 hover:border-coral"}`,children:M.bought&&E.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),E.jsxs("div",{children:[E.jsx("div",{className:`font-bold text-lg ${M.bought?"text-gray-400 line-through":"text-ink"}`,children:M.item}),M.notes&&E.jsx("div",{className:"text-xs text-gray-400 font-medium mt-0.5",children:M.notes})]})]}),E.jsx("button",{onClick:()=>C(M.id),className:"p-2 text-gray-300 hover:text-red-500 transition-colors",children:E.jsx(or,{className:"w-5 h-5"})})]},M.id))}):E.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[E.jsx("div",{className:"w-16 h-16 bg-sand/30 rounded-full flex items-center justify-center text-gray-400",children:E.jsx(Jx,{className:"w-8 h-8"})}),E.jsxs("p",{className:"text-gray-400 font-medium",children:[i.no_itinerary,E.jsx("br",{}),E.jsx("span",{className:"text-xs",children:i.click_add})]})]}),g&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>p(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:M=>M.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_activity}),E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.activity_name}),E.jsx("input",{value:r,onChange:M=>u(M.target.value),placeholder:i.shopping_list,className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal",autoFocus:!0})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.notes}),E.jsx("input",{value:c,onChange:M=>m(M.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-medium border-none shadow-sm outline-none placeholder:font-normal"})]}),E.jsx("button",{onClick:x,disabled:!r.trim(),className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 mt-4 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:i.confirm})]})]})}),E.jsx("button",{onClick:()=>p(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-coral text-white rounded-full shadow-xl shadow-coral/40 flex items-center justify-center z-30 hover:bg-coralDark active:scale-90 transition-all",children:E.jsx(Qh,{className:"w-8 h-8 stroke-[2]"})})]})},VP=({trip:n,settings:e,onUpdateTrip:t,onOpenQuickExpense:i})=>{var jt;const r=Wt[e.language]||Wt["zh-TW"],[u,c]=W.useState(null),[m,g]=W.useState(""),[p,x]=W.useState(!1),[S,C]=W.useState(!1),M=W.useRef(null),[F,H]=W.useState(!1),[Y,ie]=W.useState(null),[re,ee]=W.useState(1),[Ee,pe]=W.useState("09:00"),[J,k]=W.useState(""),[U,V]=W.useState(""),[B,q]=W.useState(""),[K,z]=W.useState(null),[Le,Xe]=W.useState("TRAIN"),[te,Se]=W.useState(""),[Ae,We]=W.useState(""),[Ne,j]=W.useState(null),[he,be]=W.useState(!1),ce=W.useMemo(()=>{const ye=n.itinerary||[],qe={};return[...ye].sort((Dt,dt)=>Dt.time.localeCompare(dt.time)).forEach(Dt=>{const dt=Dt.day||1;qe[dt]||(qe[dt]=[]),qe[dt].push(Dt)}),qe},[n.itinerary]),me=W.useMemo(()=>Object.keys(ce).map(Number).sort((ye,qe)=>ye-qe),[ce]);W.useEffect(()=>{u||Je()},[u]),W.useEffect(()=>()=>{window.speechSynthesis.cancel()},[]);const Ce=async()=>{const ye=[`${n.title} (${n.startDate} - ${n.endDate})`];me.forEach(Qe=>{ye.push(`
Day ${Qe}:`),ce[Qe].forEach(Dt=>{ye.push(`${Dt.time} ${Dt.activity}`),Dt.travelToNext&&ye.push(`   ${Dt.travelToNext.mode} (${Dt.travelToNext.duration})`)})});const qe=ye.join(`
`);try{navigator.share?await navigator.share({title:n.title,text:qe}):(await navigator.clipboard.writeText(qe),alert(r.share_success))}catch(Qe){console.error("Error sharing:",Qe)}},_e=async()=>{if(!(!n.weather||n.weather.length===0)){be(!0);try{const ye=await Lw(n.weather,n.title,e.language);j(ye)}catch{j("")}finally{be(!1)}}},Pe=async(ye,qe)=>{c({name:ye,location:qe}),g(""),x(!0);try{const Qe=await Rw(qe,ye);g(Qe||"")}catch{g("")}finally{x(!1)}},ke=()=>{if(S){Je();return}if(!m)return;const ye=new SpeechSynthesisUtterance(m);ye.lang=e.language==="en-US"?"en-US":"zh-TW",ye.rate=1,ye.onend=()=>C(!1),M.current=ye,window.speechSynthesis.speak(ye),C(!0)},Je=()=>{window.speechSynthesis.cancel(),C(!1)},wt=async ye=>{const qe=ce[ye];if(!qe||(qe==null?void 0:qe.length)<3){alert(r.optimize_route_min_items||"Need at least 3 items to optimize.");return}z(ye);try{const Dt=(await kw(qe,e.language)).map(Ie=>qe.find(ut=>ut.id===Ie)).filter(Boolean),dt=qe.map(Ie=>Ie.time).sort(),an=Dt.map((Ie,ut)=>({...Ie,time:dt[ut]})),_i=[...(n.itinerary||[]).filter(Ie=>Ie.day!==ye),...an];t==null||t({...n,itinerary:_i})}catch(Qe){console.error("Optimization failed",Qe),alert("Route optimization failed.")}finally{z(null)}},Ze=ye=>{ie(ye.id),ee(ye.day),pe(ye.time),k(ye.activity),V(ye.location),q(ye.notes||""),ye.travelToNext?(Xe(ye.travelToNext.mode),Se(ye.travelToNext.duration),We(ye.travelToNext.details||"")):(Se(""),We("")),H(!0)},Jt=async()=>{var dt;if(!J)return;let ye=null;if(U)try{const{geocodeAddress:an}=await nf(async()=>{const{geocodeAddress:Ie}=await Promise.resolve().then(()=>o5);return{geocodeAddress:Ie}},void 0),gi=an(U),_i=new Promise((Ie,ut)=>setTimeout(()=>ut(new Error("Geocoding timeout")),5e3));ye=await Promise.race([gi,_i])}catch(an){console.error("Auto-geocoding failed or timed out",an)}const qe=Y?(dt=n.itinerary)==null?void 0:dt.find(an=>an.id===Y):null,Qe={id:Y||Date.now().toString(),day:Number(re),time:Ee,activity:J,location:U,notes:B,coordinates:ye||(qe==null?void 0:qe.coordinates)||null,lat:(ye==null?void 0:ye.lat)??(qe==null?void 0:qe.lat)??null,lng:(ye==null?void 0:ye.lng)??(qe==null?void 0:qe.lng)??null,attachments:(qe==null?void 0:qe.attachments)||[],...te?{travelToNext:{mode:Le,duration:te,details:Ae}}:{}};let Dt;Y?Dt=(n.itinerary||[]).map(an=>an.id===Y?Qe:an):Dt=[...n.itinerary||[],Qe],t==null||t({...n,itinerary:Dt}),ie(null),k(""),V(""),q(""),Se(""),We(""),H(!1)},fn=ye=>{if(confirm(r.delete_trip_confirm.replace("{title}",r.itinerary))){const qe=(n.itinerary||[]).filter(Qe=>Qe.id!==ye);t==null||t({...n,itinerary:qe})}},mi=ye=>{ye&&window.open(ye,"_blank")},ei=ye=>{switch(ye){case"WALK":return E.jsx(QC,{className:"w-4 h-4"});case"TRAIN":return E.jsx(L0,{className:"w-4 h-4"});case"BUS":return E.jsx(JC,{className:"w-4 h-4"});case"CAR":return E.jsx(zC,{className:"w-4 h-4"});case"FLIGHT":return E.jsx(Gx,{className:"w-4 h-4"});default:return E.jsx(L0,{className:"w-4 h-4"})}},pi=()=>{var ye,qe;return!n.weather||((ye=n.weather)==null?void 0:ye.length)===0?null:E.jsxs("div",{className:"mb-6",children:[E.jsxs("div",{className:"flex items-center justify-between mb-3",children:[E.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1",children:r.weather}),E.jsxs("button",{onClick:_e,disabled:he,className:"text-xs font-bold text-coral flex items-center gap-1 hover:bg-coral/10 px-2 py-1 rounded-lg transition-colors",children:[E.jsx(Pp,{className:"w-3 h-3"}),he?"...":""]})]}),E.jsx("div",{className:"flex gap-3 overflow-x-auto no-scrollbar pb-2",children:(qe=n.weather)==null?void 0:qe.map((Qe,Dt)=>E.jsxs("div",{className:"flex-shrink-0 flex flex-col items-center justify-center gap-1 bg-white border border-sand p-3 rounded-2xl min-w-[70px] shadow-sm",children:[E.jsx("span",{className:"text-[10px] font-bold text-gray-400",children:Qe.date}),E.jsx("span",{className:"text-2xl drop-shadow-sm",children:Qe.icon}),E.jsxs("span",{className:"text-xs font-bold text-ink",children:[Qe.tempHigh,""]})]},Dt))}),Ne&&E.jsxs("div",{className:"mt-4 bg-white p-5 rounded-3xl shadow-card border border-sand animate-fade-in relative",children:[E.jsx("button",{onClick:()=>j(null),className:"absolute top-3 right-3 text-gray-300 hover:text-gray-500",children:E.jsx(or,{className:"w-4 h-4"})}),E.jsxs("div",{className:"flex items-start gap-3",children:[E.jsx("div",{className:"bg-orange-100 p-2 rounded-full text-orange-500 shrink-0",children:E.jsx(Pp,{className:"w-5 h-5"})}),E.jsxs("div",{children:[E.jsx("h5",{className:"font-bold text-ink mb-2",children:"AI "}),E.jsx("div",{className:"prose prose-sm text-gray-600 leading-relaxed whitespace-pre-line",children:Ne})]})]})]})]})},vn=e==null?void 0:e.minimalistMode;return E.jsxs("div",{className:"pb-40 relative min-h-full",children:[E.jsxs("div",{className:"sticky top-0 z-20 bg-paper/95 backdrop-blur-md border-b border-sand/50 py-3 mb-6 -mx-5 px-5 flex items-center justify-between shadow-sm",children:[E.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar flex-1 mr-2",children:[E.jsx("span",{className:"text-xs font-bold text-gray-400 shrink-0 mr-1",children:r.nav_quick_jump}),me.map(ye=>E.jsxs("button",{onClick:()=>{const qe=document.getElementById(`day-header-${ye}`);qe&&qe.scrollIntoView({behavior:"smooth",block:"start"})},className:"flex-shrink-0 px-4 py-1.5 bg-white border border-sand rounded-full font-bold text-ink text-xs hover:border-coral hover:text-coral hover:shadow-md active:bg-coral active:text-white transition-all whitespace-nowrap",children:[r.day," ",ye]},`nav-${ye}`))]}),E.jsx("button",{onClick:Ce,className:"p-2 bg-white rounded-full border border-sand text-coral hover:bg-coral hover:text-white transition-colors shadow-sm shrink-0",children:E.jsx(WC,{className:"w-5 h-5"})})]}),!vn&&pi(),((jt=n.itinerary)==null?void 0:jt.length)>0?E.jsxs("div",{children:[!vn&&E.jsx("h4",{className:"text-xs font-bold text-gray-400 mb-4 uppercase tracking-wider ml-1",children:r.itinerary}),me.map(ye=>{var qe;return E.jsxs("div",{className:"mb-8 scroll-mt-48",id:`day-header-${ye}`,children:[E.jsxs("div",{className:"flex items-center gap-3 mb-4 sticky top-[60px] bg-paper py-2 z-10 border-b border-sand/50 shadow-sm",children:[E.jsxs("div",{className:"bg-coral text-white px-3 py-1 rounded-lg text-sm font-bold shadow-sm",children:[r.day," ",ye]}),E.jsx("div",{className:"h-px bg-sand flex-1"}),E.jsxs("button",{onClick:()=>wt(ye),disabled:K===ye,className:"flex items-center gap-1 text-xs font-bold text-coral bg-white border border-coral px-2 py-1 rounded-lg hover:bg-coral hover:text-white transition-colors disabled:opacity-50",children:[K===ye?E.jsx("div",{className:"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin"}):E.jsx(sr,{className:"w-3 h-3"}),r.optimize_route||"AI Route"]})]}),E.jsx("div",{className:`space-y-0 relative ${vn?"":"border-l-2 border-sand ml-4"}`,children:(qe=ce[ye])==null?void 0:qe.map((Qe,Dt)=>E.jsxs("div",{className:"relative group",children:[E.jsxs("div",{className:`relative ${vn?"mb-4 border-b border-sand pb-4":"pl-8 pb-10 last:pb-0"}`,children:[!vn&&E.jsx("div",{className:"absolute -left-[7px] top-1.5 w-3.5 h-3.5 rounded-full border-2 border-paper shadow-sm bg-gray-300 group-hover:bg-coral transition-colors"}),E.jsxs("div",{className:"transition-all opacity-90 group-hover:opacity-100",children:[E.jsxs("div",{className:"flex items-center justify-between mb-2",children:[E.jsx("div",{className:"flex items-center gap-2",children:E.jsx("span",{className:"text-xs font-bold font-mono text-coral bg-coral/10 px-2 py-1 rounded-lg",children:Qe.time})}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("button",{onClick:dt=>{dt.stopPropagation(),i(Qe)},className:"p-1.5 bg-white text-gray-400 rounded-full border border-sand hover:text-green-600 hover:border-green-600 shadow-sm",title:"",children:E.jsx(jx,{className:"w-3 h-3"})}),E.jsx("button",{onClick:dt=>{dt.stopPropagation(),Ze(Qe)},className:"p-1.5 bg-white text-gray-400 rounded-full border border-sand hover:text-coral hover:border-coral shadow-sm",title:"",children:E.jsx(Wx,{className:"w-3 h-3"})}),E.jsx("button",{onClick:dt=>{dt.stopPropagation(),fn(Qe.id)},className:"p-1.5 bg-white text-red-400 rounded-full border border-red-200 hover:bg-red-50 hover:text-red-600 hover:border-red-500 shadow-sm transition-colors",title:"",children:E.jsx(or,{className:"w-3 h-3"})})]})]}),E.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-card border border-transparent hover:border-sand transition-all relative",children:[E.jsx("button",{onClick:dt=>{dt.stopPropagation(),Pe(Qe.activity,Qe.location)},className:"absolute top-4 right-4 text-gray-300 hover:text-coral transition-colors",children:E.jsx(BC,{className:"w-5 h-5"})}),E.jsx("h4",{className:`font-bold text-ink ${vn?"text-base":"text-lg"} mb-1 pr-6`,children:Qe.activity}),E.jsxs("div",{onClick:()=>mi(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(Qe.location)}`),className:"flex items-center gap-1.5 text-sm text-gray-500 cursor-pointer hover:text-coral truncate mt-1",children:[E.jsx(Rp,{className:"w-3.5 h-3.5 shrink-0 text-coral"}),Qe.location]}),Qe.notes&&!vn&&E.jsx("p",{className:"text-sm text-gray-600 mt-3 pt-3 border-t border-gray-50 leading-relaxed",children:Qe.notes})]})]})]}),Qe.travelToNext&&!vn&&E.jsxs("div",{className:"pl-8 pb-10 relative",children:[E.jsx("div",{className:"absolute left-[0px] top-0 bottom-0 w-0.5 border-l-2 border-dotted border-gray-300 -ml-[1px]"}),E.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-sand rounded-xl p-3 w-fit max-w-[80%]",children:[E.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-sand flex items-center justify-center text-gray-500 shadow-sm shrink-0",children:ei(Qe.travelToNext.mode)}),E.jsx("div",{children:E.jsxs("div",{className:"text-xs font-bold text-gray-500 flex items-center gap-1",children:[Qe.travelToNext.duration,Qe.travelToNext.details&&E.jsxs("span",{className:"font-normal text-gray-400",children:[" ",Qe.travelToNext.details]})]})})]})]})]},Qe.id||Dt))})]},ye)})]}):E.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[E.jsx("div",{className:"w-16 h-16 bg-sand/30 rounded-full flex items-center justify-center text-gray-400",children:E.jsx(Yx,{className:"w-8 h-8"})}),E.jsxs("p",{className:"text-gray-400 font-medium",children:[r.no_itinerary,E.jsx("br",{}),E.jsx("span",{className:"text-xs",children:r.click_add})]})]}),u&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>c(null),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[80vh] overflow-y-auto",onClick:ye=>ye.stopPropagation(),children:[E.jsxs("div",{className:"flex items-center justify-between mb-4",children:[E.jsx("h3",{className:"text-xl font-bold text-ink",children:u.name}),E.jsx("button",{onClick:ke,className:`p-2 rounded-full ${S?"bg-coral text-white":"bg-gray-100 text-gray-500"}`,children:E.jsx(OP,{className:"w-5 h-5"})})]}),p?E.jsx("div",{className:"flex justify-center py-10",children:E.jsx("div",{className:"w-8 h-8 border-4 border-coral border-t-transparent rounded-full animate-spin"})}):E.jsx("div",{className:"prose prose-sm text-gray-600 leading-relaxed whitespace-pre-line",children:m})]})}),F&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>H(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",onClick:ye=>ye.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:Y?r.edit_activity:r.add_activity}),E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.day}),E.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-sand px-3",children:[E.jsx("span",{className:"text-sm font-bold text-gray-400 mr-2",children:r.day}),E.jsx("input",{type:"number",min:"1",value:re,onChange:ye=>ee(parseInt(ye.target.value)||1),className:"w-full bg-transparent p-3 text-lg font-bold border-none outline-none"})]})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.time}),E.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-sand px-3",children:[E.jsx(UC,{className:"w-5 h-5 text-gray-400 mr-2"}),E.jsx("input",{type:"time",value:Ee,onChange:ye=>pe(ye.target.value),className:"w-full bg-transparent p-3 text-lg font-bold border-none outline-none"})]})]})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.activity_name}),E.jsx("input",{value:J,onChange:ye=>k(ye.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300",autoFocus:!0})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.location}),E.jsx("input",{value:U,onChange:ye=>V(ye.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300"})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:r.notes}),E.jsx("textarea",{value:B,onChange:ye=>q(ye.target.value),placeholder:"...",className:"w-full bg-white p-4 rounded-xl text-base font-medium border-none shadow-sm outline-none placeholder:font-normal placeholder:text-gray-300 min-h-[80px]"})]}),E.jsxs("div",{className:"pt-4 border-t border-sand",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1 mb-2 block",children:r.travel_to_next}),E.jsx("div",{className:"flex gap-2 mb-3 overflow-x-auto no-scrollbar",children:["WALK","TRAIN","BUS","CAR","FLIGHT"].map(ye=>E.jsx("button",{onClick:()=>Xe(ye),className:`p-2 rounded-lg border ${Le===ye?"bg-ink text-white border-ink":"bg-white text-gray-400 border-sand"}`,children:ei(ye)},ye))}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsx("input",{value:te,onChange:ye=>Se(ye.target.value),placeholder:"1h 30m",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"}),E.jsx("input",{value:Ae,onChange:ye=>We(ye.target.value),placeholder:"Details...",className:"w-full bg-white p-3 rounded-xl text-sm font-medium border-none shadow-sm outline-none"})]})]}),E.jsx("div",{className:"sticky bottom-0 bg-paper pt-4 mt-4 border-t border-sand z-10 pb-20",children:E.jsx("button",{onClick:Jt,disabled:!J,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:Y?r.confirm:r.add_activity})})]})]})}),E.jsx("button",{onClick:()=>{ie(null),ee(1),pe("09:00"),k(""),V(""),q(""),Se(""),We(""),H(!0)},className:"fixed bottom-24 right-6 w-14 h-14 bg-coral text-white rounded-full shadow-xl shadow-coral/40 flex items-center justify-center z-30 hover:bg-coralDark active:scale-90 transition-all",children:E.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})},OP=({className:n})=>E.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:n,children:[E.jsx("path",{d:"M13.5 4.06c0-1.336-1.616-2.005-2.56-1.06l-4.5 4.5H4.508c-1.141 0-2.318.664-2.66 1.905A9.76 9.76 0 001.5 12c0 .898.121 1.768.35 2.595.341 1.24 1.518 1.905 2.659 1.905h1.93l4.5 4.5c.945.945 2.561.276 2.561-1.06V4.06zM18.584 5.106a.75.75 0 011.06 0c3.808 3.807 3.808 9.98 0 13.788a.75.75 0 11-1.06-1.06 8.25 8.25 0 000-11.668.75.75 0 010-1.06z"}),E.jsx("path",{d:"M15.932 7.757a.75.75 0 011.061 0 6 6 0 010 8.486.75.75 0 01-1.06-1.061 4.5 4.5 0 000-6.364.75.75 0 010-1.06z"})]}),Ng=[{code:"TWD",symbol:"NT$",name:""},{code:"JPY",symbol:"",name:""},{code:"USD",symbol:"$",name:""},{code:"EUR",symbol:"",name:""},{code:"KRW",symbol:"",name:""},{code:"CNY",symbol:"",name:""},{code:"HKD",symbol:"HK$",name:""},{code:"GBP",symbol:"",name:""},{code:"THB",symbol:"",name:""},{code:"SGD",symbol:"S$",name:""}],el=n=>{const e=Ng.find(t=>t.code===n);return e?e.symbol:n},UP=({trip:n,settings:e,onUpdateTrip:t})=>{var Ae,We,Ne,j,he,be,ce,me,Ce;const i=Wt[e.language]||Wt["zh-TW"],[r,u]=W.useState(!1),[c,m]=W.useState(""),[g,p]=W.useState(""),[x,S]=W.useState(""),[C,M]=W.useState("Cash"),[F,H]=W.useState(((Ae=n.budget)==null?void 0:Ae.currency)||"TWD"),[Y,ie]=W.useState(""),[re,ee]=W.useState(0),[Ee,pe]=W.useState(!1),[J,k]=W.useState(!1),[U,V]=W.useState(""),B=()=>{var Pe,ke;const _e=parseInt(U);if(!isNaN(_e)&&_e>=0){const Je={...n,budget:{...n.budget,total:_e,currency:((Pe=n.budget)==null?void 0:Pe.currency)||"TWD",expenses:((ke=n.budget)==null?void 0:ke.expenses)||[]}};t==null||t(Je)}k(!1)};W.useEffect(()=>{var _e;r&&(H(((_e=n.budget)==null?void 0:_e.currency)||"TWD"),ie(""))},[r,(We=n.budget)==null?void 0:We.currency]),W.useEffect(()=>{(async()=>{var ke;const Pe=((ke=n.budget)==null?void 0:ke.currency)||"TWD";if(F!==Pe&&e.apiKey){pe(!0);try{const Je=await Ig(F,Pe);Je?ie(Je):console.warn("Failed to fetch rate")}catch(Je){console.error(Je)}pe(!1)}})()},[F,(Ne=n.budget)==null?void 0:Ne.currency,e.apiKey]),W.useEffect(()=>{const _e=parseFloat(g)||0,Pe=parseFloat(Y)||1;ee(Math.round(_e*Pe))},[g,Y]);const q=()=>{var Jt,fn,mi;if(!c||!g)return;const _e=parseFloat(g);if(_e<=0){alert(i.amount_invalid||"Amount must be greater than 0");return}const Pe=parseFloat(Y)||1,ke=Math.round(_e*Pe),Je={id:Date.now().toString(),title:c,amount:ke,category:"Other",date:new Date().toISOString().split("T")[0],payer:x||"ME",paymentMethod:C,originalCurrency:F,originalAmount:_e,exchangeRate:Pe},wt=((Jt=n.budget)==null?void 0:Jt.expenses)||[],Ze={...n,budget:{...n.budget,total:((fn=n.budget)==null?void 0:fn.total)||0,currency:((mi=n.budget)==null?void 0:mi.currency)||"TWD",expenses:[Je,...wt]}};t==null||t(Ze),u(!1),m(""),p("")},K=_e=>{var Pe,ke,Je;if(confirm(i.delete_trip_confirm.replace("{title}",i.expense_item))){const Ze=(((Pe=n.budget)==null?void 0:Pe.expenses)||[]).filter(fn=>fn.id!==_e),Jt={...n,budget:{...n.budget,total:((ke=n.budget)==null?void 0:ke.total)||0,currency:((Je=n.budget)==null?void 0:Je.currency)||"TWD",expenses:Ze}};t==null||t(Jt)}},z=(((j=n.budget)==null?void 0:j.expenses)||[]).reduce((_e,Pe)=>_e+Pe.amount,0),Le=((he=n.budget)==null?void 0:he.total)||0,Xe=Le>0?Math.min(z/Le*100,100):0,te=((be=n.budget)==null?void 0:be.currency)||"TWD",Se=el(te);return E.jsxs("div",{className:"pb-32",children:[E.jsxs("div",{className:"bg-ink text-white p-6 rounded-3xl shadow-xl mb-8 relative overflow-hidden",children:[E.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -mr-10 -mt-10 blur-2xl"}),E.jsxs("div",{className:"relative z-10",children:[E.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-1",children:i.budget_total}),E.jsx("div",{className:"flex items-center gap-2 mb-6 group",children:J?E.jsxs("div",{className:"flex items-center",children:[E.jsx("span",{className:"text-2xl mr-1 font-black",children:Se}),E.jsx("input",{type:"number",value:U,onChange:_e=>V(_e.target.value),onBlur:B,onKeyDown:_e=>_e.key==="Enter"&&B(),className:"bg-transparent text-4xl font-black text-white border-b-2 border-white/20 outline-none w-48",autoFocus:!0})]}):E.jsxs("h2",{className:"text-4xl font-black cursor-pointer hover:opacity-80 transition-opacity flex items-center gap-2",onClick:()=>{V(Le.toString()),k(!0)},children:[E.jsx("span",{className:"text-2xl mr-1",children:Se}),Le.toLocaleString(),E.jsx("svg",{className:"w-5 h-5 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]})}),E.jsxs("div",{className:"mb-2 flex justify-between text-sm font-bold",children:[E.jsx("span",{className:"text-gray-300",children:i.budget_spent}),E.jsxs("span",{children:[Se,z.toLocaleString()]})]}),E.jsx("div",{className:"h-3 bg-gray-700 rounded-full overflow-hidden mb-4",children:E.jsx("div",{className:`h-full rounded-full ${Xe>90?"bg-red-500":"bg-coral"}`,style:{width:`${Xe}%`}})}),E.jsxs("div",{className:"flex justify-between text-xs text-gray-400 font-medium",children:[E.jsxs("span",{children:[Xe.toFixed(1),"%"]}),E.jsxs("span",{children:[": ",Se,z.toLocaleString()]})]})]})]}),E.jsxs("div",{className:"space-y-4",children:[E.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider ml-1 mb-2",children:i.expense_list}),(me=(ce=n.budget)==null?void 0:ce.expenses)==null?void 0:me.map(_e=>{var Pe;return E.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-sand flex items-center justify-between group",children:[E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold ${_e.payer==="ME"?"bg-coral/10 text-coral":"bg-gray-100 text-gray-500"}`,children:_e.payer==="ME"?"":""}),E.jsxs("div",{children:[E.jsx("h4",{className:"font-bold text-ink",children:_e.title}),E.jsxs("p",{className:"text-xs text-gray-400",children:[_e.date,"  ",_e.paymentMethod]}),_e.originalCurrency&&_e.originalCurrency!==te&&E.jsxs("p",{className:"text-xs text-coral font-medium mt-0.5",children:[el(_e.originalCurrency),(Pe=_e.originalAmount)==null?void 0:Pe.toLocaleString(),E.jsx("span",{className:"text-gray-400 mx-1",children:""}),_e.exchangeRate]}),_e.note&&E.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:_e.note})]})]}),E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsxs("span",{className:"font-bold text-ink text-lg",children:[Se,_e.amount.toLocaleString()]}),E.jsx("button",{onClick:()=>K(_e.id),className:"text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all",children:E.jsx(or,{className:"w-5 h-5"})})]})]},_e.id)}),(!((Ce=n.budget)!=null&&Ce.expenses)||n.budget.expenses.length===0)&&E.jsx("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:i.no_expenses})]}),r&&E.jsx("div",{className:"fixed inset-0 z-[100] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>u(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up relative",onClick:_e=>_e.stopPropagation(),children:[E.jsx("button",{onClick:()=>u(!1),className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600 transition-colors",children:E.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),E.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_expense}),E.jsxs("div",{className:"space-y-4",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.expense_item}),E.jsx("input",{value:c,onChange:_e=>m(_e.target.value),placeholder:": ",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none placeholder:font-normal",autoFocus:!0,onFocus:_e=>_e.target.select()})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.amount}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("select",{value:F,onChange:_e=>H(_e.target.value),className:"bg-white rounded-xl border-none shadow-sm px-3 font-bold text-ink outline-none",children:Ng.map(_e=>E.jsx("option",{value:_e.code,children:_e.code},_e.code))}),E.jsxs("div",{className:"flex-1 flex items-center bg-white rounded-xl border-none shadow-sm px-4",children:[E.jsx("span",{className:"text-gray-400 font-bold mr-2",children:el(F)}),E.jsx("input",{value:g,onChange:_e=>p(_e.target.value),type:"number",placeholder:"0",className:"w-full bg-transparent py-4 text-xl font-bold border-none outline-none placeholder:font-normal",onFocus:_e=>_e.target.select()})]})]})]}),F!==te&&E.jsxs("div",{className:"space-y-1 bg-sand/30 p-3 rounded-xl",children:[E.jsxs("div",{className:"flex justify-between items-center mb-2",children:[E.jsxs("label",{className:"text-xs font-bold text-gray-500",children:[" (",F,"  ",te,")"]}),E.jsxs("span",{className:"text-xs font-bold text-coral",children:[" ",Se,re.toLocaleString()]})]}),E.jsxs("div",{className:"relative",children:[E.jsx("input",{value:Y,onChange:_e=>ie(_e.target.value),type:"number",step:"0.01",placeholder:Ee?"...":"Exchange Rate",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none",onFocus:_e=>_e.target.select(),disabled:Ee}),Ee&&E.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:E.jsx("div",{className:"w-4 h-4 border-2 border-coral border-t-transparent rounded-full animate-spin"})})]}),!e.apiKey&&E.jsx("p",{className:"text-[10px] text-red-400 mt-1",children:"*  API Key "})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{className:"flex bg-white rounded-xl p-1 shadow-sm",children:[E.jsx("button",{onClick:()=>S("ME"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${x==="ME"||x===""?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payer_me}),E.jsx("button",{onClick:()=>S("OTHER"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${x==="OTHER"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payer_other})]}),E.jsxs("div",{className:"flex bg-white rounded-xl p-1 shadow-sm",children:[E.jsx("button",{onClick:()=>M("Cash"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${C==="Cash"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payment_cash}),E.jsx("button",{onClick:()=>M("Card"),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all ${C==="Card"?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:i.payment_card})]})]}),E.jsx("div",{className:"space-y-1",children:E.jsxs("select",{className:"w-full bg-white p-3 rounded-xl font-bold text-ink border-none shadow-sm outline-none h-[48px] text-center",children:[E.jsx("option",{value:"Individual",children:i.split_individual}),E.jsx("option",{value:"Shared",children:i.split_shared})]})}),E.jsxs("div",{className:"space-y-3 pt-2",children:[E.jsx("button",{onClick:q,disabled:!c||!g,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:"+ "}),E.jsx("button",{onClick:()=>u(!1),className:"w-full py-3 bg-transparent text-gray-400 font-bold hover:text-gray-600 transition-colors",children:""})]})]})]})}),E.jsx("button",{onClick:()=>u(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-ink text-white rounded-full shadow-xl shadow-ink/40 flex items-center justify-center z-30 hover:scale-105 active:scale-95 transition-all",children:E.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})},zP=({trip:n,settings:e,onUpdateTrip:t})=>{var J;const i=Wt[e.language]||Wt["zh-TW"],[r,u]=W.useState(!1),[c,m]=W.useState("FLIGHT"),[g,p]=W.useState(""),[x,S]=W.useState(""),[C,M]=W.useState(""),[F,H]=W.useState(""),[Y,ie]=W.useState(""),[re,ee]=W.useState(""),Ee=()=>{if(!g)return;const U=[{id:Date.now().toString(),type:c,airline:g,number:x||"N/A",origin:C||"-",destination:F||"-",departureTime:Y?`${Y} ${re}`:re||"00:00",arrivalTime:"-",status:"Confirmed",bookingUrl:""},...n.bookings||[]];t==null||t({...n,bookings:U}),p(""),S(""),M(""),H(""),ie(""),ee(""),u(!1)},pe=k=>{if(confirm(i.delete_trip_confirm.replace("{title}",i.bookings))){const V=(n.bookings||[]).filter(B=>B.id!==k);t==null||t({...n,bookings:V})}};return E.jsxs("div",{className:"pb-32",children:[E.jsxs("div",{className:"space-y-4",children:[(J=n.bookings)==null?void 0:J.map(k=>E.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-sand relative group",children:[E.jsxs("div",{className:"flex justify-between items-start mb-4",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"w-10 h-10 bg-blue-50 text-blue-500 rounded-xl flex items-center justify-center",children:k.type==="FLIGHT"?E.jsx(Gx,{className:"w-5 h-5"}):E.jsx(Kx,{className:"w-5 h-5"})}),E.jsxs("div",{children:[E.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:k.type}),E.jsx("h4",{className:"font-bold text-ink text-lg",children:k.airline})]})]}),E.jsx("div",{className:"text-right",children:E.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-bold ${k.status==="Confirmed"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-500"}`,children:k.status})})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[E.jsxs("div",{children:[E.jsx("p",{className:"text-xs text-gray-400 font-bold mb-1",children:"DEPARTURE"}),E.jsx("p",{className:"text-ink font-bold text-lg",children:k.origin}),E.jsx("p",{className:"text-sm text-gray-500",children:k.departureTime})]}),E.jsxs("div",{className:"text-right",children:[E.jsx("p",{className:"text-xs text-gray-400 font-bold mb-1",children:"ARRIVAL"}),E.jsx("p",{className:"text-ink font-bold text-lg",children:k.destination}),E.jsx("p",{className:"text-sm text-gray-500",children:k.arrivalTime})]})]}),E.jsxs("div",{className:"pt-4 border-t border-sand flex justify-between items-center",children:[E.jsxs("div",{className:"text-xs text-gray-400 font-mono",children:["REF: ",E.jsx("span",{className:"text-ink font-bold",children:k.number})]}),E.jsx("button",{onClick:()=>pe(k.id),className:"text-gray-300 hover:text-red-500 transition-colors",children:E.jsx(or,{className:"w-4 h-4"})})]})]},k.id)),(!n.bookings||n.bookings.length===0)&&E.jsx("div",{className:"text-center py-10 text-gray-400 text-sm font-medium",children:i.no_bookings})]}),r&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>u(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up max-h-[90vh] overflow-y-auto",onClick:k=>k.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:i.add_booking}),E.jsxs("div",{className:"space-y-4",children:[E.jsx("div",{className:"flex bg-white rounded-xl p-1 shadow-sm mb-4",children:["FLIGHT","HOTEL","TRAIN"].map(k=>E.jsx("button",{onClick:()=>m(k),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${c===k?"bg-ink text-white shadow-sm":"text-gray-400 hover:text-ink"}`,children:k},k))}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.provider}),E.jsx("input",{value:g,onChange:k=>p(k.target.value),placeholder:"Airline / Hotel Name...",className:"w-full bg-white p-4 rounded-xl text-base font-bold border-none shadow-sm outline-none",autoFocus:!0})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.ref_number}),E.jsx("input",{value:x,onChange:k=>S(k.target.value),placeholder:"PNR...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.date}),E.jsx("input",{type:"date",value:Y,onChange:k=>ie(k.target.value),className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]})]}),E.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.origin}),E.jsx("input",{value:C,onChange:k=>M(k.target.value),placeholder:"TPE...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]}),E.jsxs("div",{className:"space-y-1",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 ml-1",children:i.label_destination}),E.jsx("input",{value:F,onChange:k=>H(k.target.value),placeholder:"NRT...",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none"})]})]}),E.jsx("button",{onClick:Ee,disabled:!g,className:"w-full bg-coral text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-coral/30 mt-4 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:i.confirm})]})]})}),E.jsx("button",{onClick:()=>u(!0),className:"fixed bottom-24 right-6 w-14 h-14 bg-blue-500 text-white rounded-full shadow-xl shadow-blue-500/40 flex items-center justify-center z-30 hover:scale-105 active:scale-95 transition-all",children:E.jsx("span",{className:"text-3xl font-light mb-1",children:"+"})})]})};function Vw(n,e){const t=W.useRef(e);W.useEffect(function(){e!==t.current&&n.attributionControl!=null&&(t.current!=null&&n.attributionControl.removeAttribution(t.current),e!=null&&n.attributionControl.addAttribution(e)),t.current=e},[n,e])}var BP=Hx();const FP=1;function qP(n){return Object.freeze({__version:FP,map:n})}function Ow(n,e){return Object.freeze({...n,...e})}const Rg=W.createContext(null);function sf(){const n=W.use(Rg);if(n==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}function Uw(n){function e(t,i){const{instance:r,context:u}=n(t).current;W.useImperativeHandle(i,()=>r);const{children:c}=t;return c==null?null:Lc.createElement(Rg,{value:u},c)}return W.forwardRef(e)}function HP(n){function e(t,i){const[r,u]=W.useState(!1),{instance:c}=n(t,u).current;W.useImperativeHandle(i,()=>c),W.useEffect(function(){r&&c.update()},[c,r,t.children]);const m=c._contentNode;return m?BP.createPortal(t.children,m):null}return W.forwardRef(e)}function GP(n){function e(t,i){const{instance:r}=n(t).current;return W.useImperativeHandle(i,()=>r),null}return W.forwardRef(e)}function Mg(n,e){const t=W.useRef(void 0);W.useEffect(function(){return e!=null&&n.instance.on(e),t.current=e,function(){t.current!=null&&n.instance.off(t.current),t.current=null}},[n,e])}function of(n,e){const t=n.pane??e.pane;return t?{...n,pane:t}:n}function jP(n,e){return function(i,r){const u=sf(),c=n(of(i,u),u);return Vw(u.map,i.attribution),Mg(c.current,i.eventHandlers),e(c.current,u,i,r),c}}var xc={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var KP=xc.exports,lE;function ZP(){return lE||(lE=1,(function(n,e){(function(t,i){i(e)})(KP,(function(t){var i="1.9.4";function r(a){var d,v,A,I;for(v=1,A=arguments.length;v<A;v++){I=arguments[v];for(d in I)a[d]=I[d]}return a}var u=Object.create||(function(){function a(){}return function(d){return a.prototype=d,new a}})();function c(a,d){var v=Array.prototype.slice;if(a.bind)return a.bind.apply(a,v.call(arguments,1));var A=v.call(arguments,2);return function(){return a.apply(d,A.length?A.concat(v.call(arguments)):arguments)}}var m=0;function g(a){return"_leaflet_id"in a||(a._leaflet_id=++m),a._leaflet_id}function p(a,d,v){var A,I,P,G;return G=function(){A=!1,I&&(P.apply(v,I),I=!1)},P=function(){A?I=arguments:(a.apply(v,arguments),setTimeout(G,d),A=!0)},P}function x(a,d,v){var A=d[1],I=d[0],P=A-I;return a===A&&v?a:((a-I)%P+P)%P+I}function S(){return!1}function C(a,d){if(d===!1)return a;var v=Math.pow(10,d===void 0?6:d);return Math.round(a*v)/v}function M(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function F(a){return M(a).split(/\s+/)}function H(a,d){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?u(a.options):{});for(var v in d)a.options[v]=d[v];return a.options}function Y(a,d,v){var A=[];for(var I in a)A.push(encodeURIComponent(v?I.toUpperCase():I)+"="+encodeURIComponent(a[I]));return(!d||d.indexOf("?")===-1?"?":"&")+A.join("&")}var ie=/\{ *([\w_ -]+) *\}/g;function re(a,d){return a.replace(ie,function(v,A){var I=d[A];if(I===void 0)throw new Error("No value provided for variable "+v);return typeof I=="function"&&(I=I(d)),I})}var ee=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function Ee(a,d){for(var v=0;v<a.length;v++)if(a[v]===d)return v;return-1}var pe="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function J(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var k=0;function U(a){var d=+new Date,v=Math.max(0,16-(d-k));return k=d+v,window.setTimeout(a,v)}var V=window.requestAnimationFrame||J("RequestAnimationFrame")||U,B=window.cancelAnimationFrame||J("CancelAnimationFrame")||J("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function q(a,d,v){if(v&&V===U)a.call(d);else return V.call(window,c(a,d))}function K(a){a&&B.call(window,a)}var z={__proto__:null,extend:r,create:u,bind:c,get lastId(){return m},stamp:g,throttle:p,wrapNum:x,falseFn:S,formatNum:C,trim:M,splitWords:F,setOptions:H,getParamString:Y,template:re,isArray:ee,indexOf:Ee,emptyImageUrl:pe,requestFn:V,cancelFn:B,requestAnimFrame:q,cancelAnimFrame:K};function Le(){}Le.extend=function(a){var d=function(){H(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=d.__super__=this.prototype,A=u(v);A.constructor=d,d.prototype=A;for(var I in this)Object.prototype.hasOwnProperty.call(this,I)&&I!=="prototype"&&I!=="__super__"&&(d[I]=this[I]);return a.statics&&r(d,a.statics),a.includes&&(Xe(a.includes),r.apply(null,[A].concat(a.includes))),r(A,a),delete A.statics,delete A.includes,A.options&&(A.options=v.options?u(v.options):{},r(A.options,a.options)),A._initHooks=[],A.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var P=0,G=A._initHooks.length;P<G;P++)A._initHooks[P].call(this)}},d},Le.include=function(a){var d=this.prototype.options;return r(this.prototype,a),a.options&&(this.prototype.options=d,this.mergeOptions(a.options)),this},Le.mergeOptions=function(a){return r(this.prototype.options,a),this},Le.addInitHook=function(a){var d=Array.prototype.slice.call(arguments,1),v=typeof a=="function"?a:function(){this[a].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function Xe(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=ee(a)?a:[a];for(var d=0;d<a.length;d++)a[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var te={on:function(a,d,v){if(typeof a=="object")for(var A in a)this._on(A,a[A],d);else{a=F(a);for(var I=0,P=a.length;I<P;I++)this._on(a[I],d,v)}return this},off:function(a,d,v){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var A in a)this._off(A,a[A],d);else{a=F(a);for(var I=arguments.length===1,P=0,G=a.length;P<G;P++)I?this._off(a[P]):this._off(a[P],d,v)}return this},_on:function(a,d,v,A){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(a,d,v)===!1){v===this&&(v=void 0);var I={fn:d,ctx:v};A&&(I.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(I)}},_off:function(a,d,v){var A,I,P;if(this._events&&(A=this._events[a],!!A)){if(arguments.length===1){if(this._firingCount)for(I=0,P=A.length;I<P;I++)A[I].fn=S;delete this._events[a];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var G=this._listens(a,d,v);if(G!==!1){var X=A[G];this._firingCount&&(X.fn=S,this._events[a]=A=A.slice()),A.splice(G,1)}}},fire:function(a,d,v){if(!this.listens(a,v))return this;var A=r({},d,{type:a,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var I=this._events[a];if(I){this._firingCount=this._firingCount+1||1;for(var P=0,G=I.length;P<G;P++){var X=I[P],ae=X.fn;X.once&&this.off(a,ae,X.ctx),ae.call(X.ctx||this,A)}this._firingCount--}}return v&&this._propagateEvent(A),this},listens:function(a,d,v,A){typeof a!="string"&&console.warn('"string" type argument expected');var I=d;typeof d!="function"&&(A=!!d,I=void 0,v=void 0);var P=this._events&&this._events[a];if(P&&P.length&&this._listens(a,I,v)!==!1)return!0;if(A){for(var G in this._eventParents)if(this._eventParents[G].listens(a,d,v,A))return!0}return!1},_listens:function(a,d,v){if(!this._events)return!1;var A=this._events[a]||[];if(!d)return!!A.length;v===this&&(v=void 0);for(var I=0,P=A.length;I<P;I++)if(A[I].fn===d&&A[I].ctx===v)return I;return!1},once:function(a,d,v){if(typeof a=="object")for(var A in a)this._on(A,a[A],d,!0);else{a=F(a);for(var I=0,P=a.length;I<P;I++)this._on(a[I],d,v,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[g(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[g(a)],this},_propagateEvent:function(a){for(var d in this._eventParents)this._eventParents[d].fire(a.type,r({layer:a.target,propagatedFrom:a.target},a),!0)}};te.addEventListener=te.on,te.removeEventListener=te.clearAllEventListeners=te.off,te.addOneTimeEventListener=te.once,te.fireEvent=te.fire,te.hasEventListeners=te.listens;var Se=Le.extend(te);function Ae(a,d,v){this.x=v?Math.round(a):a,this.y=v?Math.round(d):d}var We=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};Ae.prototype={clone:function(){return new Ae(this.x,this.y)},add:function(a){return this.clone()._add(Ne(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(Ne(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new Ae(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new Ae(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=We(this.x),this.y=We(this.y),this},distanceTo:function(a){a=Ne(a);var d=a.x-this.x,v=a.y-this.y;return Math.sqrt(d*d+v*v)},equals:function(a){return a=Ne(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=Ne(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+C(this.x)+", "+C(this.y)+")"}};function Ne(a,d,v){return a instanceof Ae?a:ee(a)?new Ae(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new Ae(a.x,a.y):new Ae(a,d,v)}function j(a,d){if(a)for(var v=d?[a,d]:a,A=0,I=v.length;A<I;A++)this.extend(v[A])}j.prototype={extend:function(a){var d,v;if(!a)return this;if(a instanceof Ae||typeof a[0]=="number"||"x"in a)d=v=Ne(a);else if(a=he(a),d=a.min,v=a.max,!d||!v)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=v.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(a){return Ne((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return Ne(this.min.x,this.max.y)},getTopRight:function(){return Ne(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var d,v;return typeof a[0]=="number"||a instanceof Ae?a=Ne(a):a=he(a),a instanceof j?(d=a.min,v=a.max):d=v=a,d.x>=this.min.x&&v.x<=this.max.x&&d.y>=this.min.y&&v.y<=this.max.y},intersects:function(a){a=he(a);var d=this.min,v=this.max,A=a.min,I=a.max,P=I.x>=d.x&&A.x<=v.x,G=I.y>=d.y&&A.y<=v.y;return P&&G},overlaps:function(a){a=he(a);var d=this.min,v=this.max,A=a.min,I=a.max,P=I.x>d.x&&A.x<v.x,G=I.y>d.y&&A.y<v.y;return P&&G},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var d=this.min,v=this.max,A=Math.abs(d.x-v.x)*a,I=Math.abs(d.y-v.y)*a;return he(Ne(d.x-A,d.y-I),Ne(v.x+A,v.y+I))},equals:function(a){return a?(a=he(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function he(a,d){return!a||a instanceof j?a:new j(a,d)}function be(a,d){if(a)for(var v=d?[a,d]:a,A=0,I=v.length;A<I;A++)this.extend(v[A])}be.prototype={extend:function(a){var d=this._southWest,v=this._northEast,A,I;if(a instanceof me)A=a,I=a;else if(a instanceof be){if(A=a._southWest,I=a._northEast,!A||!I)return this}else return a?this.extend(Ce(a)||ce(a)):this;return!d&&!v?(this._southWest=new me(A.lat,A.lng),this._northEast=new me(I.lat,I.lng)):(d.lat=Math.min(A.lat,d.lat),d.lng=Math.min(A.lng,d.lng),v.lat=Math.max(I.lat,v.lat),v.lng=Math.max(I.lng,v.lng)),this},pad:function(a){var d=this._southWest,v=this._northEast,A=Math.abs(d.lat-v.lat)*a,I=Math.abs(d.lng-v.lng)*a;return new be(new me(d.lat-A,d.lng-I),new me(v.lat+A,v.lng+I))},getCenter:function(){return new me((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new me(this.getNorth(),this.getWest())},getSouthEast:function(){return new me(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof me||"lat"in a?a=Ce(a):a=ce(a);var d=this._southWest,v=this._northEast,A,I;return a instanceof be?(A=a.getSouthWest(),I=a.getNorthEast()):A=I=a,A.lat>=d.lat&&I.lat<=v.lat&&A.lng>=d.lng&&I.lng<=v.lng},intersects:function(a){a=ce(a);var d=this._southWest,v=this._northEast,A=a.getSouthWest(),I=a.getNorthEast(),P=I.lat>=d.lat&&A.lat<=v.lat,G=I.lng>=d.lng&&A.lng<=v.lng;return P&&G},overlaps:function(a){a=ce(a);var d=this._southWest,v=this._northEast,A=a.getSouthWest(),I=a.getNorthEast(),P=I.lat>d.lat&&A.lat<v.lat,G=I.lng>d.lng&&A.lng<v.lng;return P&&G},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,d){return a?(a=ce(a),this._southWest.equals(a.getSouthWest(),d)&&this._northEast.equals(a.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ce(a,d){return a instanceof be?a:new be(a,d)}function me(a,d,v){if(isNaN(a)||isNaN(d))throw new Error("Invalid LatLng object: ("+a+", "+d+")");this.lat=+a,this.lng=+d,v!==void 0&&(this.alt=+v)}me.prototype={equals:function(a,d){if(!a)return!1;a=Ce(a);var v=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return v<=(d===void 0?1e-9:d)},toString:function(a){return"LatLng("+C(this.lat,a)+", "+C(this.lng,a)+")"},distanceTo:function(a){return Pe.distance(this,Ce(a))},wrap:function(){return Pe.wrapLatLng(this)},toBounds:function(a){var d=180*a/40075017,v=d/Math.cos(Math.PI/180*this.lat);return ce([this.lat-d,this.lng-v],[this.lat+d,this.lng+v])},clone:function(){return new me(this.lat,this.lng,this.alt)}};function Ce(a,d,v){return a instanceof me?a:ee(a)&&typeof a[0]!="object"?a.length===3?new me(a[0],a[1],a[2]):a.length===2?new me(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new me(a.lat,"lng"in a?a.lng:a.lon,a.alt):d===void 0?null:new me(a,d,v)}var _e={latLngToPoint:function(a,d){var v=this.projection.project(a),A=this.scale(d);return this.transformation._transform(v,A)},pointToLatLng:function(a,d){var v=this.scale(d),A=this.transformation.untransform(a,v);return this.projection.unproject(A)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var d=this.projection.bounds,v=this.scale(a),A=this.transformation.transform(d.min,v),I=this.transformation.transform(d.max,v);return new j(A,I)},infinite:!1,wrapLatLng:function(a){var d=this.wrapLng?x(a.lng,this.wrapLng,!0):a.lng,v=this.wrapLat?x(a.lat,this.wrapLat,!0):a.lat,A=a.alt;return new me(v,d,A)},wrapLatLngBounds:function(a){var d=a.getCenter(),v=this.wrapLatLng(d),A=d.lat-v.lat,I=d.lng-v.lng;if(A===0&&I===0)return a;var P=a.getSouthWest(),G=a.getNorthEast(),X=new me(P.lat-A,P.lng-I),ae=new me(G.lat-A,G.lng-I);return new be(X,ae)}},Pe=r({},_e,{wrapLng:[-180,180],R:6371e3,distance:function(a,d){var v=Math.PI/180,A=a.lat*v,I=d.lat*v,P=Math.sin((d.lat-a.lat)*v/2),G=Math.sin((d.lng-a.lng)*v/2),X=P*P+Math.cos(A)*Math.cos(I)*G*G,ae=2*Math.atan2(Math.sqrt(X),Math.sqrt(1-X));return this.R*ae}}),ke=6378137,Je={R:ke,MAX_LATITUDE:85.0511287798,project:function(a){var d=Math.PI/180,v=this.MAX_LATITUDE,A=Math.max(Math.min(v,a.lat),-v),I=Math.sin(A*d);return new Ae(this.R*a.lng*d,this.R*Math.log((1+I)/(1-I))/2)},unproject:function(a){var d=180/Math.PI;return new me((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*d,a.x*d/this.R)},bounds:(function(){var a=ke*Math.PI;return new j([-a,-a],[a,a])})()};function wt(a,d,v,A){if(ee(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=d,this._c=v,this._d=A}wt.prototype={transform:function(a,d){return this._transform(a.clone(),d)},_transform:function(a,d){return d=d||1,a.x=d*(this._a*a.x+this._b),a.y=d*(this._c*a.y+this._d),a},untransform:function(a,d){return d=d||1,new Ae((a.x/d-this._b)/this._a,(a.y/d-this._d)/this._c)}};function Ze(a,d,v,A){return new wt(a,d,v,A)}var Jt=r({},Pe,{code:"EPSG:3857",projection:Je,transformation:(function(){var a=.5/(Math.PI*Je.R);return Ze(a,.5,-a,.5)})()}),fn=r({},Jt,{code:"EPSG:900913"});function mi(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function ei(a,d){var v="",A,I,P,G,X,ae;for(A=0,P=a.length;A<P;A++){for(X=a[A],I=0,G=X.length;I<G;I++)ae=X[I],v+=(I?"L":"M")+ae.x+" "+ae.y;v+=d?ze.svg?"z":"x":""}return v||"M0 0"}var pi=document.documentElement.style,vn="ActiveXObject"in window,jt=vn&&!document.addEventListener,ye="msLaunchUri"in navigator&&!("documentMode"in document),qe=Un("webkit"),Qe=Un("android"),Dt=Un("android 2")||Un("android 3"),dt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),an=Qe&&Un("Google")&&dt<537&&!("AudioNode"in window),gi=!!window.opera,_i=!ye&&Un("chrome"),Ie=Un("gecko")&&!qe&&!gi&&!vn,ut=!_i&&Un("safari"),Vt=Un("phantom"),ln="OTransition"in pi,Si=navigator.platform.indexOf("Win")===0,Tn=vn&&"transition"in pi,Ot="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Dt,Dn="MozPerspective"in pi,Qt=!window.L_DISABLE_3D&&(Tn||Ot||Dn)&&!ln&&!Vt,Gi=typeof orientation<"u"||Un("mobile"),ks=Gi&&qe,ds=Gi&&Ot,ji=!window.PointerEvent&&window.MSPointerEvent,so=!!(window.PointerEvent||ji),un="ontouchstart"in window||!!window.TouchEvent,hs=!window.L_NO_TOUCH&&(un||so),fs=Gi&&gi,Ki=Gi&&Ie,Du=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,pl=(function(){var a=!1;try{var d=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",S,d),window.removeEventListener("testPassiveEventSupport",S,d)}catch{}return a})(),ms=(function(){return!!document.createElement("canvas").getContext})(),Ds=!!(document.createElementNS&&mi("svg").createSVGRect),Lu=!!Ds&&(function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Mo=!Ds&&(function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var d=a.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch{return!1}})(),ya=navigator.platform.indexOf("Mac")===0,va=navigator.platform.indexOf("Linux")===0;function Un(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var ze={ie:vn,ielt9:jt,edge:ye,webkit:qe,android:Qe,android23:Dt,androidStock:an,opera:gi,chrome:_i,gecko:Ie,safari:ut,phantom:Vt,opera12:ln,win:Si,ie3d:Tn,webkit3d:Ot,gecko3d:Dn,any3d:Qt,mobile:Gi,mobileWebkit:ks,mobileWebkit3d:ds,msPointer:ji,pointer:so,touch:hs,touchNative:un,mobileOpera:fs,mobileGecko:Ki,retina:Du,passiveEvents:pl,canvas:ms,svg:Ds,vml:Mo,inlineSvg:Lu,mac:ya,linux:va},Ta=ze.msPointer?"MSPointerDown":"pointerdown",Ai=ze.msPointer?"MSPointerMove":"pointermove",Ci=ze.msPointer?"MSPointerUp":"pointerup",cn=ze.msPointer?"MSPointerCancel":"pointercancel",mn={touchstart:Ta,touchmove:Ai,touchend:Ci,touchcancel:cn},Zi={touchstart:gs,touchmove:zn,touchend:zn,touchcancel:zn},Yi={},gl=!1;function _l(a,d,v){return d==="touchstart"&&bi(),Zi[d]?(v=Zi[d].bind(this,v),a.addEventListener(mn[d],v,!1),v):(console.warn("wrong event specified:",d),S)}function yl(a,d,v){if(!mn[d]){console.warn("wrong event specified:",d);return}a.removeEventListener(mn[d],v,!1)}function ps(a){Yi[a.pointerId]=a}function mr(a){Yi[a.pointerId]&&(Yi[a.pointerId]=a)}function Wi(a){delete Yi[a.pointerId]}function bi(){gl||(document.addEventListener(Ta,ps,!0),document.addEventListener(Ai,mr,!0),document.addEventListener(Ci,Wi,!0),document.addEventListener(cn,Wi,!0),gl=!0)}function zn(a,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var v in Yi)d.touches.push(Yi[v]);d.changedTouches=[d],a(d)}}function gs(a,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&tn(d),zn(a,d)}function pn(a){var d={},v,A;for(A in a)v=a[A],d[A]=v&&v.bind?v.bind(a):v;return a=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var Ea=200;function xa(a,d){a.addEventListener("dblclick",d);var v=0,A;function I(P){if(P.detail!==1){A=P.detail;return}if(!(P.pointerType==="mouse"||P.sourceCapabilities&&!P.sourceCapabilities.firesTouchEvents)){var G=uo(P);if(!(G.some(function(ae){return ae instanceof HTMLLabelElement&&ae.attributes.for})&&!G.some(function(ae){return ae instanceof HTMLInputElement||ae instanceof HTMLSelectElement}))){var X=Date.now();X-v<=Ea?(A++,A===2&&d(pn(P))):A=1,v=X}}}return a.addEventListener("click",I),{dblclick:d,simDblclick:I}}function _s(a,d){a.removeEventListener("dblclick",d.dblclick),a.removeEventListener("click",d.simDblclick)}var Ii=ko(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ls=ko(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),pr=Ls==="webkitTransition"||Ls==="OTransition"?Ls+"End":"transitionend";function gr(a){return typeof a=="string"?document.getElementById(a):a}function oo(a,d){var v=a.style[d]||a.currentStyle&&a.currentStyle[d];if((!v||v==="auto")&&document.defaultView){var A=document.defaultView.getComputedStyle(a,null);v=A?A[d]:null}return v==="auto"?null:v}function ht(a,d,v){var A=document.createElement(a);return A.className=d||"",v&&v.appendChild(A),A}function ft(a){var d=a.parentNode;d&&d.removeChild(a)}function Xt(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function en(a){var d=a.parentNode;d&&d.lastChild!==a&&d.appendChild(a)}function yi(a){var d=a.parentNode;d&&d.firstChild!==a&&d.insertBefore(a,d.firstChild)}function Po(a,d){if(a.classList!==void 0)return a.classList.contains(d);var v=ys(a);return v.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(v)}function Ve(a,d){if(a.classList!==void 0)for(var v=F(d),A=0,I=v.length;A<I;A++)a.classList.add(v[A]);else if(!Po(a,d)){var P=ys(a);Ni(a,(P?P+" ":"")+d)}}function Ut(a,d){a.classList!==void 0?a.classList.remove(d):Ni(a,M((" "+ys(a)+" ").replace(" "+d+" "," ")))}function Ni(a,d){a.className.baseVal===void 0?a.className=d:a.className.baseVal=d}function ys(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function Kt(a,d){"opacity"in a.style?a.style.opacity=d:"filter"in a.style&&_r(a,d)}function _r(a,d){var v=!1,A="DXImageTransform.Microsoft.Alpha";try{v=a.filters.item(A)}catch{if(d===1)return}d=Math.round(d*100),v?(v.Enabled=d!==100,v.Opacity=d):a.style.filter+=" progid:"+A+"(opacity="+d+")"}function ko(a){for(var d=document.documentElement.style,v=0;v<a.length;v++)if(a[v]in d)return a[v];return!1}function Ji(a,d,v){var A=d||new Ae(0,0);a.style[Ii]=(ze.ie3d?"translate("+A.x+"px,"+A.y+"px)":"translate3d("+A.x+"px,"+A.y+"px,0)")+(v?" scale("+v+")":"")}function zt(a,d){a._leaflet_pos=d,ze.any3d?Ji(a,d):(a.style.left=d.x+"px",a.style.top=d.y+"px")}function vs(a){return a._leaflet_pos||new Ae(0,0)}var Ri,Sn,yr;if("onselectstart"in document)Ri=function(){Ke(window,"selectstart",tn)},Sn=function(){bt(window,"selectstart",tn)};else{var Vs=ko(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ri=function(){if(Vs){var a=document.documentElement.style;yr=a[Vs],a[Vs]="none"}},Sn=function(){Vs&&(document.documentElement.style[Vs]=yr,yr=void 0)}}function Do(){Ke(window,"dragstart",tn)}function ro(){bt(window,"dragstart",tn)}var Lo,Ts;function ao(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(ti(),Lo=a,Ts=a.style.outlineStyle,a.style.outlineStyle="none",Ke(window,"keydown",ti))}function ti(){Lo&&(Lo.style.outlineStyle=Ts,Lo=void 0,Ts=void 0,bt(window,"keydown",ti))}function vr(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function ni(a){var d=a.getBoundingClientRect();return{x:d.width/a.offsetWidth||1,y:d.height/a.offsetHeight||1,boundingClientRect:d}}var lo={__proto__:null,TRANSFORM:Ii,TRANSITION:Ls,TRANSITION_END:pr,get:gr,getStyle:oo,create:ht,remove:ft,empty:Xt,toFront:en,toBack:yi,hasClass:Po,addClass:Ve,removeClass:Ut,setClass:Ni,getClass:ys,setOpacity:Kt,testProp:ko,setTransform:Ji,setPosition:zt,getPosition:vs,get disableTextSelection(){return Ri},get enableTextSelection(){return Sn},disableImageDrag:Do,enableImageDrag:ro,preventOutline:ao,restoreOutline:ti,getSizedParentNode:vr,getScale:ni};function Ke(a,d,v,A){if(d&&typeof d=="object")for(var I in d)ii(a,I,d[I],v);else{d=F(d);for(var P=0,G=d.length;P<G;P++)ii(a,d[P],v,A)}return this}var Bn="_leaflet_events";function bt(a,d,v,A){if(arguments.length===1)Os(a),delete a[Bn];else if(d&&typeof d=="object")for(var I in d)Us(a,I,d[I],v);else if(d=F(d),arguments.length===2)Os(a,function(X){return Ee(d,X)!==-1});else for(var P=0,G=d.length;P<G;P++)Us(a,d[P],v,A);return this}function Os(a,d){for(var v in a[Bn]){var A=v.split(/\d/)[0];(!d||d(A))&&Us(a,A,null,null,v)}}var vi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ii(a,d,v,A){var I=d+g(v)+(A?"_"+g(A):"");if(a[Bn]&&a[Bn][I])return this;var P=function(X){return v.call(A||a,X||window.event)},G=P;!ze.touchNative&&ze.pointer&&d.indexOf("touch")===0?P=_l(a,d,P):ze.touch&&d==="dblclick"?P=xa(a,P):"addEventListener"in a?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?a.addEventListener(vi[d]||d,P,ze.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(P=function(X){X=X||window.event,Xi(a,X)&&G(X)},a.addEventListener(vi[d],P,!1)):a.addEventListener(d,G,!1):a.attachEvent("on"+d,P),a[Bn]=a[Bn]||{},a[Bn][I]=P}function Us(a,d,v,A,I){I=I||d+g(v)+(A?"_"+g(A):"");var P=a[Bn]&&a[Bn][I];if(!P)return this;!ze.touchNative&&ze.pointer&&d.indexOf("touch")===0?yl(a,d,P):ze.touch&&d==="dblclick"?_s(a,P):"removeEventListener"in a?a.removeEventListener(vi[d]||d,P,!1):a.detachEvent("on"+d,P),a[Bn][I]=null}function _t(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function Mi(a){return ii(a,"wheel",_t),this}function zs(a){return Ke(a,"mousedown touchstart dblclick contextmenu",_t),a._leaflet_disable_click=!0,this}function tn(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function Qi(a){return tn(a),_t(a),this}function uo(a){if(a.composedPath)return a.composedPath();for(var d=[],v=a.target;v;)d.push(v),v=v.parentNode;return d}function Es(a,d){if(!d)return new Ae(a.clientX,a.clientY);var v=ni(d),A=v.boundingClientRect;return new Ae((a.clientX-A.left)/v.x-d.clientLeft,(a.clientY-A.top)/v.y-d.clientTop)}var $i=ze.linux&&ze.chrome?window.devicePixelRatio:ze.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function An(a){return ze.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/$i:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function Xi(a,d){var v=d.relatedTarget;if(!v)return!0;try{for(;v&&v!==a;)v=v.parentNode}catch{return!1}return v!==a}var xs={__proto__:null,on:Ke,off:bt,stopPropagation:_t,disableScrollPropagation:Mi,disableClickPropagation:zs,preventDefault:tn,stop:Qi,getPropagationPath:uo,getMousePosition:Es,getWheelDelta:An,isExternalTarget:Xi,addListener:Ke,removeListener:bt},Bs=Se.extend({run:function(a,d,v,A){this.stop(),this._el=a,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(A||.5,.2),this._startPos=vs(a),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=q(this._animate,this),this._step()},_step:function(a){var d=+new Date-this._startTime,v=this._duration*1e3;d<v?this._runFrame(this._easeOut(d/v),a):(this._runFrame(1),this._complete())},_runFrame:function(a,d){var v=this._startPos.add(this._offset.multiplyBy(a));d&&v._round(),zt(this._el,v),this.fire("step")},_complete:function(){K(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),ct=Se.extend({options:{crs:Jt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,d){d=H(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(Ce(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ls&&ze.any3d&&!ze.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ke(this._proxy,pr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,d,v){if(d=d===void 0?this._zoom:this._limitZoom(d),a=this._limitCenter(Ce(a),d,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=r({animate:v.animate},v.zoom),v.pan=r({animate:v.animate,duration:v.duration},v.pan));var A=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,d,v.zoom):this._tryAnimatedPan(a,v.pan);if(A)return clearTimeout(this._sizeTimer),this}return this._resetView(a,d,v.pan&&v.pan.noMoveStart),this},setZoom:function(a,d){return this._loaded?this.setView(this.getCenter(),a,{zoom:d}):(this._zoom=a,this)},zoomIn:function(a,d){return a=a||(ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,d)},zoomOut:function(a,d){return a=a||(ze.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,d)},setZoomAround:function(a,d,v){var A=this.getZoomScale(d),I=this.getSize().divideBy(2),P=a instanceof Ae?a:this.latLngToContainerPoint(a),G=P.subtract(I).multiplyBy(1-1/A),X=this.containerPointToLatLng(I.add(G));return this.setView(X,d,{zoom:v})},_getBoundsCenterZoom:function(a,d){d=d||{},a=a.getBounds?a.getBounds():ce(a);var v=Ne(d.paddingTopLeft||d.padding||[0,0]),A=Ne(d.paddingBottomRight||d.padding||[0,0]),I=this.getBoundsZoom(a,!1,v.add(A));if(I=typeof d.maxZoom=="number"?Math.min(d.maxZoom,I):I,I===1/0)return{center:a.getCenter(),zoom:I};var P=A.subtract(v).divideBy(2),G=this.project(a.getSouthWest(),I),X=this.project(a.getNorthEast(),I),ae=this.unproject(G.add(X).divideBy(2).add(P),I);return{center:ae,zoom:I}},fitBounds:function(a,d){if(a=ce(a),!a.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(a,d);return this.setView(v.center,v.zoom,d)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,d){return this.setView(a,this._zoom,{pan:d})},panBy:function(a,d){if(a=Ne(a).round(),d=d||{},!a.x&&!a.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Bs,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){Ve(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,v,d.duration||.25,d.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,d,v){if(v=v||{},v.animate===!1||!ze.any3d)return this.setView(a,d,v);this._stop();var A=this.project(this.getCenter()),I=this.project(a),P=this.getSize(),G=this._zoom;a=Ce(a),d=d===void 0?G:d;var X=Math.max(P.x,P.y),ae=X*this.getZoomScale(G,d),ve=I.distanceTo(A)||1,Me=1.42,He=Me*Me;function at(dn){var js=dn?-1:1,qo=dn?ae:X,Fu=ae*ae-X*X+js*He*He*ve*ve,qa=2*qo*He*ve,Ha=Fu/qa,To=Math.sqrt(Ha*Ha+1)-Ha,Ks=To<1e-9?-18:Math.log(To);return Ks}function Ln(dn){return(Math.exp(dn)-Math.exp(-dn))/2}function gn(dn){return(Math.exp(dn)+Math.exp(-dn))/2}function xi(dn){return Ln(dn)/gn(dn)}var It=at(0);function Nt(dn){return X*(gn(It)/gn(It+Me*dn))}function mt(dn){return X*(gn(It)*xi(It+Me*dn)-Ln(It))/He}function yo(dn){return 1-Math.pow(1-dn,1.5)}var Vi=Date.now(),Ml=(at(1)-It)/Me,vo=v.duration?1e3*v.duration:1e3*Ml*.8;function Bu(){var dn=(Date.now()-Vi)/vo,js=yo(dn)*Ml;dn<=1?(this._flyToFrame=q(Bu,this),this._move(this.unproject(A.add(I.subtract(A).multiplyBy(mt(js)/ve)),G),this.getScaleZoom(X/Nt(js),G),{flyTo:!0})):this._move(a,d)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),Bu.call(this),this},flyToBounds:function(a,d){var v=this._getBoundsCenterZoom(a,d);return this.flyTo(v.center,v.zoom,d)},setMaxBounds:function(a){return a=ce(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var d=this.options.minZoom;return this.options.minZoom=a,this._loaded&&d!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var d=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&d!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,d){this._enforcingBounds=!0;var v=this.getCenter(),A=this._limitCenter(v,this._zoom,ce(a));return v.equals(A)||this.panTo(A,d),this._enforcingBounds=!1,this},panInside:function(a,d){d=d||{};var v=Ne(d.paddingTopLeft||d.padding||[0,0]),A=Ne(d.paddingBottomRight||d.padding||[0,0]),I=this.project(this.getCenter()),P=this.project(a),G=this.getPixelBounds(),X=he([G.min.add(v),G.max.subtract(A)]),ae=X.getSize();if(!X.contains(P)){this._enforcingBounds=!0;var ve=P.subtract(X.getCenter()),Me=X.extend(P).getSize().subtract(ae);I.x+=ve.x<0?-Me.x:Me.x,I.y+=ve.y<0?-Me.y:Me.y,this.panTo(this.unproject(I),d),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=r({animate:!1,pan:!0},a===!0?{animate:!0}:a);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),A=d.divideBy(2).round(),I=v.divideBy(2).round(),P=A.subtract(I);return!P.x&&!P.y?this:(a.animate&&a.pan?this.panBy(P):(a.pan&&this._rawPanBy(P),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=r({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=c(this._handleGeolocationResponse,this),v=c(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,v,a):navigator.geolocation.getCurrentPosition(d,v,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var d=a.code,v=a.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var d=a.coords.latitude,v=a.coords.longitude,A=new me(d,v),I=A.toBounds(a.coords.accuracy*2),P=this._locateOptions;if(P.setView){var G=this.getBoundsZoom(I);this.setView(A,P.maxZoom?Math.min(G,P.maxZoom):G)}var X={latlng:A,bounds:I,timestamp:a.timestamp};for(var ae in a.coords)typeof a.coords[ae]=="number"&&(X[ae]=a.coords[ae]);this.fire("locationfound",X)}},addHandler:function(a,d){if(!d)return this;var v=this[a]=new d(this);return this._handlers.push(v),this.options[a]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ft(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(K(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)ft(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,d){var v="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),A=ht("div",v,d||this._mapPane);return a&&(this._panes[a]=A),A},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),d=this.unproject(a.getBottomLeft()),v=this.unproject(a.getTopRight());return new be(d,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,d,v){a=ce(a),v=Ne(v||[0,0]);var A=this.getZoom()||0,I=this.getMinZoom(),P=this.getMaxZoom(),G=a.getNorthWest(),X=a.getSouthEast(),ae=this.getSize().subtract(v),ve=he(this.project(X,A),this.project(G,A)).getSize(),Me=ze.any3d?this.options.zoomSnap:1,He=ae.x/ve.x,at=ae.y/ve.y,Ln=d?Math.max(He,at):Math.min(He,at);return A=this.getScaleZoom(Ln,A),Me&&(A=Math.round(A/(Me/100))*(Me/100),A=d?Math.ceil(A/Me)*Me:Math.floor(A/Me)*Me),Math.max(I,Math.min(P,A))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Ae(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,d){var v=this._getTopLeftPoint(a,d);return new j(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,d){var v=this.options.crs;return d=d===void 0?this._zoom:d,v.scale(a)/v.scale(d)},getScaleZoom:function(a,d){var v=this.options.crs;d=d===void 0?this._zoom:d;var A=v.zoom(a*v.scale(d));return isNaN(A)?1/0:A},project:function(a,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(Ce(a),d)},unproject:function(a,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(Ne(a),d)},layerPointToLatLng:function(a){var d=Ne(a).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(a){var d=this.project(Ce(a))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(Ce(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(ce(a))},distance:function(a,d){return this.options.crs.distance(Ce(a),Ce(d))},containerPointToLayerPoint:function(a){return Ne(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return Ne(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var d=this.containerPointToLayerPoint(Ne(a));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ce(a)))},mouseEventToContainerPoint:function(a){return Es(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var d=this._container=gr(a);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ke(d,"scroll",this._onScroll,this),this._containerId=g(d)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&ze.any3d,Ve(a,"leaflet-container"+(ze.touch?" leaflet-touch":"")+(ze.retina?" leaflet-retina":"")+(ze.ielt9?" leaflet-oldie":"")+(ze.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=oo(a,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),zt(this._mapPane,new Ae(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ve(a.markerPane,"leaflet-zoom-hide"),Ve(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,d,v){zt(this._mapPane,new Ae(0,0));var A=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var I=this._zoom!==d;this._moveStart(I,v)._move(a,d)._moveEnd(I),this.fire("viewreset"),A&&this.fire("load")},_moveStart:function(a,d){return a&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(a,d,v,A){d===void 0&&(d=this._zoom);var I=this._zoom!==d;return this._zoom=d,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),A?v&&v.pinch&&this.fire("zoom",v):((I||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return K(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){zt(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[g(this._container)]=this;var d=a?bt:Ke;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),ze.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){K(this._resizeRequest),this._resizeRequest=q(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,d){for(var v=[],A,I=d==="mouseout"||d==="mouseover",P=a.target||a.srcElement,G=!1;P;){if(A=this._targets[g(P)],A&&(d==="click"||d==="preclick")&&this._draggableMoved(A)){G=!0;break}if(A&&A.listens(d,!0)&&(I&&!Xi(P,a)||(v.push(A),I))||P===this._container)break;P=P.parentNode}return!v.length&&!G&&!I&&this.listens(d,!0)&&(v=[this]),v},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var d=a.target||a.srcElement;if(!(!this._loaded||d._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(d))){var v=a.type;v==="mousedown"&&ao(d),this._fireDOMEvent(a,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,d,v){if(a.type==="click"){var A=r({},a);A.type="preclick",this._fireDOMEvent(A,A.type,v)}var I=this._findEventTargets(a,d);if(v){for(var P=[],G=0;G<v.length;G++)v[G].listens(d,!0)&&P.push(v[G]);I=P.concat(I)}if(I.length){d==="contextmenu"&&tn(a);var X=I[0],ae={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var ve=X.getLatLng&&(!X._radius||X._radius<=10);ae.containerPoint=ve?this.latLngToContainerPoint(X.getLatLng()):this.mouseEventToContainerPoint(a),ae.layerPoint=this.containerPointToLayerPoint(ae.containerPoint),ae.latlng=ve?X.getLatLng():this.layerPointToLatLng(ae.layerPoint)}for(G=0;G<I.length;G++)if(I[G].fire(d,ae,!0),ae.originalEvent._stopped||I[G].options.bubblingMouseEvents===!1&&Ee(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,d=this._handlers.length;a<d;a++)this._handlers[a].disable()},whenReady:function(a,d){return this._loaded?a.call(d||this,{target:this}):this.on("load",a,d),this},_getMapPanePos:function(){return vs(this._mapPane)||new Ae(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,d){var v=a&&d!==void 0?this._getNewPixelOrigin(a,d):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,d){var v=this.getSize()._divideBy(2);return this.project(a,d)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,d,v){var A=this._getNewPixelOrigin(v,d);return this.project(a,d)._subtract(A)},_latLngBoundsToNewLayerBounds:function(a,d,v){var A=this._getNewPixelOrigin(v,d);return he([this.project(a.getSouthWest(),d)._subtract(A),this.project(a.getNorthWest(),d)._subtract(A),this.project(a.getSouthEast(),d)._subtract(A),this.project(a.getNorthEast(),d)._subtract(A)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,d,v){if(!v)return a;var A=this.project(a,d),I=this.getSize().divideBy(2),P=new j(A.subtract(I),A.add(I)),G=this._getBoundsOffset(P,v,d);return Math.abs(G.x)<=1&&Math.abs(G.y)<=1?a:this.unproject(A.add(G),d)},_limitOffset:function(a,d){if(!d)return a;var v=this.getPixelBounds(),A=new j(v.min.add(a),v.max.add(a));return a.add(this._getBoundsOffset(A,d))},_getBoundsOffset:function(a,d,v){var A=he(this.project(d.getNorthEast(),v),this.project(d.getSouthWest(),v)),I=A.min.subtract(a.min),P=A.max.subtract(a.max),G=this._rebound(I.x,-P.x),X=this._rebound(I.y,-P.y);return new Ae(G,X)},_rebound:function(a,d){return a+d>0?Math.round(a-d)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(d))},_limitZoom:function(a){var d=this.getMinZoom(),v=this.getMaxZoom(),A=ze.any3d?this.options.zoomSnap:1;return A&&(a=Math.round(a/A)*A),Math.max(d,Math.min(v,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ut(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,d){var v=this._getCenterOffset(a)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,d),!0)},_createAnimProxy:function(){var a=this._proxy=ht("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(d){var v=Ii,A=this._proxy.style[v];Ji(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),A===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ft(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),d=this.getZoom();Ji(this._proxy,this.project(a,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,d,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var A=this.getZoomScale(d),I=this._getCenterOffset(a)._divideBy(1-1/A);return v.animate!==!0&&!this.getSize().contains(I)?!1:(q(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(a,d,!0)},this),!0)},_animateZoom:function(a,d,v,A){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=d,Ve(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:d,noUpdate:A}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ut(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function co(a,d){return new ct(a,d)}var Fn=Le.extend({options:{position:"topright"},initialize:function(a){H(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var d=this._map;return d&&d.removeControl(this),this.options.position=a,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var d=this._container=this.onAdd(a),v=this.getPosition(),A=a._controlCorners[v];return Ve(d,"leaflet-control"),v.indexOf("bottom")!==-1?A.insertBefore(d,A.firstChild):A.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ft(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),si=function(a){return new Fn(a)};ct.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},d="leaflet-",v=this._controlContainer=ht("div",d+"control-container",this._container);function A(I,P){var G=d+I+" "+d+P;a[I+P]=ht("div",G,v)}A("top","left"),A("top","right"),A("bottom","left"),A("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)ft(this._controlCorners[a]);ft(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Vo=Fn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,d,v,A){return v<A?-1:A<v?1:0}},initialize:function(a,d,v){H(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var A in a)this._addLayer(a[A],A);for(A in d)this._addLayer(d[A],A,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return Fn.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,d){return this._addLayer(a,d),this._map?this._update():this},addOverlay:function(a,d){return this._addLayer(a,d,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var d=this._getLayer(g(a));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){Ve(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(Ve(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):Ut(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ut(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",d=this._container=ht("div",a),v=this.options.collapsed;d.setAttribute("aria-haspopup",!0),zs(d),Mi(d);var A=this._section=ht("section",a+"-list");v&&(this._map.on("click",this.collapse,this),Ke(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var I=this._layersLink=ht("a",a+"-toggle",d);I.href="#",I.title="Layers",I.setAttribute("role","button"),Ke(I,{keydown:function(P){P.keyCode===13&&this._expandSafely()},click:function(P){tn(P),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=ht("div",a+"-base",A),this._separator=ht("div",a+"-separator",A),this._overlaysList=ht("div",a+"-overlays",A),d.appendChild(A)},_getLayer:function(a){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&g(this._layers[d].layer)===a)return this._layers[d]},_addLayer:function(a,d,v){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:d,overlay:v}),this.options.sortLayers&&this._layers.sort(c(function(A,I){return this.options.sortFunction(A.layer,I.layer,A.name,I.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Xt(this._baseLayersList),Xt(this._overlaysList),this._layerControlInputs=[];var a,d,v,A,I=0;for(v=0;v<this._layers.length;v++)A=this._layers[v],this._addItem(A),d=d||A.overlay,a=a||!A.overlay,I+=A.overlay?0:1;return this.options.hideSingleBase&&(a=a&&I>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=d&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var d=this._getLayer(g(a.target)),v=d.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;v&&this._map.fire(v,d)},_createRadioElement:function(a,d){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(d?' checked="checked"':"")+"/>",A=document.createElement("div");return A.innerHTML=v,A.firstChild},_addItem:function(a){var d=document.createElement("label"),v=this._map.hasLayer(a.layer),A;a.overlay?(A=document.createElement("input"),A.type="checkbox",A.className="leaflet-control-layers-selector",A.defaultChecked=v):A=this._createRadioElement("leaflet-base-layers_"+g(this),v),this._layerControlInputs.push(A),A.layerId=g(a.layer),Ke(A,"click",this._onInputClick,this);var I=document.createElement("span");I.innerHTML=" "+a.name;var P=document.createElement("span");d.appendChild(P),P.appendChild(A),P.appendChild(I);var G=a.overlay?this._overlaysList:this._baseLayersList;return G.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,d,v,A=[],I=[];this._handlingClick=!0;for(var P=a.length-1;P>=0;P--)d=a[P],v=this._getLayer(d.layerId).layer,d.checked?A.push(v):d.checked||I.push(v);for(P=0;P<I.length;P++)this._map.hasLayer(I[P])&&this._map.removeLayer(I[P]);for(P=0;P<A.length;P++)this._map.hasLayer(A[P])||this._map.addLayer(A[P]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,d,v,A=this._map.getZoom(),I=a.length-1;I>=0;I--)d=a[I],v=this._getLayer(d.layerId).layer,d.disabled=v.options.minZoom!==void 0&&A<v.options.minZoom||v.options.maxZoom!==void 0&&A>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,Ke(a,"click",tn),this.expand();var d=this;setTimeout(function(){bt(a,"click",tn),d._preventClick=!1})}}),wa=function(a,d,v){return new Vo(a,d,v)},Fs=Fn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var d="leaflet-control-zoom",v=ht("div",d+" leaflet-bar"),A=this.options;return this._zoomInButton=this._createButton(A.zoomInText,A.zoomInTitle,d+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(A.zoomOutText,A.zoomOutTitle,d+"-out",v,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,d,v,A,I){var P=ht("a",v,A);return P.innerHTML=a,P.href="#",P.title=d,P.setAttribute("role","button"),P.setAttribute("aria-label",d),zs(P),Ke(P,"click",Qi),Ke(P,"click",I,this),Ke(P,"click",this._refocusOnMap,this),P},_updateDisabled:function(){var a=this._map,d="leaflet-disabled";Ut(this._zoomInButton,d),Ut(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(Ve(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(Ve(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});ct.mergeOptions({zoomControl:!0}),ct.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Fs,this.addControl(this.zoomControl))});var vl=function(a){return new Fs(a)},Sa=Fn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var d="leaflet-control-scale",v=ht("div",d),A=this.options;return this._addScales(A,d+"-line",v),a.on(A.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),v},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,d,v){a.metric&&(this._mScale=ht("div",d,v)),a.imperial&&(this._iScale=ht("div",d,v))},_update:function(){var a=this._map,d=a.getSize().y/2,v=a.distance(a.containerPointToLatLng([0,d]),a.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(v)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var d=this._getRoundNum(a),v=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,v,d/a)},_updateImperial:function(a){var d=a*3.2808399,v,A,I;d>5280?(v=d/5280,A=this._getRoundNum(v),this._updateScale(this._iScale,A+" mi",A/v)):(I=this._getRoundNum(d),this._updateScale(this._iScale,I+" ft",I/d))},_updateScale:function(a,d,v){a.style.width=Math.round(this.options.maxWidth*v)+"px",a.innerHTML=d},_getRoundNum:function(a){var d=Math.pow(10,(Math.floor(a)+"").length-1),v=a/d;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,d*v}}),Oo=function(a){return new Sa(a)},Aa='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Tr=Fn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(ze.inlineSvg?Aa+" ":"")+"Leaflet</a>"},initialize:function(a){H(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=ht("div","leaflet-control-attribution"),zs(this._container);for(var d in a._layers)a._layers[d].getAttribution&&this.addAttribution(a._layers[d].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var d in this._attributions)this._attributions[d]&&a.push(d);var v=[];this.options.prefix&&v.push(this.options.prefix),a.length&&v.push(a.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});ct.mergeOptions({attributionControl:!0}),ct.addInitHook(function(){this.options.attributionControl&&new Tr().addTo(this)});var Er=function(a){return new Tr(a)};Fn.Layers=Vo,Fn.Zoom=Fs,Fn.Scale=Sa,Fn.Attribution=Tr,si.layers=wa,si.zoom=vl,si.scale=Oo,si.attribution=Er;var Ti=Le.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ti.addTo=function(a,d){return a.addHandler(d,this),this};var Tl={Events:te},es=ze.touch?"touchstart mousedown":"mousedown",ts=Se.extend({options:{clickTolerance:3},initialize:function(a,d,v,A){H(this,A),this._element=a,this._dragStartTarget=d||a,this._preventOutline=v},enable:function(){this._enabled||(Ke(this._dragStartTarget,es,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ts._dragging===this&&this.finishDrag(!0),bt(this._dragStartTarget,es,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!Po(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){ts._dragging===this&&this.finishDrag();return}if(!(ts._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(ts._dragging=this,this._preventOutline&&ao(this._element),Do(),Ri(),!this._moving)){this.fire("down");var d=a.touches?a.touches[0]:a,v=vr(this._element);this._startPoint=new Ae(d.clientX,d.clientY),this._startPos=vs(this._element),this._parentScale=ni(v);var A=a.type==="mousedown";Ke(document,A?"mousemove":"touchmove",this._onMove,this),Ke(document,A?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var d=a.touches&&a.touches.length===1?a.touches[0]:a,v=new Ae(d.clientX,d.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,tn(a),this._moved||(this.fire("dragstart"),this._moved=!0,Ve(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ve(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),zt(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){Ut(document.body,"leaflet-dragging"),this._lastTarget&&(Ut(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),bt(document,"mousemove touchmove",this._onMove,this),bt(document,"mouseup touchend touchcancel",this._onUp,this),ro(),Sn();var d=this._moved&&this._moving;this._moving=!1,ts._dragging=!1,d&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function Ca(a,d,v){var A,I=[1,4,2,8],P,G,X,ae,ve,Me,He,at;for(P=0,Me=a.length;P<Me;P++)a[P]._code=ue(a[P],d);for(X=0;X<4;X++){for(He=I[X],A=[],P=0,Me=a.length,G=Me-1;P<Me;G=P++)ae=a[P],ve=a[G],ae._code&He?ve._code&He||(at=ne(ve,ae,He,d,v),at._code=ue(at,d),A.push(at)):(ve._code&He&&(at=ne(ve,ae,He,d,v),at._code=ue(at,d),A.push(at)),A.push(ae));a=A}return a}function ba(a,d){var v,A,I,P,G,X,ae,ve,Me;if(!a||a.length===0)throw new Error("latlngs not passed");St(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var He=Ce([0,0]),at=ce(a),Ln=at.getNorthWest().distanceTo(at.getSouthWest())*at.getNorthEast().distanceTo(at.getNorthWest());Ln<1700&&(He=xr(a));var gn=a.length,xi=[];for(v=0;v<gn;v++){var It=Ce(a[v]);xi.push(d.project(Ce([It.lat-He.lat,It.lng-He.lng])))}for(X=ae=ve=0,v=0,A=gn-1;v<gn;A=v++)I=xi[v],P=xi[A],G=I.y*P.x-P.y*I.x,ae+=(I.x+P.x)*G,ve+=(I.y+P.y)*G,X+=G*3;X===0?Me=xi[0]:Me=[ae/X,ve/X];var Nt=d.unproject(Ne(Me));return Ce([Nt.lat+He.lat,Nt.lng+He.lng])}function xr(a){for(var d=0,v=0,A=0,I=0;I<a.length;I++){var P=Ce(a[I]);d+=P.lat,v+=P.lng,A++}return Ce([d/A,v/A])}var ho={__proto__:null,clipPolygon:Ca,polygonCenter:ba,centroid:xr};function qn(a,d){if(!d||!a.length)return a.slice();var v=d*d;return a=b(a,v),a=qs(a,v),a}function Ia(a,d,v){return Math.sqrt(et(a,d,v,!0))}function El(a,d,v){return et(a,d,v)}function qs(a,d){var v=a.length,A=typeof Uint8Array<"u"?Uint8Array:Array,I=new A(v);I[0]=I[v-1]=1,y(a,I,d,0,v-1);var P,G=[];for(P=0;P<v;P++)I[P]&&G.push(a[P]);return G}function y(a,d,v,A,I){var P=0,G,X,ae;for(X=A+1;X<=I-1;X++)ae=et(a[X],a[A],a[I],!0),ae>P&&(G=X,P=ae);P>v&&(d[G]=1,y(a,d,v,A,G),y(a,d,v,G,I))}function b(a,d){for(var v=[a[0]],A=1,I=0,P=a.length;A<P;A++)Re(a[A],a[I])>d&&(v.push(a[A]),I=A);return I<P-1&&v.push(a[P-1]),v}var R;function O(a,d,v,A,I){var P=A?R:ue(a,v),G=ue(d,v),X,ae,ve;for(R=G;;){if(!(P|G))return[a,d];if(P&G)return!1;X=P||G,ae=ne(a,d,X,v,I),ve=ue(ae,v),X===P?(a=ae,P=ve):(d=ae,G=ve)}}function ne(a,d,v,A,I){var P=d.x-a.x,G=d.y-a.y,X=A.min,ae=A.max,ve,Me;return v&8?(ve=a.x+P*(ae.y-a.y)/G,Me=ae.y):v&4?(ve=a.x+P*(X.y-a.y)/G,Me=X.y):v&2?(ve=ae.x,Me=a.y+G*(ae.x-a.x)/P):v&1&&(ve=X.x,Me=a.y+G*(X.x-a.x)/P),new Ae(ve,Me,I)}function ue(a,d){var v=0;return a.x<d.min.x?v|=1:a.x>d.max.x&&(v|=2),a.y<d.min.y?v|=4:a.y>d.max.y&&(v|=8),v}function Re(a,d){var v=d.x-a.x,A=d.y-a.y;return v*v+A*A}function et(a,d,v,A){var I=d.x,P=d.y,G=v.x-I,X=v.y-P,ae=G*G+X*X,ve;return ae>0&&(ve=((a.x-I)*G+(a.y-P)*X)/ae,ve>1?(I=v.x,P=v.y):ve>0&&(I+=G*ve,P+=X*ve)),G=a.x-I,X=a.y-P,A?G*G+X*X:new Ae(I,P)}function St(a){return!ee(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function At(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),St(a)}function Zt(a,d){var v,A,I,P,G,X,ae,ve;if(!a||a.length===0)throw new Error("latlngs not passed");St(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var Me=Ce([0,0]),He=ce(a),at=He.getNorthWest().distanceTo(He.getSouthWest())*He.getNorthEast().distanceTo(He.getNorthWest());at<1700&&(Me=xr(a));var Ln=a.length,gn=[];for(v=0;v<Ln;v++){var xi=Ce(a[v]);gn.push(d.project(Ce([xi.lat-Me.lat,xi.lng-Me.lng])))}for(v=0,A=0;v<Ln-1;v++)A+=gn[v].distanceTo(gn[v+1])/2;if(A===0)ve=gn[0];else for(v=0,P=0;v<Ln-1;v++)if(G=gn[v],X=gn[v+1],I=G.distanceTo(X),P+=I,P>A){ae=(P-A)/I,ve=[X.x-ae*(X.x-G.x),X.y-ae*(X.y-G.y)];break}var It=d.unproject(Ne(ve));return Ce([It.lat+Me.lat,It.lng+Me.lng])}var Pi={__proto__:null,simplify:qn,pointToSegmentDistance:Ia,closestPointOnSegment:El,clipSegment:O,_getEdgeIntersection:ne,_getBitCode:ue,_sqClosestPointOnSegment:et,isFlat:St,_flat:At,polylineCenter:Zt},ki={project:function(a){return new Ae(a.lng,a.lat)},unproject:function(a){return new me(a.y,a.x)},bounds:new j([-180,-90],[180,90])},Ei={R:6378137,R_MINOR:6356752314245179e-9,bounds:new j([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var d=Math.PI/180,v=this.R,A=a.lat*d,I=this.R_MINOR/v,P=Math.sqrt(1-I*I),G=P*Math.sin(A),X=Math.tan(Math.PI/4-A/2)/Math.pow((1-G)/(1+G),P/2);return A=-v*Math.log(Math.max(X,1e-10)),new Ae(a.lng*d*v,A)},unproject:function(a){for(var d=180/Math.PI,v=this.R,A=this.R_MINOR/v,I=Math.sqrt(1-A*A),P=Math.exp(-a.y/v),G=Math.PI/2-2*Math.atan(P),X=0,ae=.1,ve;X<15&&Math.abs(ae)>1e-7;X++)ve=I*Math.sin(G),ve=Math.pow((1-ve)/(1+ve),I/2),ae=Math.PI/2-2*Math.atan(P*ve)-G,G+=ae;return new me(G*d,a.x*d/v)}},ns={__proto__:null,LonLat:ki,Mercator:Ei,SphericalMercator:Je},Uo=r({},Pe,{code:"EPSG:3395",projection:Ei,transformation:(function(){var a=.5/(Math.PI*Ei.R);return Ze(a,.5,-a,.5)})()}),zo=r({},Pe,{code:"EPSG:4326",projection:ki,transformation:Ze(1/180,1,-1/180,.5)}),wr=r({},_e,{projection:ki,transformation:Ze(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,d){var v=d.lng-a.lng,A=d.lat-a.lat;return Math.sqrt(v*v+A*A)},infinite:!0});_e.Earth=Pe,_e.EPSG3395=Uo,_e.EPSG3857=Jt,_e.EPSG900913=fn,_e.EPSG4326=zo,_e.Simple=wr;var is=Se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[g(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[g(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var d=a.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var v=this.getEvents();d.on(v,this),this.once("remove",function(){d.off(v,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});ct.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var d=g(a);return this._layers[d]?this:(this._layers[d]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var d=g(a);return this._layers[d]?(this._loaded&&a.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return g(a)in this._layers},eachLayer:function(a,d){for(var v in this._layers)a.call(d,this._layers[v]);return this},_addLayers:function(a){a=a?ee(a)?a:[a]:[];for(var d=0,v=a.length;d<v;d++)this.addLayer(a[d])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[g(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var d=g(a);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,d=-1/0,v=this._getZoomSpan();for(var A in this._zoomBoundLayers){var I=this._zoomBoundLayers[A].options;a=I.minZoom===void 0?a:Math.min(a,I.minZoom),d=I.maxZoom===void 0?d:Math.max(d,I.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=a===1/0?void 0:a,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Sr=is.extend({initialize:function(a,d){H(this,d),this._layers={};var v,A;if(a)for(v=0,A=a.length;v<A;v++)this.addLayer(a[v])},addLayer:function(a){var d=this.getLayerId(a);return this._layers[d]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var d=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(a){var d=typeof a=="number"?a:this.getLayerId(a);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var d=Array.prototype.slice.call(arguments,1),v,A;for(v in this._layers)A=this._layers[v],A[a]&&A[a].apply(A,d);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,d){for(var v in this._layers)a.call(d,this._layers[v]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return g(a)}}),Rf=function(a,d){return new Sr(a,d)},ws=Sr.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),Sr.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),Sr.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new be;for(var d in this._layers){var v=this._layers[d];a.extend(v.getBounds?v.getBounds():v.getLatLng())}return a}}),id=function(a,d){return new ws(a,d)},Ss=Le.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){H(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,d){var v=this._getIconUrl(a);if(!v){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var A=this._createImg(v,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(A,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),A},_setIconStyles:function(a,d){var v=this.options,A=v[d+"Size"];typeof A=="number"&&(A=[A,A]);var I=Ne(A),P=Ne(d==="shadow"&&v.shadowAnchor||v.iconAnchor||I&&I.divideBy(2,!0));a.className="leaflet-marker-"+d+" "+(v.className||""),P&&(a.style.marginLeft=-P.x+"px",a.style.marginTop=-P.y+"px"),I&&(a.style.width=I.x+"px",a.style.height=I.y+"px")},_createImg:function(a,d){return d=d||document.createElement("img"),d.src=a,d},_getIconUrl:function(a){return ze.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function Na(a){return new Ss(a)}var Ra=Ss.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof Ra.imagePath!="string"&&(Ra.imagePath=this._detectIconPath()),(this.options.imagePath||Ra.imagePath)+Ss.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var d=function(v,A,I){var P=A.exec(v);return P&&P[I]};return a=d(a,/^url\((['"])?(.+)\1\)$/,2),a&&d(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=ht("div","leaflet-default-icon-path",document.body),d=oo(a,"background-image")||oo(a,"backgroundImage");if(document.body.removeChild(a),d=this._stripUrl(d),d)return d;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),Ma=Ti.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new ts(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ve(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ut(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var d=this._marker,v=d._map,A=this._marker.options.autoPanSpeed,I=this._marker.options.autoPanPadding,P=vs(d._icon),G=v.getPixelBounds(),X=v.getPixelOrigin(),ae=he(G.min._subtract(X).add(I),G.max._subtract(X).subtract(I));if(!ae.contains(P)){var ve=Ne((Math.max(ae.max.x,P.x)-ae.max.x)/(G.max.x-ae.max.x)-(Math.min(ae.min.x,P.x)-ae.min.x)/(G.min.x-ae.min.x),(Math.max(ae.max.y,P.y)-ae.max.y)/(G.max.y-ae.max.y)-(Math.min(ae.min.y,P.y)-ae.min.y)/(G.min.y-ae.min.y)).multiplyBy(A);v.panBy(ve,{animate:!1}),this._draggable._newPos._add(ve),this._draggable._startPos._add(ve),zt(d._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=q(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(K(this._panRequest),this._panRequest=q(this._adjustPan.bind(this,a)))},_onDrag:function(a){var d=this._marker,v=d._shadow,A=vs(d._icon),I=d._map.layerPointToLatLng(A);v&&zt(v,A),d._latlng=I,a.latlng=I,a.oldLatLng=this._oldLatLng,d.fire("move",a).fire("drag",a)},_onDragEnd:function(a){K(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),Pa=is.extend({options:{icon:new Ra,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,d){H(this,d),this._latlng=Ce(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var d=this._latlng;return this._latlng=Ce(a),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=a.icon.createIcon(this._icon),A=!1;v!==this._icon&&(this._icon&&this._removeIcon(),A=!0,a.title&&(v.title=a.title),v.tagName==="IMG"&&(v.alt=a.alt||"")),Ve(v,d),a.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ke(v,"focus",this._panOnFocus,this);var I=a.icon.createShadow(this._shadow),P=!1;I!==this._shadow&&(this._removeShadow(),P=!0),I&&(Ve(I,d),I.alt=""),this._shadow=I,a.opacity<1&&this._updateOpacity(),A&&this.getPane().appendChild(this._icon),this._initInteraction(),I&&P&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&bt(this._icon,"focus",this._panOnFocus,this),ft(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ft(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&zt(this._icon,a),this._shadow&&zt(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(Ve(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ma)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ma(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&Kt(this._icon,a),this._shadow&&Kt(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var d=this.options.icon.options,v=d.iconSize?Ne(d.iconSize):Ne(0,0),A=d.iconAnchor?Ne(d.iconAnchor):Ne(0,0);a.panInside(this._latlng,{paddingTopLeft:A,paddingBottomRight:v.subtract(A)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function sd(a,d){return new Pa(a,d)}var As=is.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return H(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ar=As.extend({options:{fill:!0,radius:10},initialize:function(a,d){H(this,d),this._latlng=Ce(a),this._radius=this.options.radius},setLatLng:function(a){var d=this._latlng;return this._latlng=Ce(a),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var d=a&&a.radius||this._radius;return As.prototype.setStyle.call(this,a),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,d=this._radiusY||a,v=this._clickTolerance(),A=[a+v,d+v];this._pxBounds=new j(this._point.subtract(A),this._point.add(A))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function od(a,d){return new Ar(a,d)}var xl=Ar.extend({initialize:function(a,d,v){if(typeof d=="number"&&(d=r({},v,{radius:d})),H(this,d),this._latlng=Ce(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new be(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:As.prototype.setStyle,_project:function(){var a=this._latlng.lng,d=this._latlng.lat,v=this._map,A=v.options.crs;if(A.distance===Pe.distance){var I=Math.PI/180,P=this._mRadius/Pe.R/I,G=v.project([d+P,a]),X=v.project([d-P,a]),ae=G.add(X).divideBy(2),ve=v.unproject(ae).lat,Me=Math.acos((Math.cos(P*I)-Math.sin(d*I)*Math.sin(ve*I))/(Math.cos(d*I)*Math.cos(ve*I)))/I;(isNaN(Me)||Me===0)&&(Me=P/Math.cos(Math.PI/180*d)),this._point=ae.subtract(v.getPixelOrigin()),this._radius=isNaN(Me)?0:ae.x-v.project([ve,a-Me]).x,this._radiusY=ae.y-G.y}else{var He=A.unproject(A.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(He).x}this._updateBounds()}});function rd(a,d,v){return new xl(a,d,v)}var Hs=As.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,d){H(this,d),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var d=1/0,v=null,A=et,I,P,G=0,X=this._parts.length;G<X;G++)for(var ae=this._parts[G],ve=1,Me=ae.length;ve<Me;ve++){I=ae[ve-1],P=ae[ve];var He=A(a,I,P,!0);He<d&&(d=He,v=A(a,I,P))}return v&&(v.distance=Math.sqrt(d)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Zt(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,d){return d=d||this._defaultShape(),a=Ce(a),d.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new be,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return St(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var d=[],v=St(a),A=0,I=a.length;A<I;A++)v?(d[A]=Ce(a[A]),this._bounds.extend(d[A])):d[A]=this._convertLatLngs(a[A]);return d},_project:function(){var a=new j;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),d=new Ae(a,a);this._rawPxBounds&&(this._pxBounds=new j([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(a,d,v){var A=a[0]instanceof me,I=a.length,P,G;if(A){for(G=[],P=0;P<I;P++)G[P]=this._map.latLngToLayerPoint(a[P]),v.extend(G[P]);d.push(G)}else for(P=0;P<I;P++)this._projectLatlngs(a[P],d,v)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,v,A,I,P,G,X,ae;for(v=0,I=0,P=this._rings.length;v<P;v++)for(ae=this._rings[v],A=0,G=ae.length;A<G-1;A++)X=O(ae[A],ae[A+1],a,A,!0),X&&(d[I]=d[I]||[],d[I].push(X[0]),(X[1]!==ae[A+1]||A===G-2)&&(d[I].push(X[1]),I++))}},_simplifyPoints:function(){for(var a=this._parts,d=this.options.smoothFactor,v=0,A=a.length;v<A;v++)a[v]=qn(a[v],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,d){var v,A,I,P,G,X,ae=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(v=0,P=this._parts.length;v<P;v++)for(X=this._parts[v],A=0,G=X.length,I=G-1;A<G;I=A++)if(!(!d&&A===0)&&Ia(a,X[I],X[A])<=ae)return!0;return!1}});function Mf(a,d){return new Hs(a,d)}Hs._flat=At;var Cr=Hs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ba(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var d=Hs.prototype._convertLatLngs.call(this,a),v=d.length;return v>=2&&d[0]instanceof me&&d[0].equals(d[v-1])&&d.pop(),d},_setLatLngs:function(a){Hs.prototype._setLatLngs.call(this,a),St(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return St(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,d=this.options.weight,v=new Ae(d,d);if(a=new j(a.min.subtract(v),a.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var A=0,I=this._rings.length,P;A<I;A++)P=Ca(this._rings[A],a,!0),P.length&&this._parts.push(P)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var d=!1,v,A,I,P,G,X,ae,ve;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(P=0,ae=this._parts.length;P<ae;P++)for(v=this._parts[P],G=0,ve=v.length,X=ve-1;G<ve;X=G++)A=v[G],I=v[X],A.y>a.y!=I.y>a.y&&a.x<(I.x-A.x)*(a.y-A.y)/(I.y-A.y)+A.x&&(d=!d);return d||Hs.prototype._containsPoint.call(this,a,!0)}});function Pf(a,d){return new Cr(a,d)}var Gs=ws.extend({initialize:function(a,d){H(this,d),this._layers={},a&&this.addData(a)},addData:function(a){var d=ee(a)?a:a.features,v,A,I;if(d){for(v=0,A=d.length;v<A;v++)I=d[v],(I.geometries||I.geometry||I.features||I.coordinates)&&this.addData(I);return this}var P=this.options;if(P.filter&&!P.filter(a))return this;var G=Hn(a,P);return G?(G.feature=Al(a),G.defaultOptions=G.options,this.resetStyle(G),P.onEachFeature&&P.onEachFeature(a,G),this.addLayer(G)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=r({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(d){this._setLayerStyle(d,a)},this)},_setLayerStyle:function(a,d){a.setStyle&&(typeof d=="function"&&(d=d(a.feature)),a.setStyle(d))}});function Hn(a,d){var v=a.type==="Feature"?a.geometry:a,A=v?v.coordinates:null,I=[],P=d&&d.pointToLayer,G=d&&d.coordsToLatLng||wl,X,ae,ve,Me;if(!A&&!v)return null;switch(v.type){case"Point":return X=G(A),br(P,a,X,d);case"MultiPoint":for(ve=0,Me=A.length;ve<Me;ve++)X=G(A[ve]),I.push(br(P,a,X,d));return new ws(I);case"LineString":case"MultiLineString":return ae=ka(A,v.type==="LineString"?0:1,G),new Hs(ae,d);case"Polygon":case"MultiPolygon":return ae=ka(A,v.type==="Polygon"?1:2,G),new Cr(ae,d);case"GeometryCollection":for(ve=0,Me=v.geometries.length;ve<Me;ve++){var He=Hn({geometry:v.geometries[ve],type:"Feature",properties:a.properties},d);He&&I.push(He)}return new ws(I);case"FeatureCollection":for(ve=0,Me=v.features.length;ve<Me;ve++){var at=Hn(v.features[ve],d);at&&I.push(at)}return new ws(I);default:throw new Error("Invalid GeoJSON object.")}}function br(a,d,v,A){return a?a(d,v):new Pa(v,A&&A.markersInheritOptions&&A)}function wl(a){return new me(a[1],a[0],a[2])}function ka(a,d,v){for(var A=[],I=0,P=a.length,G;I<P;I++)G=d?ka(a[I],d-1,v):(v||wl)(a[I]),A.push(G);return A}function Sl(a,d){return a=Ce(a),a.alt!==void 0?[C(a.lng,d),C(a.lat,d),C(a.alt,d)]:[C(a.lng,d),C(a.lat,d)]}function Da(a,d,v,A){for(var I=[],P=0,G=a.length;P<G;P++)I.push(d?Da(a[P],St(a[P])?0:d-1,v,A):Sl(a[P],A));return!d&&v&&I.length>0&&I.push(I[0].slice()),I}function fo(a,d){return a.feature?r({},a.feature,{geometry:d}):Al(d)}function Al(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var mo={toGeoJSON:function(a){return fo(this,{type:"Point",coordinates:Sl(this.getLatLng(),a)})}};Pa.include(mo),xl.include(mo),Ar.include(mo),Hs.include({toGeoJSON:function(a){var d=!St(this._latlngs),v=Da(this._latlngs,d?1:0,!1,a);return fo(this,{type:(d?"Multi":"")+"LineString",coordinates:v})}}),Cr.include({toGeoJSON:function(a){var d=!St(this._latlngs),v=d&&!St(this._latlngs[0]),A=Da(this._latlngs,v?2:d?1:0,!0,a);return d||(A=[A]),fo(this,{type:(v?"Multi":"")+"Polygon",coordinates:A})}}),Sr.include({toMultiPoint:function(a){var d=[];return this.eachLayer(function(v){d.push(v.toGeoJSON(a).geometry.coordinates)}),fo(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(a){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(a);var v=d==="GeometryCollection",A=[];return this.eachLayer(function(I){if(I.toGeoJSON){var P=I.toGeoJSON(a);if(v)A.push(P.geometry);else{var G=Al(P);G.type==="FeatureCollection"?A.push.apply(A,G.features):A.push(G)}}}),v?fo(this,{geometries:A,type:"GeometryCollection"}):{type:"FeatureCollection",features:A}}});function Cl(a,d){return new Gs(a,d)}var La=Cl,Ir=is.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,d,v){this._url=a,this._bounds=ce(d),H(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ve(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ft(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&en(this._image),this},bringToBack:function(){return this._map&&yi(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=ce(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",d=this._image=a?this._url:ht("img");if(Ve(d,"leaflet-image-layer"),this._zoomAnimated&&Ve(d,"leaflet-zoom-animated"),this.options.className&&Ve(d,this.options.className),d.onselectstart=S,d.onmousemove=S,d.onload=c(this.fire,this,"load"),d.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(a){var d=this._map.getZoomScale(a.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;Ji(this._image,v,d)},_reset:function(){var a=this._image,d=new j(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=d.getSize();zt(a,d.min),a.style.width=v.x+"px",a.style.height=v.y+"px"},_updateOpacity:function(){Kt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),ad=function(a,d,v){return new Ir(a,d,v)},po=Ir.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",d=this._image=a?this._url:ht("video");if(Ve(d,"leaflet-image-layer"),this._zoomAnimated&&Ve(d,"leaflet-zoom-animated"),this.options.className&&Ve(d,this.options.className),d.onselectstart=S,d.onmousemove=S,d.onloadeddata=c(this.fire,this,"load"),a){for(var v=d.getElementsByTagName("source"),A=[],I=0;I<v.length;I++)A.push(v[I].src);this._url=v.length>0?A:[d.src];return}ee(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var P=0;P<this._url.length;P++){var G=ht("source");G.src=this._url[P],d.appendChild(G)}}});function Nr(a,d,v){return new po(a,d,v)}var bl=Ir.extend({_initImage:function(){var a=this._image=this._url;Ve(a,"leaflet-image-layer"),this._zoomAnimated&&Ve(a,"leaflet-zoom-animated"),this.options.className&&Ve(a,this.options.className),a.onselectstart=S,a.onmousemove=S}});function ld(a,d,v){return new bl(a,d,v)}var Gn=is.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,d){a&&(a instanceof me||ee(a))?(this._latlng=Ce(a),H(this,d)):(H(this,a),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&Kt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&Kt(this._container,1),this.bringToFront(),this.options.interactive&&(Ve(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(Kt(this._container,0),this._removeTimeout=setTimeout(c(ft,void 0,this._container),200)):ft(this._container),this.options.interactive&&(Ut(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=Ce(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&en(this._container),this},bringToBack:function(){return this._map&&yi(this._container),this},_prepareOpen:function(a){var d=this._source;if(!d._map)return!1;if(d instanceof ws){d=null;var v=this._source._layers;for(var A in v)if(v[A]._map){d=v[A];break}if(!d)return!1;this._source=d}if(!a)if(d.getCenter)a=d.getCenter();else if(d.getLatLng)a=d.getLatLng();else if(d.getBounds)a=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")a.innerHTML=d;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),d=Ne(this.options.offset),v=this._getAnchor();this._zoomAnimated?zt(this._container,a.add(v)):d=d.add(a).add(v);var A=this._containerBottom=-d.y,I=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=A+"px",this._container.style.left=I+"px"}},_getAnchor:function(){return[0,0]}});ct.include({_initOverlay:function(a,d,v,A){var I=d;return I instanceof a||(I=new a(A).setContent(d)),v&&I.setLatLng(v),I}}),is.include({_initOverlay:function(a,d,v,A){var I=v;return I instanceof a?(H(I,A),I._source=this):(I=d&&!A?d:new a(A,this),I.setContent(v)),I}});var Va=Gn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,Gn.prototype.openOn.call(this,a)},onAdd:function(a){Gn.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof As||this._source.on("preclick",_t))},onRemove:function(a){Gn.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof As||this._source.off("preclick",_t))},getEvents:function(){var a=Gn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",d=this._container=ht("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=ht("div",a+"-content-wrapper",d);if(this._contentNode=ht("div",a+"-content",v),zs(d),Mi(this._contentNode),Ke(d,"contextmenu",_t),this._tipContainer=ht("div",a+"-tip-container",d),this._tip=ht("div",a+"-tip",this._tipContainer),this.options.closeButton){var A=this._closeButton=ht("a",a+"-close-button",d);A.setAttribute("role","button"),A.setAttribute("aria-label","Close popup"),A.href="#close",A.innerHTML='<span aria-hidden="true">&#215;</span>',Ke(A,"click",function(I){tn(I),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,d=a.style;d.width="",d.whiteSpace="nowrap";var v=a.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),d.width=v+1+"px",d.whiteSpace="",d.height="";var A=a.offsetHeight,I=this.options.maxHeight,P="leaflet-popup-scrolled";I&&A>I?(d.height=I+"px",Ve(a,P)):Ut(a,P),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),v=this._getAnchor();zt(this._container,d.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,d=parseInt(oo(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+d,A=this._containerWidth,I=new Ae(this._containerLeft,-v-this._containerBottom);I._add(vs(this._container));var P=a.layerPointToContainerPoint(I),G=Ne(this.options.autoPanPadding),X=Ne(this.options.autoPanPaddingTopLeft||G),ae=Ne(this.options.autoPanPaddingBottomRight||G),ve=a.getSize(),Me=0,He=0;P.x+A+ae.x>ve.x&&(Me=P.x+A-ve.x+ae.x),P.x-Me-X.x<0&&(Me=P.x-X.x),P.y+v+ae.y>ve.y&&(He=P.y+v-ve.y+ae.y),P.y-He-X.y<0&&(He=P.y-X.y),(Me||He)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([Me,He]))}},_getAnchor:function(){return Ne(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ud=function(a,d){return new Va(a,d)};ct.mergeOptions({closePopupOnClick:!0}),ct.include({openPopup:function(a,d,v){return this._initOverlay(Va,a,d,v).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),is.include({bindPopup:function(a,d){return this._popup=this._initOverlay(Va,this._popup,a,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof ws||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){Qi(a);var d=a.layer||a.target;if(this._popup._source===d&&!(d instanceof As)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=d,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var Oa=Gn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){Gn.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){Gn.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=Gn.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",d=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ht("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+g(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var d,v,A=this._map,I=this._container,P=A.latLngToContainerPoint(A.getCenter()),G=A.layerPointToContainerPoint(a),X=this.options.direction,ae=I.offsetWidth,ve=I.offsetHeight,Me=Ne(this.options.offset),He=this._getAnchor();X==="top"?(d=ae/2,v=ve):X==="bottom"?(d=ae/2,v=0):X==="center"?(d=ae/2,v=ve/2):X==="right"?(d=0,v=ve/2):X==="left"?(d=ae,v=ve/2):G.x<P.x?(X="right",d=0,v=ve/2):(X="left",d=ae+(Me.x+He.x)*2,v=ve/2),a=a.subtract(Ne(d,v,!0)).add(Me).add(He),Ut(I,"leaflet-tooltip-right"),Ut(I,"leaflet-tooltip-left"),Ut(I,"leaflet-tooltip-top"),Ut(I,"leaflet-tooltip-bottom"),Ve(I,"leaflet-tooltip-"+X),zt(I,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&Kt(this._container,a)},_animateZoom:function(a){var d=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(d)},_getAnchor:function(){return Ne(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),kf=function(a,d){return new Oa(a,d)};ct.include({openTooltip:function(a,d,v){return this._initOverlay(Oa,a,d,v).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),is.include({bindTooltip:function(a,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Oa,this._tooltip,a,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var d=a?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[d](v),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof ws||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var d=typeof a.getElement=="function"&&a.getElement();d&&(Ke(d,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),Ke(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var d=typeof a.getElement=="function"&&a.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var d=a.latlng,v,A;this._tooltip.options.sticky&&a.originalEvent&&(v=this._map.mouseEventToContainerPoint(a.originalEvent),A=this._map.containerPointToLayerPoint(v),d=this._map.layerPointToLatLng(A)),this._tooltip.setLatLng(d)}});var cd=Ss.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var d=a&&a.tagName==="DIV"?a:document.createElement("div"),v=this.options;if(v.html instanceof Element?(Xt(d),d.appendChild(v.html)):d.innerHTML=v.html!==!1?v.html:"",v.bgPos){var A=Ne(v.bgPos);d.style.backgroundPosition=-A.x+"px "+-A.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function Df(a){return new cd(a)}Ss.Default=Ra;var Rr=is.extend({options:{tileSize:256,opacity:1,updateWhenIdle:ze.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){H(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),ft(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(en(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(yi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof Ae?a:new Ae(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var d=this.getPane().children,v=-a(-1/0,1/0),A=0,I=d.length,P;A<I;A++)P=d[A].style.zIndex,d[A]!==this._container&&P&&(v=a(v,+P));isFinite(v)&&(this.options.zIndex=v+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ze.ielt9){Kt(this._container,this.options.opacity);var a=+new Date,d=!1,v=!1;for(var A in this._tiles){var I=this._tiles[A];if(!(!I.current||!I.loaded)){var P=Math.min(1,(a-I.loaded)/200);Kt(I.el,P),P<1?d=!0:(I.active?v=!0:this._onOpaqueTile(I),I.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),d&&(K(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this))}},_onOpaqueTile:S,_initContainer:function(){this._container||(this._container=ht("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,d=this.options.maxZoom;if(a!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===a?(this._levels[v].el.style.zIndex=d-Math.abs(a-v),this._onUpdateLevel(v)):(ft(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var A=this._levels[a],I=this._map;return A||(A=this._levels[a]={},A.el=ht("div","leaflet-tile-container leaflet-zoom-animated",this._container),A.el.style.zIndex=d,A.origin=I.project(I.unproject(I.getPixelOrigin()),a).round(),A.zoom=a,this._setZoomTransform(A,I.getCenter(),I.getZoom()),S(A.el.offsetWidth),this._onCreateLevel(A)),this._level=A,A}},_onUpdateLevel:S,_onRemoveLevel:S,_onCreateLevel:S,_pruneTiles:function(){if(this._map){var a,d,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)d=this._tiles[a],d.retain=d.current;for(a in this._tiles)if(d=this._tiles[a],d.current&&!d.active){var A=d.coords;this._retainParent(A.x,A.y,A.z,A.z-5)||this._retainChildren(A.x,A.y,A.z,A.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var d in this._tiles)this._tiles[d].coords.z===a&&this._removeTile(d)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)ft(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,d,v,A){var I=Math.floor(a/2),P=Math.floor(d/2),G=v-1,X=new Ae(+I,+P);X.z=+G;var ae=this._tileCoordsToKey(X),ve=this._tiles[ae];return ve&&ve.active?(ve.retain=!0,!0):(ve&&ve.loaded&&(ve.retain=!0),G>A?this._retainParent(I,P,G,A):!1)},_retainChildren:function(a,d,v,A){for(var I=2*a;I<2*a+2;I++)for(var P=2*d;P<2*d+2;P++){var G=new Ae(I,P);G.z=v+1;var X=this._tileCoordsToKey(G),ae=this._tiles[X];if(ae&&ae.active){ae.retain=!0;continue}else ae&&ae.loaded&&(ae.retain=!0);v+1<A&&this._retainChildren(I,P,v+1,A)}},_resetView:function(a){var d=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var d=this.options;return d.minNativeZoom!==void 0&&a<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<a?d.maxNativeZoom:a},_setView:function(a,d,v,A){var I=Math.round(d);this.options.maxZoom!==void 0&&I>this.options.maxZoom||this.options.minZoom!==void 0&&I<this.options.minZoom?I=void 0:I=this._clampZoom(I);var P=this.options.updateWhenZooming&&I!==this._tileZoom;(!A||P)&&(this._tileZoom=I,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),I!==void 0&&this._update(a),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(a,d)},_setZoomTransforms:function(a,d){for(var v in this._levels)this._setZoomTransform(this._levels[v],a,d)},_setZoomTransform:function(a,d,v){var A=this._map.getZoomScale(v,a.zoom),I=a.origin.multiplyBy(A).subtract(this._map._getNewPixelOrigin(d,v)).round();ze.any3d?Ji(a.el,I,A):zt(a.el,I)},_resetGrid:function(){var a=this._map,d=a.options.crs,v=this._tileSize=this.getTileSize(),A=this._tileZoom,I=this._map.getPixelWorldBounds(this._tileZoom);I&&(this._globalTileRange=this._pxBoundsToTileRange(I)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,d.wrapLng[0]],A).x/v.x),Math.ceil(a.project([0,d.wrapLng[1]],A).x/v.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([d.wrapLat[0],0],A).y/v.x),Math.ceil(a.project([d.wrapLat[1],0],A).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var d=this._map,v=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),A=d.getZoomScale(v,this._tileZoom),I=d.project(a,this._tileZoom).floor(),P=d.getSize().divideBy(A*2);return new j(I.subtract(P),I.add(P))},_update:function(a){var d=this._map;if(d){var v=this._clampZoom(d.getZoom());if(a===void 0&&(a=d.getCenter()),this._tileZoom!==void 0){var A=this._getTiledPixelBounds(a),I=this._pxBoundsToTileRange(A),P=I.getCenter(),G=[],X=this.options.keepBuffer,ae=new j(I.getBottomLeft().subtract([X,-X]),I.getTopRight().add([X,-X]));if(!(isFinite(I.min.x)&&isFinite(I.min.y)&&isFinite(I.max.x)&&isFinite(I.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ve in this._tiles){var Me=this._tiles[ve].coords;(Me.z!==this._tileZoom||!ae.contains(new Ae(Me.x,Me.y)))&&(this._tiles[ve].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(a,v);return}for(var He=I.min.y;He<=I.max.y;He++)for(var at=I.min.x;at<=I.max.x;at++){var Ln=new Ae(at,He);if(Ln.z=this._tileZoom,!!this._isValidTile(Ln)){var gn=this._tiles[this._tileCoordsToKey(Ln)];gn?gn.current=!0:G.push(Ln)}}if(G.sort(function(It,Nt){return It.distanceTo(P)-Nt.distanceTo(P)}),G.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var xi=document.createDocumentFragment();for(at=0;at<G.length;at++)this._addTile(G[at],xi);this._level.el.appendChild(xi)}}}},_isValidTile:function(a){var d=this._map.options.crs;if(!d.infinite){var v=this._globalTileRange;if(!d.wrapLng&&(a.x<v.min.x||a.x>v.max.x)||!d.wrapLat&&(a.y<v.min.y||a.y>v.max.y))return!1}if(!this.options.bounds)return!0;var A=this._tileCoordsToBounds(a);return ce(this.options.bounds).overlaps(A)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var d=this._map,v=this.getTileSize(),A=a.scaleBy(v),I=A.add(v),P=d.unproject(A,a.z),G=d.unproject(I,a.z);return[P,G]},_tileCoordsToBounds:function(a){var d=this._tileCoordsToNwSe(a),v=new be(d[0],d[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var d=a.split(":"),v=new Ae(+d[0],+d[1]);return v.z=+d[2],v},_removeTile:function(a){var d=this._tiles[a];d&&(ft(d.el),delete this._tiles[a],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){Ve(a,"leaflet-tile");var d=this.getTileSize();a.style.width=d.x+"px",a.style.height=d.y+"px",a.onselectstart=S,a.onmousemove=S,ze.ielt9&&this.options.opacity<1&&Kt(a,this.options.opacity)},_addTile:function(a,d){var v=this._getTilePos(a),A=this._tileCoordsToKey(a),I=this.createTile(this._wrapCoords(a),c(this._tileReady,this,a));this._initTile(I),this.createTile.length<2&&q(c(this._tileReady,this,a,null,I)),zt(I,v),this._tiles[A]={el:I,coords:a,current:!0},d.appendChild(I),this.fire("tileloadstart",{tile:I,coords:a})},_tileReady:function(a,d,v){d&&this.fire("tileerror",{error:d,tile:v,coords:a});var A=this._tileCoordsToKey(a);v=this._tiles[A],v&&(v.loaded=+new Date,this._map._fadeAnimated?(Kt(v.el,0),K(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),d||(Ve(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ze.ielt9||!this._map._fadeAnimated?q(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var d=new Ae(this._wrapX?x(a.x,this._wrapX):a.x,this._wrapY?x(a.y,this._wrapY):a.y);return d.z=a.z,d},_pxBoundsToTileRange:function(a){var d=this.getTileSize();return new j(a.min.unscaleBy(d).floor(),a.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function dd(a){return new Rr(a)}var go=Rr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,d){this._url=a,d=H(this,d),d.detectRetina&&ze.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,d){return this._url===a&&d===void 0&&(d=!0),this._url=a,d||this.redraw(),this},createTile:function(a,d){var v=document.createElement("img");return Ke(v,"load",c(this._tileOnLoad,this,d,v)),Ke(v,"error",c(this._tileOnError,this,d,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(a),v},getTileUrl:function(a){var d={r:ze.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-a.y;this.options.tms&&(d.y=v),d["-y"]=v}return re(this._url,r(d,this.options))},_tileOnLoad:function(a,d){ze.ielt9?setTimeout(c(a,this,null,d),0):a(null,d)},_tileOnError:function(a,d,v){var A=this.options.errorTileUrl;A&&d.getAttribute("src")!==A&&(d.src=A),a(v,d)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,d=this.options.maxZoom,v=this.options.zoomReverse,A=this.options.zoomOffset;return v&&(a=d-a),a+A},_getSubdomain:function(a){var d=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var a,d;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(d=this._tiles[a].el,d.onload=S,d.onerror=S,!d.complete)){d.src=pe;var v=this._tiles[a].coords;ft(d),delete this._tiles[a],this.fire("tileabort",{tile:d,coords:v})}},_removeTile:function(a){var d=this._tiles[a];if(d)return d.el.setAttribute("src",pe),Rr.prototype._removeTile.call(this,a)},_tileReady:function(a,d,v){if(!(!this._map||v&&v.getAttribute("src")===pe))return Rr.prototype._tileReady.call(this,a,d,v)}});function Di(a,d){return new go(a,d)}var Ua=go.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,d){this._url=a;var v=r({},this.defaultWmsParams);for(var A in d)A in this.options||(v[A]=d[A]);d=H(this,d);var I=d.detectRetina&&ze.retina?2:1,P=this.getTileSize();v.width=P.x*I,v.height=P.y*I,this.wmsParams=v},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,go.prototype.onAdd.call(this,a)},getTileUrl:function(a){var d=this._tileCoordsToNwSe(a),v=this._crs,A=he(v.project(d[0]),v.project(d[1])),I=A.min,P=A.max,G=(this._wmsVersion>=1.3&&this._crs===zo?[I.y,I.x,P.y,P.x]:[I.x,I.y,P.x,P.y]).join(","),X=go.prototype.getTileUrl.call(this,a);return X+Y(this.wmsParams,X,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+G},setParams:function(a,d){return r(this.wmsParams,a),d||this.redraw(),this}});function Li(a,d){return new Ua(a,d)}go.WMS=Ua,Di.wms=Li;var oi=is.extend({options:{padding:.1},initialize:function(a){H(this,a),g(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ve(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,d){var v=this._map.getZoomScale(d,this._zoom),A=this._map.getSize().multiplyBy(.5+this.options.padding),I=this._map.project(this._center,d),P=A.multiplyBy(-v).add(I).subtract(this._map._getNewPixelOrigin(a,d));ze.any3d?Ji(this._container,P,v):zt(this._container,P)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,d=this._map.getSize(),v=this._map.containerPointToLayerPoint(d.multiplyBy(-a)).round();this._bounds=new j(v,v.add(d.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Il=oi.extend({options:{tolerance:0},getEvents:function(){var a=oi.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){oi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");Ke(a,"mousemove",this._onMouseMove,this),Ke(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ke(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){K(this._redrawRequest),delete this._ctx,ft(this._container),bt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var d in this._layers)a=this._layers[d],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){oi.prototype._update.call(this);var a=this._bounds,d=this._container,v=a.getSize(),A=ze.retina?2:1;zt(d,a.min),d.width=A*v.x,d.height=A*v.y,d.style.width=v.x+"px",d.style.height=v.y+"px",ze.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){oi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[g(a)]=a;var d=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var d=a._order,v=d.next,A=d.prev;v?v.prev=A:this._drawLast=A,A?A.next=v:this._drawFirst=v,delete a._order,delete this._layers[g(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var d=a.options.dashArray.split(/[, ]+/),v=[],A,I;for(I=0;I<d.length;I++){if(A=Number(d[I]),isNaN(A))return;v.push(A)}a.options._dashArray=v}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||q(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var d=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new j,this._redrawBounds.extend(a._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(a._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var d=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,d=this._redrawBounds;if(this._ctx.save(),d){var v=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var A=this._drawFirst;A;A=A.next)a=A.layer,(!d||a._pxBounds&&a._pxBounds.intersects(d))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,d){if(this._drawing){var v,A,I,P,G=a._parts,X=G.length,ae=this._ctx;if(X){for(ae.beginPath(),v=0;v<X;v++){for(A=0,I=G[v].length;A<I;A++)P=G[v][A],ae[A?"lineTo":"moveTo"](P.x,P.y);d&&ae.closePath()}this._fillStroke(ae,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var d=a._point,v=this._ctx,A=Math.max(Math.round(a._radius),1),I=(Math.max(Math.round(a._radiusY),1)||A)/A;I!==1&&(v.save(),v.scale(1,I)),v.beginPath(),v.arc(d.x,d.y/I,A,0,Math.PI*2,!1),I!==1&&v.restore(),this._fillStroke(v,a)}},_fillStroke:function(a,d){var v=d.options;v.fill&&(a.globalAlpha=v.fillOpacity,a.fillStyle=v.fillColor||v.color,a.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(a.setLineDash&&a.setLineDash(d.options&&d.options._dashArray||[]),a.globalAlpha=v.opacity,a.lineWidth=v.weight,a.strokeStyle=v.color,a.lineCap=v.lineCap,a.lineJoin=v.lineJoin,a.stroke())},_onClick:function(a){for(var d=this._map.mouseEventToLayerPoint(a),v,A,I=this._drawFirst;I;I=I.next)v=I.layer,v.options.interactive&&v._containsPoint(d)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(v))&&(A=v);this._fireEvent(A?[A]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,d)}},_handleMouseOut:function(a){var d=this._hoveredLayer;d&&(Ut(this._container,"leaflet-interactive"),this._fireEvent([d],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,d){if(!this._mouseHoverThrottled){for(var v,A,I=this._drawFirst;I;I=I.next)v=I.layer,v.options.interactive&&v._containsPoint(d)&&(A=v);A!==this._hoveredLayer&&(this._handleMouseOut(a),A&&(Ve(this._container,"leaflet-interactive"),this._fireEvent([A],a,"mouseover"),this._hoveredLayer=A)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,d,v){this._map._fireDOMEvent(d,v||d.type,a)},_bringToFront:function(a){var d=a._order;if(d){var v=d.next,A=d.prev;if(v)v.prev=A;else return;A?A.next=v:v&&(this._drawFirst=v),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(a)}},_bringToBack:function(a){var d=a._order;if(d){var v=d.next,A=d.prev;if(A)A.next=v;else return;v?v.prev=A:A&&(this._drawLast=A),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(a)}}});function za(a){return ze.canvas?new Il(a):null}var _o=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Vu={_initContainer:function(){this._container=ht("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(oi.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var d=a._container=_o("shape");Ve(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",a._path=_o("path"),d.appendChild(a._path),this._updateStyle(a),this._layers[g(a)]=a},_addPath:function(a){var d=a._container;this._container.appendChild(d),a.options.interactive&&a.addInteractiveTarget(d)},_removePath:function(a){var d=a._container;ft(d),a.removeInteractiveTarget(d),delete this._layers[g(a)]},_updateStyle:function(a){var d=a._stroke,v=a._fill,A=a.options,I=a._container;I.stroked=!!A.stroke,I.filled=!!A.fill,A.stroke?(d||(d=a._stroke=_o("stroke")),I.appendChild(d),d.weight=A.weight+"px",d.color=A.color,d.opacity=A.opacity,A.dashArray?d.dashStyle=ee(A.dashArray)?A.dashArray.join(" "):A.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=A.lineCap.replace("butt","flat"),d.joinstyle=A.lineJoin):d&&(I.removeChild(d),a._stroke=null),A.fill?(v||(v=a._fill=_o("fill")),I.appendChild(v),v.color=A.fillColor||A.color,v.opacity=A.fillOpacity):v&&(I.removeChild(v),a._fill=null)},_updateCircle:function(a){var d=a._point.round(),v=Math.round(a._radius),A=Math.round(a._radiusY||v);this._setPath(a,a._empty()?"M0 0":"AL "+d.x+","+d.y+" "+v+","+A+" 0,"+65535*360)},_setPath:function(a,d){a._path.v=d},_bringToFront:function(a){en(a._container)},_bringToBack:function(a){yi(a._container)}},Cs=ze.vml?_o:mi,Mr=oi.extend({_initContainer:function(){this._container=Cs("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Cs("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ft(this._container),bt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){oi.prototype._update.call(this);var a=this._bounds,d=a.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,v.setAttribute("width",d.x),v.setAttribute("height",d.y)),zt(v,a.min),v.setAttribute("viewBox",[a.min.x,a.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(a){var d=a._path=Cs("path");a.options.className&&Ve(d,a.options.className),a.options.interactive&&Ve(d,"leaflet-interactive"),this._updateStyle(a),this._layers[g(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){ft(a._path),a.removeInteractiveTarget(a._path),delete this._layers[g(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var d=a._path,v=a.options;d&&(v.stroke?(d.setAttribute("stroke",v.color),d.setAttribute("stroke-opacity",v.opacity),d.setAttribute("stroke-width",v.weight),d.setAttribute("stroke-linecap",v.lineCap),d.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?d.setAttribute("stroke-dasharray",v.dashArray):d.removeAttribute("stroke-dasharray"),v.dashOffset?d.setAttribute("stroke-dashoffset",v.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),v.fill?(d.setAttribute("fill",v.fillColor||v.color),d.setAttribute("fill-opacity",v.fillOpacity),d.setAttribute("fill-rule",v.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(a,d){this._setPath(a,ei(a._parts,d))},_updateCircle:function(a){var d=a._point,v=Math.max(Math.round(a._radius),1),A=Math.max(Math.round(a._radiusY),1)||v,I="a"+v+","+A+" 0 1,0 ",P=a._empty()?"M0 0":"M"+(d.x-v)+","+d.y+I+v*2+",0 "+I+-v*2+",0 ";this._setPath(a,P)},_setPath:function(a,d){a._path.setAttribute("d",d)},_bringToFront:function(a){en(a._path)},_bringToBack:function(a){yi(a._path)}});ze.vml&&Mr.include(Vu);function Ba(a){return ze.svg||ze.vml?new Mr(a):null}ct.include({getRenderer:function(a){var d=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var d=this._paneRenderers[a];return d===void 0&&(d=this._createRenderer({pane:a}),this._paneRenderers[a]=d),d},_createRenderer:function(a){return this.options.preferCanvas&&za(a)||Ba(a)}});var Bo=Cr.extend({initialize:function(a,d){Cr.prototype.initialize.call(this,this._boundsToLatLngs(a),d)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=ce(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function Lf(a,d){return new Bo(a,d)}Mr.create=Cs,Mr.pointsToPath=ei,Gs.geometryToLayer=Hn,Gs.coordsToLatLng=wl,Gs.coordsToLatLngs=ka,Gs.latLngToCoords=Sl,Gs.latLngsToCoords=Da,Gs.getFeature=fo,Gs.asFeature=Al,ct.mergeOptions({boxZoom:!0});var ri=Ti.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){Ke(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){bt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ft(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ri(),Do(),this._startPoint=this._map.mouseEventToContainerPoint(a),Ke(document,{contextmenu:Qi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=ht("div","leaflet-zoom-box",this._container),Ve(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var d=new j(this._point,this._startPoint),v=d.getSize();zt(this._box,d.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(ft(this._box),Ut(this._container,"leaflet-crosshair")),Sn(),ro(),bt(document,{contextmenu:Qi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var d=new be(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ct.addInitHook("addHandler","boxZoom",ri),ct.mergeOptions({doubleClickZoom:!0});var Nl=Ti.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var d=this._map,v=d.getZoom(),A=d.options.zoomDelta,I=a.originalEvent.shiftKey?v-A:v+A;d.options.doubleClickZoom==="center"?d.setZoom(I):d.setZoomAround(a.containerPoint,I)}});ct.addInitHook("addHandler","doubleClickZoom",Nl),ct.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var bs=Ti.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new ts(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}Ve(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ut(this._map._container,"leaflet-grab"),Ut(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=ce(this._map.options.maxBounds);this._offsetLimit=he(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var d=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(d),this._prunePositions(d)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,d){return a-(a-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;a.x<d.min.x&&(a.x=this._viscousLimit(a.x,d.min.x)),a.y<d.min.y&&(a.y=this._viscousLimit(a.y,d.min.y)),a.x>d.max.x&&(a.x=this._viscousLimit(a.x,d.max.x)),a.y>d.max.y&&(a.y=this._viscousLimit(a.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,d=Math.round(a/2),v=this._initialWorldOffset,A=this._draggable._newPos.x,I=(A-d+v)%a+d-v,P=(A+d+v)%a-d-v,G=Math.abs(I+v)<Math.abs(P+v)?I:P;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=G},_onDragEnd:function(a){var d=this._map,v=d.options,A=!v.inertia||a.noInertia||this._times.length<2;if(d.fire("dragend",a),A)d.fire("moveend");else{this._prunePositions(+new Date);var I=this._lastPos.subtract(this._positions[0]),P=(this._lastTime-this._times[0])/1e3,G=v.easeLinearity,X=I.multiplyBy(G/P),ae=X.distanceTo([0,0]),ve=Math.min(v.inertiaMaxSpeed,ae),Me=X.multiplyBy(ve/ae),He=ve/(v.inertiaDeceleration*G),at=Me.multiplyBy(-He/2).round();!at.x&&!at.y?d.fire("moveend"):(at=d._limitOffset(at,d.options.maxBounds),q(function(){d.panBy(at,{duration:He,easeLinearity:G,noMoveStart:!0,animate:!0})}))}}});ct.addInitHook("addHandler","dragging",bs),ct.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ou=Ti.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),Ke(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),bt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,d=document.documentElement,v=a.scrollTop||d.scrollTop,A=a.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(A,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var d=this._panKeys={},v=this.keyCodes,A,I;for(A=0,I=v.left.length;A<I;A++)d[v.left[A]]=[-1*a,0];for(A=0,I=v.right.length;A<I;A++)d[v.right[A]]=[a,0];for(A=0,I=v.down.length;A<I;A++)d[v.down[A]]=[0,a];for(A=0,I=v.up.length;A<I;A++)d[v.up[A]]=[0,-1*a]},_setZoomDelta:function(a){var d=this._zoomKeys={},v=this.keyCodes,A,I;for(A=0,I=v.zoomIn.length;A<I;A++)d[v.zoomIn[A]]=a;for(A=0,I=v.zoomOut.length;A<I;A++)d[v.zoomOut[A]]=-a},_addHooks:function(){Ke(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){bt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var d=a.keyCode,v=this._map,A;if(d in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(A=this._panKeys[d],a.shiftKey&&(A=Ne(A).multiplyBy(3)),v.options.maxBounds&&(A=v._limitOffset(Ne(A),v.options.maxBounds)),v.options.worldCopyJump){var I=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(A)));v.panTo(I)}else v.panBy(A)}else if(d in this._zoomKeys)v.setZoom(v.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;Qi(a)}}});ct.addInitHook("addHandler","keyboard",Ou),ct.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Fa=Ti.extend({addHooks:function(){Ke(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){bt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var d=An(a),v=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var A=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),A),Qi(a)},_performZoom:function(){var a=this._map,d=a.getZoom(),v=this._map.options.zoomSnap||0;a._stop();var A=this._delta/(this._map.options.wheelPxPerZoomLevel*4),I=4*Math.log(2/(1+Math.exp(-Math.abs(A))))/Math.LN2,P=v?Math.ceil(I/v)*v:I,G=a._limitZoom(d+(this._delta>0?P:-P))-d;this._delta=0,this._startTime=null,G&&(a.options.scrollWheelZoom==="center"?a.setZoom(d+G):a.setZoomAround(this._lastMousePos,d+G))}});ct.addInitHook("addHandler","scrollWheelZoom",Fa);var Fo=600;ct.mergeOptions({tapHold:ze.touchNative&&ze.safari&&ze.mobile,tapTolerance:15});var Rl=Ti.extend({addHooks:function(){Ke(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){bt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var d=a.touches[0];this._startPos=this._newPos=new Ae(d.clientX,d.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(Ke(document,"touchend",tn),Ke(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),Fo),Ke(document,"touchend touchcancel contextmenu",this._cancel,this),Ke(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){bt(document,"touchend",tn),bt(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),bt(document,"touchend touchcancel contextmenu",this._cancel,this),bt(document,"touchmove",this._onMove,this)},_onMove:function(a){var d=a.touches[0];this._newPos=new Ae(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,d){var v=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});v._simulated=!0,d.target.dispatchEvent(v)}});ct.addInitHook("addHandler","tapHold",Rl),ct.mergeOptions({touchZoom:ze.touch,bounceAtZoomLimits:!0});var Uu=Ti.extend({addHooks:function(){Ve(this._map._container,"leaflet-touch-zoom"),Ke(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ut(this._map._container,"leaflet-touch-zoom"),bt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var d=this._map;if(!(!a.touches||a.touches.length!==2||d._animatingZoom||this._zooming)){var v=d.mouseEventToContainerPoint(a.touches[0]),A=d.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(v.add(A)._divideBy(2))),this._startDist=v.distanceTo(A),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),Ke(document,"touchmove",this._onTouchMove,this),Ke(document,"touchend touchcancel",this._onTouchEnd,this),tn(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var d=this._map,v=d.mouseEventToContainerPoint(a.touches[0]),A=d.mouseEventToContainerPoint(a.touches[1]),I=v.distanceTo(A)/this._startDist;if(this._zoom=d.getScaleZoom(I,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&I<1||this._zoom>d.getMaxZoom()&&I>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,I===1)return}else{var P=v._add(A)._divideBy(2)._subtract(this._centerPoint);if(I===1&&P.x===0&&P.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(P),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),K(this._animRequest);var G=c(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=q(G,this,!0),tn(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,K(this._animRequest),bt(document,"touchmove",this._onTouchMove,this),bt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ct.addInitHook("addHandler","touchZoom",Uu),ct.BoxZoom=ri,ct.DoubleClickZoom=Nl,ct.Drag=bs,ct.Keyboard=Ou,ct.ScrollWheelZoom=Fa,ct.TapHold=Rl,ct.TouchZoom=Uu,t.Bounds=j,t.Browser=ze,t.CRS=_e,t.Canvas=Il,t.Circle=xl,t.CircleMarker=Ar,t.Class=Le,t.Control=Fn,t.DivIcon=cd,t.DivOverlay=Gn,t.DomEvent=xs,t.DomUtil=lo,t.Draggable=ts,t.Evented=Se,t.FeatureGroup=ws,t.GeoJSON=Gs,t.GridLayer=Rr,t.Handler=Ti,t.Icon=Ss,t.ImageOverlay=Ir,t.LatLng=me,t.LatLngBounds=be,t.Layer=is,t.LayerGroup=Sr,t.LineUtil=Pi,t.Map=ct,t.Marker=Pa,t.Mixin=Tl,t.Path=As,t.Point=Ae,t.PolyUtil=ho,t.Polygon=Cr,t.Polyline=Hs,t.Popup=Va,t.PosAnimation=Bs,t.Projection=ns,t.Rectangle=Bo,t.Renderer=oi,t.SVG=Mr,t.SVGOverlay=bl,t.TileLayer=go,t.Tooltip=Oa,t.Transformation=wt,t.Util=z,t.VideoOverlay=po,t.bind=c,t.bounds=he,t.canvas=za,t.circle=rd,t.circleMarker=od,t.control=si,t.divIcon=Df,t.extend=r,t.featureGroup=id,t.geoJSON=Cl,t.geoJson=La,t.gridLayer=dd,t.icon=Na,t.imageOverlay=ad,t.latLng=Ce,t.latLngBounds=ce,t.layerGroup=Rf,t.map=co,t.marker=sd,t.point=Ne,t.polygon=Pf,t.polyline=Mf,t.popup=ud,t.rectangle=Lf,t.setOptions=H,t.stamp=g,t.svg=Ba,t.svgOverlay=ld,t.tileLayer=Di,t.tooltip=kf,t.transformation=Ze,t.version=i,t.videoOverlay=Nr;var zu=window.L;t.noConflict=function(){return window.L=zu,this},window.L=t}))})(xc,xc.exports)),xc.exports}var Au=ZP();const hl=gg(Au);function rf(n,e,t){return Object.freeze({instance:n,context:e,container:t})}function af(n,e){return e==null?function(i,r){const u=W.useRef(void 0);return u.current||(u.current=n(i,r)),u}:function(i,r){const u=W.useRef(void 0);u.current||(u.current=n(i,r));const c=W.useRef(i),{instance:m}=u.current;return W.useEffect(function(){c.current!==i&&(e(m,i,c.current),c.current=i)},[m,i,e]),u}}function zw(n,e){W.useEffect(function(){return(e.layerContainer??e.map).addLayer(n.instance),function(){var u;(u=e.layerContainer)==null||u.removeLayer(n.instance),e.map.removeLayer(n.instance)}},[e,n])}function Bw(n){return function(t){const i=sf(),r=n(of(t,i),i);return Vw(i.map,t.attribution),Mg(r.current,t.eventHandlers),zw(r.current,i),r}}function YP(n,e){const t=W.useRef(void 0);W.useEffect(function(){if(e.pathOptions!==t.current){const r=e.pathOptions??{};n.instance.setStyle(r),t.current=r}},[n,e])}function WP(n){return function(t){const i=sf(),r=n(of(t,i),i);return Mg(r.current,t.eventHandlers),zw(r.current,i),YP(r.current,t),r}}function JP(n,e){const t=af(n,e),i=Bw(t);return Uw(i)}function QP(n,e){const t=af(n),i=jP(t,e);return HP(i)}function $P(n,e){const t=af(n,e),i=WP(t);return Uw(i)}function XP(n,e){const t=af(n,e),i=Bw(t);return GP(i)}function e5(n,e,t){const{opacity:i,zIndex:r}=e;i!=null&&i!==t.opacity&&n.setOpacity(i),r!=null&&r!==t.zIndex&&n.setZIndex(r)}function lf(){return sf().map}function t5({bounds:n,boundsOptions:e,center:t,children:i,className:r,id:u,placeholder:c,style:m,whenReady:g,zoom:p,...x},S){const[C]=W.useState({className:r,id:u,style:m}),[M,F]=W.useState(null),H=W.useRef(void 0);W.useImperativeHandle(S,()=>(M==null?void 0:M.map)??null,[M]);const Y=W.useCallback(re=>{if(re!==null&&!H.current){const ee=new Au.Map(re,x);H.current=ee,t!=null&&p!=null?ee.setView(t,p):n!=null&&ee.fitBounds(n,e),g!=null&&ee.whenReady(g),F(qP(ee))}},[]);W.useEffect(()=>()=>{M==null||M.map.remove()},[M]);const ie=M?Lc.createElement(Rg,{value:M},i):c??null;return Lc.createElement("div",{...C,ref:Y},ie)}const Fw=W.forwardRef(t5),Pg=JP(function({position:e,...t},i){const r=new Au.Marker(e,t);return rf(r,Ow(i,{overlayContainer:r}))},function(e,t,i){t.position!==i.position&&e.setLatLng(t.position),t.icon!=null&&t.icon!==i.icon&&e.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==i.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==i.opacity&&e.setOpacity(t.opacity),e.dragging!=null&&t.draggable!==i.draggable&&(t.draggable===!0?e.dragging.enable():e.dragging.disable())}),n5=$P(function({positions:e,...t},i){const r=new Au.Polyline(e,t);return rf(r,Ow(i,{overlayContainer:r}))},function(e,t,i){t.positions!==i.positions&&e.setLatLngs(t.positions)}),kg=QP(function(e,t){const i=new Au.Popup(e,t.overlayContainer);return rf(i,t)},function(e,t,{position:i},r){W.useEffect(function(){const{instance:c}=e;function m(p){p.popup===c&&(c.update(),r(!0))}function g(p){p.popup===c&&r(!1)}return t.map.on({popupopen:m,popupclose:g}),t.overlayContainer==null?(i!=null&&c.setLatLng(i),c.openOn(t.map)):t.overlayContainer.bindPopup(c),function(){var x;t.map.off({popupopen:m,popupclose:g}),(x=t.overlayContainer)==null||x.unbindPopup(),t.map.removeLayer(c)}},[e,t,r,i])}),qw=XP(function({url:e,...t},i){const r=new Au.TileLayer(e,of(t,i));return rf(r,i)},function(e,t,i){e5(e,t,i);const{url:r}=t;r!=null&&r!==i.url&&e.setUrl(r)}),i5="AIzaSyC2SRWVViygm5tBgGQeGgFEq9_jK_PdT_0",s5=n=>{var e,t,i,r;if(typeof n.text=="string")return n.text;if(typeof n.text=="function")return n.text();if(n.candidates&&((r=(i=(t=(e=n.candidates[0])==null?void 0:e.content)==null?void 0:t.parts)==null?void 0:i[0])!=null&&r.text))return n.candidates[0].content.parts[0].text;throw new Error("No text found in AI response")},uE={1:{lat:25.033,lng:121.5654},"taipei 101":{lat:25.033,lng:121.5654},2:{lat:25.0421,lng:121.5082},3:{lat:25.1024,lng:121.5486},test:{lat:25.033,lng:121.5654},kyoto:{lat:35.0116,lng:135.7681},osaka:{lat:34.6937,lng:135.5023},tokyo:{lat:35.6762,lng:139.6503},:{lat:26.2048,lng:127.6458}," () check in":{lat:26.2048,lng:127.6458},:{lat:26.2048,lng:127.6458},"  ":{lat:26.196,lng:127.665},:{lat:26.196,lng:127.665},:{lat:26.196,lng:127.665},:{lat:26.2206,lng:127.6711},:{lat:26.1308,lng:127.7739},:{lat:26.3164,lng:127.7577},:{lat:26.695,lng:128.022},:{lat:26.6942,lng:127.8779},:{lat:26.505,lng:127.8512},:{lat:26.215,lng:127.685},"tokyo tower":{lat:35.6586,lng:139.7454},:{lat:35.6586,lng:139.7454}},Ic=async(n,e)=>{const t=n.toLowerCase().trim();if(uE[t])return console.log(`Using Test Location for: ${n}`),uE[t];const i=async S=>{if(!S)return null;try{const M=await new Sw({apiKey:S}).models.generateContent({model:"gemini-2.0-flash",contents:`Convert this address to latitude and longitude coordinates: "${n}". 
                
                IMPORTANT: Return ONLY a JSON object in this exact format:
                {"lat": 25.0330, "lng": 121.5654}
                
                Do not include any explanations, just the JSON object.`,config:{responseMimeType:"application/json"}}),F=s5(M),H=JSON.parse(F);if(H.lat&&H.lng)return{lat:parseFloat(H.lat),lng:parseFloat(H.lng)}}catch(C){return console.warn(`Geocoding failed with key ${S.substring(0,5)}...`,C),null}return null},r=async S=>{if(!S)return null;try{console.log(`Trying Google Maps Geocoding API with key ${S.substring(0,5)}...`);const C=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(n)}&key=${S}`,F=await(await fetch(C)).json();if(F.status==="OK"&&F.results&&F.results.length>0){const H=F.results[0].geometry.location;return{lat:H.lat,lng:H.lng}}else console.warn("Google Maps Geocoding API error:",F.status,F.error_message),window.localStorage.setItem("last_geocode_error",`${F.status}: ${F.error_message||"Unknown error"}`)}catch(C){console.warn("Google Maps Geocoding API request failed:",C),window.localStorage.setItem("last_geocode_error",`Network Error: ${C}`)}return null},u=S=>S.split(/|\/|\|/).map(M=>M.trim()).filter(M=>M).map(M=>M.replace(/\(.*\)|.*/g,"").trim()).filter(M=>M.length>0),c=async(S,C={},M=5e3)=>{const F=new AbortController,H=setTimeout(()=>F.abort(),M);try{const Y=await fetch(S,{...C,signal:F.signal});return clearTimeout(H),Y}catch(Y){throw clearTimeout(H),Y}},m=async S=>{try{console.log(`[Geocoding] Trying Nominatim for: ${S}`);const C=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(S)}&limit=1`,{headers:{"User-Agent":"NomadAI-Travel-Journal/1.0"}});if(!C.ok)return console.warn(`[Geocoding] Nominatim request failed: ${C.status}`),null;const M=await C.json();if(console.log("[Geocoding] Nominatim response:",M),M&&M.length>0){const F=parseFloat(M[0].lat),H=parseFloat(M[0].lon);return console.log("[Geocoding] Nominatim success:",{lat:F,lng:H}),{lat:F,lng:H}}return null}catch(C){return console.error("Nominatim geocoding error:",C),null}},g=async S=>{try{console.log(`Trying Open-Meteo Geocoding for: "${S}"...`);const C=`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(S)}&count=1&language=zh&format=json`,M=await c(C);if(!M.ok)throw new Error(`Open-Meteo status: ${M.status}`);const F=await M.json();if(F&&F.results&&F.results.length>0){const H=F.results[0];return{lat:H.latitude,lng:H.longitude}}}catch(C){console.warn(`Open-Meteo failed for "${S}":`,C)}return null},p=[n,...u(n)],x=Array.from(new Set(p));console.log("Geocoding candidates:",x);for(const S of x){if(e){let F=await i(e);if(F||(F=await r(e),F))return F}{const F=await i(i5);if(F)return F}const C=await m(S);if(C)return C;const M=await g(S);if(M)return M}return null},o5=Object.freeze(Object.defineProperty({__proto__:null,geocodeAddress:Ic},Symbol.toStringTag,{value:"Module"})),Hw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",Gw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";let r5=hl.icon({iconUrl:Hw,shadowUrl:Gw,iconSize:[25,41],iconAnchor:[12,41]});hl.Marker.prototype.options.icon=r5;const a5=({bounds:n,isMapReady:e})=>{const t=lf();return W.useEffect(()=>{e&&n&&n.length>0&&setTimeout(()=>{t.fitBounds(n,{padding:[80,80]})},100)},[n,t,e]),null},l5=({onReady:n})=>{const e=lf();return W.useEffect(()=>{const t=setTimeout(()=>{e.invalidateSize(),n()},250);return()=>clearTimeout(t)},[e,n]),null},u5=({selectedLocation:n,searchedLocation:e,isMapReady:t})=>{const i=lf();return W.useEffect(()=>{t&&(e?i.flyTo([e.lat,e.lng],16,{animate:!0,duration:1.5}):n&&i.flyTo([n.lat,n.lng],16,{animate:!0,duration:1.5}))},[n,e,i,t]),null},c5=({item:n,index:e,isSelected:t,color:i,onClick:r})=>{var g,p;const u=Lc.useRef(null);W.useEffect(()=>{t&&u.current&&u.current.openPopup()},[t]);const c=((g=n.coordinates)==null?void 0:g.lat)||n.lat,m=((p=n.coordinates)==null?void 0:p.lng)||n.lng;return!c||!m?null:E.jsx(Pg,{ref:u,position:[c,m],icon:hl.divIcon({className:"custom-div-icon",html:`<div style="background-color: ${t?"#C5A059":i}; width: ${t?"32px":"24px"}; height: ${t?"32px":"24px"}; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: ${t?"14px":"12px"}; transition: all 0.3s ease;">${e+1}</div>`,iconSize:[t?32:24,t?32:24],iconAnchor:[t?16:12,t?16:12]}),eventHandlers:{click:r},children:E.jsx(kg,{children:E.jsxs("div",{className:"text-center",children:[E.jsxs("div",{className:"font-bold text-ink",children:[e+1,". ",n.activity]}),E.jsx("div",{className:"text-xs text-gray-500",children:n.time}),E.jsxs("div",{className:"text-xs text-coral mt-1",children:["Day ",n.day]})]})})})},d5=({trip:n,settings:e,onUpdateTrip:t,searchedLocation:i,onItemClick:r,mapSearchQuery:u})=>{Wt[e.language]||Wt["zh-TW"];const[c,m]=W.useState(null),[g,p]=W.useState(new Set),[x,S]=W.useState("ALL"),[C,M]=W.useState(null),[F,H]=W.useState(!1),Y=W.useMemo(()=>{const J=n.itinerary||[];return x==="ALL"?J:J.filter(k=>k.day===x)},[n.itinerary,x]),ie=W.useMemo(()=>{const J={};return(n.itinerary||[]).forEach(k=>{J[k.day]||(J[k.day]=[]),J[k.day].push(k)}),Object.keys(J).forEach(k=>{J[Number(k)].sort((U,V)=>U.time.localeCompare(V.time))}),J},[n.itinerary]),re=W.useMemo(()=>Object.keys(ie).map(Number).sort((J,k)=>J-k),[ie]),ee=["#FF5733","#33FF57","#3357FF","#FF33F5","#33FFF5","#F5FF33"],Ee=W.useMemo(()=>{const J=Y.filter(k=>k.coordinates||k.lat&&k.lng).map(k=>{var U,V;return[((U=k.coordinates)==null?void 0:U.lat)||k.lat,((V=k.coordinates)==null?void 0:V.lng)||k.lng]});return J.length===0?null:J},[Y]),pe=W.useMemo(()=>{var k,U,V;if(!C)return null;const J=(k=n.itinerary)==null?void 0:k.find(B=>B.id===C);return J&&(J.coordinates||J.lat&&J.lng)?{lat:((U=J.coordinates)==null?void 0:U.lat)||J.lat,lng:((V=J.coordinates)==null?void 0:V.lng)||J.lng}:null},[C,n.itinerary]);return W.useEffect(()=>{if(n.itinerary&&n.itinerary.length>0){const J=Array.from(new Set(n.itinerary.map(k=>Number(k.day)))).sort((k,U)=>k-U);if(J.length>0){const k=J[0],U=n.itinerary.filter(V=>V.day===k).sort((V,B)=>V.time.localeCompare(B.time));if(U.length>0){const V=U[0];if(M(V.id),S(k),r){const B=V.location||V.activity;B&&setTimeout(()=>r(B),500)}}}}},[n.id]),W.useEffect(()=>{window.localStorage.removeItem("last_geocode_error")},[n.id]),E.jsxs("div",{className:"h-full flex flex-col pb-24",children:[E.jsxs("div",{className:"mb-4 flex gap-2 overflow-x-auto no-scrollbar py-1 shrink-0",children:[E.jsx("button",{onClick:()=>{S("ALL"),M(null)},className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${x==="ALL"?"bg-ink text-white":"bg-white text-gray-500 border border-sand"}`,children:"ALL"}),re.map(J=>E.jsxs("button",{onClick:()=>{S(J),M(null)},className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors ${x===J?"bg-coral text-white":"bg-white text-gray-500 border border-sand"}`,children:["Day ",J]},J))]}),E.jsx("div",{className:"h-[35vh] shrink-0 bg-gray-100 rounded-3xl overflow-hidden shadow-inner border border-sand relative z-0 mb-4",children:E.jsxs(Fw,{center:[25.033,121.5654],zoom:13,style:{height:"100%",width:"100%"},children:[E.jsx(qw,{attribution:' <a href="https://www.google.com/maps">Google Maps</a>',url:"https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"}),E.jsx(l5,{onReady:()=>H(!0)}),Ee&&!pe&&!i&&E.jsx(a5,{bounds:Ee,isMapReady:F}),E.jsx(u5,{selectedLocation:pe,searchedLocation:i,isMapReady:F}),i&&(()=>{const J=Y.findIndex(B=>{var q,K;return((q=B.coordinates)==null?void 0:q.lat)===i.lat&&((K=B.coordinates)==null?void 0:K.lng)===i.lng||B.location===u||B.activity===u}),k=J!==-1?Y[J]:null;if(k&&k.coordinates)return null;const U=J!==-1?J+1:"?",V=k?ee[(k.day-1)%ee.length]:"#FF0000";return E.jsx(Pg,{position:[i.lat,i.lng],icon:hl.divIcon({className:"custom-div-icon",html:`<div style="background-color: ${V}; width: 32px; height: 32px; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 16px;">${U}</div>`,iconSize:[32,32],iconAnchor:[16,16]}),children:E.jsx(kg,{children:E.jsx("div",{className:"text-center font-bold",children:"Searched Location"})})})})(),Y.map((J,k)=>E.jsx(c5,{item:J,index:k,isSelected:C===J.id,color:ee[(J.day-1)%ee.length],onClick:()=>M(J.id)},J.id||k)),re.map((J,k)=>{if(x!=="ALL"&&x!==J)return null;const V=ie[J].filter(B=>{var q,K;return(((q=B.coordinates)==null?void 0:q.lat)||B.lat)&&(((K=B.coordinates)==null?void 0:K.lng)||B.lng)}).map(B=>{var q,K;return[((q=B.coordinates)==null?void 0:q.lat)||B.lat,((K=B.coordinates)==null?void 0:K.lng)||B.lng]});return V.length<2?null:E.jsx(n5,{positions:V,color:ee[k%ee.length],weight:4,opacity:.7,dashArray:"10, 10"},J)})]})}),E.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 space-y-3 px-1",children:Y.map((J,k)=>{var q,K;const U=(((q=J.coordinates)==null?void 0:q.lat)||J.lat)&&(((K=J.coordinates)==null?void 0:K.lng)||J.lng),V=c===J.id||c==="BATCH"&&!U,B=g.has(J.id);return E.jsxs("div",{onClick:async()=>{if(M(J.id),S(J.day),r){const z=J.location||J.activity;z&&r(z)}if(!U&&!c){if(m(J.id),g.has(J.id)){const z=new Set(g);z.delete(J.id),p(z)}console.log(`[TripMap] Starting geocode for item: ${J.activity}`);try{let z=J.location,Le=null;if(z&&(console.log(`[TripMap] Trying location: ${z}`),Le=await Ic(z,e.apiKey)),Le||(console.log(`[TripMap] Location failed or empty, trying activity: ${J.activity}`),Le=await Ic(J.activity,e.apiKey)),!Le){const Xe=J.activity.split(/[\(]/)[0].split(/|\/|\|/)[0].trim();Xe&&Xe!==J.activity&&(console.log(`[TripMap] Activity failed, trying simplified: ${Xe}`),Le=await Ic(Xe,e.apiKey))}if(console.log("[TripMap] Final geocode result:",Le),Le&&t){const Xe=[...n.itinerary||[]],te=Xe.findIndex(Se=>Se.id===J.id);te!==-1&&(console.log(`[TripMap] Updating item ${te} with coords`,Le),Xe[te]={...Xe[te],coordinates:Le,lat:Le.lat,lng:Le.lng},t({...n,itinerary:Xe}),console.log("[TripMap] onUpdateTrip called"))}else console.warn(`[TripMap] No coords found for item ${J.id}`),p(Xe=>new Set(Xe).add(J.id))}catch(z){console.error("On-demand geocoding failed",z),p(Le=>new Set(Le).add(J.id))}finally{m(null)}}},className:`p-4 rounded-2xl border transition-all cursor-pointer flex items-center gap-4 ${C===J.id?"bg-coral/10 border-coral shadow-md":"bg-white border-sand hover:border-coral/50"}`,children:[E.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold shrink-0 relative",style:{backgroundColor:ee[(J.day-1)%ee.length]},children:V&&!U?E.jsx("div",{className:"absolute inset-0 border-2 border-white border-t-transparent rounded-full animate-spin"}):k+1}),E.jsxs("div",{className:"flex-1 min-w-0",children:[E.jsxs("div",{className:"flex justify-between items-start",children:[E.jsx("h3",{className:"font-bold text-ink truncate",children:J.activity}),E.jsxs("span",{className:"text-xs font-bold text-coral bg-coral/10 px-2 py-0.5 rounded-full whitespace-nowrap",children:["Day ",J.day]})]}),E.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[E.jsx("span",{className:"font-mono bg-gray-100 px-1.5 py-0.5 rounded",children:J.time}),E.jsxs("span",{className:"truncate flex-1",children:[J.location,V&&!U&&E.jsx("span",{className:"text-coral ml-1 text-[10px] animate-pulse",children:"..."}),B&&!U&&!V&&!(i&&(J.location===u||J.activity===u))&&E.jsx("span",{className:"text-red-500 ml-1 text-[10px]",children:""})]})]})]})]},J.id||k)})})]})},h5=({trip:n,onBack:e,onDelete:t,onUpdateTrip:i,onOpenAI:r,settings:u})=>{var dt,an,gi,_i;const c=Wt[u.language]||Wt["zh-TW"],[m,g]=W.useState("ITINERARY"),[p,x]=W.useState(!1),[S,C]=W.useState(!1),[M,F]=W.useState(""),[H,Y]=W.useState(null),[ie,re]=W.useState(!1),ee=async Ie=>{const ut=Ie||M;if(ut.trim()){Ie&&F(Ie),re(!0);try{const Vt=await Ic(ut,u.apiKey);Vt?Y(Vt):(Ie||alert("Location not found"),console.log(`Location not found for: ${ut}`))}catch(Vt){console.error("Map search failed:",Vt)}finally{re(!1)}}},[Ee,pe]=W.useState(!1),[J,k]=W.useState(null),[U,V]=W.useState(""),[B,q]=W.useState(""),[K,z]=W.useState([{name:"",price:""}]),[Le,Xe]=W.useState(((dt=n.budget)==null?void 0:dt.currency)||"TWD"),[te,Se]=W.useState(""),[Ae,We]=W.useState(0),[Ne,j]=W.useState(!1);W.useEffect(()=>{var Ie;Ee&&(Xe(((Ie=n.budget)==null?void 0:Ie.currency)||"TWD"),Se(""))},[Ee,(an=n.budget)==null?void 0:an.currency]),W.useEffect(()=>{(async()=>{var Vt;const ut=((Vt=n.budget)==null?void 0:Vt.currency)||"TWD";if(Le!==ut&&u.apiKey){j(!0);const ln=await Ig(Le,ut);ln&&Se(ln),j(!1)}})()},[Le,(gi=n.budget)==null?void 0:gi.currency,u.apiKey]),W.useEffect(()=>{const Ie=parseFloat(U)||0,ut=parseFloat(te)||1;We(Math.round(Ie*ut))},[U,te]);const[he,be]=W.useState(!1),[ce,me]=W.useState(!1),[Ce,_e]=W.useState(n.title),[Pe,ke]=W.useState(!1),[Je,wt]=W.useState(""),[Ze,Jt]=W.useState(!1),fn=()=>{x(!0)},mi=()=>{t==null||t(n.id)},ei=()=>{Ce.trim()&&Ce!==n.title&&(i==null||i({...n,title:Ce})),me(!1)},pi=async Ie=>{if(Ie==="upload"){const ut=document.createElement("input");ut.type="file",ut.accept="image/*",ut.onchange=Vt=>{var Si,Tn;const ln=(Tn=(Si=Vt.target)==null?void 0:Si.files)==null?void 0:Tn[0];if(ln){const Ot=new FileReader;Ot.onload=()=>{const Dn=Ot.result;i==null||i({...n,coverImage:Dn}),ke(!1)},Ot.readAsDataURL(ln)}},ut.click()}else if(Ie==="url")Je.trim()&&(i==null||i({...n,coverImage:Je}),wt(""),ke(!1));else if(Ie==="ai"){Jt(!0);try{const{generateCoverImage:ut}=await nf(async()=>{const{generateCoverImage:ln}=await Promise.resolve().then(()=>RP);return{generateCoverImage:ln}},void 0),Vt=await ut(n.title);i==null||i({...n,coverImage:Vt}),ke(!1)}catch(ut){console.error("Failed to generate cover:",ut),alert("AI ")}finally{Jt(!1)}}},vn=Ie=>{k(Ie),V(""),q(""),z([{name:"",price:""}]),pe(!0)},jt=()=>{var Qt,Gi,ks;if(!J||!U)return;const Ie=parseFloat(U);if(Ie<=0){alert("Amount must be greater than 0");return}const ut=parseFloat(te)||1,Vt=Math.round(Ie*ut),ln=K.filter(ds=>ds.name&&ds.price).map(ds=>`${ds.name}: ${el(Le)}${ds.price}`).join(", "),Si=B?ln?`${B} (${ln})`:B:ln,Tn={id:Date.now().toString(),title:J.activity,amount:Vt,category:"Shopping",date:n.startDate?new Date(n.startDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],payer:"ME",paymentMethod:"Cash",note:Si,originalCurrency:Le,originalAmount:Ie,exchangeRate:ut},Ot=((Qt=n.budget)==null?void 0:Qt.expenses)||[],Dn={...n,budget:{...n.budget,total:((Gi=n.budget)==null?void 0:Gi.total)||0,currency:((ks=n.budget)==null?void 0:ks.currency)||"TWD",expenses:[Tn,...Ot]}};i==null||i(Dn),pe(!1)},ye=(Ie,ut,Vt)=>{const ln=[...K];if(ln[Ie][ut]=Vt,z(ln),ut==="price"){const Si=ln.reduce((Tn,Ot)=>Tn+(parseInt(Ot.price)||0),0);Si>0&&V(Si.toString())}},qe=()=>{z([...K,{name:"",price:""}])},Qe=((_i=n.budget)==null?void 0:_i.currency)||"TWD",Dt=el(Qe);return E.jsxs("div",{className:"flex flex-col h-full bg-paper animate-fade-in relative",children:[E.jsxs("div",{className:"relative h-64 shrink-0 group",children:[E.jsxs("div",{className:"absolute inset-0 bg-gray-200",children:[n.coverImage?E.jsx("img",{src:n.coverImage,alt:n.title,className:`w-full h-full object-cover transition-opacity duration-700 ${S?"opacity-100":"opacity-0"}`,onLoad:()=>C(!0)}):E.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-coral/20 to-sand/30",children:E.jsx(D0,{className:"w-16 h-16 text-coral/40"})}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"})]}),E.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 pt-safe pt-4 flex justify-between items-start z-10",children:[E.jsx("button",{onClick:e,className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-black/50 transition-colors",children:E.jsx(cs,{className:"w-6 h-6"})}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("button",{onClick:()=>ke(!0),className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-black/50 transition-colors opacity-0 group-hover:opacity-100",children:E.jsx(sr,{className:"w-5 h-5"})}),E.jsx("button",{onClick:()=>r==null?void 0:r(n.id),className:"p-2 bg-white/20 backdrop-blur-md rounded-full text-white hover:bg-white/30 transition-colors",title:"AI Assistant",children:E.jsx(sr,{className:"w-5 h-5"})}),E.jsx("button",{onClick:fn,className:"p-2 bg-black/30 backdrop-blur-md rounded-full text-white hover:bg-red-500/80 transition-colors",children:E.jsx(or,{className:"w-5 h-5"})})]})]}),E.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 text-white z-10",children:[ce?E.jsx("div",{className:"flex items-center gap-2 mb-2",children:E.jsx("input",{value:Ce,onChange:Ie=>_e(Ie.target.value),className:"bg-white/20 backdrop-blur-md text-white text-3xl font-black px-2 py-1 rounded-lg outline-none w-full",autoFocus:!0,onBlur:ei,onKeyDown:Ie=>Ie.key==="Enter"&&ei()})}):E.jsxs("h1",{className:"text-3xl font-black mb-2 leading-tight drop-shadow-md cursor-pointer hover:text-coral/90 transition-colors flex items-center gap-2",onClick:()=>{me(!0),_e(n.title)},children:[n.title,E.jsx(Wx,{className:"w-5 h-5 opacity-50"})]}),E.jsxs("div",{className:"flex items-center gap-3 text-sm font-bold text-gray-200",children:[E.jsxs("span",{className:"bg-white/20 backdrop-blur-md px-2 py-0.5 rounded text-xs",children:[n.days," Days"]}),E.jsxs("span",{children:[n.startDate," - ",n.endDate]})]})]})]}),E.jsx("div",{className:"flex-1 overflow-y-auto bg-paper relative rounded-t-3xl -mt-6 z-20 shadow-[0_-4px_20px_rgba(0,0,0,0.1)]",children:E.jsxs("div",{className:"p-5 min-h-full",children:[m==="ITINERARY"&&E.jsx(VP,{trip:n,settings:u,onUpdateTrip:i,onOpenQuickExpense:vn}),m==="MAP"&&E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"mb-4 flex gap-2",children:[E.jsxs("div",{className:"flex-1 relative",children:[E.jsx("input",{type:"text",value:M,onChange:Ie=>F(Ie.target.value),onKeyDown:Ie=>Ie.key==="Enter"&&ee(),placeholder:c.search_placeholder,className:"w-full pl-10 pr-4 py-2 rounded-full border border-sand focus:border-coral focus:ring-1 focus:ring-coral outline-none text-sm"}),E.jsx(eb,{className:"w-4 h-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2"})]}),E.jsx("button",{onClick:()=>ee(),disabled:ie||!M.trim(),className:"bg-ink text-white px-4 py-2 rounded-full text-sm font-bold disabled:opacity-50 flex items-center gap-1",children:ie?E.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):c.search_location})]}),E.jsx(d5,{trip:n,settings:u,searchedLocation:H,onItemClick:Ie=>ee(Ie),mapSearchQuery:M})]}),m==="BUDGET"&&E.jsx(UP,{trip:n,settings:u,onUpdateTrip:i}),m==="BOOKINGS"&&E.jsx(zP,{trip:n,settings:u,onUpdateTrip:i}),m==="SHOPPING"&&E.jsx(LP,{items:n.shoppingList||[],onUpdateItems:Ie=>i==null?void 0:i({...n,shoppingList:Ie}),settings:u})]})}),E.jsx("div",{className:"absolute bottom-6 left-6 right-6 bg-white/90 backdrop-blur-xl rounded-full shadow-2xl border border-white/50 p-1.5 flex justify-between items-center z-30",children:[{id:"ITINERARY",icon:Yx,label:c.itinerary},{id:"MAP",icon:D0,label:c.map},{id:"BUDGET",icon:jx,label:c.budget},{id:"BOOKINGS",icon:Kx,label:c.bookings},{id:"SHOPPING",icon:Jx,label:c.shopping}].map(Ie=>E.jsxs("button",{onClick:()=>g(Ie.id),className:`flex-1 flex flex-col items-center justify-center py-2 rounded-full transition-all duration-300 ${m===Ie.id?"bg-ink text-white shadow-lg scale-105":"text-gray-400 hover:text-ink hover:bg-gray-100"}`,children:[E.jsx(Ie.icon,{className:`w-5 h-5 ${m===Ie.id?"stroke-2":"stroke-[1.5]"}`}),m===Ie.id&&E.jsx("span",{className:"text-[10px] font-bold mt-0.5",children:Ie.label})]},Ie.id))}),p&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",children:E.jsxs("div",{className:"bg-white rounded-3xl p-6 w-full max-w-xs shadow-2xl animate-scale-in text-center",children:[E.jsx("div",{className:"w-16 h-16 bg-red-100 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:E.jsx(or,{className:"w-8 h-8"})}),E.jsx("h3",{className:"text-xl font-bold text-ink mb-2",children:c.delete_trip}),E.jsx("p",{className:"text-gray-500 mb-6",children:c.delete_trip_confirm.replace("{title}",n.title)}),E.jsxs("div",{className:"flex gap-3",children:[E.jsx("button",{onClick:()=>x(!1),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:c.cancel}),E.jsx("button",{onClick:mi,className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 shadow-lg shadow-red-500/30 transition-colors",children:c.delete})]})]})}),Pe&&E.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>ke(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:Ie=>Ie.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-ink mb-6 text-center",children:""}),E.jsxs("div",{className:"space-y-3",children:[E.jsxs("button",{onClick:()=>pi("upload"),className:"w-full py-4 bg-white border border-sand rounded-xl font-bold text-ink hover:bg-gray-50 flex items-center justify-center gap-2",children:[E.jsx("span",{children:""})," "]}),E.jsx("button",{onClick:()=>pi("ai"),disabled:Ze,className:"w-full py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-xl font-bold shadow-lg flex items-center justify-center gap-2",children:Ze?E.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):E.jsxs(E.Fragment,{children:[E.jsx("span",{children:""})," AI "]})}),E.jsxs("div",{className:"relative",children:[E.jsx("div",{className:"absolute inset-0 flex items-center",children:E.jsx("div",{className:"w-full border-t border-sand"})}),E.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:E.jsx("span",{className:"bg-paper px-2 text-gray-400",children:"OR"})})]}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("input",{value:Je,onChange:Ie=>wt(Ie.target.value),placeholder:"...",className:"flex-1 bg-white p-3 rounded-xl border border-sand outline-none"}),E.jsx("button",{onClick:()=>pi("url"),disabled:!Je,className:"bg-ink text-white px-4 rounded-xl font-bold disabled:opacity-50",children:"OK"})]})]})]})}),Ee&&E.jsx("div",{className:"fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-fade-in",onClick:()=>pe(!1),children:E.jsxs("div",{className:"bg-paper w-full max-w-sm rounded-3xl shadow-2xl p-6 animate-slide-up",onClick:Ie=>Ie.stopPropagation(),children:[E.jsx("h3",{className:"text-xl font-bold text-ink mb-2 text-center",children:""}),E.jsx("p",{className:"text-center text-gray-400 text-sm mb-6",children:J==null?void 0:J.activity}),E.jsxs("div",{className:"space-y-4",children:[K.map((Ie,ut)=>E.jsxs("div",{className:"flex gap-2",children:[E.jsx("input",{value:Ie.name,onChange:Vt=>ye(ut,"name",Vt.target.value),placeholder:" (: )",className:"flex-1 bg-white p-3 rounded-xl font-bold border-none shadow-sm outline-none",autoFocus:ut===0}),E.jsx("input",{type:"number",value:Ie.price,onChange:Vt=>ye(ut,"price",Vt.target.value),placeholder:el(Le),className:"w-24 bg-white p-3 rounded-xl font-bold border-none shadow-sm outline-none text-center",onFocus:Vt=>Vt.target.select()})]},ut)),E.jsx("button",{onClick:qe,className:"text-xs font-bold text-coral flex items-center gap-1 mx-auto hover:bg-coral/10 px-3 py-1 rounded-lg transition-colors",children:"+ "}),E.jsxs("div",{className:"pt-4 border-t border-sand",children:[E.jsxs("div",{className:"flex justify-between items-center mb-4",children:[E.jsx("div",{className:"flex items-center gap-2",children:E.jsx("select",{value:Le,onChange:Ie=>Xe(Ie.target.value),className:"bg-transparent font-bold text-gray-400 outline-none text-sm",children:Ng.map(Ie=>E.jsx("option",{value:Ie.code,children:Ie.code},Ie.code))})}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"font-bold text-ink text-2xl",children:el(Le)}),E.jsx("input",{type:"number",value:U,onChange:Ie=>V(Ie.target.value),className:"w-32 bg-transparent text-right text-3xl font-black border-none outline-none p-0",placeholder:"0",onFocus:Ie=>Ie.target.select()})]})]}),Le!==Qe&&E.jsxs("div",{className:"mb-4 bg-sand/30 p-3 rounded-xl",children:[E.jsxs("div",{className:"flex justify-between items-center mb-2",children:[E.jsxs("label",{className:"text-xs font-bold text-gray-500",children:[" (",Le,"  ",Qe,")"]}),E.jsxs("span",{className:"text-xs font-bold text-coral",children:[" ",Dt,Ae.toLocaleString()]})]}),E.jsxs("div",{className:"relative",children:[E.jsx("input",{value:te,onChange:Ie=>Se(Ie.target.value),type:"number",step:"0.01",placeholder:Ne?"...":"Exchange Rate",className:"w-full bg-white p-3 rounded-xl text-sm font-bold border-none shadow-sm outline-none",onFocus:Ie=>Ie.target.select(),disabled:Ne}),Ne&&E.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:E.jsx("div",{className:"w-4 h-4 border-2 border-coral border-t-transparent rounded-full animate-spin"})})]}),!u.apiKey&&E.jsx("p",{className:"text-[10px] text-red-400 mt-1",children:"*  API Key "})]}),E.jsx("textarea",{value:B,onChange:Ie=>q(Ie.target.value),placeholder:"...",className:"w-full bg-white p-3 rounded-xl text-sm font-medium border-none shadow-sm outline-none min-h-[60px]"})]}),E.jsx("button",{onClick:jt,disabled:!U,className:"w-full bg-ink text-white py-4 rounded-xl font-bold text-lg shadow-lg shadow-ink/30 mt-2 active:scale-95 transition-all disabled:opacity-50 disabled:shadow-none",children:""})]})]})})]})},f5=({onStartGeneration:n,onCancel:e,settings:t,sessions:i,currentSessionId:r,onCreateSession:u,onUpdateSession:c,onDeleteSession:m,onSelectSession:g})=>{const p=Wt[t.language]||Wt["zh-TW"],[x,S]=W.useState(""),[C,M]=W.useState(!1),[F,H]=W.useState(!1),Y=W.useRef(null),ie=i.find(J=>J.id===r),re=(ie==null?void 0:ie.messages)||[],ee=()=>{var J;(J=Y.current)==null||J.scrollIntoView({behavior:"smooth"})};W.useEffect(ee,[re]),W.useEffect(()=>{r&&re.length===0?c(r,[{role:"ai",content:p.ai_planner_intro,timestamp:Date.now()}]):!r&&i.length===0?u():!r&&i.length>0&&g(i[0].id)},[r,i.length]);const Ee=()=>{u(),H(!1)},pe=async()=>{if(!x.trim()||!r)return;const J={role:"user",content:x,timestamp:Date.now()},k=[...re,J];c(r,k),S(""),M(!0);const U={role:"ai",content:p.ai_planning,timestamp:Date.now()};c(r,[...k,U]),n(x,ie==null?void 0:ie.tripId).then(V=>{const B={role:"ai",content:p.ai_done,timestamp:Date.now()};V?c(r,[...k,B],V.title,V.tripId):c(r,[...k,B]),M(!1)})};return E.jsxs("div",{className:"flex h-full bg-paper pt-safe relative overflow-hidden",children:[F&&E.jsx("div",{className:"absolute inset-0 bg-black/20 z-20 backdrop-blur-sm",onClick:()=>H(!1)}),E.jsxs("div",{className:`absolute top-0 left-0 bottom-0 w-64 bg-white shadow-2xl z-30 transform transition-transform duration-300 ease-in-out ${F?"translate-x-0":"-translate-x-full"}`,children:[E.jsxs("div",{className:"p-4 border-b border-sand flex justify-between items-center pt-12",children:[E.jsx("h3",{className:"font-bold text-lg text-ink",children:t.language==="zh-TW"?"":"Chat History"}),E.jsx("button",{onClick:Ee,className:"p-2 bg-coral/10 rounded-full text-coral hover:bg-coral/20",children:E.jsx(yg,{className:"w-5 h-5"})})]}),E.jsxs("div",{className:"overflow-y-auto h-full pb-20",children:[i.map(J=>E.jsxs("div",{onClick:()=>{g(J.id),H(!1)},className:`p-4 border-b border-sand/50 cursor-pointer hover:bg-sand/30 transition-colors ${r===J.id?"bg-sand/50 border-l-4 border-l-coral":""}`,children:[E.jsx("div",{className:"font-medium text-ink truncate",children:J.title}),E.jsx("div",{className:"text-xs text-gray-400 mt-1",children:new Date(J.updatedAt).toLocaleDateString()})]},J.id)),i.length===0&&E.jsx("div",{className:"p-8 text-center text-gray-400 text-sm",children:t.language==="zh-TW"?"":"No chat history"})]})]}),E.jsxs("div",{className:"flex-1 flex flex-col h-full w-full",children:[E.jsxs("div",{className:"px-4 py-3 border-b border-sand/50 flex items-center justify-between bg-paper sticky top-0 z-10 pt-safe pt-4",children:[E.jsxs("div",{className:"flex items-center",children:[E.jsx("button",{onClick:e,className:"p-2 -ml-2 rounded-full hover:bg-white text-gray-500 transition-colors",children:E.jsx(cs,{className:"w-6 h-6"})}),E.jsx("button",{onClick:()=>H(!0),className:"ml-2 p-2 rounded-full hover:bg-white text-gray-500 transition-colors",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})})}),E.jsxs("h2",{className:"text-lg font-bold text-ink ml-2 flex items-center gap-2 truncate max-w-[150px]",children:[E.jsx(Zx,{className:"w-5 h-5 text-coral"}),(ie==null?void 0:ie.title)||p.ai_planner_title]})]}),E.jsx("button",{onClick:Ee,className:"text-xs font-bold text-coral border border-coral/30 px-3 py-1.5 rounded-full hover:bg-coral/10 transition-colors",children:t.language==="zh-TW"?"":"New Chat"})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 pb-24",children:[re.map((J,k)=>E.jsx("div",{className:`flex ${J.role==="user"?"justify-end":"justify-start"} animate-slide-up`,children:E.jsx("div",{className:`max-w-[85%] p-4 rounded-2xl text-sm font-medium leading-relaxed shadow-sm whitespace-pre-line ${J.role==="user"?"bg-coral text-white rounded-tr-none":"bg-white text-ink border border-sand rounded-tl-none"}`,children:J.content})},k)),C&&E.jsx("div",{className:"flex justify-start",children:E.jsxs("div",{className:"bg-white p-4 rounded-2xl rounded-tl-none border border-sand flex items-center gap-2",children:[E.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce"}),E.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce delay-100"}),E.jsx("div",{className:"w-2 h-2 bg-coral rounded-full animate-bounce delay-200"}),E.jsx("span",{className:"text-xs text-gray-400 font-bold ml-1",children:p.planning_process})]})}),E.jsx("div",{ref:Y})]}),E.jsxs("div",{className:"p-4 bg-white/90 backdrop-blur border-t border-sand pb-32",children:[E.jsxs("div",{className:"flex gap-2",children:[E.jsx("textarea",{value:x,onChange:J=>S(J.target.value),onKeyDown:J=>{J.key==="Enter"&&!J.shiftKey&&(J.preventDefault(),pe())},placeholder:p.input_placeholder,className:"flex-1 bg-paper rounded-2xl px-5 py-3.5 outline-none focus:ring-2 focus:ring-coral/50 transition-all font-medium text-ink placeholder:text-gray-400 border border-sand resize-none min-h-[50px] max-h-[120px]",disabled:C,rows:1}),E.jsx("button",{onClick:pe,disabled:!x.trim()||C,className:"bg-coral text-white p-3.5 rounded-2xl disabled:opacity-50 active:scale-95 transition-transform shadow-lg shadow-coral/20",children:E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-5 h-5",children:E.jsx("path",{d:"M3.105 2.289a.75.75 0 0 0-.826.95l1.414 4.925A1.5 1.5 0 0 0 5.135 9.25h6.115a.75.75 0 0 1 0 1.5H5.135a1.5 1.5 0 0 0-1.442 1.086l-1.414 4.926a.75.75 0 0 0 .826.95 28.896 28.896 0 0 0 15.293-7.154.75.75 0 0 0 0-1.115A28.897 28.897 0 0 0 3.105 2.289Z"})})})]}),E.jsx("div",{className:"flex gap-2 mt-3 overflow-x-auto no-scrollbar pb-2",children:[p.prompt_tokyo,p.prompt_bangkok,p.prompt_paris].map(J=>E.jsx("button",{onClick:()=>S(J),className:"whitespace-nowrap px-4 py-2 bg-white text-gray-500 text-xs font-bold rounded-xl border border-sand hover:text-coral hover:border-coral transition-colors",disabled:C,children:J},J))})]})]})]})},m5="https://api.exchangerate-api.com/v4/latest/TWD";let Ec=null,cE=0;const p5=1440*60*1e3,g5=async()=>{const n=Date.now();if(Ec&&n-cE<p5)return Ec;try{const t=await(await fetch(m5)).json();return Ec=t,cE=n,t}catch(e){return console.error("Failed to fetch exchange rates:",e),Ec||{base:"TWD",rates:{TWD:1,JPY:.22,KRW:.043,USD:31.5,EUR:34.2}}}},_5=async(n,e)=>{if(e==="TWD")return n;const i=(await g5()).rates[e];return i?n/i:(console.warn(`Unknown currency: ${e}`),n)},y5=(n,e="TWD")=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:e==="TWD"?"TWD":e,minimumFractionDigits:0,maximumFractionDigits:0}).format(n),jw=()=>"webkitSpeechRecognition"in window||"SpeechRecognition"in window,Dg=()=>"speechSynthesis"in window,v5=(n="zh-TW",e,t)=>{if(!jw())return t==null||t(""),null;const i=window.webkitSpeechRecognition||window.SpeechRecognition,r=new i;return r.continuous=!1,r.interimResults=!1,r.lang=n,r.onresult=u=>{const c=u.results[0][0].transcript;e(c)},r.onerror=u=>{t==null||t(u.error)},r.start(),r},Kw=(n,e="zh-TW",t)=>{if(!Dg()){console.error("");return}window.speechSynthesis.cancel();const i=new SpeechSynthesisUtterance(n);i.lang=e,i.rate=1,i.pitch=1,i.volume=1,t&&(i.onend=t),window.speechSynthesis.speak(i)},T5=()=>{Dg()&&window.speechSynthesis.cancel()},E5=async(n,e,t,i,r)=>new Promise((u,c)=>{v5(n,async g=>{t==null||t(g);try{const p=await Dw(g,e,n);p?(i==null||i(p),Kw(p,e,()=>{u()})):(r==null||r(""),c("Translation failed"))}catch(p){r==null||r(p),c(p)}},g=>{r==null||r(g),c(g)})||c("Speech recognition not supported")}),lh={recognition:jw(),synthesis:Dg()};function x5({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 21 3 16.5m0 0L7.5 12M3 16.5h13.5m0-13.5L21 7.5m0 0L16.5 12M21 7.5H7.5"}))}const w5=W.forwardRef(x5);function S5({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 0 0 6-6v-1.5m-6 7.5a6 6 0 0 1-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 0 1-3-3V4.5a3 3 0 1 1 6 0v8.25a3 3 0 0 1-3 3Z"}))}const A5=W.forwardRef(S5);function C5({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))}const dE=W.forwardRef(C5);function b5({title:n,titleId:e,...t},i){return W.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":e},t),n?W.createElement("title",{id:e},n):null,W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),W.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9.563C9 9.252 9.252 9 9.563 9h4.874c.311 0 .563.252.563.563v4.874c0 .311-.252.563-.563.563H9.564A.562.562 0 0 1 9 14.437V9.564Z"}))}const I5=W.forwardRef(b5),N5=({defaultSourceLang:n="zh-TW",defaultTargetLang:e="en-US"})=>{const[t,i]=W.useState(n),[r,u]=W.useState(e),[c,m]=W.useState(""),[g,p]=W.useState(""),[x,S]=W.useState(!1),[C,M]=W.useState(!1),[F,H]=W.useState(""),Y=[{code:"zh-TW",name:""},{code:"en-US",name:"English"},{code:"ja-JP",name:""},{code:"ko-KR",name:""},{code:"th-TH",name:""}],ie=async()=>{if(!lh.recognition){H("");return}H(""),S(!0),m(""),p("");try{await E5(t,r,pe=>{m(pe)},pe=>{p(pe),M(!0)},pe=>{H(`${pe}`)})}catch(pe){console.error(pe)}finally{S(!1),M(!1)}},re=()=>{i(r),u(t),m(""),p("")},ee=(pe,J)=>{if(!lh.synthesis){H("");return}Kw(pe,J)},Ee=()=>{T5(),M(!1)};return E.jsxs("div",{className:"max-w-4xl mx-auto p-6 pt-12 bg-paper rounded-3xl shadow-float",children:[E.jsx("h2",{className:"text-2xl font-bold text-ink mb-6 text-center",children:" "}),E.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[E.jsx("select",{value:t,onChange:pe=>i(pe.target.value),className:"flex-1 p-3 rounded-xl border-2 border-sand bg-white text-ink font-medium focus:border-coral outline-none",children:Y.map(pe=>E.jsx("option",{value:pe.code,children:pe.name},pe.code))}),E.jsx("button",{onClick:re,className:"p-3 rounded-full bg-coral text-white hover:bg-coralDark active:scale-95 transition-all",children:E.jsx(w5,{className:"w-5 h-5"})}),E.jsx("select",{value:r,onChange:pe=>u(pe.target.value),className:"flex-1 p-3 rounded-xl border-2 border-sand bg-white text-ink font-medium focus:border-coral outline-none",children:Y.map(pe=>E.jsx("option",{value:pe.code,children:pe.name},pe.code))})]}),E.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[E.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-sand min-h-[120px] flex flex-col",children:[E.jsxs("div",{className:"flex items-center justify-between mb-2",children:[E.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:" ()"}),c&&E.jsx("button",{onClick:()=>ee(c,t),className:"p-1 text-coral hover:text-coralDark",children:E.jsx(dE,{className:"w-4 h-4"})})]}),E.jsx("textarea",{value:c,onChange:pe=>m(pe.target.value),placeholder:"...",className:"w-full flex-1 resize-none outline-none text-ink bg-transparent placeholder:text-gray-300"})]}),E.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-sand min-h-[120px]",children:[E.jsxs("div",{className:"flex items-center justify-between mb-2",children:[E.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),g&&E.jsx("button",{onClick:()=>ee(g,r),className:"p-1 text-coral hover:text-coralDark",children:E.jsx(dE,{className:"w-4 h-4"})})]}),E.jsx("p",{className:"text-ink whitespace-pre-wrap",children:g||"..."})]})]}),F&&E.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm",children:F}),E.jsxs("div",{className:"flex gap-3",children:[E.jsxs("button",{onClick:ie,disabled:x||C,className:`flex-1 py-4 rounded-2xl font-bold text-lg flex items-center justify-center gap-2 transition-all ${x?"bg-red-500 text-white animate-pulse":"bg-coral text-white hover:bg-coralDark active:scale-95"}`,children:[E.jsx(A5,{className:"w-6 h-6"}),x?"...":""]}),(x||C)&&E.jsxs("button",{onClick:Ee,className:"px-6 py-4 rounded-2xl font-bold bg-gray-500 text-white hover:bg-gray-600 active:scale-95 transition-all flex items-center gap-2",children:[E.jsx(I5,{className:"w-6 h-6"}),""]})]}),(!lh.recognition||!lh.synthesis)&&E.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-xl text-yellow-800 text-sm",children:"  ChromeEdge  Safari "})]})},R5=({onBack:n})=>E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(cs,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:""})]}),E.jsx("div",{className:"p-5 flex items-center justify-center h-full text-gray-400 text-center font-medium",children:E.jsx("p",{children:""})})]}),M5=({onBack:n,t:e,language:t})=>{const[i,r]=W.useState("Taiwan (ROC)"),[u,c]=W.useState(""),[m,g]=W.useState(null),[p,x]=W.useState(!1),S=async()=>{if(u){x(!0);try{const C=await Iw(i,u,t);g(C||"")}catch{g("")}finally{x(!1)}}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(cs,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_visa})]}),E.jsxs("div",{className:"p-5 space-y-4 overflow-y-auto flex-1 pb-32",children:[E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card space-y-5 border border-sand",children:[E.jsxs("div",{children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),E.jsxs("select",{value:i,onChange:C=>r(C.target.value),className:"w-full mt-2 p-3 bg-paper rounded-xl text-ink font-medium border-none outline-none",children:[E.jsx("option",{value:"Taiwan (ROC)",children:" (Taiwan)"}),E.jsx("option",{value:"Japan",children:" (Japan)"}),E.jsx("option",{value:"USA",children:" (USA)"}),E.jsx("option",{value:"Hong Kong",children:" (Hong Kong)"})]})]}),E.jsxs("div",{children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),E.jsx("input",{value:u,onChange:C=>c(C.target.value),placeholder:"...",className:"w-full mt-2 p-3 bg-paper rounded-xl text-ink font-medium border-none outline-none"})]}),E.jsx("button",{onClick:S,disabled:p||!u,className:"w-full bg-coral text-white py-3.5 rounded-xl font-bold shadow-lg shadow-coral/30 disabled:opacity-50",children:p?e.loading:e.confirm})]}),m&&E.jsx("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand animate-fade-in",children:E.jsx("div",{className:"prose prose-sm max-w-none text-ink leading-relaxed whitespace-pre-line",children:m})})]})]})},P5=({onBack:n,t:e,language:t})=>{const[i,r]=W.useState(""),[u,c]=W.useState(null),[m,g]=W.useState(!1),p=async()=>{g(!0);try{const S=await Nw(i||"Kyoto, Japan",t);c(S||"")}catch{c("")}finally{g(!1)}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(cs,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_culture})]}),E.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[E.jsx("div",{className:"mb-4",children:E.jsx("input",{value:i,onChange:x=>r(x.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl shadow-sm border border-sand font-medium text-ink outline-none"})}),E.jsx("button",{onClick:p,disabled:m,className:"w-full bg-orange-400 text-white px-4 py-3.5 rounded-2xl font-bold text-sm shadow-md mb-6",children:m?e.loading:e.confirm}),u&&E.jsx("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand animate-fade-in",children:E.jsx("div",{className:"prose prose-sm text-ink whitespace-pre-line leading-relaxed",children:u})})]})]})},k5=({onBack:n,t:e})=>E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(cs,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_restroom})]}),E.jsx("div",{className:"flex-1 relative rounded-t-3xl overflow-hidden shadow-inner border-t border-sand",children:E.jsx("iframe",{width:"100%",height:"100%",style:{border:0},loading:"lazy",allowFullScreen:!0,src:"https://maps.google.com/maps?q=public+restroom&output=embed"})})]}),D5=({onBack:n,t:e,language:t,onOpenSettings:i})=>{const[r,u]=W.useState(""),[c,m]=W.useState(null),[g,p]=W.useState(!1),x=async()=>{if(r){p(!0);try{const C=await Mw(r,t);m(C)}catch{m("")}finally{p(!1)}}},S=c&&(c.includes("API Key")||c.includes("403"));return E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(cs,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_emergency})]}),E.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[E.jsxs("div",{className:"bg-red-500 text-white p-6 rounded-3xl shadow-lg shadow-red-500/20 mb-6",children:[E.jsx("h2",{className:"text-xl font-bold mb-2",children:"SOS?"}),E.jsxs("p",{className:"opacity-90 text-sm",children:[": ",E.jsx("span",{className:"font-black text-2xl ml-1",children:"112"})]})]}),E.jsxs("div",{className:"space-y-3",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:""}),E.jsx("input",{value:r,onChange:C=>u(C.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl border border-sand shadow-sm outline-none"}),E.jsx("button",{onClick:x,disabled:g||!r,className:"w-full py-3.5 bg-ink text-white rounded-2xl font-bold shadow-lg",children:g?e.loading:e.confirm})]}),c&&E.jsxs("div",{className:`mt-6 p-6 rounded-3xl shadow-card border whitespace-pre-line leading-relaxed ${S?"bg-red-50 border-red-200 text-red-600":"bg-white border-sand text-ink"}`,children:[c,S&&E.jsx("button",{onClick:i,className:"mt-4 w-full py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg shadow-red-500/20 hover:bg-red-600 transition-colors",children:" API Key"})]})]})]})},L5=({onBack:n,t:e,language:t})=>{const[i,r]=W.useState(""),[u,c]=W.useState(null),[m,g]=W.useState(!1),p=async()=>{if(i){g(!0);try{const x=await Pw(i,t);c(x)}catch{c("")}finally{g(!1)}}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(cs,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_card})]}),E.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[E.jsxs("div",{className:"space-y-3",children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase ml-1",children:""}),E.jsx("input",{value:i,onChange:x=>r(x.target.value),placeholder:" ()...",className:"w-full p-4 bg-white rounded-2xl border border-sand shadow-sm outline-none"}),E.jsx("button",{onClick:p,disabled:m||!i,className:"w-full py-3.5 bg-indigo-500 text-white rounded-2xl font-bold shadow-lg shadow-indigo-200",children:m?e.loading:e.confirm})]}),u&&E.jsx("div",{className:"mt-6 bg-white p-6 rounded-3xl shadow-card border border-sand whitespace-pre-line leading-relaxed text-ink",children:u})]})]})};let V5=hl.icon({iconUrl:Hw,shadowUrl:Gw,iconSize:[25,41],iconAnchor:[12,41]});hl.Marker.prototype.options.icon=V5;const hE={Japan:[36.2048,138.2529],Taiwan:[23.6978,120.9605],Thailand:[15.87,100.9925],USA:[37.0902,-95.7129],France:[46.2276,2.2137],"South Korea":[35.9078,127.7669],Vietnam:[14.0583,108.2772],China:[35.8617,104.1954],Germany:[51.1657,10.4515],Italy:[41.8719,12.5674],UK:[55.3781,-3.436],Spain:[40.4637,-3.7492],Australia:[-25.2744,133.7751],Canada:[56.1304,-106.3468],Singapore:[1.3521,103.8198],Malaysia:[4.2105,101.9758],Philippines:[12.8797,121.774],Indonesia:[-.7893,113.9213],India:[20.5937,78.9629],Russia:[61.524,105.3188],Brazil:[-14.235,-51.9253],Mexico:[23.6345,-102.5528],Egypt:[26.8206,30.8025],Turkey:[38.9637,35.2433],Netherlands:[52.1326,5.2913],Switzerland:[46.8182,8.2275],Austria:[47.5162,14.5501],Belgium:[50.5039,4.4699],Sweden:[60.1282,18.6435],Norway:[60.472,8.4689],Denmark:[56.2639,9.5018],Finland:[61.9241,25.7482],"New Zealand":[-40.9006,174.886],"Hong Kong":[22.3193,114.1694],Macau:[22.1987,113.5439]},O5=({onReady:n})=>{const e=lf();return W.useEffect(()=>{const t=setTimeout(()=>{e.invalidateSize(),n()},250);return()=>clearTimeout(t)},[e,n]),null},U5=({onBack:n,trips:e,t})=>{const[i,r]=W.useState(new Set(["Japan","Thailand","Taiwan"])),[u,c]=W.useState(""),[m,g]=W.useState(!1);W.useEffect(()=>{if(e){const S=new Set(i);e.forEach(C=>{(C.title.includes("")||C.title.includes("Japan")||C.title.includes("")||C.title.includes("")||C.title.includes("Tokyo"))&&S.add("Japan"),(C.title.includes("")||C.title.includes("Thailand")||C.title.includes(""))&&S.add("Thailand"),(C.title.includes("")||C.title.includes("Taiwan")||C.title.includes(""))&&S.add("Taiwan"),(C.title.includes("")||C.title.includes("USA"))&&S.add("USA"),(C.title.includes("")||C.title.includes("France")||C.title.includes("Paris"))&&S.add("France"),(C.title.includes("")||C.title.includes("Korea")||C.title.includes(""))&&S.add("South Korea"),(C.title.includes("")||C.title.includes("Vietnam"))&&S.add("Vietnam"),(C.title.includes("")||C.title.includes("China")||C.title.includes("")||C.title.includes(""))&&S.add("China"),(C.title.includes("")||C.title.includes("Hong Kong"))&&S.add("Hong Kong")}),r(S)}},[e]);const p=()=>{if(u.trim()){const S=u.trim(),C=Object.keys(hE).find(M=>M.toLowerCase()===S.toLowerCase());r(C?M=>new Set(M).add(C):M=>new Set(M).add(S)),c("")}},x=S=>{const C=new Set(i);C.delete(S),r(C)};return E.jsxs("div",{className:"flex flex-col h-full bg-[#111827] text-white",children:[E.jsx("div",{className:"bg-[#111827] p-4 flex items-center justify-between sticky top-0 z-10 border-b border-gray-800",children:E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("button",{onClick:n,children:E.jsx(cs,{className:"w-6 h-6 text-gray-300"})}),E.jsx("h3",{className:"font-bold text-lg",children:t.tool_map})]})}),E.jsxs("div",{className:"p-6 flex-1 overflow-y-auto pb-32",children:[E.jsxs("div",{className:"relative w-full aspect-[1.6] bg-[#1F2937] rounded-3xl overflow-hidden mb-8 shadow-2xl border border-gray-700",children:[E.jsxs(Fw,{center:[20,0],zoom:2,style:{height:"100%",width:"100%",background:"#1F2937"},zoomControl:!1,attributionControl:!1,children:[E.jsx(qw,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors  <a href="https://carto.com/attributions">CARTO</a>'}),E.jsx(O5,{onReady:()=>g(!0)}),Array.from(i).map(S=>{const C=hE[S];return C?E.jsx(Pg,{position:C,icon:hl.divIcon({className:"custom-div-icon",html:'<div style="background-color: #FF6B6B; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 10px #FF6B6B;"></div>',iconSize:[12,12],iconAnchor:[6,6]}),children:E.jsx(kg,{children:E.jsx("div",{className:"text-ink font-bold",children:S})})},S):null})]}),E.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center pointer-events-none",children:E.jsx("div",{className:"inline-block bg-black/50 backdrop-blur-sm px-3 py-1 rounded-full text-xs text-gray-400 font-mono tracking-widest border border-white/10",children:"[  ]"})})]}),E.jsxs("div",{className:"bg-[#1F2937] rounded-3xl p-6 shadow-lg border border-gray-700 mb-6",children:[E.jsxs("div",{className:"flex justify-between items-center mb-5",children:[E.jsxs("h4",{className:"font-bold text-gray-200",children:[" (",i.size,")"]}),E.jsxs("div",{className:"flex gap-2",children:[E.jsx("input",{value:u,onChange:S=>c(S.target.value),placeholder:" ()...",className:"bg-gray-800 border border-gray-600 rounded-lg px-3 py-1.5 text-sm text-white focus:outline-none focus:border-coral w-36 placeholder-gray-500"}),E.jsx("button",{onClick:p,className:"bg-coral p-1.5 rounded-lg text-white hover:bg-coralDark",children:E.jsx(Qh,{className:"w-4 h-4"})})]})]}),E.jsx("div",{className:"flex flex-wrap gap-3",children:Array.from(i).map(S=>E.jsxs("div",{className:"group relative px-4 py-2 bg-coral/10 text-coral rounded-xl text-sm font-bold border border-coral/20 flex items-center gap-2",children:[S," ",E.jsx("button",{onClick:()=>x(S),className:"opacity-0 group-hover:opacity-100 absolute -top-2 -right-2 bg-white text-coral rounded-full p-0.5 transition-opacity",children:E.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:E.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},S))})]})]})]})},z5=({onBack:n,t:e})=>{const[t,i]=W.useState(""),[r,u]=W.useState("USD"),[c,m]=W.useState(null),[g,p]=W.useState(!1),x=[{code:"USD",name:" (USD)"},{code:"JPY",name:" (JPY)"},{code:"KRW",name:" (KRW)"},{code:"EUR",name:" (EUR)"},{code:"CNY",name:" (CNY)"},{code:"THB",name:" (THB)"},{code:"VND",name:" (VND)"}],S=async()=>{if(t){p(!0);try{const C=parseFloat(t),M=await _5(C,r);m(y5(M))}catch{m("")}finally{p(!1)}}};return E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(cs,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:""})]}),E.jsxs("div",{className:"p-5 flex-1 overflow-y-auto pb-32",children:[E.jsxs("div",{className:"bg-white p-6 rounded-3xl shadow-card border border-sand space-y-5",children:[E.jsxs("div",{children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),E.jsx("input",{type:"number",value:t,onChange:C=>i(C.target.value),placeholder:"...",className:"w-full mt-2 p-4 bg-paper rounded-2xl text-xl font-bold text-ink border-none outline-none"})]}),E.jsxs("div",{children:[E.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:""}),E.jsx("select",{value:r,onChange:C=>u(C.target.value),className:"w-full mt-2 p-4 bg-paper rounded-2xl text-ink font-medium border-none outline-none",children:x.map(C=>E.jsx("option",{value:C.code,children:C.name},C.code))})]}),E.jsx("button",{onClick:S,disabled:g||!t,className:"w-full bg-green-500 text-white py-4 rounded-2xl font-bold shadow-lg shadow-green-500/30 disabled:opacity-50 active:scale-95 transition-all",children:g?"...":" (TWD)"})]}),c&&E.jsxs("div",{className:"mt-6 bg-white p-6 rounded-3xl shadow-card border border-sand text-center animate-fade-in",children:[E.jsx("p",{className:"text-gray-400 text-sm font-medium mb-1",children:""}),E.jsx("p",{className:"text-3xl font-black text-ink",children:c})]})]})]})},B5=({onBack:n,t:e,language:t})=>E.jsxs("div",{className:"flex flex-col h-full bg-paper",children:[E.jsxs("div",{className:"bg-paper p-4 flex items-center gap-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:n,children:E.jsx(cs,{className:"w-6 h-6 text-gray-500"})}),E.jsx("h3",{className:"font-bold text-lg text-ink",children:e.tool_translation||"Translation"})]}),E.jsx("div",{className:"flex-1 overflow-y-auto pb-32",children:E.jsx(N5,{defaultSourceLang:t})})]}),F5=({onBack:n,trips:e,settings:t,onMagicEditor:i,onOpenSettings:r})=>{const[u,c]=W.useState("MENU"),m=Wt[t.language]||Wt["zh-TW"];if(u==="EXPENSE")return E.jsx(R5,{onBack:()=>c("MENU")});if(u==="VISA")return E.jsx(M5,{onBack:()=>c("MENU"),t:m,language:t.language});if(u==="CULTURE")return E.jsx(P5,{onBack:()=>c("MENU"),t:m,language:t.language});if(u==="RESTROOM")return E.jsx(k5,{onBack:()=>c("MENU"),t:m});if(u==="SCRATCH_MAP")return E.jsx(U5,{onBack:()=>c("MENU"),trips:e,t:m});if(u==="EMERGENCY")return E.jsx(D5,{onBack:()=>c("MENU"),t:m,language:t.language,onOpenSettings:r});if(u==="CARD_ADVICE")return E.jsx(L5,{onBack:()=>c("MENU"),t:m,language:t.language});if(u==="TIME_CAPSULE")return E.jsx("div",{onClick:()=>c("MENU"),children:"Coming Soon"});if(u==="TRANSLATION")return E.jsx(B5,{onBack:()=>c("MENU"),t:m,language:t.language});if(u==="CURRENCY")return E.jsx(z5,{onBack:()=>c("MENU"),t:m});const g=[{id:"MAGIC_EDITOR",name:"",icon:sr,color:"text-pink-500",bg:"bg-pink-50",desc:"AI ",action:i},{id:"CURRENCY",name:"",icon:FC,color:"text-green-500",bg:"bg-green-50",desc:""},{id:"TRANSLATION",name:m.tool_translation,icon:YC,color:"text-purple-500",bg:"bg-purple-50",desc:m.desc_translator},{id:"EMERGENCY",name:m.tool_emergency,icon:KC,color:"text-red-500",bg:"bg-red-50",desc:m.desc_emergency},{id:"CARD_ADVICE",name:m.tool_card,icon:ZC,color:"text-indigo-500",bg:"bg-indigo-50",desc:m.desc_card},{id:"SCRATCH_MAP",name:m.tool_map,icon:GC,color:"text-teal-500",bg:"bg-teal-50",desc:m.desc_map},{id:"RESTROOM",name:m.tool_restroom,icon:HC,color:"text-cyan-500",bg:"bg-cyan-50",desc:m.desc_restroom},{id:"VISA",name:m.tool_visa,icon:qC,color:"text-blue-500",bg:"bg-blue-50",desc:m.desc_visa},{id:"CULTURE",name:m.tool_culture,icon:Pp,color:"text-orange-500",bg:"bg-orange-50",desc:m.desc_culture}];return E.jsxs("div",{className:"flex flex-col h-full bg-paper pt-safe",children:[E.jsx("div",{className:"px-5 py-4 bg-paper sticky top-0 z-10 flex items-center justify-between border-b border-sand/50",children:E.jsxs("h2",{className:"text-xl font-extrabold text-ink flex items-center gap-2",children:[E.jsx(yg,{className:"w-6 h-6 text-coral"}),m.tools_title]})}),E.jsx("div",{className:"p-5 grid grid-cols-2 gap-4 pb-32 overflow-y-auto",children:g.map(p=>E.jsxs("div",{onClick:()=>p.action?p.action():c(p.id),className:"bg-white p-5 rounded-3xl shadow-card border border-sand active:scale-95 transition-all cursor-pointer hover:shadow-soft hover:border-coral group",children:[E.jsx("div",{className:`w-12 h-12 ${p.bg} ${p.color} rounded-2xl flex items-center justify-center mb-4 transition-transform group-hover:scale-110`,children:E.jsx(p.icon,{className:"w-6 h-6 stroke-2"})}),E.jsx("h3",{className:"font-bold text-ink mb-1",children:p.name}),E.jsx("p",{className:"text-xs text-gray-400 font-medium",children:p.desc})]},p.id))})]})},q5=({onBack:n,settings:e,onUpdateSettings:t,onResetApp:i,user:r,onLogout:u})=>{const[c,m]=W.useState(!1),[g,p]=W.useState(!1),x=Wt[e.language]||Wt["zh-TW"];W.useEffect(()=>{const M=localStorage.getItem("nomad_user_api_key");M&&!e.apiKey&&(t({apiKey:M}),localStorage.removeItem("nomad_user_api_key"))},[]);const S=M=>{t({apiKey:M}),M&&(p(!0),setTimeout(()=>p(!1),2e3))},C=[{name:"",value:"#FF6B6B"},{name:"",value:"#4ECDC4"},{name:"",value:"#FFE66D"},{name:"",value:"#A06CD5"},{name:"",value:"#6BCB77"}];return E.jsxs("div",{className:"h-full flex flex-col bg-paper animate-slide-in",children:[E.jsxs("div",{className:"px-6 py-6 flex items-center justify-between bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-sand",children:[E.jsx("button",{onClick:n,className:"p-2 -ml-2 rounded-full hover:bg-gray-100 transition-colors",children:E.jsx(cs,{className:"w-6 h-6 text-ink"})}),E.jsx("h1",{className:"text-xl font-bold text-ink",children:""}),E.jsx("div",{className:"w-10"})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[r&&E.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[E.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),E.jsxs("div",{className:"flex items-center justify-between",children:[E.jsxs("div",{children:[E.jsx("p",{className:"text-lg font-bold text-ink",children:r.username}),E.jsxs("p",{className:"text-xs text-gray-400",children:["ID: ",r.id]})]}),E.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded-xl transition-colors text-sm font-medium",children:[E.jsx($C,{className:"w-4 h-4"}),""]})]})]}),E.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[E.jsxs("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider flex items-center gap-2",children:[E.jsx(XC,{className:"w-4 h-4"}),x.api_settings||"API "]}),E.jsxs("div",{className:"space-y-3",children:[E.jsx("label",{className:"text-sm font-bold text-ink",children:x.api_key_label||"Gemini API Key"}),E.jsxs("div",{className:"relative",children:[E.jsx("input",{type:"password",value:e.apiKey||"",onChange:M=>S(M.target.value),placeholder:x.api_key_placeholder||" API Key",className:"w-full p-4 pr-20 bg-gray-50 rounded-xl border border-gray-200 focus:border-coral focus:ring-2 focus:ring-coral/20 outline-none transition-all font-mono text-sm"}),g&&E.jsx("div",{className:"text-right mt-1",children:E.jsx("span",{className:"text-green-500 text-xs font-bold animate-fade-in",children:x.api_key_saved||""})})]}),E.jsxs("p",{className:"text-xs text-gray-400 leading-relaxed",children:[x.api_key_help||" Key ",E.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-coral hover:underline ml-1",children:" Key"})]})]})]}),E.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[E.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),E.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:[C.map(M=>E.jsx("button",{onClick:()=>t({themeColor:M.value}),className:`w-10 h-10 rounded-full flex-shrink-0 transition-transform ${e.themeColor===M.value?"scale-110 ring-2 ring-offset-2 ring-gray-300":"hover:scale-105"}`,style:{backgroundColor:M.value},"aria-label":M.name},M.value)),E.jsx("button",{onClick:()=>t({themeColor:void 0}),className:`w-10 h-10 rounded-full flex-shrink-0 bg-coral flex items-center justify-center text-white text-xs font-bold transition-transform ${e.themeColor?"hover:scale-105":"scale-110 ring-2 ring-offset-2 ring-gray-300"}`,children:""})]})]}),E.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[E.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),E.jsx("div",{className:"space-y-2",children:[{code:"zh-TW",label:""},{code:"en-US",label:"English"},{code:"ja-JP",label:""}].map(M=>E.jsxs("button",{onClick:()=>t({language:M.code}),className:`w-full flex items-center justify-between p-3 rounded-xl transition-colors ${e.language===M.code?"bg-coral/10 text-coral font-bold":"hover:bg-gray-50 text-ink"}`,children:[E.jsx("span",{children:M.label}),e.language===M.code&&E.jsx("div",{className:"w-2 h-2 rounded-full bg-coral"})]},M.code))})]}),E.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-sand",children:[E.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase mb-4 tracking-wider",children:""}),c?E.jsxs("div",{className:"space-y-3 animate-fade-in",children:[E.jsx("p",{className:"text-center text-sm text-red-500 font-medium",children:""}),E.jsxs("div",{className:"flex gap-3",children:[E.jsx("button",{onClick:()=>m(!1),className:"flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold",children:""}),E.jsx("button",{onClick:()=>{i(),m(!1)},className:"flex-1 py-3 bg-red-500 text-white rounded-xl font-bold shadow-lg shadow-red-500/30",children:""})]})]}):E.jsxs("button",{onClick:()=>m(!0),className:"w-full flex items-center justify-center gap-2 p-4 border-2 border-red-100 text-red-500 rounded-xl hover:bg-red-50 transition-colors font-bold",children:[E.jsx(or,{className:"w-5 h-5"}),""]})]}),E.jsxs("div",{className:"text-center text-xs text-gray-400 py-4",children:[E.jsx("p",{children:"NomadAI Travel Journal v1.0.0"}),E.jsx("p",{className:"mt-1",children:"Made with  by NomadAI Team"})]})]})]})},H5=()=>{};var fE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},G5=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const u=n[t++];e[i++]=String.fromCharCode((r&31)<<6|u&63)}else if(r>239&&r<365){const u=n[t++],c=n[t++],m=n[t++],g=((r&7)<<18|(u&63)<<12|(c&63)<<6|m&63)-65536;e[i++]=String.fromCharCode(55296+(g>>10)),e[i++]=String.fromCharCode(56320+(g&1023))}else{const u=n[t++],c=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(u&63)<<6|c&63)}}return e.join("")},Yw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const u=n[r],c=r+1<n.length,m=c?n[r+1]:0,g=r+2<n.length,p=g?n[r+2]:0,x=u>>2,S=(u&3)<<4|m>>4;let C=(m&15)<<2|p>>6,M=p&63;g||(M=64,c||(C=64)),i.push(t[x],t[S],t[C],t[M])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Zw(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):G5(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const u=t[n.charAt(r++)],m=r<n.length?t[n.charAt(r)]:0;++r;const p=r<n.length?t[n.charAt(r)]:64;++r;const S=r<n.length?t[n.charAt(r)]:64;if(++r,u==null||m==null||p==null||S==null)throw new j5;const C=u<<2|m>>4;if(i.push(C),p!==64){const M=m<<4&240|p>>2;if(i.push(M),S!==64){const F=p<<6&192|S;i.push(F)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class j5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const K5=function(n){const e=Zw(n);return Yw.encodeByteArray(e,!0)},Ph=function(n){return K5(n).replace(/\./g,"")},Ww=function(n){try{return Yw.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y5=()=>Z5().__FIREBASE_DEFAULTS__,W5=()=>{if(typeof process>"u"||typeof fE>"u")return;const n=fE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},J5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Ww(n[1]);return e&&JSON.parse(e)},uf=()=>{try{return H5()||Y5()||W5()||J5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Jw=n=>{var e,t;return(t=(e=uf())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},Q5=n=>{const e=Jw(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Qw=()=>{var n;return(n=uf())==null?void 0:n.config},$w=n=>{var e;return(e=uf())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Xw(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X5(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,u=n.sub||n.user_id;if(!u)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:u,user_id:u,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ph(JSON.stringify(t)),Ph(JSON.stringify(c)),""].join(".")}const Nc={};function ek(){const n={prod:[],emulator:[]};for(const e of Object.keys(Nc))Nc[e]?n.emulator.push(e):n.prod.push(e);return n}function tk(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let mE=!1;function eS(n,e){if(typeof window>"u"||typeof document>"u"||!Cu(window.location.host)||Nc[n]===e||Nc[n]||mE)return;Nc[n]=e;function t(C){return`__firebase__banner__${C}`}const i="__firebase__banner",u=ek().prod.length>0;function c(){const C=document.getElementById(i);C&&C.remove()}function m(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function g(C,M){C.setAttribute("width","24"),C.setAttribute("id",M),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function p(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{mE=!0,c()},C}function x(C,M){C.setAttribute("id",M),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function S(){const C=tk(i),M=t("text"),F=document.getElementById(M)||document.createElement("span"),H=t("learnmore"),Y=document.getElementById(H)||document.createElement("a"),ie=t("preprendIcon"),re=document.getElementById(ie)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const ee=C.element;m(ee),x(Y,H);const Ee=p();g(re,ie),ee.append(re,F,Y,Ee),document.body.appendChild(ee)}u?(F.innerText="Preview backend disconnected.",re.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(re.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,F.innerText="Preview backend running in this workspace."),F.setAttribute("id",M)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",S):S()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fi())}function ik(){var e;const n=(e=uf())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ok(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function rk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ak(){const n=fi();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function lk(){return!ik()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function uk(){try{return typeof indexedDB=="object"}catch{return!1}}function ck(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var u;e(((u=r.error)==null?void 0:u.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk="FirebaseError";class fr extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=dk,Object.setPrototypeOf(this,fr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jc.prototype.create)}}class jc{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,u=this.errors[e],c=u?hk(u,i):"Error",m=`${this.serviceName}: ${c} (${r}).`;return new fr(r,m,i)}}function hk(n,e){return n.replace(fk,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const fk=/\{\$([^}]+)}/g;function mk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function rl(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const u=n[r],c=e[r];if(pE(u)&&pE(c)){if(!rl(u,c))return!1}else if(u!==c)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function pE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function pk(n,e){const t=new gk(n,e);return t.subscribe.bind(t)}class gk{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");_k(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=yp),r.error===void 0&&(r.error=yp),r.complete===void 0&&(r.complete=yp);const u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),u}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _k(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function yp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(n){return n&&n._delegate?n._delegate:n}class al{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new $5;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Tk(e))try{this.getOrInitializeService({instanceIdentifier:Xa})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const u=this.getOrInitializeService({instanceIdentifier:r});i.resolve(u)}catch{}}}}clearInstance(e=Xa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xa){return this.instances.has(e)}getOptions(e=Xa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[u,c]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(u);i===m&&c.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const u=this.instances.get(i);return u&&e(u,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:vk(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Xa){return this.component?this.component.multipleInstances?e:Xa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vk(n){return n===Xa?void 0:n}function Tk(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new yk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Tt||(Tt={}));const xk={debug:Tt.DEBUG,verbose:Tt.VERBOSE,info:Tt.INFO,warn:Tt.WARN,error:Tt.ERROR,silent:Tt.SILENT},wk=Tt.INFO,Sk={[Tt.DEBUG]:"log",[Tt.VERBOSE]:"log",[Tt.INFO]:"info",[Tt.WARN]:"warn",[Tt.ERROR]:"error"},Ak=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=Sk[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Lg{constructor(e){this.name=e,this._logLevel=wk,this._logHandler=Ak,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Tt.DEBUG,...e),this._logHandler(this,Tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Tt.VERBOSE,...e),this._logHandler(this,Tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Tt.INFO,...e),this._logHandler(this,Tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Tt.WARN,...e),this._logHandler(this,Tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Tt.ERROR,...e),this._logHandler(this,Tt.ERROR,...e)}}const Ck=(n,e)=>e.some(t=>n instanceof t);let gE,_E;function bk(){return gE||(gE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ik(){return _E||(_E=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const tS=new WeakMap,qp=new WeakMap,nS=new WeakMap,vp=new WeakMap,Vg=new WeakMap;function Nk(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",u),n.removeEventListener("error",c)},u=()=>{t(ia(n.result)),r()},c=()=>{i(n.error),r()};n.addEventListener("success",u),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&tS.set(t,n)}).catch(()=>{}),Vg.set(e,n),e}function Rk(n){if(qp.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",u),n.removeEventListener("error",c),n.removeEventListener("abort",c)},u=()=>{t(),r()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",u),n.addEventListener("error",c),n.addEventListener("abort",c)});qp.set(n,e)}let Hp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return qp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||nS.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ia(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Mk(n){Hp=n(Hp)}function Pk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Tp(this),e,...t);return nS.set(i,e.sort?e.sort():[e]),ia(i)}:Ik().includes(n)?function(...e){return n.apply(Tp(this),e),ia(tS.get(this))}:function(...e){return ia(n.apply(Tp(this),e))}}function kk(n){return typeof n=="function"?Pk(n):(n instanceof IDBTransaction&&Rk(n),Ck(n,bk())?new Proxy(n,Hp):n)}function ia(n){if(n instanceof IDBRequest)return Nk(n);if(vp.has(n))return vp.get(n);const e=kk(n);return e!==n&&(vp.set(n,e),Vg.set(e,n)),e}const Tp=n=>Vg.get(n);function Dk(n,e,{blocked:t,upgrade:i,blocking:r,terminated:u}={}){const c=indexedDB.open(n,e),m=ia(c);return i&&c.addEventListener("upgradeneeded",g=>{i(ia(c.result),g.oldVersion,g.newVersion,ia(c.transaction),g)}),t&&c.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),m.then(g=>{u&&g.addEventListener("close",()=>u()),r&&g.addEventListener("versionchange",p=>r(p.oldVersion,p.newVersion,p))}).catch(()=>{}),m}const Lk=["get","getKey","getAll","getAllKeys","count"],Vk=["put","add","delete","clear"],Ep=new Map;function yE(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ep.get(e))return Ep.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=Vk.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||Lk.includes(t)))return;const u=async function(c,...m){const g=this.transaction(c,r?"readwrite":"readonly");let p=g.store;return i&&(p=p.index(m.shift())),(await Promise.all([p[t](...m),r&&g.done]))[0]};return Ep.set(e,u),u}Mk(n=>({...n,get:(e,t,i)=>yE(e,t)||n.get(e,t,i),has:(e,t)=>!!yE(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Uk(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Uk(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Gp="@firebase/app",vE="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar=new Lg("@firebase/app"),zk="@firebase/app-compat",Bk="@firebase/analytics-compat",Fk="@firebase/analytics",qk="@firebase/app-check-compat",Hk="@firebase/app-check",Gk="@firebase/auth",jk="@firebase/auth-compat",Kk="@firebase/database",Zk="@firebase/data-connect",Yk="@firebase/database-compat",Wk="@firebase/functions",Jk="@firebase/functions-compat",Qk="@firebase/installations",$k="@firebase/installations-compat",Xk="@firebase/messaging",eD="@firebase/messaging-compat",tD="@firebase/performance",nD="@firebase/performance-compat",iD="@firebase/remote-config",sD="@firebase/remote-config-compat",oD="@firebase/storage",rD="@firebase/storage-compat",aD="@firebase/firestore",lD="@firebase/ai",uD="@firebase/firestore-compat",cD="firebase",dD="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jp="[DEFAULT]",hD={[Gp]:"fire-core",[zk]:"fire-core-compat",[Fk]:"fire-analytics",[Bk]:"fire-analytics-compat",[Hk]:"fire-app-check",[qk]:"fire-app-check-compat",[Gk]:"fire-auth",[jk]:"fire-auth-compat",[Kk]:"fire-rtdb",[Zk]:"fire-data-connect",[Yk]:"fire-rtdb-compat",[Wk]:"fire-fn",[Jk]:"fire-fn-compat",[Qk]:"fire-iid",[$k]:"fire-iid-compat",[Xk]:"fire-fcm",[eD]:"fire-fcm-compat",[tD]:"fire-perf",[nD]:"fire-perf-compat",[iD]:"fire-rc",[sD]:"fire-rc-compat",[oD]:"fire-gcs",[rD]:"fire-gcs-compat",[aD]:"fire-fst",[uD]:"fire-fst-compat",[lD]:"fire-vertex","fire-js":"fire-js",[cD]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh=new Map,fD=new Map,Kp=new Map;function TE(n,e){try{n.container.addComponent(e)}catch(t){ar.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function fu(n){const e=n.name;if(Kp.has(e))return ar.debug(`There were multiple attempts to register component ${e}.`),!1;Kp.set(e,n);for(const t of kh.values())TE(t,n);for(const t of fD.values())TE(t,n);return!0}function Og(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ws(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},sa=new jc("app","Firebase",mD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new al("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw sa.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu=dD;function iS(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:jp,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw sa.create("bad-app-name",{appName:String(r)});if(t||(t=Qw()),!t)throw sa.create("no-options");const u=kh.get(r);if(u){if(rl(t,u.options)&&rl(i,u.config))return u;throw sa.create("duplicate-app",{appName:r})}const c=new Ek(r);for(const g of Kp.values())c.addComponent(g);const m=new pD(t,i,c);return kh.set(r,m),m}function sS(n=jp){const e=kh.get(n);if(!e&&n===jp&&Qw())return iS();if(!e)throw sa.create("no-app",{appName:n});return e}function oa(n,e,t){let i=hD[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),u=e.match(/\s|\//);if(r||u){const c=[`Unable to register library "${i}" with version "${e}":`];r&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&u&&c.push("and"),u&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ar.warn(c.join(" "));return}fu(new al(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD="firebase-heartbeat-database",_D=1,Vc="firebase-heartbeat-store";let xp=null;function oS(){return xp||(xp=Dk(gD,_D,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Vc)}catch(t){console.warn(t)}}}}).catch(n=>{throw sa.create("idb-open",{originalErrorMessage:n.message})})),xp}async function yD(n){try{const t=(await oS()).transaction(Vc),i=await t.objectStore(Vc).get(rS(n));return await t.done,i}catch(e){if(e instanceof fr)ar.warn(e.message);else{const t=sa.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ar.warn(t.message)}}}async function EE(n,e){try{const i=(await oS()).transaction(Vc,"readwrite");await i.objectStore(Vc).put(e,rS(n)),await i.done}catch(t){if(t instanceof fr)ar.warn(t.message);else{const i=sa.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ar.warn(i.message)}}}function rS(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=1024,TD=30;class ED{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new wD(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),u=xE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===u||this._heartbeatsCache.heartbeats.some(c=>c.date===u))return;if(this._heartbeatsCache.heartbeats.push({date:u,agent:r}),this._heartbeatsCache.heartbeats.length>TD){const c=SD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){ar.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=xE(),{heartbeatsToSend:i,unsentEntries:r}=xD(this._heartbeatsCache.heartbeats),u=Ph(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),u}catch(t){return ar.warn(t),""}}}function xE(){return new Date().toISOString().substring(0,10)}function xD(n,e=vD){const t=[];let i=n.slice();for(const r of n){const u=t.find(c=>c.agent===r.agent);if(u){if(u.dates.push(r.date),wE(t)>e){u.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),wE(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class wD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return uk()?ck().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await yD(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return EE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return EE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function wE(n){return Ph(JSON.stringify({version:2,heartbeats:n})).length}function SD(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AD(n){fu(new al("platform-logger",e=>new Ok(e),"PRIVATE")),fu(new al("heartbeat",e=>new ED(e),"PRIVATE")),oa(Gp,vE,n),oa(Gp,vE,"esm2020"),oa("fire-js","")}AD("");function aS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const CD=aS,lS=new jc("auth","Firebase",aS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh=new Lg("@firebase/auth");function bD(n,...e){Dh.logLevel<=Tt.WARN&&Dh.warn(`Auth (${bu}): ${n}`,...e)}function yh(n,...e){Dh.logLevel<=Tt.ERROR&&Dh.error(`Auth (${bu}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function No(n,...e){throw zg(n,...e)}function Qs(n,...e){return zg(n,...e)}function Ug(n,e,t){const i={...CD(),[e]:t};return new jc("auth","Firebase",i).create(e,{appName:n.name})}function il(n){return Ug(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ID(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&No(n,"argument-error"),Ug(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function zg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return lS.create(n,...e)}function tt(n,e,...t){if(!n)throw zg(e,...t)}function nr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw yh(e),new Error(e)}function lr(n,e){n||nr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zp(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function ND(){return SE()==="http:"||SE()==="https:"}function SE(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ND()||ok()||"connection"in navigator)?navigator.onLine:!0}function MD(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,t){this.shortDelay=e,this.longDelay=t,lr(t>e,"Short delay should be less than long delay!"),this.isMobile=nk()||rk()}get(){return RD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bg(n,e){lr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;nr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;nr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;nr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],DD=new Zc(3e4,6e4);function Fg(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Iu(n,e,t,i,r={}){return cS(n,r,async()=>{let u={},c={};i&&(e==="GET"?c=i:u={body:JSON.stringify(i)});const m=Kc({key:n.config.apiKey,...c}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:g,...u};return sk()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Cu(n.emulatorConfig.host)&&(p.credentials="include"),uS.fetch()(await dS(n,n.config.apiHost,t,m),p)})}async function cS(n,e,t){n._canInitEmulator=!1;const i={...PD,...e};try{const r=new VD(n),u=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const c=await u.json();if("needConfirmation"in c)throw uh(n,"account-exists-with-different-credential",c);if(u.ok&&!("errorMessage"in c))return c;{const m=u.ok?c.errorMessage:c.error.message,[g,p]=m.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw uh(n,"credential-already-in-use",c);if(g==="EMAIL_EXISTS")throw uh(n,"email-already-in-use",c);if(g==="USER_DISABLED")throw uh(n,"user-disabled",c);const x=i[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Ug(n,x,p);No(n,x)}}catch(r){if(r instanceof fr)throw r;No(n,"network-request-failed",{message:String(r)})}}async function LD(n,e,t,i,r={}){const u=await Iu(n,e,t,i,r);return"mfaPendingCredential"in u&&No(n,"multi-factor-auth-required",{_serverResponse:u}),u}async function dS(n,e,t,i){const r=`${e}${t}?${i}`,u=n,c=u.config.emulator?Bg(n.config,r):`${n.config.apiScheme}://${r}`;return kD.includes(t)&&(await u._persistenceManagerAvailable,u._getPersistenceType()==="COOKIE")?u._getPersistence()._getFinalTarget(c).toString():c}class VD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Qs(this.auth,"network-request-failed")),DD.get())})}}function uh(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Qs(n,e,i);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OD(n,e){return Iu(n,"POST","/v1/accounts:delete",e)}async function Lh(n,e){return Iu(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function UD(n,e=!1){const t=Zn(n),i=await t.getIdToken(e),r=qg(i);tt(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const u=typeof r.firebase=="object"?r.firebase:void 0,c=u==null?void 0:u.sign_in_provider;return{claims:r,token:i,authTime:Rc(wp(r.auth_time)),issuedAtTime:Rc(wp(r.iat)),expirationTime:Rc(wp(r.exp)),signInProvider:c||null,signInSecondFactor:(u==null?void 0:u.sign_in_second_factor)||null}}function wp(n){return Number(n)*1e3}function qg(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return yh("JWT malformed, contained fewer than 3 sections"),null;try{const r=Ww(t);return r?JSON.parse(r):(yh("Failed to decode base64 JWT payload"),null)}catch(r){return yh("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function AE(n){const e=qg(n);return tt(e,"internal-error"),tt(typeof e.exp<"u","internal-error"),tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oc(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof fr&&zD(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function zD({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rc(this.lastLoginAt),this.creationTime=Rc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vh(n){var S;const e=n.auth,t=await n.getIdToken(),i=await Oc(n,Lh(e,{idToken:t}));tt(i==null?void 0:i.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const u=(S=r.providerUserInfo)!=null&&S.length?hS(r.providerUserInfo):[],c=qD(n.providerData,u),m=n.isAnonymous,g=!(n.email&&r.passwordHash)&&!(c!=null&&c.length),p=m?g:!1,x={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:c,metadata:new Yp(r.createdAt,r.lastLoginAt),isAnonymous:p};Object.assign(n,x)}async function FD(n){const e=Zn(n);await Vh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qD(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function hS(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HD(n,e){const t=await cS(n,{},async()=>{const i=Kc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:u}=n.config,c=await dS(n,r,"/v1/token",`key=${u}`),m=await n._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:m,body:i};return n.emulatorConfig&&Cu(n.emulatorConfig.host)&&(g.credentials="include"),uS.fetch()(c,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function GD(n,e){return Iu(n,"POST","/v2/accounts:revokeToken",Fg(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class au{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt(typeof e.idToken<"u","internal-error"),tt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):AE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){tt(e.length!==0,"internal-error");const t=AE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:u}=await HD(e,t);this.updateTokensAndExpiration(i,r,Number(u))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:u}=t,c=new au;return i&&(tt(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),r&&(tt(typeof r=="string","internal-error",{appName:e}),c.accessToken=r),u&&(tt(typeof u=="number","internal-error",{appName:e}),c.expirationTime=u),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new au,this.toJSON())}_performRefresh(){return nr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(n,e){tt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Js{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new BD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Yp(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await Oc(this,this.stsTokenManager.getToken(this.auth,e));return tt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return UD(this,e)}reload(){return FD(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Js({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Vh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ws(this.auth.app))return Promise.reject(il(this.auth));const e=await this.getIdToken();return await Oc(this,OD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,u=t.phoneNumber??void 0,c=t.photoURL??void 0,m=t.tenantId??void 0,g=t._redirectEventId??void 0,p=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:S,emailVerified:C,isAnonymous:M,providerData:F,stsTokenManager:H}=t;tt(S&&H,e,"internal-error");const Y=au.fromJSON(this.name,H);tt(typeof S=="string",e,"internal-error"),Qr(i,e.name),Qr(r,e.name),tt(typeof C=="boolean",e,"internal-error"),tt(typeof M=="boolean",e,"internal-error"),Qr(u,e.name),Qr(c,e.name),Qr(m,e.name),Qr(g,e.name),Qr(p,e.name),Qr(x,e.name);const ie=new Js({uid:S,auth:e,email:r,emailVerified:C,displayName:i,isAnonymous:M,photoURL:c,phoneNumber:u,tenantId:m,stsTokenManager:Y,createdAt:p,lastLoginAt:x});return F&&Array.isArray(F)&&(ie.providerData=F.map(re=>({...re}))),g&&(ie._redirectEventId=g),ie}static async _fromIdTokenResponse(e,t,i=!1){const r=new au;r.updateFromServerResponse(t);const u=new Js({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Vh(u),u}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];tt(r.localId!==void 0,"internal-error");const u=r.providerUserInfo!==void 0?hS(r.providerUserInfo):[],c=!(r.email&&r.passwordHash)&&!(u!=null&&u.length),m=new au;m.updateFromIdToken(i);const g=new Js({uid:r.localId,auth:e,stsTokenManager:m,isAnonymous:c}),p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:u,metadata:new Yp(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(u!=null&&u.length)};return Object.assign(g,p),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CE=new Map;function ir(n){lr(n instanceof Function,"Expected a class definition");let e=CE.get(n);return e?(lr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,CE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}fS.type="NONE";const bE=fS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vh(n,e,t){return`firebase:${n}:${e}:${t}`}class lu{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:u}=this.auth;this.fullUserKey=vh(this.userKey,r.apiKey,u),this.fullPersistenceKey=vh("persistence",r.apiKey,u),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Lh(this.auth,{idToken:e}).catch(()=>{});return t?Js._fromGetAccountInfoResponse(this.auth,t,e):null}return Js._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new lu(ir(bE),e,i);const r=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let u=r[0]||ir(bE);const c=vh(i,e.config.apiKey,e.name);let m=null;for(const p of t)try{const x=await p._get(c);if(x){let S;if(typeof x=="string"){const C=await Lh(e,{idToken:x}).catch(()=>{});if(!C)break;S=await Js._fromGetAccountInfoResponse(e,C,x)}else S=Js._fromJSON(e,x);p!==u&&(m=S),u=p;break}}catch{}const g=r.filter(p=>p._shouldAllowMigration);return!u._shouldAllowMigration||!g.length?new lu(u,e,i):(u=g[0],m&&await u._set(c,m.toJSON()),await Promise.all(t.map(async p=>{if(p!==u)try{await p._remove(c)}catch{}})),new lu(u,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_S(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(mS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(vS(e))return"Blackberry";if(TS(e))return"Webos";if(pS(e))return"Safari";if((e.includes("chrome/")||gS(e))&&!e.includes("edge/"))return"Chrome";if(yS(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function mS(n=fi()){return/firefox\//i.test(n)}function pS(n=fi()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function gS(n=fi()){return/crios\//i.test(n)}function _S(n=fi()){return/iemobile/i.test(n)}function yS(n=fi()){return/android/i.test(n)}function vS(n=fi()){return/blackberry/i.test(n)}function TS(n=fi()){return/webos/i.test(n)}function Hg(n=fi()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function jD(n=fi()){var e;return Hg(n)&&!!((e=window.navigator)!=null&&e.standalone)}function KD(){return ak()&&document.documentMode===10}function ES(n=fi()){return Hg(n)||yS(n)||TS(n)||vS(n)||/windows phone/i.test(n)||_S(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(n,e=[]){let t;switch(n){case"Browser":t=IE(fi());break;case"Worker":t=`${IE(fi())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bu}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=u=>new Promise((c,m)=>{try{const g=e(u);c(g)}catch(g){m(g)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YD(n,e={}){return Iu(n,"GET","/v2/passwordPolicy",Fg(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD=6;class JD{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??WD,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,u){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new NE(this),this.idTokenSubscription=new NE(this),this.beforeStateQueue=new ZD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=lS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(u=>this._resolvePersistenceManagerAvailable=u)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ir(t)),this._initializationPromise=this.queue(async()=>{var i,r,u;if(!this._deleted&&(this.persistenceManager=await lu.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((u=this.currentUser)==null?void 0:u.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Lh(this,{idToken:e}),i=await Js._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var u;if(Ws(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(m=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(m,m))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(u=this.redirectUser)==null?void 0:u._redirectEventId,m=i==null?void 0:i._redirectEventId,g=await this.tryRedirectSignIn(e);(!c||c===m)&&(g!=null&&g.user)&&(i=g.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=MD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ws(this.app))return Promise.reject(il(this));const t=e?Zn(e):null;return t&&tt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ws(this.app)?Promise.reject(il(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ws(this.app)?Promise.reject(il(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ir(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YD(this),t=new JD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new jc("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await GD(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ir(e)||this._popupRedirectResolver;tt(t,this,"argument-error"),this.redirectPersistenceManager=await lu.create(this,[ir(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const u=typeof t=="function"?t:t.next.bind(t);let c=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(m,this,"internal-error"),m.then(()=>{c||u(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,i,r);return()=>{c=!0,g()}}else{const g=e.addObserver(t);return()=>{c=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(Ws(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&bD(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function cf(n){return Zn(n)}class NE{constructor(e){this.auth=e,this.observer=null,this.addObserver=pk(t=>this.observer=t)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $D(n){Gg=n}function XD(n){return Gg.loadJS(n)}function eL(){return Gg.gapiScript}function tL(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nL(n,e){const t=Og(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),u=t.getOptions();if(rl(u,e??{}))return r;No(r,"already-initialized")}return t.initialize({options:e})}function iL(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(ir);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function sL(n,e,t){const i=cf(n);tt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,u=wS(e),{host:c,port:m}=oL(e),g=m===null?"":`:${m}`,p={url:`${u}//${c}${g}/`},x=Object.freeze({host:c,port:m,protocol:u.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){tt(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),tt(rl(p,i.config.emulator)&&rl(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,Cu(c)?(Xw(`${u}//${c}${g}`),eS("Auth",!0)):rL()}function wS(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function oL(n){const e=wS(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const u=r[1];return{host:u,port:RE(i.substr(u.length+1))}}else{const[u,c]=i.split(":");return{host:u,port:RE(c)}}}function RE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function rL(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return nr("not implemented")}_getIdTokenResponse(e){return nr("not implemented")}_linkToIdToken(e,t){return nr("not implemented")}_getReauthenticationResolver(e){return nr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uu(n,e){return LD(n,"POST","/v1/accounts:signInWithIdp",Fg(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL="http://localhost";class ll extends SS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ll(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):No("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...u}=t;if(!i||!r)return null;const c=new ll(i,r);return c.idToken=u.idToken||void 0,c.accessToken=u.accessToken||void 0,c.secret=u.secret,c.nonce=u.nonce,c.pendingToken=u.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return uu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,uu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,uu(e,t)}buildRequest(){const e={requestUri:aL,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Kc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc extends jg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r extends Yc{constructor(){super("facebook.com")}static credential(e){return ll._fromParams({providerId:$r.PROVIDER_ID,signInMethod:$r.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $r.credentialFromTaggedObject(e)}static credentialFromError(e){return $r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $r.credential(e.oauthAccessToken)}catch{return null}}}$r.FACEBOOK_SIGN_IN_METHOD="facebook.com";$r.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr extends Yc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ll._fromParams({providerId:tr.PROVIDER_ID,signInMethod:tr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return tr.credentialFromTaggedObject(e)}static credentialFromError(e){return tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return tr.credential(t,i)}catch{return null}}}tr.GOOGLE_SIGN_IN_METHOD="google.com";tr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends Yc{constructor(){super("github.com")}static credential(e){return ll._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xr.credentialFromTaggedObject(e)}static credentialFromError(e){return Xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xr.credential(e.oauthAccessToken)}catch{return null}}}Xr.GITHUB_SIGN_IN_METHOD="github.com";Xr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea extends Yc{constructor(){super("twitter.com")}static credential(e,t){return ll._fromParams({providerId:ea.PROVIDER_ID,signInMethod:ea.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ea.credentialFromTaggedObject(e)}static credentialFromError(e){return ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return ea.credential(t,i)}catch{return null}}}ea.TWITTER_SIGN_IN_METHOD="twitter.com";ea.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const u=await Js._fromIdTokenResponse(e,i,r),c=ME(i);return new mu({user:u,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=ME(i);return new mu({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function ME(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh extends fr{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Oh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Oh(e,t,i,r)}}function AS(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(u=>{throw u.code==="auth/multi-factor-auth-required"?Oh._fromErrorAndOperation(n,u,e,i):u})}async function lL(n,e,t=!1){const i=await Oc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return mu._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uL(n,e,t=!1){const{auth:i}=n;if(Ws(i.app))return Promise.reject(il(i));const r="reauthenticate";try{const u=await Oc(n,AS(i,r,e,n),t);tt(u.idToken,i,"internal-error");const c=qg(u.idToken);tt(c,i,"internal-error");const{sub:m}=c;return tt(n.uid===m,i,"user-mismatch"),mu._forOperation(n,r,u)}catch(u){throw(u==null?void 0:u.code)==="auth/user-not-found"&&No(i,"user-mismatch"),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cL(n,e,t=!1){if(Ws(n.app))return Promise.reject(il(n));const i="signIn",r=await AS(n,i,e),u=await mu._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(u.user),u}function dL(n,e,t,i){return Zn(n).onIdTokenChanged(e,t,i)}function hL(n,e,t){return Zn(n).beforeAuthStateChanged(e,t)}function fL(n,e,t,i){return Zn(n).onAuthStateChanged(e,t,i)}function mL(n){return Zn(n).signOut()}const Uh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Uh,"1"),this.storage.removeItem(Uh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pL=1e3,gL=10;class bS extends CS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ES(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,m,g)=>{this.notifyListeners(c,g)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},u=this.storage.getItem(i);KD()&&u!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,gL):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},pL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}bS.type="LOCAL";const _L=bS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS extends CS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}IS.type="SESSION";const NS=IS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yL(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new df(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:u}=t.data,c=this.handlersMap[r];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const m=Array.from(c).map(async p=>p(t.origin,u)),g=await yL(m);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}df.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let u,c;return new Promise((m,g)=>{const p=Kg("",20);r.port1.start();const x=setTimeout(()=>{g(new Error("unsupported_event"))},i);c={messageChannel:r,onMessage(S){const C=S;if(C.data.eventId===p)switch(C.data.status){case"ack":clearTimeout(x),u=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),m(C.data.response);break;default:clearTimeout(x),clearTimeout(u),g(new Error("invalid_response"));break}}},this.handlers.add(c),r.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[r.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function So(){return window}function TL(n){So().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(){return typeof So().WorkerGlobalScope<"u"&&typeof So().importScripts=="function"}async function EL(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function xL(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function wL(){return RS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS="firebaseLocalStorageDb",SL=1,zh="firebaseLocalStorage",PS="fbase_key";class Wc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function hf(n,e){return n.transaction([zh],e?"readwrite":"readonly").objectStore(zh)}function AL(){const n=indexedDB.deleteDatabase(MS);return new Wc(n).toPromise()}function Wp(){const n=indexedDB.open(MS,SL);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(zh,{keyPath:PS})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(zh)?e(i):(i.close(),await AL(),e(await Wp()))})})}async function PE(n,e,t){const i=hf(n,!0).put({[PS]:e,value:t});return new Wc(i).toPromise()}async function CL(n,e){const t=hf(n,!1).get(e),i=await new Wc(t).toPromise();return i===void 0?null:i.value}function kE(n,e){const t=hf(n,!0).delete(e);return new Wc(t).toPromise()}const bL=800,IL=3;class kS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Wp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>IL)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return RS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=df._getInstance(wL()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await EL(),!this.activeServiceWorker)return;this.sender=new vL(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||xL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Wp();return await PE(e,Uh,"1"),await kE(e,Uh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>PE(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>CL(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>kE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const u=hf(r,!1).getAll();return new Wc(u).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:u}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(u)&&(this.notifyListeners(r,u),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),bL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kS.type="LOCAL";const NL=kS;new Zc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(n,e){return e?ir(e):(tt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg extends SS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return uu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return uu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return uu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function RL(n){return cL(n.auth,new Zg(n),n.bypassAuthState)}function ML(n){const{auth:e,user:t}=n;return tt(t,e,"internal-error"),uL(t,new Zg(n),n.bypassAuthState)}async function PL(n){const{auth:e,user:t}=n;return tt(t,e,"internal-error"),lL(t,new Zg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e,t,i,r,u=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=u,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:u,error:c,type:m}=e;if(c){this.reject(c);return}const g={auth:this.auth,requestUri:t,sessionId:i,tenantId:u||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(g))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return RL;case"linkViaPopup":case"linkViaRedirect":return PL;case"reauthViaPopup":case"reauthViaRedirect":return ML;default:No(this.auth,"internal-error")}}resolve(e){lr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){lr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kL=new Zc(2e3,1e4);async function DL(n,e,t){if(Ws(n.app))return Promise.reject(Qs(n,"operation-not-supported-in-this-environment"));const i=cf(n);ID(n,e,jg);const r=DS(i,t);return new tl(i,"signInViaPopup",e,r).executeNotNull()}class tl extends LS{constructor(e,t,i,r,u){super(e,t,r,u),this.provider=i,this.authWindow=null,this.pollId=null,tl.currentPopupAction&&tl.currentPopupAction.cancel(),tl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){lr(this.filter.length===1,"Popup operations only handle one event");const e=Kg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Qs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Qs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,kL.get())};e()}}tl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LL="pendingRedirect",Th=new Map;class VL extends LS{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Th.get(this.auth._key());if(!e){try{const i=await OL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Th.set(this.auth._key(),e)}return this.bypassAuthState||Th.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function OL(n,e){const t=BL(e),i=zL(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function UL(n,e){Th.set(n._key(),e)}function zL(n){return ir(n._redirectPersistence)}function BL(n){return vh(LL,n.config.apiKey,n.name)}async function FL(n,e,t=!1){if(Ws(n.app))return Promise.reject(il(n));const i=cf(n),r=DS(i,e),c=await new VL(i,r,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qL=600*1e3;class HL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!GL(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!VS(e)){const r=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Qs(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qL&&this.cachedEventUids.clear(),this.cachedEventUids.has(DE(e))}saveEventToCache(e){this.cachedEventUids.add(DE(e)),this.lastProcessedEventTime=Date.now()}}function DE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function VS({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function GL(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return VS(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jL(n,e={}){return Iu(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ZL=/^https?/;async function YL(n){if(n.config.emulator)return;const{authorizedDomains:e}=await jL(n);for(const t of e)try{if(WL(t))return}catch{}No(n,"unauthorized-domain")}function WL(n){const e=Zp(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!ZL.test(t))return!1;if(KL.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JL=new Zc(3e4,6e4);function LE(){const n=So().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function QL(n){return new Promise((e,t)=>{var r,u,c;function i(){LE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{LE(),t(Qs(n,"network-request-failed"))},timeout:JL.get()})}if((u=(r=So().gapi)==null?void 0:r.iframes)!=null&&u.Iframe)e(gapi.iframes.getContext());else if((c=So().gapi)!=null&&c.load)i();else{const m=tL("iframefcb");return So()[m]=()=>{gapi.load?i():t(Qs(n,"network-request-failed"))},XD(`${eL()}?onload=${m}`).catch(g=>t(g))}}).catch(e=>{throw Eh=null,e})}let Eh=null;function $L(n){return Eh=Eh||QL(n),Eh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL=new Zc(5e3,15e3),e3="__/auth/iframe",t3="emulator/auth/iframe",n3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},i3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function s3(n){const e=n.config;tt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Bg(e,t3):`https://${n.config.authDomain}/${e3}`,i={apiKey:e.apiKey,appName:n.name,v:bu},r=i3.get(n.config.apiHost);r&&(i.eid=r);const u=n._getFrameworks();return u.length&&(i.fw=u.join(",")),`${t}?${Kc(i).slice(1)}`}async function o3(n){const e=await $L(n),t=So().gapi;return tt(t,n,"internal-error"),e.open({where:document.body,url:s3(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:n3,dontclear:!0},i=>new Promise(async(r,u)=>{await i.restyle({setHideOnLeave:!1});const c=Qs(n,"network-request-failed"),m=So().setTimeout(()=>{u(c)},XL.get());function g(){So().clearTimeout(m),r(i)}i.ping(g).then(g,()=>{u(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},a3=500,l3=600,u3="_blank",c3="http://localhost";class VE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function d3(n,e,t,i=a3,r=l3){const u=Math.max((window.screen.availHeight-r)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let m="";const g={...r3,width:i.toString(),height:r.toString(),top:u,left:c},p=fi().toLowerCase();t&&(m=gS(p)?u3:t),mS(p)&&(e=e||c3,g.scrollbars="yes");const x=Object.entries(g).reduce((C,[M,F])=>`${C}${M}=${F},`,"");if(jD(p)&&m!=="_self")return h3(e||"",m),new VE(null);const S=window.open(e||"",m,x);tt(S,n,"popup-blocked");try{S.focus()}catch{}return new VE(S)}function h3(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3="__/auth/handler",m3="emulator/auth/handler",p3=encodeURIComponent("fac");async function OE(n,e,t,i,r,u){tt(n.config.authDomain,n,"auth-domain-config-required"),tt(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:bu,eventId:r};if(e instanceof jg){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",mk(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,S]of Object.entries({}))c[x]=S}if(e instanceof Yc){const x=e.getScopes().filter(S=>S!=="");x.length>0&&(c.scopes=x.join(","))}n.tenantId&&(c.tid=n.tenantId);const m=c;for(const x of Object.keys(m))m[x]===void 0&&delete m[x];const g=await n._getAppCheckToken(),p=g?`#${p3}=${encodeURIComponent(g)}`:"";return`${g3(n)}?${Kc(m).slice(1)}${p}`}function g3({config:n}){return n.emulator?Bg(n,m3):`https://${n.authDomain}/${f3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp="webStorageSupport";class _3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=NS,this._completeRedirectFn=FL,this._overrideRedirectResult=UL}async _openPopup(e,t,i,r){var c;lr((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const u=await OE(e,t,i,Zp(),r);return d3(e,u,Kg())}async _openRedirect(e,t,i,r){await this._originValidation(e);const u=await OE(e,t,i,Zp(),r);return TL(u),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:u}=this.eventManagers[t];return r?Promise.resolve(r):(lr(u,"If manager is not set, promise should be"),u)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await o3(e),i=new HL(e);return t.register("authEvent",r=>(tt(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Sp,{type:Sp},r=>{var c;const u=(c=r==null?void 0:r[0])==null?void 0:c[Sp];u!==void 0&&t(!!u),No(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=YL(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ES()||pS()||Hg()}}const y3=_3;var UE="@firebase/auth",zE="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T3(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function E3(n){fu(new al("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),u=e.getProvider("app-check-internal"),{apiKey:c,authDomain:m}=i.options;tt(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const g={apiKey:c,authDomain:m,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xS(n)},p=new QD(i,r,u,g);return iL(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),fu(new al("auth-internal",e=>{const t=cf(e.getProvider("auth").getImmediate());return(i=>new v3(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),oa(UE,zE,T3(n)),oa(UE,zE,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x3=300,w3=$w("authIdTokenMaxAge")||x3;let BE=null;const S3=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>w3)return;const r=t==null?void 0:t.token;BE!==r&&(BE=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function A3(n=sS()){const e=Og(n,"auth");if(e.isInitialized())return e.getImmediate();const t=nL(n,{popupRedirectResolver:y3,persistence:[NL,_L,NS]}),i=$w("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const u=new URL(i,location.origin);if(location.origin===u.origin){const c=S3(u.toString());hL(t,c,()=>c(t.currentUser)),dL(t,m=>c(m))}}const r=Jw("auth");return r&&sL(t,`http://${r}`),t}function C3(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}$D({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const u=Qs("internal-error");u.customData=r,t(u)},i.type="text/javascript",i.charset="UTF-8",C3().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});E3("Browser");var b3="firebase",I3="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */oa(b3,I3,"app");var FE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ra,OS;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,U){function V(){}V.prototype=U.prototype,k.F=U.prototype,k.prototype=new V,k.prototype.constructor=k,k.D=function(B,q,K){for(var z=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)z[Le-2]=arguments[Le];return U.prototype[q].apply(B,z)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(k,U,V){V||(V=0);const B=Array(16);if(typeof U=="string")for(var q=0;q<16;++q)B[q]=U.charCodeAt(V++)|U.charCodeAt(V++)<<8|U.charCodeAt(V++)<<16|U.charCodeAt(V++)<<24;else for(q=0;q<16;++q)B[q]=U[V++]|U[V++]<<8|U[V++]<<16|U[V++]<<24;U=k.g[0],V=k.g[1],q=k.g[2];let K=k.g[3],z;z=U+(K^V&(q^K))+B[0]+3614090360&4294967295,U=V+(z<<7&4294967295|z>>>25),z=K+(q^U&(V^q))+B[1]+3905402710&4294967295,K=U+(z<<12&4294967295|z>>>20),z=q+(V^K&(U^V))+B[2]+606105819&4294967295,q=K+(z<<17&4294967295|z>>>15),z=V+(U^q&(K^U))+B[3]+3250441966&4294967295,V=q+(z<<22&4294967295|z>>>10),z=U+(K^V&(q^K))+B[4]+4118548399&4294967295,U=V+(z<<7&4294967295|z>>>25),z=K+(q^U&(V^q))+B[5]+1200080426&4294967295,K=U+(z<<12&4294967295|z>>>20),z=q+(V^K&(U^V))+B[6]+2821735955&4294967295,q=K+(z<<17&4294967295|z>>>15),z=V+(U^q&(K^U))+B[7]+4249261313&4294967295,V=q+(z<<22&4294967295|z>>>10),z=U+(K^V&(q^K))+B[8]+1770035416&4294967295,U=V+(z<<7&4294967295|z>>>25),z=K+(q^U&(V^q))+B[9]+2336552879&4294967295,K=U+(z<<12&4294967295|z>>>20),z=q+(V^K&(U^V))+B[10]+4294925233&4294967295,q=K+(z<<17&4294967295|z>>>15),z=V+(U^q&(K^U))+B[11]+2304563134&4294967295,V=q+(z<<22&4294967295|z>>>10),z=U+(K^V&(q^K))+B[12]+1804603682&4294967295,U=V+(z<<7&4294967295|z>>>25),z=K+(q^U&(V^q))+B[13]+4254626195&4294967295,K=U+(z<<12&4294967295|z>>>20),z=q+(V^K&(U^V))+B[14]+2792965006&4294967295,q=K+(z<<17&4294967295|z>>>15),z=V+(U^q&(K^U))+B[15]+1236535329&4294967295,V=q+(z<<22&4294967295|z>>>10),z=U+(q^K&(V^q))+B[1]+4129170786&4294967295,U=V+(z<<5&4294967295|z>>>27),z=K+(V^q&(U^V))+B[6]+3225465664&4294967295,K=U+(z<<9&4294967295|z>>>23),z=q+(U^V&(K^U))+B[11]+643717713&4294967295,q=K+(z<<14&4294967295|z>>>18),z=V+(K^U&(q^K))+B[0]+3921069994&4294967295,V=q+(z<<20&4294967295|z>>>12),z=U+(q^K&(V^q))+B[5]+3593408605&4294967295,U=V+(z<<5&4294967295|z>>>27),z=K+(V^q&(U^V))+B[10]+38016083&4294967295,K=U+(z<<9&4294967295|z>>>23),z=q+(U^V&(K^U))+B[15]+3634488961&4294967295,q=K+(z<<14&4294967295|z>>>18),z=V+(K^U&(q^K))+B[4]+3889429448&4294967295,V=q+(z<<20&4294967295|z>>>12),z=U+(q^K&(V^q))+B[9]+568446438&4294967295,U=V+(z<<5&4294967295|z>>>27),z=K+(V^q&(U^V))+B[14]+3275163606&4294967295,K=U+(z<<9&4294967295|z>>>23),z=q+(U^V&(K^U))+B[3]+4107603335&4294967295,q=K+(z<<14&4294967295|z>>>18),z=V+(K^U&(q^K))+B[8]+1163531501&4294967295,V=q+(z<<20&4294967295|z>>>12),z=U+(q^K&(V^q))+B[13]+2850285829&4294967295,U=V+(z<<5&4294967295|z>>>27),z=K+(V^q&(U^V))+B[2]+4243563512&4294967295,K=U+(z<<9&4294967295|z>>>23),z=q+(U^V&(K^U))+B[7]+1735328473&4294967295,q=K+(z<<14&4294967295|z>>>18),z=V+(K^U&(q^K))+B[12]+2368359562&4294967295,V=q+(z<<20&4294967295|z>>>12),z=U+(V^q^K)+B[5]+4294588738&4294967295,U=V+(z<<4&4294967295|z>>>28),z=K+(U^V^q)+B[8]+2272392833&4294967295,K=U+(z<<11&4294967295|z>>>21),z=q+(K^U^V)+B[11]+1839030562&4294967295,q=K+(z<<16&4294967295|z>>>16),z=V+(q^K^U)+B[14]+4259657740&4294967295,V=q+(z<<23&4294967295|z>>>9),z=U+(V^q^K)+B[1]+2763975236&4294967295,U=V+(z<<4&4294967295|z>>>28),z=K+(U^V^q)+B[4]+1272893353&4294967295,K=U+(z<<11&4294967295|z>>>21),z=q+(K^U^V)+B[7]+4139469664&4294967295,q=K+(z<<16&4294967295|z>>>16),z=V+(q^K^U)+B[10]+3200236656&4294967295,V=q+(z<<23&4294967295|z>>>9),z=U+(V^q^K)+B[13]+681279174&4294967295,U=V+(z<<4&4294967295|z>>>28),z=K+(U^V^q)+B[0]+3936430074&4294967295,K=U+(z<<11&4294967295|z>>>21),z=q+(K^U^V)+B[3]+3572445317&4294967295,q=K+(z<<16&4294967295|z>>>16),z=V+(q^K^U)+B[6]+76029189&4294967295,V=q+(z<<23&4294967295|z>>>9),z=U+(V^q^K)+B[9]+3654602809&4294967295,U=V+(z<<4&4294967295|z>>>28),z=K+(U^V^q)+B[12]+3873151461&4294967295,K=U+(z<<11&4294967295|z>>>21),z=q+(K^U^V)+B[15]+530742520&4294967295,q=K+(z<<16&4294967295|z>>>16),z=V+(q^K^U)+B[2]+3299628645&4294967295,V=q+(z<<23&4294967295|z>>>9),z=U+(q^(V|~K))+B[0]+4096336452&4294967295,U=V+(z<<6&4294967295|z>>>26),z=K+(V^(U|~q))+B[7]+1126891415&4294967295,K=U+(z<<10&4294967295|z>>>22),z=q+(U^(K|~V))+B[14]+2878612391&4294967295,q=K+(z<<15&4294967295|z>>>17),z=V+(K^(q|~U))+B[5]+4237533241&4294967295,V=q+(z<<21&4294967295|z>>>11),z=U+(q^(V|~K))+B[12]+1700485571&4294967295,U=V+(z<<6&4294967295|z>>>26),z=K+(V^(U|~q))+B[3]+2399980690&4294967295,K=U+(z<<10&4294967295|z>>>22),z=q+(U^(K|~V))+B[10]+4293915773&4294967295,q=K+(z<<15&4294967295|z>>>17),z=V+(K^(q|~U))+B[1]+2240044497&4294967295,V=q+(z<<21&4294967295|z>>>11),z=U+(q^(V|~K))+B[8]+1873313359&4294967295,U=V+(z<<6&4294967295|z>>>26),z=K+(V^(U|~q))+B[15]+4264355552&4294967295,K=U+(z<<10&4294967295|z>>>22),z=q+(U^(K|~V))+B[6]+2734768916&4294967295,q=K+(z<<15&4294967295|z>>>17),z=V+(K^(q|~U))+B[13]+1309151649&4294967295,V=q+(z<<21&4294967295|z>>>11),z=U+(q^(V|~K))+B[4]+4149444226&4294967295,U=V+(z<<6&4294967295|z>>>26),z=K+(V^(U|~q))+B[11]+3174756917&4294967295,K=U+(z<<10&4294967295|z>>>22),z=q+(U^(K|~V))+B[2]+718787259&4294967295,q=K+(z<<15&4294967295|z>>>17),z=V+(K^(q|~U))+B[9]+3951481745&4294967295,k.g[0]=k.g[0]+U&4294967295,k.g[1]=k.g[1]+(q+(z<<21&4294967295|z>>>11))&4294967295,k.g[2]=k.g[2]+q&4294967295,k.g[3]=k.g[3]+K&4294967295}i.prototype.v=function(k,U){U===void 0&&(U=k.length);const V=U-this.blockSize,B=this.C;let q=this.h,K=0;for(;K<U;){if(q==0)for(;K<=V;)r(this,k,K),K+=this.blockSize;if(typeof k=="string"){for(;K<U;)if(B[q++]=k.charCodeAt(K++),q==this.blockSize){r(this,B),q=0;break}}else for(;K<U;)if(B[q++]=k[K++],q==this.blockSize){r(this,B),q=0;break}}this.h=q,this.o+=U},i.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var U=1;U<k.length-8;++U)k[U]=0;U=this.o*8;for(var V=k.length-8;V<k.length;++V)k[V]=U&255,U/=256;for(this.v(k),k=Array(16),U=0,V=0;V<4;++V)for(let B=0;B<32;B+=8)k[U++]=this.g[V]>>>B&255;return k};function u(k,U){var V=m;return Object.prototype.hasOwnProperty.call(V,k)?V[k]:V[k]=U(k)}function c(k,U){this.h=U;const V=[];let B=!0;for(let q=k.length-1;q>=0;q--){const K=k[q]|0;B&&K==U||(V[q]=K,B=!1)}this.g=V}var m={};function g(k){return-128<=k&&k<128?u(k,function(U){return new c([U|0],U<0?-1:0)}):new c([k|0],k<0?-1:0)}function p(k){if(isNaN(k)||!isFinite(k))return S;if(k<0)return Y(p(-k));const U=[];let V=1;for(let B=0;k>=V;B++)U[B]=k/V|0,V*=4294967296;return new c(U,0)}function x(k,U){if(k.length==0)throw Error("number format error: empty string");if(U=U||10,U<2||36<U)throw Error("radix out of range: "+U);if(k.charAt(0)=="-")return Y(x(k.substring(1),U));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const V=p(Math.pow(U,8));let B=S;for(let K=0;K<k.length;K+=8){var q=Math.min(8,k.length-K);const z=parseInt(k.substring(K,K+q),U);q<8?(q=p(Math.pow(U,q)),B=B.j(q).add(p(z))):(B=B.j(V),B=B.add(p(z)))}return B}var S=g(0),C=g(1),M=g(16777216);n=c.prototype,n.m=function(){if(H(this))return-Y(this).m();let k=0,U=1;for(let V=0;V<this.g.length;V++){const B=this.i(V);k+=(B>=0?B:4294967296+B)*U,U*=4294967296}return k},n.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(F(this))return"0";if(H(this))return"-"+Y(this).toString(k);const U=p(Math.pow(k,6));var V=this;let B="";for(;;){const q=Ee(V,U).g;V=ie(V,q.j(U));let K=((V.g.length>0?V.g[0]:V.h)>>>0).toString(k);if(V=q,F(V))return K+B;for(;K.length<6;)K="0"+K;B=K+B}},n.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function F(k){if(k.h!=0)return!1;for(let U=0;U<k.g.length;U++)if(k.g[U]!=0)return!1;return!0}function H(k){return k.h==-1}n.l=function(k){return k=ie(this,k),H(k)?-1:F(k)?0:1};function Y(k){const U=k.g.length,V=[];for(let B=0;B<U;B++)V[B]=~k.g[B];return new c(V,~k.h).add(C)}n.abs=function(){return H(this)?Y(this):this},n.add=function(k){const U=Math.max(this.g.length,k.g.length),V=[];let B=0;for(let q=0;q<=U;q++){let K=B+(this.i(q)&65535)+(k.i(q)&65535),z=(K>>>16)+(this.i(q)>>>16)+(k.i(q)>>>16);B=z>>>16,K&=65535,z&=65535,V[q]=z<<16|K}return new c(V,V[V.length-1]&-2147483648?-1:0)};function ie(k,U){return k.add(Y(U))}n.j=function(k){if(F(this)||F(k))return S;if(H(this))return H(k)?Y(this).j(Y(k)):Y(Y(this).j(k));if(H(k))return Y(this.j(Y(k)));if(this.l(M)<0&&k.l(M)<0)return p(this.m()*k.m());const U=this.g.length+k.g.length,V=[];for(var B=0;B<2*U;B++)V[B]=0;for(B=0;B<this.g.length;B++)for(let q=0;q<k.g.length;q++){const K=this.i(B)>>>16,z=this.i(B)&65535,Le=k.i(q)>>>16,Xe=k.i(q)&65535;V[2*B+2*q]+=z*Xe,re(V,2*B+2*q),V[2*B+2*q+1]+=K*Xe,re(V,2*B+2*q+1),V[2*B+2*q+1]+=z*Le,re(V,2*B+2*q+1),V[2*B+2*q+2]+=K*Le,re(V,2*B+2*q+2)}for(k=0;k<U;k++)V[k]=V[2*k+1]<<16|V[2*k];for(k=U;k<2*U;k++)V[k]=0;return new c(V,0)};function re(k,U){for(;(k[U]&65535)!=k[U];)k[U+1]+=k[U]>>>16,k[U]&=65535,U++}function ee(k,U){this.g=k,this.h=U}function Ee(k,U){if(F(U))throw Error("division by zero");if(F(k))return new ee(S,S);if(H(k))return U=Ee(Y(k),U),new ee(Y(U.g),Y(U.h));if(H(U))return U=Ee(k,Y(U)),new ee(Y(U.g),U.h);if(k.g.length>30){if(H(k)||H(U))throw Error("slowDivide_ only works with positive integers.");for(var V=C,B=U;B.l(k)<=0;)V=pe(V),B=pe(B);var q=J(V,1),K=J(B,1);for(B=J(B,2),V=J(V,2);!F(B);){var z=K.add(B);z.l(k)<=0&&(q=q.add(V),K=z),B=J(B,1),V=J(V,1)}return U=ie(k,q.j(U)),new ee(q,U)}for(q=S;k.l(U)>=0;){for(V=Math.max(1,Math.floor(k.m()/U.m())),B=Math.ceil(Math.log(V)/Math.LN2),B=B<=48?1:Math.pow(2,B-48),K=p(V),z=K.j(U);H(z)||z.l(k)>0;)V-=B,K=p(V),z=K.j(U);F(K)&&(K=C),q=q.add(K),k=ie(k,z)}return new ee(q,k)}n.B=function(k){return Ee(this,k).h},n.and=function(k){const U=Math.max(this.g.length,k.g.length),V=[];for(let B=0;B<U;B++)V[B]=this.i(B)&k.i(B);return new c(V,this.h&k.h)},n.or=function(k){const U=Math.max(this.g.length,k.g.length),V=[];for(let B=0;B<U;B++)V[B]=this.i(B)|k.i(B);return new c(V,this.h|k.h)},n.xor=function(k){const U=Math.max(this.g.length,k.g.length),V=[];for(let B=0;B<U;B++)V[B]=this.i(B)^k.i(B);return new c(V,this.h^k.h)};function pe(k){const U=k.g.length+1,V=[];for(let B=0;B<U;B++)V[B]=k.i(B)<<1|k.i(B-1)>>>31;return new c(V,k.h)}function J(k,U){const V=U>>5;U%=32;const B=k.g.length-V,q=[];for(let K=0;K<B;K++)q[K]=U>0?k.i(K+V)>>>U|k.i(K+V+1)<<32-U:k.i(K+V);return new c(q,k.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,OS=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=x,ra=c}).apply(typeof FE<"u"?FE:typeof self<"u"?self:typeof window<"u"?window:{});var ch=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var US,wc,zS,xh,Jp,BS,FS,qS;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof ch=="object"&&ch];for(var b=0;b<y.length;++b){var R=y[b];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var i=t(this);function r(y,b){if(b)e:{var R=i;y=y.split(".");for(var O=0;O<y.length-1;O++){var ne=y[O];if(!(ne in R))break e;R=R[ne]}y=y[y.length-1],O=R[y],b=b(O),b!=O&&b!=null&&e(R,y,{configurable:!0,writable:!0,value:b})}}r("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(y){return y||function(b){var R=[],O;for(O in b)Object.prototype.hasOwnProperty.call(b,O)&&R.push([O,b[O]]);return R}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},c=this||self;function m(y){var b=typeof y;return b=="object"&&y!=null||b=="function"}function g(y,b,R){return y.call.apply(y.bind,arguments)}function p(y,b,R){return p=g,p.apply(null,arguments)}function x(y,b){var R=Array.prototype.slice.call(arguments,1);return function(){var O=R.slice();return O.push.apply(O,arguments),y.apply(this,O)}}function S(y,b){function R(){}R.prototype=b.prototype,y.Z=b.prototype,y.prototype=new R,y.prototype.constructor=y,y.Ob=function(O,ne,ue){for(var Re=Array(arguments.length-2),et=2;et<arguments.length;et++)Re[et-2]=arguments[et];return b.prototype[ne].apply(O,Re)}}var C=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function M(y){const b=y.length;if(b>0){const R=Array(b);for(let O=0;O<b;O++)R[O]=y[O];return R}return[]}function F(y,b){for(let O=1;O<arguments.length;O++){const ne=arguments[O];var R=typeof ne;if(R=R!="object"?R:ne?Array.isArray(ne)?"array":R:"null",R=="array"||R=="object"&&typeof ne.length=="number"){R=y.length||0;const ue=ne.length||0;y.length=R+ue;for(let Re=0;Re<ue;Re++)y[R+Re]=ne[Re]}else y.push(ne)}}class H{constructor(b,R){this.i=b,this.j=R,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function Y(y){c.setTimeout(()=>{throw y},0)}function ie(){var y=k;let b=null;return y.g&&(b=y.g,y.g=y.g.next,y.g||(y.h=null),b.next=null),b}class re{constructor(){this.h=this.g=null}add(b,R){const O=ee.get();O.set(b,R),this.h?this.h.next=O:this.g=O,this.h=O}}var ee=new H(()=>new Ee,y=>y.reset());class Ee{constructor(){this.next=this.g=this.h=null}set(b,R){this.h=b,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let pe,J=!1,k=new re,U=()=>{const y=Promise.resolve(void 0);pe=()=>{y.then(V)}};function V(){for(var y;y=ie();){try{y.h.call(y.g)}catch(R){Y(R)}var b=ee;b.j(y),b.h<100&&(b.h++,y.next=b.g,b.g=y)}J=!1}function B(){this.u=this.u,this.C=this.C}B.prototype.u=!1,B.prototype.dispose=function(){this.u||(this.u=!0,this.N())},B.prototype[Symbol.dispose]=function(){this.dispose()},B.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(y,b){this.type=y,this.g=this.target=b,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var K=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var y=!1,b=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const R=()=>{};c.addEventListener("test",R,b),c.removeEventListener("test",R,b)}catch{}return y})();function z(y){return/^[\s\xa0]*$/.test(y)}function Le(y,b){q.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,b)}S(Le,q),Le.prototype.init=function(y,b){const R=this.type=y.type,O=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=b,b=y.relatedTarget,b||(R=="mouseover"?b=y.fromElement:R=="mouseout"&&(b=y.toElement)),this.relatedTarget=b,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&Le.Z.h.call(this)},Le.prototype.h=function(){Le.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var Xe="closure_listenable_"+(Math.random()*1e6|0),te=0;function Se(y,b,R,O,ne){this.listener=y,this.proxy=null,this.src=b,this.type=R,this.capture=!!O,this.ha=ne,this.key=++te,this.da=this.fa=!1}function Ae(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function We(y,b,R){for(const O in y)b.call(R,y[O],O,y)}function Ne(y,b){for(const R in y)b.call(void 0,y[R],R,y)}function j(y){const b={};for(const R in y)b[R]=y[R];return b}const he="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function be(y,b){let R,O;for(let ne=1;ne<arguments.length;ne++){O=arguments[ne];for(R in O)y[R]=O[R];for(let ue=0;ue<he.length;ue++)R=he[ue],Object.prototype.hasOwnProperty.call(O,R)&&(y[R]=O[R])}}function ce(y){this.src=y,this.g={},this.h=0}ce.prototype.add=function(y,b,R,O,ne){const ue=y.toString();y=this.g[ue],y||(y=this.g[ue]=[],this.h++);const Re=Ce(y,b,O,ne);return Re>-1?(b=y[Re],R||(b.fa=!1)):(b=new Se(b,this.src,ue,!!O,ne),b.fa=R,y.push(b)),b};function me(y,b){const R=b.type;if(R in y.g){var O=y.g[R],ne=Array.prototype.indexOf.call(O,b,void 0),ue;(ue=ne>=0)&&Array.prototype.splice.call(O,ne,1),ue&&(Ae(b),y.g[R].length==0&&(delete y.g[R],y.h--))}}function Ce(y,b,R,O){for(let ne=0;ne<y.length;++ne){const ue=y[ne];if(!ue.da&&ue.listener==b&&ue.capture==!!R&&ue.ha==O)return ne}return-1}var _e="closure_lm_"+(Math.random()*1e6|0),Pe={};function ke(y,b,R,O,ne){if(Array.isArray(b)){for(let ue=0;ue<b.length;ue++)ke(y,b[ue],R,O,ne);return null}return R=vn(R),y&&y[Xe]?y.J(b,R,m(O)?!!O.capture:!1,ne):Je(y,b,R,!1,O,ne)}function Je(y,b,R,O,ne,ue){if(!b)throw Error("Invalid event type");const Re=m(ne)?!!ne.capture:!!ne;let et=ei(y);if(et||(y[_e]=et=new ce(y)),R=et.add(b,R,O,Re,ue),R.proxy)return R;if(O=wt(),R.proxy=O,O.src=y,O.listener=R,y.addEventListener)K||(ne=Re),ne===void 0&&(ne=!1),y.addEventListener(b.toString(),O,ne);else if(y.attachEvent)y.attachEvent(fn(b.toString()),O);else if(y.addListener&&y.removeListener)y.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return R}function wt(){function y(R){return b.call(y.src,y.listener,R)}const b=mi;return y}function Ze(y,b,R,O,ne){if(Array.isArray(b))for(var ue=0;ue<b.length;ue++)Ze(y,b[ue],R,O,ne);else O=m(O)?!!O.capture:!!O,R=vn(R),y&&y[Xe]?(y=y.i,ue=String(b).toString(),ue in y.g&&(b=y.g[ue],R=Ce(b,R,O,ne),R>-1&&(Ae(b[R]),Array.prototype.splice.call(b,R,1),b.length==0&&(delete y.g[ue],y.h--)))):y&&(y=ei(y))&&(b=y.g[b.toString()],y=-1,b&&(y=Ce(b,R,O,ne)),(R=y>-1?b[y]:null)&&Jt(R))}function Jt(y){if(typeof y!="number"&&y&&!y.da){var b=y.src;if(b&&b[Xe])me(b.i,y);else{var R=y.type,O=y.proxy;b.removeEventListener?b.removeEventListener(R,O,y.capture):b.detachEvent?b.detachEvent(fn(R),O):b.addListener&&b.removeListener&&b.removeListener(O),(R=ei(b))?(me(R,y),R.h==0&&(R.src=null,b[_e]=null)):Ae(y)}}}function fn(y){return y in Pe?Pe[y]:Pe[y]="on"+y}function mi(y,b){if(y.da)y=!0;else{b=new Le(b,this);const R=y.listener,O=y.ha||y.src;y.fa&&Jt(y),y=R.call(O,b)}return y}function ei(y){return y=y[_e],y instanceof ce?y:null}var pi="__closure_events_fn_"+(Math.random()*1e9>>>0);function vn(y){return typeof y=="function"?y:(y[pi]||(y[pi]=function(b){return y.handleEvent(b)}),y[pi])}function jt(){B.call(this),this.i=new ce(this),this.M=this,this.G=null}S(jt,B),jt.prototype[Xe]=!0,jt.prototype.removeEventListener=function(y,b,R,O){Ze(this,y,b,R,O)};function ye(y,b){var R,O=y.G;if(O)for(R=[];O;O=O.G)R.push(O);if(y=y.M,O=b.type||b,typeof b=="string")b=new q(b,y);else if(b instanceof q)b.target=b.target||y;else{var ne=b;b=new q(O,y),be(b,ne)}ne=!0;let ue,Re;if(R)for(Re=R.length-1;Re>=0;Re--)ue=b.g=R[Re],ne=qe(ue,O,!0,b)&&ne;if(ue=b.g=y,ne=qe(ue,O,!0,b)&&ne,ne=qe(ue,O,!1,b)&&ne,R)for(Re=0;Re<R.length;Re++)ue=b.g=R[Re],ne=qe(ue,O,!1,b)&&ne}jt.prototype.N=function(){if(jt.Z.N.call(this),this.i){var y=this.i;for(const b in y.g){const R=y.g[b];for(let O=0;O<R.length;O++)Ae(R[O]);delete y.g[b],y.h--}}this.G=null},jt.prototype.J=function(y,b,R,O){return this.i.add(String(y),b,!1,R,O)},jt.prototype.K=function(y,b,R,O){return this.i.add(String(y),b,!0,R,O)};function qe(y,b,R,O){if(b=y.i.g[String(b)],!b)return!0;b=b.concat();let ne=!0;for(let ue=0;ue<b.length;++ue){const Re=b[ue];if(Re&&!Re.da&&Re.capture==R){const et=Re.listener,St=Re.ha||Re.src;Re.fa&&me(y.i,Re),ne=et.call(St,O)!==!1&&ne}}return ne&&!O.defaultPrevented}function Qe(y,b){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=p(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:c.setTimeout(y,b||0)}function Dt(y){y.g=Qe(()=>{y.g=null,y.i&&(y.i=!1,Dt(y))},y.l);const b=y.h;y.h=null,y.m.apply(null,b)}class dt extends B{constructor(b,R){super(),this.m=b,this.l=R,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Dt(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function an(y){B.call(this),this.h=y,this.g={}}S(an,B);var gi=[];function _i(y){We(y.g,function(b,R){this.g.hasOwnProperty(R)&&Jt(b)},y),y.g={}}an.prototype.N=function(){an.Z.N.call(this),_i(this)},an.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ie=c.JSON.stringify,ut=c.JSON.parse,Vt=class{stringify(y){return c.JSON.stringify(y,void 0)}parse(y){return c.JSON.parse(y,void 0)}};function ln(){}function Si(){}var Tn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ot(){q.call(this,"d")}S(Ot,q);function Dn(){q.call(this,"c")}S(Dn,q);var Qt={},Gi=null;function ks(){return Gi=Gi||new jt}Qt.Ia="serverreachability";function ds(y){q.call(this,Qt.Ia,y)}S(ds,q);function ji(y){const b=ks();ye(b,new ds(b))}Qt.STAT_EVENT="statevent";function so(y,b){q.call(this,Qt.STAT_EVENT,y),this.stat=b}S(so,q);function un(y){const b=ks();ye(b,new so(b,y))}Qt.Ja="timingevent";function hs(y,b){q.call(this,Qt.Ja,y),this.size=b}S(hs,q);function fs(y,b){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){y()},b)}function Ki(){this.g=!0}Ki.prototype.ua=function(){this.g=!1};function Du(y,b,R,O,ne,ue){y.info(function(){if(y.g)if(ue){var Re="",et=ue.split("&");for(let At=0;At<et.length;At++){var St=et[At].split("=");if(St.length>1){const Zt=St[0];St=St[1];const Pi=Zt.split("_");Re=Pi.length>=2&&Pi[1]=="type"?Re+(Zt+"="+St+"&"):Re+(Zt+"=redacted&")}}}else Re=null;else Re=ue;return"XMLHTTP REQ ("+O+") [attempt "+ne+"]: "+b+`
`+R+`
`+Re})}function pl(y,b,R,O,ne,ue,Re){y.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+ne+"]: "+b+`
`+R+`
`+ue+" "+Re})}function ms(y,b,R,O){y.info(function(){return"XMLHTTP TEXT ("+b+"): "+Lu(y,R)+(O?" "+O:"")})}function Ds(y,b){y.info(function(){return"TIMEOUT: "+b})}Ki.prototype.info=function(){};function Lu(y,b){if(!y.g)return b;if(!b)return null;try{const ue=JSON.parse(b);if(ue){for(y=0;y<ue.length;y++)if(Array.isArray(ue[y])){var R=ue[y];if(!(R.length<2)){var O=R[1];if(Array.isArray(O)&&!(O.length<1)){var ne=O[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(let Re=1;Re<O.length;Re++)O[Re]=""}}}}return Ie(ue)}catch{return b}}var Mo={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ya={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},va;function Un(){}S(Un,ln),Un.prototype.g=function(){return new XMLHttpRequest},va=new Un;function ze(y){return encodeURIComponent(String(y))}function Ta(y){var b=1;y=y.split(":");const R=[];for(;b>0&&y.length;)R.push(y.shift()),b--;return y.length&&R.push(y.join(":")),R}function Ai(y,b,R,O){this.j=y,this.i=b,this.l=R,this.S=O||1,this.V=new an(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ci}function Ci(){this.i=null,this.g="",this.h=!1}var cn={},mn={};function Zi(y,b,R){y.M=1,y.A=Ut(Xt(b)),y.u=R,y.R=!0,Yi(y,null)}function Yi(y,b){y.F=Date.now(),ps(y),y.B=Xt(y.A);var R=y.B,O=y.S;Array.isArray(O)||(O=[String(O)]),ro(R.i,"t",O),y.C=0,R=y.j.L,y.h=new Ci,y.g=ba(y.j,R?b:null,!y.u),y.P>0&&(y.O=new dt(p(y.Y,y,y.g),y.P)),b=y.V,R=y.g,O=y.ba;var ne="readystatechange";Array.isArray(ne)||(ne&&(gi[0]=ne.toString()),ne=gi);for(let ue=0;ue<ne.length;ue++){const Re=ke(R,ne[ue],O||b.handleEvent,!1,b.h||b);if(!Re)break;b.g[Re.key]=Re}b=y.J?j(y.J):{},y.u?(y.v||(y.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,b)):(y.v="GET",y.g.ea(y.B,y.v,null,b)),ji(),Du(y.i,y.v,y.B,y.l,y.S,y.u)}Ai.prototype.ba=function(y){y=y.target;const b=this.O;b&&$i(y)==3?b.j():this.Y(y)},Ai.prototype.Y=function(y){try{if(y==this.g)e:{const et=$i(this.g),St=this.g.ya(),At=this.g.ca();if(!(et<3)&&(et!=3||this.g&&(this.h.h||this.g.la()||An(this.g)))){this.K||et!=4||St==7||(St==8||At<=0?ji(3):ji(2)),Wi(this);var b=this.g.ca();this.X=b;var R=gl(this);if(this.o=b==200,pl(this.i,this.v,this.B,this.l,this.S,et,b),this.o){if(this.U&&!this.L){t:{if(this.g){var O,ne=this.g;if((O=ne.g?ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(O)){var ue=O;break t}}ue=null}if(y=ue)ms(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,gs(this,y);else{this.o=!1,this.m=3,un(12),zn(this),bi(this);break e}}if(this.R){y=!0;let Zt;for(;!this.K&&this.C<R.length;)if(Zt=yl(this,R),Zt==mn){et==4&&(this.m=4,un(14),y=!1),ms(this.i,this.l,null,"[Incomplete Response]");break}else if(Zt==cn){this.m=4,un(15),ms(this.i,this.l,R,"[Invalid Chunk]"),y=!1;break}else ms(this.i,this.l,Zt,null),gs(this,Zt);if(_l(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),et!=4||R.length!=0||this.h.h||(this.m=1,un(16),y=!1),this.o=this.o&&y,!y)ms(this.i,this.l,R,"[Invalid Chunked Response]"),zn(this),bi(this);else if(R.length>0&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.aa&&!Re.P&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),Aa(Re),Re.P=!0,un(11))}}else ms(this.i,this.l,R,null),gs(this,R);et==4&&zn(this),this.o&&!this.K&&(et==4?Ti(this.j,this):(this.o=!1,ps(this)))}else Xi(this.g),b==400&&R.indexOf("Unknown SID")>0?(this.m=3,un(12)):(this.m=0,un(13)),zn(this),bi(this)}}}catch{}finally{}};function gl(y){if(!_l(y))return y.g.la();const b=An(y.g);if(b==="")return"";let R="";const O=b.length,ne=$i(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return zn(y),bi(y),"";y.h.i=new c.TextDecoder}for(let ue=0;ue<O;ue++)y.h.h=!0,R+=y.h.i.decode(b[ue],{stream:!(ne&&ue==O-1)});return b.length=0,y.h.g+=R,y.C=0,y.h.g}function _l(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function yl(y,b){var R=y.C,O=b.indexOf(`
`,R);return O==-1?mn:(R=Number(b.substring(R,O)),isNaN(R)?cn:(O+=1,O+R>b.length?mn:(b=b.slice(O,O+R),y.C=O+R,b)))}Ai.prototype.cancel=function(){this.K=!0,zn(this)};function ps(y){y.T=Date.now()+y.H,mr(y,y.H)}function mr(y,b){if(y.D!=null)throw Error("WatchDog timer not null");y.D=fs(p(y.aa,y),b)}function Wi(y){y.D&&(c.clearTimeout(y.D),y.D=null)}Ai.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(Ds(this.i,this.B),this.M!=2&&(ji(),un(17)),zn(this),this.m=2,bi(this)):mr(this,this.T-y)};function bi(y){y.j.I==0||y.K||Ti(y.j,y)}function zn(y){Wi(y);var b=y.O;b&&typeof b.dispose=="function"&&b.dispose(),y.O=null,_i(y.V),y.g&&(b=y.g,y.g=null,b.abort(),b.dispose())}function gs(y,b){try{var R=y.j;if(R.I!=0&&(R.g==y||Ii(R.h,y))){if(!y.L&&Ii(R.h,y)&&R.I==3){try{var O=R.Ba.g.parse(b)}catch{O=null}if(Array.isArray(O)&&O.length==3){var ne=O;if(ne[0]==0){e:if(!R.v){if(R.g)if(R.g.F+3e3<y.F)Er(R),co(R);else break e;Oo(R),un(18)}}else R.xa=ne[1],0<R.xa-R.K&&ne[2]<37500&&R.F&&R.A==0&&!R.C&&(R.C=fs(p(R.Va,R),6e3));_s(R.h)<=1&&R.ta&&(R.ta=void 0)}else es(R,11)}else if((y.L||R.g==y)&&Er(R),!z(b))for(ne=R.Ba.g.parse(b),b=0;b<ne.length;b++){let At=ne[b];const Zt=At[0];if(!(Zt<=R.K))if(R.K=Zt,At=At[1],R.I==2)if(At[0]=="c"){R.M=At[1],R.ba=At[2];const Pi=At[3];Pi!=null&&(R.ka=Pi,R.j.info("VER="+R.ka));const ki=At[4];ki!=null&&(R.za=ki,R.j.info("SVER="+R.za));const Ei=At[5];Ei!=null&&typeof Ei=="number"&&Ei>0&&(O=1.5*Ei,R.O=O,R.j.info("backChannelRequestTimeoutMs_="+O)),O=R;const ns=y.g;if(ns){const Uo=ns.g?ns.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Uo){var ue=O.h;ue.g||Uo.indexOf("spdy")==-1&&Uo.indexOf("quic")==-1&&Uo.indexOf("h2")==-1||(ue.j=ue.l,ue.g=new Set,ue.h&&(Ls(ue,ue.h),ue.h=null))}if(O.G){const zo=ns.g?ns.g.getResponseHeader("X-HTTP-Session-Id"):null;zo&&(O.wa=zo,Ve(O.J,O.G,zo))}}R.I=3,R.l&&R.l.ra(),R.aa&&(R.T=Date.now()-y.F,R.j.info("Handshake RTT: "+R.T+"ms")),O=R;var Re=y;if(O.na=Ca(O,O.L?O.ba:null,O.W),Re.L){pr(O.h,Re);var et=Re,St=O.O;St&&(et.H=St),et.D&&(Wi(et),ps(et)),O.g=Re}else Sa(O);R.i.length>0&&si(R)}else At[0]!="stop"&&At[0]!="close"||es(R,7);else R.I==3&&(At[0]=="stop"||At[0]=="close"?At[0]=="stop"?es(R,7):ct(R):At[0]!="noop"&&R.l&&R.l.qa(At),R.A=0)}}ji(4)}catch{}}var pn=class{constructor(y,b){this.g=y,this.map=b}};function Ea(y){this.l=y||10,c.PerformanceNavigationTiming?(y=c.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function xa(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function _s(y){return y.h?1:y.g?y.g.size:0}function Ii(y,b){return y.h?y.h==b:y.g?y.g.has(b):!1}function Ls(y,b){y.g?y.g.add(b):y.h=b}function pr(y,b){y.h&&y.h==b?y.h=null:y.g&&y.g.has(b)&&y.g.delete(b)}Ea.prototype.cancel=function(){if(this.i=gr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function gr(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let b=y.i;for(const R of y.g.values())b=b.concat(R.G);return b}return M(y.i)}var oo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ht(y,b){if(y){y=y.split("&");for(let R=0;R<y.length;R++){const O=y[R].indexOf("=");let ne,ue=null;O>=0?(ne=y[R].substring(0,O),ue=y[R].substring(O+1)):ne=y[R],b(ne,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function ft(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;y instanceof ft?(this.l=y.l,en(this,y.j),this.o=y.o,this.g=y.g,yi(this,y.u),this.h=y.h,Po(this,Lo(y.i)),this.m=y.m):y&&(b=String(y).match(oo))?(this.l=!1,en(this,b[1]||"",!0),this.o=Ni(b[2]||""),this.g=Ni(b[3]||"",!0),yi(this,b[4]),this.h=Ni(b[5]||"",!0),Po(this,b[6]||"",!0),this.m=Ni(b[7]||"")):(this.l=!1,this.i=new Ri(null,this.l))}ft.prototype.toString=function(){const y=[];var b=this.j;b&&y.push(ys(b,_r,!0),":");var R=this.g;return(R||b=="file")&&(y.push("//"),(b=this.o)&&y.push(ys(b,_r,!0),"@"),y.push(ze(R).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.u,R!=null&&y.push(":",String(R))),(R=this.h)&&(this.g&&R.charAt(0)!="/"&&y.push("/"),y.push(ys(R,R.charAt(0)=="/"?Ji:ko,!0))),(R=this.i.toString())&&y.push("?",R),(R=this.m)&&y.push("#",ys(R,vs)),y.join("")},ft.prototype.resolve=function(y){const b=Xt(this);let R=!!y.j;R?en(b,y.j):R=!!y.o,R?b.o=y.o:R=!!y.g,R?b.g=y.g:R=y.u!=null;var O=y.h;if(R)yi(b,y.u);else if(R=!!y.h){if(O.charAt(0)!="/")if(this.g&&!this.h)O="/"+O;else{var ne=b.h.lastIndexOf("/");ne!=-1&&(O=b.h.slice(0,ne+1)+O)}if(ne=O,ne==".."||ne==".")O="";else if(ne.indexOf("./")!=-1||ne.indexOf("/.")!=-1){O=ne.lastIndexOf("/",0)==0,ne=ne.split("/");const ue=[];for(let Re=0;Re<ne.length;){const et=ne[Re++];et=="."?O&&Re==ne.length&&ue.push(""):et==".."?((ue.length>1||ue.length==1&&ue[0]!="")&&ue.pop(),O&&Re==ne.length&&ue.push("")):(ue.push(et),O=!0)}O=ue.join("/")}else O=ne}return R?b.h=O:R=y.i.toString()!=="",R?Po(b,Lo(y.i)):R=!!y.m,R&&(b.m=y.m),b};function Xt(y){return new ft(y)}function en(y,b,R){y.j=R?Ni(b,!0):b,y.j&&(y.j=y.j.replace(/:$/,""))}function yi(y,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);y.u=b}else y.u=null}function Po(y,b,R){b instanceof Ri?(y.i=b,ao(y.i,y.l)):(R||(b=ys(b,zt)),y.i=new Ri(b,y.l))}function Ve(y,b,R){y.i.set(b,R)}function Ut(y){return Ve(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function Ni(y,b){return y?b?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function ys(y,b,R){return typeof y=="string"?(y=encodeURI(y).replace(b,Kt),R&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Kt(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var _r=/[#\/\?@]/g,ko=/[#\?:]/g,Ji=/[#\?]/g,zt=/[#\?@]/g,vs=/#/g;function Ri(y,b){this.h=this.g=null,this.i=y||null,this.j=!!b}function Sn(y){y.g||(y.g=new Map,y.h=0,y.i&&ht(y.i,function(b,R){y.add(decodeURIComponent(b.replace(/\+/g," ")),R)}))}n=Ri.prototype,n.add=function(y,b){Sn(this),this.i=null,y=Ts(this,y);let R=this.g.get(y);return R||this.g.set(y,R=[]),R.push(b),this.h+=1,this};function yr(y,b){Sn(y),b=Ts(y,b),y.g.has(b)&&(y.i=null,y.h-=y.g.get(b).length,y.g.delete(b))}function Vs(y,b){return Sn(y),b=Ts(y,b),y.g.has(b)}n.forEach=function(y,b){Sn(this),this.g.forEach(function(R,O){R.forEach(function(ne){y.call(b,ne,O,this)},this)},this)};function Do(y,b){Sn(y);let R=[];if(typeof b=="string")Vs(y,b)&&(R=R.concat(y.g.get(Ts(y,b))));else for(y=Array.from(y.g.values()),b=0;b<y.length;b++)R=R.concat(y[b]);return R}n.set=function(y,b){return Sn(this),this.i=null,y=Ts(this,y),Vs(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[b]),this.h+=1,this},n.get=function(y,b){return y?(y=Do(this,y),y.length>0?String(y[0]):b):b};function ro(y,b,R){yr(y,b),R.length>0&&(y.i=null,y.g.set(Ts(y,b),M(R)),y.h+=R.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],b=Array.from(this.g.keys());for(let O=0;O<b.length;O++){var R=b[O];const ne=ze(R);R=Do(this,R);for(let ue=0;ue<R.length;ue++){let Re=ne;R[ue]!==""&&(Re+="="+ze(R[ue])),y.push(Re)}}return this.i=y.join("&")};function Lo(y){const b=new Ri;return b.i=y.i,y.g&&(b.g=new Map(y.g),b.h=y.h),b}function Ts(y,b){return b=String(b),y.j&&(b=b.toLowerCase()),b}function ao(y,b){b&&!y.j&&(Sn(y),y.i=null,y.g.forEach(function(R,O){const ne=O.toLowerCase();O!=ne&&(yr(this,O),ro(this,ne,R))},y)),y.j=b}function ti(y,b){const R=new Ki;if(c.Image){const O=new Image;O.onload=x(ni,R,"TestLoadImage: loaded",!0,b,O),O.onerror=x(ni,R,"TestLoadImage: error",!1,b,O),O.onabort=x(ni,R,"TestLoadImage: abort",!1,b,O),O.ontimeout=x(ni,R,"TestLoadImage: timeout",!1,b,O),c.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=y}else b(!1)}function vr(y,b){const R=new Ki,O=new AbortController,ne=setTimeout(()=>{O.abort(),ni(R,"TestPingServer: timeout",!1,b)},1e4);fetch(y,{signal:O.signal}).then(ue=>{clearTimeout(ne),ue.ok?ni(R,"TestPingServer: ok",!0,b):ni(R,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ne),ni(R,"TestPingServer: error",!1,b)})}function ni(y,b,R,O,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),O(R)}catch{}}function lo(){this.g=new Vt}function Ke(y){this.i=y.Sb||null,this.h=y.ab||!1}S(Ke,ln),Ke.prototype.g=function(){return new Bn(this.i,this.h)};function Bn(y,b){jt.call(this),this.H=y,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}S(Bn,jt),n=Bn.prototype,n.open=function(y,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=b,this.readyState=1,vi(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(b.body=y),(this.H||c).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Os(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,vi(this)),this.g&&(this.readyState=3,vi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;bt(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function bt(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var b=y.value?y.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!y.done}))&&(this.response=this.responseText+=b)}y.done?Os(this):vi(this),this.readyState==3&&bt(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,Os(this))},n.Na=function(y){this.g&&(this.response=y,Os(this))},n.ga=function(){this.g&&Os(this)};function Os(y){y.readyState=4,y.l=null,y.j=null,y.B=null,vi(y)}n.setRequestHeader=function(y,b){this.A.append(y,b)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],b=this.h.entries();for(var R=b.next();!R.done;)R=R.value,y.push(R[0]+": "+R[1]),R=b.next();return y.join(`\r
`)};function vi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Bn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function ii(y){let b="";return We(y,function(R,O){b+=O,b+=":",b+=R,b+=`\r
`}),b}function Us(y,b,R){e:{for(O in R){var O=!1;break e}O=!0}O||(R=ii(R),typeof y=="string"?R!=null&&ze(R):Ve(y,b,R))}function _t(y){jt.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}S(_t,jt);var Mi=/^https?$/i,zs=["POST","PUT"];n=_t.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,b,R,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);b=b?b.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():va.g(),this.g.onreadystatechange=C(p(this.Ca,this));try{this.B=!0,this.g.open(b,String(y),!0),this.B=!1}catch(ue){tn(this,ue);return}if(y=R||"",R=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var ne in O)R.set(ne,O[ne]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const ue of O.keys())R.set(ue,O.get(ue));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(R.keys()).find(ue=>ue.toLowerCase()=="content-type"),ne=c.FormData&&y instanceof c.FormData,!(Array.prototype.indexOf.call(zs,b,void 0)>=0)||O||ne||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ue,Re]of R)this.g.setRequestHeader(ue,Re);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(ue){tn(this,ue)}};function tn(y,b){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=b,y.o=5,Qi(y),Es(y)}function Qi(y){y.A||(y.A=!0,ye(y,"complete"),ye(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,ye(this,"complete"),ye(this,"abort"),Es(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Es(this,!0)),_t.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?uo(this):this.Xa())},n.Xa=function(){uo(this)};function uo(y){if(y.h&&typeof u<"u"){if(y.v&&$i(y)==4)setTimeout(y.Ca.bind(y),0);else if(ye(y,"readystatechange"),$i(y)==4){y.h=!1;try{const ue=y.ca();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var R;if(!(R=b)){var O;if(O=ue===0){let Re=String(y.D).match(oo)[1]||null;!Re&&c.self&&c.self.location&&(Re=c.self.location.protocol.slice(0,-1)),O=!Mi.test(Re?Re.toLowerCase():"")}R=O}if(R)ye(y,"complete"),ye(y,"success");else{y.o=6;try{var ne=$i(y)>2?y.g.statusText:""}catch{ne=""}y.l=ne+" ["+y.ca()+"]",Qi(y)}}finally{Es(y)}}}}function Es(y,b){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const R=y.g;y.g=null,b||ye(y,"ready");try{R.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function $i(y){return y.g?y.g.readyState:0}n.ca=function(){try{return $i(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var b=this.g.responseText;return y&&b.indexOf(y)==0&&(b=b.substring(y.length)),ut(b)}};function An(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function Xi(y){const b={};y=(y.g&&$i(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<y.length;O++){if(z(y[O]))continue;var R=Ta(y[O]);const ne=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const ue=b[ne]||[];b[ne]=ue,ue.push(R)}Ne(b,function(O){return O.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function xs(y,b,R){return R&&R.internalChannelParams&&R.internalChannelParams[y]||b}function Bs(y){this.za=0,this.i=[],this.j=new Ki,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=xs("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=xs("baseRetryDelayMs",5e3,y),this.Za=xs("retryDelaySeedMs",1e4,y),this.Ta=xs("forwardChannelMaxRetries",2,y),this.va=xs("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new Ea(y&&y.concurrentRequestLimit),this.Ba=new lo,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Bs.prototype,n.ka=8,n.I=1,n.connect=function(y,b,R,O){un(0),this.W=y,this.H=b||{},R&&O!==void 0&&(this.H.OSID=R,this.H.OAID=O),this.F=this.X,this.J=Ca(this,null,this.W),si(this)};function ct(y){if(Fn(y),y.I==3){var b=y.V++,R=Xt(y.J);if(Ve(R,"SID",y.M),Ve(R,"RID",b),Ve(R,"TYPE","terminate"),Fs(y,R),b=new Ai(y,y.j,b),b.M=2,b.A=Ut(Xt(R)),R=!1,c.navigator&&c.navigator.sendBeacon)try{R=c.navigator.sendBeacon(b.A.toString(),"")}catch{}!R&&c.Image&&(new Image().src=b.A,R=!0),R||(b.g=ba(b.j,null),b.g.ea(b.A)),b.F=Date.now(),ps(b)}ts(y)}function co(y){y.g&&(Aa(y),y.g.cancel(),y.g=null)}function Fn(y){co(y),y.v&&(c.clearTimeout(y.v),y.v=null),Er(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&c.clearTimeout(y.m),y.m=null)}function si(y){if(!xa(y.h)&&!y.m){y.m=!0;var b=y.Ea;pe||U(),J||(pe(),J=!0),k.add(b,y),y.D=0}}function Vo(y,b){return _s(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=b.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=fs(p(y.Ea,y,b),Tl(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const ne=new Ai(this,this.j,y);let ue=this.o;if(this.U&&(ue?(ue=j(ue),be(ue,this.U)):ue=this.U),this.u!==null||this.R||(ne.J=ue,ue=null),this.S)e:{for(var b=0,R=0;R<this.i.length;R++){t:{var O=this.i[R];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(b+=O,b>4096){b=R;break e}if(b===4096||R===this.i.length-1){b=R+1;break e}}b=1e3}else b=1e3;b=vl(this,ne,b),R=Xt(this.J),Ve(R,"RID",y),Ve(R,"CVER",22),this.G&&Ve(R,"X-HTTP-Session-Id",this.G),Fs(this,R),ue&&(this.R?b="headers="+ze(ii(ue))+"&"+b:this.u&&Us(R,this.u,ue)),Ls(this.h,ne),this.Ra&&Ve(R,"TYPE","init"),this.S?(Ve(R,"$req",b),Ve(R,"SID","null"),ne.U=!0,Zi(ne,R,null)):Zi(ne,R,b),this.I=2}}else this.I==3&&(y?wa(this,y):this.i.length==0||xa(this.h)||wa(this))};function wa(y,b){var R;b?R=b.l:R=y.V++;const O=Xt(y.J);Ve(O,"SID",y.M),Ve(O,"RID",R),Ve(O,"AID",y.K),Fs(y,O),y.u&&y.o&&Us(O,y.u,y.o),R=new Ai(y,y.j,R,y.D+1),y.u===null&&(R.J=y.o),b&&(y.i=b.G.concat(y.i)),b=vl(y,R,1e3),R.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Ls(y.h,R),Zi(R,O,b)}function Fs(y,b){y.H&&We(y.H,function(R,O){Ve(b,O,R)}),y.l&&We({},function(R,O){Ve(b,O,R)})}function vl(y,b,R){R=Math.min(y.i.length,R);const O=y.l?p(y.l.Ka,y.l,y):null;e:{var ne=y.i;let et=-1;for(;;){const St=["count="+R];et==-1?R>0?(et=ne[0].g,St.push("ofs="+et)):et=0:St.push("ofs="+et);let At=!0;for(let Zt=0;Zt<R;Zt++){var ue=ne[Zt].g;const Pi=ne[Zt].map;if(ue-=et,ue<0)et=Math.max(0,ne[Zt].g-100),At=!1;else try{ue="req"+ue+"_"||"";try{var Re=Pi instanceof Map?Pi:Object.entries(Pi);for(const[ki,Ei]of Re){let ns=Ei;m(Ei)&&(ns=Ie(Ei)),St.push(ue+ki+"="+encodeURIComponent(ns))}}catch(ki){throw St.push(ue+"type="+encodeURIComponent("_badmap")),ki}}catch{O&&O(Pi)}}if(At){Re=St.join("&");break e}}Re=void 0}return y=y.i.splice(0,R),b.G=y,Re}function Sa(y){if(!y.g&&!y.v){y.Y=1;var b=y.Da;pe||U(),J||(pe(),J=!0),k.add(b,y),y.A=0}}function Oo(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=fs(p(y.Da,y),Tl(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,Tr(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=fs(p(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,un(10),co(this),Tr(this))};function Aa(y){y.B!=null&&(c.clearTimeout(y.B),y.B=null)}function Tr(y){y.g=new Ai(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var b=Xt(y.na);Ve(b,"RID","rpc"),Ve(b,"SID",y.M),Ve(b,"AID",y.K),Ve(b,"CI",y.F?"0":"1"),!y.F&&y.ia&&Ve(b,"TO",y.ia),Ve(b,"TYPE","xmlhttp"),Fs(y,b),y.u&&y.o&&Us(b,y.u,y.o),y.O&&(y.g.H=y.O);var R=y.g;y=y.ba,R.M=1,R.A=Ut(Xt(b)),R.u=null,R.R=!0,Yi(R,y)}n.Va=function(){this.C!=null&&(this.C=null,co(this),Oo(this),un(19))};function Er(y){y.C!=null&&(c.clearTimeout(y.C),y.C=null)}function Ti(y,b){var R=null;if(y.g==b){Er(y),Aa(y),y.g=null;var O=2}else if(Ii(y.h,b))R=b.G,pr(y.h,b),O=1;else return;if(y.I!=0){if(b.o)if(O==1){R=b.u?b.u.length:0,b=Date.now()-b.F;var ne=y.D;O=ks(),ye(O,new hs(O,R)),si(y)}else Sa(y);else if(ne=b.m,ne==3||ne==0&&b.X>0||!(O==1&&Vo(y,b)||O==2&&Oo(y)))switch(R&&R.length>0&&(b=y.h,b.i=b.i.concat(R)),ne){case 1:es(y,5);break;case 4:es(y,10);break;case 3:es(y,6);break;default:es(y,2)}}}function Tl(y,b){let R=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(R*=2),R*b}function es(y,b){if(y.j.info("Error code "+b),b==2){var R=p(y.bb,y),O=y.Ua;const ne=!O;O=new ft(O||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||en(O,"https"),Ut(O),ne?ti(O.toString(),R):vr(O.toString(),R)}else un(2);y.I=0,y.l&&y.l.pa(b),ts(y),Fn(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),un(2)):(this.j.info("Failed to ping google.com"),un(1))};function ts(y){if(y.I=0,y.ja=[],y.l){const b=gr(y.h);(b.length!=0||y.i.length!=0)&&(F(y.ja,b),F(y.ja,y.i),y.h.i.length=0,M(y.i),y.i.length=0),y.l.oa()}}function Ca(y,b,R){var O=R instanceof ft?Xt(R):new ft(R);if(O.g!="")b&&(O.g=b+"."+O.g),yi(O,O.u);else{var ne=c.location;O=ne.protocol,b=b?b+"."+ne.hostname:ne.hostname,ne=+ne.port;const ue=new ft(null);O&&en(ue,O),b&&(ue.g=b),ne&&yi(ue,ne),R&&(ue.h=R),O=ue}return R=y.G,b=y.wa,R&&b&&Ve(O,R,b),Ve(O,"VER",y.ka),Fs(y,O),O}function ba(y,b,R){if(b&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=y.Aa&&!y.ma?new _t(new Ke({ab:R})):new _t(y.ma),b.Fa(y.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function xr(){}n=xr.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ho(){}ho.prototype.g=function(y,b){return new qn(y,b)};function qn(y,b){jt.call(this),this.g=new Bs(b),this.l=y,this.h=b&&b.messageUrlParams||null,y=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(y?y["X-WebChannel-Content-Type"]=b.messageContentType:y={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(y?y["X-WebChannel-Client-Profile"]=b.sa:y={"X-WebChannel-Client-Profile":b.sa}),this.g.U=y,(y=b&&b.Qb)&&!z(y)&&(this.g.u=y),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!z(b)&&(this.g.G=b,y=this.h,y!==null&&b in y&&(y=this.h,b in y&&delete y[b])),this.j=new qs(this)}S(qn,jt),qn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},qn.prototype.close=function(){ct(this.g)},qn.prototype.o=function(y){var b=this.g;if(typeof y=="string"){var R={};R.__data__=y,y=R}else this.v&&(R={},R.__data__=Ie(y),y=R);b.i.push(new pn(b.Ya++,y)),b.I==3&&si(b)},qn.prototype.N=function(){this.g.l=null,delete this.j,ct(this.g),delete this.g,qn.Z.N.call(this)};function Ia(y){Ot.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var b=y.__sm__;if(b){e:{for(const R in b){y=R;break e}y=void 0}(this.i=y)&&(y=this.i,b=b!==null&&y in b?b[y]:void 0),this.data=b}else this.data=y}S(Ia,Ot);function El(){Dn.call(this),this.status=1}S(El,Dn);function qs(y){this.g=y}S(qs,xr),qs.prototype.ra=function(){ye(this.g,"a")},qs.prototype.qa=function(y){ye(this.g,new Ia(y))},qs.prototype.pa=function(y){ye(this.g,new El)},qs.prototype.oa=function(){ye(this.g,"b")},ho.prototype.createWebChannel=ho.prototype.g,qn.prototype.send=qn.prototype.o,qn.prototype.open=qn.prototype.m,qn.prototype.close=qn.prototype.close,qS=function(){return new ho},FS=function(){return ks()},BS=Qt,Jp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Mo.NO_ERROR=0,Mo.TIMEOUT=8,Mo.HTTP_ERROR=6,xh=Mo,ya.COMPLETE="complete",zS=ya,Si.EventType=Tn,Tn.OPEN="a",Tn.CLOSE="b",Tn.ERROR="c",Tn.MESSAGE="d",jt.prototype.listen=jt.prototype.J,wc=Si,_t.prototype.listenOnce=_t.prototype.K,_t.prototype.getLastError=_t.prototype.Ha,_t.prototype.getLastErrorCode=_t.prototype.ya,_t.prototype.getStatus=_t.prototype.ca,_t.prototype.getResponseJson=_t.prototype.La,_t.prototype.getResponseText=_t.prototype.la,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Fa,US=_t}).apply(typeof ch<"u"?ch:typeof self<"u"?self:typeof window<"u"?window:{});const qE="@firebase/firestore",HE="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ui.UNAUTHENTICATED=new ui(null),ui.GOOGLE_CREDENTIALS=new ui("google-credentials-uid"),ui.FIRST_PARTY=new ui("first-party-uid"),ui.MOCK_USER=new ui("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nu="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=new Lg("@firebase/firestore");function Xl(){return ul.logLevel}function Oe(n,...e){if(ul.logLevel<=Tt.DEBUG){const t=e.map(Yg);ul.debug(`Firestore (${Nu}): ${n}`,...t)}}function ur(n,...e){if(ul.logLevel<=Tt.ERROR){const t=e.map(Yg);ul.error(`Firestore (${Nu}): ${n}`,...t)}}function pu(n,...e){if(ul.logLevel<=Tt.WARN){const t=e.map(Yg);ul.warn(`Firestore (${Nu}): ${n}`,...t)}}function Yg(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $e(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,HS(n,i,t)}function HS(n,e,t){let i=`FIRESTORE (${Nu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw ur(i),new Error(i)}function Lt(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||HS(e,r,i)}function ot(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends fr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class N3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ui.UNAUTHENTICATED)))}shutdown(){}}class R3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class M3{constructor(e){this.t=e,this.currentUser=ui.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Lt(this.o===void 0,42304);let i=this.i;const r=g=>this.i!==i?(i=this.i,t(g)):Promise.resolve();let u=new sl;this.o=()=>{this.i++,this.currentUser=this.u(),u.resolve(),u=new sl,e.enqueueRetryable((()=>r(this.currentUser)))};const c=()=>{const g=u;e.enqueueRetryable((async()=>{await g.promise,await r(this.currentUser)}))},m=g=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((g=>m(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?m(g):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new sl)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Lt(typeof i.accessToken=="string",31837,{l:i}),new GS(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Lt(e===null||typeof e=="string",2055,{h:e}),new ui(e)}}class P3{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=ui.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class k3{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new P3(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ui.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class GE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class D3{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ws(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Lt(this.o===void 0,3512);const i=u=>{u.error!=null&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${u.error.message}`);const c=u.token!==this.m;return this.m=u.token,Oe("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(u.token):Promise.resolve()};this.o=u=>{e.enqueueRetryable((()=>i(u)))};const r=u=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=u,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((u=>r(u))),setTimeout((()=>{if(!this.appCheck){const u=this.V.getImmediate({optional:!0});u?r(u):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new GE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Lt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new GE(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L3(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=L3(40);for(let u=0;u<r.length;++u)i.length<20&&r[u]<t&&(i+=e.charAt(r[u]%62))}return i}}function Et(n,e){return n<e?-1:n>e?1:0}function Qp(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),u=e.charAt(i);if(r!==u)return Ap(r)===Ap(u)?Et(r,u):Ap(r)?1:-1}return Et(n.length,e.length)}const V3=55296,O3=57343;function Ap(n){const e=n.charCodeAt(0);return e>=V3&&e<=O3}function gu(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE="__name__";class wo{constructor(e,t,i){t===void 0?t=0:t>e.length&&$e(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&$e(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return wo.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof wo?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const u=wo.compareSegments(e.get(r),t.get(r));if(u!==0)return u}return Et(e.length,t.length)}static compareSegments(e,t){const i=wo.isNumericId(e),r=wo.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?wo.extractNumericId(e).compare(wo.extractNumericId(t)):Qp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ra.fromString(e.substring(4,e.length-2))}}class $t extends wo{construct(e,t,i){return new $t(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ue(xe.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new $t(t)}static emptyPath(){return new $t([])}}const U3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $n extends wo{construct(e,t,i){return new $n(e,t,i)}static isValidIdentifier(e){return U3.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$n.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===jE}static keyField(){return new $n([jE])}static fromServerFormat(e){const t=[];let i="",r=0;const u=()=>{if(i.length===0)throw new Ue(xe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;r<e.length;){const m=e[r];if(m==="\\"){if(r+1===e.length)throw new Ue(xe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[r+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new Ue(xe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=g,r+=2}else m==="`"?(c=!c,r++):m!=="."||c?(i+=m,r++):(u(),r++)}if(u(),c)throw new Ue(xe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $n(t)}static emptyPath(){return new $n([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e){this.path=e}static fromPath(e){return new je($t.fromString(e))}static fromName(e){return new je($t.fromString(e).popFirst(5))}static empty(){return new je($t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$t.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return $t.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new je(new $t(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jS(n,e,t){if(!t)throw new Ue(xe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function z3(n,e,t,i){if(e===!0&&i===!0)throw new Ue(xe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function KE(n){if(!je.isDocumentKey(n))throw new Ue(xe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ZE(n){if(je.isDocumentKey(n))throw new Ue(xe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function KS(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ff(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$e(12329,{type:typeof n})}function aa(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ue(xe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ff(n);throw new Ue(xe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Jc(n,e){if(!KS(n))throw new Ue(xe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,u="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const c=n[i];if(r&&typeof c!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(u!==void 0&&c!==u.value){t=`Expected '${i}' field to equal '${u.value}'`;break}}if(t)throw new Ue(xe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE=-62135596800,WE=1e6;class on{static now(){return on.fromMillis(Date.now())}static fromDate(e){return on.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*WE);return new on(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ue(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ue(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<YE)throw new Ue(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ue(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/WE}_compareTo(e){return this.seconds===e.seconds?Et(this.nanoseconds,e.nanoseconds):Et(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:on._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Jc(e,on._jsonSchema))return new on(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-YE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}on._jsonSchemaVersion="firestore/timestamp/1.0",on._jsonSchema={type:Pn("string",on._jsonSchemaVersion),seconds:Pn("number"),nanoseconds:Pn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{static fromTimestamp(e){return new it(e)}static min(){return new it(new on(0,0))}static max(){return new it(new on(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uc=-1;function B3(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=it.fromTimestamp(i===1e9?new on(t+1,0):new on(t,i));return new ua(r,je.empty(),e)}function F3(n){return new ua(n.readTime,n.key,Uc)}class ua{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ua(it.min(),je.empty(),Uc)}static max(){return new ua(it.max(),je.empty(),Uc)}}function q3(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=je.comparator(n.documentKey,e.documentKey),t!==0?t:Et(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class G3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ru(n){if(n.code!==xe.FAILED_PRECONDITION||n.message!==H3)throw n;Oe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$e(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new we(((i,r)=>{this.nextCallback=u=>{this.wrapSuccess(e,u).next(i,r)},this.catchCallback=u=>{this.wrapFailure(t,u).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof we?t:we.resolve(t)}catch(t){return we.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):we.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):we.reject(t)}static resolve(e){return new we(((t,i)=>{t(e)}))}static reject(e){return new we(((t,i)=>{i(e)}))}static waitFor(e){return new we(((t,i)=>{let r=0,u=0,c=!1;e.forEach((m=>{++r,m.next((()=>{++u,c&&u===r&&t()}),(g=>i(g)))})),c=!0,u===r&&t()}))}static or(e){let t=we.resolve(!1);for(const i of e)t=t.next((r=>r?we.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,u)=>{i.push(t.call(this,r,u))})),this.waitFor(i)}static mapArray(e,t){return new we(((i,r)=>{const u=e.length,c=new Array(u);let m=0;for(let g=0;g<u;g++){const p=g;t(e[p]).next((x=>{c[p]=x,++m,m===u&&i(c)}),(x=>r(x)))}}))}static doWhile(e,t){return new we(((i,r)=>{const u=()=>{e()===!0?t().next((()=>{u()}),r):i()};u()}))}}function j3(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Mu(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}mf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg=-1;function pf(n){return n==null}function Bh(n){return n===0&&1/n==-1/0}function K3(n){return typeof n=="number"&&Number.isInteger(n)&&!Bh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS="";function Z3(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=JE(e)),e=Y3(n.get(t),e);return JE(e)}function Y3(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const u=n.charAt(r);switch(u){case"\0":t+="";break;case ZS:t+="";break;default:t+=u}}return t}function JE(n){return n+ZS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ga(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function YS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e,t){this.comparator=e,this.root=t||Qn.EMPTY}insert(e,t){return new hn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qn.BLACK,null,null))}remove(e){return new hn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new dh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new dh(this.root,e,this.comparator,!1)}getReverseIterator(){return new dh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new dh(this.root,e,this.comparator,!0)}}class dh{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,t&&r&&(u*=-1),u<0)e=this.isReverse?e.left:e.right;else{if(u===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qn{constructor(e,t,i,r,u){this.key=e,this.value=t,this.color=i??Qn.RED,this.left=r??Qn.EMPTY,this.right=u??Qn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,u){return new Qn(e??this.key,t??this.value,i??this.color,r??this.left,u??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const u=i(e,r.key);return r=u<0?r.copy(null,null,null,r.left.insert(e,t,i),null):u===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Qn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return Qn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw $e(43730,{key:this.key,value:this.value});if(this.right.isRed())throw $e(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw $e(27949);return e+(this.isRed()?0:1)}}Qn.EMPTY=null,Qn.RED=!0,Qn.BLACK=!1;Qn.EMPTY=new class{constructor(){this.size=0}get key(){throw $e(57766)}get value(){throw $e(16141)}get color(){throw $e(16727)}get left(){throw $e(29726)}get right(){throw $e(36894)}copy(e,t,i,r,u){return this}insert(e,t,i){return new Qn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.comparator=e,this.data=new hn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new $E(this.data.getIterator())}getIteratorFrom(e){return new $E(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof On)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,u=i.getNext().key;if(this.comparator(r,u)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new On(this.comparator);return t.data=e,t}}class $E{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e){this.fields=e,e.sort($n.comparator)}static empty(){return new us([])}unionWith(e){let t=new On($n.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new us(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gu(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(u){throw typeof DOMException<"u"&&u instanceof DOMException?new WS("Invalid base64 string: "+u):u}})(e);return new Xn(t)}static fromUint8Array(e){const t=(function(r){let u="";for(let c=0;c<r.length;++c)u+=String.fromCharCode(r[c]);return u})(e);return new Xn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Et(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xn.EMPTY_BYTE_STRING=new Xn("");const W3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ca(n){if(Lt(!!n,39018),typeof n=="string"){let e=0;const t=W3.exec(n);if(Lt(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:wn(n.seconds),nanos:wn(n.nanos)}}function wn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function da(n){return typeof n=="string"?Xn.fromBase64String(n):Xn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JS="server_timestamp",QS="__type__",$S="__previous_value__",XS="__local_write_time__";function Qg(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[QS])==null?void 0:i.stringValue)===JS}function gf(n){const e=n.mapValue.fields[$S];return Qg(e)?gf(e):e}function zc(n){const e=ca(n.mapValue.fields[XS].timestampValue);return new on(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J3{constructor(e,t,i,r,u,c,m,g,p,x){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=u,this.forceLongPolling=c,this.autoDetectLongPolling=m,this.longPollingOptions=g,this.useFetchStreams=p,this.isUsingEmulator=x}}const Fh="(default)";class Bc{constructor(e,t){this.projectId=e,this.database=t||Fh}static empty(){return new Bc("","")}get isDefaultDatabase(){return this.database===Fh}isEqual(e){return e instanceof Bc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1="__type__",Q3="__max__",hh={mapValue:{}},t1="__vector__",qh="value";function ha(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Qg(n)?4:X3(n)?9007199254740991:$3(n)?10:11:$e(28295,{value:n})}function Ro(n,e){if(n===e)return!0;const t=ha(n);if(t!==ha(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return zc(n).isEqual(zc(e));case 3:return(function(r,u){if(typeof r.timestampValue=="string"&&typeof u.timestampValue=="string"&&r.timestampValue.length===u.timestampValue.length)return r.timestampValue===u.timestampValue;const c=ca(r.timestampValue),m=ca(u.timestampValue);return c.seconds===m.seconds&&c.nanos===m.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,u){return da(r.bytesValue).isEqual(da(u.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,u){return wn(r.geoPointValue.latitude)===wn(u.geoPointValue.latitude)&&wn(r.geoPointValue.longitude)===wn(u.geoPointValue.longitude)})(n,e);case 2:return(function(r,u){if("integerValue"in r&&"integerValue"in u)return wn(r.integerValue)===wn(u.integerValue);if("doubleValue"in r&&"doubleValue"in u){const c=wn(r.doubleValue),m=wn(u.doubleValue);return c===m?Bh(c)===Bh(m):isNaN(c)&&isNaN(m)}return!1})(n,e);case 9:return gu(n.arrayValue.values||[],e.arrayValue.values||[],Ro);case 10:case 11:return(function(r,u){const c=r.mapValue.fields||{},m=u.mapValue.fields||{};if(QE(c)!==QE(m))return!1;for(const g in c)if(c.hasOwnProperty(g)&&(m[g]===void 0||!Ro(c[g],m[g])))return!1;return!0})(n,e);default:return $e(52216,{left:n})}}function Fc(n,e){return(n.values||[]).find((t=>Ro(t,e)))!==void 0}function _u(n,e){if(n===e)return 0;const t=ha(n),i=ha(e);if(t!==i)return Et(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Et(n.booleanValue,e.booleanValue);case 2:return(function(u,c){const m=wn(u.integerValue||u.doubleValue),g=wn(c.integerValue||c.doubleValue);return m<g?-1:m>g?1:m===g?0:isNaN(m)?isNaN(g)?0:-1:1})(n,e);case 3:return XE(n.timestampValue,e.timestampValue);case 4:return XE(zc(n),zc(e));case 5:return Qp(n.stringValue,e.stringValue);case 6:return(function(u,c){const m=da(u),g=da(c);return m.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(u,c){const m=u.split("/"),g=c.split("/");for(let p=0;p<m.length&&p<g.length;p++){const x=Et(m[p],g[p]);if(x!==0)return x}return Et(m.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(u,c){const m=Et(wn(u.latitude),wn(c.latitude));return m!==0?m:Et(wn(u.longitude),wn(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return ex(n.arrayValue,e.arrayValue);case 10:return(function(u,c){var C,M,F,H;const m=u.fields||{},g=c.fields||{},p=(C=m[qh])==null?void 0:C.arrayValue,x=(M=g[qh])==null?void 0:M.arrayValue,S=Et(((F=p==null?void 0:p.values)==null?void 0:F.length)||0,((H=x==null?void 0:x.values)==null?void 0:H.length)||0);return S!==0?S:ex(p,x)})(n.mapValue,e.mapValue);case 11:return(function(u,c){if(u===hh.mapValue&&c===hh.mapValue)return 0;if(u===hh.mapValue)return 1;if(c===hh.mapValue)return-1;const m=u.fields||{},g=Object.keys(m),p=c.fields||{},x=Object.keys(p);g.sort(),x.sort();for(let S=0;S<g.length&&S<x.length;++S){const C=Qp(g[S],x[S]);if(C!==0)return C;const M=_u(m[g[S]],p[x[S]]);if(M!==0)return M}return Et(g.length,x.length)})(n.mapValue,e.mapValue);default:throw $e(23264,{he:t})}}function XE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Et(n,e);const t=ca(n),i=ca(e),r=Et(t.seconds,i.seconds);return r!==0?r:Et(t.nanos,i.nanos)}function ex(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const u=_u(t[r],i[r]);if(u)return u}return Et(t.length,i.length)}function yu(n){return $p(n)}function $p(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=ca(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return da(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return je.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const u of t.values||[])r?r=!1:i+=",",i+=$p(u);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",u=!0;for(const c of i)u?u=!1:r+=",",r+=`${c}:${$p(t.fields[c])}`;return r+"}"})(n.mapValue):$e(61005,{value:n})}function wh(n){switch(ha(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=gf(n);return e?16+wh(e):16;case 5:return 2*n.stringValue.length;case 6:return da(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,u)=>r+wh(u)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return ga(i.fields,((u,c)=>{r+=u.length+wh(c)})),r})(n.mapValue);default:throw $e(13486,{value:n})}}function tx(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Xp(n){return!!n&&"integerValue"in n}function $g(n){return!!n&&"arrayValue"in n}function nx(n){return!!n&&"nullValue"in n}function ix(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Sh(n){return!!n&&"mapValue"in n}function $3(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[e1])==null?void 0:i.stringValue)===t1}function Mc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return ga(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Mc(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Mc(n.arrayValue.values[t]);return e}return{...n}}function X3(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Q3}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e){this.value=e}static empty(){return new Hi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Sh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mc(t)}setAll(e){let t=$n.emptyPath(),i={},r=[];e.forEach(((c,m)=>{if(!t.isImmediateParentOf(m)){const g=this.getFieldsMap(t);this.applyChanges(g,i,r),i={},r=[],t=m.popLast()}c?i[m.lastSegment()]=Mc(c):r.push(m.lastSegment())}));const u=this.getFieldsMap(t);this.applyChanges(u,i,r)}delete(e){const t=this.field(e.popLast());Sh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ro(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Sh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){ga(t,((r,u)=>e[r]=u));for(const r of i)delete e[r]}clone(){return new Hi(Mc(this.value))}}function n1(n){const e=[];return ga(n.fields,((t,i)=>{const r=new $n([t]);if(Sh(i)){const u=n1(i.mapValue).fields;if(u.length===0)e.push(r);else for(const c of u)e.push(r.child(c))}else e.push(r)})),new us(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,t,i,r,u,c,m){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=u,this.data=c,this.documentState=m}static newInvalidDocument(e){return new ci(e,0,it.min(),it.min(),it.min(),Hi.empty(),0)}static newFoundDocument(e,t,i,r){return new ci(e,1,t,it.min(),i,r,0)}static newNoDocument(e,t){return new ci(e,2,t,it.min(),it.min(),Hi.empty(),0)}static newUnknownDocument(e,t){return new ci(e,3,t,it.min(),it.min(),Hi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(it.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Hi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Hi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=it.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ci&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ci(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,t){this.position=e,this.inclusive=t}}function sx(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const u=e[r],c=n.position[r];if(u.field.isKeyField()?i=je.comparator(je.fromName(c.referenceValue),t.key):i=_u(c,t.data.field(u.field)),u.dir==="desc"&&(i*=-1),i!==0)break}return i}function ox(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ro(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,t="asc"){this.field=e,this.dir=t}}function e4(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{}class Mn extends i1{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new n4(e,t,i):t==="array-contains"?new o4(e,i):t==="in"?new r4(e,i):t==="not-in"?new a4(e,i):t==="array-contains-any"?new l4(e,i):new Mn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new i4(e,i):new s4(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(_u(t,this.value)):t!==null&&ha(this.value)===ha(t)&&this.matchesComparison(_u(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $e(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Xs extends i1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Xs(e,t)}matches(e){return s1(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function s1(n){return n.op==="and"}function o1(n){return t4(n)&&s1(n)}function t4(n){for(const e of n.filters)if(e instanceof Xs)return!1;return!0}function eg(n){if(n instanceof Mn)return n.field.canonicalString()+n.op.toString()+yu(n.value);if(o1(n))return n.filters.map((e=>eg(e))).join(",");{const e=n.filters.map((t=>eg(t))).join(",");return`${n.op}(${e})`}}function r1(n,e){return n instanceof Mn?(function(i,r){return r instanceof Mn&&i.op===r.op&&i.field.isEqual(r.field)&&Ro(i.value,r.value)})(n,e):n instanceof Xs?(function(i,r){return r instanceof Xs&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((u,c,m)=>u&&r1(c,r.filters[m])),!0):!1})(n,e):void $e(19439)}function a1(n){return n instanceof Mn?(function(t){return`${t.field.canonicalString()} ${t.op} ${yu(t.value)}`})(n):n instanceof Xs?(function(t){return t.op.toString()+" {"+t.getFilters().map(a1).join(" ,")+"}"})(n):"Filter"}class n4 extends Mn{constructor(e,t,i){super(e,t,i),this.key=je.fromName(i.referenceValue)}matches(e){const t=je.comparator(e.key,this.key);return this.matchesComparison(t)}}class i4 extends Mn{constructor(e,t){super(e,"in",t),this.keys=l1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class s4 extends Mn{constructor(e,t){super(e,"not-in",t),this.keys=l1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function l1(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>je.fromName(i.referenceValue)))}class o4 extends Mn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return $g(t)&&Fc(t.arrayValue,this.value)}}class r4 extends Mn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Fc(this.value.arrayValue,t)}}class a4 extends Mn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Fc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Fc(this.value.arrayValue,t)}}class l4 extends Mn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!$g(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Fc(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(e,t=null,i=[],r=[],u=null,c=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=u,this.startAt=c,this.endAt=m,this.Te=null}}function rx(n,e=null,t=[],i=[],r=null,u=null,c=null){return new u4(n,e,t,i,r,u,c)}function Xg(n){const e=ot(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>eg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(u){return u.field.canonicalString()+u.dir})(i))).join(","),pf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>yu(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>yu(i))).join(",")),e.Te=t}return e.Te}function e_(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!e4(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!r1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ox(n.startAt,e.startAt)&&ox(n.endAt,e.endAt)}function tg(n){return je.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,t=null,i=[],r=[],u=null,c="F",m=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=u,this.limitType=c,this.startAt=m,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function c4(n,e,t,i,r,u,c,m){return new Qc(n,e,t,i,r,u,c,m)}function t_(n){return new Qc(n)}function ax(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function u1(n){return n.collectionGroup!==null}function Pc(n){const e=ot(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const u of e.explicitOrderBy)e.Ie.push(u),t.add(u.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let m=new On($n.comparator);return c.filters.forEach((g=>{g.getFlattenedFilters().forEach((p=>{p.isInequality()&&(m=m.add(p.field))}))})),m})(e).forEach((u=>{t.has(u.canonicalString())||u.isKeyField()||e.Ie.push(new Gh(u,i))})),t.has($n.keyField().canonicalString())||e.Ie.push(new Gh($n.keyField(),i))}return e.Ie}function Ao(n){const e=ot(n);return e.Ee||(e.Ee=d4(e,Pc(n))),e.Ee}function d4(n,e){if(n.limitType==="F")return rx(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const u=r.dir==="desc"?"asc":"desc";return new Gh(r.field,u)}));const t=n.endAt?new Hh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Hh(n.startAt.position,n.startAt.inclusive):null;return rx(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function ng(n,e){const t=n.filters.concat([e]);return new Qc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ig(n,e,t){return new Qc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function _f(n,e){return e_(Ao(n),Ao(e))&&n.limitType===e.limitType}function c1(n){return`${Xg(Ao(n))}|lt:${n.limitType}`}function eu(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>a1(r))).join(", ")}]`),pf(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>yu(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>yu(r))).join(",")),`Target(${i})`})(Ao(n))}; limitType=${n.limitType})`}function yf(n,e){return e.isFoundDocument()&&(function(i,r){const u=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(u):je.isDocumentKey(i.path)?i.path.isEqual(u):i.path.isImmediateParentOf(u)})(n,e)&&(function(i,r){for(const u of Pc(i))if(!u.field.isKeyField()&&r.data.field(u.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const u of i.filters)if(!u.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(c,m,g){const p=sx(c,m,g);return c.inclusive?p<=0:p<0})(i.startAt,Pc(i),r)||i.endAt&&!(function(c,m,g){const p=sx(c,m,g);return c.inclusive?p>=0:p>0})(i.endAt,Pc(i),r))})(n,e)}function h4(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function d1(n){return(e,t)=>{let i=!1;for(const r of Pc(n)){const u=f4(r,e,t);if(u!==0)return u;i=i||r.field.isKeyField()}return 0}}function f4(n,e,t){const i=n.field.isKeyField()?je.comparator(e.key,t.key):(function(u,c,m){const g=c.data.field(u),p=m.data.field(u);return g!==null&&p!==null?_u(g,p):$e(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return $e(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,u]of i)if(this.equalsFn(r,e))return u}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let u=0;u<r.length;u++)if(this.equalsFn(r[u][0],e))return void(r[u]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ga(this.inner,((t,i)=>{for(const[r,u]of i)e(r,u)}))}isEmpty(){return YS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=new hn(je.comparator);function cr(){return m4}const h1=new hn(je.comparator);function Sc(...n){let e=h1;for(const t of n)e=e.insert(t.key,t);return e}function f1(n){let e=h1;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function nl(){return kc()}function m1(){return kc()}function kc(){return new fl((n=>n.toString()),((n,e)=>n.isEqual(e)))}const p4=new hn(je.comparator),g4=new On(je.comparator);function xt(...n){let e=g4;for(const t of n)e=e.add(t);return e}const _4=new On(Et);function y4(){return _4}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bh(e)?"-0":e}}function p1(n){return{integerValue:""+n}}function v4(n,e){return K3(e)?p1(e):n_(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(){this._=void 0}}function T4(n,e,t){return n instanceof qc?(function(r,u){const c={fields:{[QS]:{stringValue:JS},[XS]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return u&&Qg(u)&&(u=gf(u)),u&&(c.fields[$S]=u),{mapValue:c}})(t,e):n instanceof Hc?_1(n,e):n instanceof Gc?y1(n,e):(function(r,u){const c=g1(r,u),m=lx(c)+lx(r.Ae);return Xp(c)&&Xp(r.Ae)?p1(m):n_(r.serializer,m)})(n,e)}function E4(n,e,t){return n instanceof Hc?_1(n,e):n instanceof Gc?y1(n,e):t}function g1(n,e){return n instanceof jh?(function(i){return Xp(i)||(function(u){return!!u&&"doubleValue"in u})(i)})(e)?e:{integerValue:0}:null}class qc extends vf{}class Hc extends vf{constructor(e){super(),this.elements=e}}function _1(n,e){const t=v1(e);for(const i of n.elements)t.some((r=>Ro(r,i)))||t.push(i);return{arrayValue:{values:t}}}class Gc extends vf{constructor(e){super(),this.elements=e}}function y1(n,e){let t=v1(e);for(const i of n.elements)t=t.filter((r=>!Ro(r,i)));return{arrayValue:{values:t}}}class jh extends vf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function lx(n){return wn(n.integerValue||n.doubleValue)}function v1(n){return $g(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x4{constructor(e,t){this.field=e,this.transform=t}}function w4(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof Hc&&r instanceof Hc||i instanceof Gc&&r instanceof Gc?gu(i.elements,r.elements,Ro):i instanceof jh&&r instanceof jh?Ro(i.Ae,r.Ae):i instanceof qc&&r instanceof qc})(n.transform,e.transform)}class S4{constructor(e,t){this.version=e,this.transformResults=t}}class $s{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $s}static exists(e){return new $s(void 0,e)}static updateTime(e){return new $s(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ah(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Tf{}function T1(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new i_(n.key,$s.none()):new $c(n.key,n.data,$s.none());{const t=n.data,i=Hi.empty();let r=new On($n.comparator);for(let u of e.fields)if(!r.has(u)){let c=t.field(u);c===null&&u.length>1&&(u=u.popLast(),c=t.field(u)),c===null?i.delete(u):i.set(u,c),r=r.add(u)}return new _a(n.key,i,new us(r.toArray()),$s.none())}}function A4(n,e,t){n instanceof $c?(function(r,u,c){const m=r.value.clone(),g=cx(r.fieldTransforms,u,c.transformResults);m.setAll(g),u.convertToFoundDocument(c.version,m).setHasCommittedMutations()})(n,e,t):n instanceof _a?(function(r,u,c){if(!Ah(r.precondition,u))return void u.convertToUnknownDocument(c.version);const m=cx(r.fieldTransforms,u,c.transformResults),g=u.data;g.setAll(E1(r)),g.setAll(m),u.convertToFoundDocument(c.version,g).setHasCommittedMutations()})(n,e,t):(function(r,u,c){u.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function Dc(n,e,t,i){return n instanceof $c?(function(u,c,m,g){if(!Ah(u.precondition,c))return m;const p=u.value.clone(),x=dx(u.fieldTransforms,g,c);return p.setAll(x),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof _a?(function(u,c,m,g){if(!Ah(u.precondition,c))return m;const p=dx(u.fieldTransforms,g,c),x=c.data;return x.setAll(E1(u)),x.setAll(p),c.convertToFoundDocument(c.version,x).setHasLocalMutations(),m===null?null:m.unionWith(u.fieldMask.fields).unionWith(u.fieldTransforms.map((S=>S.field)))})(n,e,t,i):(function(u,c,m){return Ah(u.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):m})(n,e,t)}function C4(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),u=g1(i.transform,r||null);u!=null&&(t===null&&(t=Hi.empty()),t.set(i.field,u))}return t||null}function ux(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&gu(i,r,((u,c)=>w4(u,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class $c extends Tf{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class _a extends Tf{constructor(e,t,i,r,u=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=u,this.type=1}getFieldMask(){return this.fieldMask}}function E1(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function cx(n,e,t){const i=new Map;Lt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let r=0;r<t.length;r++){const u=n[r],c=u.transform,m=e.data.field(u.field);i.set(u.field,E4(c,m,t[r]))}return i}function dx(n,e,t){const i=new Map;for(const r of n){const u=r.transform,c=t.data.field(r.field);i.set(r.field,T4(u,c,e))}return i}class i_ extends Tf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class b4 extends Tf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const u=this.mutations[r];u.key.isEqual(e.key)&&A4(u,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Dc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Dc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=m1();return this.mutations.forEach((r=>{const u=e.get(r.key),c=u.overlayedDocument;let m=this.applyToLocalView(c,u.mutatedFields);m=t.has(r.key)?null:m;const g=T1(c,m);g!==null&&i.set(r.key,g),c.isValidDocument()||c.convertToNoDocument(it.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),xt())}isEqual(e){return this.batchId===e.batchId&&gu(this.mutations,e.mutations,((t,i)=>ux(t,i)))&&gu(this.baseMutations,e.baseMutations,((t,i)=>ux(t,i)))}}class s_{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){Lt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return p4})();const u=e.mutations;for(let c=0;c<u.length;c++)r=r.insert(u[c].key,i[c].version);return new s_(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N4{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rn,Ct;function M4(n){switch(n){case xe.OK:return $e(64938);case xe.CANCELLED:case xe.UNKNOWN:case xe.DEADLINE_EXCEEDED:case xe.RESOURCE_EXHAUSTED:case xe.INTERNAL:case xe.UNAVAILABLE:case xe.UNAUTHENTICATED:return!1;case xe.INVALID_ARGUMENT:case xe.NOT_FOUND:case xe.ALREADY_EXISTS:case xe.PERMISSION_DENIED:case xe.FAILED_PRECONDITION:case xe.ABORTED:case xe.OUT_OF_RANGE:case xe.UNIMPLEMENTED:case xe.DATA_LOSS:return!0;default:return $e(15467,{code:n})}}function x1(n){if(n===void 0)return ur("GRPC error has no .code"),xe.UNKNOWN;switch(n){case Rn.OK:return xe.OK;case Rn.CANCELLED:return xe.CANCELLED;case Rn.UNKNOWN:return xe.UNKNOWN;case Rn.DEADLINE_EXCEEDED:return xe.DEADLINE_EXCEEDED;case Rn.RESOURCE_EXHAUSTED:return xe.RESOURCE_EXHAUSTED;case Rn.INTERNAL:return xe.INTERNAL;case Rn.UNAVAILABLE:return xe.UNAVAILABLE;case Rn.UNAUTHENTICATED:return xe.UNAUTHENTICATED;case Rn.INVALID_ARGUMENT:return xe.INVALID_ARGUMENT;case Rn.NOT_FOUND:return xe.NOT_FOUND;case Rn.ALREADY_EXISTS:return xe.ALREADY_EXISTS;case Rn.PERMISSION_DENIED:return xe.PERMISSION_DENIED;case Rn.FAILED_PRECONDITION:return xe.FAILED_PRECONDITION;case Rn.ABORTED:return xe.ABORTED;case Rn.OUT_OF_RANGE:return xe.OUT_OF_RANGE;case Rn.UNIMPLEMENTED:return xe.UNIMPLEMENTED;case Rn.DATA_LOSS:return xe.DATA_LOSS;default:return $e(39323,{code:n})}}(Ct=Rn||(Rn={}))[Ct.OK=0]="OK",Ct[Ct.CANCELLED=1]="CANCELLED",Ct[Ct.UNKNOWN=2]="UNKNOWN",Ct[Ct.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ct[Ct.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ct[Ct.NOT_FOUND=5]="NOT_FOUND",Ct[Ct.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ct[Ct.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ct[Ct.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ct[Ct.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ct[Ct.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ct[Ct.ABORTED=10]="ABORTED",Ct[Ct.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ct[Ct.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ct[Ct.INTERNAL=13]="INTERNAL",Ct[Ct.UNAVAILABLE=14]="UNAVAILABLE",Ct[Ct.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4=new ra([4294967295,4294967295],0);function hx(n){const e=P4().encode(n),t=new OS;return t.update(e),new Uint8Array(t.digest())}function fx(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),u=e.getUint32(12,!0);return[new ra([t,i],0),new ra([r,u],0)]}class o_{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Ac(`Invalid padding: ${t}`);if(i<0)throw new Ac(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Ac(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Ac(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ra.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(ra.fromNumber(i)));return r.compare(k4)===1&&(r=new ra([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=hx(e),[i,r]=fx(t);for(let u=0;u<this.hashCount;u++){const c=this.ye(i,r,u);if(!this.we(c))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,u=new Uint8Array(Math.ceil(e/8)),c=new o_(u,r,t);return i.forEach((m=>c.insert(m))),c}insert(e){if(this.ge===0)return;const t=hx(e),[i,r]=fx(t);for(let u=0;u<this.hashCount;u++){const c=this.ye(i,r,u);this.Se(c)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Ac extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,t,i,r,u){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=u}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Xc.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Ef(it.min(),r,new hn(Et),cr(),xt())}}class Xc{constructor(e,t,i,r,u){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=u}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Xc(i,t,xt(),xt(),xt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,t,i,r){this.be=e,this.removedTargetIds=t,this.key=i,this.De=r}}class w1{constructor(e,t){this.targetId=e,this.Ce=t}}class S1{constructor(e,t,i=Xn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class mx{constructor(){this.ve=0,this.Fe=px(),this.Me=Xn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=xt(),t=xt(),i=xt();return this.Fe.forEach(((r,u)=>{switch(u){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:$e(38017,{changeType:u})}})),new Xc(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=px()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class D4{constructor(e){this.Ge=e,this.ze=new Map,this.je=cr(),this.Je=fh(),this.He=fh(),this.Ye=new hn(Et)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:$e(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const u=r.target;if(tg(u))if(i===0){const c=new je(u.path);this.et(t,c,ci.newNoDocument(c,it.min()))}else Lt(i===1,20013,{expectedCount:i});else{const c=this._t(t);if(c!==i){const m=this.ut(e),g=m?this.ct(m,e,c):1;if(g!==0){this.it(t);const p=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:u=0}=t;let c,m;try{c=da(i).toUint8Array()}catch(g){if(g instanceof WS)return pu("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{m=new o_(c,r,u)}catch(g){return pu(g instanceof Ac?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return m.ge===0?null:m}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((u=>{const c=this.Ge.ht(),m=`projects/${c.projectId}/databases/${c.database}/documents/${u.path.canonicalString()}`;e.mightContain(m)||(this.et(t,u,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((u,c)=>{const m=this.ot(c);if(m){if(u.current&&tg(m.target)){const g=new je(m.target.path);this.It(g).has(c)||this.Et(c,g)||this.et(c,g,ci.newNoDocument(g,e))}u.Be&&(t.set(c,u.ke()),u.qe())}}));let i=xt();this.He.forEach(((u,c)=>{let m=!0;c.forEachWhile((g=>{const p=this.ot(g);return!p||p.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(i=i.add(u))})),this.je.forEach(((u,c)=>c.setReadTime(e)));const r=new Ef(e,t,this.Ye,this.je,i);return this.je=cr(),this.Je=fh(),this.He=fh(),this.Ye=new hn(Et),r}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new mx,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new On(Et),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new On(Et),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new mx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function fh(){return new hn(je.comparator)}function px(){return new hn(je.comparator)}const L4={asc:"ASCENDING",desc:"DESCENDING"},V4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},O4={and:"AND",or:"OR"};class U4{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function sg(n,e){return n.useProto3Json||pf(e)?e:{value:e}}function Kh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function A1(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function z4(n,e){return Kh(n,e.toTimestamp())}function Co(n){return Lt(!!n,49232),it.fromTimestamp((function(t){const i=ca(t);return new on(i.seconds,i.nanos)})(n))}function r_(n,e){return og(n,e).canonicalString()}function og(n,e){const t=(function(r){return new $t(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function C1(n){const e=$t.fromString(n);return Lt(M1(e),10190,{key:e.toString()}),e}function rg(n,e){return r_(n.databaseId,e.path)}function Cp(n,e){const t=C1(e);if(t.get(1)!==n.databaseId.projectId)throw new Ue(xe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ue(xe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new je(I1(t))}function b1(n,e){return r_(n.databaseId,e)}function B4(n){const e=C1(n);return e.length===4?$t.emptyPath():I1(e)}function ag(n){return new $t(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function I1(n){return Lt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function gx(n,e,t){return{name:rg(n,e),fields:t.value.mapValue.fields}}function F4(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:$e(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],u=(function(p,x){return p.useProto3Json?(Lt(x===void 0||typeof x=="string",58123),Xn.fromBase64String(x||"")):(Lt(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),Xn.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,m=c&&(function(p){const x=p.code===void 0?xe.UNKNOWN:x1(p.code);return new Ue(x,p.message||"")})(c);t=new S1(i,r,u,m||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Cp(n,i.document.name),u=Co(i.document.updateTime),c=i.document.createTime?Co(i.document.createTime):it.min(),m=new Hi({mapValue:{fields:i.document.fields}}),g=ci.newFoundDocument(r,u,c,m),p=i.targetIds||[],x=i.removedTargetIds||[];t=new Ch(p,x,g.key,g)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Cp(n,i.document),u=i.readTime?Co(i.readTime):it.min(),c=ci.newNoDocument(r,u),m=i.removedTargetIds||[];t=new Ch([],m,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Cp(n,i.document),u=i.removedTargetIds||[];t=new Ch([],u,r,null)}else{if(!("filter"in e))return $e(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:u}=i,c=new R4(r,u),m=i.targetId;t=new w1(m,c)}}return t}function q4(n,e){let t;if(e instanceof $c)t={update:gx(n,e.key,e.value)};else if(e instanceof i_)t={delete:rg(n,e.key)};else if(e instanceof _a)t={update:gx(n,e.key,e.data),updateMask:Q4(e.fieldMask)};else{if(!(e instanceof b4))return $e(16599,{Vt:e.type});t={verify:rg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(u,c){const m=c.transform;if(m instanceof qc)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Hc)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Gc)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof jh)return{fieldPath:c.field.canonicalString(),increment:m.Ae};throw $e(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,u){return u.updateTime!==void 0?{updateTime:z4(r,u.updateTime)}:u.exists!==void 0?{exists:u.exists}:$e(27497)})(n,e.precondition)),t}function H4(n,e){return n&&n.length>0?(Lt(e!==void 0,14353),n.map((t=>(function(r,u){let c=r.updateTime?Co(r.updateTime):Co(u);return c.isEqual(it.min())&&(c=Co(u)),new S4(c,r.transformResults||[])})(t,e)))):[]}function G4(n,e){return{documents:[b1(n,e.path)]}}function j4(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=b1(n,r);const u=(function(p){if(p.length!==0)return R1(Xs.create(p,"and"))})(e.filters);u&&(t.structuredQuery.where=u);const c=(function(p){if(p.length!==0)return p.map((x=>(function(C){return{field:tu(C.field),direction:Y4(C.dir)}})(x)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const m=sg(n,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:r}}function K4(n){let e=B4(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){Lt(i===1,65062);const x=t.from[0];x.allDescendants?r=x.collectionId:e=e.child(x.collectionId)}let u=[];t.where&&(u=(function(S){const C=N1(S);return C instanceof Xs&&o1(C)?C.getFilters():[C]})(t.where));let c=[];t.orderBy&&(c=(function(S){return S.map((C=>(function(F){return new Gh(nu(F.field),(function(Y){switch(Y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(F.direction))})(C)))})(t.orderBy));let m=null;t.limit&&(m=(function(S){let C;return C=typeof S=="object"?S.value:S,pf(C)?null:C})(t.limit));let g=null;t.startAt&&(g=(function(S){const C=!!S.before,M=S.values||[];return new Hh(M,C)})(t.startAt));let p=null;return t.endAt&&(p=(function(S){const C=!S.before,M=S.values||[];return new Hh(M,C)})(t.endAt)),c4(e,r,c,u,m,"F",g,p)}function Z4(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $e(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function N1(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=nu(t.unaryFilter.field);return Mn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=nu(t.unaryFilter.field);return Mn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const u=nu(t.unaryFilter.field);return Mn.create(u,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=nu(t.unaryFilter.field);return Mn.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return $e(61313);default:return $e(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Mn.create(nu(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return $e(58110);default:return $e(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Xs.create(t.compositeFilter.filters.map((i=>N1(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return $e(1026)}})(t.compositeFilter.op))})(n):$e(30097,{filter:n})}function Y4(n){return L4[n]}function W4(n){return V4[n]}function J4(n){return O4[n]}function tu(n){return{fieldPath:n.canonicalString()}}function nu(n){return $n.fromServerFormat(n.fieldPath)}function R1(n){return n instanceof Mn?(function(t){if(t.op==="=="){if(ix(t.value))return{unaryFilter:{field:tu(t.field),op:"IS_NAN"}};if(nx(t.value))return{unaryFilter:{field:tu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(ix(t.value))return{unaryFilter:{field:tu(t.field),op:"IS_NOT_NAN"}};if(nx(t.value))return{unaryFilter:{field:tu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:tu(t.field),op:W4(t.op),value:t.value}}})(n):n instanceof Xs?(function(t){const i=t.getFilters().map((r=>R1(r)));return i.length===1?i[0]:{compositeFilter:{op:J4(t.op),filters:i}}})(n):$e(54877,{filter:n})}function Q4(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function M1(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,t,i,r,u=it.min(),c=it.min(),m=Xn.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=u,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=m,this.expectedCount=g}withSequenceNumber(e){return new na(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new na(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new na(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new na(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e){this.yt=e}}function X4(n){const e=K4({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ig(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{constructor(){this.Cn=new t6}addToCollectionParentIndex(e,t){return this.Cn.add(t),we.resolve()}getCollectionParents(e,t){return we.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return we.resolve()}deleteFieldIndex(e,t){return we.resolve()}deleteAllFieldIndexes(e){return we.resolve()}createTargetIndexes(e,t){return we.resolve()}getDocumentsMatchingTarget(e,t){return we.resolve(null)}getIndexType(e,t){return we.resolve(0)}getFieldIndexes(e,t){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,t){return we.resolve(ua.min())}getMinOffsetFromCollectionGroup(e,t){return we.resolve(ua.min())}updateCollectionGroup(e,t,i){return we.resolve()}updateIndexEntries(e,t){return we.resolve()}}class t6{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new On($t.comparator),u=!r.has(i);return this.index[t]=r.add(i),u}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new On($t.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},P1=41943040;class qi{static withCacheSize(e){return new qi(e,qi.DEFAULT_COLLECTION_PERCENTILE,qi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qi.DEFAULT_COLLECTION_PERCENTILE=10,qi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qi.DEFAULT=new qi(P1,qi.DEFAULT_COLLECTION_PERCENTILE,qi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qi.DISABLED=new qi(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new vu(0)}static cr(){return new vu(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx="LruGarbageCollector",n6=1048576;function vx([n,e],[t,i]){const r=Et(n,t);return r===0?Et(e,i):r}class i6{constructor(e){this.Ir=e,this.buffer=new On(vx),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();vx(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class s6{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Oe(yx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Mu(t)?Oe(yx,"Ignoring IndexedDB error during garbage collection: ",t):await Ru(t)}await this.Vr(3e5)}))}}class o6{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return we.resolve(mf.ce);const i=new i6(t);return this.mr.forEachTarget(e,(r=>i.Ar(r.sequenceNumber))).next((()=>this.mr.pr(e,(r=>i.Ar(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Oe("LruGarbageCollector","Garbage collection skipped; disabled"),we.resolve(_x)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_x):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,r,u,c,m,g,p;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((S=>(S>this.params.maximumSequenceNumbersToCollect?(Oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),r=this.params.maximumSequenceNumbersToCollect):r=S,c=Date.now(),this.nthSequenceNumber(e,r)))).next((S=>(i=S,m=Date.now(),this.removeTargets(e,i,t)))).next((S=>(u=S,g=Date.now(),this.removeOrphanedDocuments(e,i)))).next((S=>(p=Date.now(),Xl()<=Tt.DEBUG&&Oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-x}ms
	Determined least recently used ${r} in `+(m-c)+`ms
	Removed ${u} targets in `+(g-m)+`ms
	Removed ${S} documents in `+(p-g)+`ms
Total Duration: ${p-x}ms`),we.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:u,documentsRemoved:S}))))}}function r6(n,e){return new o6(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(){this.changes=new fl((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ci.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?we.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&Dc(i.mutation,r,us.empty(),on.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,xt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=xt()){const r=nl();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((u=>{let c=Sc();return u.forEach(((m,g)=>{c=c.insert(m,g.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=nl();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,xt())))}populateOverlays(e,t,i){const r=[];return i.forEach((u=>{t.has(u)||r.push(u)})),this.documentOverlayCache.getOverlays(e,r).next((u=>{u.forEach(((c,m)=>{t.set(c,m)}))}))}computeViews(e,t,i,r){let u=cr();const c=kc(),m=(function(){return kc()})();return t.forEach(((g,p)=>{const x=i.get(p.key);r.has(p.key)&&(x===void 0||x.mutation instanceof _a)?u=u.insert(p.key,p):x!==void 0?(c.set(p.key,x.mutation.getFieldMask()),Dc(x.mutation,p,x.mutation.getFieldMask(),on.now())):c.set(p.key,us.empty())})),this.recalculateAndSaveOverlays(e,u).next((g=>(g.forEach(((p,x)=>c.set(p,x))),t.forEach(((p,x)=>m.set(p,new l6(x,c.get(p)??null)))),m)))}recalculateAndSaveOverlays(e,t){const i=kc();let r=new hn(((c,m)=>c-m)),u=xt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const m of c)m.keys().forEach((g=>{const p=t.get(g);if(p===null)return;let x=i.get(g)||us.empty();x=m.applyToLocalView(p,x),i.set(g,x);const S=(r.get(m.batchId)||xt()).add(g);r=r.insert(m.batchId,S)}))})).next((()=>{const c=[],m=r.getReverseIterator();for(;m.hasNext();){const g=m.getNext(),p=g.key,x=g.value,S=m1();x.forEach((C=>{if(!u.has(C)){const M=T1(t.get(C),i.get(C));M!==null&&S.set(C,M),u=u.add(C)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,S))}return we.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return(function(c){return je.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):u1(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((u=>{const c=r-u.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-u.size):we.resolve(nl());let m=Uc,g=u;return c.next((p=>we.forEach(p,((x,S)=>(m<S.largestBatchId&&(m=S.largestBatchId),u.get(x)?we.resolve():this.remoteDocumentCache.getEntry(e,x).next((C=>{g=g.insert(x,C)}))))).next((()=>this.populateOverlays(e,p,u))).next((()=>this.computeViews(e,g,p,xt()))).next((x=>({batchId:m,changes:f1(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new je(t)).next((i=>{let r=Sc();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const u=t.collectionGroup;let c=Sc();return this.indexManager.getCollectionParents(e,u).next((m=>we.forEach(m,(g=>{const p=(function(S,C){return new Qc(C,null,S.explicitOrderBy.slice(),S.filters.slice(),S.limit,S.limitType,S.startAt,S.endAt)})(t,g.child(u));return this.getDocumentsMatchingCollectionQuery(e,p,i,r).next((x=>{x.forEach(((S,C)=>{c=c.insert(S,C)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let u;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(u=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,u,r)))).next((c=>{u.forEach(((g,p)=>{const x=p.getKey();c.get(x)===null&&(c=c.insert(x,ci.newInvalidDocument(x)))}));let m=Sc();return c.forEach(((g,p)=>{const x=u.get(g);x!==void 0&&Dc(x.mutation,p,us.empty(),on.now()),yf(t,p)&&(m=m.insert(g,p))})),m}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return we.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Co(r.createTime)}})(t)),we.resolve()}getNamedQuery(e,t){return we.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(r){return{name:r.name,query:X4(r.bundledQuery),readTime:Co(r.readTime)}})(t)),we.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(){this.overlays=new hn(je.comparator),this.qr=new Map}getOverlay(e,t){return we.resolve(this.overlays.get(t))}getOverlays(e,t){const i=nl();return we.forEach(t,(r=>this.getOverlay(e,r).next((u=>{u!==null&&i.set(r,u)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,u)=>{this.St(e,t,u)})),we.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.qr.get(i);return r!==void 0&&(r.forEach((u=>this.overlays=this.overlays.remove(u))),this.qr.delete(i)),we.resolve()}getOverlaysForCollection(e,t,i){const r=nl(),u=t.length+1,c=new je(t.child("")),m=this.overlays.getIteratorFrom(c);for(;m.hasNext();){const g=m.getNext().value,p=g.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===u&&g.largestBatchId>i&&r.set(g.getKey(),g)}return we.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let u=new hn(((p,x)=>p-x));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let x=u.get(p.largestBatchId);x===null&&(x=nl(),u=u.insert(p.largestBatchId,x)),x.set(p.getKey(),p)}}const m=nl(),g=u.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((p,x)=>m.set(p,x))),!(m.size()>=r)););return we.resolve(m)}St(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const c=this.qr.get(r.largestBatchId).delete(i.key);this.qr.set(r.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new N4(t,i));let u=this.qr.get(t);u===void 0&&(u=xt(),this.qr.set(t,u)),this.qr.set(t,u.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(){this.sessionToken=Xn.EMPTY_BYTE_STRING}getSessionToken(e){return we.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,we.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(){this.Qr=new On(Kn.$r),this.Ur=new On(Kn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new Kn(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new Kn(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new je(new $t([])),i=new Kn(t,e),r=new Kn(t,e+1),u=[];return this.Ur.forEachInRange([i,r],(c=>{this.Gr(c),u.push(c.key)})),u}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new je(new $t([])),i=new Kn(t,e),r=new Kn(t,e+1);let u=xt();return this.Ur.forEachInRange([i,r],(c=>{u=u.add(c.key)})),u}containsKey(e){const t=new Kn(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class Kn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return je.comparator(e.key,t.key)||Et(e.Yr,t.Yr)}static Kr(e,t){return Et(e.Yr,t.Yr)||je.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new On(Kn.$r)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const u=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new I4(u,t,i,r);this.mutationQueue.push(c);for(const m of r)this.Zr=this.Zr.add(new Kn(m.key,u)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return we.resolve(c)}lookupMutationBatch(e,t){return we.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.ei(i),u=r<0?0:r;return we.resolve(this.mutationQueue.length>u?this.mutationQueue[u]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?Jg:this.tr-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Kn(t,0),r=new Kn(t,Number.POSITIVE_INFINITY),u=[];return this.Zr.forEachInRange([i,r],(c=>{const m=this.Xr(c.Yr);u.push(m)})),we.resolve(u)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new On(Et);return t.forEach((r=>{const u=new Kn(r,0),c=new Kn(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([u,c],(m=>{i=i.add(m.Yr)}))})),we.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let u=i;je.isDocumentKey(u)||(u=u.child(""));const c=new Kn(new je(u),0);let m=new On(Et);return this.Zr.forEachWhile((g=>{const p=g.key.path;return!!i.isPrefixOf(p)&&(p.length===r&&(m=m.add(g.Yr)),!0)}),c),we.resolve(this.ti(m))}ti(e){const t=[];return e.forEach((i=>{const r=this.Xr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){Lt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return we.forEach(t.mutations,(r=>{const u=new Kn(r.key,t.batchId);return i=i.delete(u),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new Kn(t,0),r=this.Zr.firstAfterOrEqual(i);return we.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(e){this.ri=e,this.docs=(function(){return new hn(je.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),u=r?r.size:0,c=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-u,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return we.resolve(i?i.document.mutableCopy():ci.newInvalidDocument(t))}getEntries(e,t){let i=cr();return t.forEach((r=>{const u=this.docs.get(r);i=i.insert(r,u?u.document.mutableCopy():ci.newInvalidDocument(r))})),we.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let u=cr();const c=t.path,m=new je(c.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(m);for(;g.hasNext();){const{key:p,value:{document:x}}=g.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||q3(F3(x),i)<=0||(r.has(x.key)||yf(t,x))&&(u=u.insert(x.key,x.mutableCopy()))}return we.resolve(u)}getAllFromCollectionGroup(e,t,i,r){$e(9500)}ii(e,t){return we.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new p6(this)}getSize(e){return we.resolve(this.size)}}class p6 extends a6{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(i)})),we.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e){this.persistence=e,this.si=new fl((t=>Xg(t)),e_),this.lastRemoteSnapshotVersion=it.min(),this.highestTargetId=0,this.oi=0,this._i=new a_,this.targetCount=0,this.ai=vu.ur()}forEachTarget(e,t){return this.si.forEach(((i,r)=>t(r))),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),we.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new vu(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,we.resolve()}updateTargetData(e,t){return this.Pr(t),we.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,t,i){let r=0;const u=[];return this.si.forEach(((c,m)=>{m.sequenceNumber<=t&&i.get(m.targetId)===null&&(this.si.delete(c),u.push(this.removeMatchingKeysForTargetId(e,m.targetId)),r++)})),we.waitFor(u).next((()=>r))}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return we.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),we.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const r=this.persistence.referenceDelegate,u=[];return r&&t.forEach((c=>{u.push(r.markPotentiallyOrphaned(e,c))})),we.waitFor(u)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),we.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return we.resolve(i)}containsKey(e,t){return we.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k1{constructor(e,t){this.ui={},this.overlays={},this.ci=new mf(0),this.li=!1,this.li=!0,this.hi=new h6,this.referenceDelegate=e(this),this.Pi=new g6(this),this.indexManager=new e6,this.remoteDocumentCache=(function(r){return new m6(r)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new $4(t),this.Ii=new c6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new d6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new f6(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){Oe("MemoryPersistence","Starting transaction:",e);const r=new _6(this.ci.next());return this.referenceDelegate.Ei(),i(r).next((u=>this.referenceDelegate.di(r).next((()=>u)))).toPromise().then((u=>(r.raiseOnCommittedEvent(),u)))}Ai(e,t){return we.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class _6 extends G3{constructor(e){super(),this.currentSequenceNumber=e}}class l_{constructor(e){this.persistence=e,this.Ri=new a_,this.Vi=null}static mi(e){return new l_(e)}get fi(){if(this.Vi)return this.Vi;throw $e(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),we.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),we.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),we.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((r=>this.fi.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((u=>this.fi.add(u.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.fi,(i=>{const r=je.fromPath(i);return this.gi(e,r).next((u=>{u||t.removeEntry(r,it.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return we.or([()=>we.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Zh{constructor(e,t){this.persistence=e,this.pi=new fl((i=>Z3(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=r6(this,t)}static mi(e,t){return new Zh(e,t)}Ei(){}di(e){return we.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return we.forEach(this.pi,((i,r)=>this.br(e,i,r).next((u=>u?we.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),u=r.newChangeBuffer();return r.ii(e,(c=>this.br(e,c,t).next((m=>{m||(i++,u.removeEntry(c,it.min()))})))).next((()=>u.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),we.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),we.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),we.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),we.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=wh(e.data.value)),t}br(e,t,i){return we.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.pi.get(t);return we.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=r}static As(e,t){let i=xt(),r=xt();for(const u of t.docChanges)switch(u.type){case 0:i=i.add(u.doc.key);break;case 1:r=r.add(u.doc.key)}return new u_(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return lk()?8:j3(fi())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const u={result:null};return this.ys(e,t).next((c=>{u.result=c})).next((()=>{if(!u.result)return this.ws(e,t,r,i).next((c=>{u.result=c}))})).next((()=>{if(u.result)return;const c=new y6;return this.Ss(e,t,c).next((m=>{if(u.result=m,this.Vs)return this.bs(e,t,c,m.size)}))})).next((()=>u.result))}bs(e,t,i,r){return i.documentReadCount<this.fs?(Xl()<=Tt.DEBUG&&Oe("QueryEngine","SDK will not create cache indexes for query:",eu(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),we.resolve()):(Xl()<=Tt.DEBUG&&Oe("QueryEngine","Query:",eu(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.gs*r?(Xl()<=Tt.DEBUG&&Oe("QueryEngine","The SDK decides to create cache indexes for query:",eu(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ao(t))):we.resolve())}ys(e,t){if(ax(t))return we.resolve(null);let i=Ao(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=ig(t,null,"F"),i=Ao(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((u=>{const c=xt(...u);return this.ps.getDocuments(e,c).next((m=>this.indexManager.getMinOffset(e,i).next((g=>{const p=this.Ds(t,m);return this.Cs(t,p,c,g.readTime)?this.ys(e,ig(t,null,"F")):this.vs(e,p,t,g)}))))})))))}ws(e,t,i,r){return ax(t)||r.isEqual(it.min())?we.resolve(null):this.ps.getDocuments(e,i).next((u=>{const c=this.Ds(t,u);return this.Cs(t,c,i,r)?we.resolve(null):(Xl()<=Tt.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),eu(t)),this.vs(e,c,t,B3(r,Uc)).next((m=>m)))}))}Ds(e,t){let i=new On(d1(e));return t.forEach(((r,u)=>{yf(e,u)&&(i=i.add(u))})),i}Cs(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const u=e.limitType==="F"?t.last():t.first();return!!u&&(u.hasPendingWrites||u.version.compareTo(r)>0)}Ss(e,t,i){return Xl()<=Tt.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",eu(t)),this.ps.getDocumentsMatchingQuery(e,t,ua.min(),i)}vs(e,t,i,r){return this.ps.getDocumentsMatchingQuery(e,i,r).next((u=>(t.forEach((c=>{u=u.insert(c.key,c)})),u)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_="LocalStore",T6=3e8;class E6{constructor(e,t,i,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new hn(Et),this.xs=new fl((u=>Xg(u)),e_),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new u6(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function x6(n,e,t,i){return new E6(n,e,t,i)}async function D1(n,e){const t=ot(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((u=>(r=u,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((u=>{const c=[],m=[];let g=xt();for(const p of r){c.push(p.batchId);for(const x of p.mutations)g=g.add(x.key)}for(const p of u){m.push(p.batchId);for(const x of p.mutations)g=g.add(x.key)}return t.localDocuments.getDocuments(i,g).next((p=>({Ls:p,removedBatchIds:c,addedBatchIds:m})))}))}))}function w6(n,e){const t=ot(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),u=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(m,g,p,x){const S=p.batch,C=S.keys();let M=we.resolve();return C.forEach((F=>{M=M.next((()=>x.getEntry(g,F))).next((H=>{const Y=p.docVersions.get(F);Lt(Y!==null,48541),H.version.compareTo(Y)<0&&(S.applyToRemoteDocument(H,p),H.isValidDocument()&&(H.setReadTime(p.commitVersion),x.addEntry(H)))}))})),M.next((()=>m.mutationQueue.removeMutationBatch(g,S)))})(t,i,e,u).next((()=>u.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(m){let g=xt();for(let p=0;p<m.mutationResults.length;++p)m.mutationResults[p].transformResults.length>0&&(g=g.add(m.batch.mutations[p].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function L1(n){const e=ot(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function S6(n,e){const t=ot(n),i=e.snapshotVersion;let r=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(u=>{const c=t.Ns.newChangeBuffer({trackRemovals:!0});r=t.Ms;const m=[];e.targetChanges.forEach(((x,S)=>{const C=r.get(S);if(!C)return;m.push(t.Pi.removeMatchingKeys(u,x.removedDocuments,S).next((()=>t.Pi.addMatchingKeys(u,x.addedDocuments,S))));let M=C.withSequenceNumber(u.currentSequenceNumber);e.targetMismatches.get(S)!==null?M=M.withResumeToken(Xn.EMPTY_BYTE_STRING,it.min()).withLastLimboFreeSnapshotVersion(it.min()):x.resumeToken.approximateByteSize()>0&&(M=M.withResumeToken(x.resumeToken,i)),r=r.insert(S,M),(function(H,Y,ie){return H.resumeToken.approximateByteSize()===0||Y.snapshotVersion.toMicroseconds()-H.snapshotVersion.toMicroseconds()>=T6?!0:ie.addedDocuments.size+ie.modifiedDocuments.size+ie.removedDocuments.size>0})(C,M,x)&&m.push(t.Pi.updateTargetData(u,M))}));let g=cr(),p=xt();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(u,x))})),m.push(A6(u,c,e.documentUpdates).next((x=>{g=x.ks,p=x.qs}))),!i.isEqual(it.min())){const x=t.Pi.getLastRemoteSnapshotVersion(u).next((S=>t.Pi.setTargetsMetadata(u,u.currentSequenceNumber,i)));m.push(x)}return we.waitFor(m).next((()=>c.apply(u))).next((()=>t.localDocuments.getLocalViewOfDocuments(u,g,p))).next((()=>g))})).then((u=>(t.Ms=r,u)))}function A6(n,e,t){let i=xt(),r=xt();return t.forEach((u=>i=i.add(u))),e.getEntries(n,i).next((u=>{let c=cr();return t.forEach(((m,g)=>{const p=u.get(m);g.isFoundDocument()!==p.isFoundDocument()&&(r=r.add(m)),g.isNoDocument()&&g.version.isEqual(it.min())?(e.removeEntry(m,g.readTime),c=c.insert(m,g)):!p.isValidDocument()||g.version.compareTo(p.version)>0||g.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(g),c=c.insert(m,g)):Oe(c_,"Ignoring outdated watch update for ",m,". Current version:",p.version," Watch version:",g.version)})),{ks:c,qs:r}}))}function C6(n,e){const t=ot(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Jg),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function b6(n,e){const t=ot(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.Pi.getTargetData(i,e).next((u=>u?(r=u,we.resolve(r)):t.Pi.allocateTargetId(i).next((c=>(r=new na(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.Ms.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function lg(n,e,t){const i=ot(n),r=i.Ms.get(e),u=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",u,(c=>i.persistence.referenceDelegate.removeTarget(c,r)))}catch(c){if(!Mu(c))throw c;Oe(c_,`Failed to update sequence numbers for target ${e}: ${c}`)}i.Ms=i.Ms.remove(e),i.xs.delete(r.target)}function Tx(n,e,t){const i=ot(n);let r=it.min(),u=xt();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(g,p,x){const S=ot(g),C=S.xs.get(x);return C!==void 0?we.resolve(S.Ms.get(C)):S.Pi.getTargetData(p,x)})(i,c,Ao(e)).next((m=>{if(m)return r=m.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(c,m.targetId).next((g=>{u=g}))})).next((()=>i.Fs.getDocumentsMatchingQuery(c,e,t?r:it.min(),t?u:xt()))).next((m=>(I6(i,h4(e),m),{documents:m,Qs:u})))))}function I6(n,e,t){let i=n.Os.get(e)||it.min();t.forEach(((r,u)=>{u.readTime.compareTo(i)>0&&(i=u.readTime)})),n.Os.set(e,i)}class Ex{constructor(){this.activeTargetIds=y4()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class N6{constructor(){this.Mo=new Ex,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ex,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx="ConnectivityMonitor";class wx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Oe(xx,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Oe(xx,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mh=null;function ug(){return mh===null?mh=(function(){return 268435456+Math.round(2147483648*Math.random())})():mh++,"0x"+mh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp="RestConnection",M6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class P6{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${r}`,this.Wo=this.databaseId.database===Fh?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Go(e,t,i,r,u){const c=ug(),m=this.zo(e,t.toUriEncodedString());Oe(bp,`Sending RPC '${e}' ${c}:`,m,i);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,r,u);const{host:p}=new URL(m),x=Cu(p);return this.Jo(e,m,g,i,x).then((S=>(Oe(bp,`Received RPC '${e}' ${c}: `,S),S)),(S=>{throw pu(bp,`RPC '${e}' ${c} failed with error: `,S,"url: ",m,"request:",i),S}))}Ho(e,t,i,r,u,c){return this.Go(e,t,i,r,u)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Nu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,u)=>e[u]=r)),i&&i.headers.forEach(((r,u)=>e[u]=r))}zo(e,t){const i=M6[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li="WebChannelConnection";class D6 extends P6{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,r,u){const c=ug();return new Promise(((m,g)=>{const p=new US;p.setWithCredentials(!0),p.listenOnce(zS.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case xh.NO_ERROR:const S=p.getResponseJson();Oe(li,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(S)),m(S);break;case xh.TIMEOUT:Oe(li,`RPC '${e}' ${c} timed out`),g(new Ue(xe.DEADLINE_EXCEEDED,"Request time out"));break;case xh.HTTP_ERROR:const C=p.getStatus();if(Oe(li,`RPC '${e}' ${c} failed with status:`,C,"response text:",p.getResponseText()),C>0){let M=p.getResponseJson();Array.isArray(M)&&(M=M[0]);const F=M==null?void 0:M.error;if(F&&F.status&&F.message){const H=(function(ie){const re=ie.toLowerCase().replace(/_/g,"-");return Object.values(xe).indexOf(re)>=0?re:xe.UNKNOWN})(F.status);g(new Ue(H,F.message))}else g(new Ue(xe.UNKNOWN,"Server responded with status "+p.getStatus()))}else g(new Ue(xe.UNAVAILABLE,"Connection failed."));break;default:$e(9055,{l_:e,streamId:c,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{Oe(li,`RPC '${e}' ${c} completed.`)}}));const x=JSON.stringify(r);Oe(li,`RPC '${e}' ${c} sending request:`,r),p.send(t,"POST",x,i,15)}))}T_(e,t,i){const r=ug(),u=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=qS(),m=FS(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(g.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,t,i),g.encodeInitMessageHeaders=!0;const x=u.join("");Oe(li,`Creating RPC '${e}' stream ${r}: ${x}`,g);const S=c.createWebChannel(x,g);this.I_(S);let C=!1,M=!1;const F=new k6({Yo:Y=>{M?Oe(li,`Not sending because RPC '${e}' stream ${r} is closed:`,Y):(C||(Oe(li,`Opening RPC '${e}' stream ${r} transport.`),S.open(),C=!0),Oe(li,`RPC '${e}' stream ${r} sending:`,Y),S.send(Y))},Zo:()=>S.close()}),H=(Y,ie,re)=>{Y.listen(ie,(ee=>{try{re(ee)}catch(Ee){setTimeout((()=>{throw Ee}),0)}}))};return H(S,wc.EventType.OPEN,(()=>{M||(Oe(li,`RPC '${e}' stream ${r} transport opened.`),F.o_())})),H(S,wc.EventType.CLOSE,(()=>{M||(M=!0,Oe(li,`RPC '${e}' stream ${r} transport closed`),F.a_(),this.E_(S))})),H(S,wc.EventType.ERROR,(Y=>{M||(M=!0,pu(li,`RPC '${e}' stream ${r} transport errored. Name:`,Y.name,"Message:",Y.message),F.a_(new Ue(xe.UNAVAILABLE,"The operation could not be completed")))})),H(S,wc.EventType.MESSAGE,(Y=>{var ie;if(!M){const re=Y.data[0];Lt(!!re,16349);const ee=re,Ee=(ee==null?void 0:ee.error)||((ie=ee[0])==null?void 0:ie.error);if(Ee){Oe(li,`RPC '${e}' stream ${r} received error:`,Ee);const pe=Ee.status;let J=(function(V){const B=Rn[V];if(B!==void 0)return x1(B)})(pe),k=Ee.message;J===void 0&&(J=xe.INTERNAL,k="Unknown error status: "+pe+" with message "+Ee.message),M=!0,F.a_(new Ue(J,k)),S.close()}else Oe(li,`RPC '${e}' stream ${r} received:`,re),F.u_(re)}})),H(m,BS.STAT_EVENT,(Y=>{Y.stat===Jp.PROXY?Oe(li,`RPC '${e}' stream ${r} detected buffering proxy`):Y.stat===Jp.NOPROXY&&Oe(li,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{F.__()}),0),F}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Ip(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xf(n){return new U4(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e,t,i=1e3,r=1.5,u=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=r,this.R_=u,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&Oe("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sx="PersistentStream";class O1{constructor(e,t,i,r,u,c,m,g){this.Mi=e,this.S_=i,this.b_=r,this.connection=u,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=m,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new V1(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===xe.RESOURCE_EXHAUSTED?(ur(t.toString()),ur("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===xe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Ue(xe.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.J_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Oe(Sx,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Oe(Sx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class L6 extends O1{constructor(e,t,i,r,u,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,c),this.serializer=u}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=F4(this.serializer,e),i=(function(u){if(!("targetChange"in u))return it.min();const c=u.targetChange;return c.targetIds&&c.targetIds.length?it.min():c.readTime?Co(c.readTime):it.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=ag(this.serializer),t.addTarget=(function(u,c){let m;const g=c.target;if(m=tg(g)?{documents:G4(u,g)}:{query:j4(u,g).ft},m.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){m.resumeToken=A1(u,c.resumeToken);const p=sg(u,c.expectedCount);p!==null&&(m.expectedCount=p)}else if(c.snapshotVersion.compareTo(it.min())>0){m.readTime=Kh(u,c.snapshotVersion.toTimestamp());const p=sg(u,c.expectedCount);p!==null&&(m.expectedCount=p)}return m})(this.serializer,e);const i=Z4(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=ag(this.serializer),t.removeTarget=e,this.q_(t)}}class V6 extends O1{constructor(e,t,i,r,u,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,c),this.serializer=u}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=H4(e.writeResults,e.commitTime),i=Co(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=ag(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>q4(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O6{}class U6 extends O6{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Ue(xe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,c])=>this.connection.Go(e,og(t,i),r,u,c))).catch((u=>{throw u.name==="FirebaseError"?(u.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ue(xe.UNKNOWN,u.toString())}))}Ho(e,t,i,r,u){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,m])=>this.connection.Ho(e,og(t,i),r,c,m,u))).catch((c=>{throw c.name==="FirebaseError"?(c.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Ue(xe.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class z6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ur(t),this.aa=!1):Oe("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl="RemoteStore";class B6{constructor(e,t,i,r,u){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=u,this.Aa.Oo((c=>{i.enqueueAndForget((async()=>{ml(this)&&(Oe(cl,"Restarting streams for network reachability change."),await(async function(g){const p=ot(g);p.Ea.add(4),await ed(p),p.Ra.set("Unknown"),p.Ea.delete(4),await wf(p)})(this))}))})),this.Ra=new z6(i,r)}}async function wf(n){if(ml(n))for(const e of n.da)await e(!0)}async function ed(n){for(const e of n.da)await e(!1)}function U1(n,e){const t=ot(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),m_(t)?f_(t):Pu(t).O_()&&h_(t,e))}function d_(n,e){const t=ot(n),i=Pu(t);t.Ia.delete(e),i.O_()&&z1(t,e),t.Ia.size===0&&(i.O_()?i.L_():ml(t)&&t.Ra.set("Unknown"))}function h_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(it.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Pu(n).Y_(e)}function z1(n,e){n.Va.Ue(e),Pu(n).Z_(e)}function f_(n){n.Va=new D4({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Pu(n).start(),n.Ra.ua()}function m_(n){return ml(n)&&!Pu(n).x_()&&n.Ia.size>0}function ml(n){return ot(n).Ea.size===0}function B1(n){n.Va=void 0}async function F6(n){n.Ra.set("Online")}async function q6(n){n.Ia.forEach(((e,t)=>{h_(n,e)}))}async function H6(n,e){B1(n),m_(n)?(n.Ra.ha(e),f_(n)):n.Ra.set("Unknown")}async function G6(n,e,t){if(n.Ra.set("Online"),e instanceof S1&&e.state===2&&e.cause)try{await(async function(r,u){const c=u.cause;for(const m of u.targetIds)r.Ia.has(m)&&(await r.remoteSyncer.rejectListen(m,c),r.Ia.delete(m),r.Va.removeTarget(m))})(n,e)}catch(i){Oe(cl,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Yh(n,i)}else if(e instanceof Ch?n.Va.Ze(e):e instanceof w1?n.Va.st(e):n.Va.tt(e),!t.isEqual(it.min()))try{const i=await L1(n.localStore);t.compareTo(i)>=0&&await(function(u,c){const m=u.Va.Tt(c);return m.targetChanges.forEach(((g,p)=>{if(g.resumeToken.approximateByteSize()>0){const x=u.Ia.get(p);x&&u.Ia.set(p,x.withResumeToken(g.resumeToken,c))}})),m.targetMismatches.forEach(((g,p)=>{const x=u.Ia.get(g);if(!x)return;u.Ia.set(g,x.withResumeToken(Xn.EMPTY_BYTE_STRING,x.snapshotVersion)),z1(u,g);const S=new na(x.target,g,p,x.sequenceNumber);h_(u,S)})),u.remoteSyncer.applyRemoteEvent(m)})(n,t)}catch(i){Oe(cl,"Failed to raise snapshot:",i),await Yh(n,i)}}async function Yh(n,e,t){if(!Mu(e))throw e;n.Ea.add(1),await ed(n),n.Ra.set("Offline"),t||(t=()=>L1(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Oe(cl,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await wf(n)}))}function F1(n,e){return e().catch((t=>Yh(n,t,e)))}async function Sf(n){const e=ot(n),t=fa(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Jg;for(;j6(e);)try{const r=await C6(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,K6(e,r)}catch(r){await Yh(e,r)}q1(e)&&H1(e)}function j6(n){return ml(n)&&n.Ta.length<10}function K6(n,e){n.Ta.push(e);const t=fa(n);t.O_()&&t.X_&&t.ea(e.mutations)}function q1(n){return ml(n)&&!fa(n).x_()&&n.Ta.length>0}function H1(n){fa(n).start()}async function Z6(n){fa(n).ra()}async function Y6(n){const e=fa(n);for(const t of n.Ta)e.ea(t.mutations)}async function W6(n,e,t){const i=n.Ta.shift(),r=s_.from(i,e,t);await F1(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Sf(n)}async function J6(n,e){e&&fa(n).X_&&await(async function(i,r){if((function(c){return M4(c)&&c!==xe.ABORTED})(r.code)){const u=i.Ta.shift();fa(i).B_(),await F1(i,(()=>i.remoteSyncer.rejectFailedWrite(u.batchId,r))),await Sf(i)}})(n,e),q1(n)&&H1(n)}async function Ax(n,e){const t=ot(n);t.asyncQueue.verifyOperationInProgress(),Oe(cl,"RemoteStore received new credentials");const i=ml(t);t.Ea.add(3),await ed(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await wf(t)}async function Q6(n,e){const t=ot(n);e?(t.Ea.delete(2),await wf(t)):e||(t.Ea.add(2),await ed(t),t.Ra.set("Unknown"))}function Pu(n){return n.ma||(n.ma=(function(t,i,r){const u=ot(t);return u.sa(),new L6(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,r)})(n.datastore,n.asyncQueue,{Xo:F6.bind(null,n),t_:q6.bind(null,n),r_:H6.bind(null,n),H_:G6.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),m_(n)?f_(n):n.Ra.set("Unknown")):(await n.ma.stop(),B1(n))}))),n.ma}function fa(n){return n.fa||(n.fa=(function(t,i,r){const u=ot(t);return u.sa(),new V6(i,u.connection,u.authCredentials,u.appCheckCredentials,u.serializer,r)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Z6.bind(null,n),r_:J6.bind(null,n),ta:Y6.bind(null,n),na:W6.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Sf(n)):(await n.fa.stop(),n.Ta.length>0&&(Oe(cl,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e,t,i,r,u){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=u,this.deferred=new sl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,u){const c=Date.now()+i,m=new p_(e,t,c,r,u);return m.start(i),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ue(xe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function g_(n,e){if(ur("AsyncQueue",`${e}: ${n}`),Mu(n))return new Ue(xe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{static emptySet(e){return new cu(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||je.comparator(t.key,i.key):(t,i)=>je.comparator(t.key,i.key),this.keyedMap=Sc(),this.sortedSet=new hn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof cu)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,u=i.getNext().key;if(!r.isEqual(u))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new cu;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(){this.ga=new hn(je.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):$e(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Tu{constructor(e,t,i,r,u,c,m,g,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=u,this.fromCache=c,this.syncStateChanged=m,this.excludesMetadataChanges=g,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,r,u){const c=[];return t.forEach((m=>{c.push({type:0,doc:m})})),new Tu(e,t,cu.emptySet(t),c,i,r,!0,!1,u)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_f(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class X6{constructor(){this.queries=bx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=ot(t),u=r.queries;r.queries=bx(),u.forEach(((c,m)=>{for(const g of m.Sa)g.onError(i)}))})(this,new Ue(xe.ABORTED,"Firestore shutting down"))}}function bx(){return new fl((n=>c1(n)),_f)}async function eV(n,e){const t=ot(n);let i=3;const r=e.query;let u=t.queries.get(r);u?!u.ba()&&e.Da()&&(i=2):(u=new $6,i=e.Da()?0:1);try{switch(i){case 0:u.wa=await t.onListen(r,!0);break;case 1:u.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(c){const m=g_(c,`Initialization of query '${eu(e.query)}' failed`);return void e.onError(m)}t.queries.set(r,u),u.Sa.push(e),e.va(t.onlineState),u.wa&&e.Fa(u.wa)&&__(t)}async function tV(n,e){const t=ot(n),i=e.query;let r=3;const u=t.queries.get(i);if(u){const c=u.Sa.indexOf(e);c>=0&&(u.Sa.splice(c,1),u.Sa.length===0?r=e.Da()?0:1:!u.ba()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function nV(n,e){const t=ot(n);let i=!1;for(const r of e){const u=r.query,c=t.queries.get(u);if(c){for(const m of c.Sa)m.Fa(r)&&(i=!0);c.wa=r}}i&&__(t)}function iV(n,e,t){const i=ot(n),r=i.queries.get(e);if(r)for(const u of r.Sa)u.onError(t);i.queries.delete(e)}function __(n){n.Ca.forEach((e=>{e.next()}))}var cg,Ix;(Ix=cg||(cg={})).Ma="default",Ix.Cache="cache";class sV{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Tu(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Tu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==cg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e){this.key=e}}class j1{constructor(e){this.key=e}}class oV{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=xt(),this.mutatedKeys=xt(),this.eu=d1(e),this.tu=new cu(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new Cx,r=t?t.tu:this.tu;let u=t?t.mutatedKeys:this.mutatedKeys,c=r,m=!1;const g=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,p=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((x,S)=>{const C=r.get(x),M=yf(this.query,S)?S:null,F=!!C&&this.mutatedKeys.has(C.key),H=!!M&&(M.hasLocalMutations||this.mutatedKeys.has(M.key)&&M.hasCommittedMutations);let Y=!1;C&&M?C.data.isEqual(M.data)?F!==H&&(i.track({type:3,doc:M}),Y=!0):this.su(C,M)||(i.track({type:2,doc:M}),Y=!0,(g&&this.eu(M,g)>0||p&&this.eu(M,p)<0)&&(m=!0)):!C&&M?(i.track({type:0,doc:M}),Y=!0):C&&!M&&(i.track({type:1,doc:C}),Y=!0,(g||p)&&(m=!0)),Y&&(M?(c=c.add(M),u=H?u.add(x):u.delete(x)):(c=c.delete(x),u=u.delete(x)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const x=this.query.limitType==="F"?c.last():c.first();c=c.delete(x.key),u=u.delete(x.key),i.track({type:1,doc:x})}return{tu:c,iu:i,Cs:m,mutatedKeys:u}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const u=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((x,S)=>(function(M,F){const H=Y=>{switch(Y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $e(20277,{Rt:Y})}};return H(M)-H(F)})(x.type,S.type)||this.eu(x.doc,S.doc))),this.ou(i),r=r??!1;const m=t&&!r?this._u():[],g=this.Xa.size===0&&this.current&&!r?1:0,p=g!==this.Za;return this.Za=g,c.length!==0||p?{snapshot:new Tu(this.query,e.tu,u,c,e.mutatedKeys,g===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Cx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=xt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new j1(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new G1(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=xt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Tu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const y_="SyncEngine";class rV{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class aV{constructor(e){this.key=e,this.hu=!1}}class lV{constructor(e,t,i,r,u,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=u,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new fl((m=>c1(m)),_f),this.Iu=new Map,this.Eu=new Set,this.du=new hn(je.comparator),this.Au=new Map,this.Ru=new a_,this.Vu={},this.mu=new Map,this.fu=vu.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function uV(n,e,t=!0){const i=Q1(n);let r;const u=i.Tu.get(e);return u?(i.sharedClientState.addLocalQueryTarget(u.targetId),r=u.view.lu()):r=await K1(i,e,t,!0),r}async function cV(n,e){const t=Q1(n);await K1(t,e,!0,!1)}async function K1(n,e,t,i){const r=await b6(n.localStore,Ao(e)),u=r.targetId,c=n.sharedClientState.addLocalQueryTarget(u,t);let m;return i&&(m=await dV(n,e,u,c==="current",r.resumeToken)),n.isPrimaryClient&&t&&U1(n.remoteStore,r),m}async function dV(n,e,t,i,r){n.pu=(S,C,M)=>(async function(H,Y,ie,re){let ee=Y.view.ru(ie);ee.Cs&&(ee=await Tx(H.localStore,Y.query,!1).then((({documents:k})=>Y.view.ru(k,ee))));const Ee=re&&re.targetChanges.get(Y.targetId),pe=re&&re.targetMismatches.get(Y.targetId)!=null,J=Y.view.applyChanges(ee,H.isPrimaryClient,Ee,pe);return Rx(H,Y.targetId,J.au),J.snapshot})(n,S,C,M);const u=await Tx(n.localStore,e,!0),c=new oV(e,u.Qs),m=c.ru(u.documents),g=Xc.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),p=c.applyChanges(m,n.isPrimaryClient,g);Rx(n,t,p.au);const x=new rV(e,t,c);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function hV(n,e,t){const i=ot(n),r=i.Tu.get(e),u=i.Iu.get(r.targetId);if(u.length>1)return i.Iu.set(r.targetId,u.filter((c=>!_f(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await lg(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&d_(i.remoteStore,r.targetId),dg(i,r.targetId)})).catch(Ru)):(dg(i,r.targetId),await lg(i.localStore,r.targetId,!0))}async function fV(n,e){const t=ot(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),d_(t.remoteStore,i.targetId))}async function mV(n,e,t){const i=EV(n);try{const r=await(function(c,m){const g=ot(c),p=on.now(),x=m.reduce(((M,F)=>M.add(F.key)),xt());let S,C;return g.persistence.runTransaction("Locally write mutations","readwrite",(M=>{let F=cr(),H=xt();return g.Ns.getEntries(M,x).next((Y=>{F=Y,F.forEach(((ie,re)=>{re.isValidDocument()||(H=H.add(ie))}))})).next((()=>g.localDocuments.getOverlayedDocuments(M,F))).next((Y=>{S=Y;const ie=[];for(const re of m){const ee=C4(re,S.get(re.key).overlayedDocument);ee!=null&&ie.push(new _a(re.key,ee,n1(ee.value.mapValue),$s.exists(!0)))}return g.mutationQueue.addMutationBatch(M,p,ie,m)})).next((Y=>{C=Y;const ie=Y.applyToLocalDocumentSet(S,H);return g.documentOverlayCache.saveOverlays(M,Y.batchId,ie)}))})).then((()=>({batchId:C.batchId,changes:f1(S)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(c,m,g){let p=c.Vu[c.currentUser.toKey()];p||(p=new hn(Et)),p=p.insert(m,g),c.Vu[c.currentUser.toKey()]=p})(i,r.batchId,t),await td(i,r.changes),await Sf(i.remoteStore)}catch(r){const u=g_(r,"Failed to persist write");t.reject(u)}}async function Z1(n,e){const t=ot(n);try{const i=await S6(t.localStore,e);e.targetChanges.forEach(((r,u)=>{const c=t.Au.get(u);c&&(Lt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?c.hu=!0:r.modifiedDocuments.size>0?Lt(c.hu,14607):r.removedDocuments.size>0&&(Lt(c.hu,42227),c.hu=!1))})),await td(t,i,e)}catch(i){await Ru(i)}}function Nx(n,e,t){const i=ot(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((u,c)=>{const m=c.view.va(e);m.snapshot&&r.push(m.snapshot)})),(function(c,m){const g=ot(c);g.onlineState=m;let p=!1;g.queries.forEach(((x,S)=>{for(const C of S.Sa)C.va(m)&&(p=!0)})),p&&__(g)})(i.eventManager,e),r.length&&i.Pu.H_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function pV(n,e,t){const i=ot(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),u=r&&r.key;if(u){let c=new hn(je.comparator);c=c.insert(u,ci.newNoDocument(u,it.min()));const m=xt().add(u),g=new Ef(it.min(),new Map,new hn(Et),c,m);await Z1(i,g),i.du=i.du.remove(u),i.Au.delete(e),v_(i)}else await lg(i.localStore,e,!1).then((()=>dg(i,e,t))).catch(Ru)}async function gV(n,e){const t=ot(n),i=e.batch.batchId;try{const r=await w6(t.localStore,e);W1(t,i,null),Y1(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await td(t,r)}catch(r){await Ru(r)}}async function _V(n,e,t){const i=ot(n);try{const r=await(function(c,m){const g=ot(c);return g.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let x;return g.mutationQueue.lookupMutationBatch(p,m).next((S=>(Lt(S!==null,37113),x=S.keys(),g.mutationQueue.removeMutationBatch(p,S)))).next((()=>g.mutationQueue.performConsistencyCheck(p))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(p,x,m))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,x))).next((()=>g.localDocuments.getDocuments(p,x)))}))})(i.localStore,e);W1(i,e,t),Y1(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await td(i,r)}catch(r){await Ru(r)}}function Y1(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function W1(n,e,t){const i=ot(n);let r=i.Vu[i.currentUser.toKey()];if(r){const u=r.get(e);u&&(t?u.reject(t):u.resolve(),r=r.remove(e)),i.Vu[i.currentUser.toKey()]=r}}function dg(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||J1(n,i)}))}function J1(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(d_(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),v_(n))}function Rx(n,e,t){for(const i of t)i instanceof G1?(n.Ru.addReference(i.key,e),yV(n,i)):i instanceof j1?(Oe(y_,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||J1(n,i.key)):$e(19791,{wu:i})}function yV(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(Oe(y_,"New document in limbo: "+t),n.Eu.add(i),v_(n))}function v_(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new je($t.fromString(e)),i=n.fu.next();n.Au.set(i,new aV(t)),n.du=n.du.insert(t,i),U1(n.remoteStore,new na(Ao(t_(t.path)),i,"TargetPurposeLimboResolution",mf.ce))}}async function td(n,e,t){const i=ot(n),r=[],u=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((m,g)=>{c.push(i.pu(g,e,t).then((p=>{var x;if((p||t)&&i.isPrimaryClient){const S=p?!p.fromCache:(x=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:x.current;i.sharedClientState.updateQueryState(g.targetId,S?"current":"not-current")}if(p){r.push(p);const S=u_.As(g.targetId,p);u.push(S)}})))})),await Promise.all(c),i.Pu.H_(r),await(async function(g,p){const x=ot(g);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(S=>we.forEach(p,(C=>we.forEach(C.Es,(M=>x.persistence.referenceDelegate.addReference(S,C.targetId,M))).next((()=>we.forEach(C.ds,(M=>x.persistence.referenceDelegate.removeReference(S,C.targetId,M)))))))))}catch(S){if(!Mu(S))throw S;Oe(c_,"Failed to update sequence numbers: "+S)}for(const S of p){const C=S.targetId;if(!S.fromCache){const M=x.Ms.get(C),F=M.snapshotVersion,H=M.withLastLimboFreeSnapshotVersion(F);x.Ms=x.Ms.insert(C,H)}}})(i.localStore,u))}async function vV(n,e){const t=ot(n);if(!t.currentUser.isEqual(e)){Oe(y_,"User change. New user:",e.toKey());const i=await D1(t.localStore,e);t.currentUser=e,(function(u,c){u.mu.forEach((m=>{m.forEach((g=>{g.reject(new Ue(xe.CANCELLED,c))}))})),u.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await td(t,i.Ls)}}function TV(n,e){const t=ot(n),i=t.Au.get(e);if(i&&i.hu)return xt().add(i.key);{let r=xt();const u=t.Iu.get(e);if(!u)return r;for(const c of u){const m=t.Tu.get(c);r=r.unionWith(m.view.nu)}return r}}function Q1(n){const e=ot(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Z1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=TV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pV.bind(null,e),e.Pu.H_=nV.bind(null,e.eventManager),e.Pu.yu=iV.bind(null,e.eventManager),e}function EV(n){const e=ot(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_V.bind(null,e),e}class Wh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return x6(this.persistence,new v6,e.initialUser,this.serializer)}Cu(e){return new k1(l_.mi,this.serializer)}Du(e){return new N6}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Wh.provider={build:()=>new Wh};class xV extends Wh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Lt(this.persistence.referenceDelegate instanceof Zh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new s6(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?qi.withCacheSize(this.cacheSizeBytes):qi.DEFAULT;return new k1((i=>Zh.mi(i,t)),this.serializer)}}class hg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Nx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=vV.bind(null,this.syncEngine),await Q6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new X6})()}createDatastore(e){const t=xf(e.databaseInfo.databaseId),i=(function(u){return new D6(u)})(e.databaseInfo);return(function(u,c,m,g){return new U6(u,c,m,g)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,u,c,m){return new B6(i,r,u,c,m)})(this.localStore,this.datastore,e.asyncQueue,(t=>Nx(this.syncEngine,t,0)),(function(){return wx.v()?new wx:new R6})())}createSyncEngine(e,t){return(function(r,u,c,m,g,p,x){const S=new lV(r,u,c,m,g,p);return x&&(S.gu=!0),S})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const u=ot(r);Oe(cl,"RemoteStore shutting down."),u.Ea.add(5),await ed(u),u.Aa.shutdown(),u.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}hg.provider={build:()=>new hg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wV{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ur("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma="FirestoreClient";class SV{constructor(e,t,i,r,u){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=ui.UNAUTHENTICATED,this.clientId=Wg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=u,this.authCredentials.start(i,(async c=>{Oe(ma,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Oe(ma,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=g_(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Np(n,e){n.asyncQueue.verifyOperationInProgress(),Oe(ma,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await D1(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function Mx(n,e){n.asyncQueue.verifyOperationInProgress();const t=await AV(n);Oe(ma,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>Ax(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>Ax(e.remoteStore,r))),n._onlineComponents=e}async function AV(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Oe(ma,"Using user provided OfflineComponentProvider");try{await Np(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===xe.FAILED_PRECONDITION||r.code===xe.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;pu("Error using user provided cache. Falling back to memory cache: "+t),await Np(n,new Wh)}}else Oe(ma,"Using default OfflineComponentProvider"),await Np(n,new xV(void 0));return n._offlineComponents}async function $1(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Oe(ma,"Using user provided OnlineComponentProvider"),await Mx(n,n._uninitializedComponentsProvider._online)):(Oe(ma,"Using default OnlineComponentProvider"),await Mx(n,new hg))),n._onlineComponents}function CV(n){return $1(n).then((e=>e.syncEngine))}async function Px(n){const e=await $1(n),t=e.eventManager;return t.onListen=uV.bind(null,e.syncEngine),t.onUnlisten=hV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=cV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=fV.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X1(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA="firestore.googleapis.com",Dx=!0;class Lx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ue(xe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=eA,this.ssl=Dx}else this.host=e.host,this.ssl=e.ssl??Dx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=P1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<n6)throw new Ue(xe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}z3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=X1(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ue(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ue(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ue(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Af{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Lx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ue(xe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ue(xe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Lx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new N3;switch(i.type){case"firstParty":return new k3(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ue(xe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=kx.get(t);i&&(Oe("ComponentProvider","Removing Datastore"),kx.delete(t),i.terminate())})(this),Promise.resolve()}}function bV(n,e,t,i={}){var p;n=aa(n,Af);const r=Cu(e),u=n._getSettings(),c={...u,emulatorOptions:n._getEmulatorOptions()},m=`${e}:${t}`;r&&(Xw(`https://${m}`),eS("Firestore",!0)),u.host!==eA&&u.host!==m&&pu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...u,host:m,ssl:r,emulatorOptions:i};if(!rl(g,c)&&(n._setSettings(g),i.mockUserToken)){let x,S;if(typeof i.mockUserToken=="string")x=i.mockUserToken,S=ui.MOCK_USER;else{x=X5(i.mockUserToken,(p=n._app)==null?void 0:p.options.projectId);const C=i.mockUserToken.sub||i.mockUserToken.user_id;if(!C)throw new Ue(xe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");S=new ui(C)}n._authCredentials=new R3(new GS(x,S))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new ku(this.firestore,e,this._query)}}class kn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new la(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new kn(this.firestore,e,this._key)}toJSON(){return{type:kn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Jc(t,kn._jsonSchema))return new kn(e,i||null,new je($t.fromString(t.referencePath)))}}kn._jsonSchemaVersion="firestore/documentReference/1.0",kn._jsonSchema={type:Pn("string",kn._jsonSchemaVersion),referencePath:Pn("string")};class la extends ku{constructor(e,t,i){super(e,t,t_(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new kn(this.firestore,null,new je(e))}withConverter(e){return new la(this.firestore,e,this._path)}}function Vx(n,e,...t){if(n=Zn(n),jS("collection","path",e),n instanceof Af){const i=$t.fromString(e,...t);return ZE(i),new la(n,null,i)}{if(!(n instanceof kn||n instanceof la))throw new Ue(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child($t.fromString(e,...t));return ZE(i),new la(n.firestore,null,i)}}function fg(n,e,...t){if(n=Zn(n),arguments.length===1&&(e=Wg.newId()),jS("doc","path",e),n instanceof Af){const i=$t.fromString(e,...t);return KE(i),new kn(n,null,new je(i))}{if(!(n instanceof kn||n instanceof la))throw new Ue(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child($t.fromString(e,...t));return KE(i),new kn(n.firestore,n instanceof la?n.converter:null,new je(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox="AsyncQueue";class Ux{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new V1(this,"async_queue_retry"),this._c=()=>{const i=Ip();i&&Oe(Ox,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=Ip();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ip();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new sl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Mu(e))throw e;Oe(Ox,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,ur("INTERNAL UNHANDLED ERROR: ",zx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=p_.createAndSchedule(this,e,t,i,(u=>this.hc(u)));return this.tc.push(r),r}uc(){this.nc&&$e(47125,{Pc:zx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function zx(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const r=t;for(const u of i)if(u in r&&typeof r[u]=="function")return!0;return!1})(n,["next","error","complete"])}class Eu extends Af{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new Ux,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ux(e),this._firestoreClient=void 0,await e}}}function IV(n,e){const t=typeof n=="object"?n:sS(),i=typeof n=="string"?n:Fh,r=Og(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const u=Q5("firestore");u&&bV(r,...u)}return r}function tA(n){if(n._terminated)throw new Ue(xe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||NV(n),n._firestoreClient}function NV(n){var i,r,u;const e=n._freezeSettings(),t=(function(m,g,p,x){return new J3(m,g,p,x.host,x.ssl,x.experimentalForceLongPolling,x.experimentalAutoDetectLongPolling,X1(x.experimentalLongPollingOptions),x.useFetchStreams,x.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((u=e.localCache)!=null&&u._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new SV(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(m){const g=m==null?void 0:m._online.build();return{_offline:m==null?void 0:m._offline.build(g),_online:g}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ms(Xn.fromBase64String(e))}catch(t){throw new Ue(xe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ms(Xn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ms._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Jc(e,Ms._jsonSchema))return Ms.fromBase64String(e.bytes)}}Ms._jsonSchemaVersion="firestore/bytes/1.0",Ms._jsonSchema={type:Pn("string",Ms._jsonSchemaVersion),bytes:Pn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ue(xe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $n(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ue(xe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ue(xe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Et(this._lat,e._lat)||Et(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:bo._jsonSchemaVersion}}static fromJSON(e){if(Jc(e,bo._jsonSchema))return new bo(e.latitude,e.longitude)}}bo._jsonSchemaVersion="firestore/geoPoint/1.0",bo._jsonSchema={type:Pn("string",bo._jsonSchemaVersion),latitude:Pn("number"),longitude:Pn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let u=0;u<i.length;++u)if(i[u]!==r[u])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Io._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Jc(e,Io._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Io(e.vectorValues);throw new Ue(xe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Io._jsonSchemaVersion="firestore/vectorValue/1.0",Io._jsonSchema={type:Pn("string",Io._jsonSchemaVersion),vectorValues:Pn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RV=/^__.*__$/;class MV{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new _a(e,this.data,this.fieldMask,t,this.fieldTransforms):new $c(e,this.data,t,this.fieldTransforms)}}class nA{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new _a(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function iA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $e(40011,{Ac:n})}}class T_{constructor(e,t,i,r,u,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,u===void 0&&this.Rc(),this.fieldTransforms=u||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new T_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Jh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(iA(this.Ac)&&RV.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class PV{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||xf(e)}Cc(e,t,i,r=!1){return new T_({Ac:e,methodName:t,Dc:i,path:$n.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function E_(n){const e=n._freezeSettings(),t=xf(n._databaseId);return new PV(n._databaseId,!!e.ignoreUndefinedProperties,t)}function kV(n,e,t,i,r,u={}){const c=n.Cc(u.merge||u.mergeFields?2:0,e,t,r);w_("Data must be an object, but it was:",c,i);const m=sA(i,c);let g,p;if(u.merge)g=new us(c.fieldMask),p=c.fieldTransforms;else if(u.mergeFields){const x=[];for(const S of u.mergeFields){const C=mg(e,S,t);if(!c.contains(C))throw new Ue(xe.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);rA(x,C)||x.push(C)}g=new us(x),p=c.fieldTransforms.filter((S=>g.covers(S.field)))}else g=null,p=c.fieldTransforms;return new MV(new Hi(m),g,p)}class If extends bf{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof If}}class x_ extends bf{_toFieldTransform(e){return new x4(e.path,new qc)}isEqual(e){return e instanceof x_}}function DV(n,e,t,i){const r=n.Cc(1,e,t);w_("Data must be an object, but it was:",r,i);const u=[],c=Hi.empty();ga(i,((g,p)=>{const x=S_(e,g,t);p=Zn(p);const S=r.yc(x);if(p instanceof If)u.push(x);else{const C=nd(p,S);C!=null&&(u.push(x),c.set(x,C))}}));const m=new us(u);return new nA(c,m,r.fieldTransforms)}function LV(n,e,t,i,r,u){const c=n.Cc(1,e,t),m=[mg(e,i,t)],g=[r];if(u.length%2!=0)throw new Ue(xe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<u.length;C+=2)m.push(mg(e,u[C])),g.push(u[C+1]);const p=[],x=Hi.empty();for(let C=m.length-1;C>=0;--C)if(!rA(p,m[C])){const M=m[C];let F=g[C];F=Zn(F);const H=c.yc(M);if(F instanceof If)p.push(M);else{const Y=nd(F,H);Y!=null&&(p.push(M),x.set(M,Y))}}const S=new us(p);return new nA(x,S,c.fieldTransforms)}function VV(n,e,t,i=!1){return nd(t,n.Cc(i?4:3,e))}function nd(n,e){if(oA(n=Zn(n)))return w_("Unsupported field value:",e,n),sA(n,e);if(n instanceof bf)return(function(i,r){if(!iA(r.Ac))throw r.Sc(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${i._methodName}() is not currently supported inside arrays`);const u=i._toFieldTransform(r);u&&r.fieldTransforms.push(u)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,r){const u=[];let c=0;for(const m of i){let g=nd(m,r.wc(c));g==null&&(g={nullValue:"NULL_VALUE"}),u.push(g),c++}return{arrayValue:{values:u}}})(n,e)}return(function(i,r){if((i=Zn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return v4(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const u=on.fromDate(i);return{timestampValue:Kh(r.serializer,u)}}if(i instanceof on){const u=new on(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Kh(r.serializer,u)}}if(i instanceof bo)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Ms)return{bytesValue:A1(r.serializer,i._byteString)};if(i instanceof kn){const u=r.databaseId,c=i.firestore._databaseId;if(!c.isEqual(u))throw r.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${u.projectId}/${u.database}`);return{referenceValue:r_(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Io)return(function(c,m){return{mapValue:{fields:{[e1]:{stringValue:t1},[qh]:{arrayValue:{values:c.toArray().map((p=>{if(typeof p!="number")throw m.Sc("VectorValues must only contain numeric values.");return n_(m.serializer,p)}))}}}}}})(i,r);throw r.Sc(`Unsupported field value: ${ff(i)}`)})(n,e)}function sA(n,e){const t={};return YS(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ga(n,((i,r)=>{const u=nd(r,e.mc(i));u!=null&&(t[i]=u)})),{mapValue:{fields:t}}}function oA(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof on||n instanceof bo||n instanceof Ms||n instanceof kn||n instanceof bf||n instanceof Io)}function w_(n,e,t){if(!oA(t)||!KS(t)){const i=ff(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function mg(n,e,t){if((e=Zn(e))instanceof Cf)return e._internalPath;if(typeof e=="string")return S_(n,e);throw Jh("Field path arguments must be of type string or ",n,!1,void 0,t)}const OV=new RegExp("[~\\*/\\[\\]]");function S_(n,e,t){if(e.search(OV)>=0)throw Jh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Cf(...e.split("."))._internalPath}catch{throw Jh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Jh(n,e,t,i,r){const u=i&&!i.isEmpty(),c=r!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let g="";return(u||c)&&(g+=" (found",u&&(g+=` in field ${i}`),c&&(g+=` in document ${r}`),g+=")"),new Ue(xe.INVALID_ARGUMENT,m+n+g)}function rA(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{constructor(e,t,i,r,u){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=u}get id(){return this._key.path.lastSegment()}get ref(){return new kn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new UV(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(A_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class UV extends aA{data(){return super.data()}}function A_(n,e){return typeof e=="string"?S_(n,e):e instanceof Cf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zV(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ue(xe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class C_{}class BV extends C_{}function FV(n,e,...t){let i=[];e instanceof C_&&i.push(e),i=i.concat(t),(function(u){const c=u.filter((g=>g instanceof b_)).length,m=u.filter((g=>g instanceof Nf)).length;if(c>1||c>0&&m>0)throw new Ue(xe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const r of i)n=r._apply(n);return n}class Nf extends BV{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Nf(e,t,i)}_apply(e){const t=this._parse(e);return lA(e._query,t),new ku(e.firestore,e.converter,ng(e._query,t))}_parse(e){const t=E_(e.firestore);return(function(u,c,m,g,p,x,S){let C;if(p.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new Ue(xe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){qx(S,x);const F=[];for(const H of S)F.push(Fx(g,u,H));C={arrayValue:{values:F}}}else C=Fx(g,u,S)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||qx(S,x),C=VV(m,c,S,x==="in"||x==="not-in");return Mn.create(p,x,C)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function qV(n,e,t){const i=e,r=A_("where",n);return Nf._create(r,i,t)}class b_ extends C_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new b_(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:Xs.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(r,u){let c=r;const m=u.getFlattenedFilters();for(const g of m)lA(c,g),c=ng(c,g)})(e._query,t),new ku(e.firestore,e.converter,ng(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Fx(n,e,t){if(typeof(t=Zn(t))=="string"){if(t==="")throw new Ue(xe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!u1(e)&&t.indexOf("/")!==-1)throw new Ue(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child($t.fromString(t));if(!je.isDocumentKey(i))throw new Ue(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return tx(n,new je(i))}if(t instanceof kn)return tx(n,t._key);throw new Ue(xe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ff(t)}.`)}function qx(n,e){if(!Array.isArray(n)||n.length===0)throw new Ue(xe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function lA(n,e){const t=(function(r,u){for(const c of r)for(const m of c.getFlattenedFilters())if(u.indexOf(m.op)>=0)return m.op;return null})(n.filters,(function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ue(xe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ue(xe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class HV{convertValue(e,t="none"){switch(ha(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(da(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw $e(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return ga(e,((r,u)=>{i[r]=this.convertValue(u,t)})),i}convertVectorValue(e){var i,r,u;const t=(u=(r=(i=e.fields)==null?void 0:i[qh].arrayValue)==null?void 0:r.values)==null?void 0:u.map((c=>wn(c.doubleValue)));return new Io(t)}convertGeoPoint(e){return new bo(wn(e.latitude),wn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=gf(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(zc(e));default:return null}}convertTimestamp(e){const t=ca(e);return new on(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=$t.fromString(e);Lt(M1(i),9688,{name:e});const r=new Bc(i.get(1),i.get(3)),u=new je(i.popFirst(5));return r.isEqual(t)||ur(`Document ${u} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GV(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class Cc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ol extends aA{constructor(e,t,i,r,u,c){super(e,t,i,r,c),this._firestore=e,this._firestoreImpl=e,this.metadata=u}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new bh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(A_("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(xe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ol._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ol._jsonSchemaVersion="firestore/documentSnapshot/1.0",ol._jsonSchema={type:Pn("string",ol._jsonSchemaVersion),bundleSource:Pn("string","DocumentSnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class bh extends ol{data(e={}){return super.data(e)}}class du{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Cc(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new bh(this._firestore,this._userDataWriter,i.key,i,new Cc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ue(xe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,u){if(r._snapshot.oldDocs.isEmpty()){let c=0;return r._snapshot.docChanges.map((m=>{const g=new bh(r._firestore,r._userDataWriter,m.doc.key,m.doc,new Cc(r._snapshot.mutatedKeys.has(m.doc.key),r._snapshot.fromCache),r.query.converter);return m.doc,{type:"added",doc:g,oldIndex:-1,newIndex:c++}}))}{let c=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((m=>u||m.type!==3)).map((m=>{const g=new bh(r._firestore,r._userDataWriter,m.doc.key,m.doc,new Cc(r._snapshot.mutatedKeys.has(m.doc.key),r._snapshot.fromCache),r.query.converter);let p=-1,x=-1;return m.type!==0&&(p=c.indexOf(m.doc.key),c=c.delete(m.doc.key)),m.type!==1&&(c=c.add(m.doc),x=c.indexOf(m.doc.key)),{type:jV(m.type),doc:g,oldIndex:p,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(xe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=du._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Wg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((u=>{u._document!==null&&(t.push(u._document),i.push(this._userDataWriter.convertObjectMap(u._document.data.value.mapValue.fields,"previous")),r.push(u.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function jV(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $e(61501,{type:n})}}du._jsonSchemaVersion="firestore/querySnapshot/1.0",du._jsonSchema={type:Pn("string",du._jsonSchemaVersion),bundleSource:Pn("string","QuerySnapshot"),bundleName:Pn("string"),bundle:Pn("string")};class uA extends HV{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ms(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new kn(this.firestore,null,t)}}function KV(n,e,t,...i){n=aa(n,kn);const r=aa(n.firestore,Eu),u=E_(r);let c;return c=typeof(e=Zn(e))=="string"||e instanceof Cf?LV(u,"updateDoc",n._key,e,t,i):DV(u,"updateDoc",n._key,e),I_(r,[c.toMutation(n._key,$s.exists(!0))])}function ZV(n){return I_(aa(n.firestore,Eu),[new i_(n._key,$s.none())])}function YV(n,e){const t=aa(n.firestore,Eu),i=fg(n),r=GV(n.converter,e);return I_(t,[kV(E_(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,$s.exists(!1))]).then((()=>i))}function WV(n,...e){var g,p,x;n=Zn(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||Bx(e[i])||(t=e[i++]);const r={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(Bx(e[i])){const S=e[i];e[i]=(g=S.next)==null?void 0:g.bind(S),e[i+1]=(p=S.error)==null?void 0:p.bind(S),e[i+2]=(x=S.complete)==null?void 0:x.bind(S)}let u,c,m;if(n instanceof kn)c=aa(n.firestore,Eu),m=t_(n._key.path),u={next:S=>{e[i]&&e[i](JV(c,n,S))},error:e[i+1],complete:e[i+2]};else{const S=aa(n,ku);c=aa(S.firestore,Eu),m=S._query;const C=new uA(c);u={next:M=>{e[i]&&e[i](new du(c,C,S,M))},error:e[i+1],complete:e[i+2]},zV(n._query)}return(function(C,M,F,H){const Y=new wV(H),ie=new sV(M,Y,F);return C.asyncQueue.enqueueAndForget((async()=>eV(await Px(C),ie))),()=>{Y.Nu(),C.asyncQueue.enqueueAndForget((async()=>tV(await Px(C),ie)))}})(tA(c),m,r,u)}function I_(n,e){return(function(i,r){const u=new sl;return i.asyncQueue.enqueueAndForget((async()=>mV(await CV(i),r,u))),u.promise})(tA(n),e)}function JV(n,e,t){const i=t.docs.get(e._key),r=new uA(n);return new ol(n,r,e._key,i,new Cc(t.hasPendingWrites,t.fromCache),e.converter)}function QV(){return new x_("serverTimestamp")}(function(e,t=!0){(function(r){Nu=r})(bu),fu(new al("firestore",((i,{instanceIdentifier:r,options:u})=>{const c=i.getProvider("app").getImmediate(),m=new Eu(new M3(i.getProvider("auth-internal")),new D3(c,i.getProvider("app-check-internal")),(function(p,x){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Ue(xe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bc(p.options.projectId,x)})(c,r),c);return u={useFetchStreams:t,...u},m._setSettings(u),m}),"PUBLIC").setMultipleInstances(!0)),oa(qE,HE,e),oa(qE,HE,"esm2020")})();const $V={apiKey:"AIzaSyBCnLlCaVWh9iKhclzPWJcEPDuyH0OHPUM",authDomain:"ques-trip.firebaseapp.com",projectId:"ques-trip",storageBucket:"ques-trip.firebasestorage.app",messagingSenderId:"765263595886",appId:"1:765263595886:web:3e501d362abe47bfb8597f",measurementId:"G-R1NF9EVRHY"},N_=iS($V);console.log("Firebase App Initialized:",N_.name);const pg=A3(N_),XV=new tr,ph=IV(N_),eO=({onLogin:n})=>{const[e,t]=W.useState(""),[i,r]=W.useState(!1),u=async()=>{console.log("Attempting Google Login..."),r(!0),t("");try{const c=await DL(pg,XV);console.log("Google Login Success:",c.user.uid)}catch(c){console.error("Login failed",c),t(c.message||"")}finally{r(!1)}};return E.jsx("div",{className:"h-full flex flex-col items-center justify-center p-6 bg-paper",children:E.jsxs("div",{className:"w-full max-w-sm bg-white rounded-3xl shadow-card p-8 border border-sand text-center",children:[E.jsxs("div",{className:"flex flex-col items-center mb-8",children:[E.jsx("div",{className:"w-16 h-16 bg-coral rounded-2xl flex items-center justify-center mb-4 shadow-lg shadow-coral/30",children:E.jsx(sr,{className:"w-8 h-8 text-white"})}),E.jsx("h1",{className:"text-2xl font-bold text-ink",children:"Ques-trip"}),E.jsx("p",{className:"text-gray-400 text-sm mt-2",children:""})]}),E.jsxs("div",{className:"space-y-4",children:[E.jsxs("button",{id:"google-login-btn",onClick:u,disabled:i,className:"w-full bg-white border border-gray-300 text-gray-700 py-3.5 rounded-xl font-bold shadow-sm hover:bg-gray-50 active:scale-95 transition-all flex items-center justify-center gap-3",children:[i?E.jsx("div",{className:"w-5 h-5 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}):E.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[E.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),E.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),E.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.84z",fill:"#FBBC05"}),E.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]})," Google "]}),e&&E.jsx("div",{className:"text-red-500 text-sm font-medium bg-red-50 p-2 rounded-lg",children:e})]})]})})},tO=({memories:n,onAddMemory:e,onDeleteMemory:t,settings:i})=>{const[r,u]=W.useState(""),[c,m]=W.useState(null),g=W.useRef(null),p=async S=>{var M;const C=(M=S.target.files)==null?void 0:M[0];if(C)try{const{compressImage:F}=await nf(async()=>{const{compressImage:Y}=await import("./image-CYcWJ_KT.js");return{compressImage:Y}},[]),H=await F(C);m(H)}catch(F){console.error("Image compression failed",F),alert("")}},x=S=>{if(S.preventDefault(),!c)return;const C={id:Date.now().toString(),userId:"",imageUrl:c,caption:r,date:new Date().toISOString()};e(C),u(""),m(null),g.current&&(g.current.value="")};return E.jsxs("div",{className:"h-full flex flex-col bg-paper animate-slide-in pb-24",children:[E.jsxs("div",{className:"px-6 py-6 bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-sand pt-safe pt-12",children:[E.jsxs("h1",{className:"text-2xl font-bold text-ink flex items-center gap-2",children:[E.jsx(hu,{className:"w-8 h-8 text-coral"}),""]}),E.jsx("p",{className:"text-sm text-gray-400 mt-1",children:""})]}),E.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[E.jsx("div",{className:"bg-white rounded-3xl p-6 shadow-card border border-sand",children:E.jsxs("form",{onSubmit:x,className:"space-y-4",children:[E.jsxs("div",{onClick:()=>{var S;return(S=g.current)==null?void 0:S.click()},className:`relative w-full aspect-video rounded-2xl border-2 border-dashed border-sand flex flex-col items-center justify-center cursor-pointer transition-all hover:bg-gray-50 ${c?"border-none p-0 overflow-hidden":""}`,children:[c?E.jsx("img",{src:c,alt:"Preview",className:"w-full h-full object-cover"}):E.jsxs("div",{className:"flex flex-col items-center text-gray-400",children:[E.jsx(hu,{className:"w-12 h-12 mb-2"}),E.jsx("span",{className:"font-medium",children:""})]}),E.jsx("input",{type:"file",ref:g,onChange:p,accept:"image/*",className:"hidden"})]}),E.jsx("textarea",{value:r,onChange:S=>u(S.target.value),placeholder:"...",className:"w-full bg-paper rounded-xl p-4 text-ink font-medium outline-none focus:ring-2 focus:ring-coral/50 transition-all border border-sand resize-none h-24"}),E.jsxs("button",{type:"submit",disabled:!c,className:`w-full py-3.5 rounded-xl font-bold shadow-lg transition-all flex items-center justify-center gap-2 ${c?"bg-coral text-white shadow-coral/30 active:scale-95":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:[E.jsx(Qh,{className:"w-5 h-5"}),""]})]})}),E.jsx("div",{className:"grid grid-cols-1 gap-6",children:n.length===0?E.jsxs("div",{className:"text-center py-12 text-gray-400",children:[E.jsx("p",{children:""}),E.jsx("p",{className:"text-sm mt-2",children:""})]}):n.map(S=>E.jsxs("div",{className:"bg-white rounded-3xl overflow-hidden shadow-card border border-sand group",children:[E.jsxs("div",{className:"relative aspect-video",children:[E.jsx("img",{src:S.imageUrl,alt:S.caption,className:"w-full h-full object-cover"}),E.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-end p-4",children:E.jsx("button",{onClick:()=>t(S.id),className:"p-2 bg-white/20 backdrop-blur-md text-white rounded-full hover:bg-red-500 transition-colors",children:E.jsx(or,{className:"w-5 h-5"})})})]}),E.jsxs("div",{className:"p-5",children:[E.jsx("p",{className:"text-ink font-medium whitespace-pre-wrap",children:S.caption}),E.jsx("p",{className:"text-xs text-gray-400 mt-3",children:new Date(S.date).toLocaleDateString()})]})]},S.id))})]})]})};function nO(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:i,onRegistered:r,onRegisteredSW:u,onRegisterError:c}=n;let m,g;const p=async(S=!0)=>{await g};async function x(){if("serviceWorker"in navigator){if(m=await nf(async()=>{const{Workbox:S}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:S}},[]).then(({Workbox:S})=>new S("/sw.js",{scope:"/",type:"classic"})).catch(S=>{c==null||c(S)}),!m)return;m.addEventListener("activated",S=>{(S.isUpdate||S.isExternal)&&window.location.reload()}),m.addEventListener("installed",S=>{S.isUpdate||i==null||i()}),m.register({immediate:e}).then(S=>{u?u("/sw.js",S):r==null||r(S)}).catch(S=>{c==null||c(S)})}}return g=x(),p}function iO(n={}){const{immediate:e=!0,onNeedRefresh:t,onOfflineReady:i,onRegistered:r,onRegisteredSW:u,onRegisterError:c}=n,[m,g]=W.useState(!1),[p,x]=W.useState(!1),[S]=W.useState(()=>nO({immediate:e,onOfflineReady(){x(!0),i==null||i()},onNeedRefresh(){g(!0),t==null||t()},onRegistered:r,onRegisteredSW:u,onRegisterError:c}));return{needRefresh:[m,g],offlineReady:[p,x],updateServiceWorker:S}}const sO=({settings:n})=>{n&&Wt[n.language]||Wt["zh-TW"];const{offlineReady:[e,t],needRefresh:[i,r],updateServiceWorker:u}=iO({onRegistered(m){console.log("SW Registered: "+m)},onRegisterError(m){console.log("SW registration error",m)}}),c=()=>{t(!1),r(!1)};return!e&&!i?null:E.jsxs("div",{className:"fixed bottom-6 right-6 z-[1000] p-4 bg-ink text-white rounded-xl shadow-2xl animate-slide-up max-w-xs border border-white/10",children:[E.jsx("div",{className:"mb-3 font-bold",children:e?E.jsx("span",{children:"App ready to work offline"}):E.jsx("span",{children:"New content available, click on reload button to update."})}),E.jsxs("div",{className:"flex gap-2",children:[i&&E.jsx("button",{className:"flex-1 px-3 py-2 bg-coral text-white rounded-lg font-bold text-sm hover:bg-coralDark transition-colors",onClick:()=>u(!0),children:"Reload"}),E.jsx("button",{className:"flex-1 px-3 py-2 bg-white/10 text-white rounded-lg font-bold text-sm hover:bg-white/20 transition-colors",onClick:c,children:"Close"})]})]})},oO={USERS:"nomad_app_users_v1",CURRENT_USER:"nomad_app_current_user_v1",getTripsKey:n=>`nomad_app_trips_${n} `,getSettingsKey:n=>`nomad_app_settings_${n} `,getMemoriesKey:n=>`nomad_app_memories_${n} `,getChatSessionsKey:n=>`nomad_app_chat_sessions_${n} `},rO=()=>{console.log("App Component Rendering...");const[n,e]=W.useState({id:"test-user-id",username:"Test User",password:"",createdAt:new Date().toISOString()}),[t,i]=W.useState([]),[r,u]=W.useState([]),[c,m]=W.useState([]),[g,p]=W.useState(null),[x,S]=W.useState({language:"zh-TW",minimalistMode:!1}),[C,M]=W.useState(!0),[F,H]=W.useState(null),[Y,ie]=W.useState(nt.HOME),[re,ee]=W.useState(null),[Ee,pe]=W.useState([]);W.useEffect(()=>{console.log("Setting up Auth Listener...");const ce=fL(pg,me=>{if(console.log("Auth State Changed:",me?"User Logged In":"User Logged Out",me==null?void 0:me.uid),me){const Ce={id:me.uid,username:me.displayName||"Traveler",password:"",createdAt:me.metadata.creationTime||new Date().toISOString()};e(Ce),console.log("Listening to trips for user:",me.uid);const _e=FV(Vx(ph,"itineraries"),qV("uid","==",me.uid)),Pe=WV(_e,ke=>{const Je=[];ke.forEach(wt=>{const Ze=wt.data();Je.push({id:wt.id,...Ze})}),Je.sort((wt,Ze)=>{const Jt=wt.createdAt?typeof wt.createdAt=="string"?new Date(wt.createdAt).getTime():wt.createdAt.toMillis?wt.createdAt.toMillis():0:0;return(Ze.createdAt?typeof Ze.createdAt=="string"?new Date(Ze.createdAt).getTime():Ze.createdAt.toMillis?Ze.createdAt.toMillis():0:0)-Jt}),i(Je),M(!0),H(null)},ke=>{console.error("Error fetching trips:",ke),H(`Fetch Trips Error: ${ke.message}`),M(!0)});return()=>Pe()}else e(null),i([]),M(!0)});return()=>ce()},[]);const J=async ce=>{if(n)try{const{id:me,...Ce}=ce;await YV(Vx(ph,"itineraries"),{...Ce,uid:n.id,createdAt:QV()}),Y===nt.AI_PLANNER&&ie(nt.HOME)}catch(me){console.error("Error adding trip",me),H(`Add Trip Error: ${me.message}`),alert(": "+me.message)}},k=async ce=>{if(!(!n||!ce.id))try{const me=fg(ph,"itineraries",ce.id),{id:Ce,..._e}=ce;await KV(me,_e),(re==null?void 0:re.id)===ce.id&&ee(ce)}catch(me){console.error("Error updating trip",me),alert("")}},U=async ce=>{try{await ZV(fg(ph,"itineraries",ce)),(re==null?void 0:re.id)===ce&&(ee(null),ie(nt.HOME))}catch(me){console.error("Error deleting trip",me),alert("")}},V=W.useCallback(async(ce,me)=>{var _e;console.log("Starting background generation...",{userPrompt:ce,tripId:me});const Ce=Date.now().toString();pe(Pe=>[...Pe,Ce]);try{let Pe,ke=null;me&&(ke=t.find(Ze=>Ze.id===me)),ke?(console.log("Updating existing trip:",ke.title),Pe=await bw(ke,ce,x.language),console.log("Updated Trip Plan:",Pe)):(console.log("Generating new trip..."),Pe=await Cw(ce,x.language),console.log("New Trip Plan:",Pe));let Je=Pe.coverImage||(ke==null?void 0:ke.coverImage);if(!Je)try{const Ze=Pe.title||ce;Je=await bg(Ze)}catch(Ze){console.error("Failed to generate cover image:",Ze),Je=`https://placehold.co/800x600/e2e8f0/475569?text=${encodeURIComponent(((_e=Pe.title)==null?void 0:_e.split(" ")[0])||"Travel")}`}!Pe.itinerary||Pe.itinerary.length===0?console.warn("AI returned empty itinerary:",Pe):Pe.itinerary=Pe.itinerary.map(Ze=>({...Ze,day:Number(Ze.day)||1,id:Ze.id||Math.random().toString(36).substr(2,9),time:Ze.time||"09:00",activity:Ze.activity||"New Activity",location:Ze.location||"",notes:Ze.notes||""}));let wt;return ke?(wt={...ke,...Pe,id:ke.id,coverImage:Je},k(wt)):(wt={...Pe,id:Ce,coverImage:Je,bookings:[],budget:Pe.budget||{total:0,currency:"TWD",expenses:[]},weather:Pe.weather||[]},J(wt)),pe(Ze=>Ze.filter(Jt=>Jt!==Ce)),{title:wt.title,tripId:wt.id}}catch(Pe){return console.error("Background generation failed",Pe),pe(ke=>ke.filter(Je=>Je!==Ce)),null}},[t,x.language]),B=ce=>{S(me=>({...me,...ce}))},q=()=>{n&&K()},K=async()=>{try{await mL(pg),ie(nt.HOME),ee(null)}catch(ce){console.error("Logout failed",ce)}},z=()=>{},Le=()=>{},Xe=ce=>{u([ce,...r])},te=ce=>{u(r.filter(me=>me.id!==ce))},Se=()=>{const ce={id:Date.now().toString(),title:x.language==="zh-TW"?"":"New Chat",messages:[],createdAt:Date.now(),updatedAt:Date.now()};return m(me=>[ce,...me]),p(ce.id),ce.id},Ae=(ce,me,Ce,_e)=>{m(Pe=>Pe.map(ke=>{if(ke.id===ce){let Je=ke.title;if(Ce)Je=Ce;else if(!ke.messages.some(Ze=>Ze.role==="user")){const Ze=me.find(Jt=>Jt.role==="user");Ze&&(Je=Ze.content.slice(0,20)+(Ze.content.length>20?"...":""))}return{...ke,messages:me,title:Je,tripId:_e||ke.tripId,updatedAt:Date.now()}}return ke}))},We=ce=>{m(me=>me.filter(Ce=>Ce.id!==ce)),g===ce&&p(null)},Ne=ce=>{p(ce)};if(W.useEffect(()=>{const ce=document.getElementById("loading-screen");ce?(console.log("Removing loading screen..."),ce.style.opacity="0",setTimeout(()=>ce.remove(),500)):console.log("Loading screen not found (already removed?)")},[]),W.useEffect(()=>{if(n&&C)try{localStorage.setItem(oO.getSettingsKey(n.id),JSON.stringify(x))}catch(ce){console.error("Failed to save settings",ce)}x.themeColor?document.documentElement.style.setProperty("--color-coral",x.themeColor):document.documentElement.style.removeProperty("--color-coral")},[x,n,C]),!n)return E.jsx(eO,{onLogin:z,onRegister:Le});const j=ce=>{const me=c.find(Ce=>Ce.tripId===ce);if(me)p(me.id);else{const Ce=Se();m(_e=>_e.map(Pe=>{var ke;return Pe.id===Ce?{...Pe,tripId:ce,title:`${((ke=t.find(Je=>Je.id===ce))==null?void 0:ke.title)||"Trip"} Planning`}:Pe}))}ie(nt.AI_PLANNER)},he=()=>{switch(Y){case nt.HOME:return E.jsx(tb,{trips:t,onSelectTrip:ce=>{ee(ce),ie(nt.TRIP_DETAILS)},onAddTrip:()=>ie(nt.ADD_TRIP),onOpenSettings:()=>ie(nt.SETTINGS),settings:x});case nt.ADD_TRIP:return E.jsx(MP,{onSave:ce=>{J(ce),ie(nt.HOME)},onCancel:()=>ie(nt.HOME),settings:x});case nt.MAGIC_EDITOR:return E.jsx(PP,{settings:x});case nt.TRIP_MEMORY:return E.jsx(tO,{memories:r,onAddMemory:Xe,onDeleteMemory:te,settings:x});case nt.AI_PLANNER:return E.jsx(f5,{onStartGeneration:V,onCancel:()=>ie(nt.HOME),settings:x,sessions:c,currentSessionId:g,onCreateSession:Se,onUpdateSession:Ae,onDeleteSession:We,onSelectSession:Ne});case nt.TOOLS:return E.jsx(F5,{onBack:()=>ie(nt.HOME),trips:t,settings:x,onMagicEditor:()=>ie(nt.MAGIC_EDITOR),onOpenSettings:()=>ie(nt.SETTINGS)});case nt.TRIP_DETAILS:return re?E.jsx(h5,{trip:re,onBack:()=>ie(nt.HOME),onDelete:U,onUpdateTrip:k,onOpenAI:j,settings:x}):null;case nt.SETTINGS:return E.jsx(q5,{onBack:()=>ie(nt.HOME),settings:x,onUpdateSettings:B,onResetApp:q,user:n,onLogout:K});default:return null}},be=[nt.HOME,nt.TRIP_MEMORY,nt.TOOLS,nt.AI_PLANNER].includes(Y);return E.jsxs("div",{className:"h-full w-full max-w-md mx-auto bg-paper shadow-2xl relative overflow-hidden flex flex-col font-sans text-ink",children:[F&&E.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 relative",role:"alert",children:[E.jsx("strong",{className:"font-bold",children:"Error: "}),E.jsx("span",{className:"block sm:inline",children:F}),E.jsx("span",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>H(null),children:E.jsxs("svg",{className:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:[E.jsx("title",{children:"Close"}),E.jsx("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})]})})]}),E.jsx("div",{className:"flex-1 overflow-hidden relative bg-paper",children:he()}),be&&E.jsx("div",{className:"absolute bottom-6 left-4 right-4 z-40",children:E.jsxs("div",{className:"bg-white/90 backdrop-blur-xl border border-white/50 shadow-float rounded-3xl px-2 py-3 flex justify-around items-center",children:[E.jsxs("button",{onClick:()=>ie(nt.HOME),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Y===nt.HOME?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[E.jsx(OC,{className:`w-6 h-6 ${Y===nt.HOME?"stroke-2":"stroke-[1.5]"}`}),Y===nt.HOME&&E.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),E.jsxs("button",{onClick:()=>ie(nt.AI_PLANNER),className:`relative flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Y===nt.AI_PLANNER?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[E.jsxs("div",{className:"relative",children:[E.jsx(Zx,{className:`w-6 h-6 ${Y===nt.AI_PLANNER?"stroke-2":"stroke-[1.5]"}`}),(Ee==null?void 0:Ee.length)>0&&E.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-coral rounded-full animate-ping"}),(Ee==null?void 0:Ee.length)>0&&E.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-coral rounded-full border-2 border-white"})]}),Y===nt.AI_PLANNER&&E.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),E.jsxs("button",{onClick:()=>ie(nt.TRIP_MEMORY),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Y===nt.TRIP_MEMORY?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[E.jsx(hu,{className:`w-6 h-6 ${Y===nt.TRIP_MEMORY?"stroke-2":"stroke-[1.5]"}`}),Y===nt.TRIP_MEMORY&&E.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]}),E.jsxs("button",{onClick:()=>ie(nt.TOOLS),className:`flex flex-col items-center gap-1 p-2 rounded-2xl transition-all w-16 ${Y===nt.TOOLS?"text-coral scale-105":"text-gray-400 hover:text-gray-600"}`,children:[E.jsx(yg,{className:`w-6 h-6 ${Y===nt.TOOLS?"stroke-2":"stroke-[1.5]"}`}),Y===nt.TOOLS&&E.jsx("span",{className:"w-1 h-1 bg-coral rounded-full mt-1"})]})]})}),E.jsx(sO,{settings:x})]})};console.log("NomadAI App Starting...");const cA=document.getElementById("root");if(!cA)throw new Error("Could not find root element to mount to");const aO=VC.createRoot(cA);try{aO.render(E.jsx(Lc.StrictMode,{children:E.jsx(rO,{})})),setTimeout(()=>{const n=document.getElementById("loading-screen");n&&(console.warn("Force removing loader after timeout"),n.style.opacity="0",setTimeout(()=>n.remove(),500))},3e3)}catch(n){console.error("React Render Error:",n)}
